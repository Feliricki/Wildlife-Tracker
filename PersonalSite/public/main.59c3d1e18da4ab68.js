(self.webpackChunkPersonalSite=self.webpackChunkPersonalSite||[]).push([[792,307],{121:(Go,Gn,It)=>{"use strict";function Ai(bi,Di,ki,Ki,mt=[]){let yi,en;if(8&ki)yi=(Ki[3]-bi[1])/(Di[1]-bi[1]),en=3;else if(4&ki)yi=(Ki[1]-bi[1])/(Di[1]-bi[1]),en=1;else if(2&ki)yi=(Ki[2]-bi[0])/(Di[0]-bi[0]),en=2;else{if(!(1&ki))return null;yi=(Ki[0]-bi[0])/(Di[0]-bi[0]),en=0}for(let mi=0;mi<bi.length;mi++)mt[mi]=(1&en)===mi?Ki[en]:yi*(Di[mi]-bi[mi])+bi[mi];return mt}function _(bi,Di){let ki=0;return bi[0]<Di[0]?ki|=1:bi[0]>Di[2]&&(ki|=2),bi[1]<Di[1]?ki|=4:bi[1]>Di[3]&&(ki|=8),ki}function Tt(bi,Di){const ki=Di.length,Ki=bi.length;if(Ki>0){let mt=!0;for(let yi=0;yi<ki;yi++)if(bi[Ki-ki+yi]!==Di[yi]){mt=!1;break}if(mt)return!1}for(let mt=0;mt<ki;mt++)bi[Ki+mt]=Di[mt];return!0}function Si(bi,Di){const ki=Di.length;for(let Ki=0;Ki<ki;Ki++)bi[Ki]=Di[Ki]}function Ri(bi,Di,ki,Ki,mt=[]){const yi=Ki+Di*ki;for(let en=0;en<ki;en++)mt[en]=bi[yi+en];return mt}function Ar(bi,Di){const{size:ki=2,broken:Ki=!1,gridResolution:mt=10,gridOffset:yi=[0,0],startIndex:en=0,endIndex:mi=bi.length}=Di||{},Mn=(mi-en)/ki;let vn=[];const St=[vn],Vn=Ri(bi,0,ki,en);let yn,Ii;const an=function ji(bi,Di,ki,Ki){const mt=Math.floor((bi[0]-ki[0])/Di)*Di+ki[0],yi=Math.floor((bi[1]-ki[1])/Di)*Di+ki[1];return Ki[0]=mt,Ki[1]=yi,Ki[2]=mt+Di,Ki[3]=yi+Di,Ki}(Vn,mt,yi,[]),Vr=[];Tt(vn,Vn);for(let uo=1;uo<Mn;uo++){for(yn=Ri(bi,uo,ki,en,yn),Ii=_(yn,an);Ii;){Ai(Vn,yn,Ii,an,Vr);const Hr=_(Vr,an);Hr&&(Ai(Vn,Vr,Hr,an,Vr),Ii=Hr),Tt(vn,Vr),Si(Vn,Vr),un(an,mt,Ii),Ki&&vn.length>ki&&(vn=[],St.push(vn),Tt(vn,Vn)),Ii=_(yn,an)}Tt(vn,yn),Si(Vn,yn)}return Ki?St:St[0]}function un(bi,Di,ki){8&ki?(bi[1]+=Di,bi[3]+=Di):4&ki?(bi[1]-=Di,bi[3]-=Di):2&ki?(bi[0]+=Di,bi[2]+=Di):1&ki&&(bi[0]-=Di,bi[2]-=Di)}It.d(Gn,{M:()=>Ar})},825:(Go,Gn,It)=>{"use strict";It.d(Gn,{I:()=>Ai});var o=It(121);function Ai(Kt,ui){const{size:Ft=2,startIndex:Li=0,endIndex:er=Kt.length,normalize:ji=!0}=ui||{},un=Kt.slice(Li,er);!function Ri(Kt,ui,Ft,Li){let ji,er=Kt[0];for(let un=Ft;un<Li;un+=ui){ji=Kt[un];const tr=ji-er;(tr>180||tr<-180)&&(ji-=360*Math.round(tr/360)),Kt[un]=er=ji}}(un,Ft,0,er-Li);const tr=(0,o.M)(un,{size:Ft,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(ji)for(const bi of tr)Ar(bi,Ft);return tr}function Ar(Kt,ui){let Ft;const Li=Kt.length/ui;for(let ji=0;ji<Li&&(Ft=Kt[ji*ui],(Ft+180)%360==0);ji++);const er=360*-Math.round(Ft/360);if(0!==er)for(let ji=0;ji<Li;ji++)Kt[ji*ui]+=er}},442:(Go,Gn,It)=>{"use strict";It.d(Gn,{rJ:()=>o,Mk:()=>la.M,Iy:()=>io.I,hY:()=>Li,IC:()=>_,UD:()=>Yt});const o={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function Yt(Ge,Qe,nt={}){return function Ai(Ge,Qe={}){return Math.sign(_(Ge,Qe))}(Ge,nt)!==Qe&&(function Si(Ge,Qe){const{start:nt=0,end:Xt=Ge.length,size:kt=2}=Qe,qt=(Xt-nt)/kt,Bt=Math.floor(qt/2);for(let pi=0;pi<Bt;++pi){const pn=nt+pi*kt,Pr=nt+(qt-1-pi)*kt;for(let br=0;br<kt;++br){const Ho=Ge[pn+br];Ge[pn+br]=Ge[Pr+br],Ge[Pr+br]=Ho}}}(Ge,nt),!0)}function _(Ge,Qe={}){const{start:nt=0,end:Xt=Ge.length}=Qe,kt=Qe.size||2;let qt=0;for(let Bt=nt,pi=Xt-kt;Bt<Xt;Bt+=kt)qt+=(Ge[Bt]-Ge[pi])*(Ge[Bt+1]+Ge[pi+1]),pi=Bt;return qt/2}function Li(Ge,Qe,nt=2,Xt){const kt=Qe&&Qe.length,qt=kt?Qe[0]*nt:Ge.length;let Bt=er(Ge,0,qt,nt,!0,Xt&&Xt[0]);const pi=[];if(!Bt||Bt.next===Bt.prev)return pi;let pn,Pr,br,Ho,qo,lt,ve;if(kt&&(Bt=function Ki(Ge,Qe,nt,Xt,kt){const qt=[];let Bt,pi,pn,Pr,br;for(Bt=0,pi=Qe.length;Bt<pi;Bt++)pn=Qe[Bt]*Xt,Pr=Bt<pi-1?Qe[Bt+1]*Xt:Ge.length,br=er(Ge,pn,Pr,Xt,!1,kt&&kt[Bt+1]),br===br.next&&(br.steiner=!0),qt.push(Vn(br));for(qt.sort(mt),Bt=0;Bt<qt.length;Bt++)yi(qt[Bt],nt),nt=ji(nt,nt.next);return nt}(Ge,Qe,Bt,nt,Xt)),Ge.length>80*nt){Ho=Pr=Ge[0],qo=br=Ge[1];for(let Ce=nt;Ce<qt;Ce+=nt)lt=Ge[Ce],ve=Ge[Ce+1],lt<Ho&&(Ho=lt),ve<qo&&(qo=ve),lt>Pr&&(Pr=lt),ve>br&&(br=ve);pn=Math.max(Pr-Ho,br-qo),pn=0!==pn?1/pn:0}return un(Bt,pi,nt,Ho,qo,pn),pi}function er(Ge,Qe,nt,Xt,kt,qt){let Bt,pi;if(void 0===qt&&(qt=_(Ge,{start:Qe,end:nt,size:Xt})),kt===qt<0)for(Bt=Qe;Bt<nt;Bt+=Xt)pi=Eo(Bt,Ge[Bt],Ge[Bt+1],pi);else for(Bt=nt-Xt;Bt>=Qe;Bt-=Xt)pi=Eo(Bt,Ge[Bt],Ge[Bt+1],pi);return pi&&Vr(pi,pi.next)&&(zr(pi),pi=pi.next),pi}function ji(Ge,Qe){if(!Ge)return Ge;Qe||(Qe=Ge);let Xt,nt=Ge;do{if(Xt=!1,nt.steiner||!Vr(nt,nt.next)&&0!==an(nt.prev,nt,nt.next))nt=nt.next;else{if(zr(nt),nt=Qe=nt.prev,nt===nt.next)break;Xt=!0}}while(Xt||nt!==Qe);return Qe}function un(Ge,Qe,nt,Xt,kt,qt,Bt){if(!Ge)return;!Bt&&qt&&function Mn(Ge,Qe,nt,Xt){let kt=Ge;do{null===kt.z&&(kt.z=St(kt.x,kt.y,Qe,nt,Xt)),kt.prevZ=kt.prev,kt.nextZ=kt.next,kt=kt.next}while(kt!==Ge);kt.prevZ.nextZ=null,kt.prevZ=null,function vn(Ge){let Qe,nt,kt,qt,Bt,pi,pn,Pr,Xt=1;do{for(qt=Ge,Ge=null,Pr=null,kt=0;qt;){for(kt++,pi=qt,Bt=0,nt=0;nt<Xt&&(Bt++,pi=pi.nextZ,pi);nt++);for(pn=Xt;Bt>0||pn>0&&pi;)0!==Bt&&(0===pn||!pi||qt.z<=pi.z)?(Qe=qt,qt=qt.nextZ,Bt--):(Qe=pi,pi=pi.nextZ,pn--),Pr?Pr.nextZ=Qe:Ge=Qe,Qe.prevZ=Pr,Pr=Qe;qt=pi}Pr.nextZ=null,Xt*=2}while(kt>1)}(kt)}(Ge,Xt,kt,qt);let pn,Pr,pi=Ge;for(;Ge.prev!==Ge.next;)if(pn=Ge.prev,Pr=Ge.next,qt?bi(Ge,Xt,kt,qt):tr(Ge))Qe.push(pn.i/nt),Qe.push(Ge.i/nt),Qe.push(Pr.i/nt),zr(Ge),Ge=Pr.next,pi=Pr.next;else if((Ge=Pr)===pi){Bt?1===Bt?un(Ge=Di(ji(Ge),Qe,nt),Qe,nt,Xt,kt,qt,2):2===Bt&&ki(Ge,Qe,nt,Xt,kt,qt):un(ji(Ge),Qe,nt,Xt,kt,qt,1);break}}function tr(Ge){const Qe=Ge.prev,nt=Ge,Xt=Ge.next;if(an(Qe,nt,Xt)>=0)return!1;let kt=Ge.next.next;for(;kt!==Ge.prev;){if(yn(Qe.x,Qe.y,nt.x,nt.y,Xt.x,Xt.y,kt.x,kt.y)&&an(kt.prev,kt,kt.next)>=0)return!1;kt=kt.next}return!0}function bi(Ge,Qe,nt,Xt){const kt=Ge.prev,qt=Ge,Bt=Ge.next;if(an(kt,qt,Bt)>=0)return!1;const Pr=kt.x>qt.x?kt.x>Bt.x?kt.x:Bt.x:qt.x>Bt.x?qt.x:Bt.x,br=kt.y>qt.y?kt.y>Bt.y?kt.y:Bt.y:qt.y>Bt.y?qt.y:Bt.y,Ho=St(kt.x<qt.x?kt.x<Bt.x?kt.x:Bt.x:qt.x<Bt.x?qt.x:Bt.x,kt.y<qt.y?kt.y<Bt.y?kt.y:Bt.y:qt.y<Bt.y?qt.y:Bt.y,Qe,nt,Xt),qo=St(Pr,br,Qe,nt,Xt);let lt=Ge.prevZ,ve=Ge.nextZ;for(;lt&&lt.z>=Ho&&ve&&ve.z<=qo;){if(lt!==Ge.prev&&lt!==Ge.next&&yn(kt.x,kt.y,qt.x,qt.y,Bt.x,Bt.y,lt.x,lt.y)&&an(lt.prev,lt,lt.next)>=0||(lt=lt.prevZ,ve!==Ge.prev&&ve!==Ge.next&&yn(kt.x,kt.y,qt.x,qt.y,Bt.x,Bt.y,ve.x,ve.y)&&an(ve.prev,ve,ve.next)>=0))return!1;ve=ve.nextZ}for(;lt&&lt.z>=Ho;){if(lt!==Ge.prev&&lt!==Ge.next&&yn(kt.x,kt.y,qt.x,qt.y,Bt.x,Bt.y,lt.x,lt.y)&&an(lt.prev,lt,lt.next)>=0)return!1;lt=lt.prevZ}for(;ve&&ve.z<=qo;){if(ve!==Ge.prev&&ve!==Ge.next&&yn(kt.x,kt.y,qt.x,qt.y,Bt.x,Bt.y,ve.x,ve.y)&&an(ve.prev,ve,ve.next)>=0)return!1;ve=ve.nextZ}return!0}function Di(Ge,Qe,nt){let Xt=Ge;do{const kt=Xt.prev,qt=Xt.next.next;!Vr(kt,qt)&&uo(kt,Xt,Xt.next,qt)&&jt(kt,qt)&&jt(qt,kt)&&(Qe.push(kt.i/nt),Qe.push(Xt.i/nt),Qe.push(qt.i/nt),zr(Xt),zr(Xt.next),Xt=Ge=qt),Xt=Xt.next}while(Xt!==Ge);return ji(Xt)}function ki(Ge,Qe,nt,Xt,kt,qt){let Bt=Ge;do{let pi=Bt.next.next;for(;pi!==Bt.prev;){if(Bt.i!==pi.i&&Ii(Bt,pi)){let pn=Za(Bt,pi);return Bt=ji(Bt,Bt.next),pn=ji(pn,pn.next),un(Bt,Qe,nt,Xt,kt,qt),void un(pn,Qe,nt,Xt,kt,qt)}pi=pi.next}Bt=Bt.next}while(Bt!==Ge)}function mt(Ge,Qe){return Ge.x-Qe.x}function yi(Ge,Qe){if(Qe=function en(Ge,Qe){let nt=Qe;const Xt=Ge.x,kt=Ge.y;let Bt,qt=-1/0;do{if(kt<=nt.y&&kt>=nt.next.y&&nt.next.y!==nt.y){const qo=nt.x+(kt-nt.y)*(nt.next.x-nt.x)/(nt.next.y-nt.y);if(qo<=Xt&&qo>qt){if(qt=qo,qo===Xt){if(kt===nt.y)return nt;if(kt===nt.next.y)return nt.next}Bt=nt.x<nt.next.x?nt:nt.next}}nt=nt.next}while(nt!==Qe);if(!Bt)return null;if(Xt===qt)return Bt;const pi=Bt,pn=Bt.x,Pr=Bt.y;let Ho,br=1/0;nt=Bt;do{Xt>=nt.x&&nt.x>=pn&&Xt!==nt.x&&yn(kt<Pr?Xt:qt,kt,pn,Pr,kt<Pr?qt:Xt,kt,nt.x,nt.y)&&(Ho=Math.abs(kt-nt.y)/(Xt-nt.x),jt(nt,Ge)&&(Ho<br||Ho===br&&(nt.x>Bt.x||nt.x===Bt.x&&mi(Bt,nt)))&&(Bt=nt,br=Ho)),nt=nt.next}while(nt!==pi);return Bt}(Ge,Qe),Qe){const nt=Za(Qe,Ge);ji(Qe,Qe.next),ji(nt,nt.next)}}function mi(Ge,Qe){return an(Ge.prev,Ge,Qe.prev)<0&&an(Qe.next,Ge,Ge.next)<0}function St(Ge,Qe,nt,Xt,kt){return(Ge=1431655765&((Ge=858993459&((Ge=252645135&((Ge=16711935&((Ge=32767*(Ge-nt)*kt)|Ge<<8))|Ge<<4))|Ge<<2))|Ge<<1))|(Qe=1431655765&((Qe=858993459&((Qe=252645135&((Qe=16711935&((Qe=32767*(Qe-Xt)*kt)|Qe<<8))|Qe<<4))|Qe<<2))|Qe<<1))<<1}function Vn(Ge){let Qe=Ge,nt=Ge;do{(Qe.x<nt.x||Qe.x===nt.x&&Qe.y<nt.y)&&(nt=Qe),Qe=Qe.next}while(Qe!==Ge);return nt}function yn(Ge,Qe,nt,Xt,kt,qt,Bt,pi){return(kt-Bt)*(Qe-pi)-(Ge-Bt)*(qt-pi)>=0&&(Ge-Bt)*(Xt-pi)-(nt-Bt)*(Qe-pi)>=0&&(nt-Bt)*(qt-pi)-(kt-Bt)*(Xt-pi)>=0}function Ii(Ge,Qe){return Ge.next.i!==Qe.i&&Ge.prev.i!==Qe.i&&!function va(Ge,Qe){let nt=Ge;do{if(nt.i!==Ge.i&&nt.next.i!==Ge.i&&nt.i!==Qe.i&&nt.next.i!==Qe.i&&uo(nt,nt.next,Ge,Qe))return!0;nt=nt.next}while(nt!==Ge);return!1}(Ge,Qe)&&(jt(Ge,Qe)&&jt(Qe,Ge)&&function ta(Ge,Qe){let nt=Ge,Xt=!1;const kt=(Ge.x+Qe.x)/2,qt=(Ge.y+Qe.y)/2;do{nt.y>qt!=nt.next.y>qt&&nt.next.y!==nt.y&&kt<(nt.next.x-nt.x)*(qt-nt.y)/(nt.next.y-nt.y)+nt.x&&(Xt=!Xt),nt=nt.next}while(nt!==Ge);return Xt}(Ge,Qe)&&(an(Ge.prev,Ge,Qe.prev)||an(Ge,Qe.prev,Qe))||Vr(Ge,Qe)&&an(Ge.prev,Ge,Ge.next)>0&&an(Qe.prev,Qe,Qe.next)>0)}function an(Ge,Qe,nt){return(Qe.y-Ge.y)*(nt.x-Qe.x)-(Qe.x-Ge.x)*(nt.y-Qe.y)}function Vr(Ge,Qe){return Ge.x===Qe.x&&Ge.y===Qe.y}function uo(Ge,Qe,nt,Xt){const kt=as(an(Ge,Qe,nt)),qt=as(an(Ge,Qe,Xt)),Bt=as(an(nt,Xt,Ge)),pi=as(an(nt,Xt,Qe));return!!(kt!==qt&&Bt!==pi||0===kt&&Hr(Ge,nt,Qe)||0===qt&&Hr(Ge,Xt,Qe)||0===Bt&&Hr(nt,Ge,Xt)||0===pi&&Hr(nt,Qe,Xt))}function Hr(Ge,Qe,nt){return Qe.x<=Math.max(Ge.x,nt.x)&&Qe.x>=Math.min(Ge.x,nt.x)&&Qe.y<=Math.max(Ge.y,nt.y)&&Qe.y>=Math.min(Ge.y,nt.y)}function as(Ge){return Ge>0?1:Ge<0?-1:0}function jt(Ge,Qe){return an(Ge.prev,Ge,Ge.next)<0?an(Ge,Qe,Ge.next)>=0&&an(Ge,Ge.prev,Qe)>=0:an(Ge,Qe,Ge.prev)<0||an(Ge,Ge.next,Qe)<0}function Za(Ge,Qe){const nt=new No(Ge.i,Ge.x,Ge.y),Xt=new No(Qe.i,Qe.x,Qe.y),kt=Ge.next,qt=Qe.prev;return Ge.next=Qe,Qe.prev=Ge,nt.next=kt,kt.prev=nt,Xt.next=nt,nt.prev=Xt,qt.next=Xt,Xt.prev=qt,Xt}function Eo(Ge,Qe,nt,Xt){const kt=new No(Ge,Qe,nt);return Xt?(kt.next=Xt.next,kt.prev=Xt,Xt.next.prev=kt,Xt.next=kt):(kt.prev=kt,kt.next=kt),kt}function zr(Ge){Ge.next.prev=Ge.prev,Ge.prev.next=Ge.next,Ge.prevZ&&(Ge.prevZ.nextZ=Ge.nextZ),Ge.nextZ&&(Ge.nextZ.prevZ=Ge.prevZ)}function No(Ge,Qe,nt){this.i=Ge,this.x=Qe,this.y=nt,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var la=It(121),io=It(825)},307:(Go,Gn,It)=>{"use strict";It.d(Gn,{gL:()=>od,XL:()=>gf});var o=It(467),Ai=It(442);function Tt(he,N,W,re){W.push(N.length),N.push(...he);for(let _e=he.length;_e<re.coordLength;_e++)N.push(0)}function Si(he,N,W,re){W.push(N.length);for(const _e of he){N.push(..._e);for(let Ie=_e.length;Ie<re.coordLength;Ie++)N.push(0)}}function Ri(he,N,W,re,_e){let Ie=0;const $e=[],Ue=[];for(const Ct of he){const zt=Ct.map(En=>En.slice(0,2));let li=(0,Ai.IC)(zt.flat());const Ln=li<0;_e.fixRingWinding&&(0===Ie&&!Ln||Ie>0&&Ln)&&(Ct.reverse(),li=-li),$e.push(li),Si(Ct,N,Ue,_e),Ie++}Ie>0&&(re.push($e),W.push(Ue))}function Kt(he,N,W){const re=function Ft(he){const N={};for(const W of he)if(W.properties)for(const re in W.properties)N[re]=mt(W.properties[re],N[re]);return N}(he),_e=Object.keys(re).filter(Ie=>re[Ie]!==Array);return function Li(he,N,W){const{pointPositionsCount:re,pointFeaturesCount:_e,linePositionsCount:Ie,linePathsCount:$e,lineFeaturesCount:Ue,polygonPositionsCount:Ct,polygonObjectsCount:zt,polygonRingsCount:li,polygonFeaturesCount:Ln,propArrayTypes:En,coordLength:Wn}=N,{numericPropKeys:pr=[],PositionDataType:ys=Float32Array,triangulate:Ja=!0}=W,xl=he[0]&&"id"in he[0],Lc=he.length>65535?Uint32Array:Uint16Array,ja={type:"Point",positions:new ys(re*Wn),globalFeatureIds:new Lc(re),featureIds:_e>65535?new Uint32Array(re):new Uint16Array(re),numericProps:{},properties:[],fields:[]},Ga={type:"LineString",pathIndices:Ie>65535?new Uint32Array($e+1):new Uint16Array($e+1),positions:new ys(Ie*Wn),globalFeatureIds:new Lc(Ie),featureIds:Ue>65535?new Uint32Array(Ie):new Uint16Array(Ie),numericProps:{},properties:[],fields:[]},wl={type:"Polygon",polygonIndices:Ct>65535?new Uint32Array(zt+1):new Uint16Array(zt+1),primitivePolygonIndices:Ct>65535?new Uint32Array(li+1):new Uint16Array(li+1),positions:new ys(Ct*Wn),globalFeatureIds:new Lc(Ct),featureIds:Ln>65535?new Uint32Array(Ct):new Uint16Array(Ct),numericProps:{},properties:[],fields:[]};Ja&&(wl.triangles=[]);for(const Fc of[ja,Ga,wl])for(const da of pr)Fc.numericProps[da]=new(0,En[da])(Fc.positions.length/Wn);Ga.pathIndices[$e]=Ie,wl.polygonIndices[zt]=Ct,wl.primitivePolygonIndices[li]=Ct;const fo={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const Fc of he){const da=Fc.geometry,Nt=Fc.properties||{};switch(da.type){case"Point":er(da,ja,fo,Wn,Nt),ja.properties.push(Ki(Nt,pr)),xl&&ja.fields.push({id:Fc.id}),fo.pointFeature++;break;case"LineString":ji(da,Ga,fo,Wn,Nt),Ga.properties.push(Ki(Nt,pr)),xl&&Ga.fields.push({id:Fc.id}),fo.lineFeature++;break;case"Polygon":un(da,wl,fo,Wn,Nt),wl.properties.push(Ki(Nt,pr)),xl&&wl.fields.push({id:Fc.id}),fo.polygonFeature++;break;default:throw new Error("Invalid geometry type")}fo.feature++}return function Di(he,N,W,re){const _e={points:{...he,positions:{value:he.positions,size:re},globalFeatureIds:{value:he.globalFeatureIds,size:1},featureIds:{value:he.featureIds,size:1},numericProps:bi(he.numericProps,1)},lines:{...N,positions:{value:N.positions,size:re},pathIndices:{value:N.pathIndices,size:1},globalFeatureIds:{value:N.globalFeatureIds,size:1},featureIds:{value:N.featureIds,size:1},numericProps:bi(N.numericProps,1)},polygons:{...W,positions:{value:W.positions,size:re},polygonIndices:{value:W.polygonIndices,size:1},primitivePolygonIndices:{value:W.primitivePolygonIndices,size:1},globalFeatureIds:{value:W.globalFeatureIds,size:1},featureIds:{value:W.featureIds,size:1},numericProps:bi(W.numericProps,1)}};return W.triangles&&(_e.polygons.triangles={value:new Uint32Array(W.triangles),size:1}),_e}(ja,Ga,wl,Wn)}(he,{propArrayTypes:re,...N},{numericPropKeys:W&&W.numericPropKeys||_e,PositionDataType:W?W.PositionDataType:Float32Array,triangulate:!W||W.triangulate})}function er(he,N,W,re,_e){N.positions.set(he.data,W.pointPosition*re);const Ie=he.data.length/re;ki(N,_e,W.pointPosition,Ie),N.globalFeatureIds.fill(W.feature,W.pointPosition,W.pointPosition+Ie),N.featureIds.fill(W.pointFeature,W.pointPosition,W.pointPosition+Ie),W.pointPosition+=Ie}function ji(he,N,W,re,_e){N.positions.set(he.data,W.linePosition*re);const Ie=he.data.length/re;ki(N,_e,W.linePosition,Ie),N.globalFeatureIds.fill(W.feature,W.linePosition,W.linePosition+Ie),N.featureIds.fill(W.lineFeature,W.linePosition,W.linePosition+Ie);for(let $e=0,Ue=he.indices.length;$e<Ue;++$e){const Ct=he.indices[$e],zt=$e===Ue-1?he.data.length:he.indices[$e+1];N.pathIndices[W.linePath++]=W.linePosition,W.linePosition+=(zt-Ct)/re}}function un(he,N,W,re,_e){N.positions.set(he.data,W.polygonPosition*re);const Ie=he.data.length/re;ki(N,_e,W.polygonPosition,Ie),N.globalFeatureIds.fill(W.feature,W.polygonPosition,W.polygonPosition+Ie),N.featureIds.fill(W.polygonFeature,W.polygonPosition,W.polygonPosition+Ie);for(let $e=0,Ue=he.indices.length;$e<Ue;++$e){const Ct=W.polygonPosition;N.polygonIndices[W.polygonObject++]=Ct;const zt=he.areas[$e],li=he.indices[$e],Ln=he.indices[$e+1];for(let Wn=0,pr=li.length;Wn<pr;++Wn){const ys=li[Wn],Ja=Wn===pr-1?void 0===Ln?he.data.length:Ln[0]:li[Wn+1];N.primitivePolygonIndices[W.polygonRing++]=W.polygonPosition,W.polygonPosition+=(Ja-ys)/re}tr(N,zt,li,{startPosition:Ct,endPosition:W.polygonPosition,coordLength:re})}}function tr(he,N,W,re){let{startPosition:_e,endPosition:Ie,coordLength:$e}=re;if(!he.triangles)return;const zt=he.positions.subarray(_e*$e,Ie*$e),li=W[0],Ln=W.slice(1).map(Wn=>(Wn-li)/$e),En=(0,Ai.hY)(zt,Ln,$e,N);for(let Wn=0,pr=En.length;Wn<pr;++Wn)he.triangles.push(_e+En[Wn])}function bi(he,N){const W={};for(const re in he)W[re]={value:he[re],size:N};return W}function ki(he,N,W,re){for(const _e in he.numericProps)_e in N&&he.numericProps[_e].fill(N[_e],W,W+re)}function Ki(he,N){const W={};for(const re in he)N.includes(re)||(W[re]=he[re]);return W}function mt(he,N){return N!==Array&&Number.isFinite(he)?N===Float64Array||Math.fround(he)!==he?Float64Array:Float32Array:Array}function yi(he){let N=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fixRingWinding:!0,triangulate:!0};const W=function Yt(he){let N=0,W=0,re=0,_e=0,Ie=0,$e=0,Ue=0,Ct=0,zt=0;const li=new Set;for(const Ln of he){const En=Ln.geometry;switch(En.type){case"Point":W++,N++,li.add(En.coordinates.length);break;case"MultiPoint":W++,N+=En.coordinates.length;for(const pr of En.coordinates)li.add(pr.length);break;case"LineString":Ie++,re+=En.coordinates.length,_e++;for(const pr of En.coordinates)li.add(pr.length);break;case"MultiLineString":Ie++;for(const pr of En.coordinates){re+=pr.length,_e++;for(const ys of pr)li.add(ys.length)}break;case"Polygon":zt++,Ue++,Ct+=En.coordinates.length;const Wn=En.coordinates.flat();$e+=Wn.length;for(const pr of Wn)li.add(pr.length);break;case"MultiPolygon":zt++;for(const pr of En.coordinates){Ue++,Ct+=pr.length;const ys=pr.flat();$e+=ys.length;for(const Ja of ys)li.add(Ja.length)}break;default:throw new Error("Unsupported geometry type: ".concat(En.type))}}return{coordLength:li.size>0?Math.max(...li):2,pointPositionsCount:N,pointFeaturesCount:W,linePositionsCount:re,linePathsCount:_e,lineFeaturesCount:Ie,polygonPositionsCount:$e,polygonObjectsCount:Ue,polygonRingsCount:Ct,polygonFeaturesCount:zt}}(he),re=W.coordLength,{fixRingWinding:_e}=N;return Kt(function _(he){let N=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{coordLength:2,fixRingWinding:!0};return he.map(W=>function Ar(he,N){const{geometry:W}=he;if("GeometryCollection"===W.type)throw new Error("GeometryCollection type not supported");const re=[],_e=[];let Ie,$e;switch(W.type){case"Point":$e="Point",Tt(W.coordinates,re,_e,N);break;case"MultiPoint":$e="Point",W.coordinates.map(Ue=>Tt(Ue,re,_e,N));break;case"LineString":$e="LineString",Si(W.coordinates,re,_e,N);break;case"MultiLineString":$e="LineString",W.coordinates.map(Ue=>Si(Ue,re,_e,N));break;case"Polygon":$e="Polygon",Ie=[],Ri(W.coordinates,re,_e,Ie,N);break;case"MultiPolygon":$e="Polygon",Ie=[],W.coordinates.map(Ue=>Ri(Ue,re,_e,Ie,N));break;default:throw new Error("Unknown type: ".concat($e))}return{...he,geometry:{type:$e,indices:_e,data:re,areas:Ie}}}(W,N))}(he,{coordLength:re,fixRingWinding:_e}),W,{numericPropKeys:N.numericPropKeys,PositionDataType:N.PositionDataType||Float32Array,triangulate:N.triangulate})}const en=[0,2e3,1e4,3e4,null];class mi{constructor(N){this._retryDelays=void 0!==N?[...N,null]:en}nextRetryDelayInMilliseconds(N){return this._retryDelays[N.previousRetryCount]}}let Mn=(()=>{class he{}return he.Authorization="Authorization",he.Cookie="Cookie",he})();class vn{constructor(N,W,re){this.statusCode=N,this.statusText=W,this.content=re}}class St{get(N,W){return this.send({...W,method:"GET",url:N})}post(N,W){return this.send({...W,method:"POST",url:N})}delete(N,W){return this.send({...W,method:"DELETE",url:N})}getCookieString(N){return""}}class Vn extends St{constructor(N,W){super(),this._innerClient=N,this._accessTokenFactory=W}send(N){var W=this;return(0,o.A)(function*(){let re=!0;W._accessTokenFactory&&(!W._accessToken||N.url&&N.url.indexOf("/negotiate?")>0)&&(re=!1,W._accessToken=yield W._accessTokenFactory()),W._setAuthorizationHeader(N);const _e=yield W._innerClient.send(N);return re&&401===_e.statusCode&&W._accessTokenFactory?(W._accessToken=yield W._accessTokenFactory(),W._setAuthorizationHeader(N),yield W._innerClient.send(N)):_e})()}_setAuthorizationHeader(N){N.headers||(N.headers={}),this._accessToken?N.headers[Mn.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&N.headers[Mn.Authorization]&&delete N.headers[Mn.Authorization]}getCookieString(N){return this._innerClient.getCookieString(N)}}class yn extends Error{constructor(N,W){const re=new.target.prototype;super(`${N}: Status code '${W}'`),this.statusCode=W,this.__proto__=re}}class Ii extends Error{constructor(N="A timeout occurred."){const W=new.target.prototype;super(N),this.__proto__=W}}class an extends Error{constructor(N="An abort occurred."){const W=new.target.prototype;super(N),this.__proto__=W}}class Vr extends Error{constructor(N,W){const re=new.target.prototype;super(N),this.transport=W,this.errorType="UnsupportedTransportError",this.__proto__=re}}class uo extends Error{constructor(N,W){const re=new.target.prototype;super(N),this.transport=W,this.errorType="DisabledTransportError",this.__proto__=re}}class Hr extends Error{constructor(N,W){const re=new.target.prototype;super(N),this.transport=W,this.errorType="FailedToStartTransportError",this.__proto__=re}}class as extends Error{constructor(N){const W=new.target.prototype;super(N),this.errorType="FailedToNegotiateWithServerError",this.__proto__=W}}class va extends Error{constructor(N,W){const re=new.target.prototype;super(N),this.innerErrors=W,this.__proto__=re}}var jt=function(he){return he[he.Trace=0]="Trace",he[he.Debug=1]="Debug",he[he.Information=2]="Information",he[he.Warning=3]="Warning",he[he.Error=4]="Error",he[he.Critical=5]="Critical",he[he.None=6]="None",he}(jt||{});class ta{constructor(){}log(N,W){}}ta.instance=new ta;const Za="8.0.0";class Eo{static isRequired(N,W){if(null==N)throw new Error(`The '${W}' argument is required.`)}static isNotEmpty(N,W){if(!N||N.match(/^\s*$/))throw new Error(`The '${W}' argument should not be empty.`)}static isIn(N,W,re){if(!(N in W))throw new Error(`Unknown ${re} value: ${N}.`)}}class zr{static get isBrowser(){return!zr.isNode&&"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return!zr.isNode&&"object"==typeof self&&"importScripts"in self}static get isReactNative(){return!zr.isNode&&"object"==typeof window&&typeof window.document>"u"}static get isNode(){return typeof process<"u"&&process.release&&"node"===process.release.name}}function No(he,N){let W="";return io(he)?(W=`Binary data of length ${he.byteLength}`,N&&(W+=`. Content: '${function la(he){const N=new Uint8Array(he);let W="";return N.forEach(re=>{W+=`0x${re<16?"0":""}${re.toString(16)} `}),W.substr(0,W.length-1)}(he)}'`)):"string"==typeof he&&(W=`String data of length ${he.length}`,N&&(W+=`. Content: '${he}'`)),W}function io(he){return he&&typeof ArrayBuffer<"u"&&(he instanceof ArrayBuffer||he.constructor&&"ArrayBuffer"===he.constructor.name)}function Ge(he,N,W,re,_e,Ie){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,o.A)(function*(he,N,W,re,_e,Ie){const $e={},[Ue,Ct]=qt();$e[Ue]=Ct,he.log(jt.Trace,`(${N} transport) sending data. ${No(_e,Ie.logMessageContent)}.`);const zt=io(_e)?"arraybuffer":"text",li=yield W.post(re,{content:_e,headers:{...$e,...Ie.headers},responseType:zt,timeout:Ie.timeout,withCredentials:Ie.withCredentials});he.log(jt.Trace,`(${N} transport) request complete. Response status: ${li.statusCode}.`)})).apply(this,arguments)}class Xt{constructor(N,W){this._subject=N,this._observer=W}dispose(){const N=this._subject.observers.indexOf(this._observer);N>-1&&this._subject.observers.splice(N,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(W=>{})}}class kt{constructor(N){this._minLevel=N,this.out=console}log(N,W){if(N>=this._minLevel){const re=`[${(new Date).toISOString()}] ${jt[N]}: ${W}`;switch(N){case jt.Critical:case jt.Error:this.out.error(re);break;case jt.Warning:this.out.warn(re);break;case jt.Information:this.out.info(re);break;default:this.out.log(re)}}}}function qt(){let he="X-SignalR-User-Agent";return zr.isNode&&(he="User-Agent"),[he,Bt(Za,pi(),zr.isNode?"NodeJS":"Browser",pn())]}function Bt(he,N,W,re){let _e="Microsoft SignalR/";const Ie=he.split(".");return _e+=`${Ie[0]}.${Ie[1]}`,_e+=` (${he}; `,_e+=N&&""!==N?`${N}; `:"Unknown OS; ",_e+=`${W}`,_e+=re?`; ${re}`:"; Unknown Runtime Version",_e+=")",_e}function pi(){if(!zr.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function pn(){if(zr.isNode)return process.versions.node}function br(he){return he.stack?he.stack:he.message?he.message:`${he}`}class He extends St{constructor(N){super(),this._logger=N;const W={_fetchType:void 0,_jar:void 0};!function qo(he){return!!(typeof fetch>"u"||zr.isNode)&&(he._jar=new(It(611).CookieJar),he._fetchType=typeof fetch>"u"?It(676):fetch,he._fetchType=It(236)(he._fetchType,he._jar),!0)}(W)?this._fetchType=fetch.bind(function Ho(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}()):(this._fetchType=W._fetchType,this._jar=W._jar),this._abortControllerType=AbortController;const re={_abortControllerType:this._abortControllerType};(function lt(he){return typeof AbortController>"u"&&(he._abortControllerType=It(720),!0)})(re)&&(this._abortControllerType=re._abortControllerType)}send(N){var W=this;return(0,o.A)(function*(){if(N.abortSignal&&N.abortSignal.aborted)throw new an;if(!N.method)throw new Error("No method defined.");if(!N.url)throw new Error("No url defined.");const re=new W._abortControllerType;let _e;N.abortSignal&&(N.abortSignal.onabort=()=>{re.abort(),_e=new an});let $e,Ie=null;N.timeout&&(Ie=setTimeout(()=>{re.abort(),W._logger.log(jt.Warning,"Timeout from HTTP request."),_e=new Ii},N.timeout)),""===N.content&&(N.content=void 0),N.content&&(N.headers=N.headers||{},N.headers["Content-Type"]=io(N.content)?"application/octet-stream":"text/plain;charset=UTF-8");try{$e=yield W._fetchType(N.url,{body:N.content,cache:"no-cache",credentials:!0===N.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...N.headers},method:N.method,mode:"cors",redirect:"follow",signal:re.signal})}catch(zt){throw _e||(W._logger.log(jt.Warning,`Error from HTTP request. ${zt}.`),zt)}finally{Ie&&clearTimeout(Ie),N.abortSignal&&(N.abortSignal.onabort=null)}if(!$e.ok){const zt=yield ut($e,"text");throw new yn(zt||$e.statusText,$e.status)}const Ct=yield ut($e,N.responseType);return new vn($e.status,$e.statusText,Ct)})()}getCookieString(N){let W="";return zr.isNode&&this._jar&&this._jar.getCookies(N,(re,_e)=>W=_e.join("; ")),W}}function ut(he,N){let W;switch(N){case"arraybuffer":W=he.arrayBuffer();break;case"text":default:W=he.text();break;case"blob":case"document":case"json":throw new Error(`${N} is not supported.`)}return W}class bt extends St{constructor(N){super(),this._logger=N}send(N){return N.abortSignal&&N.abortSignal.aborted?Promise.reject(new an):N.method?N.url?new Promise((W,re)=>{const _e=new XMLHttpRequest;_e.open(N.method,N.url,!0),_e.withCredentials=void 0===N.withCredentials||N.withCredentials,_e.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===N.content&&(N.content=void 0),N.content&&(io(N.content)?_e.setRequestHeader("Content-Type","application/octet-stream"):_e.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const Ie=N.headers;Ie&&Object.keys(Ie).forEach($e=>{_e.setRequestHeader($e,Ie[$e])}),N.responseType&&(_e.responseType=N.responseType),N.abortSignal&&(N.abortSignal.onabort=()=>{_e.abort(),re(new an)}),N.timeout&&(_e.timeout=N.timeout),_e.onload=()=>{N.abortSignal&&(N.abortSignal.onabort=null),_e.status>=200&&_e.status<300?W(new vn(_e.status,_e.statusText,_e.response||_e.responseText)):re(new yn(_e.response||_e.responseText||_e.statusText,_e.status))},_e.onerror=()=>{this._logger.log(jt.Warning,`Error from HTTP request. ${_e.status}: ${_e.statusText}.`),re(new yn(_e.statusText,_e.status))},_e.ontimeout=()=>{this._logger.log(jt.Warning,"Timeout from HTTP request."),re(new Ii)},_e.send(N.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class Ht extends St{constructor(N){if(super(),typeof fetch<"u"||zr.isNode)this._httpClient=new He(N);else{if(!(typeof XMLHttpRequest<"u"))throw new Error("No usable HttpClient found.");this._httpClient=new bt(N)}}send(N){return N.abortSignal&&N.abortSignal.aborted?Promise.reject(new an):N.method?N.url?this._httpClient.send(N):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(N){return this._httpClient.getCookieString(N)}}var hi=function(he){return he[he.None=0]="None",he[he.WebSockets=1]="WebSockets",he[he.ServerSentEvents=2]="ServerSentEvents",he[he.LongPolling=4]="LongPolling",he}(hi||{}),gt=function(he){return he[he.Text=1]="Text",he[he.Binary=2]="Binary",he}(gt||{});class Ni{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class wi{get pollAborted(){return this._pollAbort.aborted}constructor(N,W,re){this._httpClient=N,this._logger=W,this._pollAbort=new Ni,this._options=re,this._running=!1,this.onreceive=null,this.onclose=null}connect(N,W){var re=this;return(0,o.A)(function*(){if(Eo.isRequired(N,"url"),Eo.isRequired(W,"transferFormat"),Eo.isIn(W,gt,"transferFormat"),re._url=N,re._logger.log(jt.Trace,"(LongPolling transport) Connecting."),W===gt.Binary&&typeof XMLHttpRequest<"u"&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[_e,Ie]=qt(),$e={[_e]:Ie,...re._options.headers},Ue={abortSignal:re._pollAbort.signal,headers:$e,timeout:1e5,withCredentials:re._options.withCredentials};W===gt.Binary&&(Ue.responseType="arraybuffer");const Ct=`${N}&_=${Date.now()}`;re._logger.log(jt.Trace,`(LongPolling transport) polling: ${Ct}.`);const zt=yield re._httpClient.get(Ct,Ue);200!==zt.statusCode?(re._logger.log(jt.Error,`(LongPolling transport) Unexpected response code: ${zt.statusCode}.`),re._closeError=new yn(zt.statusText||"",zt.statusCode),re._running=!1):re._running=!0,re._receiving=re._poll(re._url,Ue)})()}_poll(N,W){var re=this;return(0,o.A)(function*(){try{for(;re._running;)try{const _e=`${N}&_=${Date.now()}`;re._logger.log(jt.Trace,`(LongPolling transport) polling: ${_e}.`);const Ie=yield re._httpClient.get(_e,W);204===Ie.statusCode?(re._logger.log(jt.Information,"(LongPolling transport) Poll terminated by server."),re._running=!1):200!==Ie.statusCode?(re._logger.log(jt.Error,`(LongPolling transport) Unexpected response code: ${Ie.statusCode}.`),re._closeError=new yn(Ie.statusText||"",Ie.statusCode),re._running=!1):Ie.content?(re._logger.log(jt.Trace,`(LongPolling transport) data received. ${No(Ie.content,re._options.logMessageContent)}.`),re.onreceive&&re.onreceive(Ie.content)):re._logger.log(jt.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(_e){re._running?_e instanceof Ii?re._logger.log(jt.Trace,"(LongPolling transport) Poll timed out, reissuing."):(re._closeError=_e,re._running=!1):re._logger.log(jt.Trace,`(LongPolling transport) Poll errored after shutdown: ${_e.message}`)}}finally{re._logger.log(jt.Trace,"(LongPolling transport) Polling complete."),re.pollAborted||re._raiseOnClose()}})()}send(N){var W=this;return(0,o.A)(function*(){return W._running?Ge(W._logger,"LongPolling",W._httpClient,W._url,N,W._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){var N=this;return(0,o.A)(function*(){N._logger.log(jt.Trace,"(LongPolling transport) Stopping polling."),N._running=!1,N._pollAbort.abort();try{yield N._receiving,N._logger.log(jt.Trace,`(LongPolling transport) sending DELETE request to ${N._url}.`);const W={},[re,_e]=qt();W[re]=_e;const Ie={headers:{...W,...N._options.headers},timeout:N._options.timeout,withCredentials:N._options.withCredentials};let $e;try{yield N._httpClient.delete(N._url,Ie)}catch(Ue){$e=Ue}$e?$e instanceof yn&&N._logger.log(jt.Trace,404===$e.statusCode?"(LongPolling transport) A 404 response was returned from sending a DELETE request.":`(LongPolling transport) Error sending a DELETE request: ${$e}`):N._logger.log(jt.Trace,"(LongPolling transport) DELETE request accepted.")}finally{N._logger.log(jt.Trace,"(LongPolling transport) Stop finished."),N._raiseOnClose()}})()}_raiseOnClose(){if(this.onclose){let N="(LongPolling transport) Firing onclose event.";this._closeError&&(N+=" Error: "+this._closeError),this._logger.log(jt.Trace,N),this.onclose(this._closeError)}}}class $i{constructor(N,W,re,_e){this._httpClient=N,this._accessToken=W,this._logger=re,this._options=_e,this.onreceive=null,this.onclose=null}connect(N,W){var re=this;return(0,o.A)(function*(){return Eo.isRequired(N,"url"),Eo.isRequired(W,"transferFormat"),Eo.isIn(W,gt,"transferFormat"),re._logger.log(jt.Trace,"(SSE transport) Connecting."),re._url=N,re._accessToken&&(N+=(N.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(re._accessToken)}`),new Promise((_e,Ie)=>{let Ue,$e=!1;if(W===gt.Text){if(zr.isBrowser||zr.isWebWorker)Ue=new re._options.EventSource(N,{withCredentials:re._options.withCredentials});else{const Ct=re._httpClient.getCookieString(N),zt={};zt.Cookie=Ct;const[li,Ln]=qt();zt[li]=Ln,Ue=new re._options.EventSource(N,{withCredentials:re._options.withCredentials,headers:{...zt,...re._options.headers}})}try{Ue.onmessage=Ct=>{if(re.onreceive)try{re._logger.log(jt.Trace,`(SSE transport) data received. ${No(Ct.data,re._options.logMessageContent)}.`),re.onreceive(Ct.data)}catch(zt){return void re._close(zt)}},Ue.onerror=Ct=>{$e?re._close():Ie(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},Ue.onopen=()=>{re._logger.log(jt.Information,`SSE connected to ${re._url}`),re._eventSource=Ue,$e=!0,_e()}}catch(Ct){return void Ie(Ct)}}else Ie(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})})()}send(N){var W=this;return(0,o.A)(function*(){return W._eventSource?Ge(W._logger,"SSE",W._httpClient,W._url,N,W._options):Promise.reject(new Error("Cannot send until the transport is connected"))})()}stop(){return this._close(),Promise.resolve()}_close(N){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(N))}}class jn{constructor(N,W,re,_e,Ie,$e){this._logger=re,this._accessTokenFactory=W,this._logMessageContent=_e,this._webSocketConstructor=Ie,this._httpClient=N,this.onreceive=null,this.onclose=null,this._headers=$e}connect(N,W){var re=this;return(0,o.A)(function*(){let _e;return Eo.isRequired(N,"url"),Eo.isRequired(W,"transferFormat"),Eo.isIn(W,gt,"transferFormat"),re._logger.log(jt.Trace,"(WebSockets transport) Connecting."),re._accessTokenFactory&&(_e=yield re._accessTokenFactory()),new Promise((Ie,$e)=>{let Ue;N=N.replace(/^http/,"ws");const Ct=re._httpClient.getCookieString(N);let zt=!1;if(zr.isNode||zr.isReactNative){const li={},[Ln,En]=qt();li[Ln]=En,_e&&(li[Mn.Authorization]=`Bearer ${_e}`),Ct&&(li[Mn.Cookie]=Ct),Ue=new re._webSocketConstructor(N,void 0,{headers:{...li,...re._headers}})}else _e&&(N+=(N.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(_e)}`);Ue||(Ue=new re._webSocketConstructor(N)),W===gt.Binary&&(Ue.binaryType="arraybuffer"),Ue.onopen=li=>{re._logger.log(jt.Information,`WebSocket connected to ${N}.`),re._webSocket=Ue,zt=!0,Ie()},Ue.onerror=li=>{let Ln=null;Ln=typeof ErrorEvent<"u"&&li instanceof ErrorEvent?li.error:"There was an error with the transport",re._logger.log(jt.Information,`(WebSockets transport) ${Ln}.`)},Ue.onmessage=li=>{if(re._logger.log(jt.Trace,`(WebSockets transport) data received. ${No(li.data,re._logMessageContent)}.`),re.onreceive)try{re.onreceive(li.data)}catch(Ln){return void re._close(Ln)}},Ue.onclose=li=>{if(zt)re._close(li);else{let Ln=null;Ln=typeof ErrorEvent<"u"&&li instanceof ErrorEvent?li.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",$e(new Error(Ln))}}})})()}send(N){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(jt.Trace,`(WebSockets transport) sending data. ${No(N,this._logMessageContent)}.`),this._webSocket.send(N),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(N){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(jt.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(N)||!1!==N.wasClean&&1e3===N.code?N instanceof Error?this.onclose(N):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${N.code} (${N.reason||"no reason given"}).`)))}_isCloseEvent(N){return N&&"boolean"==typeof N.wasClean&&"number"==typeof N.code}}class _o{constructor(N,W={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,Eo.isRequired(N,"url"),this._logger=function nt(he){return void 0===he?new kt(jt.Information):null===he?ta.instance:void 0!==he.log?he:new kt(he)}(W.logger),this.baseUrl=this._resolveUrl(N),(W=W||{}).logMessageContent=void 0!==W.logMessageContent&&W.logMessageContent,"boolean"!=typeof W.withCredentials&&void 0!==W.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");W.withCredentials=void 0===W.withCredentials||W.withCredentials,W.timeout=void 0===W.timeout?1e5:W.timeout;let re=null,_e=null;zr.isNode&&(re=function ve(){return It(449)}(),_e=function Ce(){return It(194)}()),!zr.isNode&&typeof WebSocket<"u"&&!W.WebSocket?W.WebSocket=WebSocket:zr.isNode&&!W.WebSocket&&re&&(W.WebSocket=re),!zr.isNode&&typeof EventSource<"u"&&!W.EventSource?W.EventSource=EventSource:zr.isNode&&!W.EventSource&&typeof _e<"u"&&(W.EventSource=_e),this._httpClient=new Vn(W.httpClient||new Ht(this._logger),W.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=W,this.onreceive=null,this.onclose=null}start(N){var W=this;return(0,o.A)(function*(){if(Eo.isIn(N=N||gt.Binary,gt,"transferFormat"),W._logger.log(jt.Debug,`Starting connection with transfer format '${gt[N]}'.`),"Disconnected"!==W._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(W._connectionState="Connecting",W._startInternalPromise=W._startInternal(N),yield W._startInternalPromise,"Disconnecting"===W._connectionState){const re="Failed to start the HttpConnection before stop() was called.";return W._logger.log(jt.Error,re),yield W._stopPromise,Promise.reject(new an(re))}if("Connected"!==W._connectionState){const re="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return W._logger.log(jt.Error,re),Promise.reject(new an(re))}W._connectionStarted=!0})()}send(N){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new Tr(this.transport)),this._sendQueue.send(N))}stop(N){var W=this;return(0,o.A)(function*(){return"Disconnected"===W._connectionState?(W._logger.log(jt.Debug,`Call to HttpConnection.stop(${N}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===W._connectionState?(W._logger.log(jt.Debug,`Call to HttpConnection.stop(${N}) ignored because the connection is already in the disconnecting state.`),W._stopPromise):(W._connectionState="Disconnecting",W._stopPromise=new Promise(re=>{W._stopPromiseResolver=re}),yield W._stopInternal(N),void(yield W._stopPromise))})()}_stopInternal(N){var W=this;return(0,o.A)(function*(){W._stopError=N;try{yield W._startInternalPromise}catch{}if(W.transport){try{yield W.transport.stop()}catch(re){W._logger.log(jt.Error,`HttpConnection.transport.stop() threw error '${re}'.`),W._stopConnection()}W.transport=void 0}else W._logger.log(jt.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")})()}_startInternal(N){var W=this;return(0,o.A)(function*(){let re=W.baseUrl;W._accessTokenFactory=W._options.accessTokenFactory,W._httpClient._accessTokenFactory=W._accessTokenFactory;try{if(W._options.skipNegotiation){if(W._options.transport!==hi.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");W.transport=W._constructTransport(hi.WebSockets),yield W._startTransport(re,N)}else{let _e=null,Ie=0;do{if(_e=yield W._getNegotiationResponse(re),"Disconnecting"===W._connectionState||"Disconnected"===W._connectionState)throw new an("The connection was stopped during negotiation.");if(_e.error)throw new Error(_e.error);if(_e.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(_e.url&&(re=_e.url),_e.accessToken){const $e=_e.accessToken;W._accessTokenFactory=()=>$e,W._httpClient._accessToken=$e,W._httpClient._accessTokenFactory=void 0}Ie++}while(_e.url&&Ie<100);if(100===Ie&&_e.url)throw new Error("Negotiate redirection limit exceeded.");yield W._createTransport(re,W._options.transport,_e,N)}W.transport instanceof wi&&(W.features.inherentKeepAlive=!0),"Connecting"===W._connectionState&&(W._logger.log(jt.Debug,"The HttpConnection connected successfully."),W._connectionState="Connected")}catch(_e){return W._logger.log(jt.Error,"Failed to start the connection: "+_e),W._connectionState="Disconnected",W.transport=void 0,W._stopPromiseResolver(),Promise.reject(_e)}})()}_getNegotiationResponse(N){var W=this;return(0,o.A)(function*(){const re={},[_e,Ie]=qt();re[_e]=Ie;const $e=W._resolveNegotiateUrl(N);W._logger.log(jt.Debug,`Sending negotiation request: ${$e}.`);try{const Ue=yield W._httpClient.post($e,{content:"",headers:{...re,...W._options.headers},timeout:W._options.timeout,withCredentials:W._options.withCredentials});if(200!==Ue.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${Ue.statusCode}'`));const Ct=JSON.parse(Ue.content);return(!Ct.negotiateVersion||Ct.negotiateVersion<1)&&(Ct.connectionToken=Ct.connectionId),Ct.useStatefulReconnect&&!0!==W._options._useStatefulReconnect?Promise.reject(new as("Client didn't negotiate Stateful Reconnect but the server did.")):Ct}catch(Ue){let Ct="Failed to complete negotiation with the server: "+Ue;return Ue instanceof yn&&404===Ue.statusCode&&(Ct+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),W._logger.log(jt.Error,Ct),Promise.reject(new as(Ct))}})()}_createConnectUrl(N,W){return W?N+(-1===N.indexOf("?")?"?":"&")+`id=${W}`:N}_createTransport(N,W,re,_e){var Ie=this;return(0,o.A)(function*(){let $e=Ie._createConnectUrl(N,re.connectionToken);if(Ie._isITransport(W))return Ie._logger.log(jt.Debug,"Connection was provided an instance of ITransport, using that directly."),Ie.transport=W,yield Ie._startTransport($e,_e),void(Ie.connectionId=re.connectionId);const Ue=[],Ct=re.availableTransports||[];let zt=re;for(const li of Ct){const Ln=Ie._resolveTransportOrError(li,W,_e,!0===zt?.useStatefulReconnect);if(Ln instanceof Error)Ue.push(`${li.transport} failed:`),Ue.push(Ln);else if(Ie._isITransport(Ln)){if(Ie.transport=Ln,!zt){try{zt=yield Ie._getNegotiationResponse(N)}catch(En){return Promise.reject(En)}$e=Ie._createConnectUrl(N,zt.connectionToken)}try{return yield Ie._startTransport($e,_e),void(Ie.connectionId=zt.connectionId)}catch(En){if(Ie._logger.log(jt.Error,`Failed to start the transport '${li.transport}': ${En}`),zt=void 0,Ue.push(new Hr(`${li.transport} failed: ${En}`,hi[li.transport])),"Connecting"!==Ie._connectionState){const Wn="Failed to select transport before stop() was called.";return Ie._logger.log(jt.Debug,Wn),Promise.reject(new an(Wn))}}}}return Promise.reject(Ue.length>0?new va(`Unable to connect to the server with any of the available transports. ${Ue.join(" ")}`,Ue):new Error("None of the transports supported by the client are supported by the server."))})()}_constructTransport(N){switch(N){case hi.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new jn(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case hi.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new $i(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case hi.LongPolling:return new wi(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${N}.`)}}_startTransport(N,W){var re=this;return this.transport.onreceive=this.onreceive,this.transport.onclose=this.features.reconnect?function(){var _e=(0,o.A)(function*(Ie){let $e=!1;if(re.features.reconnect){try{re.features.disconnected(),yield re.transport.connect(N,W),yield re.features.resend()}catch{$e=!0}$e&&re._stopConnection(Ie)}else re._stopConnection(Ie)});return function(Ie){return _e.apply(this,arguments)}}():_e=>this._stopConnection(_e),this.transport.connect(N,W)}_resolveTransportOrError(N,W,re,_e){const Ie=hi[N.transport];if(null==Ie)return this._logger.log(jt.Debug,`Skipping transport '${N.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${N.transport}' because it is not supported by this client.`);if(!function Pn(he,N){return!he||!!(N&he)}(W,Ie))return this._logger.log(jt.Debug,`Skipping transport '${hi[Ie]}' because it was disabled by the client.`),new uo(`'${hi[Ie]}' is disabled by the client.`,Ie);if(!(N.transferFormats.map(Ue=>gt[Ue]).indexOf(re)>=0))return this._logger.log(jt.Debug,`Skipping transport '${hi[Ie]}' because it does not support the requested transfer format '${gt[re]}'.`),new Error(`'${hi[Ie]}' does not support ${gt[re]}.`);if(Ie===hi.WebSockets&&!this._options.WebSocket||Ie===hi.ServerSentEvents&&!this._options.EventSource)return this._logger.log(jt.Debug,`Skipping transport '${hi[Ie]}' because it is not supported in your environment.'`),new Vr(`'${hi[Ie]}' is not supported in your environment.`,Ie);this._logger.log(jt.Debug,`Selecting transport '${hi[Ie]}'.`);try{return this.features.reconnect=Ie===hi.WebSockets?_e:void 0,this._constructTransport(Ie)}catch(Ue){return Ue}}_isITransport(N){return N&&"object"==typeof N&&"connect"in N}_stopConnection(N){if(this._logger.log(jt.Debug,`HttpConnection.stopConnection(${N}) called while in state ${this._connectionState}.`),this.transport=void 0,N=this._stopError||N,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(jt.Warning,`Call to HttpConnection.stopConnection(${N}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${N}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),N?this._logger.log(jt.Error,`Connection disconnected with error '${N}'.`):this._logger.log(jt.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(W=>{this._logger.log(jt.Error,`TransportSendQueue.stop() threw error '${W}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(N)}catch(W){this._logger.log(jt.Error,`HttpConnection.onclose(${N}) threw error '${W}'.`)}}}else this._logger.log(jt.Debug,`Call to HttpConnection.stopConnection(${N}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(N){if(0===N.lastIndexOf("https://",0)||0===N.lastIndexOf("http://",0))return N;if(!zr.isBrowser)throw new Error(`Cannot resolve '${N}'.`);const W=window.document.createElement("a");return W.href=N,this._logger.log(jt.Information,`Normalizing '${N}' to '${W.href}'.`),W.href}_resolveNegotiateUrl(N){const W=new URL(N);W.pathname.endsWith("/")?W.pathname+="negotiate":W.pathname+="/negotiate";const re=new URLSearchParams(W.searchParams);return re.has("negotiateVersion")||re.append("negotiateVersion",this._negotiateVersion.toString()),re.has("useStatefulReconnect")?"true"===re.get("useStatefulReconnect")&&(this._options._useStatefulReconnect=!0):!0===this._options._useStatefulReconnect&&re.append("useStatefulReconnect","true"),W.search=re.toString(),W.toString()}}class Tr{constructor(N){this._transport=N,this._buffer=[],this._executing=!0,this._sendBufferedData=new cr,this._transportResult=new cr,this._sendLoopPromise=this._sendLoop()}send(N){return this._bufferData(N),this._transportResult||(this._transportResult=new cr),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(N){if(this._buffer.length&&typeof this._buffer[0]!=typeof N)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof N}`);this._buffer.push(N),this._sendBufferedData.resolve()}_sendLoop(){var N=this;return(0,o.A)(function*(){for(;;){if(yield N._sendBufferedData.promise,!N._executing){N._transportResult&&N._transportResult.reject("Connection stopped.");break}N._sendBufferedData=new cr;const W=N._transportResult;N._transportResult=void 0;const re="string"==typeof N._buffer[0]?N._buffer.join(""):Tr._concatBuffers(N._buffer);N._buffer.length=0;try{yield N._transport.send(re),W.resolve()}catch(_e){W.reject(_e)}}})()}static _concatBuffers(N){const W=N.map(Ie=>Ie.byteLength).reduce((Ie,$e)=>Ie+$e),re=new Uint8Array(W);let _e=0;for(const Ie of N)re.set(new Uint8Array(Ie),_e),_e+=Ie.byteLength;return re.buffer}}class cr{constructor(){this.promise=new Promise((N,W)=>[this._resolver,this._rejecter]=[N,W])}resolve(){this._resolver()}reject(N){this._rejecter(N)}}class kn{static write(N){return`${N}${kn.RecordSeparator}`}static parse(N){if(N[N.length-1]!==kn.RecordSeparator)throw new Error("Message is incomplete.");const W=N.split(kn.RecordSeparator);return W.pop(),W}}kn.RecordSeparatorCode=30,kn.RecordSeparator=String.fromCharCode(kn.RecordSeparatorCode);class Xr{writeHandshakeRequest(N){return kn.write(JSON.stringify(N))}parseHandshakeResponse(N){let W,re;if(io(N)){const Ue=new Uint8Array(N),Ct=Ue.indexOf(kn.RecordSeparatorCode);if(-1===Ct)throw new Error("Message is incomplete.");const zt=Ct+1;W=String.fromCharCode.apply(null,Array.prototype.slice.call(Ue.slice(0,zt))),re=Ue.byteLength>zt?Ue.slice(zt).buffer:null}else{const Ue=N,Ct=Ue.indexOf(kn.RecordSeparator);if(-1===Ct)throw new Error("Message is incomplete.");const zt=Ct+1;W=Ue.substring(0,zt),re=Ue.length>zt?Ue.substring(zt):null}const _e=kn.parse(W),Ie=JSON.parse(_e[0]);if(Ie.type)throw new Error("Expected a handshake response from the server.");return[re,Ie]}}var gi=function(he){return he[he.Invocation=1]="Invocation",he[he.StreamItem=2]="StreamItem",he[he.Completion=3]="Completion",he[he.StreamInvocation=4]="StreamInvocation",he[he.CancelInvocation=5]="CancelInvocation",he[he.Ping=6]="Ping",he[he.Close=7]="Close",he[he.Ack=8]="Ack",he[he.Sequence=9]="Sequence",he}(gi||{});class di{constructor(){this.observers=[]}next(N){for(const W of this.observers)W.next(N)}error(N){for(const W of this.observers)W.error&&W.error(N)}complete(){for(const N of this.observers)N.complete&&N.complete()}subscribe(N){return this.observers.push(N),new Xt(this,N)}}class ro{constructor(N,W,re){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=N,this._connection=W,this._bufferSize=re}_send(N){var W=this;return(0,o.A)(function*(){const re=W._protocol.writeMessage(N);let _e=Promise.resolve();if(W._isInvocationMessage(N)){W._totalMessageCount++;let Ie=()=>{},$e=()=>{};io(re)?W._bufferedByteCount+=re.byteLength:W._bufferedByteCount+=re.length,W._bufferedByteCount>=W._bufferSize&&(_e=new Promise((Ue,Ct)=>{Ie=Ue,$e=Ct})),W._messages.push(new Hs(re,W._totalMessageCount,Ie,$e))}try{W._reconnectInProgress||(yield W._connection.send(re))}catch{W._disconnected()}yield _e})()}_ack(N){let W=-1;for(let re=0;re<this._messages.length;re++){const _e=this._messages[re];if(_e._id<=N.sequenceId)W=re,io(_e._message)?this._bufferedByteCount-=_e._message.byteLength:this._bufferedByteCount-=_e._message.length,_e._resolver();else{if(!(this._bufferedByteCount<this._bufferSize))break;_e._resolver()}}-1!==W&&(this._messages=this._messages.slice(W+1))}_shouldProcessMessage(N){if(this._waitForSequenceMessage)return N.type===gi.Sequence&&(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(N))return!0;const W=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,W<=this._latestReceivedSequenceId?(W===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=W,this._ackTimer(),!0)}_resetSequence(N){N.sequenceId>this._nextReceivingSequenceId?this._connection.stop(new Error("Sequence ID greater than amount of messages we've received.")):this._nextReceivingSequenceId=N.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}_resend(){var N=this;return(0,o.A)(function*(){const W=0!==N._messages.length?N._messages[0]._id:N._totalMessageCount+1;yield N._connection.send(N._protocol.writeMessage({type:gi.Sequence,sequenceId:W}));const re=N._messages;for(const _e of re)yield N._connection.send(_e._message);N._reconnectInProgress=!1})()}_dispose(N){N??(N=new Error("Unable to reconnect to server."));for(const W of this._messages)W._rejector(N)}_isInvocationMessage(N){switch(N.type){case gi.Invocation:case gi.StreamItem:case gi.Completion:case gi.StreamInvocation:case gi.CancelInvocation:return!0;case gi.Close:case gi.Sequence:case gi.Ping:case gi.Ack:return!1}}_ackTimer(){var N=this;void 0===this._ackTimerHandle&&(this._ackTimerHandle=setTimeout((0,o.A)(function*(){try{N._reconnectInProgress||(yield N._connection.send(N._protocol.writeMessage({type:gi.Ack,sequenceId:N._latestReceivedSequenceId})))}catch{}clearTimeout(N._ackTimerHandle),N._ackTimerHandle=void 0}),1e3))}}class Hs{constructor(N,W,re,_e){this._message=N,this._id=W,this._resolver=re,this._rejector=_e}}var dt=function(he){return he.Disconnected="Disconnected",he.Connecting="Connecting",he.Connected="Connected",he.Disconnecting="Disconnecting",he.Reconnecting="Reconnecting",he}(dt||{});class wt{static create(N,W,re,_e,Ie,$e,Ue){return new wt(N,W,re,_e,Ie,$e,Ue)}constructor(N,W,re,_e,Ie,$e,Ue){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(jt.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},Eo.isRequired(N,"connection"),Eo.isRequired(W,"logger"),Eo.isRequired(re,"protocol"),this.serverTimeoutInMilliseconds=Ie??3e4,this.keepAliveIntervalInMilliseconds=$e??15e3,this._statefulReconnectBufferSize=Ue??1e5,this._logger=W,this._protocol=re,this.connection=N,this._reconnectPolicy=_e,this._handshakeProtocol=new Xr,this.connection.onreceive=Ct=>this._processIncomingData(Ct),this.connection.onclose=Ct=>this._connectionClosed(Ct),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=dt.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:gi.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(N){if(this._connectionState!==dt.Disconnected&&this._connectionState!==dt.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!N)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=N}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}_startWithStateTransitions(){var N=this;return(0,o.A)(function*(){if(N._connectionState!==dt.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));N._connectionState=dt.Connecting,N._logger.log(jt.Debug,"Starting HubConnection.");try{yield N._startInternal(),zr.isBrowser&&window.document.addEventListener("freeze",N._freezeEventListener),N._connectionState=dt.Connected,N._connectionStarted=!0,N._logger.log(jt.Debug,"HubConnection connected successfully.")}catch(W){return N._connectionState=dt.Disconnected,N._logger.log(jt.Debug,`HubConnection failed to start successfully because of error '${W}'.`),Promise.reject(W)}})()}_startInternal(){var N=this;return(0,o.A)(function*(){N._stopDuringStartError=void 0,N._receivedHandshakeResponse=!1;const W=new Promise((re,_e)=>{N._handshakeResolver=re,N._handshakeRejecter=_e});yield N.connection.start(N._protocol.transferFormat);try{let re=N._protocol.version;N.connection.features.reconnect||(re=1);const _e={protocol:N._protocol.name,version:re};if(N._logger.log(jt.Debug,"Sending handshake request."),yield N._sendMessage(N._handshakeProtocol.writeHandshakeRequest(_e)),N._logger.log(jt.Information,`Using HubProtocol '${N._protocol.name}'.`),N._cleanupTimeout(),N._resetTimeoutPeriod(),N._resetKeepAliveInterval(),yield W,N._stopDuringStartError)throw N._stopDuringStartError;!!N.connection.features.reconnect&&(N._messageBuffer=new ro(N._protocol,N.connection,N._statefulReconnectBufferSize),N.connection.features.disconnected=N._messageBuffer._disconnected.bind(N._messageBuffer),N.connection.features.resend=()=>{if(N._messageBuffer)return N._messageBuffer._resend()}),N.connection.features.inherentKeepAlive||(yield N._sendMessage(N._cachedPingMessage))}catch(re){throw N._logger.log(jt.Debug,`Hub handshake failed with error '${re}' during start(). Stopping HubConnection.`),N._cleanupTimeout(),N._cleanupPingTimer(),yield N.connection.stop(re),re}})()}stop(){var N=this;return(0,o.A)(function*(){const W=N._startPromise;N.connection.features.reconnect=!1,N._stopPromise=N._stopInternal(),yield N._stopPromise;try{yield W}catch{}})()}_stopInternal(N){if(this._connectionState===dt.Disconnected)return this._logger.log(jt.Debug,`Call to HubConnection.stop(${N}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===dt.Disconnecting)return this._logger.log(jt.Debug,`Call to HttpConnection.stop(${N}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const W=this._connectionState;return this._connectionState=dt.Disconnecting,this._logger.log(jt.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(jt.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(W===dt.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=N||new an("The connection was stopped before the hub handshake could complete."),this.connection.stop(N))}_sendCloseMessage(){var N=this;return(0,o.A)(function*(){try{yield N._sendWithProtocol(N._createCloseMessage())}catch{}})()}stream(N,...W){const[re,_e]=this._replaceStreamingParams(W),Ie=this._createStreamInvocation(N,W,_e);let $e;const Ue=new di;return Ue.cancelCallback=()=>{const Ct=this._createCancelInvocation(Ie.invocationId);return delete this._callbacks[Ie.invocationId],$e.then(()=>this._sendWithProtocol(Ct))},this._callbacks[Ie.invocationId]=(Ct,zt)=>{zt?Ue.error(zt):Ct&&(Ct.type===gi.Completion?Ct.error?Ue.error(new Error(Ct.error)):Ue.complete():Ue.next(Ct.item))},$e=this._sendWithProtocol(Ie).catch(Ct=>{Ue.error(Ct),delete this._callbacks[Ie.invocationId]}),this._launchStreams(re,$e),Ue}_sendMessage(N){return this._resetKeepAliveInterval(),this.connection.send(N)}_sendWithProtocol(N){return this._messageBuffer?this._messageBuffer._send(N):this._sendMessage(this._protocol.writeMessage(N))}send(N,...W){const[re,_e]=this._replaceStreamingParams(W),Ie=this._sendWithProtocol(this._createInvocation(N,W,!0,_e));return this._launchStreams(re,Ie),Ie}invoke(N,...W){const[re,_e]=this._replaceStreamingParams(W),Ie=this._createInvocation(N,W,!1,_e);return new Promise((Ue,Ct)=>{this._callbacks[Ie.invocationId]=(li,Ln)=>{Ln?Ct(Ln):li&&(li.type===gi.Completion?li.error?Ct(new Error(li.error)):Ue(li.result):Ct(new Error(`Unexpected message type: ${li.type}`)))};const zt=this._sendWithProtocol(Ie).catch(li=>{Ct(li),delete this._callbacks[Ie.invocationId]});this._launchStreams(re,zt)})}on(N,W){!N||!W||(N=N.toLowerCase(),this._methods[N]||(this._methods[N]=[]),-1===this._methods[N].indexOf(W)&&this._methods[N].push(W))}off(N,W){if(!N)return;N=N.toLowerCase();const re=this._methods[N];if(re)if(W){const _e=re.indexOf(W);-1!==_e&&(re.splice(_e,1),0===re.length&&delete this._methods[N])}else delete this._methods[N]}onclose(N){N&&this._closedCallbacks.push(N)}onreconnecting(N){N&&this._reconnectingCallbacks.push(N)}onreconnected(N){N&&this._reconnectedCallbacks.push(N)}_processIncomingData(N){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(N=this._processHandshakeResponse(N),this._receivedHandshakeResponse=!0),N){const W=this._protocol.parseMessages(N,this._logger);for(const re of W)if(!this._messageBuffer||this._messageBuffer._shouldProcessMessage(re))switch(re.type){case gi.Invocation:this._invokeClientMethod(re);break;case gi.StreamItem:case gi.Completion:{const _e=this._callbacks[re.invocationId];if(_e){re.type===gi.Completion&&delete this._callbacks[re.invocationId];try{_e(re)}catch(Ie){this._logger.log(jt.Error,`Stream callback threw error: ${br(Ie)}`)}}break}case gi.Ping:break;case gi.Close:{this._logger.log(jt.Information,"Close message received from server.");const _e=re.error?new Error("Server returned an error on close: "+re.error):void 0;!0===re.allowReconnect?this.connection.stop(_e):this._stopPromise=this._stopInternal(_e);break}case gi.Ack:this._messageBuffer&&this._messageBuffer._ack(re);break;case gi.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(re);break;default:this._logger.log(jt.Warning,`Invalid message type: ${re.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(N){let W,re;try{[re,W]=this._handshakeProtocol.parseHandshakeResponse(N)}catch(_e){const Ie="Error parsing handshake response: "+_e;this._logger.log(jt.Error,Ie);const $e=new Error(Ie);throw this._handshakeRejecter($e),$e}if(W.error){const _e="Server returned handshake error: "+W.error;this._logger.log(jt.Error,_e);const Ie=new Error(_e);throw this._handshakeRejecter(Ie),Ie}return this._logger.log(jt.Debug,"Server handshake complete."),this._handshakeResolver(),re}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){var N=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let W=this._nextKeepAlive-(new Date).getTime();W<0&&(W=0),this._pingServerHandle=setTimeout((0,o.A)(function*(){if(N._connectionState===dt.Connected)try{yield N._sendMessage(N._cachedPingMessage)}catch{N._cleanupPingTimer()}}),W)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(N){var W=this;return(0,o.A)(function*(){const re=N.target.toLowerCase(),_e=W._methods[re];if(!_e)return W._logger.log(jt.Warning,`No client method with the name '${re}' found.`),void(N.invocationId&&(W._logger.log(jt.Warning,`No result given for '${re}' method and invocation ID '${N.invocationId}'.`),yield W._sendWithProtocol(W._createCompletionMessage(N.invocationId,"Client didn't provide a result.",null))));const Ie=_e.slice(),$e=!!N.invocationId;let Ue,Ct,zt;for(const li of Ie)try{const Ln=Ue;Ue=yield li.apply(W,N.arguments),$e&&Ue&&Ln&&(W._logger.log(jt.Error,`Multiple results provided for '${re}'. Sending error to server.`),zt=W._createCompletionMessage(N.invocationId,"Client provided multiple results.",null)),Ct=void 0}catch(Ln){Ct=Ln,W._logger.log(jt.Error,`A callback for the method '${re}' threw error '${Ln}'.`)}zt?yield W._sendWithProtocol(zt):$e?(Ct?zt=W._createCompletionMessage(N.invocationId,`${Ct}`,null):void 0!==Ue?zt=W._createCompletionMessage(N.invocationId,null,Ue):(W._logger.log(jt.Warning,`No result given for '${re}' method and invocation ID '${N.invocationId}'.`),zt=W._createCompletionMessage(N.invocationId,"Client didn't provide a result.",null)),yield W._sendWithProtocol(zt)):Ue&&W._logger.log(jt.Error,`Result given for '${re}' method but server is not expecting a result.`)})()}_connectionClosed(N){this._logger.log(jt.Debug,`HubConnection.connectionClosed(${N}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||N||new an("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(N||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===dt.Disconnecting?this._completeClose(N):this._connectionState===dt.Connected&&this._reconnectPolicy?this._reconnect(N):this._connectionState===dt.Connected&&this._completeClose(N)}_completeClose(N){if(this._connectionStarted){this._connectionState=dt.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(N??new Error("Connection closed.")),this._messageBuffer=void 0),zr.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(W=>W.apply(this,[N]))}catch(W){this._logger.log(jt.Error,`An onclose callback called with error '${N}' threw error '${W}'.`)}}}_reconnect(N){var W=this;return(0,o.A)(function*(){const re=Date.now();let _e=0,Ie=void 0!==N?N:new Error("Attempting to reconnect due to a unknown error."),$e=W._getNextRetryDelay(_e++,0,Ie);if(null===$e)return W._logger.log(jt.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void W._completeClose(N);if(W._connectionState=dt.Reconnecting,W._logger.log(jt.Information,N?`Connection reconnecting because of error '${N}'.`:"Connection reconnecting."),0!==W._reconnectingCallbacks.length){try{W._reconnectingCallbacks.forEach(Ue=>Ue.apply(W,[N]))}catch(Ue){W._logger.log(jt.Error,`An onreconnecting callback called with error '${N}' threw error '${Ue}'.`)}if(W._connectionState!==dt.Reconnecting)return void W._logger.log(jt.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==$e;){if(W._logger.log(jt.Information,`Reconnect attempt number ${_e} will start in ${$e} ms.`),yield new Promise(Ue=>{W._reconnectDelayHandle=setTimeout(Ue,$e)}),W._reconnectDelayHandle=void 0,W._connectionState!==dt.Reconnecting)return void W._logger.log(jt.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(yield W._startInternal(),W._connectionState=dt.Connected,W._logger.log(jt.Information,"HubConnection reconnected successfully."),0!==W._reconnectedCallbacks.length)try{W._reconnectedCallbacks.forEach(Ue=>Ue.apply(W,[W.connection.connectionId]))}catch(Ue){W._logger.log(jt.Error,`An onreconnected callback called with connectionId '${W.connection.connectionId}; threw error '${Ue}'.`)}return}catch(Ue){if(W._logger.log(jt.Information,`Reconnect attempt failed because of error '${Ue}'.`),W._connectionState!==dt.Reconnecting)return W._logger.log(jt.Debug,`Connection moved to the '${W._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(W._connectionState===dt.Disconnecting&&W._completeClose());Ie=Ue instanceof Error?Ue:new Error(Ue.toString()),$e=W._getNextRetryDelay(_e++,Date.now()-re,Ie)}}W._logger.log(jt.Information,`Reconnect retries have been exhausted after ${Date.now()-re} ms and ${_e} failed attempts. Connection disconnecting.`),W._completeClose()})()}_getNextRetryDelay(N,W,re){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:W,previousRetryCount:N,retryReason:re})}catch(_e){return this._logger.log(jt.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${N}, ${W}) threw error '${_e}'.`),null}}_cancelCallbacksWithError(N){const W=this._callbacks;this._callbacks={},Object.keys(W).forEach(re=>{const _e=W[re];try{_e(null,N)}catch(Ie){this._logger.log(jt.Error,`Stream 'error' callback called with '${N}' threw error: ${br(Ie)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(N,W,re,_e){if(re)return 0!==_e.length?{arguments:W,streamIds:_e,target:N,type:gi.Invocation}:{arguments:W,target:N,type:gi.Invocation};{const Ie=this._invocationId;return this._invocationId++,0!==_e.length?{arguments:W,invocationId:Ie.toString(),streamIds:_e,target:N,type:gi.Invocation}:{arguments:W,invocationId:Ie.toString(),target:N,type:gi.Invocation}}}_launchStreams(N,W){if(0!==N.length){W||(W=Promise.resolve());for(const re in N)N[re].subscribe({complete:()=>{W=W.then(()=>this._sendWithProtocol(this._createCompletionMessage(re)))},error:_e=>{let Ie;Ie=_e instanceof Error?_e.message:_e&&_e.toString?_e.toString():"Unknown error",W=W.then(()=>this._sendWithProtocol(this._createCompletionMessage(re,Ie)))},next:_e=>{W=W.then(()=>this._sendWithProtocol(this._createStreamItemMessage(re,_e)))}})}}_replaceStreamingParams(N){const W=[],re=[];for(let _e=0;_e<N.length;_e++){const Ie=N[_e];if(this._isObservable(Ie)){const $e=this._invocationId;this._invocationId++,W[$e]=Ie,re.push($e.toString()),N.splice(_e,1)}}return[W,re]}_isObservable(N){return N&&N.subscribe&&"function"==typeof N.subscribe}_createStreamInvocation(N,W,re){const _e=this._invocationId;return this._invocationId++,0!==re.length?{arguments:W,invocationId:_e.toString(),streamIds:re,target:N,type:gi.StreamInvocation}:{arguments:W,invocationId:_e.toString(),target:N,type:gi.StreamInvocation}}_createCancelInvocation(N){return{invocationId:N,type:gi.CancelInvocation}}_createStreamItemMessage(N,W){return{invocationId:N,item:W,type:gi.StreamItem}}_createCompletionMessage(N,W,re){return W?{error:W,invocationId:N,type:gi.Completion}:{invocationId:N,result:re,type:gi.Completion}}_createCloseMessage(){return{type:gi.Close}}}class st{constructor(){this.name="json",this.version=2,this.transferFormat=gt.Text}parseMessages(N,W){if("string"!=typeof N)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!N)return[];null===W&&(W=ta.instance);const re=kn.parse(N),_e=[];for(const Ie of re){const $e=JSON.parse(Ie);if("number"!=typeof $e.type)throw new Error("Invalid payload.");switch($e.type){case gi.Invocation:this._isInvocationMessage($e);break;case gi.StreamItem:this._isStreamItemMessage($e);break;case gi.Completion:this._isCompletionMessage($e);break;case gi.Ping:case gi.Close:break;case gi.Ack:this._isAckMessage($e);break;case gi.Sequence:this._isSequenceMessage($e);break;default:W.log(jt.Information,"Unknown message type '"+$e.type+"' ignored.");continue}_e.push($e)}return _e}writeMessage(N){return kn.write(JSON.stringify(N))}_isInvocationMessage(N){this._assertNotEmptyString(N.target,"Invalid payload for Invocation message."),void 0!==N.invocationId&&this._assertNotEmptyString(N.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(N){if(this._assertNotEmptyString(N.invocationId,"Invalid payload for StreamItem message."),void 0===N.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(N){if(N.result&&N.error)throw new Error("Invalid payload for Completion message.");!N.result&&N.error&&this._assertNotEmptyString(N.error,"Invalid payload for Completion message."),this._assertNotEmptyString(N.invocationId,"Invalid payload for Completion message.")}_isAckMessage(N){if("number"!=typeof N.sequenceId)throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(N){if("number"!=typeof N.sequenceId)throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(N,W){if("string"!=typeof N||""===N)throw new Error(W)}}const ei={trace:jt.Trace,debug:jt.Debug,info:jt.Information,information:jt.Information,warn:jt.Warning,warning:jt.Warning,error:jt.Error,critical:jt.Critical,none:jt.None};class ai{configureLogging(N){if(Eo.isRequired(N,"logging"),function Zt(he){return void 0!==he.log}(N))this.logger=N;else if("string"==typeof N){const W=function si(he){const N=ei[he.toLowerCase()];if(typeof N<"u")return N;throw new Error(`Unknown log level: ${he}`)}(N);this.logger=new kt(W)}else this.logger=new kt(N);return this}withUrl(N,W){return Eo.isRequired(N,"url"),Eo.isNotEmpty(N,"url"),this.url=N,this.httpConnectionOptions="object"==typeof W?{...this.httpConnectionOptions,...W}:{...this.httpConnectionOptions,transport:W},this}withHubProtocol(N){return Eo.isRequired(N,"protocol"),this.protocol=N,this}withAutomaticReconnect(N){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return this.reconnectPolicy=N?Array.isArray(N)?new mi(N):N:new mi,this}withServerTimeout(N){return Eo.isRequired(N,"milliseconds"),this._serverTimeoutInMilliseconds=N,this}withKeepAliveInterval(N){return Eo.isRequired(N,"milliseconds"),this._keepAliveIntervalInMilliseconds=N,this}withStatefulReconnect(N){return void 0===this.httpConnectionOptions&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=N?.bufferSize,this}build(){const N=this.httpConnectionOptions||{};if(void 0===N.logger&&(N.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const W=new _o(this.url,N);return wt.create(W,this.logger||ta.instance,this.protocol||new st,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}var ri=4294967295;function sn(he,N,W){var re=Math.floor(W/4294967296),_e=W;he.setUint32(N,re),he.setUint32(N+4,_e)}function Zn(he,N){return 4294967296*he.getInt32(N)+he.getUint32(N+4)}var Kr,hr,Qr,ho=(typeof process>"u"||"never"!==(null===(Kr=null==process?void 0:process.env)||void 0===Kr?void 0:Kr.TEXT_ENCODING))&&typeof TextEncoder<"u"&&typeof TextDecoder<"u";function bo(he){for(var N=he.length,W=0,re=0;re<N;){var _e=he.charCodeAt(re++);if(4294967168&_e)if(4294965248&_e){if(_e>=55296&&_e<=56319&&re<N){var Ie=he.charCodeAt(re);56320==(64512&Ie)&&(++re,_e=((1023&_e)<<10)+(1023&Ie)+65536)}W+=4294901760&_e?4:3}else W+=2;else W++}return W}var Ss=ho?new TextEncoder:void 0,$s=ho?typeof process<"u"&&"force"!==(null===(hr=null==process?void 0:process.env)||void 0===hr?void 0:hr.TEXT_ENCODING)?200:0:ri,Ka=Ss?.encodeInto?function gh(he,N,W){Ss.encodeInto(he,N.subarray(W))}:function nr(he,N,W){N.set(Ss.encode(he),W)};function bl(he,N,W){for(var re=N,_e=re+W,Ie=[],$e="";re<_e;){var Ue=he[re++];if(128&Ue)if(192==(224&Ue)){var Ct=63&he[re++];Ie.push((31&Ue)<<6|Ct)}else if(224==(240&Ue)){Ct=63&he[re++];var zt=63&he[re++];Ie.push((31&Ue)<<12|Ct<<6|zt)}else if(240==(248&Ue)){var Ln=(7&Ue)<<18|(Ct=63&he[re++])<<12|(zt=63&he[re++])<<6|63&he[re++];Ln>65535&&(Ie.push((Ln-=65536)>>>10&1023|55296),Ln=56320|1023&Ln),Ie.push(Ln)}else Ie.push(Ue);else Ie.push(Ue);Ie.length>=4096&&($e+=String.fromCharCode.apply(String,Ie),Ie.length=0)}return Ie.length>0&&($e+=String.fromCharCode.apply(String,Ie)),$e}var Ps=ho?new TextDecoder:null,xi=ho?typeof process<"u"&&"force"!==(null===(Qr=null==process?void 0:process.env)||void 0===Qr?void 0:Qr.TEXT_DECODER)?200:0:ri,rs=function(){return function he(N,W){this.type=N,this.data=W}}(),Ua=function(){var he=function(N,W){return(he=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(re,_e){re.__proto__=_e}||function(re,_e){for(var Ie in _e)Object.prototype.hasOwnProperty.call(_e,Ie)&&(re[Ie]=_e[Ie])})(N,W)};return function(N,W){if("function"!=typeof W&&null!==W)throw new TypeError("Class extends value "+String(W)+" is not a constructor or null");function re(){this.constructor=N}he(N,W),N.prototype=null===W?Object.create(W):(re.prototype=W.prototype,new re)}}(),Ta=function(he){function N(W){var re=he.call(this,W)||this,_e=Object.create(N.prototype);return Object.setPrototypeOf(re,_e),Object.defineProperty(re,"name",{configurable:!0,enumerable:!1,value:N.name}),re}return Ua(N,he),N}(Error),yl={type:-1,encode:function id(he){if(he instanceof Date){var N=function rr(he){var N=he.getTime(),W=Math.floor(N/1e3),re=1e6*(N-1e3*W),_e=Math.floor(re/1e9);return{sec:W+_e,nsec:re-1e9*_e}}(he);return function Vo(he){var _e,N=he.sec,W=he.nsec;if(N>=0&&W>=0&&N<=17179869183){if(0===W&&N<=4294967295){var re=new Uint8Array(4);return(_e=new DataView(re.buffer)).setUint32(0,N),re}var Ie=N/4294967296,$e=4294967295&N;return re=new Uint8Array(8),(_e=new DataView(re.buffer)).setUint32(0,W<<2|3&Ie),_e.setUint32(4,$e),re}return re=new Uint8Array(12),(_e=new DataView(re.buffer)).setUint32(0,W),sn(_e,4,N),re}(N)}return null},decode:function Sa(he){var N=function Ic(he){var N=new DataView(he.buffer,he.byteOffset,he.byteLength);switch(he.byteLength){case 4:return{sec:N.getUint32(0),nsec:0};case 8:var _e=N.getUint32(0);return{sec:4294967296*(3&_e)+N.getUint32(4),nsec:_e>>>2};case 12:return{sec:Zn(N,4),nsec:N.getUint32(0)};default:throw new Ta("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(he.length))}}(he);return new Date(1e3*N.sec+N.nsec/1e6)}},Os=function(){function he(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(yl)}return he.prototype.register=function(N){var W=N.type,re=N.encode,_e=N.decode;if(W>=0)this.encoders[W]=re,this.decoders[W]=_e;else{var Ie=1+W;this.builtInEncoders[Ie]=re,this.builtInDecoders[Ie]=_e}},he.prototype.tryToEncode=function(N,W){for(var re=0;re<this.builtInEncoders.length;re++)if(null!=(_e=this.builtInEncoders[re])&&null!=(Ie=_e(N,W)))return new rs(-1-re,Ie);for(re=0;re<this.encoders.length;re++){var _e,Ie;if(null!=(_e=this.encoders[re])&&null!=(Ie=_e(N,W)))return new rs(re,Ie)}return N instanceof rs?N:null},he.prototype.decode=function(N,W,re){var _e=W<0?this.builtInDecoders[-1-W]:this.decoders[W];return _e?_e(N,W,re):new rs(W,N)},he.defaultCodec=new he,he}();function Rc(he){return he instanceof Uint8Array?he:ArrayBuffer.isView(he)?new Uint8Array(he.buffer,he.byteOffset,he.byteLength):he instanceof ArrayBuffer?new Uint8Array(he):Uint8Array.from(he)}var Or=function(){function he(N,W,re,_e,Ie,$e,Ue,Ct){void 0===N&&(N=Os.defaultCodec),void 0===W&&(W=void 0),void 0===re&&(re=100),void 0===_e&&(_e=2048),void 0===Ie&&(Ie=!1),void 0===$e&&($e=!1),void 0===Ue&&(Ue=!1),void 0===Ct&&(Ct=!1),this.extensionCodec=N,this.context=W,this.maxDepth=re,this.initialBufferSize=_e,this.sortKeys=Ie,this.forceFloat32=$e,this.ignoreUndefined=Ue,this.forceIntegerToFloat=Ct,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return he.prototype.reinitializeState=function(){this.pos=0},he.prototype.encodeSharedRef=function(N){return this.reinitializeState(),this.doEncode(N,1),this.bytes.subarray(0,this.pos)},he.prototype.encode=function(N){return this.reinitializeState(),this.doEncode(N,1),this.bytes.slice(0,this.pos)},he.prototype.doEncode=function(N,W){if(W>this.maxDepth)throw new Error("Too deep objects in depth ".concat(W));null==N?this.encodeNil():"boolean"==typeof N?this.encodeBoolean(N):"number"==typeof N?this.encodeNumber(N):"string"==typeof N?this.encodeString(N):this.encodeObject(N,W)},he.prototype.ensureBufferSizeToWrite=function(N){var W=this.pos+N;this.view.byteLength<W&&this.resizeBuffer(2*W)},he.prototype.resizeBuffer=function(N){var W=new ArrayBuffer(N),re=new Uint8Array(W),_e=new DataView(W);re.set(this.bytes),this.view=_e,this.bytes=re},he.prototype.encodeNil=function(){this.writeU8(192)},he.prototype.encodeBoolean=function(N){this.writeU8(!1===N?194:195)},he.prototype.encodeNumber=function(N){Number.isSafeInteger(N)&&!this.forceIntegerToFloat?N>=0?N<128?this.writeU8(N):N<256?(this.writeU8(204),this.writeU8(N)):N<65536?(this.writeU8(205),this.writeU16(N)):N<4294967296?(this.writeU8(206),this.writeU32(N)):(this.writeU8(207),this.writeU64(N)):N>=-32?this.writeU8(224|N+32):N>=-128?(this.writeU8(208),this.writeI8(N)):N>=-32768?(this.writeU8(209),this.writeI16(N)):N>=-2147483648?(this.writeU8(210),this.writeI32(N)):(this.writeU8(211),this.writeI64(N)):this.forceFloat32?(this.writeU8(202),this.writeF32(N)):(this.writeU8(203),this.writeF64(N))},he.prototype.writeStringHeader=function(N){if(N<32)this.writeU8(160+N);else if(N<256)this.writeU8(217),this.writeU8(N);else if(N<65536)this.writeU8(218),this.writeU16(N);else{if(!(N<4294967296))throw new Error("Too long string: ".concat(N," bytes in UTF-8"));this.writeU8(219),this.writeU32(N)}},he.prototype.encodeString=function(N){if(N.length>$s){var _e=bo(N);this.ensureBufferSizeToWrite(5+_e),this.writeStringHeader(_e),Ka(N,this.bytes,this.pos),this.pos+=_e}else _e=bo(N),this.ensureBufferSizeToWrite(5+_e),this.writeStringHeader(_e),function ir(he,N,W){for(var re=he.length,_e=W,Ie=0;Ie<re;){var $e=he.charCodeAt(Ie++);if(4294967168&$e){if(4294965248&$e){if($e>=55296&&$e<=56319&&Ie<re){var Ue=he.charCodeAt(Ie);56320==(64512&Ue)&&(++Ie,$e=((1023&$e)<<10)+(1023&Ue)+65536)}4294901760&$e?(N[_e++]=$e>>18&7|240,N[_e++]=$e>>12&63|128,N[_e++]=$e>>6&63|128):(N[_e++]=$e>>12&15|224,N[_e++]=$e>>6&63|128)}else N[_e++]=$e>>6&31|192;N[_e++]=63&$e|128}else N[_e++]=$e}}(N,this.bytes,this.pos),this.pos+=_e},he.prototype.encodeObject=function(N,W){var re=this.extensionCodec.tryToEncode(N,this.context);if(null!=re)this.encodeExtension(re);else if(Array.isArray(N))this.encodeArray(N,W);else if(ArrayBuffer.isView(N))this.encodeBinary(N);else{if("object"!=typeof N)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(N)));this.encodeMap(N,W)}},he.prototype.encodeBinary=function(N){var W=N.byteLength;if(W<256)this.writeU8(196),this.writeU8(W);else if(W<65536)this.writeU8(197),this.writeU16(W);else{if(!(W<4294967296))throw new Error("Too large binary: ".concat(W));this.writeU8(198),this.writeU32(W)}var re=Rc(N);this.writeU8a(re)},he.prototype.encodeArray=function(N,W){var re=N.length;if(re<16)this.writeU8(144+re);else if(re<65536)this.writeU8(220),this.writeU16(re);else{if(!(re<4294967296))throw new Error("Too large array: ".concat(re));this.writeU8(221),this.writeU32(re)}for(var _e=0,Ie=N;_e<Ie.length;_e++)this.doEncode(Ie[_e],W+1)},he.prototype.countWithoutUndefined=function(N,W){for(var re=0,_e=0,Ie=W;_e<Ie.length;_e++)void 0!==N[Ie[_e]]&&re++;return re},he.prototype.encodeMap=function(N,W){var re=Object.keys(N);this.sortKeys&&re.sort();var _e=this.ignoreUndefined?this.countWithoutUndefined(N,re):re.length;if(_e<16)this.writeU8(128+_e);else if(_e<65536)this.writeU8(222),this.writeU16(_e);else{if(!(_e<4294967296))throw new Error("Too large map object: ".concat(_e));this.writeU8(223),this.writeU32(_e)}for(var Ie=0,$e=re;Ie<$e.length;Ie++){var Ue=$e[Ie],Ct=N[Ue];this.ignoreUndefined&&void 0===Ct||(this.encodeString(Ue),this.doEncode(Ct,W+1))}},he.prototype.encodeExtension=function(N){var W=N.data.length;if(1===W)this.writeU8(212);else if(2===W)this.writeU8(213);else if(4===W)this.writeU8(214);else if(8===W)this.writeU8(215);else if(16===W)this.writeU8(216);else if(W<256)this.writeU8(199),this.writeU8(W);else if(W<65536)this.writeU8(200),this.writeU16(W);else{if(!(W<4294967296))throw new Error("Too large extension object: ".concat(W));this.writeU8(201),this.writeU32(W)}this.writeI8(N.type),this.writeU8a(N.data)},he.prototype.writeU8=function(N){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,N),this.pos++},he.prototype.writeU8a=function(N){var W=N.length;this.ensureBufferSizeToWrite(W),this.bytes.set(N,this.pos),this.pos+=W},he.prototype.writeI8=function(N){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,N),this.pos++},he.prototype.writeU16=function(N){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,N),this.pos+=2},he.prototype.writeI16=function(N){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,N),this.pos+=2},he.prototype.writeU32=function(N){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,N),this.pos+=4},he.prototype.writeI32=function(N){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,N),this.pos+=4},he.prototype.writeF32=function(N){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,N),this.pos+=4},he.prototype.writeF64=function(N){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,N),this.pos+=8},he.prototype.writeU64=function(N){this.ensureBufferSizeToWrite(8),function oi(he,N,W){var _e=W;he.setUint32(N,W/4294967296),he.setUint32(N+4,_e)}(this.view,this.pos,N),this.pos+=8},he.prototype.writeI64=function(N){this.ensureBufferSizeToWrite(8),sn(this.view,this.pos,N),this.pos+=8},he}();function wr(he){return"".concat(he<0?"-":"","0x").concat(Math.abs(he).toString(16).padStart(2,"0"))}var Ve=function(){function he(N,W){void 0===N&&(N=16),void 0===W&&(W=16),this.maxKeyLength=N,this.maxLengthPerKey=W,this.hit=0,this.miss=0,this.caches=[];for(var re=0;re<this.maxKeyLength;re++)this.caches.push([])}return he.prototype.canBeCached=function(N){return N>0&&N<=this.maxKeyLength},he.prototype.find=function(N,W,re){e:for(var Ie=0,$e=this.caches[re-1];Ie<$e.length;Ie++){for(var Ue=$e[Ie],Ct=Ue.bytes,zt=0;zt<re;zt++)if(Ct[zt]!==N[W+zt])continue e;return Ue.str}return null},he.prototype.store=function(N,W){var re=this.caches[N.length-1],_e={bytes:N,str:W};re.length>=this.maxLengthPerKey?re[Math.random()*re.length|0]=_e:re.push(_e)},he.prototype.decode=function(N,W,re){var _e=this.find(N,W,re);if(null!=_e)return this.hit++,_e;this.miss++;var Ie=bl(N,W,re),$e=Uint8Array.prototype.slice.call(N,W,W+re);return this.store($e,Ie),Ie},he}(),Qt=function(he,N){var re,_e,Ie,$e,W={label:0,sent:function(){if(1&Ie[0])throw Ie[1];return Ie[1]},trys:[],ops:[]};return $e={next:Ue(0),throw:Ue(1),return:Ue(2)},"function"==typeof Symbol&&($e[Symbol.iterator]=function(){return this}),$e;function Ue(zt){return function(li){return function Ct(zt){if(re)throw new TypeError("Generator is already executing.");for(;W;)try{if(re=1,_e&&(Ie=2&zt[0]?_e.return:zt[0]?_e.throw||((Ie=_e.return)&&Ie.call(_e),0):_e.next)&&!(Ie=Ie.call(_e,zt[1])).done)return Ie;switch(_e=0,Ie&&(zt=[2&zt[0],Ie.value]),zt[0]){case 0:case 1:Ie=zt;break;case 4:return W.label++,{value:zt[1],done:!1};case 5:W.label++,_e=zt[1],zt=[0];continue;case 7:zt=W.ops.pop(),W.trys.pop();continue;default:if(!(Ie=(Ie=W.trys).length>0&&Ie[Ie.length-1])&&(6===zt[0]||2===zt[0])){W=0;continue}if(3===zt[0]&&(!Ie||zt[1]>Ie[0]&&zt[1]<Ie[3])){W.label=zt[1];break}if(6===zt[0]&&W.label<Ie[1]){W.label=Ie[1],Ie=zt;break}if(Ie&&W.label<Ie[2]){W.label=Ie[2],W.ops.push(zt);break}Ie[2]&&W.ops.pop(),W.trys.pop();continue}zt=N.call(he,W)}catch(li){zt=[6,li],_e=0}finally{re=Ie=0}if(5&zt[0])throw zt[1];return{value:zt[0]?zt[1]:void 0,done:!0}}([zt,li])}}},Ei=function(he){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var W,N=he[Symbol.asyncIterator];return N?N.call(he):(he="function"==typeof __values?__values(he):he[Symbol.iterator](),W={},re("next"),re("throw"),re("return"),W[Symbol.asyncIterator]=function(){return this},W);function re(Ie){W[Ie]=he[Ie]&&function($e){return new Promise(function(Ue,Ct){!function _e(Ie,$e,Ue,Ct){Promise.resolve(Ct).then(function(zt){Ie({value:zt,done:Ue})},$e)}(Ue,Ct,($e=he[Ie]($e)).done,$e.value)})}}},fn=function(he){return this instanceof fn?(this.v=he,this):new fn(he)},Pi=function(he){var N=typeof he;return"string"===N||"number"===N},nn=new DataView(new ArrayBuffer(0)),nd=new Uint8Array(nn.buffer),$n=function(){try{nn.getInt8(0)}catch(he){return he.constructor}throw new Error("never reached")}(),jd=new $n("Insufficient data"),Ws=new Ve,rn=function(){function he(N,W,re,_e,Ie,$e,Ue,Ct){void 0===N&&(N=Os.defaultCodec),void 0===W&&(W=void 0),void 0===re&&(re=ri),void 0===_e&&(_e=ri),void 0===Ie&&(Ie=ri),void 0===$e&&($e=ri),void 0===Ue&&(Ue=ri),void 0===Ct&&(Ct=Ws),this.extensionCodec=N,this.context=W,this.maxStrLength=re,this.maxBinLength=_e,this.maxArrayLength=Ie,this.maxMapLength=$e,this.maxExtLength=Ue,this.keyDecoder=Ct,this.totalPos=0,this.pos=0,this.view=nn,this.bytes=nd,this.headByte=-1,this.stack=[]}return he.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},he.prototype.setBuffer=function(N){this.bytes=Rc(N),this.view=function mf(he){if(he instanceof ArrayBuffer)return new DataView(he);var N=Rc(he);return new DataView(N.buffer,N.byteOffset,N.byteLength)}(this.bytes),this.pos=0},he.prototype.appendBuffer=function(N){if(-1!==this.headByte||this.hasRemaining(1)){var W=this.bytes.subarray(this.pos),re=Rc(N),_e=new Uint8Array(W.length+re.length);_e.set(W),_e.set(re,W.length),this.setBuffer(_e)}else this.setBuffer(N)},he.prototype.hasRemaining=function(N){return this.view.byteLength-this.pos>=N},he.prototype.createExtraByteError=function(N){var re=this.view;return new RangeError("Extra ".concat(re.byteLength-this.pos," of ").concat(re.byteLength," byte(s) found at buffer[").concat(N,"]"))},he.prototype.decode=function(N){this.reinitializeState(),this.setBuffer(N);var W=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return W},he.prototype.decodeMulti=function(N){return Qt(this,function(W){switch(W.label){case 0:this.reinitializeState(),this.setBuffer(N),W.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return W.sent(),[3,1];case 3:return[2]}})},he.prototype.decodeAsync=function(N){var W,re,_e,Ie;return function(he,N,W,re){return new(W||(W=Promise))(function(Ie,$e){function Ue(li){try{zt(re.next(li))}catch(Ln){$e(Ln)}}function Ct(li){try{zt(re.throw(li))}catch(Ln){$e(Ln)}}function zt(li){li.done?Ie(li.value):function _e(Ie){return Ie instanceof W?Ie:new W(function($e){$e(Ie)})}(li.value).then(Ue,Ct)}zt((re=re.apply(he,N||[])).next())})}(this,void 0,void 0,function(){var $e,Ue,Ct,zt,li,En,Wn;return Qt(this,function(pr){switch(pr.label){case 0:$e=!1,pr.label=1;case 1:pr.trys.push([1,6,7,12]),W=Ei(N),pr.label=2;case 2:return[4,W.next()];case 3:if((re=pr.sent()).done)return[3,5];if(Ct=re.value,$e)throw this.createExtraByteError(this.totalPos);this.appendBuffer(Ct);try{Ue=this.doDecodeSync(),$e=!0}catch(ys){if(!(ys instanceof $n))throw ys}this.totalPos+=this.pos,pr.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return zt=pr.sent(),_e={error:zt},[3,12];case 7:return pr.trys.push([7,,10,11]),re&&!re.done&&(Ie=W.return)?[4,Ie.call(W)]:[3,9];case 8:pr.sent(),pr.label=9;case 9:return[3,11];case 10:if(_e)throw _e.error;return[7];case 11:return[7];case 12:if($e){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,Ue]}throw En=(li=this).pos,Wn=li.totalPos,new RangeError("Insufficient data in parsing ".concat(wr(li.headByte)," at ").concat(Wn," (").concat(En," in the current buffer)"))}})})},he.prototype.decodeArrayStream=function(N){return this.decodeMultiAsync(N,!0)},he.prototype.decodeStream=function(N){return this.decodeMultiAsync(N,!1)},he.prototype.decodeMultiAsync=function(N,W){return function(he,N,W){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _e,re=W.apply(he,N||[]),Ie=[];return _e={},$e("next"),$e("throw"),$e("return"),_e[Symbol.asyncIterator]=function(){return this},_e;function $e(En){re[En]&&(_e[En]=function(Wn){return new Promise(function(pr,ys){Ie.push([En,Wn,pr,ys])>1||Ue(En,Wn)})})}function Ue(En,Wn){try{!function Ct(En){En.value instanceof fn?Promise.resolve(En.value.v).then(zt,li):Ln(Ie[0][2],En)}(re[En](Wn))}catch(pr){Ln(Ie[0][3],pr)}}function zt(En){Ue("next",En)}function li(En){Ue("throw",En)}function Ln(En,Wn){En(Wn),Ie.shift(),Ie.length&&Ue(Ie[0][0],Ie[0][1])}}(this,arguments,function(){var _e,Ie,$e,Ue,Ct,zt,li,Ln,En;return Qt(this,function(Wn){switch(Wn.label){case 0:_e=W,Ie=-1,Wn.label=1;case 1:Wn.trys.push([1,13,14,19]),$e=Ei(N),Wn.label=2;case 2:return[4,fn($e.next())];case 3:if((Ue=Wn.sent()).done)return[3,12];if(Ct=Ue.value,W&&0===Ie)throw this.createExtraByteError(this.totalPos);this.appendBuffer(Ct),_e&&(Ie=this.readArraySize(),_e=!1,this.complete()),Wn.label=4;case 4:Wn.trys.push([4,9,,10]),Wn.label=5;case 5:return[4,fn(this.doDecodeSync())];case 6:return[4,Wn.sent()];case 7:return Wn.sent(),0==--Ie?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((zt=Wn.sent())instanceof $n))throw zt;return[3,10];case 10:this.totalPos+=this.pos,Wn.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return li=Wn.sent(),Ln={error:li},[3,19];case 14:return Wn.trys.push([14,,17,18]),Ue&&!Ue.done&&(En=$e.return)?[4,fn(En.call($e))]:[3,16];case 15:Wn.sent(),Wn.label=16;case 16:return[3,18];case 17:if(Ln)throw Ln.error;return[7];case 18:return[7];case 19:return[2]}})})},he.prototype.doDecodeSync=function(){e:for(;;){var N=this.readHeadByte(),W=void 0;if(N>=224)W=N-256;else if(N<192)if(N<128)W=N;else if(N<144){if(0!=(re=N-128)){this.pushMapState(re),this.complete();continue e}W={}}else if(N<160){if(0!=(re=N-144)){this.pushArrayState(re),this.complete();continue e}W=[]}else W=this.decodeUtf8String(_e=N-160,0);else if(192===N)W=null;else if(194===N)W=!1;else if(195===N)W=!0;else if(202===N)W=this.readF32();else if(203===N)W=this.readF64();else if(204===N)W=this.readU8();else if(205===N)W=this.readU16();else if(206===N)W=this.readU32();else if(207===N)W=this.readU64();else if(208===N)W=this.readI8();else if(209===N)W=this.readI16();else if(210===N)W=this.readI32();else if(211===N)W=this.readI64();else if(217===N){var _e=this.lookU8();W=this.decodeUtf8String(_e,1)}else if(218===N)_e=this.lookU16(),W=this.decodeUtf8String(_e,2);else if(219===N)_e=this.lookU32(),W=this.decodeUtf8String(_e,4);else if(220===N){if(0!==(re=this.readU16())){this.pushArrayState(re),this.complete();continue e}W=[]}else if(221===N){if(0!==(re=this.readU32())){this.pushArrayState(re),this.complete();continue e}W=[]}else if(222===N){if(0!==(re=this.readU16())){this.pushMapState(re),this.complete();continue e}W={}}else if(223===N){if(0!==(re=this.readU32())){this.pushMapState(re),this.complete();continue e}W={}}else if(196===N){var re=this.lookU8();W=this.decodeBinary(re,1)}else if(197===N)re=this.lookU16(),W=this.decodeBinary(re,2);else if(198===N)re=this.lookU32(),W=this.decodeBinary(re,4);else if(212===N)W=this.decodeExtension(1,0);else if(213===N)W=this.decodeExtension(2,0);else if(214===N)W=this.decodeExtension(4,0);else if(215===N)W=this.decodeExtension(8,0);else if(216===N)W=this.decodeExtension(16,0);else if(199===N)re=this.lookU8(),W=this.decodeExtension(re,1);else if(200===N)re=this.lookU16(),W=this.decodeExtension(re,2);else{if(201!==N)throw new Ta("Unrecognized type byte: ".concat(wr(N)));re=this.lookU32(),W=this.decodeExtension(re,4)}this.complete();for(var Ie=this.stack;Ie.length>0;){var $e=Ie[Ie.length-1];if(0===$e.type){if($e.array[$e.position]=W,$e.position++,$e.position!==$e.size)continue e;Ie.pop(),W=$e.array}else{if(1===$e.type){if(!Pi(W))throw new Ta("The type of key must be string or number but "+typeof W);if("__proto__"===W)throw new Ta("The key __proto__ is not allowed");$e.key=W,$e.type=2;continue e}if($e.map[$e.key]=W,$e.readCount++,$e.readCount!==$e.size){$e.key=null,$e.type=1;continue e}Ie.pop(),W=$e.map}}return W}},he.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},he.prototype.complete=function(){this.headByte=-1},he.prototype.readArraySize=function(){var N=this.readHeadByte();switch(N){case 220:return this.readU16();case 221:return this.readU32();default:if(N<160)return N-144;throw new Ta("Unrecognized array type byte: ".concat(wr(N)))}},he.prototype.pushMapState=function(N){if(N>this.maxMapLength)throw new Ta("Max length exceeded: map length (".concat(N,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:N,key:null,readCount:0,map:{}})},he.prototype.pushArrayState=function(N){if(N>this.maxArrayLength)throw new Ta("Max length exceeded: array length (".concat(N,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:N,array:new Array(N),position:0})},he.prototype.decodeUtf8String=function(N,W){var re;if(N>this.maxStrLength)throw new Ta("Max length exceeded: UTF-8 byte length (".concat(N,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+W+N)throw jd;var Ie,_e=this.pos+W;return Ie=this.stateIsMapKey()&&null!==(re=this.keyDecoder)&&void 0!==re&&re.canBeCached(N)?this.keyDecoder.decode(this.bytes,_e,N):N>xi?function Ea(he,N,W){var re=he.subarray(N,N+W);return Ps.decode(re)}(this.bytes,_e,N):bl(this.bytes,_e,N),this.pos+=W+N,Ie},he.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},he.prototype.decodeBinary=function(N,W){if(N>this.maxBinLength)throw new Ta("Max length exceeded: bin length (".concat(N,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(N+W))throw jd;var re=this.pos+W,_e=this.bytes.subarray(re,re+N);return this.pos+=W+N,_e},he.prototype.decodeExtension=function(N,W){if(N>this.maxExtLength)throw new Ta("Max length exceeded: ext length (".concat(N,") > maxExtLength (").concat(this.maxExtLength,")"));var re=this.view.getInt8(this.pos+W),_e=this.decodeBinary(N,W+1);return this.extensionCodec.decode(_e,re,this.context)},he.prototype.lookU8=function(){return this.view.getUint8(this.pos)},he.prototype.lookU16=function(){return this.view.getUint16(this.pos)},he.prototype.lookU32=function(){return this.view.getUint32(this.pos)},he.prototype.readU8=function(){var N=this.view.getUint8(this.pos);return this.pos++,N},he.prototype.readI8=function(){var N=this.view.getInt8(this.pos);return this.pos++,N},he.prototype.readU16=function(){var N=this.view.getUint16(this.pos);return this.pos+=2,N},he.prototype.readI16=function(){var N=this.view.getInt16(this.pos);return this.pos+=2,N},he.prototype.readU32=function(){var N=this.view.getUint32(this.pos);return this.pos+=4,N},he.prototype.readI32=function(){var N=this.view.getInt32(this.pos);return this.pos+=4,N},he.prototype.readU64=function(){var N=function zi(he,N){return 4294967296*he.getUint32(N)+he.getUint32(N+4)}(this.view,this.pos);return this.pos+=8,N},he.prototype.readI64=function(){var N=Zn(this.view,this.pos);return this.pos+=8,N},he.prototype.readF32=function(){var N=this.view.getFloat32(this.pos);return this.pos+=4,N},he.prototype.readF64=function(){var N=this.view.getFloat64(this.pos);return this.pos+=8,N},he}();class Qa{static write(N){let W=N.byteLength||N.length;const re=[];do{let Ie=127&W;W>>=7,W>0&&(Ie|=128),re.push(Ie)}while(W>0);W=N.byteLength||N.length;const _e=new Uint8Array(re.length+W);return _e.set(re,0),_e.set(N,re.length),_e.buffer}static parse(N){const W=[],re=new Uint8Array(N),Ie=[0,7,14,21,28];for(let $e=0;$e<N.byteLength;){let zt,Ue=0,Ct=0;do{zt=re[$e+Ue],Ct|=(127&zt)<<Ie[Ue],Ue++}while(Ue<Math.min(5,N.byteLength-$e)&&128&zt);if(128&zt&&Ue<5)throw new Error("Cannot read message size.");if(5===Ue&&zt>7)throw new Error("Messages bigger than 2GB are not supported.");if(!(re.byteLength>=$e+Ue+Ct))throw new Error("Incomplete message.");W.push(re.slice?re.slice($e+Ue,$e+Ue+Ct):re.subarray($e+Ue,$e+Ue+Ct)),$e=$e+Ue+Ct}return W}}const cs=new Uint8Array([145,gi.Ping]);class ds{constructor(N){this.name="messagepack",this.version=2,this.transferFormat=gt.Binary,this._errorResult=1,this._voidResult=2,this._nonVoidResult=3,this._encoder=new Or((N=N||{}).extensionCodec,N.context,N.maxDepth,N.initialBufferSize,N.sortKeys,N.forceFloat32,N.ignoreUndefined,N.forceIntegerToFloat),this._decoder=new rn(N.extensionCodec,N.context,N.maxStrLength,N.maxBinLength,N.maxArrayLength,N.maxMapLength,N.maxExtLength)}parseMessages(N,W){if(!function lc(he){return he&&typeof ArrayBuffer<"u"&&(he instanceof ArrayBuffer||he.constructor&&"ArrayBuffer"===he.constructor.name)}(N))throw new Error("Invalid input for MessagePack hub protocol. Expected an ArrayBuffer.");null===W&&(W=ta.instance);const re=Qa.parse(N),_e=[];for(const Ie of re){const $e=this._parseMessage(Ie,W);$e&&_e.push($e)}return _e}writeMessage(N){switch(N.type){case gi.Invocation:return this._writeInvocation(N);case gi.StreamInvocation:return this._writeStreamInvocation(N);case gi.StreamItem:return this._writeStreamItem(N);case gi.Completion:return this._writeCompletion(N);case gi.Ping:return Qa.write(cs);case gi.CancelInvocation:return this._writeCancelInvocation(N);case gi.Close:return this._writeClose();case gi.Ack:return this._writeAck(N);case gi.Sequence:return this._writeSequence(N);default:throw new Error("Invalid message type.")}}_parseMessage(N,W){if(0===N.length)throw new Error("Invalid payload.");const re=this._decoder.decode(N);if(0===re.length||!(re instanceof Array))throw new Error("Invalid payload.");const _e=re[0];switch(_e){case gi.Invocation:return this._createInvocationMessage(this._readHeaders(re),re);case gi.StreamItem:return this._createStreamItemMessage(this._readHeaders(re),re);case gi.Completion:return this._createCompletionMessage(this._readHeaders(re),re);case gi.Ping:return this._createPingMessage(re);case gi.Close:return this._createCloseMessage(re);case gi.Ack:return this._createAckMessage(re);case gi.Sequence:return this._createSequenceMessage(re);default:return W.log(jt.Information,"Unknown message type '"+_e+"' ignored."),null}}_createCloseMessage(N){if(N.length<2)throw new Error("Invalid payload for Close message.");return{allowReconnect:N.length>=3?N[2]:void 0,error:N[1],type:gi.Close}}_createPingMessage(N){if(N.length<1)throw new Error("Invalid payload for Ping message.");return{type:gi.Ping}}_createInvocationMessage(N,W){if(W.length<5)throw new Error("Invalid payload for Invocation message.");const re=W[2];return re?{arguments:W[4],headers:N,invocationId:re,streamIds:[],target:W[3],type:gi.Invocation}:{arguments:W[4],headers:N,streamIds:[],target:W[3],type:gi.Invocation}}_createStreamItemMessage(N,W){if(W.length<4)throw new Error("Invalid payload for StreamItem message.");return{headers:N,invocationId:W[2],item:W[3],type:gi.StreamItem}}_createCompletionMessage(N,W){if(W.length<4)throw new Error("Invalid payload for Completion message.");const re=W[3];if(re!==this._voidResult&&W.length<5)throw new Error("Invalid payload for Completion message.");let _e,Ie;switch(re){case this._errorResult:_e=W[4];break;case this._nonVoidResult:Ie=W[4]}return{error:_e,headers:N,invocationId:W[2],result:Ie,type:gi.Completion}}_createAckMessage(N){if(N.length<1)throw new Error("Invalid payload for Ack message.");return{sequenceId:N[1],type:gi.Ack}}_createSequenceMessage(N){if(N.length<1)throw new Error("Invalid payload for Sequence message.");return{sequenceId:N[1],type:gi.Sequence}}_writeInvocation(N){let W;return W=this._encoder.encode(N.streamIds?[gi.Invocation,N.headers||{},N.invocationId||null,N.target,N.arguments,N.streamIds]:[gi.Invocation,N.headers||{},N.invocationId||null,N.target,N.arguments]),Qa.write(W.slice())}_writeStreamInvocation(N){let W;return W=this._encoder.encode(N.streamIds?[gi.StreamInvocation,N.headers||{},N.invocationId,N.target,N.arguments,N.streamIds]:[gi.StreamInvocation,N.headers||{},N.invocationId,N.target,N.arguments]),Qa.write(W.slice())}_writeStreamItem(N){const W=this._encoder.encode([gi.StreamItem,N.headers||{},N.invocationId,N.item]);return Qa.write(W.slice())}_writeCompletion(N){const W=N.error?this._errorResult:void 0!==N.result?this._nonVoidResult:this._voidResult;let re;switch(W){case this._errorResult:re=this._encoder.encode([gi.Completion,N.headers||{},N.invocationId,W,N.error]);break;case this._voidResult:re=this._encoder.encode([gi.Completion,N.headers||{},N.invocationId,W]);break;case this._nonVoidResult:re=this._encoder.encode([gi.Completion,N.headers||{},N.invocationId,W,N.result])}return Qa.write(re.slice())}_writeCancelInvocation(N){const W=this._encoder.encode([gi.CancelInvocation,N.headers||{},N.invocationId]);return Qa.write(W.slice())}_writeClose(){const N=this._encoder.encode([gi.Close,null]);return Qa.write(N.slice())}_writeAck(N){const W=this._encoder.encode([gi.Ack,N.sequenceId]);return Qa.write(W.slice())}_writeSequence(N){const W=this._encoder.encode([gi.Sequence,N.sequenceId]);return Qa.write(W.slice())}_readHeaders(N){const W=N[1];if("object"!=typeof W)throw new Error("Invalid headers.");return W}}var Ul={},H_=It(953);let pf=null;function Pc(){return(Pc=(0,o.A)(function*(he){try{pf?.dispose();const N=(0,H_.naY)()?"https://localhost:4200/api/MoveBank-Hub":"https://api.wildlife-tracker.com/api/MoveBank-Hub",W=(new ai).configureLogging(jt.Debug).withUrl(N,{withCredentials:!1}).withHubProtocol(new ds).withStatefulReconnect().build();yield W.start(),pf=W.stream("StreamEvents",he.request).subscribe({next:_e=>{const Ie=function Gd(he,N){return void 0===N&&(N=Ul),new rn(N.extensionCodec,N.context,N.maxStrLength,N.maxBinLength,N.maxArrayLength,N.maxMapLength,N.maxExtLength).decode(he)}(_e),$e=function cc(he){const W=he[1],re=he[2],_e=he[3];return{features:he[0].map(Ms),individualLocalIdentifier:W,count:re,index:_e}}(Ie);od($e,"BinaryLineString").then(Ue=>{null!==Ue&&postMessage(Ue[0],Ue[1])})},complete:()=>{postMessage({type:"StreamEnded"})},error:_e=>{console.error(_e),postMessage({type:"StreamError"})}})}catch(N){console.error(N)}})).apply(this,arguments)}function od(he,N){return sd.apply(this,arguments)}function sd(){return(sd=(0,o.A)(function*(he,N){if(0===he.count)return null;const W=he.features,_e=yi(W).lines;return void 0===_e||0===W.length?null:function dc(he,N,W){const _e=function Hd(he){const N=new TextEncoder;return{contentArray:he.map(re=>N.encode(re.content).buffer)}}(he.properties),Ie=function $_(he){const N=he,W=Object.keys(N),re=[],_e=new Map;for(const $e of W){const Ue=he[$e];re.push(Ue.value.buffer),_e.set($e,{size:Ue.size,value:Ue.value.buffer})}return[{sourceTimestamp:{size:N.sourceTimestamp.size,value:N.sourceTimestamp.value.buffer},destinationTimestamp:{size:N.destinationTimestamp.size,value:N.destinationTimestamp.value.buffer},distanceKm:{size:N.distanceKm?.size??2,value:N.distanceKm.value.buffer},distanceTravelledKm:{size:N.distanceTravelledKm.size,value:N.distanceTravelledKm.value.buffer}},re]}(he.numericProps),$e={type:W,index:N.index,length:N.count,individualLocalIdentifier:N.individualLocalIdentifier,featureId:Kn(he.featureIds),globalFeatureIds:Kn(he.globalFeatureIds),pathIndices:Kn(he.pathIndices),position:Kn(he.positions),colors:vh(_e.contentArray.length),numericProps:Ie[0],content:_e};return[$e,[$e.featureId.value,$e.globalFeatureIds.value,$e.pathIndices.value,$e.position.value,...Ie[1],..._e.contentArray]]}(_e,he,N)})).apply(this,arguments)}function Ms(he){const W=he[2];return{type:"Feature",geometry:{type:"LineString",coordinates:he[1][1]},properties:{sourceTimestamp:W[0],destinationTimestamp:W[1],content:W[2],distanceKm:W[3],distanceTravelledKm:W[4]}}}function vh(he){const N=[];for(let W=0;W<he;W++)N.push(...gf()),N.push(...gf());return{size:4,value:new Uint8Array(N).buffer}}function gf(){const he=[0,0,0,0];for(let N=0;N<3;N++)he[N]=Math.round(255*Math.random());return he[3]=255,he}function Kn(he){return{size:he.size,value:he.value.buffer}}addEventListener("message",({data:he})=>{"FetchRequest"===he.type&&function rd(he){Pc.apply(this,arguments)}(he.data)})},364:(Go,Gn,It)=>{"use strict";var o=It(953),Yt=It(467),Ai=It(985),_=It(71);function Tt(i){return!!i&&(i instanceof Ai.c||(0,_.T)(i.lift)&&(0,_.T)(i.subscribe))}function vn(i){return this instanceof vn?(this.v=i,this):new vn(i)}function yn(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=i[Symbol.asyncIterator];return t?t.call(i):(i=function mt(i){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(l){e[l]=i[l]&&function(m){return new Promise(function(C,A){!function r(l,m,C,A){Promise.resolve(A).then(function(O){l({value:O,done:C})},m)}(C,A,(m=i[l](m)).done,m.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const zr=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function No(i){return(0,_.T)(i?.then)}var la=It(494);function io(i){return(0,_.T)(i[la.s])}function Ge(i){return Symbol.asyncIterator&&(0,_.T)(i?.[Symbol.asyncIterator])}function Qe(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Xt=function nt(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function kt(i){return(0,_.T)(i?.[Xt])}function qt(i){return function St(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=e.apply(i,t||[]),l=[];return r={},C("next"),C("throw"),C("return",function m(te){return function(de){return Promise.resolve(de).then(te,$)}}),r[Symbol.asyncIterator]=function(){return this},r;function C(te,de){n[te]&&(r[te]=function(fe){return new Promise(function(ge,Re){l.push([te,fe,ge,Re])>1||A(te,fe)})},de&&(r[te]=de(r[te])))}function A(te,de){try{!function O(te){te.value instanceof vn?Promise.resolve(te.value.v).then(z,$):Q(l[0][2],te)}(n[te](de))}catch(fe){Q(l[0][3],fe)}}function z(te){A("next",te)}function $(te){A("throw",te)}function Q(te,de){te(de),l.shift(),l.length&&A(l[0][0],l[0][1])}}(this,arguments,function*(){const e=i.getReader();try{for(;;){const{value:n,done:r}=yield vn(e.read());if(r)return yield vn(void 0);yield yield vn(n)}}finally{e.releaseLock()}})}function Bt(i){return(0,_.T)(i?.getReader)}var pi=It(334);function pn(i){if(i instanceof Ai.c)return i;if(null!=i){if(io(i))return function Pr(i){return new Ai.c(t=>{const e=i[la.s]();if((0,_.T)(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(zr(i))return function br(i){return new Ai.c(t=>{for(let e=0;e<i.length&&!t.closed;e++)t.next(i[e]);t.complete()})}(i);if(No(i))return function Ho(i){return new Ai.c(t=>{i.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,pi.m)})}(i);if(Ge(i))return lt(i);if(kt(i))return function qo(i){return new Ai.c(t=>{for(const e of i)if(t.next(e),t.closed)return;t.complete()})}(i);if(Bt(i))return function ve(i){return lt(qt(i))}(i)}throw Qe(i)}function lt(i){return new Ai.c(t=>{(function Ce(i,t){var e,n,r,l;return function bi(i,t,e,n){return new(e||(e=Promise))(function(l,m){function C(z){try{O(n.next(z))}catch($){m($)}}function A(z){try{O(n.throw(z))}catch($){m($)}}function O(z){z.done?l(z.value):function r(l){return l instanceof e?l:new e(function(m){m(l)})}(z.value).then(C,A)}O((n=n.apply(i,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=yn(i);!(n=yield e.next()).done;)if(t.next(n.value),t.closed)return}catch(m){r={error:m}}finally{try{n&&!n.done&&(l=e.return)&&(yield l.call(e))}finally{if(r)throw r.error}}t.complete()})})(i,t).catch(e=>t.error(e))})}function He(i,t,e,n=0,r=!1){const l=t.schedule(function(){e(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(l),!r)return l}var ut=It(974),bt=It(360);function Ht(i,t=0){return(0,ut.N)((e,n)=>{e.subscribe((0,bt._)(n,r=>He(n,i,()=>n.next(r),t),()=>He(n,i,()=>n.complete(),t),r=>He(n,i,()=>n.error(r),t)))})}function hi(i,t=0){return(0,ut.N)((e,n)=>{n.add(i.schedule(()=>e.subscribe(n),t))})}function jn(i,t){if(!i)throw new Error("Iterable cannot be null");return new Ai.c(e=>{He(e,t,()=>{const n=i[Symbol.asyncIterator]();He(e,t,()=>{n.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Pn(i,t){return t?function _o(i,t){if(null!=i){if(io(i))return function gt(i,t){return pn(i).pipe(hi(t),Ht(t))}(i,t);if(zr(i))return function wi(i,t){return new Ai.c(e=>{let n=0;return t.schedule(function(){n===i.length?e.complete():(e.next(i[n++]),e.closed||this.schedule())})})}(i,t);if(No(i))return function Ni(i,t){return pn(i).pipe(hi(t),Ht(t))}(i,t);if(Ge(i))return jn(i,t);if(kt(i))return function $i(i,t){return new Ai.c(e=>{let n;return He(e,t,()=>{n=i[Xt](),He(e,t,()=>{let r,l;try{({value:r,done:l}=n.next())}catch(m){return void e.error(m)}l?e.complete():e.next(r)},0,!0)}),()=>(0,_.T)(n?.return)&&n.return()})}(i,t);if(Bt(i))return function eo(i,t){return jn(qt(i),t)}(i,t)}throw Qe(i)}(i,t):pn(i)}function Tr(i){return i&&(0,_.T)(i.schedule)}function cr(i){return i[i.length-1]}function kn(i){return(0,_.T)(cr(i))?i.pop():void 0}function Xr(i){return Tr(cr(i))?i.pop():void 0}function di(...i){return Pn(i,Xr(i))}var ro=It(412);const{isArray:Hs}=Array,{getPrototypeOf:ca,prototype:ls,keys:Yo}=Object;function dt(i){if(1===i.length){const t=i[0];if(Hs(t))return{args:t,keys:null};if(function wt(i){return i&&"object"==typeof i&&ca(i)===ls}(t)){const e=Yo(t);return{args:e.map(n=>t[n]),keys:e}}}return{args:i,keys:null}}var Vt=It(669),st=It(354);const{isArray:ei}=Array;function ai(i){return(0,st.T)(t=>function si(i,t){return ei(t)?i(...t):i(t)}(i,t))}function Zt(i,t){return i.reduce((e,n,r)=>(e[n]=t[r],e),{})}function ri(...i){const t=Xr(i),e=kn(i),{args:n,keys:r}=dt(i);if(0===n.length)return Pn([],t);const l=new Ai.c(function oi(i,t,e=Vt.D){return n=>{sn(t,()=>{const{length:r}=i,l=new Array(r);let m=r,C=r;for(let A=0;A<r;A++)sn(t,()=>{const O=Pn(i[A],t);let z=!1;O.subscribe((0,bt._)(n,$=>{l[A]=$,z||(z=!0,C--),C||n.next(e(l.slice()))},()=>{--m||n.complete()}))},n)},n)}}(n,t,r?m=>Zt(r,m):Vt.D));return e?l.pipe(ai(e)):l}function sn(i,t,e){i?He(e,i,t):t()}const zi=(0,It(853).L)(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function hr(i,t,e=1/0){return(0,_.T)(t)?hr((n,r)=>(0,st.T)((l,m)=>t(n,l,r,m))(pn(i(n,r))),e):("number"==typeof t&&(e=t),(0,ut.N)((n,r)=>function Kr(i,t,e,n,r,l,m,C){const A=[];let O=0,z=0,$=!1;const Q=()=>{$&&!A.length&&!O&&t.complete()},te=fe=>O<n?de(fe):A.push(fe),de=fe=>{l&&t.next(fe),O++;let ge=!1;pn(e(fe,z++)).subscribe((0,bt._)(t,Re=>{r?.(Re),l?te(Re):t.next(Re)},()=>{ge=!0},void 0,()=>{if(ge)try{for(O--;A.length&&O<n;){const Re=A.shift();m?He(t,m,()=>de(Re)):de(Re)}Q()}catch(Re){t.error(Re)}}))};return i.subscribe((0,bt._)(t,te,()=>{$=!0,Q()})),()=>{C?.()}}(n,r,i,e)))}function Qr(i=1/0){return hr(Vt.D,i)}function bo(...i){return function ho(){return Qr(1)}()(Pn(i,Xr(i)))}function ir(i){return new Ai.c(t=>{pn(i()).subscribe(t)})}var Ss=It(203);function $s(i,t){const e=(0,_.T)(i)?i:()=>i,n=r=>r.error(e());return new Ai.c(t?r=>t.schedule(n,0,r):n)}const nr=new Ai.c(i=>i.complete());var On=It(359);function bl(){return(0,ut.N)((i,t)=>{let e=null;i._refCount++;const n=(0,bt._)(t,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(e=null);const r=i._connection,l=e;e=null,r&&(!l||r===l)&&r.unsubscribe(),t.unsubscribe()});i.subscribe(n),n.closed||(e=i.connect())})}class Ps extends Ai.c{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,(0,ut.S)(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new On.yU;const e=this.getSubject();t.add(this.source.subscribe((0,bt._)(e,void 0,()=>{this._teardown(),e.complete()},n=>{this._teardown(),e.error(n)},()=>this._teardown()))),t.closed&&(this._connection=null,t=On.yU.EMPTY)}return t}refCount(){return bl()(this)}}var xi=It(413);let Ea=null;function rs(){return Ea}class Ta{}const Nn=new o.nKC("");let Bo=(()=>{class i{historyGo(e){throw new Error("")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:()=>(0,o.WQX)(rr),providedIn:"platform"})}}return i})();const Vo=new o.nKC("");let rr=(()=>{class i extends Bo{constructor(){super(),this._doc=(0,o.WQX)(Nn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return rs().getBaseHref(this._doc)}onPopState(e){const n=rs().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",e,!1),()=>n.removeEventListener("popstate",e)}onHashChange(e){const n=rs().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",e,!1),()=>n.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,n,r){this._history.pushState(e,n,r)}replaceState(e,n,r){this._history.replaceState(e,n,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:()=>new i,providedIn:"platform"})}}return i})();function id(i,t){if(0==i.length)return t;if(0==t.length)return i;let e=0;return i.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?i+t.substring(1):1==e?i+t:i+"/"+t}function Ic(i){const t=i.match(/#|\?|$/),e=t&&t.index||i.length;return i.slice(0,e-("/"===i[e-1]?1:0))+i.slice(e)}function Sa(i){return i&&"?"!==i[0]?"?"+i:i}let yl=(()=>{class i{historyGo(e){throw new Error("")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:()=>(0,o.WQX)(Rc),providedIn:"root"})}}return i})();const Os=new o.nKC("");let Rc=(()=>{class i extends yl{constructor(e,n){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??(0,o.WQX)(Nn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return id(this._baseHref,e)}path(e=!1){const n=this._platformLocation.pathname+Sa(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${n}${r}`:n}pushState(e,n,r,l){const m=this.prepareExternalUrl(r+Sa(l));this._platformLocation.pushState(e,n,m)}replaceState(e,n,r,l){const m=this.prepareExternalUrl(r+Sa(l));this._platformLocation.replaceState(e,n,m)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Bo),o.KVO(Os,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),mf=(()=>{class i extends yl{constructor(e,n){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){const n=this._platformLocation.hash??"#";return n.length>0?n.substring(1):n}prepareExternalUrl(e){const n=id(this._baseHref,e);return n.length>0?"#"+n:n}pushState(e,n,r,l){let m=this.prepareExternalUrl(r+Sa(l));0==m.length&&(m=this._platformLocation.pathname),this._platformLocation.pushState(e,n,m)}replaceState(e,n,r,l){let m=this.prepareExternalUrl(r+Sa(l));0==m.length&&(m=this._platformLocation.pathname),this._platformLocation.replaceState(e,n,m)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Bo),o.KVO(Os,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})(),Ma=(()=>{class i{constructor(e){this._subject=new o.bkB,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const n=this._locationStrategy.getBaseHref();this._basePath=function Ae(i){if(new RegExp("^(https?:)?//").test(i)){const[,e]=i.split(/\/\/[^\/]+/);return e}return i}(Ic(wr(n))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,n=""){return this.path()==this.normalize(e+Sa(n))}normalize(e){return i.stripTrailingSlash(function Or(i,t){if(!i||!t.startsWith(i))return t;const e=t.substring(i.length);return""===e||["/",";","?","#"].includes(e[0])?e:t}(this._basePath,wr(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,n="",r=null){this._locationStrategy.pushState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Sa(n)),r)}replaceState(e,n="",r=null){this._locationStrategy.replaceState(r,"",e,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Sa(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}),()=>{const n=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(n,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",n){this._urlChangeListeners.forEach(r=>r(e,n))}subscribe(e,n,r){return this._subject.subscribe({next:e,error:n,complete:r})}static{this.normalizeQueryParams=Sa}static{this.joinWithSlash=id}static{this.stripTrailingSlash=Ic}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(yl))}}static{this.\u0275prov=o.jDH({token:i,factory:()=>function Ci(){return new Ma((0,o.KVO)(yl))}(),providedIn:"root"})}}return i})();function wr(i){return i.replace(/\/index.html$/,"")}var Qt=function(i){return i[i.Format=0]="Format",i[i.Standalone=1]="Standalone",i}(Qt||{}),Ei=function(i){return i[i.Narrow=0]="Narrow",i[i.Abbreviated=1]="Abbreviated",i[i.Wide=2]="Wide",i[i.Short=3]="Short",i}(Ei||{}),fn=function(i){return i[i.Short=0]="Short",i[i.Medium=1]="Medium",i[i.Long=2]="Long",i[i.Full=3]="Full",i}(fn||{});const An={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Qa(i,t){return Ms((0,o.H5H)(i)[o.KH2.DateFormat],t)}function lc(i,t){return Ms((0,o.H5H)(i)[o.KH2.TimeFormat],t)}function cs(i,t){return Ms((0,o.H5H)(i)[o.KH2.DateTimeFormat],t)}function ds(i,t){const e=(0,o.H5H)(i),n=e[o.KH2.NumberSymbols][t];if(typeof n>"u"){if(t===An.CurrencyDecimal)return e[o.KH2.NumberSymbols][An.Decimal];if(t===An.CurrencyGroup)return e[o.KH2.NumberSymbols][An.Group]}return n}function Pc(i){if(!i[o.KH2.ExtraData])throw new Error(`Missing extra locale data for the locale "${i[o.KH2.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ms(i,t){for(let e=t;e>-1;e--)if(typeof i[e]<"u")return i[e];throw new Error("Locale data API: locale data undefined")}function dc(i){const[t,e]=i.split(":");return{hours:+t,minutes:+e}}const gf=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Kn={},zm=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Oc=function(i){return i[i.Short=0]="Short",i[i.ShortGMT=1]="ShortGMT",i[i.Long=2]="Long",i[i.Extended=3]="Extended",i}(Oc||{}),he=function(i){return i[i.FullYear=0]="FullYear",i[i.Month=1]="Month",i[i.Date=2]="Date",i[i.Hours=3]="Hours",i[i.Minutes=4]="Minutes",i[i.Seconds=5]="Seconds",i[i.FractionalSeconds=6]="FractionalSeconds",i[i.Day=7]="Day",i}(he||{}),N=function(i){return i[i.DayPeriods=0]="DayPeriods",i[i.Days=1]="Days",i[i.Months=2]="Months",i[i.Eras=3]="Eras",i}(N||{});function W(i,t,e,n){let r=function da(i){if(Um(i))return i;if("number"==typeof i&&!isNaN(i))return new Date(i);if("string"==typeof i){if(i=i.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(i)){const[r,l=1,m=1]=i.split("-").map(C=>+C);return re(r,l-1,m)}const e=parseFloat(i);if(!isNaN(i-e))return new Date(e);let n;if(n=i.match(gf))return function Nt(i){const t=new Date(0);let e=0,n=0;const r=i[8]?t.setUTCFullYear:t.setFullYear,l=i[8]?t.setUTCHours:t.setHours;i[9]&&(e=Number(i[9]+i[10]),n=Number(i[9]+i[11])),r.call(t,Number(i[1]),Number(i[2])-1,Number(i[3]));const m=Number(i[4]||0)-e,C=Number(i[5]||0)-n,A=Number(i[6]||0),O=Math.floor(1e3*parseFloat("0."+(i[7]||0)));return l.call(t,m,C,A,O),t}(n)}const t=new Date(i);if(!Um(t))throw new Error(`Unable to convert "${i}" into a date`);return t}(i);t=_e(e,t)||t;let C,m=[];for(;t;){if(C=zm.exec(t),!C){m.push(t);break}{m=m.concat(C.slice(1));const z=m.pop();if(!z)break;t=z}}let A=r.getTimezoneOffset();n&&(A=wl(n,A),r=function Fc(i,t,e){const n=e?-1:1,r=i.getTimezoneOffset();return function fo(i,t){return(i=new Date(i.getTime())).setMinutes(i.getMinutes()+t),i}(i,n*(wl(t,r)-r))}(r,n,!0));let O="";return m.forEach(z=>{const $=function Ga(i){if(ja[i])return ja[i];let t;switch(i){case"G":case"GG":case"GGG":t=li(N.Eras,Ei.Abbreviated);break;case"GGGG":t=li(N.Eras,Ei.Wide);break;case"GGGGG":t=li(N.Eras,Ei.Narrow);break;case"y":t=Ct(he.FullYear,1,0,!1,!0);break;case"yy":t=Ct(he.FullYear,2,0,!0,!0);break;case"yyy":t=Ct(he.FullYear,3,0,!1,!0);break;case"yyyy":t=Ct(he.FullYear,4,0,!1,!0);break;case"Y":t=Lc(1);break;case"YY":t=Lc(2,!0);break;case"YYY":t=Lc(3);break;case"YYYY":t=Lc(4);break;case"M":case"L":t=Ct(he.Month,1,1);break;case"MM":case"LL":t=Ct(he.Month,2,1);break;case"MMM":t=li(N.Months,Ei.Abbreviated);break;case"MMMM":t=li(N.Months,Ei.Wide);break;case"MMMMM":t=li(N.Months,Ei.Narrow);break;case"LLL":t=li(N.Months,Ei.Abbreviated,Qt.Standalone);break;case"LLLL":t=li(N.Months,Ei.Wide,Qt.Standalone);break;case"LLLLL":t=li(N.Months,Ei.Narrow,Qt.Standalone);break;case"w":t=xl(1);break;case"ww":t=xl(2);break;case"W":t=xl(1,!0);break;case"d":t=Ct(he.Date,1);break;case"dd":t=Ct(he.Date,2);break;case"c":case"cc":t=Ct(he.Day,1);break;case"ccc":t=li(N.Days,Ei.Abbreviated,Qt.Standalone);break;case"cccc":t=li(N.Days,Ei.Wide,Qt.Standalone);break;case"ccccc":t=li(N.Days,Ei.Narrow,Qt.Standalone);break;case"cccccc":t=li(N.Days,Ei.Short,Qt.Standalone);break;case"E":case"EE":case"EEE":t=li(N.Days,Ei.Abbreviated);break;case"EEEE":t=li(N.Days,Ei.Wide);break;case"EEEEE":t=li(N.Days,Ei.Narrow);break;case"EEEEEE":t=li(N.Days,Ei.Short);break;case"a":case"aa":case"aaa":t=li(N.DayPeriods,Ei.Abbreviated);break;case"aaaa":t=li(N.DayPeriods,Ei.Wide);break;case"aaaaa":t=li(N.DayPeriods,Ei.Narrow);break;case"b":case"bb":case"bbb":t=li(N.DayPeriods,Ei.Abbreviated,Qt.Standalone,!0);break;case"bbbb":t=li(N.DayPeriods,Ei.Wide,Qt.Standalone,!0);break;case"bbbbb":t=li(N.DayPeriods,Ei.Narrow,Qt.Standalone,!0);break;case"B":case"BB":case"BBB":t=li(N.DayPeriods,Ei.Abbreviated,Qt.Format,!0);break;case"BBBB":t=li(N.DayPeriods,Ei.Wide,Qt.Format,!0);break;case"BBBBB":t=li(N.DayPeriods,Ei.Narrow,Qt.Format,!0);break;case"h":t=Ct(he.Hours,1,-12);break;case"hh":t=Ct(he.Hours,2,-12);break;case"H":t=Ct(he.Hours,1);break;case"HH":t=Ct(he.Hours,2);break;case"m":t=Ct(he.Minutes,1);break;case"mm":t=Ct(he.Minutes,2);break;case"s":t=Ct(he.Seconds,1);break;case"ss":t=Ct(he.Seconds,2);break;case"S":t=Ct(he.FractionalSeconds,1);break;case"SS":t=Ct(he.FractionalSeconds,2);break;case"SSS":t=Ct(he.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=En(Oc.Short);break;case"ZZZZZ":t=En(Oc.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=En(Oc.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=En(Oc.Long);break;default:return null}return ja[i]=t,t}(z);O+=$?$(r,e,A):"''"===z?"'":z.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),O}function re(i,t,e){const n=new Date(0);return n.setFullYear(i,t,e),n.setHours(0,0,0),n}function _e(i,t){const e=function Zo(i){return(0,o.H5H)(i)[o.KH2.LocaleId]}(i);if(Kn[e]??={},Kn[e][t])return Kn[e][t];let n="";switch(t){case"shortDate":n=Qa(i,fn.Short);break;case"mediumDate":n=Qa(i,fn.Medium);break;case"longDate":n=Qa(i,fn.Long);break;case"fullDate":n=Qa(i,fn.Full);break;case"shortTime":n=lc(i,fn.Short);break;case"mediumTime":n=lc(i,fn.Medium);break;case"longTime":n=lc(i,fn.Long);break;case"fullTime":n=lc(i,fn.Full);break;case"short":const r=_e(i,"shortTime"),l=_e(i,"shortDate");n=Ie(cs(i,fn.Short),[r,l]);break;case"medium":const m=_e(i,"mediumTime"),C=_e(i,"mediumDate");n=Ie(cs(i,fn.Medium),[m,C]);break;case"long":const A=_e(i,"longTime"),O=_e(i,"longDate");n=Ie(cs(i,fn.Long),[A,O]);break;case"full":const z=_e(i,"fullTime"),$=_e(i,"fullDate");n=Ie(cs(i,fn.Full),[z,$])}return n&&(Kn[e][t]=n),n}function Ie(i,t){return t&&(i=i.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),i}function $e(i,t,e="-",n,r){let l="";(i<0||r&&i<=0)&&(r?i=1-i:(i=-i,l=e));let m=String(i);for(;m.length<t;)m="0"+m;return n&&(m=m.slice(m.length-t)),l+m}function Ct(i,t,e=0,n=!1,r=!1){return function(l,m){let C=function zt(i,t){switch(i){case he.FullYear:return t.getFullYear();case he.Month:return t.getMonth();case he.Date:return t.getDate();case he.Hours:return t.getHours();case he.Minutes:return t.getMinutes();case he.Seconds:return t.getSeconds();case he.FractionalSeconds:return t.getMilliseconds();case he.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${i}".`)}}(i,l);if((e>0||C>-e)&&(C+=e),i===he.Hours)0===C&&-12===e&&(C=12);else if(i===he.FractionalSeconds)return function Ue(i,t){return $e(i,3).substring(0,t)}(C,t);const A=ds(m,An.MinusSign);return $e(C,t,A,n,r)}}function li(i,t,e=Qt.Format,n=!1){return function(r,l){return function Ln(i,t,e,n,r,l){switch(e){case N.Months:return function $n(i,t,e){const n=(0,o.H5H)(i),l=Ms([n[o.KH2.MonthsFormat],n[o.KH2.MonthsStandalone]],t);return Ms(l,e)}(t,r,n)[i.getMonth()];case N.Days:return function nd(i,t,e){const n=(0,o.H5H)(i),l=Ms([n[o.KH2.DaysFormat],n[o.KH2.DaysStandalone]],t);return Ms(l,e)}(t,r,n)[i.getDay()];case N.DayPeriods:const m=i.getHours(),C=i.getMinutes();if(l){const O=function od(i){const t=(0,o.H5H)(i);return Pc(t),(t[o.KH2.ExtraData][2]||[]).map(n=>"string"==typeof n?dc(n):[dc(n[0]),dc(n[1])])}(t),z=function sd(i,t,e){const n=(0,o.H5H)(i);Pc(n);const l=Ms([n[o.KH2.ExtraData][0],n[o.KH2.ExtraData][1]],t)||[];return Ms(l,e)||[]}(t,r,n),$=O.findIndex(Q=>{if(Array.isArray(Q)){const[te,de]=Q,fe=m>=te.hours&&C>=te.minutes,ge=m<de.hours||m===de.hours&&C<de.minutes;if(te.hours<de.hours){if(fe&&ge)return!0}else if(fe||ge)return!0}else if(Q.hours===m&&Q.minutes===C)return!0;return!1});if(-1!==$)return z[$]}return function nn(i,t,e){const n=(0,o.H5H)(i),l=Ms([n[o.KH2.DayPeriodsFormat],n[o.KH2.DayPeriodsStandalone]],t);return Ms(l,e)}(t,r,n)[m<12?0:1];case N.Eras:return function jd(i,t){return Ms((0,o.H5H)(i)[o.KH2.Eras],t)}(t,n)[i.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,l,i,t,e,n)}}function En(i){return function(t,e,n){const r=-1*n,l=ds(e,An.MinusSign),m=r>0?Math.floor(r/60):Math.ceil(r/60);switch(i){case Oc.Short:return(r>=0?"+":"")+$e(m,2,l)+$e(Math.abs(r%60),2,l);case Oc.ShortGMT:return"GMT"+(r>=0?"+":"")+$e(m,1,l);case Oc.Long:return"GMT"+(r>=0?"+":"")+$e(m,2,l)+":"+$e(Math.abs(r%60),2,l);case Oc.Extended:return 0===n?"Z":(r>=0?"+":"")+$e(m,2,l)+":"+$e(Math.abs(r%60),2,l);default:throw new Error(`Unknown zone width "${i}"`)}}}const Wn=0,pr=4;function Ja(i){const t=i.getDay(),e=0===t?-3:pr-t;return re(i.getFullYear(),i.getMonth(),i.getDate()+e)}function xl(i,t=!1){return function(e,n){let r;if(t){const l=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,m=e.getDate();r=1+Math.floor((m+l)/7)}else{const l=Ja(e),m=function ys(i){const t=re(i,Wn,1).getDay();return re(i,0,1+(t<=pr?pr:pr+7)-t)}(l.getFullYear()),C=l.getTime()-m.getTime();r=1+Math.round(C/6048e5)}return $e(r,i,ds(n,An.MinusSign))}}function Lc(i,t=!1){return function(e,n){return $e(Ja(e).getFullYear(),i,ds(n,An.MinusSign),t)}}const ja={};function wl(i,t){i=i.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+i)/6e4;return isNaN(e)?t:e}function Um(i){return i instanceof Date&&!isNaN(i.valueOf())}function mg(i,t){t=encodeURIComponent(t);for(const e of i.split(";")){const n=e.indexOf("="),[r,l]=-1==n?[e,""]:[e.slice(0,n),e.slice(n+1)];if(r.trim()===t)return decodeURIComponent(l)}return null}const pg=/\s+/,Wb=[];let Hm=(()=>{class i{constructor(e,n){this._ngEl=e,this._renderer=n,this.initialClasses=Wb,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(pg):Wb}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(pg):e}ngDoCheck(){for(const n of this.initialClasses)this._updateState(n,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const n of e)this._updateState(n,!0);else if(null!=e)for(const n of Object.keys(e))this._updateState(n,!!e[n]);this._applyStateDiff()}_updateState(e,n){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==n&&(r.changed=!0,r.enabled=n),r.touched=!0):this.stateMap.set(e,{enabled:n,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const n=e[0],r=e[1];r.changed?(this._toggleClass(n,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(n,!1),this.stateMap.delete(n)),r.touched=!1}}_toggleClass(e,n){(e=e.trim()).length>0&&e.split(pg).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.sFG))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return i})();class vf{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Eu=(()=>{class i{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,n,r){this._viewContainer=e,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const n=this._viewContainer;e.forEachOperation((r,l,m)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new vf(r.item,this._ngForOf,-1,-1),null===m?void 0:m);else if(null==m)n.remove(null===l?void 0:l);else if(null!==l){const C=n.get(l);n.move(C,m),$d(C,r)}});for(let r=0,l=n.length;r<l;r++){const C=n.get(r).context;C.index=r,C.count=l,C.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{$d(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,n){return!0}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.c1b),o.rXU(o.C4Q),o.rXU(o._q3))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return i})();function $d(i,t){i.context.$implicit=t.item}let fc=(()=>{class i{constructor(e,n){this._viewContainer=e,this._context=new bf,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){ad("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){ad("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,n){return!0}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.c1b),o.rXU(o.C4Q))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return i})();class bf{constructor(){this.$implicit=null,this.ngIf=null}}function ad(i,t){if(t&&!t.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${(0,o.Tbb)(t)}'.`)}let mc=(()=>{class i{constructor(e,n,r){this._ngEl=e,this._differs=n,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,n){const[r,l]=e.split("."),m=-1===r.indexOf("-")?void 0:o.czy.DashCase;null!=n?this._renderer.setStyle(this._ngEl.nativeElement,r,l?`${n}${l}`:n,m):this._renderer.removeStyle(this._ngEl.nativeElement,r,m)}_applyChanges(e){e.forEachRemovedItem(n=>this._setStyle(n.key,null)),e.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),e.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.MKu),o.rXU(o.sFG))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}}return i})(),Nc=(()=>{class i{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(this._shouldRecreateView(e)){const n=this._viewContainerRef;if(this._viewRef&&n.remove(n.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=n.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(e){return!!e.ngTemplateOutlet||!!e.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(e,n,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,n,r),get:(e,n,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,n,r)}})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.c1b))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[o.OA$]})}}return i})();function ka(i,t){return new o.wOt(2100,!1)}class Dx{createSubscription(t,e){return(0,o.O8t)(()=>t.subscribe({next:e,error:n=>{throw n}}))}dispose(t){(0,o.O8t)(()=>t.unsubscribe())}}class Wm{createSubscription(t,e){return t.then(e,n=>{throw n})}dispose(t){}}const Xm=new Wm,yf=new Dx;let xf=(()=>{class i{constructor(e){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=e}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(e){if(!this._obj){if(e)try{this.markForCheckOnValueUpdate=!1,this._subscribe(e)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue}_subscribe(e){this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,n=>this._updateLatestValue(e,n))}_selectStrategy(e){if((0,o.jNT)(e))return Xm;if((0,o.zjR)(e))return yf;throw ka()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(e,n){e===this._obj&&(this._latestValue=n,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc,16))}}static{this.\u0275pipe=o.EJ8({name:"async",type:i,pure:!1,standalone:!0})}}return i})();const Dr=new o.nKC(""),To=new o.nKC("");let Z_=(()=>{class i{constructor(e,n,r){this.locale=e,this.defaultTimezone=n,this.defaultOptions=r}transform(e,n,r,l){if(null==e||""===e||e!=e)return null;try{return W(e,n??this.defaultOptions?.dateFormat??"mediumDate",l||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(m){throw ka()}}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.xe9,16),o.rXU(Dr,24),o.rXU(To,24))}}static{this.\u0275pipe=o.EJ8({name:"date",type:i,pure:!0,standalone:!0})}}return i})(),os=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({})}}return i})();const K_="browser";function Km(i){return i===K_}function Tf(i){return"server"===i}let Qm=(()=>{class i{static{this.\u0275prov=(0,o.jDH)({token:i,providedIn:"root",factory:()=>Km((0,o.WQX)(o.Agw))?new Hl((0,o.WQX)(Nn),window):new ba})}}return i})();class Hl{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t){this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){const e=function J_(i,t){const e=i.getElementById(t)||i.getElementsByName(t)[0];if(e)return e;if("function"==typeof i.createTreeWalker&&i.body&&"function"==typeof i.body.attachShadow){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const l=r.shadowRoot;if(l){const m=l.getElementById(t)||l.querySelector(`[name="${t}"]`);if(m)return m}r=n.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){this.window.history.scrollRestoration=t}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,l=this.offset();this.window.scrollTo(n-l[0],r-l[1])}}class ba{setOffset(t){}getScrollPosition(){return[0,0]}scrollToPosition(t){}scrollToAnchor(t){}setHistoryScrollRestoration(t){}}class Du{}function So(i,t){return(0,ut.N)((e,n)=>{let r=null,l=0,m=!1;const C=()=>m&&!r&&n.complete();e.subscribe((0,bt._)(n,A=>{r?.unsubscribe();let O=0;const z=l++;pn(i(A,z)).subscribe(r=(0,bt._)(n,$=>n.next(t?t(A,$,z,O++):$),()=>{r=null,C()}))},()=>{m=!0,C()}))})}function gs(i){return i<=0?()=>nr:(0,ut.N)((t,e)=>{let n=0;t.subscribe((0,bt._)(e,r=>{++n<=i&&(e.next(r),i<=n&&e.complete())}))})}function As(...i){const t=Xr(i);return(0,ut.N)((e,n)=>{(t?bo(i,e,t):bo(i,e)).subscribe(n)})}function Ur(i,t){return(0,ut.N)((e,n)=>{let r=0;e.subscribe((0,bt._)(n,l=>i.call(t,l,r++)&&n.next(l)))})}function ua(i){return(0,ut.N)((t,e)=>{let n=!1;t.subscribe((0,bt._)(e,r=>{n=!0,e.next(r)},()=>{n||e.next(i),e.complete()}))})}function jc(i=sp){return(0,ut.N)((t,e)=>{let n=!1;t.subscribe((0,bt._)(e,r=>{n=!0,e.next(r)},()=>n?e.complete():e.error(i())))})}function sp(){return new zi}function Lu(i,t){const e=arguments.length>=2;return n=>n.pipe(i?Ur((r,l)=>i(r,l,n)):Vt.D,gs(1),e?ua(t):jc(()=>new zi))}function ld(i,t){return(0,_.T)(t)?hr(i,t,1):hr(i,1)}function Oo(i,t,e){const n=(0,_.T)(i)||t||e?{next:i,error:t,complete:e}:i;return n?(0,ut.N)((r,l)=>{var m;null===(m=n.subscribe)||void 0===m||m.call(n);let C=!0;r.subscribe((0,bt._)(l,A=>{var O;null===(O=n.next)||void 0===O||O.call(n,A),l.next(A)},()=>{var A;C=!1,null===(A=n.complete)||void 0===A||A.call(n),l.complete()},A=>{var O;C=!1,null===(O=n.error)||void 0===O||O.call(n,A),l.error(A)},()=>{var A,O;C&&(null===(A=n.unsubscribe)||void 0===A||A.call(n)),null===(O=n.finalize)||void 0===O||O.call(n)}))}):Vt.D}function xa(i){return(0,ut.N)((t,e)=>{let l,n=null,r=!1;n=t.subscribe((0,bt._)(e,void 0,void 0,m=>{l=pn(i(m,xa(i)(t))),n?(n.unsubscribe(),n=null,l.subscribe(e)):r=!0})),r&&(n.unsubscribe(),n=null,l.subscribe(e))})}function Bf(i,t,e,n,r){return(l,m)=>{let C=e,A=t,O=0;l.subscribe((0,bt._)(m,z=>{const $=O++;A=C?i(A,z,$):(C=!0,z),n&&m.next(A)},r&&(()=>{C&&m.next(A),m.complete()})))}}function dv(i){return i<=0?()=>nr:(0,ut.N)((t,e)=>{let n=[];t.subscribe((0,bt._)(e,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)e.next(r);e.complete()},void 0,()=>{n=null}))})}function vo(i){return(0,st.T)(()=>i)}function Ir(i){return(0,ut.N)((t,e)=>{try{t.subscribe(e)}finally{e.add(i)}})}var Gc=It(343);function dn(i){return(0,ut.N)((t,e)=>{pn(i).subscribe((0,bt._)(e,()=>e.complete(),Gc.l)),!e.closed&&t.subscribe(e)})}class il extends Ta{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Hc extends il{static makeCurrent(){!function Ua(i){Ea??=i}(new Hc)}onAndCancel(t,e,n){return t.addEventListener(e,n),()=>{t.removeEventListener(e,n)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function Dg(){return _s=_s||document.querySelector("base"),_s?_s.getAttribute("href"):null}();return null==e?null:function Fu(i){return new URL(i,document.baseURI).pathname}(e)}resetBaseElement(){_s=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return mg(document.cookie,t)}}let _s=null,zf=(()=>{class i{build(){return new XMLHttpRequest}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const Uf=new o.nKC("");let jf=(()=>{class i{constructor(e,n){this._zone=n,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,n,r){return this._findPluginFor(n).addEventListener(e,n,r)}getZone(){return this._zone}_findPluginFor(e){let n=this._eventNameToPlugin.get(e);if(n)return n;if(n=this._plugins.find(l=>l.supports(e)),!n)throw new o.wOt(5101,!1);return this._eventNameToPlugin.set(e,n),n}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Uf),o.KVO(o.SKi))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();class kg{constructor(t){this._doc=t}}const ap="ng-app-id";let $c=(()=>{class i{constructor(e,n,r,l={}){this.doc=e,this.appId=n,this.nonce=r,this.platformId=l,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Tf(l),this.resetHostNodes()}addStyles(e){for(const n of e)1===this.changeUsageCount(n,1)&&this.onStyleAdded(n)}removeStyles(e){for(const n of e)this.changeUsageCount(n,-1)<=0&&this.onStyleRemoved(n)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(n=>n.remove()),e.clear());for(const n of this.getAllStyles())this.onStyleRemoved(n);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const n of this.getAllStyles())this.addStyleToHost(e,n)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const n of this.hostNodes)this.addStyleToHost(n,e)}onStyleRemoved(e){const n=this.styleRef;n.get(e)?.elements?.forEach(r=>r.remove()),n.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${ap}="${this.appId}"]`);if(e?.length){const n=new Map;return e.forEach(r=>{null!=r.textContent&&n.set(r.textContent,r)}),n}return null}changeUsageCount(e,n){const r=this.styleRef;if(r.has(e)){const l=r.get(e);return l.usage+=n,l.usage}return r.set(e,{usage:n,elements:[]}),n}getStyleElement(e,n){const r=this.styleNodesInDOM,l=r?.get(n);if(l?.parentNode===e)return r.delete(n),l.removeAttribute(ap),l;{const m=this.doc.createElement("style");return this.nonce&&m.setAttribute("nonce",this.nonce),m.textContent=n,this.platformIsServer&&m.setAttribute(ap,this.appId),e.appendChild(m),m}}addStyleToHost(e,n){const r=this.getStyleElement(e,n),l=this.styleRef,m=l.get(n)?.elements;m?m.push(r):l.set(n,{elements:[r],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn),o.KVO(o.sZ2),o.KVO(o.BIS,8),o.KVO(o.Agw))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const xh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},cd=/%COMP%/g,Sl=new o.nKC("",{providedIn:"root",factory:()=>!0});function eu(i,t){return t.map(e=>e.replace(cd,i))}let Ao=(()=>{class i{constructor(e,n,r,l,m,C,A,O=null){this.eventManager=e,this.sharedStylesHost=n,this.appId=r,this.removeStylesOnCompDestroy=l,this.doc=m,this.platformId=C,this.ngZone=A,this.nonce=O,this.rendererByCompId=new Map,this.platformIsServer=Tf(C),this.defaultRenderer=new xs(e,m,A,this.platformIsServer)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===o.gXe.ShadowDom&&(n={...n,encapsulation:o.gXe.Emulated});const r=this.getOrCreateRenderer(e,n);return r instanceof us?r.applyToHost(e):r instanceof dd&&r.applyStyles(),r}getOrCreateRenderer(e,n){const r=this.rendererByCompId;let l=r.get(n.id);if(!l){const m=this.doc,C=this.ngZone,A=this.eventManager,O=this.sharedStylesHost,z=this.removeStylesOnCompDestroy,$=this.platformIsServer;switch(n.encapsulation){case o.gXe.Emulated:l=new us(A,O,n,this.appId,z,m,C,$);break;case o.gXe.ShadowDom:return new Gf(A,O,e,n,m,C,this.nonce,$);default:l=new dd(A,O,n,z,m,C,$)}r.set(n.id,l)}return l}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(jf),o.KVO($c),o.KVO(o.sZ2),o.KVO(Sl),o.KVO(Nn),o.KVO(o.Agw),o.KVO(o.SKi),o.KVO(o.BIS))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();class xs{constructor(t,e,n,r){this.eventManager=t,this.doc=e,this.ngZone=n,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(t,e){return e?this.doc.createElementNS(xh[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(Nu(t)?t.content:t).appendChild(e)}insertBefore(t,e,n){t&&(Nu(t)?t.content:t).insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?this.doc.querySelector(t):t;if(!n)throw new o.wOt(-5104,!1);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const l=xh[r];l?t.setAttributeNS(l,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=xh[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&(o.czy.DashCase|o.czy.Important)?t.style.setProperty(e,n,r&o.czy.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&o.czy.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){null!=t&&(t[e]=n)}setValue(t,e){t.nodeValue=e}listen(t,e,n){if("string"==typeof t&&!(t=rs().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${e}`);return this.eventManager.addEventListener(t,e,this.decoratePreventDefault(n))}decoratePreventDefault(t){return e=>{if("__ngUnwrap__"===e)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))&&e.preventDefault()}}}function Nu(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class Gf extends xs{constructor(t,e,n,r,l,m,C,A){super(t,l,m,A),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const O=eu(r.id,r.styles);for(const z of O){const $=document.createElement("style");C&&$.setAttribute("nonce",C),$.textContent=z,this.shadowRoot.appendChild($)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class dd extends xs{constructor(t,e,n,r,l,m,C,A){super(t,l,m,C),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r,this.styles=A?eu(A,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class us extends dd{constructor(t,e,n,r,l,m,C,A){const O=r+"-"+n.id;super(t,e,n,l,m,C,A,O),this.contentAttr=function Ys(i){return"_ngcontent-%COMP%".replace(cd,i)}(O),this.hostAttr=function Ns(i){return"_nghost-%COMP%".replace(cd,i)}(O)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}let Bu=(()=>{class i extends kg{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,r){return e.addEventListener(n,r,!1),()=>this.removeEventListener(e,n,r)}removeEventListener(e,n,r){return e.removeEventListener(n,r)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const Vu=["alt","control","meta","shift"],ud={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},wh={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let uv=(()=>{class i extends kg{constructor(e){super(e)}supports(e){return null!=i.parseEventName(e)}addEventListener(e,n,r){const l=i.parseEventName(n),m=i.eventCallback(l.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>rs().onAndCancel(e,l.domEventName,m))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const l=i._normalizeKey(n.pop());let m="",C=n.indexOf("code");if(C>-1&&(n.splice(C,1),m="code."),Vu.forEach(O=>{const z=n.indexOf(O);z>-1&&(n.splice(z,1),m+=O+".")}),m+=l,0!=n.length||0===l.length)return null;const A={};return A.domEventName=r,A.fullKey=m,A}static matchEventFullKeyCode(e,n){let r=ud[e.key]||e.key,l="";return n.indexOf("code.")>-1&&(r=e.code,l="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),Vu.forEach(m=>{m!==r&&(0,wh[m])(e)&&(l+=m+".")}),l+=r,l===n)}static eventCallback(e,n,r){return l=>{i.matchEventFullKeyCode(l,e)&&r.runGuarded(()=>n(l))}}static _normalizeKey(e){return"esc"===e?"escape":e}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();function Ml(i){return{appProviders:[...Ds,...i?.providers??[]],platformProviders:Wo}}const Wo=[{provide:o.Agw,useValue:K_},{provide:o.PLl,useValue:function Eh(){Hc.makeCurrent()},multi:!0},{provide:Nn,useFactory:function Wc(){return(0,o.TL$)(document),document},deps:[]}],Bs=new o.nKC(""),Hf=[{provide:o.e01,useClass:class _c{addToWindow(t){o.JZv.getAngularTestability=(n,r=!0)=>{const l=t.findTestabilityInTree(n,r);if(null==l)throw new o.wOt(5103,!1);return l},o.JZv.getAllAngularTestabilities=()=>t.getAllTestabilities(),o.JZv.getAllAngularRootElements=()=>t.getAllRootElements(),o.JZv.frameworkStabilizers||(o.JZv.frameworkStabilizers=[]),o.JZv.frameworkStabilizers.push(n=>{const r=o.JZv.getAllAngularTestabilities();let l=r.length;const m=function(){l--,0==l&&n()};r.forEach(C=>{C.whenStable(m)})})}findTestabilityInTree(t,e,n){return null==e?null:t.getTestability(e)??(n?rs().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:o.WHO,useClass:o.NYb,deps:[o.SKi,o.giA,o.e01]},{provide:o.NYb,useClass:o.NYb,deps:[o.SKi,o.giA,o.e01]}],Ds=[{provide:o.H8p,useValue:"root"},{provide:o.zcH,useFactory:function lp(){return new o.zcH},deps:[]},{provide:Uf,useClass:Bu,multi:!0,deps:[Nn,o.SKi,o.Agw]},{provide:Uf,useClass:uv,multi:!0,deps:[Nn]},Ao,$c,jf,{provide:o._9s,useExisting:Ao},{provide:Du,useClass:zf,deps:[]},[]];let ha=(()=>{class i{constructor(e){}static withServerTransition(e){return{ngModule:i,providers:[{provide:o.sZ2,useValue:e.appId}]}}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Bs,12))}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[...Ds,...Hf],imports:[os,o.Hbi]})}}return i})(),cp=(()=>{class i{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),w=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:function(n){let r=null;return r=n?new(n||i):o.KVO(S),r},providedIn:"root"})}}return i})(),S=(()=>{class i extends w{constructor(e){super(),this._doc=e}sanitize(e,n){if(null==n)return null;switch(e){case o.WPN.NONE:return n;case o.WPN.HTML:return(0,o.ZF7)(n,"HTML")?(0,o.rcV)(n):(0,o.h9k)(this._doc,String(n)).toString();case o.WPN.STYLE:return(0,o.ZF7)(n,"Style")?(0,o.rcV)(n):n;case o.WPN.SCRIPT:if((0,o.ZF7)(n,"Script"))return(0,o.rcV)(n);throw new o.wOt(5200,!1);case o.WPN.URL:return(0,o.ZF7)(n,"URL")?(0,o.rcV)(n):(0,o.$MX)(String(n));case o.WPN.RESOURCE_URL:if((0,o.ZF7)(n,"ResourceURL"))return(0,o.rcV)(n);throw new o.wOt(5201,!1);default:throw new o.wOt(5202,!1)}}bypassSecurityTrustHtml(e){return(0,o.Kcf)(e)}bypassSecurityTrustStyle(e){return(0,o.cWb)(e)}bypassSecurityTrustScript(e){return(0,o.UyX)(e)}bypassSecurityTrustUrl(e){return(0,o.osQ)(e)}bypassSecurityTrustResourceUrl(e){return(0,o.e5t)(e)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const ae="primary",ce=Symbol("RouteTitle");class me{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function se(i){return new me(i)}function be(i,t,e){const n=e.path.split("/");if(n.length>i.length||"full"===e.pathMatch&&(t.hasChildren()||n.length<i.length))return null;const r={};for(let l=0;l<n.length;l++){const m=n[l],C=i[l];if(":"===m[0])r[m.substring(1)]=C;else if(m!==C.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function we(i,t){const e=i?Se(i):void 0,n=t?Se(t):void 0;if(!e||!n||e.length!=n.length)return!1;let r;for(let l=0;l<e.length;l++)if(r=e[l],!pe(i[r],t[r]))return!1;return!0}function Se(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function pe(i,t){if(Array.isArray(i)&&Array.isArray(t)){if(i.length!==t.length)return!1;const e=[...i].sort(),n=[...t].sort();return e.every((r,l)=>n[l]===r)}return i===t}function De(i){return i.length>0?i[i.length-1]:null}function Fe(i){return Tt(i)?i:(0,o.jNT)(i)?Pn(Promise.resolve(i)):di(i)}const Ne={exact:function rt(i,t,e){if(!Wt(i.segments,t.segments)||!ht(i.segments,t.segments,e)||i.numberOfChildren!==t.numberOfChildren)return!1;for(const n in t.children)if(!i.children[n]||!rt(i.children[n],t.children[n],e))return!1;return!0},subset:Pt},je={exact:function Ke(i,t){return we(i,t)},subset:function pt(i,t){return Object.keys(t).length<=Object.keys(i).length&&Object.keys(t).every(e=>pe(i[e],t[e]))},ignored:()=>!0};function at(i,t,e){return Ne[e.paths](i.root,t.root,e.matrixParams)&&je[e.queryParams](i.queryParams,t.queryParams)&&!("exact"===e.fragment&&i.fragment!==t.fragment)}function Pt(i,t,e){return Ze(i,t,t.segments,e)}function Ze(i,t,e,n){if(i.segments.length>e.length){const r=i.segments.slice(0,e.length);return!(!Wt(r,e)||t.hasChildren()||!ht(r,e,n))}if(i.segments.length===e.length){if(!Wt(i.segments,e)||!ht(i.segments,e,n))return!1;for(const r in t.children)if(!i.children[r]||!Pt(i.children[r],t.children[r],n))return!1;return!0}{const r=e.slice(0,i.segments.length),l=e.slice(i.segments.length);return!!(Wt(i.segments,r)&&ht(i.segments,r,n)&&i.children[ae])&&Ze(i.children[ae],t,l,n)}}function ht(i,t,e){return t.every((n,r)=>je[e](i[r].parameters,n.parameters))}class ze{constructor(t=new Ye([],{}),e={},n=null){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap??=se(this.queryParams),this._queryParamMap}toString(){return qi.serialize(this)}}class Ye{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Object.values(e).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Xi(this)}}class Mt{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap??=se(this.parameters),this._parameterMap}toString(){return Do(this)}}function Wt(i,t){return i.length===t.length&&i.every((e,n)=>e.path===t[n].path)}let vi=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:()=>new Yi,providedIn:"root"})}}return i})();class Yi{parse(t){const e=new kl(t);return new ze(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${Sn(t.root,!0)}`,n=function Lr(i){const t=Object.entries(i).map(([e,n])=>Array.isArray(n)?n.map(r=>`${xn(e)}=${xn(r)}`).join("&"):`${xn(e)}=${xn(n)}`).filter(e=>e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${n}${"string"==typeof t.fragment?`#${function Dn(i){return encodeURI(i)}(t.fragment)}`:""}`}}const qi=new Yi;function Xi(i){return i.segments.map(t=>Do(t)).join("/")}function Sn(i,t){if(!i.hasChildren())return Xi(i);if(t){const e=i.children[ae]?Sn(i.children[ae],!1):"",n=[];return Object.entries(i.children).forEach(([r,l])=>{r!==ae&&n.push(`${r}:${Sn(l,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function _i(i,t){let e=[];return Object.entries(i.children).forEach(([n,r])=>{n===ae&&(e=e.concat(t(r,n)))}),Object.entries(i.children).forEach(([n,r])=>{n!==ae&&(e=e.concat(t(r,n)))}),e}(i,(n,r)=>r===ae?[Sn(i.children[ae],!1)]:[`${r}:${Sn(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[ae]?`${Xi(i)}/${e[0]}`:`${Xi(i)}/(${e.join("//")})`}}function bn(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function xn(i){return bn(i).replace(/%3B/gi,";")}function fr(i){return bn(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jr(i){return decodeURIComponent(i)}function Mi(i){return jr(i.replace(/\+/g,"%20"))}function Do(i){return`${fr(i.path)}${function ar(i){return Object.entries(i).map(([t,e])=>`;${fr(t)}=${fr(e)}`).join("")}(i.parameters)}`}const vr=/^[^\/()?;#]+/;function Sr(i){const t=i.match(vr);return t?t[0]:""}const ko=/^[^\/()?;=#]+/,Zs=/^[^=?&#]+/,Dl=/^[^&#]+/;class kl{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ye([],{}):new Ye([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n[ae]=new Ye(t,e)),n}parseSegment(){const t=Sr(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new o.wOt(4009,!1);return this.capture(t),new Mt(jr(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=function Yr(i){const t=i.match(ko);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const r=Sr(this.remaining);r&&(n=r,this.capture(n))}t[jr(e)]=jr(n)}parseQueryParam(t){const e=function ws(i){const t=i.match(Zs);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const m=function hd(i){const t=i.match(Dl);return t?t[0]:""}(this.remaining);m&&(n=m,this.capture(n))}const r=Mi(e),l=Mi(n);if(t.hasOwnProperty(r)){let m=t[r];Array.isArray(m)||(m=[m],t[r]=m),m.push(l)}else t[r]=l}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Sr(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new o.wOt(4010,!1);let l;n.indexOf(":")>-1?(l=n.slice(0,n.indexOf(":")),this.capture(l),this.capture(":")):t&&(l=ae);const m=this.parseChildren();e[l]=1===Object.keys(m).length?m[ae]:new Ye([],m),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new o.wOt(4011,!1)}}function Ks(i){return i.segments.length>0?new Ye([],{[ae]:i}):i}function ks(i){const t={};for(const[n,r]of Object.entries(i.children)){const l=ks(r);if(n===ae&&0===l.segments.length&&l.hasChildren())for(const[m,C]of Object.entries(l.children))t[m]=C;else(l.segments.length>0||l.hasChildren())&&(t[n]=l)}return function Ot(i){if(1===i.numberOfChildren&&i.children[ae]){const t=i.children[ae];return new Ye(i.segments.concat(t.segments),t.children)}return i}(new Ye(i.segments,t))}function Jn(i){return i instanceof ze}function vc(i){let t;const r=Ks(function e(l){const m={};for(const A of l.children){const O=e(A);m[A.outlet]=O}const C=new Ye(l.url,m);return l===i&&(t=C),C}(i.root));return t??r}function lo(i,t,e,n){let r=i;for(;r.parent;)r=r.parent;if(0===t.length)return $a(r,r,r,e,n);const l=function qf(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new Uu(!0,0,i);let t=0,e=!1;const n=i.reduce((r,l,m)=>{if("object"==typeof l&&null!=l){if(l.outlets){const C={};return Object.entries(l.outlets).forEach(([A,O])=>{C[A]="string"==typeof O?O.split("/"):O}),[...r,{outlets:C}]}if(l.segmentPath)return[...r,l.segmentPath]}return"string"!=typeof l?[...r,l]:0===m?(l.split("/").forEach((C,A)=>{0==A&&"."===C||(0==A&&""===C?e=!0:".."===C?t++:""!=C&&r.push(C))}),r):[...r,l]},[]);return new Uu(e,t,n)}(t);if(l.toRoot())return $a(r,r,new Ye([],{}),e,n);const m=function ju(i,t,e){if(i.isAbsolute)return new Yf(t,!0,0);if(!e)return new Yf(t,!1,NaN);if(null===e.parent)return new Yf(e,!0,0);const n=Xc(i.commands[0])?0:1;return function Fx(i,t,e){let n=i,r=t,l=e;for(;l>r;){if(l-=r,n=n.parent,!n)throw new o.wOt(4005,!1);r=n.segments.length}return new Yf(n,!1,r-l)}(e,e.segments.length-1+n,i.numberOfDoubleDots)}(l,r,i),C=m.processChildren?fa(m.segmentGroup,m.index,l.commands):Zf(m.segmentGroup,m.index,l.commands);return $a(r,m.segmentGroup,C,e,n)}function Xc(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Wl(i){return"object"==typeof i&&null!=i&&i.outlets}function $a(i,t,e,n,r){let m,l={};n&&Object.entries(n).forEach(([A,O])=>{l[A]=Array.isArray(O)?O.map(z=>`${z}`):`${O}`}),m=i===t?e:Xf(i,t,e);const C=Ks(ks(m));return new ze(C,l,r)}function Xf(i,t,e){const n={};return Object.entries(i.children).forEach(([r,l])=>{n[r]=l===t?e:Xf(l,t,e)}),new Ye(i.segments,n)}class Uu{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&Xc(n[0]))throw new o.wOt(4003,!1);const r=n.find(Wl);if(r&&r!==De(n))throw new o.wOt(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Yf{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function Zf(i,t,e){if(i??=new Ye([],{}),0===i.segments.length&&i.hasChildren())return fa(i,t,e);const n=function bc(i,t,e){let n=0,r=t;const l={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=e.length)return l;const m=i.segments[r],C=e[n];if(Wl(C))break;const A=`${C}`,O=n<e.length-1?e[n+1]:null;if(r>0&&void 0===A)break;if(A&&O&&"object"==typeof O&&void 0===O.outlets){if(!vC(A,O,m))return l;n+=2}else{if(!vC(A,{},m))return l;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,t,e),r=e.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const l=new Ye(i.segments.slice(0,n.pathIndex),{});return l.children[ae]=new Ye(i.segments.slice(n.pathIndex),i.children),fa(l,0,r)}return n.match&&0===r.length?new Ye(i.segments,{}):n.match&&!i.hasChildren()?up(i,t,e):n.match?fa(i,0,r):up(i,t,e)}function fa(i,t,e){if(0===e.length)return new Ye(i.segments,{});{const n=function _C(i){return Wl(i[0])?i[0].outlets:{[ae]:i}}(e),r={};if(Object.keys(n).some(l=>l!==ae)&&i.children[ae]&&1===i.numberOfChildren&&0===i.children[ae].segments.length){const l=fa(i.children[ae],t,e);return new Ye(i.segments,l.children)}return Object.entries(n).forEach(([l,m])=>{"string"==typeof m&&(m=[m]),null!==m&&(r[l]=Zf(i.children[l],t,m))}),Object.entries(i.children).forEach(([l,m])=>{void 0===n[l]&&(r[l]=m)}),new Ye(i.segments,r)}}function up(i,t,e){const n=i.segments.slice(0,t);let r=0;for(;r<e.length;){const l=e[r];if(Wl(l)){const A=fd(l.outlets);return new Ye(n,A)}if(0===r&&Xc(e[0])){n.push(new Mt(i.segments[t].path,iu(e[0]))),r++;continue}const m=Wl(l)?l.outlets[ae]:`${l}`,C=r<e.length-1?e[r+1]:null;m&&C&&Xc(C)?(n.push(new Mt(m,iu(C))),r+=2):(n.push(new Mt(m,{})),r++)}return new Ye(n,{})}function fd(i){const t={};return Object.entries(i).forEach(([e,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(t[e]=up(new Ye([],{}),0,n))}),t}function iu(i){const t={};return Object.entries(i).forEach(([e,n])=>t[e]=`${n}`),t}function vC(i,t,e){return i==e.path&&we(t,e.parameters)}const Og="imperative";var dr=function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i}(dr||{});class Qo{constructor(t,e){this.id=t,this.url=e}}class hp extends Qo{constructor(t,e,n="imperative",r=null){super(t,e),this.type=dr.NavigationStart,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class md extends Qo{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n,this.type=dr.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var Xl=function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i}(Xl||{}),fp=function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i}(fp||{});class xo extends Qo{constructor(t,e,n,r){super(t,e),this.reason=n,this.code=r,this.type=dr.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ah extends Qo{constructor(t,e,n,r){super(t,e),this.reason=n,this.code=r,this.type=dr.NavigationSkipped}}class pd extends Qo{constructor(t,e,n,r){super(t,e),this.error=n,this.target=r,this.type=dr.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class oy extends Qo{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r,this.type=dr.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Nx extends Qo{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r,this.type=dr.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Bx extends Qo{constructor(t,e,n,r,l){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=l,this.type=dr.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Jo extends Qo{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r,this.type=dr.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fv extends Qo{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r,this.type=dr.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Gu{constructor(t){this.route=t,this.type=dr.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class rl{constructor(t){this.route=t,this.type=dr.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Kf{constructor(t){this.snapshot=t,this.type=dr.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bs{constructor(t){this.snapshot=t,this.type=dr.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class mo{constructor(t){this.snapshot=t,this.type=dr.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vx{constructor(t){this.snapshot=t,this.type=dr.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ql{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n,this.type=dr.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class sy{}class Lg{constructor(t,e){this.url=t,this.navigationBehaviorOptions=e}}class zn{constructor(t){this.injector=t,this.outlet=null,this.route=null,this.children=new Il(this.injector),this.attachRef=null}}let Il=(()=>{class i{constructor(e){this.parentInjector=e,this.contexts=new Map}onChildOutletCreated(e,n){const r=this.getOrCreateContext(e);r.outlet=n,this.contexts.set(e,r)}onChildOutletDestroyed(e){const n=this.getContext(e);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new zn(this.parentInjector),this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(o.uvJ))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();class hs{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=mp(t,this._root);return e?e.children.map(n=>n.value):[]}firstChild(t){const e=mp(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=pp(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return pp(t,this._root).map(e=>e.value)}}function mp(i,t){if(i===t.value)return t;for(const e of t.children){const n=mp(i,e);if(n)return n}return null}function pp(i,t){if(i===t.value)return[t];for(const e of t.children){const n=pp(i,e);if(n.length)return n.unshift(t),n}return[]}class Yl{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Dh(i){const t={};return i&&i.children.forEach(e=>t[e.value.outlet]=e),t}class ay extends hs{constructor(t,e){super(t),this.snapshot=e,nu(this,t)}toString(){return this.snapshot.toString()}}function ly(i){const t=function yC(i){const l=new Un([],{},{},"",{},ae,i,null,{});return new Fg("",new Yl(l,[]))}(i),e=new ro.t([new Mt("",{})]),n=new ro.t({}),r=new ro.t({}),l=new ro.t({}),m=new ro.t(""),C=new qc(e,n,l,m,r,ae,i,t.root);return C.snapshot=t.root,new ay(new Yl(C,[]),t)}class qc{constructor(t,e,n,r,l,m,C,A){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=n,this.fragmentSubject=r,this.dataSubject=l,this.outlet=m,this.component=C,this._futureSnapshot=A,this.title=this.dataSubject?.pipe((0,st.T)(O=>O[ce]))??di(void 0),this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe((0,st.T)(t=>se(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe((0,st.T)(t=>se(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function wn(i,t,e="emptyOnly"){let n;const{routeConfig:r}=i;return n=null===t||"always"!==e&&""!==r?.path&&(t.component||t.routeConfig?.loadComponent)?{params:{...i.params},data:{...i.data},resolve:{...i.data,...i._resolvedData??{}}}:{params:{...t.params,...i.params},data:{...t.data,...i.data},resolve:{...i.data,...t.data,...r?.data,...i._resolvedData}},r&&xC(r)&&(n.resolve[ce]=r.title),n}class Un{get title(){return this.data?.[ce]}constructor(t,e,n,r,l,m,C,A,O){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=l,this.outlet=m,this.component=C,this.routeConfig=A,this._resolve=O}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=se(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=se(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Fg extends hs{constructor(t,e){super(e),this.url=t,nu(this,e)}toString(){return zx(this._root)}}function nu(i,t){t.value._routerState=i,t.children.forEach(e=>nu(i,e))}function zx(i){const t=i.children.length>0?` { ${i.children.map(zx).join(", ")} } `:"";return`${i.value}${t}`}function cy(i){if(i.snapshot){const t=i.snapshot,e=i._futureSnapshot;i.snapshot=e,we(t.queryParams,e.queryParams)||i.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&i.fragmentSubject.next(e.fragment),we(t.params,e.params)||i.paramsSubject.next(e.params),function Me(i,t){if(i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(!we(i[e],t[e]))return!1;return!0}(t.url,e.url)||i.urlSubject.next(e.url),we(t.data,e.data)||i.dataSubject.next(e.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function Ux(i,t){const e=we(i.params,t.params)&&function ti(i,t){return Wt(i,t)&&i.every((e,n)=>we(e.parameters,t[n].parameters))}(i.url,t.url);return e&&!(!i.parent!=!t.parent)&&(!i.parent||Ux(i.parent,t.parent))}function xC(i){return"string"==typeof i.title||null===i.title}let Ng=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=ae,this.activateEvents=new o.bkB,this.deactivateEvents=new o.bkB,this.attachEvents=new o.bkB,this.detachEvents=new o.bkB,this.parentContexts=(0,o.WQX)(Il),this.location=(0,o.WQX)(o.c1b),this.changeDetector=(0,o.WQX)(o.gRc),this.inputBinder=(0,o.WQX)(_p,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(e){if(e.name){const{firstChange:n,previousValue:r}=e.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new o.wOt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new o.wOt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new o.wOt(4012,!1);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,n){this.activated=e,this._activatedRoute=n,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,n){if(this.isActivated)throw new o.wOt(4013,!1);this._activatedRoute=e;const r=this.location,m=e.snapshot.component,C=this.parentContexts.getOrCreateContext(this.name).children,A=new gp(e,C,r.injector);this.activated=r.createComponent(m,{index:r.length,injector:A,environmentInjector:n}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[o.OA$]})}}return i})();class gp{__ngOutletInjector(t){return new gp(this.route,this.childContexts,t)}constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===qc?this.route:t===Il?this.childContexts:this.parent.get(t,e)}}const _p=new o.nKC("");let vp=(()=>{class i{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){const{activatedRoute:n}=e,r=ri([n.queryParams,n.params,n.data]).pipe(So(([l,m,C],A)=>(C={...l,...m,...C},0===A?di(C):Promise.resolve(C)))).subscribe(l=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==n||null===n.component)return void this.unsubscribeFromRouteData(e);const m=(0,o.HJs)(n.component);if(m)for(const{templateName:C}of m.inputs)e.activatedComponentRef.setInput(C,l[C]);else this.unsubscribeFromRouteData(e)});this.outletDataSubscriptions.set(e,r)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();function Hu(i,t,e){if(e&&i.shouldReuseRoute(t.value,e.value.snapshot)){const n=e.value;n._futureSnapshot=t.value;const r=function $u(i,t,e){return t.children.map(n=>{for(const r of e.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return Hu(i,n,r);return Hu(i,n)})}(i,t,e);return new Yl(n,r)}{if(i.shouldAttach(t.value)){const l=i.retrieve(t.value);if(null!==l){const m=l.route;return m.value._futureSnapshot=t.value,m.children=t.children.map(C=>Hu(i,C)),m}}const n=function jx(i){return new qc(new ro.t(i.url),new ro.t(i.params),new ro.t(i.queryParams),new ro.t(i.fragment),new ro.t(i.data),i.outlet,i.component,i)}(t.value),r=t.children.map(l=>Hu(i,l));return new Yl(n,r)}}class or{constructor(t,e){this.redirectTo=t,this.navigationBehaviorOptions=e}}const Gx="ngNavigationCancelingError";function Rl(i,t){const{redirectTo:e,navigationBehaviorOptions:n}=Jn(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=dy(!1,Xl.Redirect);return r.url=e,r.navigationBehaviorOptions=n,r}function dy(i,t){const e=new Error(`NavigationCancelingError: ${i||""}`);return e[Gx]=!0,e.cancellationCode=t,e}function gd(i){return!!i&&i[Gx]}let Hx=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["ng-component"]],standalone:!0,features:[o.aNF],decls:1,vars:0,template:function(n,r){1&n&&o.nrm(0,"router-outlet")},dependencies:[Ng],encapsulation:2})}}return i})();function _d(i){const t=i.children&&i.children.map(_d),e=t?{...i,children:t}:{...i};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==ae&&(e.component=Hx),e}function Qs(i){return i.outlet||ae}function yc(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let t=i.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class Yx{constructor(t,e,n,r,l){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r,this.inputBindingEnabled=l}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),cy(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=Dh(e);t.children.forEach(l=>{const m=l.value.outlet;this.deactivateRoutes(l,r[m],n),delete r[m]}),Object.values(r).forEach(l=>{this.deactivateRouteAndItsChildren(l,n)})}deactivateRoutes(t,e,n){const r=t.value,l=e?e.value:null;if(r===l)if(r.component){const m=n.getContext(r.outlet);m&&this.deactivateChildRoutes(t,e,m.children)}else this.deactivateChildRoutes(t,e,n);else l&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet),r=n&&t.value.component?n.children:e,l=Dh(t);for(const m of Object.values(l))this.deactivateRouteAndItsChildren(m,r);if(n&&n.outlet){const m=n.outlet.detach(),C=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:m,route:t,contexts:C})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),r=n&&t.value.component?n.children:e,l=Dh(t);for(const m of Object.values(l))this.deactivateRouteAndItsChildren(m,r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(t,e,n){const r=Dh(e);t.children.forEach(l=>{this.activateRoutes(l,r[l.value.outlet],n),this.forwardEvent(new Vx(l.value.snapshot))}),t.children.length&&this.forwardEvent(new bs(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,l=e?e.value:null;if(cy(r),r===l)if(r.component){const m=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,m.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const m=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const C=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),m.children.onOutletReAttached(C.contexts),m.attachRef=C.componentRef,m.route=C.route.value,m.outlet&&m.outlet.attach(C.componentRef,C.route.value),cy(C.route.value),this.activateChildRoutes(t,null,m.children)}else{const C=yc(r.snapshot);m.attachRef=null,m.route=r,m.injector=C??m.injector,m.outlet&&m.outlet.activateWith(r,m.injector),this.activateChildRoutes(t,null,m.children)}}else this.activateChildRoutes(t,null,n)}}class Jf{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Wu{constructor(t,e){this.component=t,this.route=e}}function ra(i,t,e){const n=i._root;return tm(n,t?t._root:null,e,[n.value])}function em(i,t){const e=Symbol(),n=t.get(i,e);return n===e?"function"!=typeof i||(0,o.LfX)(i)?t.get(i):i:n}function tm(i,t,e,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const l=Dh(t);return i.children.forEach(m=>{(function AC(i,t,e,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const l=i.value,m=t?t.value:null,C=e?e.getContext(i.value.outlet):null;if(m&&l.routeConfig===m.routeConfig){const A=function Zx(i,t,e){if("function"==typeof e)return e(i,t);switch(e){case"pathParamsChange":return!Wt(i.url,t.url);case"pathParamsOrQueryParamsChange":return!Wt(i.url,t.url)||!we(i.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ux(i,t)||!we(i.queryParams,t.queryParams);default:return!Ux(i,t)}}(m,l,l.routeConfig.runGuardsAndResolvers);A?r.canActivateChecks.push(new Jf(n)):(l.data=m.data,l._resolvedData=m._resolvedData),tm(i,t,l.component?C?C.children:null:e,n,r),A&&C&&C.outlet&&C.outlet.isActivated&&r.canDeactivateChecks.push(new Wu(C.outlet.component,m))}else m&&Xu(t,C,r),r.canActivateChecks.push(new Jf(n)),tm(i,null,l.component?C?C.children:null:e,n,r)})(m,l[m.value.outlet],e,n.concat([m.value]),r),delete l[m.value.outlet]}),Object.entries(l).forEach(([m,C])=>Xu(C,e.getContext(m),r)),r}function Xu(i,t,e){const n=Dh(i),r=i.value;Object.entries(n).forEach(([l,m])=>{Xu(m,r.component?t?t.children.getContext(l):null:t,e)}),e.canDeactivateChecks.push(new Wu(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}function Zl(i){return"function"==typeof i}function vd(i){return i instanceof zi||"EmptyError"===i?.name}const gv=Symbol("INITIAL_VALUE");function mr(){return So(i=>ri(i.map(t=>t.pipe(gs(1),As(gv)))).pipe((0,st.T)(t=>{for(const e of t)if(!0!==e){if(e===gv)return gv;if(!1===e||py(e))return e}return!0}),Ur(t=>t!==gv),gs(1)))}function py(i){return Jn(i)||i instanceof or}function _y(i){return(0,Ss.F)(Oo(t=>{if("boolean"!=typeof t)throw Rl(0,t)}),(0,st.T)(t=>!0===t))}class Xn{constructor(t){this.segmentGroup=t||null}}class Pl extends Error{constructor(t){super(),this.urlTree=t}}function Yc(i){return $s(new Xn(i))}class tw{constructor(t,e){this.urlSerializer=t,this.urlTree=e}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return di(n);if(r.numberOfChildren>1||!r.children[ae])return $s(new o.wOt(4e3,!1));r=r.children[ae]}}applyRedirectCommands(t,e,n,r,l){if("string"!=typeof e){const C=e,{queryParams:A,fragment:O,routeConfig:z,url:$,outlet:Q,params:te,data:de,title:fe}=r,ge=(0,o.N4e)(l,()=>C({params:te,data:de,queryParams:A,fragment:O,routeConfig:z,url:$,outlet:Q,title:fe}));if(ge instanceof ze)throw new Pl(ge);e=ge}const m=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,n);if("/"===e[0])throw new Pl(m);return m}applyRedirectCreateUrlTree(t,e,n,r){const l=this.createSegmentGroup(t,e.root,n,r);return new ze(l,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return Object.entries(t).forEach(([r,l])=>{if("string"==typeof l&&":"===l[0]){const C=l.substring(1);n[r]=e[C]}else n[r]=l}),n}createSegmentGroup(t,e,n,r){const l=this.createSegments(t,e.segments,n,r);let m={};return Object.entries(e.children).forEach(([C,A])=>{m[C]=this.createSegmentGroup(t,A,n,r)}),new Ye(l,m)}createSegments(t,e,n,r){return e.map(l=>":"===l.path[0]?this.findPosParam(t,l,r):this.findOrReturn(l,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new o.wOt(4001,!1);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}const iw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function XS(i,t,e,n,r){const l=nw(i,t,e);return l.matched?(n=function mv(i,t){return i.providers&&!i._injector&&(i._injector=(0,o.Ol2)(i.providers,t,`Route: ${i.path}`)),i._injector??t}(t,n),function ew(i,t,e,n){const r=t.canMatch;return r&&0!==r.length?di(r.map(m=>{const C=em(m,i);return Fe(function GS(i){return i&&Zl(i.canMatch)}(C)?C.canMatch(t,e):(0,o.N4e)(i,()=>C(t,e)))})).pipe(mr(),_y()):di(!0)}(n,t,e).pipe((0,st.T)(m=>!0===m?l:{...iw}))):di(l)}function nw(i,t,e){if("**"===t.path)return function qS(i){return{matched:!0,parameters:i.length>0?De(i).parameters:{},consumedSegments:i,remainingSegments:[],positionalParamSegments:{}}}(e);if(""===t.path)return"full"===t.pathMatch&&(i.hasChildren()||e.length>0)?{...iw}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const r=(t.matcher||be)(e,i,t);if(!r)return{...iw};const l={};Object.entries(r.posParams??{}).forEach(([C,A])=>{l[C]=A.path});const m=r.consumed.length>0?{...l,...r.consumed[r.consumed.length-1].parameters}:l;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:m,positionalParamSegments:r.posParams??{}}}function RC(i,t,e,n){return e.length>0&&function _v(i,t,e){return e.some(n=>qu(i,t,n)&&Qs(n)!==ae)}(i,e,n)?{segmentGroup:new Ye(t,im(n,new Ye(e,i.children))),slicedSegments:[]}:0===e.length&&function PC(i,t,e){return e.some(n=>qu(i,t,n))}(i,e,n)?{segmentGroup:new Ye(i.segments,YS(i,e,n,i.children)),slicedSegments:e}:{segmentGroup:new Ye(i.segments,i.children),slicedSegments:e}}function YS(i,t,e,n){const r={};for(const l of e)if(qu(i,t,l)&&!n[Qs(l)]){const m=new Ye([],{});r[Qs(l)]=m}return{...n,...r}}function im(i,t){const e={};e[ae]=t;for(const n of i)if(""===n.path&&Qs(n)!==ae){const r=new Ye([],{});e[Qs(n)]=r}return e}function qu(i,t,e){return(!(i.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}class Yu{}class vv{constructor(t,e,n,r,l,m,C){this.injector=t,this.configLoader=e,this.rootComponentType=n,this.config=r,this.urlTree=l,this.paramsInheritanceStrategy=m,this.urlSerializer=C,this.applyRedirects=new tw(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(t){return new o.wOt(4002,`'${t.segmentGroup}'`)}recognize(){const t=RC(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe((0,st.T)(({children:e,rootSnapshot:n})=>{const r=new Yl(n,e),l=new Fg("",r),m=function nl(i,t,e=null,n=null){return lo(vc(i),t,e,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return m.queryParams=this.urlTree.queryParams,l.url=this.urlSerializer.serialize(m),{state:l,tree:m}}))}match(t){const e=new Un([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Object.freeze({}),ae,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,ae,e).pipe((0,st.T)(n=>({children:n,rootSnapshot:e})),xa(n=>{if(n instanceof Pl)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Xn?this.noMatchError(n):n}))}processSegmentGroup(t,e,n,r,l){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,e,n,l):this.processSegment(t,e,n,n.segments,r,!0,l).pipe((0,st.T)(m=>m instanceof Yl?[m]:[]))}processChildren(t,e,n,r){const l=[];for(const m of Object.keys(n.children))"primary"===m?l.unshift(m):l.push(m);return Pn(l).pipe(ld(m=>{const C=n.children[m],A=function pv(i,t){const e=i.filter(n=>Qs(n)===t);return e.push(...i.filter(n=>Qs(n)!==t)),e}(e,m);return this.processSegmentGroup(t,A,C,m,r)}),function Tl(i,t){return(0,ut.N)(Bf(i,t,arguments.length>=2,!0))}((m,C)=>(m.push(...C),m)),ua(null),function Vf(i,t){const e=arguments.length>=2;return n=>n.pipe(i?Ur((r,l)=>i(r,l,n)):Vt.D,dv(1),e?ua(t):jc(()=>new zi))}(),hr(m=>{if(null===m)return Yc(n);const C=bd(m);return function QS(i){i.sort((t,e)=>t.value.outlet===ae?-1:e.value.outlet===ae?1:t.value.outlet.localeCompare(e.value.outlet))}(C),di(C)}))}processSegment(t,e,n,r,l,m,C){return Pn(e).pipe(ld(A=>this.processSegmentAgainstRoute(A._injector??t,e,A,n,r,l,m,C).pipe(xa(O=>{if(O instanceof Xn)return di(null);throw O}))),Lu(A=>!!A),xa(A=>{if(vd(A))return function ZS(i,t,e){return 0===t.length&&!i.children[e]}(n,r,l)?di(new Yu):Yc(n);throw A}))}processSegmentAgainstRoute(t,e,n,r,l,m,C,A){return function Zk(i,t,e,n){return!!(Qs(i)===n||n!==ae&&qu(t,e,i))&&nw(t,i,e).matched}(n,r,l,m)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(t,r,n,l,m,A):this.allowRedirects&&C?this.expandSegmentAgainstRouteUsingRedirect(t,r,e,n,l,m,A):Yc(r):Yc(r)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,l,m,C){const{matched:A,parameters:O,consumedSegments:z,positionalParamSegments:$,remainingSegments:Q}=nw(e,r,l);if(!A)return Yc(e);"string"==typeof r.redirectTo&&"/"===r.redirectTo[0]&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const te=new Un(l,O,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,yp(r),Qs(r),r.component??r._loadedComponent??null,r,nm(r)),de=wn(te,C,this.paramsInheritanceStrategy);te.params=Object.freeze(de.params),te.data=Object.freeze(de.data);const fe=this.applyRedirects.applyRedirectCommands(z,r.redirectTo,$,te,t);return this.applyRedirects.lineralizeSegments(r,fe).pipe(hr(ge=>this.processSegment(t,n,e,ge.concat(Q),m,!1,C)))}matchSegmentAgainstRoute(t,e,n,r,l,m){const C=XS(e,n,r,t);return"**"===n.path&&(e.children={}),C.pipe(So(A=>A.matched?this.getChildConfig(t=n._injector??t,n,r).pipe(So(({routes:O})=>{const z=n._loadedInjector??t,{parameters:$,consumedSegments:Q,remainingSegments:te}=A,de=new Un(Q,$,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,yp(n),Qs(n),n.component??n._loadedComponent??null,n,nm(n)),fe=wn(de,m,this.paramsInheritanceStrategy);de.params=Object.freeze(fe.params),de.data=Object.freeze(fe.data);const{segmentGroup:ge,slicedSegments:Re}=RC(e,Q,te,O);if(0===Re.length&&ge.hasChildren())return this.processChildren(z,O,ge,de).pipe((0,st.T)(et=>new Yl(de,et)));if(0===O.length&&0===Re.length)return di(new Yl(de,[]));const qe=Qs(n)===l;return this.processSegment(z,O,ge,Re,qe?ae:l,!0,de).pipe((0,st.T)(et=>new Yl(de,et instanceof Yl?[et]:[])))})):Yc(e)))}getChildConfig(t,e,n){return e.children?di({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?di({routes:e._loadedRoutes,injector:e._loadedInjector}):function WS(i,t,e,n){const r=t.canLoad;return void 0===r||0===r.length?di(!0):di(r.map(m=>{const C=em(m,i);return Fe(function hy(i){return i&&Zl(i.canLoad)}(C)?C.canLoad(t,e):(0,o.N4e)(i,()=>C(t,e)))})).pipe(mr(),_y())}(t,e,n).pipe(hr(r=>r?this.configLoader.loadChildren(t,e).pipe(Oo(l=>{e._loadedRoutes=l.routes,e._loadedInjector=l.injector})):function IC(){return $s(dy(!1,Xl.GuardRejected))}())):di({routes:[],injector:t})}}function rw(i){const t=i.value.routeConfig;return t&&""===t.path}function bd(i){const t=[],e=new Set;for(const n of i){if(!rw(n)){t.push(n);continue}const r=t.find(l=>n.value.routeConfig===l.value.routeConfig);void 0!==r?(r.children.push(...n.children),e.add(r)):t.push(n)}for(const n of e){const r=bd(n.children);t.push(new Yl(n.value,r))}return t.filter(n=>!e.has(n))}function yp(i){return i.data||{}}function nm(i){return i.resolve||{}}function ow(i){const t=i.children.map(e=>ow(e)).flat();return[i,...t]}function Oa(i){return So(t=>{const e=i(t);return e?Pn(e).pipe((0,st.T)(()=>t)):di(t)})}let yy=(()=>{class i{buildTitle(e){let n,r=e.root;for(;void 0!==r;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(l=>l.outlet===ae);return n}getResolvedTitleForRoute(e){return e.data[ce]}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:()=>(0,o.WQX)(sw),providedIn:"root"})}}return i})(),sw=(()=>{class i extends yy{constructor(e){super(),this.title=e}updateTitle(e){const n=this.buildTitle(e);void 0!==n&&this.title.setTitle(n)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(cp))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const yd=new o.nKC("",{providedIn:"root",factory:()=>({})}),yv=new o.nKC("");let aw=(()=>{class i{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,o.WQX)(o.Ql9)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return di(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const n=Fe(e.loadComponent()).pipe((0,st.T)(xd),Oo(l=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=l}),Ir(()=>{this.componentLoaders.delete(e)})),r=new Ps(n,()=>new xi.B).pipe(bl());return this.componentLoaders.set(e,r),r}loadChildren(e,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return di({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);const l=function Ol(i,t,e,n){return Fe(i.loadChildren()).pipe((0,st.T)(xd),hr(r=>r instanceof o.Co$||Array.isArray(r)?di(r):Pn(t.compileModuleAsync(r))),(0,st.T)(r=>{n&&n(i);let l,m,C=!1;return Array.isArray(r)?(m=r,!0):(l=r.create(e).injector,m=l.get(yv,[],{optional:!0,self:!0}).flat()),{routes:m.map(_d),injector:l}}))}(n,this.compiler,e,this.onLoadEndListener).pipe(Ir(()=>{this.childrenLoaders.delete(n)})),m=new Ps(l,()=>new xi.B).pipe(bl());return this.childrenLoaders.set(n,m),m}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function xd(i){return function rm(i){return i&&"object"==typeof i&&"default"in i}(i)?i.default:i}let wd=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:()=>(0,o.WQX)(FC),providedIn:"root"})}}return i})(),FC=(()=>{class i{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const xy=new o.nKC(""),xv=new o.nKC("");function wy(i,t,e){const n=i.get(xv),r=i.get(Nn);return i.get(o.SKi).runOutsideAngular(()=>{if(!r.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(O=>setTimeout(O));let l;const m=new Promise(O=>{l=O}),C=r.startViewTransition(()=>(l(),function wv(i){return new Promise(t=>{(0,o.mal)(()=>setTimeout(t),{injector:i,phase:o.wjH.Read})})}(i))),{onViewTransitionCreated:A}=n;return A&&(0,o.N4e)(i,()=>A({transition:C,from:t,to:e})),m})}const Bg=new o.nKC("");let Cv=(()=>{class i{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new xi.B,this.transitionAbortSubject=new xi.B,this.configLoader=(0,o.WQX)(aw),this.environmentInjector=(0,o.WQX)(o.uvJ),this.urlSerializer=(0,o.WQX)(vi),this.rootContexts=(0,o.WQX)(Il),this.location=(0,o.WQX)(Ma),this.inputBindingEnabled=null!==(0,o.WQX)(_p,{optional:!0}),this.titleStrategy=(0,o.WQX)(yy),this.options=(0,o.WQX)(yd,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=(0,o.WQX)(wd),this.createViewTransition=(0,o.WQX)(xy,{optional:!0}),this.navigationErrorHandler=(0,o.WQX)(Bg,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>di(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new rl(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Gu(r))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const n=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:n})}setupNavigations(e,n,r){return this.transitions=new ro.t({id:0,currentUrlTree:n,currentRawUrl:n,extractedUrl:this.urlHandlingStrategy.extract(n),urlAfterRedirects:this.urlHandlingStrategy.extract(n),rawUrl:n,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Og,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ur(l=>0!==l.id),(0,st.T)(l=>({...l,extractedUrl:this.urlHandlingStrategy.extract(l.rawUrl)})),So(l=>{let m=!1,C=!1;return di(l).pipe(So(A=>{if(this.navigationId>l.id)return this.cancelNavigationTransition(l,"",Xl.SupersededByNewNavigation),nr;this.currentTransition=l,this.currentNavigation={id:A.id,initialUrl:A.rawUrl,extractedUrl:A.extractedUrl,trigger:A.source,extras:A.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const O=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!O&&"reload"!==(A.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const $="";return this.events.next(new Ah(A.id,this.urlSerializer.serialize(A.rawUrl),$,fp.IgnoredSameUrlNavigation)),A.resolve(!1),nr}if(this.urlHandlingStrategy.shouldProcessUrl(A.rawUrl))return di(A).pipe(So($=>{const Q=this.transitions?.getValue();return this.events.next(new hp($.id,this.urlSerializer.serialize($.extractedUrl),$.source,$.restoredState)),Q!==this.transitions?.getValue()?nr:Promise.resolve($)}),function OC(i,t,e,n,r,l){return hr(m=>function KS(i,t,e,n,r,l,m="emptyOnly"){return new vv(i,t,e,n,r,m,l).recognize()}(i,t,e,n,m.extractedUrl,r,l).pipe((0,st.T)(({state:C,tree:A})=>({...m,targetSnapshot:C,urlAfterRedirects:A}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),Oo($=>{l.targetSnapshot=$.targetSnapshot,l.urlAfterRedirects=$.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:$.urlAfterRedirects};const Q=new oy($.id,this.urlSerializer.serialize($.extractedUrl),this.urlSerializer.serialize($.urlAfterRedirects),$.targetSnapshot);this.events.next(Q)}));if(O&&this.urlHandlingStrategy.shouldProcessUrl(A.currentRawUrl)){const{id:$,extractedUrl:Q,source:te,restoredState:de,extras:fe}=A,ge=new hp($,this.urlSerializer.serialize(Q),te,de);this.events.next(ge);const Re=ly(this.rootComponentType).snapshot;return this.currentTransition=l={...A,targetSnapshot:Re,urlAfterRedirects:Q,extras:{...fe,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=Q,di(l)}{const $="";return this.events.next(new Ah(A.id,this.urlSerializer.serialize(A.extractedUrl),$,fp.IgnoredByUrlHandlingStrategy)),A.resolve(!1),nr}}),Oo(A=>{const O=new Nx(A.id,this.urlSerializer.serialize(A.extractedUrl),this.urlSerializer.serialize(A.urlAfterRedirects),A.targetSnapshot);this.events.next(O)}),(0,st.T)(A=>(this.currentTransition=l={...A,guards:ra(A.targetSnapshot,A.currentSnapshot,this.rootContexts)},l)),function Kl(i,t){return hr(e=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:l,canDeactivateChecks:m}}=e;return 0===m.length&&0===l.length?di({...e,guardsResult:!0}):function kh(i,t,e,n){return Pn(i).pipe(hr(r=>function DC(i,t,e,n,r){const l=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return l&&0!==l.length?di(l.map(C=>{const A=yc(t)??r,O=em(C,A);return Fe(function Qx(i){return i&&Zl(i.canDeactivate)}(O)?O.canDeactivate(i,t,e,n):(0,o.N4e)(A,()=>O(i,t,e,n))).pipe(Lu())})).pipe(mr()):di(!0)}(r.component,r.route,e,t,n)),Lu(r=>!0!==r,!0))}(m,n,r,i).pipe(hr(C=>C&&function Kx(i){return"boolean"==typeof i}(C)?function HS(i,t,e,n){return Pn(t).pipe(ld(r=>bo(function gy(i,t){return null!==i&&t&&t(new Kf(i)),di(!0)}(r.route.parent,n),function Jx(i,t){return null!==i&&t&&t(new mo(i)),di(!0)}(r.route,n),function $S(i,t,e){const n=t[t.length-1],l=t.slice(0,t.length-1).reverse().map(m=>function MC(i){const t=i.routeConfig?i.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:i,guards:t}:null}(m)).filter(m=>null!==m).map(m=>ir(()=>di(m.guards.map(A=>{const O=yc(m.node)??e,z=em(A,O);return Fe(function my(i){return i&&Zl(i.canActivateChild)}(z)?z.canActivateChild(n,i):(0,o.N4e)(O,()=>z(n,i))).pipe(Lu())})).pipe(mr())));return di(l).pipe(mr())}(i,r.path,e),function Pa(i,t,e){const n=t.routeConfig?t.routeConfig.canActivate:null;if(!n||0===n.length)return di(!0);const r=n.map(l=>ir(()=>{const m=yc(t)??e,C=em(l,m);return Fe(function fy(i){return i&&Zl(i.canActivate)}(C)?C.canActivate(t,i):(0,o.N4e)(m,()=>C(t,i))).pipe(Lu())}));return di(r).pipe(mr())}(i,r.route,e))),Lu(r=>!0!==r,!0))}(n,l,i,t):di(C)),(0,st.T)(C=>({...e,guardsResult:C})))})}(this.environmentInjector,A=>this.events.next(A)),Oo(A=>{if(l.guardsResult=A.guardsResult,A.guardsResult&&"boolean"!=typeof A.guardsResult)throw Rl(0,A.guardsResult);const O=new Bx(A.id,this.urlSerializer.serialize(A.extractedUrl),this.urlSerializer.serialize(A.urlAfterRedirects),A.targetSnapshot,!!A.guardsResult);this.events.next(O)}),Ur(A=>!!A.guardsResult||(this.cancelNavigationTransition(A,"",Xl.GuardRejected),!1)),Oa(A=>{if(A.guards.canActivateChecks.length)return di(A).pipe(Oo(O=>{const z=new Jo(O.id,this.urlSerializer.serialize(O.extractedUrl),this.urlSerializer.serialize(O.urlAfterRedirects),O.targetSnapshot);this.events.next(z)}),So(O=>{let z=!1;return di(O).pipe(function LC(i,t){return hr(e=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=e;if(!r.length)return di(e);const l=new Set(r.map(A=>A.route)),m=new Set;for(const A of l)if(!m.has(A))for(const O of ow(A))m.add(O);let C=0;return Pn(m).pipe(ld(A=>l.has(A)?function by(i,t,e,n){const r=i.routeConfig,l=i._resolve;return void 0!==r?.title&&!xC(r)&&(l[ce]=r.title),function ss(i,t,e,n){const r=Se(i);if(0===r.length)return di({});const l={};return Pn(r).pipe(hr(m=>function JS(i,t,e,n){const r=yc(t)??n,l=em(i,r);return Fe(l.resolve?l.resolve(t,e):(0,o.N4e)(r,()=>l(t,e)))}(i[m],t,e,n).pipe(Lu(),Oo(C=>{if(C instanceof or)throw Rl(new Yi,C);l[m]=C}))),dv(1),vo(l),xa(m=>vd(m)?nr:$s(m)))}(l,i,t,n).pipe((0,st.T)(m=>(i._resolvedData=m,i.data=wn(i,i.parent,e).resolve,null)))}(A,n,i,t):(A.data=wn(A,A.parent,i).resolve,di(void 0))),Oo(()=>C++),dv(1),hr(A=>C===m.size?di(e):nr))})}(this.paramsInheritanceStrategy,this.environmentInjector),Oo({next:()=>z=!0,complete:()=>{z||this.cancelNavigationTransition(O,"",Xl.NoDataFromResolver)}}))}),Oo(O=>{const z=new fv(O.id,this.urlSerializer.serialize(O.extractedUrl),this.urlSerializer.serialize(O.urlAfterRedirects),O.targetSnapshot);this.events.next(z)}))}),Oa(A=>{const O=z=>{const $=[];z.routeConfig?.loadComponent&&!z.routeConfig._loadedComponent&&$.push(this.configLoader.loadComponent(z.routeConfig).pipe(Oo(Q=>{z.component=Q}),(0,st.T)(()=>{})));for(const Q of z.children)$.push(...O(Q));return $};return ri(O(A.targetSnapshot.root)).pipe(ua(null),gs(1))}),Oa(()=>this.afterPreactivation()),So(()=>{const{currentSnapshot:A,targetSnapshot:O}=l,z=this.createViewTransition?.(this.environmentInjector,A.root,O.root);return z?Pn(z).pipe((0,st.T)(()=>l)):di(l)}),(0,st.T)(A=>{const O=function wC(i,t,e){const n=Hu(i,t._root,e?e._root:void 0);return new ay(n,t)}(e.routeReuseStrategy,A.targetSnapshot,A.currentRouterState);return this.currentTransition=l={...A,targetRouterState:O},this.currentNavigation.targetRouterState=O,l}),Oo(()=>{this.events.next(new sy)}),((i,t,e,n)=>(0,st.T)(r=>(new Yx(t,r.targetRouterState,r.currentRouterState,e,n).activate(i),r)))(this.rootContexts,e.routeReuseStrategy,A=>this.events.next(A),this.inputBindingEnabled),gs(1),Oo({next:A=>{m=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new md(A.id,this.urlSerializer.serialize(A.extractedUrl),this.urlSerializer.serialize(A.urlAfterRedirects))),this.titleStrategy?.updateTitle(A.targetRouterState.snapshot),A.resolve(!0)},complete:()=>{m=!0}}),dn(this.transitionAbortSubject.pipe(Oo(A=>{throw A}))),Ir(()=>{!m&&!C&&this.cancelNavigationTransition(l,"",Xl.SupersededByNewNavigation),this.currentTransition?.id===l.id&&(this.currentNavigation=null,this.currentTransition=null)}),xa(A=>{if(C=!0,gd(A))this.events.next(new xo(l.id,this.urlSerializer.serialize(l.extractedUrl),A.message,A.cancellationCode)),function CC(i){return gd(i)&&Jn(i.url)}(A)?this.events.next(new Lg(A.url,A.navigationBehaviorOptions)):l.resolve(!1);else{const O=new pd(l.id,this.urlSerializer.serialize(l.extractedUrl),A,l.targetSnapshot??void 0);try{const z=(0,o.N4e)(this.environmentInjector,()=>this.navigationErrorHandler?.(O));if(z instanceof or){const{message:$,cancellationCode:Q}=Rl(0,z);this.events.next(new xo(l.id,this.urlSerializer.serialize(l.extractedUrl),$,Q)),this.events.next(new Lg(z.redirectTo,z.navigationBehaviorOptions))}else{this.events.next(O);const $=e.errorHandler(A);l.resolve(!!$)}}catch(z){this.options.resolveNavigationPromiseOnError?l.resolve(!1):l.reject(z)}}return nr}))}))}cancelNavigationTransition(e,n,r){const l=new xo(e.id,this.urlSerializer.serialize(e.extractedUrl),n,r);this.events.next(l),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Cy(i){return i!==Og}let lw=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:()=>(0,o.WQX)(dw),providedIn:"root"})}}return i})();class cw{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let dw=(()=>{class i extends cw{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Ey=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:()=>(0,o.WQX)(Ih),providedIn:"root"})}}return i})(),Ih=(()=>{class i extends Ey{constructor(){super(...arguments),this.location=(0,o.WQX)(Ma),this.urlSerializer=(0,o.WQX)(vi),this.options=(0,o.WQX)(yd,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=(0,o.WQX)(wd),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ze,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=ly(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(n=>{"popstate"===n.type&&e(n.url,n.state)})}handleRouterEvent(e,n){if(e instanceof hp)this.stateMemento=this.createStateMemento();else if(e instanceof Ah)this.rawUrlTree=n.initialUrl;else if(e instanceof oy){if("eager"===this.urlUpdateStrategy&&!n.extras.skipLocationChange){const r=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl);this.setBrowserUrl(r,n)}}else e instanceof sy?(this.currentUrlTree=n.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl),this.routerState=n.targetRouterState,"deferred"===this.urlUpdateStrategy&&(n.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,n))):e instanceof xo&&(e.code===Xl.GuardRejected||e.code===Xl.NoDataFromResolver)?this.restoreHistory(n):e instanceof pd?this.restoreHistory(n,!0):e instanceof md&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,n){const r=this.urlSerializer.serialize(e);if(this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl){const m={...n.extras.state,...this.generateNgRouterState(n.id,this.browserPageId)};this.location.replaceState(r,"",m)}else{const l={...n.extras.state,...this.generateNgRouterState(n.id,this.browserPageId+1)};this.location.go(r,"",l)}}restoreHistory(e,n=!1){if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-this.browserPageId;0!==l?this.location.historyGo(l):this.currentUrlTree===e.finalUrl&&0===l&&(this.resetState(e),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,n){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:n}:{navigationId:e}}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Rh=function(i){return i[i.COMPLETE=0]="COMPLETE",i[i.FAILED=1]="FAILED",i[i.REDIRECTING=2]="REDIRECTING",i}(Rh||{});function Ev(i,t){i.events.pipe(Ur(e=>e instanceof md||e instanceof xo||e instanceof pd||e instanceof Ah),(0,st.T)(e=>e instanceof md||e instanceof Ah?Rh.COMPLETE:e instanceof xo&&(e.code===Xl.Redirect||e.code===Xl.SupersededByNewNavigation)?Rh.REDIRECTING:Rh.FAILED),Ur(e=>e!==Rh.REDIRECTING),gs(1)).subscribe(()=>{t()})}function uw(i){throw i}const NC={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},BC={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Cd=(()=>{class i{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=(0,o.WQX)(o.H3F),this.stateManager=(0,o.WQX)(Ey),this.options=(0,o.WQX)(yd,{optional:!0})||{},this.pendingTasks=(0,o.WQX)(o.TgB),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=(0,o.WQX)(Cv),this.urlSerializer=(0,o.WQX)(vi),this.location=(0,o.WQX)(Ma),this.urlHandlingStrategy=(0,o.WQX)(wd),this._events=new xi.B,this.errorHandler=this.options.errorHandler||uw,this.navigated=!1,this.routeReuseStrategy=(0,o.WQX)(lw),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=(0,o.WQX)(yv,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!(0,o.WQX)(_p,{optional:!0}),this.eventsSubscription=new On.yU,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const e=this.navigationTransitions.events.subscribe(n=>{try{const r=this.navigationTransitions.currentTransition,l=this.navigationTransitions.currentNavigation;if(null!==r&&null!==l)if(this.stateManager.handleRouterEvent(n,l),n instanceof xo&&n.code!==Xl.Redirect&&n.code!==Xl.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof md)this.navigated=!0;else if(n instanceof Lg){const m=n.navigationBehaviorOptions,C=this.urlHandlingStrategy.merge(n.url,r.currentRawUrl),A={info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||"eager"===this.urlUpdateStrategy||Cy(r.source),...m};this.scheduleNavigation(C,Og,null,A,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function zC(i){return!(i instanceof sy||i instanceof Lg)})(n)&&this._events.next(n)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Og,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,n)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(e,"popstate",n)},0)})}navigateToSyncWithBrowser(e,n,r){const l={replaceUrl:!0},m=r?.navigationId?r:null;if(r){const A={...r};delete A.navigationId,delete A.\u0275routerPageId,0!==Object.keys(A).length&&(l.state=A)}const C=this.parseUrl(e);this.scheduleNavigation(C,n,m,l)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(_d),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,n={}){const{relativeTo:r,queryParams:l,fragment:m,queryParamsHandling:C,preserveFragment:A}=n,O=A?this.currentUrlTree.fragment:m;let $,z=null;switch(C){case"merge":z={...this.currentUrlTree.queryParams,...l};break;case"preserve":z=this.currentUrlTree.queryParams;break;default:z=l||null}null!==z&&(z=this.removeEmptyProps(z));try{$=vc(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof e[0]||"/"!==e[0][0])&&(e=[]),$=this.currentUrlTree.root}return lo($,e,z,O??null)}navigateByUrl(e,n={skipLocationChange:!1}){const r=Jn(e)?e:this.parseUrl(e),l=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(l,Og,null,n)}navigate(e,n={skipLocationChange:!1}){return function VC(i){for(let t=0;t<i.length;t++)if(null==i[t])throw new o.wOt(4008,!1)}(e),this.navigateByUrl(this.createUrlTree(e,n),n)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,n){let r;if(r=!0===n?{...NC}:!1===n?{...BC}:n,Jn(e))return at(this.currentUrlTree,e,r);const l=this.parseUrl(e);return at(this.currentUrlTree,l,r)}removeEmptyProps(e){return Object.entries(e).reduce((n,[r,l])=>(null!=l&&(n[r]=l),n),{})}scheduleNavigation(e,n,r,l,m){if(this.disposed)return Promise.resolve(!1);let C,A,O;m?(C=m.resolve,A=m.reject,O=m.promise):O=new Promise(($,Q)=>{C=$,A=Q});const z=this.pendingTasks.add();return Ev(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(z))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:l,resolve:C,reject:A,promise:O,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),O.catch($=>Promise.reject($))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Tv=(()=>{class i{constructor(e,n,r,l,m,C){this.router=e,this.route=n,this.tabIndexAttribute=r,this.renderer=l,this.el=m,this.locationStrategy=C,this.href=null,this.commands=null,this.onChanges=new xi.B,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const A=m.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===A||"area"===A,this.isAnchorElement?this.subscription=e.events.subscribe(O=>{O instanceof md&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,n,r,l,m){const C=this.urlTree;return!!(null===C||this.isAnchorElement&&(0!==e||n||r||l||m||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(C,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const e=this.urlTree;this.href=null!==e&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e)):null;const n=null===this.href?null:(0,o.n$t)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(e,n){const r=this.renderer,l=this.el.nativeElement;null!==n?r.setAttribute(l,e,n):r.removeAttribute(l,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(Cd),o.rXU(qc),o.kS0("tabindex"),o.rXU(o.sFG),o.rXU(o.aKT),o.rXU(yl))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,r){1&n&&o.bIt("click",function(m){return r.onClick(m.button,m.ctrlKey,m.shiftKey,m.altKey,m.metaKey)}),2&n&&o.BMQ("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",o.L39],skipLocationChange:[2,"skipLocationChange","skipLocationChange",o.L39],replaceUrl:[2,"replaceUrl","replaceUrl",o.L39],routerLink:"routerLink"},standalone:!0,features:[o.GFd,o.OA$]})}}return i})();class fw{}let iM=(()=>{class i{constructor(e,n,r,l,m){this.router=e,this.injector=r,this.preloadingStrategy=l,this.loader=m}setUpPreloading(){this.subscription=this.router.events.pipe(Ur(e=>e instanceof md),ld(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,n){const r=[];for(const l of n){l.providers&&!l._injector&&(l._injector=(0,o.Ol2)(l.providers,e,`Route: ${l.path}`));const m=l._injector??e,C=l._loadedInjector??m;(l.loadChildren&&!l._loadedRoutes&&void 0===l.canLoad||l.loadComponent&&!l._loadedComponent)&&r.push(this.preloadConfig(m,l)),(l.children||l._loadedRoutes)&&r.push(this.processRoutes(C,l.children??l._loadedRoutes))}return Pn(r).pipe(Qr())}preloadConfig(e,n){return this.preloadingStrategy.preload(n,()=>{let r;r=n.loadChildren&&void 0===n.canLoad?this.loader.loadChildren(e,n):di(null);const l=r.pipe(hr(m=>null===m?di(void 0):(n._loadedRoutes=m.routes,n._loadedInjector=m.injector,this.processRoutes(m.injector??e,m.routes))));return n.loadComponent&&!n._loadedComponent?Pn([l,this.loader.loadComponent(n)]).pipe(Qr()):l})}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Cd),o.KVO(o.Ql9),o.KVO(o.uvJ),o.KVO(fw),o.KVO(aw))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const Sv=new o.nKC("");let Zu=(()=>{class i{constructor(e,n,r,l,m={}){this.urlSerializer=e,this.transitions=n,this.viewportScroller=r,this.zone=l,this.options=m,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=(0,o.WQX)(o.uvJ),m.scrollPositionRestoration||="disabled",m.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof hp?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof md?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof Ah&&e.code===fp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof ql&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,n){var r=this;this.zone.runOutsideAngular((0,Yt.A)(function*(){yield new Promise(l=>{setTimeout(()=>{l()}),(0,o.mal)(()=>{l()},{injector:r.environmentInjector})}),r.zone.run(()=>{r.transitions.events.next(new ql(e,"popstate"===r.lastSource?r.store[r.restoredId]:null,n))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(n){o.QTQ()}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();function ol(i,t){return{\u0275kind:i,\u0275providers:t}}function rM(){const i=(0,o.WQX)(o.zZn);return t=>{const e=i.get(o.o8S);if(t!==e.components[0])return;const n=i.get(Cd),r=i.get(jC);1===i.get(Mv)&&n.initialNavigation(),i.get(Dv,null,o.$GK.Optional)?.setUpPreloading(),i.get(Sv,null,o.$GK.Optional)?.init(),n.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const jC=new o.nKC("",{factory:()=>new xi.B}),Mv=new o.nKC("",{providedIn:"root",factory:()=>1}),Dv=new o.nKC("");function Ay(i){return ol(0,[{provide:Dv,useExisting:iM},{provide:fw,useExisting:i}])}function Dy(i){return ol(9,[{provide:xy,useValue:wy},{provide:xv,useValue:{skipNextTransition:!!i?.skipInitialTransition,...i}}])}const om=new o.nKC("ROUTER_FORROOT_GUARD"),ky=[Ma,{provide:vi,useClass:Yi},Cd,Il,{provide:qc,useFactory:function mw(i){return i.routerState.root},deps:[Cd]},aw,[]];let Ed=(()=>{class i{constructor(e){}static forRoot(e,n){return{ngModule:i,providers:[ky,[],{provide:yv,multi:!0,useValue:e},{provide:om,useFactory:Iy,deps:[[Cd,new o.Xx1,new o.kdw]]},{provide:yd,useValue:n||{}},n?.useHash?{provide:yl,useClass:mf}:{provide:yl,useClass:Rc},{provide:Sv,useFactory:()=>{const i=(0,o.WQX)(Qm),t=(0,o.WQX)(o.SKi),e=(0,o.WQX)(yd),n=(0,o.WQX)(Cv),r=(0,o.WQX)(vi);return e.scrollOffset&&i.setOffset(e.scrollOffset),new Zu(r,n,i,t,e)}},n?.preloadingStrategy?Ay(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?gw(n):[],n?.bindToComponentInputs?ol(8,[vp,{provide:_p,useExisting:vp}]).\u0275providers:[],n?.enableViewTransitions?Dy().\u0275providers:[],[{provide:xp,useFactory:rM},{provide:o.iLQ,multi:!0,useExisting:xp}]]}}static forChild(e){return{ngModule:i,providers:[{provide:yv,multi:!0,useValue:e}]}}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(om,8))}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({})}}return i})();function Iy(i){return"guarded"}function gw(i){return["disabled"===i.initialNavigation?ol(3,[{provide:o.hnV,multi:!0,useFactory:()=>{const t=(0,o.WQX)(Cd);return()=>{t.setUpLocationChangeListener()}}},{provide:Mv,useValue:2}]).\u0275providers:[],"enabledBlocking"===i.initialNavigation?ol(2,[{provide:Mv,useValue:0},{provide:o.hnV,multi:!0,deps:[o.zZn],useFactory:t=>{const e=t.get(Vo,Promise.resolve());return()=>e.then(()=>new Promise(n=>{const r=t.get(Cd),l=t.get(jC);Ev(r,()=>{n(!0)}),t.get(Cv).afterPreactivation=()=>(n(!0),l.closed?di(void 0):l),r.initialNavigation()}))}}]).\u0275providers:[]]}const xp=new o.nKC("");let kv;try{kv=typeof Intl<"u"&&Intl.v8BreakIterator}catch{kv=!1}let Oh,wo=(()=>{class i{constructor(e){this._platformId=e,this.isBrowser=this._platformId?Km(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!kv)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(o.Agw))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const Ug=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function YC(){if(Oh)return Oh;if("object"!=typeof document||!document)return Oh=new Set(Ug),Oh;let i=document.createElement("input");return Oh=new Set(Ug.filter(t=>(i.setAttribute("type",t),i.type===t))),Oh}let Ly;function Ql(i){return function Jk(){if(null==Ly&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Ly=!0}))}finally{Ly=Ly||!1}return Ly}()?i:!!i.capture}var Ku=function(i){return i[i.NORMAL=0]="NORMAL",i[i.NEGATED=1]="NEGATED",i[i.INVERTED=2]="INVERTED",i}(Ku||{});let wp,Lh,Fy;function _w(){if(null==Lh){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Lh=!1,Lh;if("scrollBehavior"in document.documentElement.style)Lh=!0;else{const i=Element.prototype.scrollTo;Lh=!!i&&!/\{\s*\[native code\]\s*\}/.test(i.toString())}}return Lh}function am(){if("object"!=typeof document||!document)return Ku.NORMAL;if(null==wp){const i=document.createElement("div"),t=i.style;i.dir="rtl",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";const e=document.createElement("div"),n=e.style;n.width="2px",n.height="1px",i.appendChild(e),document.body.appendChild(i),wp=Ku.NORMAL,0===i.scrollLeft&&(i.scrollLeft=1,wp=0===i.scrollLeft?Ku.NEGATED:Ku.INVERTED),i.remove()}return wp}function Td(i){return i.composedPath?i.composedPath()[0]:i.target}function Gg(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function oa(i,...t){return t.length?t.some(e=>i[e]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}class ru extends On.yU{constructor(t,e){super()}schedule(t,e=0){return this}}const um={setInterval(i,t,...e){const{delegate:n}=um;return n?.setInterval?n.setInterval(i,t,...e):setInterval(i,t,...e)},clearInterval(i){const{delegate:t}=um;return(t?.clearInterval||clearInterval)(i)},delegate:void 0};var cE=It(908);class Bv extends ru{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var n;if(this.closed)return this;this.state=t;const r=this.id,l=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(l,r,e)),this.pending=!0,this.delay=e,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(l,this.id,e),this}requestAsyncId(t,e,n=0){return um.setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return e;null!=e&&um.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,n=!1;try{this.work(t)}catch(l){n=!0,r=l||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:n}=e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,cE.o)(n,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const Yg={now:()=>(Yg.delegate||Date).now(),delegate:void 0};class Zg{constructor(t,e=Zg.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,n){return new this.schedulerActionCtor(this,t).schedule(n,e)}}Zg.now=Yg.now;class Jl extends Zg{constructor(t,e=Zg.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let n;this._active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const zh=new Jl(Bv),Kg=zh;function Uh(i,t=zh){return(0,ut.N)((e,n)=>{let r=null,l=null,m=null;const C=()=>{if(r){r.unsubscribe(),r=null;const O=l;l=null,n.next(O)}};function A(){const O=m+i,z=t.now();if(z<O)return r=this.schedule(void 0,O-z),void n.add(r);C()}e.subscribe((0,bt._)(n,O=>{l=O,m=t.now(),r||(r=t.schedule(A,i),n.add(r))},()=>{C(),n.complete()},void 0,()=>{l=r=null}))})}function ou(i){return Ur((t,e)=>i<=e)}function su(i,t=Vt.D){return i=i??Qg,(0,ut.N)((e,n)=>{let r,l=!0;e.subscribe((0,bt._)(n,m=>{const C=t(m);(l||!i(r,C))&&(l=!1,r=C,n.next(m))}))})}function Qg(i,t){return i===t}function Es(i){return null!=i&&"false"!=`${i}`}function au(i,t=0){return Dw(i)?Number(i):t}function Dw(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}function Vv(i){return Array.isArray(i)?i:[i]}function Vs(i){return null==i?"":"string"==typeof i?i:`${i}px`}function lu(i){return i instanceof o.aKT?i.nativeElement:i}let cu=(()=>{class i{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),dE=(()=>{class i{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map,this._ngZone=(0,o.WQX)(o.SKi)}ngOnDestroy(){this._observedElements.forEach((e,n)=>this._cleanupObserver(n))}observe(e){const n=lu(e);return new Ai.c(r=>{const m=this._observeElement(n).pipe((0,st.T)(C=>C.filter(A=>!function kw(i){if("characterData"===i.type&&i.target instanceof Comment)return!0;if("childList"===i.type){for(let t=0;t<i.addedNodes.length;t++)if(!(i.addedNodes[t]instanceof Comment))return!1;for(let t=0;t<i.removedNodes.length;t++)if(!(i.removedNodes[t]instanceof Comment))return!1;return!0}return!1}(A))),Ur(C=>!!C.length)).subscribe(C=>{this._ngZone.run(()=>{r.next(C)})});return()=>{m.unsubscribe(),this._unobserveElement(n)}})}_observeElement(e){return this._ngZone.runOutsideAngular(()=>{if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const n=new xi.B,r=this._mutationObserverFactory.create(l=>n.next(l));r&&r.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:r,stream:n,count:1})}return this._observedElements.get(e).stream})}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:n,stream:r}=this._observedElements.get(e);n&&n.disconnect(),r.complete(),this._observedElements.delete(e)}}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(cu))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),uE=(()=>{class i{get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=au(e),this._subscribe()}constructor(e,n){this._contentObserver=e,this._elementRef=n,this.event=new o.bkB,this._disabled=!1,this._currentSubscription=null}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._currentSubscription=(this.debounce?e.pipe(Uh(this.debounce)):e).subscribe(this.event)}_unsubscribe(){this._currentSubscription?.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(dE),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkObserveContent",""]],inputs:{disabled:[2,"cdkObserveContentDisabled","disabled",o.L39],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"],standalone:!0,features:[o.GFd]})}}return i})(),kp=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[cu]})}}return i})();const Iw=new Set;let hm,Rw=(()=>{class i{constructor(e,n){this._platform=e,this._nonce=n,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Pw}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function Hy(i,t){if(!Iw.has(i))try{hm||(hm=document.createElement("style"),t&&hm.setAttribute("nonce",t),hm.setAttribute("type","text/css"),document.head.appendChild(hm)),hm.sheet&&(hm.sheet.insertRule(`@media ${i} {body{ }}`,0),Iw.add(i))}catch(e){console.error(e)}}(e,this._nonce),this._matchMedia(e)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(wo),o.KVO(o.BIS,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Pw(i){return{matches:"all"===i||""===i,media:i,addListener:()=>{},removeListener:()=>{}}}let sa=(()=>{class i{constructor(e,n){this._mediaMatcher=e,this._zone=n,this._queries=new Map,this._destroySubject=new xi.B}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return fm(Vv(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let l=ri(fm(Vv(e)).map(m=>this._registerQuery(m).observable));return l=bo(l.pipe(gs(1)),l.pipe(ou(1),Uh(0))),l.pipe((0,st.T)(m=>{const C={matches:!1,breakpoints:{}};return m.forEach(({matches:A,query:O})=>{C.matches=C.matches||A,C.breakpoints[O]=A}),C}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const n=this._mediaMatcher.matchMedia(e),l={observable:new Ai.c(m=>{const C=A=>this._zone.run(()=>m.next(A));return n.addListener(C),()=>{n.removeListener(C)}}).pipe(As(n),(0,st.T)(({matches:m})=>({query:e,matches:m})),dn(this._destroySubject)),mql:n};return this._queries.set(e,l),l}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Rw),o.KVO(o.SKi))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function fm(i){return i.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}const Cc_XSmall="(max-width: 599.98px)",Cc_Small="(min-width: 600px) and (max-width: 959.98px)";function jh(i,t,e){const n=Ll(i,t);e=e.trim(),!n.some(r=>r.trim()===e)&&(n.push(e),i.setAttribute(t,n.join(" ")))}function pm(i,t,e){const n=Ll(i,t);e=e.trim();const r=n.filter(l=>l!==e);r.length?i.setAttribute(t,r.join(" ")):i.removeAttribute(t)}function Ll(i,t){return i.getAttribute(t)?.match(/\S+/g)??[]}const Ip="cdk-describedby-message",Ad="cdk-describedby-host";let $y=0,Uv=(()=>{class i{constructor(e,n){this._platform=n,this._messageRegistry=new Map,this._messagesContainer=null,this._id=""+$y++,this._document=e,this._id=(0,o.WQX)(o.sZ2)+"-"+$y++}describe(e,n,r){if(!this._canBeDescribed(e,n))return;const l=Wy(n,r);"string"!=typeof n?(e_(n,this._id),this._messageRegistry.set(l,{messageElement:n,referenceCount:0})):this._messageRegistry.has(l)||this._createMessageElement(n,r),this._isElementDescribedByMessage(e,l)||this._addMessageReference(e,l)}removeDescription(e,n,r){if(!n||!this._isElementNode(e))return;const l=Wy(n,r);if(this._isElementDescribedByMessage(e,l)&&this._removeMessageReference(e,l),"string"==typeof n){const m=this._messageRegistry.get(l);m&&0===m.referenceCount&&this._deleteMessageElement(l)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const e=this._document.querySelectorAll(`[${Ad}="${this._id}"]`);for(let n=0;n<e.length;n++)this._removeCdkDescribedByReferenceIds(e[n]),e[n].removeAttribute(Ad);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(e,n){const r=this._document.createElement("div");e_(r,this._id),r.textContent=e,n&&r.setAttribute("role",n),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(Wy(e,n),{messageElement:r,referenceCount:0})}_deleteMessageElement(e){this._messageRegistry.get(e)?.messageElement?.remove(),this._messageRegistry.delete(e)}_createMessagesContainer(){if(this._messagesContainer)return;const e="cdk-describedby-message-container",n=this._document.querySelectorAll(`.${e}[platform="server"]`);for(let l=0;l<n.length;l++)n[l].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(e),r.classList.add("cdk-visually-hidden"),this._platform&&!this._platform.isBrowser&&r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(e){const n=Ll(e,"aria-describedby").filter(r=>0!=r.indexOf(Ip));e.setAttribute("aria-describedby",n.join(" "))}_addMessageReference(e,n){const r=this._messageRegistry.get(n);jh(e,"aria-describedby",r.messageElement.id),e.setAttribute(Ad,this._id),r.referenceCount++}_removeMessageReference(e,n){const r=this._messageRegistry.get(n);r.referenceCount--,pm(e,"aria-describedby",r.messageElement.id),e.removeAttribute(Ad)}_isElementDescribedByMessage(e,n){const r=Ll(e,"aria-describedby"),l=this._messageRegistry.get(n),m=l&&l.messageElement.id;return!!m&&-1!=r.indexOf(m)}_canBeDescribed(e,n){if(!this._isElementNode(e))return!1;if(n&&"object"==typeof n)return!0;const r=null==n?"":`${n}`.trim(),l=e.getAttribute("aria-label");return!(!r||l&&l.trim()===r)}_isElementNode(e){return e.nodeType===this._document.ELEMENT_NODE}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn),o.KVO(wo))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Wy(i,t){return"string"==typeof i?`${t||""}/${i}`:i}function e_(i,t){i.id||(i.id=`${Ip}-${t}-${$y++}`)}class t_{constructor(t,e){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new xi.B,this._typeaheadSubscription=On.yU.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=n=>n.disabled,this._pressedLetters=[],this.tabOut=new xi.B,this.change=new xi.B,t instanceof o.rOR?this._itemChangesSubscription=t.changes.subscribe(n=>this._itemsChanged(n.toArray())):(0,o.Hps)(t)&&(this._effectRef=(0,o.QZP)(()=>this._itemsChanged(t()),{injector:e}))}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Oo(e=>this._pressedLetters.push(e)),Uh(t),Ur(()=>this._pressedLetters.length>0),(0,st.T)(()=>this._pressedLetters.join(""))).subscribe(e=>{const n=this._getItemsArray();for(let r=1;r<n.length+1;r++){const l=(this._activeItemIndex+r)%n.length,m=n[l];if(!this._skipPredicateFn(m)&&0===m.getLabel().toUpperCase().trim().indexOf(e)){this.setActiveItem(l);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}withPageUpDown(t=!0,e=10){return this._pageUpAndDown={enabled:t,delta:e},this}setActiveItem(t){const e=this._activeItem;this.updateActiveItem(t),this._activeItem!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(l=>!t[l]||this._allowedModifierKeys.indexOf(l)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const l=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(l>0?l:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const l=this._activeItemIndex+this._pageUpAndDown.delta,m=this._getItemsArray().length;this._setActiveItemByIndex(l<m?l:m-1,-1);break}return;default:return void((r||oa(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),n="number"==typeof t?t:e.indexOf(t);this._activeItem=e[n]??null,this._activeItemIndex=n}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let n=1;n<=e.length;n++){const r=(this._activeItemIndex+t*n+e.length)%e.length;if(!this._skipPredicateFn(e[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const n=this._getItemsArray();if(n[t]){for(;this._skipPredicateFn(n[t]);)if(!n[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return(0,o.Hps)(this._items)?this._items():this._items instanceof o.rOR?this._items.toArray():this._items}_itemsChanged(t){if(this._activeItem){const e=t.indexOf(this._activeItem);e>-1&&e!==this._activeItemIndex&&(this._activeItemIndex=e)}}}class $r extends t_{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}class jv extends t_{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(t){return this._origin=t,this}setActiveItem(t){super.setActiveItem(t),this.activeItem&&this.activeItem.focus(this._origin)}}let Dd=(()=>{class i{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function hE(i){return!!(i.offsetWidth||i.offsetHeight||"function"==typeof i.getClientRects&&i.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const n=function Xy(i){try{return i.frameElement}catch{return null}}(function mE(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}(e));if(n&&(-1===Gv(n)||!this.isVisible(n)))return!1;let r=e.nodeName.toLowerCase(),l=Gv(e);return e.hasAttribute("contenteditable")?-1!==l:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function r_(i){let t=i.nodeName.toLowerCase(),e="input"===t&&i.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===r?!!e.hasAttribute("controls")&&-1!==l:"video"===r?-1!==l&&(null!==l||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,n){return function Hv(i){return!function i_(i){return function Rp(i){return"input"==i.nodeName.toLowerCase()}(i)&&"hidden"==i.type}(i)&&(function fE(i){let t=i.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(i)||function n_(i){return function kd(i){return"a"==i.nodeName.toLowerCase()}(i)&&i.hasAttribute("href")}(i)||i.hasAttribute("contenteditable")||qy(i))}(e)&&!this.isDisabled(e)&&(n?.ignoreVisibility||this.isVisible(e))}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(wo))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function qy(i){if(!i.hasAttribute("tabindex")||void 0===i.tabIndex)return!1;let t=i.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function Gv(i){if(!qy(i))return null;const t=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class $v{get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}constructor(t,e,n,r,l=!1,m){this._element=t,this._checker=e,this._ngZone=n,this._document=r,this._injector=m,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,l||this.attachAnchors()}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const n=this._getFirstTabbableElement(e);return n?.focus(t),!!n}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=0;n<e.length;n++){const r=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(r)return r}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let n=e.length-1;n>=0;n--){const r=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(r)return r}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._injector?(0,o.mal)(t,{injector:this._injector}):setTimeout(t)}}let o_=(()=>{class i{constructor(e,n,r){this._checker=e,this._ngZone=n,this._injector=(0,o.WQX)(o.zZn),this._document=r}create(e,n=!1){return new $v(e,this._checker,this._ngZone,this._document,n,this._injector)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Dd),o.KVO(o.SKi),o.KVO(Nn))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),pE=(()=>{class i{get enabled(){return this.focusTrap?.enabled||!1}set enabled(e){this.focusTrap&&(this.focusTrap.enabled=e)}constructor(e,n,r){this._elementRef=e,this._focusTrapFactory=n,this._previouslyFocusedElement=null,(0,o.WQX)(wo).isBrowser&&(this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0))}ngOnDestroy(){this.focusTrap?.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap?.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap&&!this.focusTrap.hasAttached()&&this.focusTrap.attachAnchors()}ngOnChanges(e){const n=e.autoCapture;n&&!n.firstChange&&this.autoCapture&&this.focusTrap?.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=function jg(){let i=typeof document<"u"&&document?document.activeElement:null;for(;i&&i.shadowRoot;){const t=i.shadowRoot.activeElement;if(t===i)break;i=t}return i}(),this.focusTrap?.focusInitialElementWhenReady()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o_),o.rXU(Nn))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:[2,"cdkTrapFocus","enabled",o.L39],autoCapture:[2,"cdkTrapFocusAutoCapture","autoCapture",o.L39]},exportAs:["cdkTrapFocus"],standalone:!0,features:[o.GFd,o.OA$]})}}return i})();function Pp(i){return 0===i.buttons||0===i.detail}function _m(i){const t=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const Wv=new o.nKC("cdk-input-modality-detector-options"),RM={ignoreKeys:[18,17,224,91,16]},zs=Ql({passive:!0,capture:!0});let Ky=(()=>{class i{get mostRecentModality(){return this._modality.value}constructor(e,n,r,l){this._platform=e,this._mostRecentTarget=null,this._modality=new ro.t(null),this._lastTouchMs=0,this._onKeydown=m=>{this._options?.ignoreKeys?.some(C=>C===m.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Td(m))},this._onMousedown=m=>{Date.now()-this._lastTouchMs<650||(this._modality.next(Pp(m)?"keyboard":"mouse"),this._mostRecentTarget=Td(m))},this._onTouchstart=m=>{_m(m)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Td(m))},this._options={...RM,...l},this.modalityDetected=this._modality.pipe(ou(1)),this.modalityChanged=this.modalityDetected.pipe(su()),e.isBrowser&&n.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,zs),r.addEventListener("mousedown",this._onMousedown,zs),r.addEventListener("touchstart",this._onTouchstart,zs)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,zs),document.removeEventListener("mousedown",this._onMousedown,zs),document.removeEventListener("touchstart",this._onTouchstart,zs))}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(wo),o.KVO(o.SKi),o.KVO(Nn),o.KVO(Wv,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const PM=new o.nKC("liveAnnouncerElement",{providedIn:"root",factory:function OM(){return null}}),Qy=new o.nKC("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let _E=0,Ow=(()=>{class i{constructor(e,n,r,l){this._ngZone=n,this._defaultOptions=l,this._document=r,this._liveElement=e||this._createLiveElement()}announce(e,...n){const r=this._defaultOptions;let l,m;return 1===n.length&&"number"==typeof n[0]?m=n[0]:[l,m]=n,this.clear(),clearTimeout(this._previousTimeout),l||(l=r&&r.politeness?r.politeness:"polite"),null==m&&r&&(m=r.duration),this._liveElement.setAttribute("aria-live",l),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(C=>this._currentResolve=C)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,"number"==typeof m&&(this._previousTimeout=setTimeout(()=>this.clear(),m)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",n=this._document.getElementsByClassName(e),r=this._document.createElement("div");for(let l=0;l<n.length;l++)n[l].remove();return r.classList.add(e),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),r.id="cdk-live-announcer-"+_E++,this._document.body.appendChild(r),r}_exposeAnnouncerToModals(e){const n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<n.length;r++){const l=n[r],m=l.getAttribute("aria-owns");m?-1===m.indexOf(e)&&l.setAttribute("aria-owns",m+" "+e):l.setAttribute("aria-owns",e)}}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(PM,8),o.KVO(o.SKi),o.KVO(Nn),o.KVO(Qy,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Xv=function(i){return i[i.IMMEDIATE=0]="IMMEDIATE",i[i.EVENTUAL=1]="EVENTUAL",i}(Xv||{});const vE=new o.nKC("cdk-focus-monitor-default-options"),qv=Ql({passive:!0,capture:!0});let Kc=(()=>{class i{constructor(e,n,r,l,m){this._ngZone=e,this._platform=n,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new xi.B,this._rootNodeFocusAndBlurListener=C=>{for(let O=Td(C);O;O=O.parentElement)"focus"===C.type?this._onFocus(C,O):this._onBlur(C,O)},this._document=l,this._detectionMode=m?.detectionMode||Xv.IMMEDIATE}monitor(e,n=!1){const r=lu(e);if(!this._platform.isBrowser||1!==r.nodeType)return di();const l=function Cp(i){if(function Ny(){if(null==Fy){const i=typeof document<"u"?document.head:null;Fy=!(!i||!i.createShadowRoot&&!i.attachShadow)}return Fy}()){const t=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(r)||this._getDocument(),m=this._elementInfo.get(r);if(m)return n&&(m.checkChildren=!0),m.subject;const C={checkChildren:n,subject:new xi.B,rootNode:l};return this._elementInfo.set(r,C),this._registerGlobalListeners(C),C.subject}stopMonitoring(e){const n=lu(e),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(e,n,r){const l=lu(e);l===this._getDocument().activeElement?this._getClosestElementsInfo(l).forEach(([C,A])=>this._originChanged(C,n,A)):(this._setOrigin(n),"function"==typeof l.focus&&l.focus(r))}ngOnDestroy(){this._elementInfo.forEach((e,n)=>this.stopMonitoring(n))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return this._detectionMode===Xv.EVENTUAL||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,n){e.classList.toggle("cdk-focused",!!n),e.classList.toggle("cdk-touch-focused","touch"===n),e.classList.toggle("cdk-keyboard-focused","keyboard"===n),e.classList.toggle("cdk-mouse-focused","mouse"===n),e.classList.toggle("cdk-program-focused","program"===n)}_setOrigin(e,n=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&n,this._detectionMode===Xv.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,n){const r=this._elementInfo.get(n),l=Td(e);!r||!r.checkChildren&&n!==l||this._originChanged(n,this._getFocusOrigin(l),r)}_onBlur(e,n){const r=this._elementInfo.get(n);!r||r.checkChildren&&e.relatedTarget instanceof Node&&n.contains(e.relatedTarget)||(this._setClasses(n),this._emitOrigin(r,null))}_emitOrigin(e,n){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(n))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const n=e.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,qv),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,qv)}),this._rootNodeFocusListenerCount.set(n,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(dn(this._stopInputModalityDetector)).subscribe(l=>{this._setOrigin(l,!0)}))}_removeGlobalListeners(e){const n=e.rootNode;if(this._rootNodeFocusListenerCount.has(n)){const r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,qv),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,qv),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,n,r){this._setClasses(e,n),this._emitOrigin(r,n),this._lastFocusOrigin=n}_getClosestElementsInfo(e){const n=[];return this._elementInfo.forEach((r,l)=>{(l===e||r.checkChildren&&l.contains(e))&&n.push([l,r])}),n}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:n,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!n||n===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const l=e.labels;if(l)for(let m=0;m<l.length;m++)if(l[m].contains(n))return!0;return!1}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(o.SKi),o.KVO(wo),o.KVO(Ky),o.KVO(Nn,8),o.KVO(vE,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Jy=(()=>{class i{constructor(e,n){this._elementRef=e,this._focusMonitor=n,this._focusOrigin=null,this.cdkFocusChange=new o.bkB}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,1===e.nodeType&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>{this._focusOrigin=n,this.cdkFocusChange.emit(n)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(Kc))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"],standalone:!0})}}return i})();var Ju=function(i){return i[i.NONE=0]="NONE",i[i.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",i[i.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",i}(Ju||{});const Yv="cdk-high-contrast-black-on-white",Zv="cdk-high-contrast-white-on-black",s_="cdk-high-contrast-active";let bE=(()=>{class i{constructor(e,n){this._platform=e,this._document=n,this._breakpointSubscription=(0,o.WQX)(sa).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Ju.NONE;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(e):null,l=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),l){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Ju.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Ju.BLACK_ON_WHITE}return Ju.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(s_,Yv,Zv),this._hasCheckedHighContrastMode=!0;const n=this.getHighContrastMode();n===Ju.BLACK_ON_WHITE?e.add(s_,Yv):n===Ju.WHITE_ON_BLACK&&e.add(s_,Zv)}}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(wo),o.KVO(Nn))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),ec=(()=>{class i{constructor(e){e._applyBodyHighContrastModeCssClasses()}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(bE))}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[kp]})}}return i})();const Kv=new o.nKC("cdk-dir-doc",{providedIn:"root",factory:function e0(){return(0,o.WQX)(Nn)}}),LM=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Us=(()=>{class i{constructor(e){this.value="ltr",this.change=new o.bkB,e&&(this.value=function t0(i){const t=i?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?LM.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Kv,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Op=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({})}}return i})();const n0=["text"],l_=[[["mat-icon"]],"*"],c_=["mat-icon","*"];function Id(i,t){if(1&i&&o.nrm(0,"mat-pseudo-checkbox",1),2&i){const e=o.XpG();o.Y8G("disabled",e.disabled)("state",e.selected?"checked":"unchecked")}}function yE(i,t){if(1&i&&o.nrm(0,"mat-pseudo-checkbox",3),2&i){const e=o.XpG();o.Y8G("disabled",e.disabled)}}function r0(i,t){if(1&i&&(o.j41(0,"span",4),o.EFF(1),o.k0s()),2&i){const e=o.XpG();o.R7$(),o.SpI("(",e.group.label,")")}}const o0=["mat-internal-form-field",""],VM=["*"];let xE=(()=>{class i{static{this.STANDARD_CURVE="cubic-bezier(0.4,0.0,0.2,1)"}static{this.DECELERATION_CURVE="cubic-bezier(0.0,0.0,0.2,1)"}static{this.ACCELERATION_CURVE="cubic-bezier(0.4,0.0,1,1)"}static{this.SHARP_CURVE="cubic-bezier(0.4,0.0,0.6,1)"}}return i})(),Lp=(()=>{class i{static{this.COMPLEX="375ms"}static{this.ENTERING="225ms"}static{this.EXITING="195ms"}}return i})();const Lw=new o.nKC("mat-sanity-checks",{providedIn:"root",factory:function Fp(){return!0}});let qn=(()=>{class i{constructor(e,n,r){this._sanityChecks=n,this._document=r,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!Gg()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(bE),o.KVO(Lw,8),o.KVO(Nn))}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[Op,Op]})}}return i})();class Qv{constructor(t,e,n,r,l){this._defaultMatcher=t,this.ngControl=e,this._parentFormGroup=n,this._parentForm=r,this._stateChanges=l,this.errorState=!1}updateErrorState(){const t=this.errorState,e=this._parentFormGroup||this._parentForm,n=this.matcher||this._defaultMatcher,r=this.ngControl?this.ngControl.control:null,l=n?.isErrorState(r,e)??!1;l!==t&&(this.errorState=l,this._stateChanges.next())}}const bm=new o.nKC("MAT_DATE_LOCALE",{providedIn:"root",factory:function Bw(){return(0,o.WQX)(o.xe9)}});class Xa{constructor(){this._localeChanges=new xi.B,this.localeChanges=this._localeChanges}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let n=this.isValid(t),r=this.isValid(e);return n&&r?!this.compareDate(t,e):n==r}return t==e}clampDate(t,e,n){return e&&this.compareDate(t,e)<0?e:n&&this.compareDate(t,n)>0?n:t}}const Bp=new o.nKC("mat-date-formats"),CE=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function Vw(i,t){const e=Array(i);for(let n=0;n<i;n++)e[n]=t(n);return e}let HM=(()=>{class i extends Xa{constructor(e){super(),this.useUtcForDisplay=!1,this._matDateLocale=(0,o.WQX)(bm,{optional:!0}),void 0!==e&&(this._matDateLocale=e),super.setLocale(this._matDateLocale)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){const n=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return Vw(12,r=>this._format(n,new Date(2017,r,1)))}getDateNames(){const e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return Vw(31,n=>this._format(e,new Date(2017,0,n+1)))}getDayOfWeekNames(e){const n=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return Vw(7,r=>this._format(n,new Date(2017,0,r+1)))}getYearName(e){const n=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(n,e)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,n,r){let l=this._createDateWithOverflow(e,n,r);return l.getMonth(),l}today(){return new Date}parse(e,n){return"number"==typeof e?new Date(e):e?new Date(Date.parse(e)):null}format(e,n){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");const r=new Intl.DateTimeFormat(this.locale,{...n,timeZone:"utc"});return this._format(r,e)}addCalendarYears(e,n){return this.addCalendarMonths(e,12*n)}addCalendarMonths(e,n){let r=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+n,this.getDate(e));return this.getMonth(r)!=((this.getMonth(e)+n)%12+12)%12&&(r=this._createDateWithOverflow(this.getYear(r),this.getMonth(r),0)),r}addCalendarDays(e,n){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+n)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if("string"==typeof e){if(!e)return null;if(CE.test(e)){let n=new Date(e);if(this.isValid(n))return n}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(e,n,r){const l=new Date;return l.setFullYear(e,n,r),l.setHours(0,0,0,0),l}_2digit(e){return("00"+e).slice(-2)}_format(e,n){const r=new Date;return r.setUTCFullYear(n.getFullYear(),n.getMonth(),n.getDate()),r.setUTCHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),e.format(r)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(bm,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const EE={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let SE=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[d_()]})}}return i})();function d_(i=EE){return[{provide:Xa,useClass:HM},{provide:Bp,useValue:i}]}let eh=(()=>{class i{isErrorState(e,n){return!!(e&&e.invalid&&(e.touched||n&&n.submitted))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),th=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,qn]})}}return i})();var cl=function(i){return i[i.FADING_IN=0]="FADING_IN",i[i.VISIBLE=1]="VISIBLE",i[i.FADING_OUT=2]="FADING_OUT",i[i.HIDDEN=3]="HIDDEN",i}(cl||{});class eb{constructor(t,e,n,r=!1){this._renderer=t,this.element=e,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=cl.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}}const $M=Ql({passive:!0,capture:!0});class ME{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const e=Td(t);e&&this._events.get(t.type)?.forEach((n,r)=>{(r===e||r.contains(e))&&n.forEach(l=>l.handleEvent(t))})}}addHandler(t,e,n,r){const l=this._events.get(e);if(l){const m=l.get(n);m?m.add(r):l.set(n,new Set([r]))}else this._events.set(e,new Map([[n,new Set([r])]])),t.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,$M)})}removeHandler(t,e,n){const r=this._events.get(t);if(!r)return;const l=r.get(e);l&&(l.delete(n),0===l.size&&r.delete(e),0===r.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,$M)))}}const tb={enterDuration:225,exitDuration:150},WM=Ql({passive:!0,capture:!0}),AE=["mousedown","touchstart"],DE=["mouseup","mouseleave","touchend","touchcancel"];class Vp{static{this._eventManager=new ME}constructor(t,e,n,r){this._target=t,this._ngZone=e,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=lu(n))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),l={...tb,...n.animation};n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const m=n.radius||function ib(i,t,e){const n=Math.max(Math.abs(i-e.left),Math.abs(i-e.right)),r=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(n*n+r*r)}(t,e,r),C=t-r.left,A=e-r.top,O=l.enterDuration,z=document.createElement("div");z.classList.add("mat-ripple-element"),z.style.left=C-m+"px",z.style.top=A-m+"px",z.style.height=2*m+"px",z.style.width=2*m+"px",null!=n.color&&(z.style.backgroundColor=n.color),z.style.transitionDuration=`${O}ms`,this._containerElement.appendChild(z);const $=window.getComputedStyle(z),te=$.transitionDuration,de="none"===$.transitionProperty||"0s"===te||"0s, 0s"===te||0===r.width&&0===r.height,fe=new eb(this,z,n,de);z.style.transform="scale3d(1, 1, 1)",fe.state=cl.FADING_IN,n.persistent||(this._mostRecentTransientRipple=fe);let ge=null;return!de&&(O||l.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Re=()=>this._finishRippleTransition(fe),qe=()=>this._destroyRipple(fe);z.addEventListener("transitionend",Re),z.addEventListener("transitioncancel",qe),ge={onTransitionEnd:Re,onTransitionCancel:qe}}),this._activeRipples.set(fe,ge),(de||!O)&&this._finishRippleTransition(fe),fe}fadeOutRipple(t){if(t.state===cl.FADING_OUT||t.state===cl.HIDDEN)return;const e=t.element,n={...tb,...t.config.animation};e.style.transitionDuration=`${n.exitDuration}ms`,e.style.opacity="0",t.state=cl.FADING_OUT,(t._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=lu(t);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,AE.forEach(n=>{Vp._eventManager.addHandler(this._ngZone,n,e,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{DE.forEach(e=>{this._triggerElement.addEventListener(e,this,WM)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){t.state===cl.FADING_IN?this._startFadeOutTransition(t):t.state===cl.FADING_OUT&&this._destroyRipple(t)}_startFadeOutTransition(t){const e=t===this._mostRecentTransientRipple,{persistent:n}=t.config;t.state=cl.VISIBLE,!n&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=cl.HIDDEN,null!==e&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel)),t.element.remove()}_onMousedown(t){const e=Pp(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!n&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!_m(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;if(e)for(let n=0;n<e.length;n++)this.fadeInRipple(e[n].clientX,e[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(t.state===cl.VISIBLE||t.config.terminateOnPointerUp&&t.state===cl.FADING_IN)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(AE.forEach(e=>Vp._eventManager.removeHandler(e,t,this)),this._pointerUpEventsRegistered&&(DE.forEach(e=>t.removeEventListener(e,this,WM)),this._pointerUpEventsRegistered=!1))}}const zp=new o.nKC("mat-ripple-global-options");let dl=(()=>{class i{get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}constructor(e,n,r,l,m){this._elementRef=e,this._animationMode=m,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=l||{},this._rippleRenderer=new Vp(this,n,e,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,n=0,r){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,n,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.SKi),o.rXU(wo),o.rXU(zp,8),o.rXU(o.bc$,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(n,r){2&n&&o.AVh("mat-ripple-unbounded",r.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0})}}return i})(),ul=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,qn]})}}return i})(),ym=(()=>{class i{constructor(e){this._animationMode=e,this.state="unchecked",this.disabled=!1,this.appearance="full"}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.bc$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(n,r){2&n&&o.AVh("mat-pseudo-checkbox-indeterminate","indeterminate"===r.state)("mat-pseudo-checkbox-checked","checked"===r.state)("mat-pseudo-checkbox-disabled",r.disabled)("mat-pseudo-checkbox-minimal","minimal"===r.appearance)("mat-pseudo-checkbox-full","full"===r.appearance)("_mat-animation-noopable","NoopAnimations"===r._animationMode)},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},standalone:!0,features:[o.aNF],decls:0,vars:0,template:function(n,r){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color)}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color)}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color);border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color);border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0})}}return i})(),xm=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn]})}}return i})();const Up=new o.nKC("MAT_OPTION_PARENT_COMPONENT"),Ec=new o.nKC("MatOptgroup");let jp=0;class wm{constructor(t,e=!1){this.source=t,this.isUserInput=e}}let Gp=(()=>{class i{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=e}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!(!this._parent||!this._parent.hideSingleSelectionIndicator)}constructor(e,n,r,l){this._element=e,this._changeDetectorRef=n,this._parent=r,this.group=l,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+jp++,this.onSelectionChange=new o.bkB,this._stateChanges=new xi.B}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(e=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),e&&this._emitSelectionChangeEvent())}deselect(e=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),e&&this._emitSelectionChangeEvent())}focus(e,n){const r=this._getHostElement();"function"==typeof r.focus&&r.focus(n)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!oa(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=e)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new wm(this,e))}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(Up,8),o.rXU(Ec,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-option"]],viewQuery:function(n,r){if(1&n&&o.GBs(n0,7),2&n){let l;o.mGM(l=o.lsd())&&(r._text=l.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(n,r){1&n&&o.bIt("click",function(){return r._selectViaInteraction()})("keydown",function(m){return r._handleKeydown(m)}),2&n&&(o.Mr5("id",r.id),o.BMQ("aria-selected",r.selected)("aria-disabled",r.disabled.toString()),o.AVh("mdc-list-item--selected",r.selected)("mat-mdc-option-multiple",r.multiple)("mat-mdc-option-active",r.active)("mdc-list-item--disabled",r.disabled))},inputs:{value:"value",id:"id",disabled:[2,"disabled","disabled",o.L39]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],standalone:!0,features:[o.GFd,o.aNF],ngContentSelectors:c_,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(n,r){1&n&&(o.NAR(l_),o.DNE(0,Id,1,2,"mat-pseudo-checkbox",1),o.SdG(1),o.j41(2,"span",2,0),o.SdG(4,1),o.k0s(),o.DNE(5,yE,1,1,"mat-pseudo-checkbox",3)(6,r0,2,1,"span",4),o.nrm(7,"div",5)),2&n&&(o.vxM(r.multiple?0:-1),o.R7$(5),o.vxM(r.multiple||!r.selected||r.hideSingleSelectionIndicator?-1:5),o.R7$(),o.vxM(r.group&&r.group._inert?6:-1),o.R7$(),o.Y8G("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disabled||r.disableRipple))},dependencies:[ym,dl],styles:['.mat-mdc-option{-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;min-height:48px;padding:0 16px;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color);font-family:var(--mat-option-label-text-font);line-height:var(--mat-option-label-text-line-height);font-size:var(--mat-option-label-text-size);letter-spacing:var(--mat-option-label-text-tracking);font-weight:var(--mat-option-label-text-weight)}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color)}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color);outline:0}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color)}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color)}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return i})();function s0(i,t,e){if(e.length){let n=t.toArray(),r=e.toArray(),l=0;for(let m=0;m<i+1;m++)n[m].group&&n[m].group===r[l]&&l++;return l}return 0}function h_(i,t,e,n){return i<e?i:i+t>e+n?Math.max(0,i-n+t):e}let rb=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[ul,qn,xm]})}}return i})();const f_={capture:!0},Uw=["focus","mousedown","mouseenter","touchstart"],Gh="mat-ripple-loader-uninitialized",jw="mat-ripple-loader-class-name",ob="mat-ripple-loader-centered",a0="mat-ripple-loader-disabled";let m_=(()=>{class i{constructor(){this._document=(0,o.WQX)(Nn,{optional:!0}),this._animationMode=(0,o.WQX)(o.bc$,{optional:!0}),this._globalRippleOptions=(0,o.WQX)(zp,{optional:!0}),this._platform=(0,o.WQX)(wo),this._ngZone=(0,o.WQX)(o.SKi),this._hosts=new Map,this._onInteraction=e=>{const n=Td(e);if(n instanceof HTMLElement){const r=n.closest(`[${Gh}="${this._globalRippleOptions?.namespace??""}"]`);r&&this._createRipple(r)}},this._ngZone.runOutsideAngular(()=>{for(const e of Uw)this._document?.addEventListener(e,this._onInteraction,f_)})}ngOnDestroy(){const e=this._hosts.keys();for(const n of e)this.destroyRipple(n);for(const n of Uw)this._document?.removeEventListener(n,this._onInteraction,f_)}configureRipple(e,n){e.setAttribute(Gh,this._globalRippleOptions?.namespace??""),(n.className||!e.hasAttribute(jw))&&e.setAttribute(jw,n.className||""),n.centered&&e.setAttribute(ob,""),n.disabled&&e.setAttribute(a0,"")}getRipple(e){return this._hosts.get(e)||this._createRipple(e)}setDisabled(e,n){const r=this._hosts.get(e);r?r.disabled=n:n?e.setAttribute(a0,""):e.removeAttribute(a0)}_createRipple(e){if(!this._document)return;const n=this._hosts.get(e);if(n)return n;e.querySelector(".mat-ripple")?.remove();const r=this._document.createElement("span");r.classList.add("mat-ripple",e.getAttribute(jw)),e.append(r);const l=new dl(new o.aKT(r),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return l._isInitialized=!0,l.trigger=e,l.centered=e.hasAttribute(ob),l.disabled=e.hasAttribute(a0),this.attachRipple(e,l),l}attachRipple(e,n){e.removeAttribute(Gh),this._hosts.set(e,n)}destroyRipple(e){const n=this._hosts.get(e);n&&(n.ngOnDestroy(),this._hosts.delete(e))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),sb=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(n,r){2&n&&o.AVh("mdc-form-field--align-end","before"===r.labelPosition)},inputs:{labelPosition:"labelPosition"},standalone:!0,features:[o.aNF],attrs:o0,ngContentSelectors:VM,decls:1,vars:0,template:function(n,r){1&n&&(o.NAR(),o.SdG(0))},styles:[".mdc-form-field{display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field[hidden]{display:none}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{margin-left:auto;margin-right:0}[dir=rtl] .mdc-form-field>label,.mdc-form-field>label[dir=rtl]{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{margin-left:0;margin-right:auto}[dir=rtl] .mdc-form-field--align-end>label,.mdc-form-field--align-end>label[dir=rtl]{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}[dir=rtl] .mdc-form-field--space-between>label,.mdc-form-field--space-between>label[dir=rtl]{margin:0}.mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}"],encapsulation:2,changeDetection:0})}}return i})();const Gw=["*",[["mat-toolbar-row"]]],kE=["*","mat-toolbar-row"];let IE=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"],standalone:!0})}}return i})(),Hw=(()=>{class i{constructor(e,n,r){this._elementRef=e,this._platform=n,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(wo),o.rXU(Nn))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-toolbar"]],contentQueries:function(n,r,l){if(1&n&&o.wni(l,IE,5),2&n){let m;o.mGM(m=o.lsd())&&(r._toolbarRows=m)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(n,r){2&n&&(o.HbH(r.color?"mat-"+r.color:""),o.AVh("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",0===r._toolbarRows.length))},inputs:{color:"color"},exportAs:["matToolbar"],standalone:!0,features:[o.aNF],ngContentSelectors:kE,decls:2,vars:0,template:function(n,r){1&n&&(o.NAR(Gw),o.SdG(0),o.SdG(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color);--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color)}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0})}}return i})(),$w=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,qn]})}}return i})();function uu(...i){const t=kn(i),{args:e,keys:n}=dt(i),r=new Ai.c(l=>{const{length:m}=e;if(!m)return void l.complete();const C=new Array(m);let A=m,O=m;for(let z=0;z<m;z++){let $=!1;pn(e[z]).subscribe((0,bt._)(l,Q=>{$||($=!0,O--),C[z]=Q},()=>A--,void 0,()=>{(!A||!$)&&(O||l.next(n?Zt(n,C):C),l.complete())}))}});return t?r.pipe(ai(t)):r}var Hh=It(707);function p_(i={}){const{connector:t=()=>new xi.B,resetOnError:e=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return l=>{let m,C,A,O=0,z=!1,$=!1;const Q=()=>{C?.unsubscribe(),C=void 0},te=()=>{Q(),m=A=void 0,z=$=!1},de=()=>{const fe=m;te(),fe?.unsubscribe()};return(0,ut.N)((fe,ge)=>{O++,!$&&!z&&Q();const Re=A=A??t();ge.add(()=>{O--,0===O&&!$&&!z&&(C=Hp(de,r))}),Re.subscribe(ge),!m&&O>0&&(m=new Hh.Ms({next:qe=>Re.next(qe),error:qe=>{$=!0,Q(),C=Hp(te,e,qe),Re.error(qe)},complete:()=>{z=!0,Q(),C=Hp(te,n),Re.complete()}}),pn(fe).subscribe(m))})(l)}}function Hp(i,t,...e){if(!0===t)return void i();if(!1===t)return;const n=new Hh.Ms({next:()=>{n.unsubscribe(),i()}});return pn(t(...e)).subscribe(n)}class g_{}class l0{}class Fl{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(e=>{const n=e.indexOf(":");if(n>0){const r=e.slice(0,n),l=r.toLowerCase(),m=e.slice(n+1).trim();this.maybeSetNormalizedName(r,l),this.headers.has(l)?this.headers.get(l).push(m):this.headers.set(l,[m])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,n)=>{this.setHeaderEntries(n,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,n])=>{this.setHeaderEntries(e,n)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Fl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Fl;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Fl?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const l=t.value;if(l){let m=this.headers.get(e);if(!m)return;m=m.filter(C=>-1===l.indexOf(C)),0===m.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,m)}else this.headers.delete(e),this.normalizedNames.delete(e)}}setHeaderEntries(t,e){const n=(Array.isArray(e)?e:[e]).map(l=>l.toString()),r=t.toLowerCase();this.headers.set(r,n),this.maybeSetNormalizedName(t,r)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class qM{encodeKey(t){return PE(t)}encodeValue(t){return PE(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const RE=/%(\d[a-f0-9])/gi,c0={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function PE(i){return encodeURIComponent(i).replace(RE,(t,e)=>c0[e]??t)}function __(i){return`${i}`}class La{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new qM,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function YM(i,t){const e=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{const l=r.indexOf("="),[m,C]=-1==l?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,l)),t.decodeValue(r.slice(l+1))],A=e.get(m)||[];A.push(C),e.set(m,A)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e],r=Array.isArray(n)?n.map(__):[__(n)];this.map.set(e,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(n=>{const r=t[n];Array.isArray(r)?r.forEach(l=>{e.push({param:n,value:l,op:"a"})}):e.push({param:n,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(n=>e+"="+this.encoder.encodeValue(n)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new La({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(__(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let n=this.map.get(t.param)||[];const r=n.indexOf(__(t.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(t.param,n):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class LE{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function ih(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function Xw(i){return typeof Blob<"u"&&i instanceof Blob}function qw(i){return typeof FormData<"u"&&i instanceof FormData}class v_{constructor(t,e,n,r){let l;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function d0(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,l=r):l=n,l&&(this.reportProgress=!!l.reportProgress,this.withCredentials=!!l.withCredentials,l.responseType&&(this.responseType=l.responseType),l.headers&&(this.headers=l.headers),l.context&&(this.context=l.context),l.params&&(this.params=l.params),this.transferCache=l.transferCache),this.headers??=new Fl,this.context??=new LE,this.params){const m=this.params.toString();if(0===m.length)this.urlWithParams=e;else{const C=e.indexOf("?");this.urlWithParams=e+(-1===C?"?":C<e.length-1?"&":"")+m}}else this.params=new La,this.urlWithParams=e}serializeBody(){return null===this.body?null:"string"==typeof this.body||ih(this.body)||Xw(this.body)||qw(this.body)||function FE(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}(this.body)?this.body:this.body instanceof La?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||qw(this.body)?null:Xw(this.body)?this.body.type||null:ih(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof La?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,r=t.responseType||this.responseType,l=t.transferCache??this.transferCache,m=void 0!==t.body?t.body:this.body,C=t.withCredentials??this.withCredentials,A=t.reportProgress??this.reportProgress;let O=t.headers||this.headers,z=t.params||this.params;const $=t.context??this.context;return void 0!==t.setHeaders&&(O=Object.keys(t.setHeaders).reduce((Q,te)=>Q.set(te,t.setHeaders[te]),O)),t.setParams&&(z=Object.keys(t.setParams).reduce((Q,te)=>Q.set(te,t.setParams[te]),z)),new v_(e,n,m,{params:z,headers:O,context:$,reportProgress:A,responseType:r,withCredentials:C,transferCache:l})}}var hu=function(i){return i[i.Sent=0]="Sent",i[i.UploadProgress=1]="UploadProgress",i[i.ResponseHeader=2]="ResponseHeader",i[i.DownloadProgress=3]="DownloadProgress",i[i.Response=4]="Response",i[i.User=5]="User",i}(hu||{});class $p{constructor(t,e=200,n="OK"){this.headers=t.headers||new Fl,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class b_ extends $p{constructor(t={}){super(t),this.type=hu.ResponseHeader}clone(t={}){return new b_({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Qc extends $p{constructor(t={}){super(t),this.type=hu.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Qc({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class fu extends $p{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}var Rd=function(i){return i[i.Continue=100]="Continue",i[i.SwitchingProtocols=101]="SwitchingProtocols",i[i.Processing=102]="Processing",i[i.EarlyHints=103]="EarlyHints",i[i.Ok=200]="Ok",i[i.Created=201]="Created",i[i.Accepted=202]="Accepted",i[i.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",i[i.NoContent=204]="NoContent",i[i.ResetContent=205]="ResetContent",i[i.PartialContent=206]="PartialContent",i[i.MultiStatus=207]="MultiStatus",i[i.AlreadyReported=208]="AlreadyReported",i[i.ImUsed=226]="ImUsed",i[i.MultipleChoices=300]="MultipleChoices",i[i.MovedPermanently=301]="MovedPermanently",i[i.Found=302]="Found",i[i.SeeOther=303]="SeeOther",i[i.NotModified=304]="NotModified",i[i.UseProxy=305]="UseProxy",i[i.Unused=306]="Unused",i[i.TemporaryRedirect=307]="TemporaryRedirect",i[i.PermanentRedirect=308]="PermanentRedirect",i[i.BadRequest=400]="BadRequest",i[i.Unauthorized=401]="Unauthorized",i[i.PaymentRequired=402]="PaymentRequired",i[i.Forbidden=403]="Forbidden",i[i.NotFound=404]="NotFound",i[i.MethodNotAllowed=405]="MethodNotAllowed",i[i.NotAcceptable=406]="NotAcceptable",i[i.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",i[i.RequestTimeout=408]="RequestTimeout",i[i.Conflict=409]="Conflict",i[i.Gone=410]="Gone",i[i.LengthRequired=411]="LengthRequired",i[i.PreconditionFailed=412]="PreconditionFailed",i[i.PayloadTooLarge=413]="PayloadTooLarge",i[i.UriTooLong=414]="UriTooLong",i[i.UnsupportedMediaType=415]="UnsupportedMediaType",i[i.RangeNotSatisfiable=416]="RangeNotSatisfiable",i[i.ExpectationFailed=417]="ExpectationFailed",i[i.ImATeapot=418]="ImATeapot",i[i.MisdirectedRequest=421]="MisdirectedRequest",i[i.UnprocessableEntity=422]="UnprocessableEntity",i[i.Locked=423]="Locked",i[i.FailedDependency=424]="FailedDependency",i[i.TooEarly=425]="TooEarly",i[i.UpgradeRequired=426]="UpgradeRequired",i[i.PreconditionRequired=428]="PreconditionRequired",i[i.TooManyRequests=429]="TooManyRequests",i[i.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",i[i.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",i[i.InternalServerError=500]="InternalServerError",i[i.NotImplemented=501]="NotImplemented",i[i.BadGateway=502]="BadGateway",i[i.ServiceUnavailable=503]="ServiceUnavailable",i[i.GatewayTimeout=504]="GatewayTimeout",i[i.HttpVersionNotSupported=505]="HttpVersionNotSupported",i[i.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",i[i.InsufficientStorage=507]="InsufficientStorage",i[i.LoopDetected=508]="LoopDetected",i[i.NotExtended=510]="NotExtended",i[i.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",i}(Rd||{});function Cm(i,t){return{body:t,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials,transferCache:i.transferCache}}let Em=(()=>{class i{constructor(e){this.handler=e}request(e,n,r={}){let l;if(e instanceof v_)l=e;else{let A,O;A=r.headers instanceof Fl?r.headers:new Fl(r.headers),r.params&&(O=r.params instanceof La?r.params:new La({fromObject:r.params})),l=new v_(e,n,void 0!==r.body?r.body:null,{headers:A,context:r.context,params:O,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const m=di(l).pipe(ld(A=>this.handler.handle(A)));if(e instanceof v_||"events"===r.observe)return m;const C=m.pipe(Ur(A=>A instanceof Qc));switch(r.observe||"body"){case"body":switch(l.responseType){case"arraybuffer":return C.pipe((0,st.T)(A=>{if(null!==A.body&&!(A.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return A.body}));case"blob":return C.pipe((0,st.T)(A=>{if(null!==A.body&&!(A.body instanceof Blob))throw new Error("Response is not a Blob.");return A.body}));case"text":return C.pipe((0,st.T)(A=>{if(null!==A.body&&"string"!=typeof A.body)throw new Error("Response is not a string.");return A.body}));default:return C.pipe((0,st.T)(A=>A.body))}case"response":return C;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,n={}){return this.request("DELETE",e,n)}get(e,n={}){return this.request("GET",e,n)}head(e,n={}){return this.request("HEAD",e,n)}jsonp(e,n){return this.request("JSONP",e,{params:(new La).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,n={}){return this.request("OPTIONS",e,n)}patch(e,n,r={}){return this.request("PATCH",e,Cm(r,n))}post(e,n,r={}){return this.request("POST",e,Cm(r,n))}put(e,n,r={}){return this.request("PUT",e,Cm(r,n))}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(g_))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const ZM=/^\)\]\}',?\n/;function $h(i){if(i.url)return i.url;const t="X-Request-URL".toLocaleLowerCase();return i.headers.get(t)}let tc=(()=>{class i{constructor(){this.fetchImpl=(0,o.WQX)(y_,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=(0,o.WQX)(o.SKi)}handle(e){return new Ai.c(n=>{const r=new AbortController;return this.doRequest(e,r.signal,n).then(h0,l=>n.error(new fu({error:l}))),()=>r.abort()})}doRequest(e,n,r){var l=this;return(0,Yt.A)(function*(){const m=l.createRequestInit(e);let C;try{const de=l.fetchImpl(e.urlWithParams,{signal:n,...m});(function NE(i){i.then(h0,h0)})(de),r.next({type:hu.Sent}),C=yield de}catch(de){return void r.error(new fu({error:de,status:de.status??0,statusText:de.statusText,url:e.urlWithParams,headers:de.headers}))}const A=new Fl(C.headers),O=C.statusText,z=$h(C)??e.urlWithParams;let $=C.status,Q=null;if(e.reportProgress&&r.next(new b_({headers:A,status:$,statusText:O,url:z})),C.body){const de=C.headers.get("content-length"),fe=[],ge=C.body.getReader();let qe,et,Re=0;const yt=typeof Zone<"u"&&Zone.current;yield l.ngZone.runOutsideAngular((0,Yt.A)(function*(){for(;;){const{done:fi,value:Hi}=yield ge.read();if(fi)break;if(fe.push(Hi),Re+=Hi.length,e.reportProgress){et="text"===e.responseType?(et??"")+(qe??=new TextDecoder).decode(Hi,{stream:!0}):void 0;const tn=()=>r.next({type:hu.DownloadProgress,total:de?+de:void 0,loaded:Re,partialText:et});yt?yt.run(tn):tn()}}}));const Jt=l.concatChunks(fe,Re);try{const fi=C.headers.get("Content-Type")??"";Q=l.parseBody(e,Jt,fi)}catch(fi){return void r.error(new fu({error:fi,headers:new Fl(C.headers),status:C.status,statusText:C.statusText,url:$h(C)??e.urlWithParams}))}}0===$&&($=Q?200:0),$>=200&&$<300?(r.next(new Qc({body:Q,headers:A,status:$,statusText:O,url:z})),r.complete()):r.error(new fu({error:Q,headers:A,status:$,statusText:O,url:z}))})()}parseBody(e,n,r){switch(e.responseType){case"json":const l=(new TextDecoder).decode(n).replace(ZM,"");return""===l?null:JSON.parse(l);case"text":return(new TextDecoder).decode(n);case"blob":return new Blob([n],{type:r});case"arraybuffer":return n.buffer}}createRequestInit(e){const n={},r=e.withCredentials?"include":void 0;if(e.headers.forEach((l,m)=>n[l]=m.join(",")),n.Accept??="application/json, text/plain, */*",!n["Content-Type"]){const l=e.detectContentTypeHeader();null!==l&&(n["Content-Type"]=l)}return{body:e.serializeBody(),method:e.method,headers:n,credentials:r}}concatChunks(e,n){const r=new Uint8Array(n);let l=0;for(const m of e)r.set(m,l),l+=m.length;return r}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();class y_{}function h0(){}function f0(i,t){return t(i)}function m0(i,t){return(e,n)=>t.intercept(e,{handle:r=>i(r,n)})}const Yw=new o.nKC(""),Wp=new o.nKC(""),VE=new o.nKC(""),zE=new o.nKC("",{providedIn:"root",factory:()=>!0});function Wh(){let i=null;return(t,e)=>{null===i&&(i=((0,o.WQX)(Yw,{optional:!0})??[]).reduceRight(m0,f0));const n=(0,o.WQX)(o.TgB);if((0,o.WQX)(zE)){const l=n.add();return i(t,e).pipe(Ir(()=>n.remove(l)))}return i(t,e)}}let ab=(()=>{class i extends g_{constructor(e,n){super(),this.backend=e,this.injector=n,this.chain=null,this.pendingTasks=(0,o.WQX)(o.TgB),this.contributeToStability=(0,o.WQX)(zE)}handle(e){if(null===this.chain){const n=Array.from(new Set([...this.injector.get(Wp),...this.injector.get(VE,[])]));this.chain=n.reduceRight((r,l)=>function BE(i,t,e){return(n,r)=>(0,o.N4e)(e,()=>t(n,l=>i(l,r)))}(r,l,this.injector),f0)}if(this.contributeToStability){const n=this.pendingTasks.add();return this.chain(e,r=>this.backend.handle(r)).pipe(Ir(()=>this.pendingTasks.remove(n)))}return this.chain(e,n=>this.backend.handle(n))}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(l0),o.KVO(o.uvJ))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const tA=/^\)\]\}',?\n/;let Qw=(()=>{class i{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new o.wOt(-2800,!1);const n=this.xhrFactory;return(n.\u0275loadImpl?Pn(n.\u0275loadImpl()):di(null)).pipe(So(()=>new Ai.c(l=>{const m=n.build();if(m.open(e.method,e.urlWithParams),e.withCredentials&&(m.withCredentials=!0),e.headers.forEach((fe,ge)=>m.setRequestHeader(fe,ge.join(","))),e.headers.has("Accept")||m.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const fe=e.detectContentTypeHeader();null!==fe&&m.setRequestHeader("Content-Type",fe)}if(e.responseType){const fe=e.responseType.toLowerCase();m.responseType="json"!==fe?fe:"text"}const C=e.serializeBody();let A=null;const O=()=>{if(null!==A)return A;const fe=m.statusText||"OK",ge=new Fl(m.getAllResponseHeaders()),Re=function AI(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(m)||e.url;return A=new b_({headers:ge,status:m.status,statusText:fe,url:Re}),A},z=()=>{let{headers:fe,status:ge,statusText:Re,url:qe}=O(),et=null;204!==ge&&(et=typeof m.response>"u"?m.responseText:m.response),0===ge&&(ge=et?200:0);let yt=ge>=200&&ge<300;if("json"===e.responseType&&"string"==typeof et){const Jt=et;et=et.replace(tA,"");try{et=""!==et?JSON.parse(et):null}catch(fi){et=Jt,yt&&(yt=!1,et={error:fi,text:et})}}yt?(l.next(new Qc({body:et,headers:fe,status:ge,statusText:Re,url:qe||void 0})),l.complete()):l.error(new fu({error:et,headers:fe,status:ge,statusText:Re,url:qe||void 0}))},$=fe=>{const{url:ge}=O(),Re=new fu({error:fe,status:m.status||0,statusText:m.statusText||"Unknown Error",url:ge||void 0});l.error(Re)};let Q=!1;const te=fe=>{Q||(l.next(O()),Q=!0);let ge={type:hu.DownloadProgress,loaded:fe.loaded};fe.lengthComputable&&(ge.total=fe.total),"text"===e.responseType&&m.responseText&&(ge.partialText=m.responseText),l.next(ge)},de=fe=>{let ge={type:hu.UploadProgress,loaded:fe.loaded};fe.lengthComputable&&(ge.total=fe.total),l.next(ge)};return m.addEventListener("load",z),m.addEventListener("error",$),m.addEventListener("timeout",$),m.addEventListener("abort",$),e.reportProgress&&(m.addEventListener("progress",te),null!==C&&m.upload&&m.upload.addEventListener("progress",de)),m.send(C),l.next({type:hu.Sent}),()=>{m.removeEventListener("error",$),m.removeEventListener("abort",$),m.removeEventListener("load",z),m.removeEventListener("timeout",$),e.reportProgress&&(m.removeEventListener("progress",te),null!==C&&m.upload&&m.upload.removeEventListener("progress",de)),m.readyState!==m.DONE&&m.abort()}})))}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Du))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const hl=new o.nKC(""),e1=new o.nKC("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),UE=new o.nKC("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class fs{}let n1=(()=>{class i{constructor(e,n,r){this.doc=e,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=mg(e,this.cookieName),this.lastCookieString=e),this.lastToken}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn),o.KVO(o.Agw),o.KVO(e1))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();function p0(i,t){const e=i.url.toLowerCase();if(!(0,o.WQX)(hl)||"GET"===i.method||"HEAD"===i.method||e.startsWith("http://")||e.startsWith("https://"))return t(i);const n=(0,o.WQX)(fs).getToken(),r=(0,o.WQX)(UE);return null!=n&&!i.headers.has(r)&&(i=i.clone({headers:i.headers.set(r,n)})),t(i)}var nh=function(i){return i[i.Interceptors=0]="Interceptors",i[i.LegacyInterceptors=1]="LegacyInterceptors",i[i.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",i[i.NoXsrfProtection=3]="NoXsrfProtection",i[i.JsonpSupport=4]="JsonpSupport",i[i.RequestsMadeViaParent=5]="RequestsMadeViaParent",i[i.Fetch=6]="Fetch",i}(nh||{});const d=new o.nKC(""),At=["*"];let ft;function ii(i){return function Dt(){if(void 0===ft&&(ft=null,typeof window<"u")){const i=window;void 0!==i.trustedTypes&&(ft=i.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return ft}()?.createHTML(i)||i}function Lt(i){return Error(`Unable to find icon with the name "${i}"`)}function Ti(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function Ut(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}class on{constructor(t,e,n){this.url=t,this.svgText=e,this.options=n}}let Gi=(()=>{class i{constructor(e,n,r,l){this._httpClient=e,this._sanitizer=n,this._errorHandler=l,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(e,n,r){return this.addSvgIconInNamespace("",e,n,r)}addSvgIconLiteral(e,n,r){return this.addSvgIconLiteralInNamespace("",e,n,r)}addSvgIconInNamespace(e,n,r,l){return this._addSvgIconConfig(e,n,new on(r,null,l))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,n,r,l){const m=this._sanitizer.sanitize(o.WPN.HTML,r);if(!m)throw Ut(r);const C=ii(m);return this._addSvgIconConfig(e,n,new on("",C,l))}addSvgIconSet(e,n){return this.addSvgIconSetInNamespace("",e,n)}addSvgIconSetLiteral(e,n){return this.addSvgIconSetLiteralInNamespace("",e,n)}addSvgIconSetInNamespace(e,n,r){return this._addSvgIconSetConfig(e,new on(n,null,r))}addSvgIconSetLiteralInNamespace(e,n,r){const l=this._sanitizer.sanitize(o.WPN.HTML,n);if(!l)throw Ut(n);const m=ii(l);return this._addSvgIconSetConfig(e,new on("",m,r))}registerFontClassAlias(e,n=e){return this._fontCssClassesByAlias.set(e,n),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const n=this._sanitizer.sanitize(o.WPN.RESOURCE_URL,e);if(!n)throw Ti(e);const r=this._cachedIconsByUrl.get(n);return r?di(Qi(r)):this._loadSvgIconFromConfig(new on(e,null)).pipe(Oo(l=>this._cachedIconsByUrl.set(n,l)),(0,st.T)(l=>Qi(l)))}getNamedSvgIcon(e,n=""){const r=Hn(n,e);let l=this._svgIconConfigs.get(r);if(l)return this._getSvgFromConfig(l);if(l=this._getIconConfigFromResolvers(n,e),l)return this._svgIconConfigs.set(r,l),this._getSvgFromConfig(l);const m=this._iconSetConfigs.get(n);return m?this._getSvgFromIconSetConfigs(e,m):$s(Lt(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?di(Qi(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe((0,st.T)(n=>Qi(n)))}_getSvgFromIconSetConfigs(e,n){const r=this._extractIconWithNameFromAnySet(e,n);return r?di(r):uu(n.filter(m=>!m.svgText).map(m=>this._loadSvgIconSetFromConfig(m).pipe(xa(C=>{const O=`Loading icon set URL: ${this._sanitizer.sanitize(o.WPN.RESOURCE_URL,m.url)} failed: ${C.message}`;return this._errorHandler.handleError(new Error(O)),di(null)})))).pipe((0,st.T)(()=>{const m=this._extractIconWithNameFromAnySet(e,n);if(!m)throw Lt(e);return m}))}_extractIconWithNameFromAnySet(e,n){for(let r=n.length-1;r>=0;r--){const l=n[r];if(l.svgText&&l.svgText.toString().indexOf(e)>-1){const m=this._svgElementFromConfig(l),C=this._extractSvgIconFromSet(m,e,l.options);if(C)return C}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Oo(n=>e.svgText=n),(0,st.T)(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?di(null):this._fetchIcon(e).pipe(Oo(n=>e.svgText=n))}_extractSvgIconFromSet(e,n,r){const l=e.querySelector(`[id="${n}"]`);if(!l)return null;const m=l.cloneNode(!0);if(m.removeAttribute("id"),"svg"===m.nodeName.toLowerCase())return this._setSvgAttributes(m,r);if("symbol"===m.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(m),r);const C=this._svgElementFromString(ii("<svg></svg>"));return C.appendChild(m),this._setSvgAttributes(C,r)}_svgElementFromString(e){const n=this._document.createElement("DIV");n.innerHTML=e;const r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(e){const n=this._svgElementFromString(ii("<svg></svg>")),r=e.attributes;for(let l=0;l<r.length;l++){const{name:m,value:C}=r[l];"id"!==m&&n.setAttribute(m,C)}for(let l=0;l<e.childNodes.length;l++)e.childNodes[l].nodeType===this._document.ELEMENT_NODE&&n.appendChild(e.childNodes[l].cloneNode(!0));return n}_setSvgAttributes(e,n){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),n&&n.viewBox&&e.setAttribute("viewBox",n.viewBox),e}_fetchIcon(e){const{url:n,options:r}=e,l=r?.withCredentials??!1;if(!this._httpClient)throw function Ui(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const m=this._sanitizer.sanitize(o.WPN.RESOURCE_URL,n);if(!m)throw Ti(n);const C=this._inProgressUrlFetches.get(m);if(C)return C;const A=this._httpClient.get(m,{responseType:"text",withCredentials:l}).pipe((0,st.T)(O=>ii(O)),Ir(()=>this._inProgressUrlFetches.delete(m)),p_());return this._inProgressUrlFetches.set(m,A),A}_addSvgIconConfig(e,n,r){return this._svgIconConfigs.set(Hn(e,n),r),this}_addSvgIconSetConfig(e,n){const r=this._iconSetConfigs.get(e);return r?r.push(n):this._iconSetConfigs.set(e,[n]),this}_svgElementFromConfig(e){if(!e.svgElement){const n=this._svgElementFromString(e.svgText);this._setSvgAttributes(n,e.options),e.svgElement=n}return e.svgElement}_getIconConfigFromResolvers(e,n){for(let r=0;r<this._resolvers.length;r++){const l=this._resolvers[r](n,e);if(l)return hn(l)?new on(l.url,null,l.options):new on(l,null)}}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Em,8),o.KVO(w),o.KVO(Nn,8),o.KVO(o.zcH))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Qi(i){return i.cloneNode(!0)}function Hn(i,t){return i+":"+t}function hn(i){return!(!i.url||!i.options)}const Yn=new o.nKC("MAT_ICON_DEFAULT_OPTIONS"),In=new o.nKC("mat-icon-location",{providedIn:"root",factory:function xr(){const i=(0,o.WQX)(Nn),t=i?i.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),Rn=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],po=Rn.map(i=>`[${i}]`).join(", "),Fr=/^url\(['"]?#(.*?)['"]?\)$/;let Mr=(()=>{class i{get color(){return this._color||this._defaultColor}set color(e){this._color=e}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const n=this._cleanupFontValue(e);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const n=this._cleanupFontValue(e);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}constructor(e,n,r,l,m,C){this._elementRef=e,this._iconRegistry=n,this._location=l,this._errorHandler=m,this.inline=!1,this._previousFontSetClass=[],this._currentIconFetch=On.yU.EMPTY,C&&(C.color&&(this.color=this._defaultColor=C.color),C.fontSet&&(this.fontSet=C.fontSet)),r||e.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];const n=e.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let n=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){const r=e.childNodes[n];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>e.classList.remove(r)),n.forEach(r=>e.classList.add(r)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const n=this._elementsWithExternalReferences;n&&n.forEach((r,l)=>{r.forEach(m=>{l.setAttribute(m.name,`url('${e}#${m.value}')`)})})}_cacheChildrenWithExternalReferences(e){const n=e.querySelectorAll(po),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let l=0;l<n.length;l++)Rn.forEach(m=>{const C=n[l],A=C.getAttribute(m),O=A?A.match(Fr):null;if(O){let z=r.get(C);z||(z=[],r.set(C,z)),z.push({name:m,value:O[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[n,r]=this._splitIconName(e);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(gs(1)).subscribe(l=>this._setSvgElement(l),l=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${n}:${r}! ${l.message}`))})}}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(Gi),o.kS0("aria-hidden"),o.rXU(In),o.rXU(o.zcH),o.rXU(Yn,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(n,r){2&n&&(o.BMQ("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),o.HbH(r.color?"mat-"+r.color:""),o.AVh("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:[2,"inline","inline",o.L39],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],standalone:!0,features:[o.GFd,o.aNF],ngContentSelectors:At,decls:1,vars:0,template:function(n,r){1&n&&(o.NAR(),o.SdG(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}}return i})(),Er=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,qn]})}}return i})();const Gr=["mat-button",""],Mo=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Jr=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],aa=["mat-fab",""],Uo=["mat-mini-fab",""],ma=["mat-icon-button",""],pa=["*"],Co=new o.nKC("MAT_BUTTON_CONFIG"),Yh=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}];let wa=(()=>{class i{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(e){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,e)}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=e,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._updateRippleDisabled()}constructor(e,n,r,l){this._elementRef=e,this._platform=n,this._ngZone=r,this._animationMode=l,this._focusMonitor=(0,o.WQX)(Kc),this._rippleLoader=(0,o.WQX)(m_),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;const m=(0,o.WQX)(Co,{optional:!0}),C=e.nativeElement,A=C.classList;this.disabledInteractive=m?.disabledInteractive??!1,this._rippleLoader?.configureRipple(C,{className:"mat-mdc-button-ripple"});for(const{attribute:O,mdcClasses:z}of Yh)C.hasAttribute(O)&&A.add(...z)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(e="program",n){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,n):this._elementRef.nativeElement.focus(n)}_getAriaDisabled(){return null!=this.ariaDisabled?this.ariaDisabled:!(!this.disabled||!this.disabledInteractive)||null}_getDisabledAttribute(){return!(this.disabledInteractive||!this.disabled)||null}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static{this.\u0275fac=function(n){o.QTQ()}}static{this.\u0275dir=o.FsC({type:i,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",o.L39],disabled:[2,"disabled","disabled",o.L39],ariaDisabled:[2,"aria-disabled","ariaDisabled",o.L39],disabledInteractive:[2,"disabledInteractive","disabledInteractive",o.L39]},features:[o.GFd]})}}return i})(),Sc=(()=>{class i extends wa{constructor(e,n,r,l){super(e,n,r,l)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(wo),o.rXU(o.SKi),o.rXU(o.bc$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(n,r){2&n&&(o.BMQ("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),o.HbH(r.color?"mat-"+r.color:""),o.AVh("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[o.Vt3,o.aNF],attrs:Gr,ngContentSelectors:Jr,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,r){1&n&&(o.NAR(Mo),o.nrm(0,"span",0),o.SdG(1),o.j41(2,"span",1),o.SdG(3,1),o.k0s(),o.SdG(4,2),o.nrm(5,"span",2)(6,"span",3)),2&n&&o.AVh("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px);display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);font-weight:var(--mdc-text-button-label-text-weight);text-transform:var(--mdc-text-button-label-text-transform);height:var(--mdc-text-button-container-height);border-radius:var(--mdc-text-button-container-shape);padding:0 var(--mat-text-button-horizontal-padding, 8px)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);font-weight:var(--mdc-filled-button-label-text-weight);text-transform:var(--mdc-filled-button-label-text-transform);height:var(--mdc-filled-button-container-height);border-radius:var(--mdc-filled-button-container-shape);padding:0 var(--mat-filled-button-horizontal-padding, 16px)}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color)}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);font-weight:var(--mdc-protected-button-label-text-weight);text-transform:var(--mdc-protected-button-label-text-transform);height:var(--mdc-protected-button-container-height);border-radius:var(--mdc-protected-button-container-shape);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow)}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color)}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);font-weight:var(--mdc-outlined-button-label-text-weight);text-transform:var(--mdc-outlined-button-label-text-transform);height:var(--mdc-outlined-button-container-height);border-radius:var(--mdc-outlined-button-container-shape);padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width);padding:0 var(--mat-outlined-button-horizontal-padding, 15px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color)}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape)}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width))}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button-base{text-decoration:none}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}}return i})();const db=new o.nKC("mat-mdc-fab-default-options",{providedIn:"root",factory:_0});function _0(){return{color:"accent"}}const Xp=_0();let iA=(()=>{class i extends wa{constructor(e,n,r,l,m){super(e,n,r,l),this._options=m,this._isFab=!0,this._options=this._options||Xp,this.color=this._options.color||Xp.color}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(wo),o.rXU(o.SKi),o.rXU(o.bc$,8),o.rXU(db,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["button","mat-fab",""]],hostVars:18,hostBindings:function(n,r){2&n&&(o.BMQ("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),o.HbH(r.color?"mat-"+r.color:""),o.AVh("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0)("mdc-fab--extended",r.extended)("mat-mdc-extended-fab",r.extended))},inputs:{extended:[2,"extended","extended",o.L39]},exportAs:["matButton"],standalone:!0,features:[o.GFd,o.Vt3,o.aNF],attrs:aa,ngContentSelectors:Jr,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,r){1&n&&(o.NAR(Mo),o.nrm(0,"span",0),o.SdG(1),o.j41(2,"span",1),o.SdG(3,1),o.k0s(),o.SdG(4,2),o.nrm(5,"span",2)(6,"span",3)),2&n&&o.AVh("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-fab{position:relative;display:inline-flex;position:relative;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;user-select:none;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-fab .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-fab[hidden]{display:none}.mdc-fab::-moz-focus-inner{padding:0;border:0}.mdc-fab .mdc-fab__focus-ring{position:absolute}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{border-color:CanvasText}}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{border-color:CanvasText}}.mdc-fab:active,.mdc-fab:focus{outline:none}.mdc-fab:hover{cursor:pointer}.mdc-fab>svg{width:100%}.mdc-fab--mini{width:40px;height:40px}.mdc-fab--extended{border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;height:48px;line-height:normal}.mdc-fab--extended .mdc-fab__ripple{border-radius:24px}.mdc-fab--extended .mdc-fab__icon{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mdc-fab--extended .mdc-fab__icon,.mdc-fab--extended .mdc-fab__icon[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon,.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}.mdc-fab--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-fab--touch .mdc-fab__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-fab::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-fab::before{border-color:CanvasText}}.mdc-fab__label{justify-content:flex-start;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;overflow-y:visible}.mdc-fab__icon{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mdc-fab .mdc-fab__icon{display:inline-flex;align-items:center;justify-content:center}.mdc-fab--exited{transform:scale(0);opacity:0;transition:opacity 15ms linear 150ms,transform 180ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-fab--exited .mdc-fab__icon{transform:scale(0);transition:transform 135ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-fab{background-color:var(--mdc-fab-container-color)}.mat-mdc-fab .mdc-fab__icon{width:var(--mdc-fab-icon-size);height:var(--mdc-fab-icon-size);font-size:var(--mdc-fab-icon-size)}.mat-mdc-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-container-shape)}.mat-mdc-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-container-shape)}.mat-mdc-mini-fab{background-color:var(--mdc-fab-small-container-color)}.mat-mdc-mini-fab .mdc-fab__icon{width:var(--mdc-fab-small-icon-size);height:var(--mdc-fab-small-icon-size);font-size:var(--mdc-fab-small-icon-size)}.mat-mdc-mini-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-mini-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-extended-fab{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mdc-extended-fab-container-height);border-radius:var(--mdc-extended-fab-container-shape);font-family:var(--mdc-extended-fab-label-text-font);font-size:var(--mdc-extended-fab-label-text-size);font-weight:var(--mdc-extended-fab-label-text-weight);letter-spacing:var(--mdc-extended-fab-label-text-tracking)}.mat-mdc-extended-fab .mdc-fab__ripple{border-radius:var(--mdc-extended-fab-container-shape)}.mat-mdc-fab,.mat-mdc-mini-fab{-webkit-tap-highlight-color:rgba(0,0,0,0);flex-shrink:0}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-fab .mdc-button__label,.mat-mdc-fab .mat-icon,.mat-mdc-mini-fab .mdc-button__label,.mat-mdc-mini-fab .mat-icon{z-index:1;position:relative}.mat-mdc-fab .mat-mdc-focus-indicator,.mat-mdc-mini-fab .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-fab:focus .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-fab._mat-animation-noopable,.mat-mdc-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-fab:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-mini-fab:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}.mat-mdc-fab .mat-icon,.mat-mdc-fab .material-icons,.mat-mdc-mini-fab .mat-icon,.mat-mdc-mini-fab .material-icons{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mat-mdc-fab .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-fab[disabled],.mat-mdc-fab[disabled]:focus,.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-fab.mat-mdc-button-disabled:focus,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab[disabled]:focus,.mat-mdc-mini-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-fab.mat-mdc-button-disabled-interactive,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-fab{color:var(--mat-fab-foreground-color, inherit);box-shadow:var(--mdc-fab-container-elevation-shadow)}.mat-mdc-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-touch-target-display)}.mat-mdc-fab .mat-ripple-element{background-color:var(--mat-fab-ripple-color)}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-state-layer-color)}.mat-mdc-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-disabled-state-layer-color)}.mat-mdc-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-hover-state-layer-opacity)}.mat-mdc-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-focus-state-layer-opacity)}.mat-mdc-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-pressed-state-layer-opacity)}.mat-mdc-fab:hover{box-shadow:var(--mdc-fab-hover-container-elevation-shadow)}.mat-mdc-fab:focus{box-shadow:var(--mdc-fab-focus-container-elevation-shadow)}.mat-mdc-fab:active,.mat-mdc-fab:focus:active{box-shadow:var(--mdc-fab-pressed-container-elevation-shadow)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-disabled-state-foreground-color);background-color:var(--mat-fab-disabled-state-container-color)}.mat-mdc-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-mini-fab{color:var(--mat-fab-small-foreground-color, inherit);box-shadow:var(--mdc-fab-small-container-elevation-shadow)}.mat-mdc-mini-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-small-touch-target-display)}.mat-mdc-mini-fab .mat-ripple-element{background-color:var(--mat-fab-small-ripple-color)}.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-state-layer-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-disabled-state-layer-color)}.mat-mdc-mini-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-hover-state-layer-opacity)}.mat-mdc-mini-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-focus-state-layer-opacity)}.mat-mdc-mini-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-pressed-state-layer-opacity)}.mat-mdc-mini-fab:hover{box-shadow:var(--mdc-fab-small-hover-container-elevation-shadow)}.mat-mdc-mini-fab:focus{box-shadow:var(--mdc-fab-small-focus-container-elevation-shadow)}.mat-mdc-mini-fab:active,.mat-mdc-mini-fab:focus:active{box-shadow:var(--mdc-fab-small-pressed-container-elevation-shadow)}.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-small-disabled-state-foreground-color);background-color:var(--mat-fab-small-disabled-state-container-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab{box-shadow:var(--mdc-extended-fab-container-elevation-shadow)}.mat-mdc-extended-fab:hover{box-shadow:var(--mdc-extended-fab-hover-container-elevation-shadow)}.mat-mdc-extended-fab:focus{box-shadow:var(--mdc-extended-fab-focus-container-elevation-shadow)}.mat-mdc-extended-fab:active,.mat-mdc-extended-fab:focus:active{box-shadow:var(--mdc-extended-fab-pressed-container-elevation-shadow)}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab[disabled]:focus,.mat-mdc-extended-fab.mat-mdc-button-disabled,.mat-mdc-extended-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-extended-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab>.mat-icon,.mat-mdc-extended-fab>.material-icons{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mat-mdc-extended-fab>.mat-icon,[dir=rtl] .mat-mdc-extended-fab>.material-icons,.mat-mdc-extended-fab>.mat-icon[dir=rtl],.mat-mdc-extended-fab>.material-icons[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mat-mdc-extended-fab .mat-mdc-button-touch-target{width:100%}.mat-mdc-extended-fab .mdc-button__label+.mat-icon,.mat-mdc-extended-fab .mdc-button__label+.material-icons{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.material-icons,.mat-mdc-extended-fab .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-extended-fab .mdc-button__label+.material-icons[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}'],encapsulation:2,changeDetection:0})}}return i})(),jE=(()=>{class i extends wa{constructor(e,n,r,l,m){super(e,n,r,l),this._options=m,this._isFab=!0,this._options=this._options||Xp,this.color=this._options.color||Xp.color}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(wo),o.rXU(o.SKi),o.rXU(o.bc$,8),o.rXU(db,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["button","mat-mini-fab",""]],hostVars:14,hostBindings:function(n,r){2&n&&(o.BMQ("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),o.HbH(r.color?"mat-"+r.color:""),o.AVh("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[o.Vt3,o.aNF],attrs:Uo,ngContentSelectors:Jr,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,r){1&n&&(o.NAR(Mo),o.nrm(0,"span",0),o.SdG(1),o.j41(2,"span",1),o.SdG(3,1),o.k0s(),o.SdG(4,2),o.nrm(5,"span",2)(6,"span",3)),2&n&&o.AVh("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-fab{position:relative;display:inline-flex;position:relative;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;user-select:none;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-fab .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-fab[hidden]{display:none}.mdc-fab::-moz-focus-inner{padding:0;border:0}.mdc-fab .mdc-fab__focus-ring{position:absolute}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring{border-color:CanvasText}}.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-fab.mdc-ripple-upgraded--background-focused .mdc-fab__focus-ring::after,.mdc-fab:not(.mdc-ripple-upgraded):focus .mdc-fab__focus-ring::after{border-color:CanvasText}}.mdc-fab:active,.mdc-fab:focus{outline:none}.mdc-fab:hover{cursor:pointer}.mdc-fab>svg{width:100%}.mdc-fab--mini{width:40px;height:40px}.mdc-fab--extended{border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;height:48px;line-height:normal}.mdc-fab--extended .mdc-fab__ripple{border-radius:24px}.mdc-fab--extended .mdc-fab__icon{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mdc-fab--extended .mdc-fab__icon,.mdc-fab--extended .mdc-fab__icon[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mdc-fab--extended .mdc-fab__label+.mdc-fab__icon,.mdc-fab--extended .mdc-fab__label+.mdc-fab__icon[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}.mdc-fab--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-fab--touch .mdc-fab__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-fab::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-fab::before{border-color:CanvasText}}.mdc-fab__label{justify-content:flex-start;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;overflow-y:visible}.mdc-fab__icon{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mdc-fab .mdc-fab__icon{display:inline-flex;align-items:center;justify-content:center}.mdc-fab--exited{transform:scale(0);opacity:0;transition:opacity 15ms linear 150ms,transform 180ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-fab--exited .mdc-fab__icon{transform:scale(0);transition:transform 135ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mat-mdc-fab{background-color:var(--mdc-fab-container-color)}.mat-mdc-fab .mdc-fab__icon{width:var(--mdc-fab-icon-size);height:var(--mdc-fab-icon-size);font-size:var(--mdc-fab-icon-size)}.mat-mdc-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-container-shape)}.mat-mdc-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-container-shape)}.mat-mdc-mini-fab{background-color:var(--mdc-fab-small-container-color)}.mat-mdc-mini-fab .mdc-fab__icon{width:var(--mdc-fab-small-icon-size);height:var(--mdc-fab-small-icon-size);font-size:var(--mdc-fab-small-icon-size)}.mat-mdc-mini-fab:not(.mdc-fab--extended){border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-mini-fab:not(.mdc-fab--extended) .mdc-fab__ripple{border-radius:var(--mdc-fab-small-container-shape)}.mat-mdc-extended-fab{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mdc-extended-fab-container-height);border-radius:var(--mdc-extended-fab-container-shape);font-family:var(--mdc-extended-fab-label-text-font);font-size:var(--mdc-extended-fab-label-text-size);font-weight:var(--mdc-extended-fab-label-text-weight);letter-spacing:var(--mdc-extended-fab-label-text-tracking)}.mat-mdc-extended-fab .mdc-fab__ripple{border-radius:var(--mdc-extended-fab-container-shape)}.mat-mdc-fab,.mat-mdc-mini-fab{-webkit-tap-highlight-color:rgba(0,0,0,0);flex-shrink:0}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple,.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-fab .mat-mdc-button-ripple,.mat-mdc-mini-fab .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-fab .mdc-button__label,.mat-mdc-fab .mat-icon,.mat-mdc-mini-fab .mdc-button__label,.mat-mdc-mini-fab .mat-icon{z-index:1;position:relative}.mat-mdc-fab .mat-mdc-focus-indicator,.mat-mdc-mini-fab .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-fab:focus .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-fab._mat-animation-noopable,.mat-mdc-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-fab:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-mini-fab:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}.mat-mdc-fab .mat-icon,.mat-mdc-fab .material-icons,.mat-mdc-mini-fab .mat-icon,.mat-mdc-mini-fab .material-icons{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mat-mdc-fab .mat-mdc-focus-indicator::before,.mat-mdc-mini-fab .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-fab[disabled],.mat-mdc-fab[disabled]:focus,.mat-mdc-fab.mat-mdc-button-disabled,.mat-mdc-fab.mat-mdc-button-disabled:focus,.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab[disabled]:focus,.mat-mdc-mini-fab.mat-mdc-button-disabled,.mat-mdc-mini-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-fab.mat-mdc-button-disabled-interactive,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-fab{color:var(--mat-fab-foreground-color, inherit);box-shadow:var(--mdc-fab-container-elevation-shadow)}.mat-mdc-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-touch-target-display)}.mat-mdc-fab .mat-ripple-element{background-color:var(--mat-fab-ripple-color)}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-state-layer-color)}.mat-mdc-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-disabled-state-layer-color)}.mat-mdc-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-hover-state-layer-opacity)}.mat-mdc-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-focus-state-layer-opacity)}.mat-mdc-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-pressed-state-layer-opacity)}.mat-mdc-fab:hover{box-shadow:var(--mdc-fab-hover-container-elevation-shadow)}.mat-mdc-fab:focus{box-shadow:var(--mdc-fab-focus-container-elevation-shadow)}.mat-mdc-fab:active,.mat-mdc-fab:focus:active{box-shadow:var(--mdc-fab-pressed-container-elevation-shadow)}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-disabled-state-foreground-color);background-color:var(--mat-fab-disabled-state-container-color)}.mat-mdc-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-mini-fab{color:var(--mat-fab-small-foreground-color, inherit);box-shadow:var(--mdc-fab-small-container-elevation-shadow)}.mat-mdc-mini-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-small-touch-target-display)}.mat-mdc-mini-fab .mat-ripple-element{background-color:var(--mat-fab-small-ripple-color)}.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-state-layer-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-disabled-state-layer-color)}.mat-mdc-mini-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-hover-state-layer-opacity)}.mat-mdc-mini-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-focus-state-layer-opacity)}.mat-mdc-mini-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-pressed-state-layer-opacity)}.mat-mdc-mini-fab:hover{box-shadow:var(--mdc-fab-small-hover-container-elevation-shadow)}.mat-mdc-mini-fab:focus{box-shadow:var(--mdc-fab-small-focus-container-elevation-shadow)}.mat-mdc-mini-fab:active,.mat-mdc-mini-fab:focus:active{box-shadow:var(--mdc-fab-small-pressed-container-elevation-shadow)}.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-small-disabled-state-foreground-color);background-color:var(--mat-fab-small-disabled-state-container-color)}.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab{box-shadow:var(--mdc-extended-fab-container-elevation-shadow)}.mat-mdc-extended-fab:hover{box-shadow:var(--mdc-extended-fab-hover-container-elevation-shadow)}.mat-mdc-extended-fab:focus{box-shadow:var(--mdc-extended-fab-focus-container-elevation-shadow)}.mat-mdc-extended-fab:active,.mat-mdc-extended-fab:focus:active{box-shadow:var(--mdc-extended-fab-pressed-container-elevation-shadow)}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab[disabled]:focus,.mat-mdc-extended-fab.mat-mdc-button-disabled,.mat-mdc-extended-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-extended-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-extended-fab>.mat-icon,.mat-mdc-extended-fab>.material-icons{margin-left:calc(12px - 20px);margin-right:12px}[dir=rtl] .mat-mdc-extended-fab>.mat-icon,[dir=rtl] .mat-mdc-extended-fab>.material-icons,.mat-mdc-extended-fab>.mat-icon[dir=rtl],.mat-mdc-extended-fab>.material-icons[dir=rtl]{margin-left:12px;margin-right:calc(12px - 20px)}.mat-mdc-extended-fab .mat-mdc-button-touch-target{width:100%}.mat-mdc-extended-fab .mdc-button__label+.mat-icon,.mat-mdc-extended-fab .mdc-button__label+.material-icons{margin-left:12px;margin-right:calc(12px - 20px)}[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.material-icons,.mat-mdc-extended-fab .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-extended-fab .mdc-button__label+.material-icons[dir=rtl]{margin-left:calc(12px - 20px);margin-right:12px}'],encapsulation:2,changeDetection:0})}}return i})(),mu=(()=>{class i extends wa{constructor(e,n,r,l){super(e,n,r,l),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(wo),o.rXU(o.SKi),o.rXU(o.bc$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(n,r){2&n&&(o.BMQ("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),o.HbH(r.color?"mat-"+r.color:""),o.AVh("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[o.Vt3,o.aNF],attrs:ma,ngContentSelectors:pa,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,r){1&n&&(o.NAR(),o.nrm(0,"span",0),o.SdG(1),o.nrm(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{color:var(--mdc-icon-button-icon-color)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 48px);height:var(--mdc-icon-button-state-layer-size, 48px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 48px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size);-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label,.mat-mdc-icon-button .mat-icon{z-index:1;position:relative}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color)}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color)}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color)}.mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity)}.mat-mdc-icon-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity)}.mat-mdc-icon-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity)}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}}return i})(),ea=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,ul,qn]})}}return i})();const o1=()=>["/"];let Tm=(()=>{class i{constructor(e){this.activatedRoute=e}matchRoute(e){return null!=this.activatedRoute.component&&this.activatedRoute.component.name===e}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(qc))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-nav-bar"]],standalone:!0,features:[o.aNF],decls:6,vars:2,consts:[[1,"tool-bar-container"],["color","primary",1,"toolbar"],["mat-icon-button","",1,"home_button",3,"routerLink"],[1,"spacer"]],template:function(n,r){1&n&&(o.j41(0,"header",0)(1,"mat-toolbar",1)(2,"button",2)(3,"mat-icon"),o.EFF(4," home "),o.k0s()(),o.nrm(5,"span",3),o.k0s()()),2&n&&(o.R7$(2),o.Y8G("routerLink",o.lJ4(1,o1)))},dependencies:[$w,Hw,ea,mu,Tv,Er,Mr],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.toolbar[_ngcontent-%COMP%]{height:2.5em}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:fixed;background-color:#048372}.login-button[_ngcontent-%COMP%]{z-index:5}"]})}}return i})();class Sm extends xi.B{constructor(t=1/0,e=1/0,n=Yg){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:l,_windowTime:m}=this;e||(n.push(t),!r&&n.push(l.now()+m)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:n,_buffer:r}=this,l=r.slice();for(let m=0;m<l.length&&!t.closed;m+=n?1:2)t.next(l[m]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:n,_infiniteTimeWindow:r}=this,l=(r?1:2)*t;if(t<1/0&&l<n.length&&n.splice(0,n.length-l),!r){const m=e.now();let C=0;for(let A=1;A<n.length&&n[A]<=m;A+=2)C=A;C&&n.splice(0,C+1)}}}function Io(...i){const t=Xr(i),e=function gi(i,t){return"number"==typeof cr(i)?i.pop():t}(i,1/0),n=i;return n.length?1===n.length?pn(n[0]):Qr(e)(Pn(n,t)):nr}const ub={schedule(i,t){const e=setTimeout(i,t);return()=>clearTimeout(e)},scheduleBeforeRender(i){if(typeof window>"u")return ub.schedule(i,0);if(typeof window.requestAnimationFrame>"u")return ub.schedule(i,16);const t=window.requestAnimationFrame(i);return()=>window.cancelAnimationFrame(t)}};let nc;function b4(i,t,e){let n=e;return function $E(i){return!!i&&i.nodeType===Node.ELEMENT_NODE}(i)&&t.some((r,l)=>!("*"===r||!function hb(i,t){if(!nc){const e=Element.prototype;nc=e.matches||e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}return i.nodeType===Node.ELEMENT_NODE&&nc.call(i,t)}(i,r)||(n=l,0))),n}class x4{constructor(t,e){this.componentFactory=e.get(o.OM3).resolveComponentFactory(t)}create(t){return new w4(this.componentFactory,t)}}class w4{constructor(t,e){this.componentFactory=t,this.injector=e,this.eventEmitters=new Sm(1),this.events=this.eventEmitters.pipe(So(n=>Io(...n))),this.componentRef=null,this.viewChangeDetectorRef=null,this.inputChanges=null,this.hasInputChanges=!1,this.implementsOnChanges=!1,this.scheduledChangeDetectionFn=null,this.scheduledDestroyFn=null,this.initialInputValues=new Map,this.unchangedInputs=new Set(this.componentFactory.inputs.map(({propName:n})=>n)),this.ngZone=this.injector.get(o.SKi),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(t){this.runInZone(()=>{if(null!==this.scheduledDestroyFn)return this.scheduledDestroyFn(),void(this.scheduledDestroyFn=null);null===this.componentRef&&this.initializeComponent(t)})}disconnect(){this.runInZone(()=>{null===this.componentRef||null!==this.scheduledDestroyFn||(this.scheduledDestroyFn=ub.schedule(()=>{null!==this.componentRef&&(this.componentRef.destroy(),this.componentRef=null,this.viewChangeDetectorRef=null)},10))})}getInputValue(t){return this.runInZone(()=>null===this.componentRef?this.initialInputValues.get(t):this.componentRef.instance[t])}setInputValue(t,e,n){this.runInZone(()=>{n&&(e=n.call(this.componentRef?.instance,e)),null!==this.componentRef?function nA(i,t){return i===t||i!=i&&t!=t}(e,this.getInputValue(t))&&(void 0!==e||!this.unchangedInputs.has(t))||(this.recordInputChange(t,e),this.unchangedInputs.delete(t),this.hasInputChanges=!0,this.componentRef.instance[t]=e,this.scheduleDetectChanges()):this.initialInputValues.set(t,e)})}initializeComponent(t){const e=o.zZn.create({providers:[],parent:this.injector}),n=function v4(i,t){const e=i.childNodes,n=t.map(()=>[]);let r=-1;t.some((l,m)=>"*"===l&&(r=m,!0));for(let l=0,m=e.length;l<m;++l){const C=e[l],A=b4(C,t,r);-1!==A&&n[A].push(C)}return n}(t,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(e,n,t),this.viewChangeDetectorRef=this.componentRef.injector.get(o.gRc),this.implementsOnChanges=function DI(i){return"function"==typeof i}(this.componentRef.instance.ngOnChanges),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.detectChanges(),this.injector.get(o.o8S).attachView(this.componentRef.hostView)}initializeInputs(){this.componentFactory.inputs.forEach(({propName:t,transform:e})=>{this.initialInputValues.has(t)&&this.setInputValue(t,this.initialInputValues.get(t),e)}),this.initialInputValues.clear()}initializeOutputs(t){const e=this.componentFactory.outputs.map(({propName:n,templateName:r})=>t.instance[n].pipe((0,st.T)(m=>({name:r,value:m}))));this.eventEmitters.next(e)}callNgOnChanges(t){if(!this.implementsOnChanges||null===this.inputChanges)return;const e=this.inputChanges;this.inputChanges=null,t.instance.ngOnChanges(e)}markViewForCheck(t){this.hasInputChanges&&(this.hasInputChanges=!1,t.markForCheck())}scheduleDetectChanges(){this.scheduledChangeDetectionFn||(this.scheduledChangeDetectionFn=ub.scheduleBeforeRender(()=>{this.scheduledChangeDetectionFn=null,this.detectChanges()}))}recordInputChange(t,e){if(!this.implementsOnChanges)return;null===this.inputChanges&&(this.inputChanges={});const n=this.inputChanges[t];if(n)return void(n.currentValue=e);const r=this.unchangedInputs.has(t),l=r?void 0:this.getInputValue(t);this.inputChanges[t]=new o.FRM(l,e,r)}detectChanges(){null!==this.componentRef&&(this.callNgOnChanges(this.componentRef),this.markViewForCheck(this.viewChangeDetectorRef),this.componentRef.changeDetectorRef.detectChanges())}runInZone(t){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(t):t()}}class C4 extends HTMLElement{constructor(){super(...arguments),this.ngElementEventsSubscription=null}}function xL(i,t){const e=function kI(i,t){return t.get(o.OM3).resolveComponentFactory(i).inputs}(i,t.injector),n=t.strategyFactory||new x4(i,t.injector),r=function Mm(i){const t={};return i.forEach(({propName:e,templateName:n,transform:r})=>{t[function qp(i){return i.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}(n)]=[e,r]}),t}(e);class l extends C4{static{this.observedAttributes=Object.keys(r)}get ngElementStrategy(){if(!this._ngElementStrategy){const C=this._ngElementStrategy=n.create(this.injector||t.injector);e.forEach(({propName:A,transform:O})=>{if(!this.hasOwnProperty(A))return;const z=this[A];delete this[A],C.setInputValue(A,z,O)})}return this._ngElementStrategy}constructor(C){super(),this.injector=C}attributeChangedCallback(C,A,O,z){const[$,Q]=r[C];this.ngElementStrategy.setInputValue($,O,Q)}connectedCallback(){let C=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),C=!0),this.ngElementStrategy.connect(this),C||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(C=>{const A=new CustomEvent(C.name,{detail:C.value});this.dispatchEvent(A)})}}return e.forEach(({propName:m,transform:C})=>{Object.defineProperty(l.prototype,m,{get(){return this.ngElementStrategy.getInputValue(m)},set(A){this.ngElementStrategy.setInputValue(m,A,C)},configurable:!0,enumerable:!0})}),l}let E4=(()=>{class i{constructor(){}emitEventRequest(e){this.eventRequest?.emit(e)}ngOnDestroy(){}closeInfoWindow(){this.infoWindowInstance?.set("toggle",!1),this.infoWindowInstance?.close()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-info-window"]],inputs:{currentStudy:"currentStudy",eventRequest:"eventRequest",infoWindowInstance:"infoWindowInstance"},standalone:!0,features:[o.aNF],decls:11,vars:3,consts:[[1,"container"],["mat-raised-button","","extended","",3,"click"]],template:function(n,r){1&n&&(o.j41(0,"div",0)(1,"h4"),o.EFF(2),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s(),o.nrm(5,"br"),o.j41(6,"span"),o.EFF(7),o.k0s(),o.nrm(8,"br"),o.j41(9,"button",1),o.bIt("click",function(){return r.emitEventRequest(r.currentStudy)}),o.EFF(10,"See Event Data"),o.k0s()()),2&n&&(o.R7$(2),o.JRh(null==r.currentStudy?null:r.currentStudy.name),o.R7$(2),o.SpI("latitude: ",null==r.currentStudy?null:r.currentStudy.mainLocationLat,""),o.R7$(3),o.SpI("longitude: ",null==r.currentStudy?null:r.currentStudy.mainLocationLon,""))},dependencies:[os,ea,Sc,Er],styles:[".container[_ngcontent-%COMP%]{width:auto;height:auto;margin-bottom:.5em}.container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1em}"]})}}return i})();class wL{constructor(t){this.collection=t}onAdd(t){const e=document.createElement("custom-button-el");return e.map=t,e.collection=this.collection,this._container=e,this._map=t,this._container}onRemove(){this._container&&(this._container.parentNode?.removeChild(this._container),this._map=void 0)}setStudiesVisibility(t){this._container&&(this._container.studiesVisible=t)}}function mb(i,t,e="studies",n=!0){const r=i.getSource(e);if(r)return console.log(r),void r.setData(n?t:{type:"FeatureCollection",features:[]});i.addSource(e,{type:"geojson",data:n?t:{type:"FeatureCollection",features:[]},cluster:!0,clusterMinPoints:2,clusterMaxZoom:10,clusterRadius:50}),i.addLayer({id:"clusters",type:"circle",source:e,filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",50,"#f1f075",100,"#f28cb1"],"circle-radius":["step",["get","point_count"],20,50,30,100,40]}}),i.addLayer({id:"cluster-count",type:"symbol",source:e,filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}}),i.addLayer({id:"unclustered-point",type:"circle",source:e,filter:["!",["has","point_count"]],paint:{"circle-color":"#11b4da","circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#fff"}})}function CL(i,t){1&i&&o.EFF(0," Disable Terrain ")}function T4(i,t){1&i&&o.EFF(0," Enable Terrain ")}function II(i,t){1&i&&o.EFF(0," Disable Labels ")}function EL(i,t){1&i&&o.EFF(0," Enable Labels ")}var Am=function(i){return i.StandardLabel="mapbox://styles/feliricki/cltqf12yx00p301p5dq5hcmiv",i.StandardNoLabel="mapbox://styles/feliricki/cltt2y3nr00kb01pb678qbtwo",i.SatelliteLabel="mapbox://styles/feliricki/cltqh2rpe031p01qee1x69a67",i.SatelliteNoLabel="mapbox://styles/feliricki/cltt4rrni00up01qjhe4t8yob",i.OutdoorsLabel="mapbox://styles/feliricki/cltqgt2be027701qpeui970ly",i.OutdoorsNoLabel="mapbox://styles/feliricki/cltt51mik00uw01qjfpnfcm6s",i}(Am||{});let TL=(()=>{class i{constructor(){this.standardLayers=[Am.StandardLabel,Am.StandardNoLabel],this.satelliteLayers=[Am.SatelliteLabel,Am.SatelliteNoLabel],this.outdoorsLayers=[Am.OutdoorsLabel,Am.OutdoorsNoLabel],this.labelledLayers=new Set([Am.StandardLabel,Am.OutdoorsLabel,Am.SatelliteLabel]),this.studiesVisible=!0,this.terrainEnabled=!1,this.labelEnabled=!0,this.currentLayerType="standard",this.currentMapStyle=Am.StandardLabel,this.initializedCallback=!1,this.togglingLabels=!1}initializeMapCallback(){this.initializedCallback||!this.map||(this.map.getSource("mapbox-dem")||this.map.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1"}),this.map.on("style.load",()=>{!this.map||!this.collection||(this.map.getSource("mapbox-dem")||this.map.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1"}),this.map.setTerrain(this.terrainEnabled?{source:"mapbox-dem",exaggeration:1}:null),this.map.getStyle().layers.forEach(e=>{"symbol"===e.type&&"cluster-count"!==e.id&&this.map?.setLayoutProperty(e.id,"visibility",this.labelEnabled?"visible":"none")}),mb(this.map,this.collection,"studies",this.studiesVisible))}),this.initializedCallback=!0)}toggleTerrain(){this.map&&(this.initializeMapCallback(),this.terrainEnabled=!this.terrainEnabled,this.map.getSource("mapbox-dem")||this.map.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1"}),this.map.setTerrain(this.terrainEnabled?{source:"mapbox-dem",exaggeration:1}:null))}toggleLabel(){!this.collection||!this.map||(this.initializeMapCallback(),this.labelEnabled=!this.labelEnabled,this.map.getStyle().layers.forEach(e=>{"symbol"===e.type&&"cluster-count"!==e.id&&this.map?.setLayoutProperty(e.id,"visibility",this.labelEnabled?"visible":"none")}))}selectLayer(e){if(!this.collection||!this.map)return;this.initializeMapCallback();let n=[];switch(e){case"standard":n=this.standardLayers;break;case"outdoors":n=this.outdoorsLayers;break;case"satellite":n=this.satelliteLayers}const r=n.filter(l=>this.labelledLayers.has(l)===this.labelEnabled).at(0);void 0!==r&&(this.currentMapStyle=r,this.currentLayerType=e,this.map.setStyle(this.currentMapStyle))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-custom-button"]],inputs:{map:"map",collection:"collection",studiesVisible:"studiesVisible"},standalone:!0,features:[o.aNF],decls:14,vars:2,consts:[["id","toggles",1,"mapboxgl-ctrl"],[3,"click"],["id","button-container",1,"mapboxgl-ctrl"]],template:function(n,r){1&n&&(o.j41(0,"div",0)(1,"button",1),o.bIt("click",function(){return r.toggleTerrain()}),o.DNE(2,CL,1,0)(3,T4,1,0),o.k0s(),o.j41(4,"button",1),o.bIt("click",function(){return r.toggleLabel()}),o.DNE(5,II,1,0)(6,EL,1,0),o.k0s()(),o.j41(7,"div",2)(8,"button",1),o.bIt("click",function(){return r.selectLayer("standard")}),o.EFF(9," Standard "),o.k0s(),o.j41(10,"button",1),o.bIt("click",function(){return r.selectLayer("outdoors")}),o.EFF(11," Outdoors "),o.k0s(),o.j41(12,"button",1),o.bIt("click",function(){return r.selectLayer("satellite")}),o.EFF(13," Satellite "),o.k0s()()),2&n&&(o.R7$(2),o.vxM(r.terrainEnabled?2:3),o.R7$(3),o.vxM(r.labelEnabled?5:6))},dependencies:[ea,Er],styles:["#toggles[_ngcontent-%COMP%]{display:flex;flex-direction:row}#toggles[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#000;background-color:#fff}#button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}#button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#000;background-color:#fff}"]})}}return i})(),SL=(()=>{class i{constructor(e){this.injector=e,this.title="Animal tracker";const n=xL(E4,{injector:this.injector});customElements.define("info-window-el",n);const r=xL(TL,{injector:this.injector});customElements.define("custom-button-el",r)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.zZn))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-root"]],standalone:!0,features:[o.aNF],decls:2,vars:0,template:function(n,r){1&n&&o.nrm(0,"app-nav-bar")(1,"router-outlet")},dependencies:[Tm,Ng],styles:["table[_ngcontent-%COMP%]{border:0px;border-spacing:0px;border-collapse:collapse}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #dddddd}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f4f4f4}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:left;padding:5px 10px}"]})}}return i})();var Wr=function(i){return i[i.State=0]="State",i[i.Transition=1]="Transition",i[i.Sequence=2]="Sequence",i[i.Group=3]="Group",i[i.Animate=4]="Animate",i[i.Keyframes=5]="Keyframes",i[i.Style=6]="Style",i[i.Trigger=7]="Trigger",i[i.Reference=8]="Reference",i[i.AnimateChild=9]="AnimateChild",i[i.AnimateRef=10]="AnimateRef",i[i.Query=11]="Query",i[i.Stagger=12]="Stagger",i}(Wr||{});const oh="*";function js(i,t){return{type:Wr.Trigger,name:i,definitions:t,options:{}}}function co(i,t=null){return{type:Wr.Animate,styles:t,timings:i}}function RI(i,t=null){return{type:Wr.Group,steps:i,options:t}}function gn(i){return{type:Wr.Style,styles:i,offset:null}}function Lo(i,t,e){return{type:Wr.State,name:i,styles:t,options:e}}function pb(i){return{type:Wr.Keyframes,steps:i}}function oo(i,t,e=null){return{type:Wr.Transition,expr:i,animation:t,options:e}}function OI(i=null){return{type:Wr.AnimateChild,options:i}}function s1(i,t,e=null){return{type:Wr.Query,selector:i,animation:t,options:e}}class a1{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class IL{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const l=this.players.length;0==l?queueMicrotask(()=>this._onFinish()):this.players.forEach(m=>{m.onDone(()=>{++e==l&&this._onFinish()}),m.onDestroy(()=>{++n==l&&this._onDestroy()}),m.onStart(()=>{++r==l&&this._onStart()})}),this.totalTime=this.players.reduce((m,C)=>Math.max(m,C.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,e/n.totalTime):1;n.setPosition(r)})}getPosition(){const t=this.players.reduce((e,n)=>null===e||n.totalTime>e.totalTime?n:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}function x_(i){return new o.wOt(3e3,!1)}function ah(i){switch(i.length){case 0:return new a1;case 1:return i[0];default:return new IL(i)}}function d1(i,t,e=new Map,n=new Map){const r=[],l=[];let m=-1,C=null;if(t.forEach(A=>{const O=A.get("offset"),z=O==m,$=z&&C||new Map;A.forEach((Q,te)=>{let de=te,fe=Q;if("offset"!==te)switch(de=i.normalizePropertyName(de,r),fe){case"!":fe=e.get(te);break;case oh:fe=n.get(te);break;default:fe=i.normalizeStyleValue(te,de,fe,r)}$.set(de,fe)}),z||l.push($),C=$,m=O}),r.length)throw function c1(){return new o.wOt(3502,!1)}();return l}function ZE(i,t,e,n){switch(t){case"start":i.onStart(()=>n(e&&KE(e,"start",i)));break;case"done":i.onDone(()=>n(e&&KE(e,"done",i)));break;case"destroy":i.onDestroy(()=>n(e&&KE(e,"destroy",i)))}}function KE(i,t,e){const l=QE(i.element,i.triggerName,i.fromState,i.toState,t||i.phaseName,e.totalTime??i.totalTime,!!e.disabled),m=i._data;return null!=m&&(l._data=m),l}function QE(i,t,e,n,r="",l=0,m){return{element:i,triggerName:t,fromState:e,toState:n,phaseName:r,totalTime:l,disabled:!!m}}function Mc(i,t,e){let n=i.get(t);return n||i.set(t,n=e),n}function JE(i){const t=i.indexOf(":");return[i.substring(1,t),i.slice(t+1)]}const UI=typeof document>"u"?null:document.documentElement;function x0(i){const t=i.parentNode||i.host||null;return t===UI?null:t}let vb=null,Ld=!1;function uA(i,t){for(;t;){if(t===i)return!0;t=x0(t)}return!1}function hA(i,t,e){if(e)return Array.from(i.querySelectorAll(t));const n=i.querySelector(t);return n?[n]:[]}let jI=(()=>{class i{validateStyleProperty(e){return function GL(i){vb||(vb=function dA(){return typeof document<"u"?document.body:null}()||{},Ld=!!vb.style&&"WebkitAppearance"in vb.style);let t=!0;return vb.style&&!function _b(i){return"ebkit"==i.substring(1,6)}(i)&&(t=i in vb.style,!t&&Ld&&(t="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in vb.style)),t}(e)}containsElement(e,n){return uA(e,n)}getParentElement(e){return x0(e)}query(e,n,r){return hA(e,n,r)}computeStyle(e,n,r){return r||""}animate(e,n,r,l,m,C=[],A){return new a1(r,l)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();class fA{static{this.NOOP=new jI}}class w0{}const pA=1e3,eT="ng-enter",Yp="ng-leave",C0="ng-trigger",E0=".ng-trigger",gA="ng-animating",tT=".ng-animating";function km(i){if("number"==typeof i)return i;const t=i.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:_A(parseFloat(t[1]),t[2])}function _A(i,t){return"s"===t?i*pA:i}function iT(i,t,e){return i.hasOwnProperty("duration")?i:function T0(i,t,e){let r,l=0,m="";if("string"==typeof i){const C=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===C)return t.push(x_()),{duration:0,delay:0,easing:""};r=_A(parseFloat(C[1]),C[2]);const A=C[3];null!=A&&(l=_A(parseFloat(A),C[4]));const O=C[5];O&&(m=O)}else r=i;if(!e){let C=!1,A=t.length;r<0&&(t.push(function FI(){return new o.wOt(3100,!1)}()),C=!0),l<0&&(t.push(function PL(){return new o.wOt(3101,!1)}()),C=!0),C&&t.splice(A,0,x_())}return{duration:r,delay:l,easing:m}}(i,t,e)}function Im(i,t,e){t.forEach((n,r)=>{const l=h1(r);e&&!e.has(r)&&e.set(r,i.style[l]),i.style[l]=n})}function yb(i,t){t.forEach((e,n)=>{const r=h1(n);i.style[r]=""})}function S0(i){return Array.isArray(i)?1==i.length?i[0]:function S4(i,t=null){return{type:Wr.Sequence,steps:i,options:t}}(i):i}const vA=new RegExp("{{\\s*(.+?)\\s*}}","g");function HL(i){let t=[];if("string"==typeof i){let e;for(;e=vA.exec(i);)t.push(e[1]);vA.lastIndex=0}return t}function u1(i,t,e){const n=`${i}`,r=n.replace(vA,(l,m)=>{let C=t[m];return null==C&&(e.push(function rA(){return new o.wOt(3003,!1)}()),C=""),C.toString()});return r==n?i:r}const bA=/-+([a-z0-9])/g;function h1(i){return i.replace(bA,(...t)=>t[1].toUpperCase())}function pu(i,t,e){switch(t.type){case Wr.Trigger:return i.visitTrigger(t,e);case Wr.State:return i.visitState(t,e);case Wr.Transition:return i.visitTransition(t,e);case Wr.Sequence:return i.visitSequence(t,e);case Wr.Group:return i.visitGroup(t,e);case Wr.Animate:return i.visitAnimate(t,e);case Wr.Keyframes:return i.visitKeyframes(t,e);case Wr.Style:return i.visitStyle(t,e);case Wr.Reference:return i.visitReference(t,e);case Wr.AnimateChild:return i.visitAnimateChild(t,e);case Wr.AnimateRef:return i.visitAnimateRef(t,e);case Wr.Query:return i.visitQuery(t,e);case Wr.Stagger:return i.visitStagger(t,e);default:throw function oA(){return new o.wOt(3004,!1)}()}}function yA(i,t){return window.getComputedStyle(i)[t]}const XL=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class XI extends w0{normalizePropertyName(t,e){return h1(t)}normalizeStyleValue(t,e,n,r){let l="";const m=n.toString().trim();if(XL.has(e)&&0!==n&&"0"!==n)if("number"==typeof n)l="px";else{const C=n.match(/^[+-]?[\d\.]+([a-z]*)$/);C&&0==C[1].length&&r.push(function OL(){return new o.wOt(3005,!1)}())}return m+l}}const nT="*";const f1=new Set(["true","1"]),Zh=new Set(["false","0"]);function YI(i,t){const e=f1.has(i)||Zh.has(i),n=f1.has(t)||Zh.has(t);return(r,l)=>{let m=i==nT||i==r,C=t==nT||t==l;return!m&&e&&"boolean"==typeof r&&(m=r?f1.has(i):Zh.has(i)),!C&&n&&"boolean"==typeof l&&(C=l?f1.has(t):Zh.has(t)),m&&C}}const ZL=new RegExp("s*:selfs*,?","g");function rT(i,t,e,n){return new m1(i).build(t,e,n)}class m1{constructor(t){this._driver=t}build(t,e,n){const r=new ZI(e);return this._resetContextStyleTimingState(r),pu(this,S0(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const l=[],m=[];return"@"==t.name.charAt(0)&&e.errors.push(function NI(){return new o.wOt(3006,!1)}()),t.definitions.forEach(C=>{if(this._resetContextStyleTimingState(e),C.type==Wr.State){const A=C,O=A.name;O.toString().split(/\s*,\s*/).forEach(z=>{A.name=z,l.push(this.visitState(A,e))}),A.name=O}else if(C.type==Wr.Transition){const A=this.visitTransition(C,e);n+=A.queryCount,r+=A.depCount,m.push(A)}else e.errors.push(function sA(){return new o.wOt(3007,!1)}())}),{type:Wr.Trigger,name:t.name,states:l,transitions:m,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const l=new Set,m=r||{};n.styles.forEach(C=>{C instanceof Map&&C.forEach(A=>{HL(A).forEach(O=>{m.hasOwnProperty(O)||l.add(O)})})}),l.size&&e.errors.push(function LL(){return new o.wOt(3008,!1)}(0,l.values()))}return{type:Wr.State,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=pu(this,S0(t.animation),e),r=function qL(i,t){const e=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function YL(i,t,e){if(":"==i[0]){const A=function qI(i,t){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,n)=>parseFloat(n)>parseFloat(e);case":decrement":return(e,n)=>parseFloat(n)<parseFloat(e);default:return t.push(function XE(){return new o.wOt(3016,!1)}()),"* => *"}}(i,e);if("function"==typeof A)return void t.push(A);i=A}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return e.push(function gb(){return new o.wOt(3015,!1)}()),t;const r=n[1],l=n[2],m=n[3];t.push(YI(r,m)),"<"==l[0]&&(r!=nT||m!=nT)&&t.push(YI(m,r))}(n,e,t)):e.push(i),e}(t.expr,e.errors);return{type:Wr.Transition,matchers:r,animation:n,queryCount:e.queryCount,depCount:e.depCount,options:lh(t.options)}}visitSequence(t,e){return{type:Wr.Sequence,steps:t.steps.map(n=>pu(this,n,e)),options:lh(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const l=t.steps.map(m=>{e.currentTime=n;const C=pu(this,m,e);return r=Math.max(r,e.currentTime),C});return e.currentTime=r,{type:Wr.Group,steps:l,options:lh(t.options)}}visitAnimate(t,e){const n=function EA(i,t){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return w_(iT(i,t).duration,0,"");const e=i;if(e.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=w_(0,0,"");return l.dynamic=!0,l.strValue=e,l}const r=iT(e,t);return w_(r.duration,r.delay,r.easing)}(t.timings,e.errors);e.currentAnimateTimings=n;let r,l=t.styles?t.styles:gn({});if(l.type==Wr.Keyframes)r=this.visitKeyframes(l,e);else{let m=t.styles,C=!1;if(!m){C=!0;const O={};n.easing&&(O.easing=n.easing),m=gn(O)}e.currentTime+=n.duration+n.delay;const A=this.visitStyle(m,e);A.isEmptyStep=C,r=A}return e.currentAnimateTimings=null,{type:Wr.Animate,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let C of r)"string"==typeof C?C===oh?n.push(C):e.errors.push(new o.wOt(3002,!1)):n.push(new Map(Object.entries(C)));let l=!1,m=null;return n.forEach(C=>{if(C instanceof Map&&(C.has("easing")&&(m=C.get("easing"),C.delete("easing")),!l))for(let A of C.values())if(A.toString().indexOf("{{")>=0){l=!0;break}}),{type:Wr.Style,styles:n,easing:m,offset:t.offset,containsDynamicStyles:l,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,l=e.currentTime;n&&l>0&&(l-=n.duration+n.delay),t.styles.forEach(m=>{"string"!=typeof m&&m.forEach((C,A)=>{const O=e.collectedStyles.get(e.currentQuerySelector),z=O.get(A);let $=!0;z&&(l!=r&&l>=z.startTime&&r<=z.endTime&&(e.errors.push(function FL(){return new o.wOt(3010,!1)}()),$=!1),l=z.startTime),$&&O.set(A,{startTime:l,endTime:r}),e.options&&function WI(i,t,e){const n=t.params||{},r=HL(i);r.length&&r.forEach(l=>{n.hasOwnProperty(l)||e.push(function R4(){return new o.wOt(3001,!1)}())})}(C,e.options,e.errors)})})}visitKeyframes(t,e){const n={type:Wr.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function NL(){return new o.wOt(3011,!1)}()),n;let l=0;const m=[];let C=!1,A=!1,O=0;const z=t.steps.map(Re=>{const qe=this._makeStyleAst(Re,e);let et=null!=qe.offset?qe.offset:function A0(i){if("string"==typeof i)return null;let t=null;if(Array.isArray(i))i.forEach(e=>{if(e instanceof Map&&e.has("offset")){const n=e;t=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const e=i;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(qe.styles),yt=0;return null!=et&&(l++,yt=qe.offset=et),A=A||yt<0||yt>1,C=C||yt<O,O=yt,m.push(yt),qe});A&&e.errors.push(function lA(){return new o.wOt(3012,!1)}()),C&&e.errors.push(function BL(){return new o.wOt(3200,!1)}());const $=t.steps.length;let Q=0;l>0&&l<$?e.errors.push(function Dm(){return new o.wOt(3202,!1)}()):0==l&&(Q=1/($-1));const te=$-1,de=e.currentTime,fe=e.currentAnimateTimings,ge=fe.duration;return z.forEach((Re,qe)=>{const et=Q>0?qe==te?1:Q*qe:m[qe],yt=et*ge;e.currentTime=de+fe.delay+yt,fe.duration=yt,this._validateStyleAst(Re,e),Re.offset=et,n.styles.push(Re)}),n}visitReference(t,e){return{type:Wr.Reference,animation:pu(this,S0(t.animation),e),options:lh(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:Wr.AnimateChild,options:lh(t.options)}}visitAnimateRef(t,e){return{type:Wr.AnimateRef,animation:this.visitReference(t.animation,e),options:lh(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[l,m]=function CA(i){const t=!!i.split(/\s*,\s*/).find(e=>":self"==e);return t&&(i=i.replace(ZL,"")),i=i.replace(/@\*/g,E0).replace(/@\w+/g,e=>E0+"-"+e.slice(1)).replace(/:animating/g,tT),[i,t]}(t.selector);e.currentQuerySelector=n.length?n+" "+l:l,Mc(e.collectedStyles,e.currentQuerySelector,new Map);const C=pu(this,S0(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:Wr.Query,selector:l,limit:r.limit||0,optional:!!r.optional,includeSelf:m,animation:C,originalSelector:t.selector,options:lh(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function l1(){return new o.wOt(3013,!1)}());const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:iT(t.timings,e.errors,!0);return{type:Wr.Stagger,animation:pu(this,S0(t.animation),e),timings:n,options:null}}}class ZI{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function lh(i){return i?(i={...i}).params&&(i.params=function M0(i){return i?{...i}:null}(i.params)):i={},i}function w_(i,t,e){return{duration:i,delay:t,easing:e}}function C_(i,t,e,n,r,l,m=null,C=!1){return{type:1,element:i,keyframes:t,preStyleProps:e,postStyleProps:n,duration:r,delay:l,totalTime:r+l,easing:m,subTimeline:C}}class Zp{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const I0=new RegExp(":enter","g"),P0=new RegExp(":leave","g");function oT(i,t,e,n,r,l=new Map,m=new Map,C,A,O=[]){return(new KI).buildKeyframes(i,t,e,n,r,l,m,C,A,O)}class KI{buildKeyframes(t,e,n,r,l,m,C,A,O,z=[]){O=O||new Zp;const $=new sT(t,e,O,r,l,z,[]);$.options=A;const Q=A.delay?km(A.delay):0;$.currentTimeline.delayNextStep(Q),$.currentTimeline.setStyles([m],null,$.errors,A),pu(this,n,$);const te=$.timelines.filter(de=>de.containsAnimation());if(te.length&&C.size){let de;for(let fe=te.length-1;fe>=0;fe--){const ge=te[fe];if(ge.element===e){de=ge;break}}de&&!de.allowOnlyTimelineStyles()&&de.setStyles([C],null,$.errors,A)}return te.length?te.map(de=>de.buildKeyframes()):[C_(e,[],[],[],0,Q,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.get(e.element);if(n){const r=e.createSubContext(t.options),l=e.currentTimeline.currentTime,m=this._visitSubInstructions(n,r,r.options);l!=m&&e.transformIntoNewTimeline(m)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,n),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,n){for(const r of t){const l=r?.delay;if(l){const m="number"==typeof l?l:km(u1(l,r?.params??{},e.errors));n.delayNextStep(m)}}}_visitSubInstructions(t,e,n){let l=e.currentTimeline.currentTime;const m=null!=n.duration?km(n.duration):null,C=null!=n.delay?km(n.delay):null;return 0!==m&&t.forEach(A=>{const O=e.appendInstructionToTimeline(A,m,C);l=Math.max(l,O.duration+O.delay)}),l}visitReference(t,e){e.updateOptions(t.options,!0),pu(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const l=t.options;if(l&&(l.params||l.delay)&&(r=e.createSubContext(l),r.transformIntoNewTimeline(),null!=l.delay)){r.previousNode.type==Wr.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=p1);const m=km(l.delay);r.delayNextStep(m)}t.steps.length&&(t.steps.forEach(m=>pu(this,m,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const l=t.options&&t.options.delay?km(t.options.delay):0;t.steps.forEach(m=>{const C=e.createSubContext(t.options);l&&C.delayNextStep(l),pu(this,m,C),r=Math.max(r,C.currentTimeline.currentTime),n.push(C.currentTimeline)}),n.forEach(m=>e.currentTimeline.mergeTimelineCollectedStyles(m)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return iT(e.params?u1(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const l=t.style;l.type==Wr.Keyframes?this.visitKeyframes(l,e):(e.incrementTime(n.duration),this.visitStyle(l,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();const l=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(l):n.setStyles(t.styles,l,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,l=n.duration,C=e.createSubContext().currentTimeline;C.easing=n.easing,t.styles.forEach(A=>{C.forwardTime((A.offset||0)*l),C.setStyles(A.styles,A.easing,e.errors,e.options),C.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(C),e.transformIntoNewTimeline(r+l),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},l=r.delay?km(r.delay):0;l&&(e.previousNode.type===Wr.Style||0==n&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=p1);let m=n;const C=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=C.length;let A=null;C.forEach((O,z)=>{e.currentQueryIndex=z;const $=e.createSubContext(t.options,O);l&&$.delayNextStep(l),O===e.element&&(A=$.currentTimeline),pu(this,t.animation,$),$.currentTimeline.applyStylesToKeyframe(),m=Math.max(m,$.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(m),A&&(e.currentTimeline.mergeTimelineCollectedStyles(A),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,l=t.timings,m=Math.abs(l.duration),C=m*(e.currentQueryTotal-1);let A=m*e.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":A=C-A;break;case"full":A=n.currentStaggerTime}const z=e.currentTimeline;A&&z.delayNextStep(A);const $=z.currentTime;pu(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-$+(r.startTime-n.currentTimeline.startTime)}}const p1={};class sT{constructor(t,e,n,r,l,m,C,A){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=l,this.errors=m,this.timelines=C,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=p1,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=A||new g1(this._driver,e,0),C.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=km(n.duration)),null!=n.delay&&(r.delay=km(n.delay));const l=n.params;if(l){let m=r.params;m||(m=this.options.params={}),Object.keys(l).forEach(C=>{(!e||!m.hasOwnProperty(C))&&(m[C]=u1(l[C],m,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(r=>{n[r]=e[r]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,l=new sT(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(t),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(t){return this.previousNode=p1,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:e??t.duration,delay:this.currentTimeline.currentTime+(n??0)+t.delay,easing:""},l=new QI(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(l),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,l,m){let C=[];if(r&&C.push(this.element),t.length>0){t=(t=t.replace(I0,"."+this._enterClassName)).replace(P0,"."+this._leaveClassName);let O=this._driver.query(this.element,t,1!=n);0!==n&&(O=n<0?O.slice(O.length+n,O.length):O.slice(0,n)),C.push(...O)}return!l&&0==C.length&&m.push(function Fa(){return new o.wOt(3014,!1)}()),C}}class g1{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new g1(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,n]of this._globalTimelineStyles)this._backFill.set(e,n||oh),this._currentKeyframe.set(e,oh);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&this._previousKeyframe.set("easing",e);const l=r&&r.params||{},m=function JI(i,t){const e=new Map;let n;return i.forEach(r=>{if("*"===r){n??=t.keys();for(let l of n)e.set(l,oh)}else for(let[l,m]of r)e.set(l,m)}),e}(t,this._globalTimelineStyles);for(let[C,A]of m){const O=u1(A,l,n);this._pendingStyles.set(C,O),this._localTimelineStyles.has(C)||this._backFill.set(C,this._globalTimelineStyles.get(C)??oh),this._updateStyle(C,O)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,n)=>{const r=this._styleSummary.get(n);(!r||e.time>r.time)&&this._updateStyle(n,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((C,A)=>{const O=new Map([...this._backFill,...C]);O.forEach((z,$)=>{"!"===z?t.add($):z===oh&&e.add($)}),n||O.set("offset",A/this.duration),r.push(O)});const l=[...t.values()],m=[...e.values()];if(n){const C=r[0],A=new Map(C);C.set("offset",0),A.set("offset",1),r=[C,A]}return C_(this.element,r,l,m,this.duration,this.startTime,this.easing,!1)}}class QI extends g1{constructor(t,e,n,r,l,m,C=!1){super(t,e,m.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=l,this._stretchStartingKeyframe=C,this.timings={duration:m.duration,delay:m.delay,easing:m.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const l=[],m=n+e,C=e/m,A=new Map(t[0]);A.set("offset",0),l.push(A);const O=new Map(t[0]);O.set("offset",TA(C)),l.push(O);const z=t.length-1;for(let $=1;$<=z;$++){let Q=new Map(t[$]);const te=Q.get("offset");Q.set("offset",TA((e+te*n)/m)),l.push(Q)}n=m,e=0,r="",t=l}return C_(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function TA(i,t=3){const e=Math.pow(10,t-1);return Math.round(i*e)/e}function SA(i,t,e,n,r,l,m,C,A,O,z,$,Q){return{type:0,element:i,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:l,toState:n,toStyles:m,timelines:C,queriedElements:A,preStyleProps:O,postStyleProps:z,totalTime:$,errors:Q}}const O0={};class Kp{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function KL(i,t,e,n,r){return i.some(l=>l(t,e,n,r))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){let r=this._stateStyles.get("*");return void 0!==t&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(e,n):new Map}build(t,e,n,r,l,m,C,A,O,z){const $=[],Q=this.ast.options&&this.ast.options.params||O0,de=this.buildStyles(n,C&&C.params||O0,$),fe=A&&A.params||O0,ge=this.buildStyles(r,fe,$),Re=new Set,qe=new Map,et=new Map,yt="void"===r,Jt={params:aT(fe,Q),delay:this.ast.options?.delay},fi=z?[]:oT(t,e,this.ast.animation,l,m,de,ge,Jt,O,$);let Hi=0;return fi.forEach(tn=>{Hi=Math.max(tn.duration+tn.delay,Hi)}),$.length?SA(e,this._triggerName,n,r,yt,de,ge,[],[],qe,et,Hi,$):(fi.forEach(tn=>{const cn=tn.element,_n=Mc(qe,cn,new Set);tn.preStyleProps.forEach(to=>_n.add(to));const Rr=Mc(et,cn,new Set);tn.postStyleProps.forEach(to=>Rr.add(to)),cn!==e&&Re.add(cn)}),SA(e,this._triggerName,n,r,yt,de,ge,fi,[...Re.values()],qe,et,Hi))}}function aT(i,t){const e={...t};return Object.entries(i).forEach(([n,r])=>{null!=r&&(e[n]=r)}),e}class xb{constructor(t,e,n){this.styles=t,this.defaultParams=e,this.normalizer=n}buildStyles(t,e){const n=new Map,r=aT(t,this.defaultParams);return this.styles.styles.forEach(l=>{"string"!=typeof l&&l.forEach((m,C)=>{m&&(m=u1(m,r,e));const A=this.normalizer.normalizePropertyName(C,e);m=this.normalizer.normalizeStyleValue(C,A,m,e),n.set(C,m)})}),n}}class QL{constructor(t,e,n){this.name=t,this.ast=e,this._normalizer=n,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new xb(r.style,r.options&&r.options.params||{},n))}),JL(this.states,"true","1"),JL(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new Kp(t,r,this.states))}),this.fallbackTransition=function AA(i,t){return new Kp(i,{type:Wr.Transition,animation:{type:Wr.Sequence,steps:[],options:null},matchers:[(m,C)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(m=>m.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function JL(i,t,e){i.has(t)?i.has(e)||i.set(e,i.get(t)):i.has(e)&&i.set(t,i.get(e))}const H4=new Zp;class eF{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const n=[],l=rT(this._driver,e,n,[]);if(n.length)throw function cA(){return new o.wOt(3503,!1)}();this._animations.set(t,l)}_buildPlayer(t,e,n){const r=t.element,l=d1(this._normalizer,t.keyframes,e,n);return this._driver.animate(r,l,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],l=this._animations.get(t);let m;const C=new Map;if(l?(m=oT(this._driver,e,l,eT,Yp,new Map,new Map,n,H4,r),m.forEach(z=>{const $=Mc(C,z.element,new Map);z.postStyleProps.forEach(Q=>$.set(Q,null))})):(r.push(function BI(){return new o.wOt(3300,!1)}()),m=[]),r.length)throw function VI(){return new o.wOt(3504,!1)}();C.forEach((z,$)=>{z.forEach((Q,te)=>{z.set(te,this._driver.computeStyle($,te,oh))})});const O=ah(m.map(z=>{const $=C.get(z.element);return this._buildPlayer(z,new Map,$)}));return this._playersById.set(t,O),O.onDestroy(()=>this.destroy(t)),this.players.push(O),O}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function zL(){return new o.wOt(3301,!1)}();return e}listen(t,e,n,r){const l=QE(e,"","","");return ZE(this._getPlayer(t),n,l,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const l=this._getPlayer(t);switch(n){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const e2="ng-animate-queued",DA="ng-animate-disabled",iF=[],kA={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},nF={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ch="__ng_removed";class lT{get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=function $4(i){return i??null}(n?t.value:t),n){const{value:l,...m}=t;this.options=m}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const e=t.params;if(e){const n=this.options.params;Object.keys(e).forEach(r=>{null==n[r]&&(n[r]=e[r])})}}}const Rm="void",IA=new lT(Rm);class rF{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,uh(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.has(e))throw function UL(){return new o.wOt(3302,!1)}();if(null==n||0==n.length)throw function Na(){return new o.wOt(3303,!1)}();if(!function PA(i){return"start"==i||"done"==i}(n))throw function zI(){return new o.wOt(3400,!1)}();const l=Mc(this._elementListeners,t,[]),m={name:e,phase:n,callback:r};l.push(m);const C=Mc(this._engine.statesByElement,t,new Map);return C.has(e)||(uh(t,C0),uh(t,C0+"-"+e),C.set(e,IA)),()=>{this._engine.afterFlush(()=>{const A=l.indexOf(m);A>=0&&l.splice(A,1),this._triggers.has(e)||C.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function jL(){return new o.wOt(3401,!1)}();return e}trigger(t,e,n,r=!0){const l=this._getTrigger(e),m=new RA(this.id,e,t);let C=this._engine.statesByElement.get(t);C||(uh(t,C0),uh(t,C0+"-"+e),this._engine.statesByElement.set(t,C=new Map));let A=C.get(e);const O=new lT(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&A&&O.absorbOptions(A.options),C.set(e,O),A||(A=IA),O.value!==Rm&&A.value===O.value){if(!function s2(i,t){const e=Object.keys(i),n=Object.keys(t);if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++){const l=e[r];if(!t.hasOwnProperty(l)||i[l]!==t[l])return!1}return!0}(A.params,O.params)){const fe=[],ge=l.matchStyles(A.value,A.params,fe),Re=l.matchStyles(O.value,O.params,fe);fe.length?this._engine.reportError(fe):this._engine.afterFlush(()=>{yb(t,ge),Im(t,Re)})}return}const Q=Mc(this._engine.playersByElement,t,[]);Q.forEach(fe=>{fe.namespaceId==this.id&&fe.triggerName==e&&fe.queued&&fe.destroy()});let te=l.matchTransition(A.value,O.value,t,O.params),de=!1;if(!te){if(!r)return;te=l.fallbackTransition,de=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:te,fromState:A,toState:O,player:m,isFallbackTransition:de}),de||(uh(t,e2),m.onStart(()=>{wb(t,e2)})),m.onDone(()=>{let fe=this.players.indexOf(m);fe>=0&&this.players.splice(fe,1);const ge=this._engine.playersByElement.get(t);if(ge){let Re=ge.indexOf(m);Re>=0&&ge.splice(Re,1)}}),this.players.push(m),Q.push(m),m}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(n=>n.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,E0,!0);n.forEach(r=>{if(r[ch])return;const l=this._engine.fetchNamespacesByElement(r);l.size?l.forEach(m=>m.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,n,r){const l=this._engine.statesByElement.get(t),m=new Map;if(l){const C=[];if(l.forEach((A,O)=>{if(m.set(O,A.value),this._triggers.has(O)){const z=this.trigger(t,O,Rm,r);z&&C.push(z)}}),C.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,m),n&&ah(C).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),n=this._engine.statesByElement.get(t);if(e&&n){const r=new Set;e.forEach(l=>{const m=l.name;if(r.has(m))return;r.add(m);const A=this._triggers.get(m).fallbackTransition,O=n.get(m)||IA,z=new lT(Rm),$=new RA(this.id,m,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:m,transition:A,fromState:O,toState:z,player:$,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const l=n.players.length?n.playersByQueriedElement.get(t):[];if(l&&l.length)r=!0;else{let m=t;for(;m=m.parentNode;)if(n.statesByElement.get(m)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{const l=t[ch];(!l||l===kA)&&(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){uh(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const l=n.element,m=this._elementListeners.get(l);m&&m.forEach(C=>{if(C.name==n.triggerName){const A=QE(l,n.triggerName,n.fromState.value,n.toState.value);A._data=t,ZE(n.player,C.phase,A,C.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((n,r)=>{const l=n.transition.ast.depCount,m=r.transition.ast.depCount;return 0==l||0==m?l-m:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}}class r2{_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,l)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(n=>{n.queued&&t.push(n)})}),t}createNamespace(t,e){const n=new rF(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let m=!1,C=this.driver.getParentElement(e);for(;C;){const A=r.get(C);if(A){const O=n.indexOf(A);n.splice(O+1,0,t),m=!0;break}C=this.driver.getParentElement(C)}m||n.unshift(t)}else n.push(t);return r.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(t);this.namespacesByHostElement.delete(n.hostElement);const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1),n.destroy(e),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n)for(let r of n.values())if(r.namespaceId){const l=this._fetchNamespace(r.namespaceId);l&&e.add(l)}return e}trigger(t,e,n,r){if(L0(e)){const l=this._fetchNamespace(t);if(l)return l.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!L0(e))return;const l=e[ch];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const m=this.collectedLeaveElements.indexOf(e);m>=0&&this.collectedLeaveElements.splice(m,1)}if(t){const m=this._fetchNamespace(t);m&&m.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),uh(t,DA)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),wb(t,DA))}removeNode(t,e,n){if(L0(e)){const r=t?this._fetchNamespace(t):null;r?r.removeNode(e,n):this.markElementAsRemoved(t,e,!1,n);const l=this.namespacesByHostElement.get(e);l&&l.id!==t&&l.removeNode(e,n)}else this._onRemovalComplete(e,n)}markElementAsRemoved(t,e,n,r,l){this.collectedLeaveElements.push(e),e[ch]={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:l}}listen(t,e,n,r,l){return L0(e)?this._fetchNamespace(t).listen(e,n,r,l):()=>{}}_buildInstruction(t,e,n,r,l){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,l)}destroyInnerAnimations(t){let e=this.driver.query(t,E0,!0);e.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,tT,!0),e.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return ah(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[ch];if(e&&e.setForRemoval){if(t[ch]=kA,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(DA)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)uh(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],e.length?ah(e).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(t){throw function Ba(){return new o.wOt(3402,!1)}()}_flushAnimations(t,e){const n=new Zp,r=[],l=new Map,m=[],C=new Map,A=new Map,O=new Map,z=new Set;this.disabledNodes.forEach(Fn=>{z.add(Fn);const ur=this.driver.query(Fn,".ng-animate-queued",!0);for(let Br=0;Br<ur.length;Br++)z.add(ur[Br])});const $=this.bodyNode,Q=Array.from(this.statesByElement.keys()),te=dh(Q,this.collectedEnterElements),de=new Map;let fe=0;te.forEach((Fn,ur)=>{const Br=eT+fe++;de.set(ur,Br),Fn.forEach(jo=>uh(jo,Br))});const ge=[],Re=new Set,qe=new Set;for(let Fn=0;Fn<this.collectedLeaveElements.length;Fn++){const ur=this.collectedLeaveElements[Fn],Br=ur[ch];Br&&Br.setForRemoval&&(ge.push(ur),Re.add(ur),Br.hasAnimation?this.driver.query(ur,".ng-star-inserted",!0).forEach(jo=>Re.add(jo)):qe.add(ur))}const et=new Map,yt=dh(Q,Array.from(Re));yt.forEach((Fn,ur)=>{const Br=Yp+fe++;et.set(ur,Br),Fn.forEach(jo=>uh(jo,Br))}),t.push(()=>{te.forEach((Fn,ur)=>{const Br=de.get(ur);Fn.forEach(jo=>wb(jo,Br))}),yt.forEach((Fn,ur)=>{const Br=et.get(ur);Fn.forEach(jo=>wb(jo,Br))}),ge.forEach(Fn=>{this.processLeaveNode(Fn)})});const Jt=[],fi=[];for(let Fn=this._namespaceList.length-1;Fn>=0;Fn--)this._namespaceList[Fn].drainQueuedTransitions(e).forEach(Br=>{const jo=Br.player,kc=Br.element;if(Jt.push(jo),this.collectedEnterElements.length){const Ud=kc[ch];if(Ud&&Ud.setForMove){if(Ud.previousTriggersValues&&Ud.previousTriggersValues.has(Br.triggerName)){const uC=Ud.previousTriggersValues.get(Br.triggerName),Vm=this.statesByElement.get(Br.element);if(Vm&&Vm.has(Br.triggerName)){const uL=Vm.get(Br.triggerName);uL.value=uC,Vm.set(Br.triggerName,uL)}}return void jo.destroy()}}const G_=!$||!this.driver.containsElement($,kc),ff=et.get(kc),Sx=de.get(kc),za=this._buildInstruction(Br,n,Sx,ff,G_);if(za.errors&&za.errors.length)return void fi.push(za);if(G_)return jo.onStart(()=>yb(kc,za.fromStyles)),jo.onDestroy(()=>Im(kc,za.toStyles)),void r.push(jo);if(Br.isFallbackTransition)return jo.onStart(()=>yb(kc,za.fromStyles)),jo.onDestroy(()=>Im(kc,za.toStyles)),void r.push(jo);const eX=[];za.timelines.forEach(Ud=>{Ud.stretchStartingKeyframe=!0,this.disabledNodes.has(Ud.element)||eX.push(Ud)}),za.timelines=eX,n.append(kc,za.timelines),m.push({instruction:za,player:jo,element:kc}),za.queriedElements.forEach(Ud=>Mc(C,Ud,[]).push(jo)),za.preStyleProps.forEach((Ud,uC)=>{if(Ud.size){let Vm=A.get(uC);Vm||A.set(uC,Vm=new Set),Ud.forEach((uL,_4)=>Vm.add(_4))}}),za.postStyleProps.forEach((Ud,uC)=>{let Vm=O.get(uC);Vm||O.set(uC,Vm=new Set),Ud.forEach((uL,_4)=>Vm.add(_4))})});if(fi.length){const Fn=[];fi.forEach(ur=>{Fn.push(function y0(){return new o.wOt(3505,!1)}())}),Jt.forEach(ur=>ur.destroy()),this.reportError(Fn)}const Hi=new Map,tn=new Map;m.forEach(Fn=>{const ur=Fn.element;n.has(ur)&&(tn.set(ur,ur),this._beforeAnimationBuild(Fn.player.namespaceId,Fn.instruction,Hi))}),r.forEach(Fn=>{const ur=Fn.element;this._getPreviousPlayers(ur,!1,Fn.namespaceId,Fn.triggerName,null).forEach(jo=>{Mc(Hi,ur,[]).push(jo),jo.destroy()})});const cn=ge.filter(Fn=>OA(Fn,A,O)),_n=new Map;dT(_n,this.driver,qe,O,oh).forEach(Fn=>{OA(Fn,A,O)&&cn.push(Fn)});const to=new Map;te.forEach((Fn,ur)=>{dT(to,this.driver,new Set(Fn),A,"!")}),cn.forEach(Fn=>{const ur=_n.get(Fn),Br=to.get(Fn);_n.set(Fn,new Map([...ur?.entries()??[],...Br?.entries()??[]]))});const Ts=[],ns=[],ph={};m.forEach(Fn=>{const{element:ur,player:Br,instruction:jo}=Fn;if(n.has(ur)){if(z.has(ur))return Br.onDestroy(()=>Im(ur,jo.toStyles)),Br.disabled=!0,Br.overrideTotalTime(jo.totalTime),void r.push(Br);let kc=ph;if(tn.size>1){let ff=ur;const Sx=[];for(;ff=ff.parentNode;){const za=tn.get(ff);if(za){kc=za;break}Sx.push(ff)}Sx.forEach(za=>tn.set(za,kc))}const G_=this._buildAnimation(Br.namespaceId,jo,Hi,l,to,_n);if(Br.setRealPlayer(G_),kc===ph)Ts.push(Br);else{const ff=this.playersByElement.get(kc);ff&&ff.length&&(Br.parentPlayer=ah(ff)),r.push(Br)}}else yb(ur,jo.fromStyles),Br.onDestroy(()=>Im(ur,jo.toStyles)),ns.push(Br),z.has(ur)&&r.push(Br)}),ns.forEach(Fn=>{const ur=l.get(Fn.element);if(ur&&ur.length){const Br=ah(ur);Fn.setRealPlayer(Br)}}),r.forEach(Fn=>{Fn.parentPlayer?Fn.syncPlayerEvents(Fn.parentPlayer):Fn.destroy()});for(let Fn=0;Fn<ge.length;Fn++){const ur=ge[Fn],Br=ur[ch];if(wb(ur,Yp),Br&&Br.hasAnimation)continue;let jo=[];if(C.size){let G_=C.get(ur);G_&&G_.length&&jo.push(...G_);let ff=this.driver.query(ur,tT,!0);for(let Sx=0;Sx<ff.length;Sx++){let za=C.get(ff[Sx]);za&&za.length&&jo.push(...za)}}const kc=jo.filter(G_=>!G_.destroyed);kc.length?Pm(this,ur,kc):this.processLeaveNode(ur)}return ge.length=0,Ts.forEach(Fn=>{this.players.push(Fn),Fn.onDone(()=>{Fn.destroy();const ur=this.players.indexOf(Fn);this.players.splice(ur,1)}),Fn.play()}),Ts}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,l){let m=[];if(e){const C=this.playersByQueriedElement.get(t);C&&(m=C)}else{const C=this.playersByElement.get(t);if(C){const A=!l||l==Rm;C.forEach(O=>{O.queued||!A&&O.triggerName!=r||m.push(O)})}}return(n||r)&&(m=m.filter(C=>!(n&&n!=C.namespaceId||r&&r!=C.triggerName))),m}_beforeAnimationBuild(t,e,n){const l=e.element,m=e.isRemovalTransition?void 0:t,C=e.isRemovalTransition?void 0:e.triggerName;for(const A of e.timelines){const O=A.element,z=O!==l,$=Mc(n,O,[]);this._getPreviousPlayers(O,z,m,C,e.toState).forEach(te=>{const de=te.getRealPlayer();de.beforeDestroy&&de.beforeDestroy(),te.destroy(),$.push(te)})}yb(l,e.fromStyles)}_buildAnimation(t,e,n,r,l,m){const C=e.triggerName,A=e.element,O=[],z=new Set,$=new Set,Q=e.timelines.map(de=>{const fe=de.element;z.add(fe);const ge=fe[ch];if(ge&&ge.removedBeforeQueried)return new a1(de.duration,de.delay);const Re=fe!==A,qe=function Kh(i){const t=[];return hh(i,t),t}((n.get(fe)||iF).map(Hi=>Hi.getRealPlayer())).filter(Hi=>!!Hi.element&&Hi.element===fe),et=l.get(fe),yt=m.get(fe),Jt=d1(this._normalizer,de.keyframes,et,yt),fi=this._buildPlayer(de,Jt,qe);if(de.subTimeline&&r&&$.add(fe),Re){const Hi=new RA(t,C,fe);Hi.setRealPlayer(fi),O.push(Hi)}return fi});O.forEach(de=>{Mc(this.playersByQueriedElement,de.element,[]).push(de),de.onDone(()=>function o2(i,t,e){let n=i.get(t);if(n){if(n.length){const r=n.indexOf(e);n.splice(r,1)}0==n.length&&i.delete(t)}return n}(this.playersByQueriedElement,de.element,de))}),z.forEach(de=>uh(de,gA));const te=ah(Q);return te.onDestroy(()=>{z.forEach(de=>wb(de,gA)),Im(A,e.toStyles)}),$.forEach(de=>{Mc(r,de,[]).push(te)}),te}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new a1(t.duration,t.delay)}}class RA{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new a1,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,n)=>{e.forEach(r=>ZE(t,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Mc(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function L0(i){return i&&1===i.nodeType}function cT(i,t){const e=i.style.display;return i.style.display=t??"none",e}function dT(i,t,e,n,r){const l=[];e.forEach(A=>l.push(cT(A)));const m=[];n.forEach((A,O)=>{const z=new Map;A.forEach($=>{const Q=t.computeStyle(O,$,r);z.set($,Q),(!Q||0==Q.length)&&(O[ch]=nF,m.push(O))}),i.set(O,z)});let C=0;return e.forEach(A=>cT(A,l[C++])),m}function dh(i,t){const e=new Map;if(i.forEach(C=>e.set(C,[])),0==t.length)return e;const r=new Set(t),l=new Map;function m(C){if(!C)return 1;let A=l.get(C);if(A)return A;const O=C.parentNode;return A=e.has(O)?O:r.has(O)?1:m(O),l.set(C,A),A}return t.forEach(C=>{const A=m(C);1!==A&&e.get(A).push(C)}),e}function uh(i,t){i.classList?.add(t)}function wb(i,t){i.classList?.remove(t)}function Pm(i,t,e){ah(e).onDone(()=>i.processLeaveNode(t))}function hh(i,t){for(let e=0;e<i.length;e++){const n=i[e];n instanceof IL?hh(n.players,t):t.push(n)}}function OA(i,t,e){const n=e.get(i);if(!n)return!1;let r=t.get(i);return r?n.forEach(l=>r.add(l)):t.set(i,n),e.delete(i),!0}class _1{constructor(t,e,n){this._driver=e,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,l)=>{},this._transitionEngine=new r2(t.body,e,n),this._timelineEngine=new eF(t.body,e,n),this._transitionEngine.onRemovalComplete=(r,l)=>this.onRemovalComplete(r,l)}registerTrigger(t,e,n,r,l){const m=t+"-"+r;let C=this._triggerCache[m];if(!C){const A=[],z=rT(this._driver,l,A,[]);if(A.length)throw function VL(){return new o.wOt(3404,!1)}();C=function MA(i,t,e){return new QL(i,t,e)}(r,z,this._normalizer),this._triggerCache[m]=C}this._transitionEngine.registerTrigger(e,r,C)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n){this._transitionEngine.removeNode(t,e,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[l,m]=JE(n);this._timelineEngine.command(l,e,m,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,l){if("@"==n.charAt(0)){const[m,C]=JE(n);return this._timelineEngine.listen(m,e,C,l)}return this._transitionEngine.listen(t,e,n,r,l)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}}class v1{static{this.initialStylesByElement=new WeakMap}constructor(t,e,n){this._element=t,this._startStyles=e,this._endStyles=n,this._state=0;let r=v1.initialStylesByElement.get(t);r||v1.initialStylesByElement.set(t,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&Im(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Im(this._element,this._initialStyles),this._endStyles&&(Im(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(v1.initialStylesByElement.delete(this._element),this._startStyles&&(yb(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(yb(this._element,this._endStyles),this._endStyles=null),Im(this._element,this._initialStyles),this._state=3)}}function LA(i){let t=null;return i.forEach((e,n)=>{(function FA(i){return"display"===i||"position"===i})(n)&&(t=t||new Map,t.set(n,e))}),t}class F0{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map;const e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(n=>{e.push(Object.fromEntries(n))}),e}_triggerWebAnimation(t,e,n){return t.animate(this._convertKeyframesToObject(e),n)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{"offset"!==r&&t.set(r,this._finished?n:yA(this.element,r))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(n=>n()),e.length=0}}class a2{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}containsElement(t,e){return uA(t,e)}getParentElement(t){return x0(t)}query(t,e,n){return hA(t,e,n)}computeStyle(t,e,n){return yA(t,e)}animate(t,e,n,r,l,m=[]){const A={duration:n,delay:r,fill:0==r?"both":"forwards"};l&&(A.easing=l);const O=new Map,z=m.filter(te=>te instanceof F0);(function $L(i,t){return 0===i||0===t})(n,r)&&z.forEach(te=>{te.currentSnapshot.forEach((de,fe)=>O.set(fe,de))});let $=function HI(i){return i.length?i[0]instanceof Map?i:i.map(t=>new Map(Object.entries(t))):[]}(e).map(te=>new Map(te));$=function WL(i,t,e){if(e.size&&t.length){let n=t[0],r=[];if(e.forEach((l,m)=>{n.has(m)||r.push(m),n.set(m,l)}),r.length)for(let l=1;l<t.length;l++){let m=t[l];r.forEach(C=>m.set(C,yA(i,C)))}}return t}(t,$,O);const Q=function oF(i,t){let e=null,n=null;return Array.isArray(t)&&t.length?(e=LA(t[0]),t.length>1&&(n=LA(t[t.length-1]))):t instanceof Map&&(e=LA(t)),e||n?new v1(i,e,n):null}(t,$);return new F0(t,$,A,Q)}}const NA="@.disabled";class BA{constructor(t,e,n,r){this.namespaceId=t,this.delegate=e,this.engine=n,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n,r=!0){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&e==NA?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class hT extends BA{constructor(t,e,n,r,l){super(e,n,r,l),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&e==NA?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.slice(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const r=function aF(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(t);let l=e.slice(1),m="";return"@"!=l.charAt(0)&&([l,m]=function l2(i){const t=i.indexOf(".");return[i.substring(0,t),i.slice(t+1)]}(l)),this.engine.listen(this.namespaceId,r,l,m,C=>{this.factory.scheduleListenerCallback(C._data||-1,n,C)})}return this.delegate.listen(t,e,n)}}class c2{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,e.onRemovalComplete=(r,l)=>{const m=l?.parentNode(r);m&&l.removeChild(m,r)}}createRenderer(t,e){const r=this.delegate.createRenderer(t,e);if(!t||!e?.data?.animation){const O=this._rendererCache;let z=O.get(r);return z||(z=new BA("",r,this.engine,()=>O.delete(r)),O.set(r,z)),z}const l=e.id,m=e.id+"-"+this._currentId;this._currentId++,this.engine.register(m,t);const C=O=>{Array.isArray(O)?O.forEach(C):this.engine.registerTrigger(l,m,t,O.name,O)};return e.data.animation.forEach(C),new hT(this,m,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){if(t>=0&&t<this._microtaskId)return void this._zone.run(()=>e(n));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(l=>{const[m,C]=l;m(C)}),this._animationCallbacksBuffer=[]})}),r.push([e,n])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}let lF=(()=>{class i extends _1{constructor(e,n,r){super(e,n,r)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn),o.KVO(fA),o.KVO(w0))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const d2=[{provide:w0,useFactory:function cF(){return new XI}},{provide:_1,useClass:lF},{provide:o._9s,useFactory:function dF(i,t,e){return new c2(i,t,e)},deps:[Ao,_1,o.SKi]}],uF=[{provide:fA,useFactory:()=>new a2},{provide:o.bc$,useValue:"BrowserAnimations"},...d2];function N0(i){var t,e,n,r=2;for(typeof Symbol<"u"&&(e=Symbol.asyncIterator,n=Symbol.iterator);r--;){if(e&&null!=(t=i[e]))return t.call(i);if(n&&null!=(t=i[n]))return new VA(t.call(i));e="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function VA(i){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var n=e.done;return Promise.resolve(e.value).then(function(r){return{value:r,done:n}})}return(VA=function(n){this.s=n,this.n=n.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(n){var r=this.s.return;return void 0===r?Promise.resolve({value:n,done:!0}):t(r.apply(this.s,arguments))},throw:function(n){var r=this.s.return;return void 0===r?Promise.reject(n):t(r.apply(this.s,arguments))}},new VA(i)}function zA(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}"function"==typeof SuppressedError&&SuppressedError;var u2=function i(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){if(t.constructor!==e.constructor)return!1;var n,r,l;if(Array.isArray(t)){if((n=t.length)!=e.length)return!1;for(r=n;0!=r--;)if(!i(t[r],e[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();if((n=(l=Object.keys(t)).length)!==Object.keys(e).length)return!1;for(r=n;0!=r--;)if(!Object.prototype.hasOwnProperty.call(e,l[r]))return!1;for(r=n;0!=r--;){var m=l[r];if(!i(t[m],e[m]))return!1}return!0}return t!=t&&e!=e},h2=zA(u2);const UA="__googleMapsScriptId";var B0=function(i){return i[i.INITIALIZED=0]="INITIALIZED",i[i.LOADING=1]="LOADING",i[i.SUCCESS=2]="SUCCESS",i[i.FAILURE=3]="FAILURE",i}(B0||{});class Cb{constructor({apiKey:t,authReferrerPolicy:e,channel:n,client:r,id:l=UA,language:m,libraries:C=[],mapIds:A,nonce:O,region:z,retries:$=3,url:Q="https://maps.googleapis.com/maps/api/js",version:te}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=t,this.authReferrerPolicy=e,this.channel=n,this.client=r,this.id=l||UA,this.language=m,this.libraries=C,this.mapIds=A,this.nonce=O,this.region=z,this.retries=$,this.url=Q,this.version=te,Cb.instance){if(!h2(this.options,Cb.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(Cb.instance.options)}`);return Cb.instance}Cb.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?B0.FAILURE:this.done?B0.SUCCESS:this.loading?B0.LOADING:B0.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let t=this.url;return t+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(t+=`&key=${this.apiKey}`),this.channel&&(t+=`&channel=${this.channel}`),this.client&&(t+=`&client=${this.client}`),this.libraries.length>0&&(t+=`&libraries=${this.libraries.join(",")}`),this.language&&(t+=`&language=${this.language}`),this.region&&(t+=`&region=${this.region}`),this.version&&(t+=`&v=${this.version}`),this.mapIds&&(t+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(t+=`&auth_referrer_policy=${this.authReferrerPolicy}`),t}deleteScript(){const t=document.getElementById(this.id);t&&t.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((t,e)=>{this.loadCallback(n=>{n?e(n.error):t(window.google)})})}importLibrary(t){return this.execute(),google.maps.importLibrary(t)}loadCallback(t){this.callbacks.push(t),this.execute()}setScript(){var t,e;if(document.getElementById(this.id))return void this.callback();const n={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(n).forEach(l=>!n[l]&&delete n[l]),null!==(e=null===(t=window?.google)||void 0===t?void 0:t.maps)&&void 0!==e&&e.importLibrary||(l=>{let m,C,A,O="The Google Maps JavaScript API",z="google",$="importLibrary",Q="__ib__",te=document,de=window;de=de[z]||(de[z]={});const fe=de.maps||(de.maps={}),ge=new Set,Re=new URLSearchParams,qe=()=>m||(m=new Promise((et,yt)=>function mF(i,t,e,n){return new(e||(e=Promise))(function(l,m){function C(z){try{O(n.next(z))}catch($){m($)}}function A(z){try{O(n.throw(z))}catch($){m($)}}function O(z){z.done?l(z.value):function r(l){return l instanceof e?l:new e(function(m){m(l)})}(z.value).then(C,A)}O((n=n.apply(i,t||[])).next())})}(this,void 0,void 0,function*(){var Jt;for(A in yield C=te.createElement("script"),C.id=this.id,Re.set("libraries",[...ge]+""),l)Re.set(A.replace(/[A-Z]/g,fi=>"_"+fi[0].toLowerCase()),l[A]);Re.set("callback",z+".maps."+Q),C.src=this.url+"?"+Re,fe[Q]=et,C.onerror=()=>m=yt(Error(O+" could not load.")),C.nonce=this.nonce||(null===(Jt=te.querySelector("script[nonce]"))||void 0===Jt?void 0:Jt.nonce)||"",te.head.append(C)})));fe[$]?console.warn(O+" only loads once. Ignoring:",l):fe[$]=(et,...yt)=>ge.add(et)&&qe().then(()=>fe[$](et,...yt))})(n);const r=this.libraries.map(l=>this.importLibrary(l));r.length||r.push(this.importLibrary("core")),Promise.all(r).then(()=>this.callback(),l=>{const m=new ErrorEvent("error",{error:l});this.loadErrorCallback(m)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(t){if(this.errors.push(t),this.errors.length<=this.retries){const e=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${e} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},e)}else this.onerrorEvent=t,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(t=>{t(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setScript())}}}var f2=It(362),V0=It.n(f2);const m2=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class p2{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,n]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const r=n>>4;if(1!==r)throw new Error(`Got v${r} data when expected v1.`);const l=m2[15&n];if(!l)throw new Error("Unrecognized array type.");const[m]=new Uint16Array(t,2,1),[C]=new Uint32Array(t,4,1);return new p2(C,m,l,t)}constructor(t,e=64,n=Float64Array,r){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const l=m2.indexOf(this.ArrayType),m=2*t*this.ArrayType.BYTES_PER_ELEMENT,C=t*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-C%8)%8;if(l<0)throw new Error(`Unexpected typed array class: ${n}.`);r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+A,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+m+C+A),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+A,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+l]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=e,n}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return jA(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:l,coords:m,nodeSize:C}=this,A=[0,l.length-1,0],O=[];for(;A.length;){const z=A.pop()||0,$=A.pop()||0,Q=A.pop()||0;if($-Q<=C){for(let ge=Q;ge<=$;ge++){const Re=m[2*ge],qe=m[2*ge+1];Re>=t&&Re<=n&&qe>=e&&qe<=r&&O.push(l[ge])}continue}const te=Q+$>>1,de=m[2*te],fe=m[2*te+1];de>=t&&de<=n&&fe>=e&&fe<=r&&O.push(l[te]),(0===z?t<=de:e<=fe)&&(A.push(Q),A.push(te-1),A.push(1-z)),(0===z?n>=de:r>=fe)&&(A.push(te+1),A.push($),A.push(1-z))}return O}within(t,e,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:l,nodeSize:m}=this,C=[0,r.length-1,0],A=[],O=n*n;for(;C.length;){const z=C.pop()||0,$=C.pop()||0,Q=C.pop()||0;if($-Q<=m){for(let ge=Q;ge<=$;ge++)g2(l[2*ge],l[2*ge+1],t,e)<=O&&A.push(r[ge]);continue}const te=Q+$>>1,de=l[2*te],fe=l[2*te+1];g2(de,fe,t,e)<=O&&A.push(r[te]),(0===z?t-n<=de:e-n<=fe)&&(C.push(Q),C.push(te-1),C.push(1-z)),(0===z?t+n>=de:e+n>=fe)&&(C.push(te+1),C.push($),C.push(1-z))}return A}}function jA(i,t,e,n,r,l){if(r-n<=e)return;const m=n+r>>1;GA(i,t,m,n,r,l),jA(i,t,e,n,m-1,1-l),jA(i,t,e,m+1,r,1-l)}function GA(i,t,e,n,r,l){for(;r>n;){if(r-n>600){const O=r-n+1,z=e-n+1,$=Math.log(O),Q=.5*Math.exp(2*$/3),te=.5*Math.sqrt($*Q*(O-Q)/O)*(z-O/2<0?-1:1);GA(i,t,e,Math.max(n,Math.floor(e-z*Q/O+te)),Math.min(r,Math.floor(e+(O-z)*Q/O+te)),l)}const m=t[2*e+l];let C=n,A=r;for(E_(i,t,n,e),t[2*r+l]>m&&E_(i,t,n,r);C<A;){for(E_(i,t,C,A),C++,A--;t[2*C+l]<m;)C++;for(;t[2*A+l]>m;)A--}t[2*n+l]===m?E_(i,t,n,A):(A++,E_(i,t,A,r)),A<=e&&(n=A+1),e<=A&&(r=A-1)}}function E_(i,t,e,n){HA(i,e,n),HA(t,2*e,2*n),HA(t,2*e+1,2*n+1)}function HA(i,t,e){const n=i[t];i[t]=i[e],i[e]=n}function g2(i,t,e,n){const r=i-e,l=t-n;return r*r+l*l}const $A={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:i=>i},_2=Math.fround||(i=>t=>(i[0]=+t,i[0]))(new Float32Array(1)),Qh=3,Qp=5,v2=6;class b2{constructor(t){this.options=Object.assign(Object.create($A),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:n,maxZoom:r}=this.options;e&&console.time("total time");const l=`prepare ${t.length} points`;e&&console.time(l),this.points=t;const m=[];for(let A=0;A<t.length;A++){const O=t[A];if(!O.geometry)continue;const[z,$]=O.geometry.coordinates,Q=_2(Eb(z)),te=_2(z0($));m.push(Q,te,1/0,A,-1,1),this.options.reduce&&m.push(0)}let C=this.trees[r+1]=this._createTree(m);e&&console.timeEnd(l);for(let A=r;A>=n;A--){const O=+Date.now();C=this.trees[A]=this._createTree(this._cluster(C,A)),e&&console.log("z%d: %d clusters in %dms",A,C.numItems,+Date.now()-O)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,t[1]));let l=180===t[2]?180:((t[2]+180)%360+360)%360-180;const m=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,l=180;else if(n>l){const $=this.getClusters([n,r,180,m],e),Q=this.getClusters([-180,r,l,m],e);return $.concat(Q)}const C=this.trees[this._limitZoom(e)],A=C.range(Eb(n),z0(m),Eb(l),z0(r)),O=C.data,z=[];for(const $ of A){const Q=this.stride*$;z.push(O[Q+Qp]>1?y2(O,Q,this.clusterProps):this.points[O[Q+Qh]])}return z}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),r="No cluster with the specified id.",l=this.trees[n];if(!l)throw new Error(r);const m=l.data;if(e*this.stride>=m.length)throw new Error(r);const C=this.options.radius/(this.options.extent*Math.pow(2,n-1)),z=l.within(m[e*this.stride],m[e*this.stride+1],C),$=[];for(const Q of z){const te=Q*this.stride;m[te+4]===t&&$.push(m[te+Qp]>1?y2(m,te,this.clusterProps):this.points[m[te+Qh]])}if(0===$.length)throw new Error(r);return $}getLeaves(t,e,n){const r=[];return this._appendLeaves(r,t,e=e||10,n=n||0,0),r}getTile(t,e,n){const r=this.trees[this._limitZoom(t)],l=Math.pow(2,t),{extent:m,radius:C}=this.options,A=C/m,O=(n-A)/l,z=(n+1+A)/l,$={features:[]};return this._addTileFeatures(r.range((e-A)/l,O,(e+1+A)/l,z),r.data,e,n,l,$),0===e&&this._addTileFeatures(r.range(1-A/l,O,1,z),r.data,l,n,l,$),e===l-1&&this._addTileFeatures(r.range(0,O,A/l,z),r.data,-1,n,l,$),$.features.length?$:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,r,l){const m=this.getChildren(e);for(const C of m){const A=C.properties;if(A&&A.cluster?l+A.point_count<=r?l+=A.point_count:l=this._appendLeaves(t,A.cluster_id,n,r,l):l<r?l++:t.push(C),t.length===n)break}return l}_createTree(t){const e=new p2(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<t.length;n+=this.stride)e.add(t[n],t[n+1]);return e.finish(),e.data=t,e}_addTileFeatures(t,e,n,r,l,m){for(const C of t){const A=C*this.stride,O=e[A+Qp]>1;let z,$,Q;if(O)z=y1(e,A,this.clusterProps),$=e[A],Q=e[A+1];else{const fe=this.points[e[A+Qh]];z=fe.properties;const[ge,Re]=fe.geometry.coordinates;$=Eb(ge),Q=z0(Re)}const te={type:1,geometry:[[Math.round(this.options.extent*($*l-n)),Math.round(this.options.extent*(Q*l-r))]],tags:z};let de;de=O||this.options.generateId?e[A+Qh]:this.points[e[A+Qh]].id,void 0!==de&&(te.id=de),m.features.push(te)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:n,extent:r,reduce:l,minPoints:m}=this.options,C=n/(r*Math.pow(2,e)),A=t.data,O=[],z=this.stride;for(let $=0;$<A.length;$+=z){if(A[$+2]<=e)continue;A[$+2]=e;const Q=A[$],te=A[$+1],de=t.within(A[$],A[$+1],C),fe=A[$+Qp];let ge=fe;for(const Re of de){const qe=Re*z;A[qe+2]>e&&(ge+=A[qe+Qp])}if(ge>fe&&ge>=m){let et,Re=Q*fe,qe=te*fe,yt=-1;const Jt=($/z<<5)+(e+1)+this.points.length;for(const fi of de){const Hi=fi*z;if(A[Hi+2]<=e)continue;A[Hi+2]=e;const tn=A[Hi+Qp];Re+=A[Hi]*tn,qe+=A[Hi+1]*tn,A[Hi+4]=Jt,l&&(et||(et=this._map(A,$,!0),yt=this.clusterProps.length,this.clusterProps.push(et)),l(et,this._map(A,Hi)))}A[$+4]=Jt,O.push(Re/ge,qe/ge,1/0,Jt,-1,ge),l&&O.push(yt)}else{for(let Re=0;Re<z;Re++)O.push(A[$+Re]);if(ge>1)for(const Re of de){const qe=Re*z;if(!(A[qe+2]<=e)){A[qe+2]=e;for(let et=0;et<z;et++)O.push(A[qe+et])}}}}return O}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,n){if(t[e+Qp]>1){const m=this.clusterProps[t[e+v2]];return n?Object.assign({},m):m}const r=this.points[t[e+Qh]].properties,l=this.options.map(r);return n&&l===r?Object.assign({},l):l}}function y2(i,t,e){return{type:"Feature",id:i[t+Qh],properties:y1(i,t,e),geometry:{type:"Point",coordinates:[x2(i[t]),pF(i[t+1])]}}}function y1(i,t,e){const n=i[t+Qp],r=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?Math.round(n/100)/10+"k":n,l=i[t+v2],m=-1===l?{}:Object.assign({},e[l]);return Object.assign(m,{cluster:!0,cluster_id:i[t+Qh],point_count:n,point_count_abbreviated:r})}function Eb(i){return i/360+.5}function z0(i){const t=Math.sin(i*Math.PI/180),e=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return e<0?0:e>1?1:e}function x2(i){return 360*(i-.5)}function pF(i){const t=(180-360*i)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}class qa{static isAdvancedMarkerAvailable(t){return google.maps.marker&&!0===t.getMapCapabilities().isAdvancedMarkersAvailable}static isAdvancedMarker(t){return google.maps.marker&&t instanceof google.maps.marker.AdvancedMarkerElement}static setMap(t,e){this.isAdvancedMarker(t)?t.map=e:t.setMap(e)}static getPosition(t){if(this.isAdvancedMarker(t)){if(t.position){if(t.position instanceof google.maps.LatLng)return t.position;if(t.position.lat&&t.position.lng)return new google.maps.LatLng(t.position.lat,t.position.lng)}return new google.maps.LatLng(null)}return t.getPosition()}static getVisible(t){return!!this.isAdvancedMarker(t)||t.getVisible()}}class T_{constructor({markers:t,position:e}){this.markers=t,e&&(this._position=e instanceof google.maps.LatLng?e:new google.maps.LatLng(e))}get bounds(){if(0===this.markers.length&&!this._position)return;const t=new google.maps.LatLngBounds(this._position,this._position);for(const e of this.markers)t.extend(qa.getPosition(e));return t}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(t=>qa.getVisible(t)).length}push(t){this.markers.push(t)}delete(){this.marker&&(qa.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class C2{constructor({maxZoom:t=16}){this.maxZoom=t}noop({markers:t}){return E2(t)}}const E2=i=>i.map(e=>new T_({position:qa.getPosition(e),markers:[e]}));class qA extends C2{constructor(t){var{maxZoom:e,radius:n=60}=t,r=function x1(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(null!=i&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(i);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(i,n[r])&&(e[n[r]]=i[n[r]])}return e}(t,["maxZoom","radius"]);super({maxZoom:e}),this.state={zoom:-1},this.superCluster=new b2(Object.assign({maxZoom:this.maxZoom,radius:n},r))}calculate(t){let e=!1;const n={zoom:t.map.getZoom()};if(!V0()(t.markers,this.markers)){e=!0,this.markers=[...t.markers];const r=this.markers.map(l=>{const m=qa.getPosition(l);return{type:"Feature",geometry:{type:"Point",coordinates:[m.lng(),m.lat()]},properties:{marker:l}}});this.superCluster.load(r)}return e||(this.state.zoom<=this.maxZoom||n.zoom<=this.maxZoom)&&(e=!V0()(this.state,n)),this.state=n,e&&(this.clusters=this.cluster(t)),{clusters:this.clusters,changed:e}}cluster({map:t}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(t.getZoom())).map(e=>this.transformCluster(e))}transformCluster({geometry:{coordinates:[t,e]},properties:n}){if(n.cluster)return new T_({markers:this.superCluster.getLeaves(n.cluster_id,1/0).map(l=>l.properties.marker),position:{lat:e,lng:t}});const r=n.marker;return new T_({markers:[r],position:qa.getPosition(r)})}}class _F{constructor(t,e){this.markers={sum:t.length};const n=e.map(l=>l.count),r=n.reduce((l,m)=>l+m,0);this.clusters={count:e.length,markers:{mean:r/e.length,sum:r,min:Math.min(...n),max:Math.max(...n)}}}}class j0{render({count:t,position:e},n,r){const m=`<svg fill="${t>Math.max(10,n.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">\n<circle cx="120" cy="120" opacity=".6" r="70" />\n<circle cx="120" cy="120" opacity=".3" r="90" />\n<circle cx="120" cy="120" opacity=".2" r="110" />\n<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${t}</text>\n</svg>`,C=`Cluster of ${t} markers`,A=Number(google.maps.Marker.MAX_ZINDEX)+t;if(qa.isAdvancedMarkerAvailable(r)){const $=(new DOMParser).parseFromString(m,"image/svg+xml").documentElement;return $.setAttribute("transform","translate(0 25)"),new google.maps.marker.AdvancedMarkerElement({map:r,position:e,zIndex:A,title:C,content:$})}const O={position:e,zIndex:A,title:C,icon:{url:`data:image/svg+xml;base64,${btoa(m)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(O)}}class G0{constructor(){!function vF(i,t){for(let e in t.prototype)i.prototype[e]=t.prototype[e]}(G0,google.maps.OverlayView)}}var Tb=function(i){return i.CLUSTERING_BEGIN="clusteringbegin",i.CLUSTERING_END="clusteringend",i.CLUSTER_CLICK="click",i}(Tb||{});const Fd=(i,t,e)=>{e.fitBounds(t.bounds)};class YA extends G0{constructor({map:t,markers:e=[],algorithmOptions:n={},algorithm:r=new qA(n),renderer:l=new j0,onClusterClick:m=Fd}){super(),this.markers=[...e],this.clusters=[],this.algorithm=r,this.renderer=l,this.onClusterClick=m,t&&this.setMap(t)}addMarker(t,e){this.markers.includes(t)||(this.markers.push(t),e||this.render())}addMarkers(t,e){t.forEach(n=>{this.addMarker(n,!0)}),e||this.render()}removeMarker(t,e){const n=this.markers.indexOf(t);return-1!==n&&(qa.setMap(t,null),this.markers.splice(n,1),e||this.render(),!0)}removeMarkers(t,e){let n=!1;return t.forEach(r=>{n=this.removeMarker(r,!0)||n}),n&&!e&&this.render(),n}clearMarkers(t){this.markers.length=0,t||this.render()}render(){const t=this.getMap();if(t instanceof google.maps.Map&&t.getProjection()){google.maps.event.trigger(this,Tb.CLUSTERING_BEGIN,this);const{clusters:e,changed:n}=this.algorithm.calculate({markers:this.markers,map:t,mapCanvasProjection:this.getProjection()});if(n||null==n){const r=new Set;for(const m of e)1==m.markers.length&&r.add(m.markers[0]);const l=[];for(const m of this.clusters)null!=m.marker&&(1==m.markers.length?r.has(m.marker)||qa.setMap(m.marker,null):l.push(m.marker));this.clusters=e,this.renderClusters(),requestAnimationFrame(()=>l.forEach(m=>qa.setMap(m,null)))}google.maps.event.trigger(this,Tb.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(t=>qa.setMap(t,null)),this.clusters.forEach(t=>t.delete()),this.clusters=[]}renderClusters(){const t=new _F(this.markers,this.clusters),e=this.getMap();this.clusters.forEach(n=>{1===n.markers.length?n.marker=n.markers[0]:(n.marker=this.renderer.render(n,t,e),n.markers.forEach(r=>qa.setMap(r,null)),this.onClusterClick&&n.marker.addListener("click",r=>{google.maps.event.trigger(this,Tb.CLUSTER_CLICK,n),this.onClusterClick(r,n,e)})),qa.setMap(n.marker,e)})}}class ZA{render({count:t,position:e},n,r){const l=`Cluster of ${t} markers`,m=Number(google.maps.Marker.MAX_ZINDEX)+t,C=document.createElement("div");if(C.style.fontSize="15px",C.innerText=`${t}`,qa.isAdvancedMarkerAvailable(r)){const O=document.createElement("div");O.style.position="relative",O.style.textAlign="center";const z=document.createElement("img");z.src="../../assets/location-pin-noglyph-smaller.png";const $=document.createElement("span");return $.style.position="absolute",$.style.fontSize="15px",$.style.top="50%",$.style.left="50%",$.style.transform="translate(-50%, -90%)",$.innerText=`${t}`,$.style.color="white",O.appendChild(z),O.appendChild($),new google.maps.marker.AdvancedMarkerElement({map:r,position:e,zIndex:m,title:l,content:O})}return new google.maps.Marker({position:e,zIndex:m,title:l})}}function C1(i){return(C1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(i)}function ye(i,t,e){return(t=function T1(i){var t=function E1(i,t){if("object"!=C1(i)||!i)return i;var e=i[Symbol.toPrimitive];if(void 0!==e){var n=e.call(i,t||"default");if("object"!=C1(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(i)}(i,"string");return"symbol"==C1(t)?t:t+""}(t))in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function T2(i){if(typeof window<"u"&&"object"==typeof window.process&&"renderer"===window.process.type||typeof process<"u"&&"object"==typeof process.versions&&process.versions.electron)return!0;const t="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,e=i||t;return!!(e&&e.indexOf("Electron")>=0)}function Jh(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||T2()}const S2=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Jh();class M2{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";ye(this,"storage",void 0),ye(this,"id",void 0),ye(this,"config",void 0),this.storage=function bF(i){try{const t=window[i],e="__storage_test__";return t.setItem(e,e),t.removeItem(e),t}catch{return null}}(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function KA(i,t,e){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=i.src.replace(/\(/g,"%28").replace(/\)/g,"%29");i.width>n&&(e=Math.min(e,n/i.width));const l=i.width*e,m=i.height*e,C=["font-size:1px;","padding:".concat(Math.floor(m/2),"px ").concat(Math.floor(l/2),"px;"),"line-height:".concat(m,"px;"),"background:url(".concat(r,");"),"background-size:".concat(l,"px ").concat(m,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),C]}let QA;var i;function xF(i){return"string"==typeof i?QA[i.toUpperCase()]||QA.WHITE:i}function S1(i,t){if(!i)throw new Error(t||"Assertion failed")}(i=QA||(QA={}))[i.BLACK=30]="BLACK",i[i.RED=31]="RED",i[i.GREEN=32]="GREEN",i[i.YELLOW=33]="YELLOW",i[i.BLUE=34]="BLUE",i[i.MAGENTA=35]="MAGENTA",i[i.CYAN=36]="CYAN",i[i.WHITE=37]="WHITE",i[i.BRIGHT_BLACK=90]="BRIGHT_BLACK",i[i.BRIGHT_RED=91]="BRIGHT_RED",i[i.BRIGHT_GREEN=92]="BRIGHT_GREEN",i[i.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",i[i.BRIGHT_BLUE=94]="BRIGHT_BLUE",i[i.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",i[i.BRIGHT_CYAN=96]="BRIGHT_CYAN",i[i.BRIGHT_WHITE=97]="BRIGHT_WHITE";const ef={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:"object"==typeof process&&process},M1=ef.window||ef.self||ef.global,A1=ef.process||{};function H0(){let i;var t,e;if(Jh&&"performance"in M1)i=null==M1||null===(t=M1.performance)||void 0===t||null===(e=t.now)||void 0===e?void 0:e.call(t);else if("hrtime"in A1){var n;const r=null==A1||null===(n=A1.hrtime)||void 0===n?void 0:n.call(A1);i=1e3*r[0]+r[1]/1e6}else i=Date.now();return i}const $0={debug:Jh&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},oU={enabled:!0,level:0};function fh(){}const JA={},I2={once:!0};class D1{constructor(){let{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};ye(this,"id",void 0),ye(this,"VERSION",S2),ye(this,"_startTs",H0()),ye(this,"_deltaTs",H0()),ye(this,"_storage",void 0),ye(this,"userData",{}),ye(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this.userData={},this._storage=new M2("__probe-".concat(this.id,"__"),oU),this.timeStamp("".concat(this.id," started")),function tU(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const e=Object.getPrototypeOf(i),n=Object.getOwnPropertyNames(e);for(const r of n)"function"==typeof i[r]&&(t.find(l=>r===l)||(i[r]=i[r].bind(i)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((H0()-this._startTs).toPrecision(10))}getDelta(){return Number((H0()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){return this._storage.setConfiguration({enabled:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){S1(t,e)}warn(t){return this._getLogFunction(0,t,$0.warn,arguments,I2)}error(t){return this._getLogFunction(0,t,$0.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,$0.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,$0.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),l=2;l<n;l++)r[l-2]=arguments[l];return this._getLogFunction(t,e,$0.debug||$0.info,arguments,I2)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||fh,n&&[n],{tag:L2(e)}):fh}image(t){let{logLevel:e,priority:n,image:r,message:l="",scale:m=1}=t;return this._shouldLog(e||n)?Jh?function wF(i){let{image:t,message:e="",scale:n=1}=i;if("string"==typeof t){const l=new Image;return l.onload=()=>{const m=KA(l,e,n);console.log(...m)},l.src=t,fh}const r=t.nodeName||"";if("img"===r.toLowerCase())return console.log(...KA(t,e,n)),fh;if("canvas"===r.toLowerCase()){const l=new Image;return l.onload=()=>console.log(...KA(l,e,n)),l.src=t.toDataURL(),fh}return fh}({image:r,message:l,scale:m}):function O2(i){let{message:e="",scale:n=1}=i;return console.warn("removed"),fh}({image:r,message:l,scale:m}):fh}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||fh)}group(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const r=R2({logLevel:t,message:e,opts:n}),{collapsed:l}=n;return r.method=(l?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(t,e){return this.group(t,e,Object.assign({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||fh)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=W0(t)}_getLogFunction(t,e,n,r,l){if(this._shouldLog(t)){l=R2({logLevel:t,message:e,args:r,opts:l}),S1(n=n||l.method),l.total=this.getTotal(),l.delta=this.getDelta(),this._deltaTs=H0();const m=l.tag||l.message;if(l.once){if(JA[m])return fh;JA[m]=H0()}return e=function P2(i,t,e){if("string"==typeof t){const n=e.time?function D2(i){const e=Math.max((arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-i.length,0);return"".concat(" ".repeat(e)).concat(i)}(function A2(i){let t;return t=i<10?"".concat(i.toFixed(2),"ms"):i<100?"".concat(i.toFixed(1),"ms"):i<1e3?"".concat(i.toFixed(0),"ms"):"".concat((i/1e3).toFixed(2),"s"),t}(e.total)):"";t=function eU(i,t,e){return!Jh&&"string"==typeof i&&(t&&(t=xF(t),i="\x1b[".concat(t,"m").concat(i,"\x1b[39m")),e&&(t=xF(e),i="\x1b[".concat(e+10,"m").concat(i,"\x1b[49m"))),i}(t=e.time?"".concat(i,": ").concat(n,"  ").concat(t):"".concat(i,": ").concat(t),e.color,e.background)}return t}(this.id,l.message,l),n.bind(console,e,...l.args)}return fh}}function W0(i){if(!i)return 0;let t;switch(typeof i){case"number":t=i;break;case"object":t=i.logLevel||i.priority||0;break;default:return 0}return S1(Number.isFinite(t)&&t>=0),t}function R2(i){const{logLevel:t,message:e}=i;i.logLevel=W0(t);const n=i.args?Array.from(i.args):[];for(;n.length&&n.shift()!==e;);switch(typeof t){case"string":case"function":void 0!==e&&n.unshift(e),i.message=t;break;case"object":Object.assign(i,t)}"function"==typeof i.message&&(i.message=i.message());const r=typeof i.message;return S1("string"===r||"object"===r),Object.assign(i,{args:n},i.opts)}function L2(i){for(const t in i)for(const e in i[t])return e||"untitled";return"empty"}ye(D1,"VERSION",S2);const lr=new D1({id:"luma.gl"});function rc(i,t){if(!i)throw new Error(t||"luma.gl: assertion failed.")}const F2="Requires WebGL2";function vT(i){return typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||!(!i||!Number.isFinite(i._version))}function go(i){return typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||!(!i||2!==i._version)}function X0(i){return rc(vT(i),"Invalid WebGLRenderingContext"),i}function Ac(i){return rc(go(i),F2),i}const q0={};const k1=function i(t){const e=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(let n=0;n<this.attribs.length;n++){const r=new i.VertexAttrib(e);this.attribs[n]=r}this.maxAttrib=0};(k1.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Sb=function(t){const e=this;this.gl=t,function DF(i){const t=i.getError;i.getError=function(){let n;do{n=t.apply(i),0!==n&&(q0[n]=!0)}while(0!==n);for(n in q0)if(q0[n])return delete q0[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(l){return l===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(l){const m=e.currentVertexArrayObject;return m.maxAttrib=Math.max(m.maxAttrib,l),m.attribs[l].enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(l){const m=e.currentVertexArrayObject;return m.maxAttrib=Math.max(m.maxAttrib,l),m.attribs[l].enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(l,m){switch(l){case 34962:e.currentArrayBuffer=m;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=m}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(l,m){const A=e.currentVertexArrayObject.attribs[l];switch(m){case 34975:return A.buffer;case 34338:return A.enabled;case 34339:return A.size;case 34340:return A.stride;case 34341:return A.type;case 34922:return A.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(l,m,C,A,O,z){const $=e.currentVertexArrayObject;$.maxAttrib=Math.max($.maxAttrib,l);const Q=$.attribs[l];return Q.buffer=e.currentArrayBuffer,Q.size=m,Q.type=C,Q.normalized=A,Q.stride=O,Q.offset=z,Q.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",()=>{(function MF(i){globalThis.console&&globalThis.console.log&&globalThis.console.log(i)})("OESVertexArrayObject emulation library context restored"),e.reset_()},!0),this.reset_()};Sb.prototype.VERTEX_ARRAY_BINDING_OES=34229,Sb.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let n=0;n<this.vertexArrayObjects.length;++n)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new k1(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Sb.prototype.createVertexArrayOES=function(){const t=new k1(this);return this.vertexArrayObjects.push(t),t},Sb.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},Sb.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof k1&&t.hasBeenBound&&t.ext===this)},Sb.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return void function AF(i,t){q0[i]=!0,void 0!==t&&function SF(i){globalThis.console&&globalThis.console.error&&globalThis.console.error(i)}(t)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const n=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const l=this.currentVertexArrayObject;if(r===l)return;(!r||l.elementArrayBuffer!==r.elementArrayBuffer)&&n.bindBuffer.call(e,34963,l.elementArrayBuffer);let m=this.currentArrayBuffer;const C=Math.max(r?r.maxAttrib:0,l.maxAttrib);for(let A=0;A<=C;A++){const O=l.attribs[A],z=r?r.attribs[A]:null;if((!r||O.enabled!==z.enabled)&&(O.enabled?n.enableVertexAttribArray.call(e,A):n.disableVertexAttribArray.call(e,A)),O.enabled){let $=!1;(!r||O.buffer!==z.buffer)&&(m!==O.buffer&&(n.bindBuffer.call(e,34962,O.buffer),m=O.buffer),$=!0),($||O.cached!==z.cached)&&n.vertexAttribPointer.call(e,A,O.size,O.type,O.normalized,O.stride,O.offset)}}this.currentArrayBuffer!==m&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)};const N2="OES_element_index",eD="WEBGL_draw_buffers",tD="WEBGL_debug_renderer_info",PF=35723,V2=36795,z2=34047,iD=37445,nD=37446,Gs=i=>go(i)?void 0:0,rD={3074:i=>go(i)?void 0:36064,[PF]:i=>go(i)?void 0:4352,35977:Gs,32937:Gs,[V2]:(i,t)=>{const e=go(i)?i.getExtension("EXT_disjoint_timer_query_webgl2"):i.getExtension("EXT_disjoint_timer_query");return e&&e.GPU_DISJOINT_EXT?t(e.GPU_DISJOINT_EXT):0},[iD]:(i,t)=>{const e=i.getExtension(tD);return t(e&&e.UNMASKED_VENDOR_WEBGL||7936)},[nD]:(i,t)=>{const e=i.getExtension(tD);return t(e&&e.UNMASKED_RENDERER_WEBGL||7937)},[z2]:(i,t)=>{const e=i.luma.extensions.EXT_texture_filter_anisotropic;return e?t(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Gs,35071:Gs,37447:Gs,36063:(i,t)=>{if(!go(i)){const e=i.getExtension(eD);return e?t(e.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Gs,35374:Gs,35377:Gs,34852:i=>{if(!go(i)){const t=i.getExtension(eD);return t?t.MAX_DRAW_BUFFERS_WEBGL:0}},36203:i=>i.getExtension(N2)?2147483647:65535,33001:i=>i.getExtension(N2)?16777216:65535,33e3:i=>16777216,37157:Gs,35373:Gs,35657:Gs,36183:Gs,37137:Gs,34045:Gs,35978:Gs,35979:Gs,35968:Gs,35376:Gs,35375:Gs,35659:Gs,37154:Gs,35371:Gs,35658:Gs,35076:Gs,35077:Gs,35380:Gs},j2="OES_vertex_array_object",LF="ANGLE_instanced_arrays",G2="WEBGL_draw_buffers",FF="EXT_disjoint_timer_query",oD={[j2]:{meta:{suffix:"OES"},createVertexArray:()=>{rc(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[LF]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(i,t){rc(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[G2]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{rc(!1)}},[FF]:{meta:{suffix:"EXT"},createQuery:()=>{rc(!1)},deleteQuery:()=>{rc(!1)},beginQuery:()=>{rc(!1)},endQuery:()=>{},getQuery(i,t){return this.getQueryObject(i,t)},getQueryParameter(i,t){return this.getQueryObject(i,t)},getQueryObject:()=>{}}},I1={readBuffer:(i,t,e)=>{go(i)&&t(e)},getVertexAttrib:(i,t,e,n)=>{const{webgl2:r,ext:l}=function NF(i,t){return{webgl2:go(i),ext:i.getExtension(t)}}(i,LF);let m;switch(n){case 35069:m=!!r&&void 0;break;case 35070:m=r||l?void 0:0}return void 0!==m?m:t(e,n)},getProgramParameter:(i,t,e,n)=>{if(!go(i))switch(n){case 35967:return 35981;case 35971:case 35382:return 0}return t(e,n)},getInternalformatParameter:(i,t,e,n,r)=>go(i)||32937!==r?i.getInternalformatParameter(e,n,r):new Int32Array([0]),getTexParameter(i,t,e,n){if(34046===n){const{extensions:r}=i.luma,l=r.EXT_texture_filter_anisotropic;n=l&&l.TEXTURE_MAX_ANISOTROPY_EXT||34046}return t(e,n)},getParameter:function U2(i,t,e){const n=rD[e],r="function"==typeof n?n(i,t,e):n;return void 0!==r?r:t(e)},hint:(i,t,e,n)=>t(e,n)};function Z2(i,t){let{extension:e,target:n,target2:r}=t;const l=oD[e];rc(l);const{meta:m={}}=l,{suffix:C=""}=m,A=i.getExtension(e);for(const O of Object.keys(l)){const z="".concat(O).concat(C);let $=null;"meta"===O||"function"==typeof i[O]||(A&&"function"==typeof A[z]?$=function(){return A[z](...arguments)}:"function"==typeof l[O]&&($=l[O].bind(n))),$&&(n[O]=$,r[O]=$)}}globalThis.polyfillContext=function W2(i){i.luma=i.luma||{};const{luma:t}=i;return t.polyfilled||(function kF(i){if("function"==typeof i.createVertexArray)return;const t=i.getSupportedExtensions;i.getSupportedExtensions=function(){const r=t.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const e=i.getExtension;i.getExtension=function(r){return e.call(this,r)||("OES_vertex_array_object"!==r?null:(i.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Sb(this)),this.__OESVertexArrayObject))}}(i),function X2(i){i.luma.extensions={};const t=i.getSupportedExtensions()||[];for(const e of t)i.luma[e]=i.getExtension(e)}(i),function Y2(i,t){for(const e of Object.getOwnPropertyNames(t))"overrides"!==e&&Z2(i,{extension:e,target:i.luma,target2:i})}(i,oD),function q2(i,t){let{target:e,target2:n}=t;Object.keys(I1).forEach(r=>{if("function"==typeof I1[r]){const l=i[r]?i[r].bind(i):()=>{},m=I1[r].bind(null,i,l);e[r]=m,n[r]=m}})}(i,{target:t,target2:i}),t.polyfilled=!0),i};const bT={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},eg=(i,t,e)=>t?i.enable(e):i.disable(e),sD=(i,t,e)=>i.hint(e,t),Nd=(i,t,e)=>i.pixelStorei(e,t);function Y0(i){return Array.isArray(i)||ArrayBuffer.isView(i)}const BF={3042:eg,32773:(i,t)=>i.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(i,t)=>i.clearColor(...t),3107:(i,t)=>i.colorMask(...t),2884:eg,2885:(i,t)=>i.cullFace(t),2929:eg,2931:(i,t)=>i.clearDepth(t),2932:(i,t)=>i.depthFunc(t),2928:(i,t)=>i.depthRange(...t),2930:(i,t)=>i.depthMask(t),3024:eg,35723:sD,36006:(i,t)=>{const e=go(i)?36009:36160;return i.bindFramebuffer(e,t)},2886:(i,t)=>i.frontFace(t),33170:sD,2849:(i,t)=>i.lineWidth(t),32823:eg,32824:"polygonOffset",10752:"polygonOffset",35977:eg,32938:"sampleCoverage",32939:"sampleCoverage",3089:eg,3088:(i,t)=>i.scissor(...t),2960:eg,2961:(i,t)=>i.clearStencil(t),2968:(i,t)=>i.stencilMaskSeparate(1028,t),36005:(i,t)=>i.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(i,t)=>i.viewport(...t),3333:Nd,3317:Nd,37440:Nd,37441:Nd,37443:Nd,3330:Nd,3332:Nd,3331:Nd,36010:(i,t)=>i.bindFramebuffer(36008,t),3314:Nd,32878:Nd,3316:Nd,3315:Nd,32877:Nd,framebuffer:(i,t)=>i.bindFramebuffer(36160,t&&"handle"in t?t.handle:t),blend:(i,t)=>t?i.enable(3042):i.disable(3042),blendColor:(i,t)=>i.blendColor(...t),blendEquation:(i,t)=>{t=Y0(t)?t:[t,t],i.blendEquationSeparate(...t)},blendFunc:(i,t)=>{t=Y0(t)&&2===t.length?[...t,...t]:t,i.blendFuncSeparate(...t)},clearColor:(i,t)=>i.clearColor(...t),clearDepth:(i,t)=>i.clearDepth(t),clearStencil:(i,t)=>i.clearStencil(t),colorMask:(i,t)=>i.colorMask(...t),cull:(i,t)=>t?i.enable(2884):i.disable(2884),cullFace:(i,t)=>i.cullFace(t),depthTest:(i,t)=>t?i.enable(2929):i.disable(2929),depthFunc:(i,t)=>i.depthFunc(t),depthMask:(i,t)=>i.depthMask(t),depthRange:(i,t)=>i.depthRange(...t),dither:(i,t)=>t?i.enable(3024):i.disable(3024),derivativeHint:(i,t)=>{i.hint(35723,t)},frontFace:(i,t)=>i.frontFace(t),mipmapHint:(i,t)=>i.hint(33170,t),lineWidth:(i,t)=>i.lineWidth(t),polygonOffsetFill:(i,t)=>t?i.enable(32823):i.disable(32823),polygonOffset:(i,t)=>i.polygonOffset(...t),sampleCoverage:(i,t)=>i.sampleCoverage(...t),scissorTest:(i,t)=>t?i.enable(3089):i.disable(3089),scissor:(i,t)=>i.scissor(...t),stencilTest:(i,t)=>t?i.enable(2960):i.disable(2960),stencilMask:(i,t)=>{t=Y0(t)?t:[t,t];const[e,n]=t;i.stencilMaskSeparate(1028,e),i.stencilMaskSeparate(1029,n)},stencilFunc:(i,t)=>{t=Y0(t)&&3===t.length?[...t,...t]:t;const[e,n,r,l,m,C]=t;i.stencilFuncSeparate(1028,e,n,r),i.stencilFuncSeparate(1029,l,m,C)},stencilOp:(i,t)=>{t=Y0(t)&&3===t.length?[...t,...t]:t;const[e,n,r,l,m,C]=t;i.stencilOpSeparate(1028,e,n,r),i.stencilOpSeparate(1029,l,m,C)},viewport:(i,t)=>i.viewport(...t)};function Ca(i,t,e){return void 0!==t[i]?t[i]:e[i]}const VF={blendEquation:(i,t,e)=>i.blendEquationSeparate(Ca(32777,t,e),Ca(34877,t,e)),blendFunc:(i,t,e)=>i.blendFuncSeparate(Ca(32969,t,e),Ca(32968,t,e),Ca(32971,t,e),Ca(32970,t,e)),polygonOffset:(i,t,e)=>i.polygonOffset(Ca(32824,t,e),Ca(10752,t,e)),sampleCoverage:(i,t,e)=>i.sampleCoverage(Ca(32938,t,e),Ca(32939,t,e)),stencilFuncFront:(i,t,e)=>i.stencilFuncSeparate(1028,Ca(2962,t,e),Ca(2967,t,e),Ca(2963,t,e)),stencilFuncBack:(i,t,e)=>i.stencilFuncSeparate(1029,Ca(34816,t,e),Ca(36003,t,e),Ca(36004,t,e)),stencilOpFront:(i,t,e)=>i.stencilOpSeparate(1028,Ca(2964,t,e),Ca(2965,t,e),Ca(2966,t,e)),stencilOpBack:(i,t,e)=>i.stencilOpSeparate(1029,Ca(34817,t,e),Ca(34818,t,e),Ca(34819,t,e))},J2={enable:(i,t)=>i({[t]:!0}),disable:(i,t)=>i({[t]:!1}),pixelStorei:(i,t,e)=>i({[t]:e}),hint:(i,t,e)=>i({[t]:e}),bindFramebuffer:(i,t,e)=>{switch(t){case 36160:return i({36006:e,36010:e});case 36009:return i({36006:e});case 36008:return i({36010:e});default:return null}},blendColor:(i,t,e,n,r)=>i({32773:new Float32Array([t,e,n,r])}),blendEquation:(i,t)=>i({32777:t,34877:t}),blendEquationSeparate:(i,t,e)=>i({32777:t,34877:e}),blendFunc:(i,t,e)=>i({32969:t,32968:e,32971:t,32970:e}),blendFuncSeparate:(i,t,e,n,r)=>i({32969:t,32968:e,32971:n,32970:r}),clearColor:(i,t,e,n,r)=>i({3106:new Float32Array([t,e,n,r])}),clearDepth:(i,t)=>i({2931:t}),clearStencil:(i,t)=>i({2961:t}),colorMask:(i,t,e,n,r)=>i({3107:[t,e,n,r]}),cullFace:(i,t)=>i({2885:t}),depthFunc:(i,t)=>i({2932:t}),depthRange:(i,t,e)=>i({2928:new Float32Array([t,e])}),depthMask:(i,t)=>i({2930:t}),frontFace:(i,t)=>i({2886:t}),lineWidth:(i,t)=>i({2849:t}),polygonOffset:(i,t,e)=>i({32824:t,10752:e}),sampleCoverage:(i,t,e)=>i({32938:t,32939:e}),scissor:(i,t,e,n,r)=>i({3088:new Int32Array([t,e,n,r])}),stencilMask:(i,t)=>i({2968:t,36005:t}),stencilMaskSeparate:(i,t,e)=>i({[1028===t?2968:36005]:e}),stencilFunc:(i,t,e,n)=>i({2962:t,2967:e,2963:n,34816:t,36003:e,36004:n}),stencilFuncSeparate:(i,t,e,n,r)=>i({[1028===t?2962:34816]:e,[1028===t?2967:36003]:n,[1028===t?2963:36004]:r}),stencilOp:(i,t,e,n)=>i({2964:t,2965:e,2966:n,34817:t,34818:e,34819:n}),stencilOpSeparate:(i,t,e,n,r)=>i({[1028===t?2964:34817]:e,[1028===t?2965:34818]:n,[1028===t?2966:34819]:r}),viewport:(i,t,e,n,r)=>i({2978:[t,e,n,r]})},tf=(i,t)=>i.isEnabled(t),eR={3042:tf,2884:tf,2929:tf,3024:tf,32823:tf,32926:tf,32928:tf,3089:tf,2960:tf,35977:tf};function tR(i){for(const t in i)return!1;return!0}function zF(i,t){if(i===t)return!0;const e=Array.isArray(i)||ArrayBuffer.isView(i),n=Array.isArray(t)||ArrayBuffer.isView(t);if(e&&n&&i.length===t.length){for(let r=0;r<i.length;++r)if(i[r]!==t[r])return!1;return!0}return!1}function iR(i,t){const e=i[t].bind(i);i[t]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in i.state.cache&&i.state.enable?i.state.cache[r]:e(...arguments)},Object.defineProperty(i[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function UF(i,t,e){const n=i[t].bind(i);i[t]=function(){for(var l=arguments.length,m=new Array(l),C=0;C<l;C++)m[C]=arguments[C];const{valueChanged:A,oldValue:O}=e(i.state._updateCache,...m);return A&&n(...m),O},Object.defineProperty(i[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}class GF{constructor(t){let{copyState:e=!1,log:n=()=>{}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?yT(t):Object.assign({},bT),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){rc(this.stateStack.length>0),nf(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(t){let n,e=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const l in t){rc(void 0!==l);const m=t[l],C=this.cache[l];zF(m,C)||(e=!0,n=C,r&&!(l in r)&&(r[l]=C),this.cache[l]=m)}return{valueChanged:e,oldValue:n}}}function nR(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:e=!0,copyState:n}=t;if(rc(void 0!==n),!i.state){const{polyfillContext:r}=globalThis;r&&r(i),i.state=new GF(i,{copyState:n}),function jF(i){const t=i.useProgram.bind(i);i.useProgram=function(n){i.state.program!==n&&(t(n),i.state.program=n)}}(i);for(const l in J2)UF(i,l,J2[l]);iR(i,"getParameter"),iR(i,"isEnabled")}return i.state.enable=e,i}function aD(i){rc(i.state),i.state.pop()}function nf(i,t){if(rc(vT(i),"setParameters requires a WebGL context"),tR(t))return;const e={};for(const r in t){const l=Number(r),m=BF[r];m&&("string"==typeof m?e[m]=!0:m(i,t[r],l))}const n=i.state&&i.state.cache;if(n)for(const r in e)(0,VF[r])(i,t,n)}function yT(i,t){if("number"==typeof(t=t||bT)){const r=t,l=eR[r];return l?l(i,r):i.getParameter(r)}const e=Array.isArray(t)?t:Object.keys(t),n={};for(const r of e){const l=eR[r];n[r]=l?l(i,Number(r)):i.getParameter(Number(r))}return n}function Nl(i,t,e){if(tR(t))return e(i);const{nocatch:n=!0}=t;let r;if(function HF(i){i.state||nR(i,{copyState:!1}),i.state.push()}(i),nf(i,t),n)r=e(i),aD(i);else try{r=e(i)}finally{aD(i)}return r}function S_(i){const{luma:t}=i;if(i.canvas&&t){const e=t.canvasSizeInfo,n="clientWidth"in e?e.clientWidth:i.canvas.clientWidth;return n?i.drawingBufferWidth/n:1}return 1}function xT(i,t){let e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function sR(i,t,e,n,r){const l=lD(i[0],t,e);let m=cD(i[1],t,n,r),C=lD(i[0]+1,t,e);const A=C===e-1?C:C-1;let O;return C=cD(i[1]+1,t,n,r),r?(C=0===C?C:C+1,O=m,m=C):O=C===n-1?C:C-1,{x:l,y:m,width:Math.max(A-l+1,1),height:Math.max(O-m+1,1)}}(t,S_(i),i.drawingBufferWidth,i.drawingBufferHeight,e)}function lD(i,t,e){return Math.min(Math.round(i*t),e-1)}function cD(i,t,e,n){return n?Math.max(0,e-1-Math.round(i*t)):Math.min(Math.round(i*t),e-1)}const dD=Jh(),$F=dD&&typeof document<"u",wT={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function R1(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rc(dD,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),i=Object.assign({},wT,i);const{width:t,height:e}=i;function n(C){if(i.throwOnError)throw new Error(C);return console.error(C),null}let r;i.onError=n;const{canvas:l}=i,m=function cR(i){let l,{canvas:t,width:e=800,height:n=600,onError:r}=i;return"string"==typeof t?($F&&"complete"===document.readyState||r("createGLContext called on canvas '".concat(t,"' before page was loaded")),l=document.getElementById(t)):t?l=t:(l=document.createElement("canvas"),l.id="lumagl-canvas",l.style.width=Number.isFinite(e)?"".concat(e,"px"):"100%",l.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",document.body.insertBefore(l,document.body.firstChild)),l}({canvas:l,width:t,height:e,onError:n});return r=function lR(i,t){const{onError:e}=t;let n=null;const r=A=>n=A.statusMessage||n;i.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:l=!0,webgl2:m=!0}=t;let C=null;return m&&(C=C||i.getContext("webgl2",t),C=C||i.getContext("experimental-webgl2",t)),l&&(C=C||i.getContext("webgl",t),C=C||i.getContext("experimental-webgl",t)),i.removeEventListener("webglcontextcreationerror",r,!1),C?(t.onContextLost&&i.addEventListener("webglcontextlost",t.onContextLost,!1),t.onContextRestored&&i.addEventListener("webglcontextrestored",t.onContextRestored,!1),C):e("Failed to create ".concat(m&&!l?"WebGL2":"WebGL"," context: ").concat(n||"Unknown error"))}(m,i),r?(r=P1(r,i),function dR(i){const t=go(i)?"WebGL2":"WebGL1",e=function uD(i){const t=i.getParameter(7936),e=i.getParameter(7937),n=i.getExtension("WEBGL_debug_renderer_info");return{vendor:n&&i.getParameter(n.UNMASKED_VENDOR_WEBGL||7936)||t,renderer:n&&i.getParameter(n.UNMASKED_RENDERER_WEBGL||7937)||e,vendorMasked:t,rendererMasked:e,version:i.getParameter(7938),shadingLanguageVersion:i.getParameter(35724)}}(i),n=e?"(".concat(e.vendor,",").concat(e.renderer,")"):"",r=i.debug?" debug":"";lr.info(1,"".concat(t).concat(r," context ").concat(n))()}(r),r):null}function P1(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i||i._instrumented)return i;i._version=i._version||function uR(i){return typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext?2:1}(i),i.luma=i.luma||{},i.luma.canvasSizeInfo=i.luma.canvasSizeInfo||{},t=Object.assign({},wT,t);const{manageState:e,debug:n}=t;return e&&nR(i,{copyState:!1,log:function(){for(var r=arguments.length,l=new Array(r),m=0;m<r;m++)l[m]=arguments[m];return lr.log(1,...l)()}}),dD&&n&&(globalThis.makeDebugContext?(i=globalThis.makeDebugContext(i,t),lr.level=Math.max(lr.level,1)):lr.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),i._instrumented=!0,i}let hD=1,fR=1;class CT{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:r=1,repeat:l=1}=t,m=hD++,C={time:0,delay:e,duration:n,rate:r,repeat:l};return this._setChannelTime(C,this.time),this.channels.set(m,C),m}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const r of e)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:l,channel:m}=r;l.setTime(this.getTime(m))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=fR++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}const ET=Symbol.for("component"),M_=Symbol.for("propTypes"),fD=Symbol.for("deprecatedProps"),A_=Symbol.for("asyncPropDefaults"),tg=Symbol.for("asyncPropOriginal"),ig=Symbol.for("asyncPropResolved"),so=new D1({id:"deck"});let mD={};function WF(i){mD=i}function Bl(i,t,e,n){so.level>0&&mD[i]&&mD[i].call(null,t,e,n)}function Z0(i,t=()=>!0){return Array.isArray(i)?pD(i,t,[]):t(i)?[i]:[]}function pD(i,t,e){let n=-1;for(;++n<i.length;){const r=i[n];Array.isArray(r)?pD(r,t,e):t(r)&&e.push(r)}return e}function XF({target:i,source:t,start:e=0,count:n=1}){const r=t.length,l=n*r;let m=0;for(let C=e;m<r;m++)i[C++]=t[m];for(;m<l;)m<l-m?(i.copyWithin(e+m,e,e+m),m*=2):(i.copyWithin(e+m,e,e+l-m),m=l);return i}function gD(){let i;if(typeof window<"u"&&window.performance)i=window.performance.now();else if(typeof process<"u"&&process.hrtime){const t=process.hrtime();i=1e3*t[0]+t[1]/1e6}else i=Date.now();return i}class mR{constructor(t,e){ye(this,"name",void 0),ye(this,"type",void 0),ye(this,"sampleSize",1),ye(this,"time",void 0),ye(this,"count",void 0),ye(this,"samples",void 0),ye(this,"lastTiming",void 0),ye(this,"lastSampleTime",void 0),ye(this,"lastSampleCount",void 0),ye(this,"_count",0),ye(this,"_time",0),ye(this,"_samples",0),ye(this,"_startTime",0),ye(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=gD(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(gD()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class _D{constructor(t){ye(this,"id",void 0),ye(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){return this._getOrCreate({name:t,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count"})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach(e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}}),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(e=>this._getOrCreate(e))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof mR?t:new mR(e,n)),this.stats[e]}}const mh=i=>"function"==typeof i,rf=i=>null!==i&&"object"==typeof i,qF=i=>rf(i)&&i.constructor==={}.constructor,pR=i=>i&&"function"==typeof i[Symbol.iterator],gR=i=>i&&"function"==typeof i[Symbol.asyncIterator],D_=i=>typeof Response<"u"&&i instanceof Response||i&&i.arrayBuffer&&i.text&&i.json,Ab=i=>typeof Blob<"u"&&i instanceof Blob,ZF=i=>i&&"object"==typeof i&&i.isBuffer,K0=i=>(i=>typeof ReadableStream<"u"&&i instanceof ReadableStream||rf(i)&&mh(i.tee)&&mh(i.cancel)&&mh(i.getReader))(i)||(i=>rf(i)&&mh(i.read)&&mh(i.pipe)&&(i=>"boolean"==typeof i)(i.readable))(i);function L1(i,t){if(!i)throw new Error(t||"loader assertion failed.")}function TT(i){var t;return!!i&&(Array.isArray(i)&&(i=i[0]),Array.isArray(null===(t=i)||void 0===t?void 0:t.extensions))}function ST(i){var t,e;let n;return L1(i,"null loader"),L1(TT(i),"invalid loader"),Array.isArray(i)&&(n=i[1],i=i[0],i={...i,options:{...i.options,...n}}),(null!==(t=i)&&void 0!==t&&t.parseTextSync||null!==(e=i)&&void 0!==e&&e.parseText)&&(i.text=!0),i.text||(i.binary=!0),i}let MT="";const AT={},vR=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,iN=/^([-\w.]+\/[-\w.+]+)/;function bR(i){const t=vR.exec(i);return t?t[1]:""}const Q0=/\?.*/;function vD(i){return i.replace(Q0,"")}function DT(i){return D_(i)?i.url:Ab(i)?i.name||"":"string"==typeof i?i:""}function oc(i){if(D_(i)){const t=i,e=t.headers.get("content-type")||"",n=vD(t.url);return function nN(i){const t=iN.exec(i);return t?t[1]:i}(e)||bR(n)}return Ab(i)?i.type||"":"string"==typeof i?bR(i):""}function xR(i){return bD.apply(this,arguments)}function bD(){return bD=(0,Yt.A)(function*(i){if(D_(i))return i;const t={},e=function J0(i){return D_(i)?i.headers["content-length"]||-1:Ab(i)?i.size:"string"==typeof i?i.length:i instanceof ArrayBuffer||ArrayBuffer.isView(i)?i.byteLength:-1}(i);e>=0&&(t["content-length"]=String(e));const n=DT(i),r=oc(i);r&&(t["content-type"]=r);const l=yield function oN(i){return IT.apply(this,arguments)}(i);l&&(t["x-first-bytes"]=l),"string"==typeof i&&(i=(new TextEncoder).encode(i));const m=new Response(i,{headers:t});return Object.defineProperty(m,"url",{value:n}),m}),bD.apply(this,arguments)}function wR(){return wR=(0,Yt.A)(function*(i){if(!i.ok){const t=yield function rN(i){return F1.apply(this,arguments)}(i);throw new Error(t)}}),wR.apply(this,arguments)}function F1(){return F1=(0,Yt.A)(function*(i){let t="Failed to fetch resource ".concat(i.url," (").concat(i.status,"): ");try{const e=i.headers.get("Content-Type");let n=i.statusText;e.includes("application/json")&&(n+=" ".concat(yield i.text())),t+=n,t=t.length>60?"".concat(t.slice(0,60),"..."):t}catch{}return t}),F1.apply(this,arguments)}function IT(){return IT=(0,Yt.A)(function*(i){if("string"==typeof i)return"data:,".concat(i.slice(0,5));if(i instanceof Blob){const e=i.slice(0,5);return yield new Promise(n=>{const r=new FileReader;r.onload=l=>{var m;return n(null==l||null===(m=l.target)||void 0===m?void 0:m.result)},r.readAsDataURL(e)})}if(i instanceof ArrayBuffer){const n=function sN(i){let t="";const e=new Uint8Array(i);for(let n=0;n<e.byteLength;n++)t+=String.fromCharCode(e[n]);return btoa(t)}(i.slice(0,5));return"data:base64,".concat(n)}return null}),IT.apply(this,arguments)}function CR(i,t){return yD.apply(this,arguments)}function yD(){return yD=(0,Yt.A)(function*(i,t){if("string"==typeof i){i=function _R(i){for(const t in AT)i.startsWith(t)&&(i=i.replace(t,AT[t]));return!i.startsWith("http://")&&!i.startsWith("https://")&&(i="".concat(MT).concat(i)),i}(i);let e=t;return null!=t&&t.fetch&&"function"!=typeof t?.fetch&&(e=t.fetch),yield fetch(i,e)}return yield xR(i)}),yD.apply(this,arguments)}const RT=new D1({id:"loaders.gl"});class ER{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const PT=!("object"==typeof process&&"[object process]"===String(process)&&!process.browser),SR=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),OT=(SR&&parseFloat(SR[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class aN{constructor(){ye(this,"console",void 0),this.console=console}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:PT,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),uU={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function xD(){globalThis.loaders=globalThis.loaders||{};const{loaders:i}=globalThis;return i._state=i._state||{},i._state}const wD=()=>{const i=xD();return i.globalOptions=i.globalOptions||{...OT},i.globalOptions};function MR(i,t,e,n){return e=e||[],function AR(i,t){DR(i,null,OT,uU,t);for(const e of t)DR(i&&i[e.id]||{},e.id,e.options&&e.options[e.id]||{},e.deprecatedOptions&&e.deprecatedOptions[e.id]||{},t)}(i,e=Array.isArray(e)?e:[e]),function CD(i,t,e){const r={...i.options||{}};return function dN(i,t){t&&!("baseUri"in i)&&(i.baseUri=t)}(r,e),null===r.log&&(r.log=new ER),IR(r,wD()),IR(r,t),r}(t,i,n)}function DR(i,t,e,n,r){const l=t||"Top level",m=t?"".concat(t,"."):"";for(const C in i){const A=!t&&rf(i[C]);if(!(C in e)&&("baseUri"!==C||t)&&("workerUrl"!==C||!t))if(C in n)RT.warn("".concat(l," loader option '").concat(m).concat(C,"' no longer supported, use '").concat(n[C],"'"))();else if(!A){const $=kR(C,r);RT.warn("".concat(l," loader option '").concat(m).concat(C,"' not recognized. ").concat($))()}}}function kR(i,t){const e=i.toLowerCase();let n="";for(const r of t)for(const l in r.options){if(i===l)return"Did you mean '".concat(r.id,".").concat(l,"'?");const m=l.toLowerCase();(e.startsWith(m)||m.startsWith(e))&&(n=n||"Did you mean '".concat(r.id,".").concat(l,"'?"))}return n}function IR(i,t){for(const e in t)e in t&&(i[e]=qF(t[e])&&qF(i[e])?{...i[e],...t[e]}:t[e])}function ED(i,t){const e=wD(),n=i||e;return"function"==typeof n.fetch?n.fetch:rf(n.fetch)?r=>CR(r,n):null!=t&&t.fetch?t?.fetch:CR}function ng(i,t){if(!i)throw new Error(t||"loaders.gl assertion failed.")}const RR="3.4.15";typeof self<"u"&&self,typeof window<"u"&&window,typeof global<"u"&&global,typeof document<"u"&&document;const TD="object"!=typeof process||"[object process]"!==String(process)||process.browser,mU=typeof window<"u"&&typeof window.orientation<"u",mN=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);mN&&parseFloat(mN[1]);class OR{terminate(){}}const LT=new Map;function SD(i){const t=new Blob([i],{type:"application/javascript"});return URL.createObjectURL(t)}function ex(i){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=arguments.length>2?arguments[2]:void 0;const n=e||new Set;if(i)if(B1(i))n.add(i);else if(B1(i.buffer))n.add(i.buffer);else if(!ArrayBuffer.isView(i)&&t&&"object"==typeof i)for(const r in i)ex(i[r],t,n);return void 0===e?Array.from(n):[]}function B1(i){return!!i&&(i instanceof ArrayBuffer||typeof MessagePort<"u"&&i instanceof MessagePort||typeof ImageBitmap<"u"&&i instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)}const MD=()=>{};class AD{static isSupported(){return typeof Worker<"u"&&TD||typeof OR<"u"&&!TD}constructor(t){ye(this,"name",void 0),ye(this,"source",void 0),ye(this,"url",void 0),ye(this,"terminated",!1),ye(this,"worker",void 0),ye(this,"onMessage",void 0),ye(this,"onError",void 0),ye(this,"_loadableURL","");const{name:e,source:n,url:r}=t;ng(n||r),this.name=e,this.source=n,this.url=r,this.onMessage=MD,this.onError=l=>console.log(l),this.worker=TD?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=MD,this.onError=MD,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(t,e){e=e||ex(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=function pU(i){ng(i.source&&!i.url||!i.source&&i.url);let t=LT.get(i.source||i.url);return t||(i.url&&(t=function gU(i){if(!i.startsWith("http"))return i;const t=function pN(i){return"try {\n  importScripts('".concat(i,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")}(i);return SD(t)}(i.url),LT.set(i.url,t)),i.source&&(t=SD(i.source),LT.set(i.source,t))),ng(t),t}({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},t.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},t.onmessageerror=e=>console.error(e),t}_createNodeWorker(){let t;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new OR(n,{eval:!1})}else{if(!this.source)throw new Error("no worker");t=new OR(this.source,{eval:!0})}return t.on("message",e=>{this.onMessage(e)}),t.on("error",e=>{this.onError(e)}),t.on("exit",e=>{}),t}}class _N{constructor(t,e){ye(this,"name",void 0),ye(this,"workerThread",void 0),ye(this,"isRunning",!0),ye(this,"result",void 0),ye(this,"_resolve",()=>{}),ye(this,"_reject",()=>{}),this.name=t,this.workerThread=e,this.result=new Promise((n,r)=>{this._resolve=n,this._reject=r})}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){ng(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){ng(this.isRunning),this.isRunning=!1,this._reject(t)}}class vN{static isSupported(){return AD.isSupported()}constructor(t){ye(this,"name","unnamed"),ye(this,"source",void 0),ye(this,"url",void 0),ye(this,"maxConcurrency",1),ye(this,"maxMobileConcurrency",1),ye(this,"onDebug",()=>{}),ye(this,"reuseWorkers",!0),ye(this,"props",{}),ye(this,"jobQueue",[]),ye(this,"idleQueue",[]),ye(this,"count",0),ye(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}startJob(t){var e=arguments,n=this;return(0,Yt.A)(function*(){let r=e.length>1&&void 0!==e[1]?e[1]:(C,A,O)=>C.done(O),l=e.length>2&&void 0!==e[2]?e[2]:(C,A)=>C.error(A);const m=new Promise(C=>(n.jobQueue.push({name:t,onMessage:r,onError:l,onStart:C}),n));return n._startQueuedJob(),yield m})()}_startQueuedJob(){var t=this;return(0,Yt.A)(function*(){if(!t.jobQueue.length)return;const e=t._getAvailableWorker();if(!e)return;const n=t.jobQueue.shift();if(n){t.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:t.jobQueue.length});const r=new _N(n.name,e);e.onMessage=l=>n.onMessage(r,l.type,l.payload),e.onError=l=>n.onError(r,l),n.onStart(r);try{yield r.result}finally{t.returnWorkerToQueue(e)}}})()}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new AD({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return mU?this.maxMobileConcurrency:this.maxConcurrency}}const bN={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class rg{static isSupported(){return AD.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rg._workerFarm=rg._workerFarm||new rg({}),rg._workerFarm.setProps(t),rg._workerFarm}constructor(t){ye(this,"props",void 0),ye(this,"workerPools",new Map),this.props={...bN},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:r}=t;let l=this.workerPools.get(e);return l||(l=new vN({name:e,source:n,url:r}),l.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,l)),l}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}ye(rg,"_workerFarm",void 0);const LR="latest";function DD(){return DD=(0,Yt.A)(function*(i,t,e,n,r){const l=i.id,m=function yN(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const e=t[i.id]||{},n="".concat(i.id,"-worker.js");let r=e.workerUrl;if(!r&&"compression"===i.id&&(r=t.workerUrl),"test"===t._workerType&&(r="modules/".concat(i.module,"/dist/").concat(n)),!r){let l=i.version;"latest"===l&&(l=LR);const m=l?"@".concat(l):"";r="https://unpkg.com/@loaders.gl/".concat(i.module).concat(m,"/dist/").concat(n)}return ng(r),r}(i,e),A=rg.getWorkerFarm(e).getWorkerPool({name:l,url:m});e=JSON.parse(JSON.stringify(e)),n=JSON.parse(JSON.stringify(n||{}));const O=yield A.startJob("process-on-worker",CN.bind(null,r));return O.postMessage("process",{input:t,options:e,context:n}),yield(yield O.result).result}),DD.apply(this,arguments)}function CN(i,t,e,n){return kD.apply(this,arguments)}function kD(){return kD=(0,Yt.A)(function*(i,t,e,n){switch(e){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:r,input:l,options:m}=n;try{const C=yield i(l,m);t.postMessage("done",{id:r,result:C})}catch(C){const A=C instanceof Error?C.message:"unknown error";t.postMessage("error",{id:r,error:A})}break;default:console.warn("parse-with-worker unknown message ".concat(e))}}),kD.apply(this,arguments)}function RD(){return RD=(0,Yt.A)(function*(i){const t=[];var r,e=!1,n=!1;try{for(var m,l=N0(i);e=!(m=yield l.next()).done;e=!1)t.push(m.value)}catch(C){n=!0,r=C}finally{try{e&&null!=l.return&&(yield l.return())}finally{if(n)throw r}}return function TN(){for(var i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];const n=t.map(C=>C instanceof ArrayBuffer?new Uint8Array(C):C),r=n.reduce((C,A)=>C+A.byteLength,0),l=new Uint8Array(r);let m=0;for(const C of n)l.set(C,m),m+=C.byteLength;return l.buffer}(...t)}),RD.apply(this,arguments)}const SN=262144,wU=262144;function PD(i,t){this.v=i,this.k=t}function V1(i){return new PD(i,0)}function OD(i){return function(){return new tx(i.apply(this,arguments))}}function tx(i){var t,e;function n(l,m){try{var C=i[l](m),A=C.value,O=A instanceof PD;Promise.resolve(O?A.v:A).then(function(z){if(O){var $="return"===l?"return":"next";if(!A.k||z.done)return n($,z);z=i[$](z).value}r(C.done?"return":"normal",z)},function(z){n("throw",z)})}catch(z){r("throw",z)}}function r(l,m){switch(l){case"return":t.resolve({value:m,done:!0});break;case"throw":t.reject(m);break;default:t.resolve({value:m,done:!1})}(t=t.next)?n(t.key,t.arg):e=null}this._invoke=function(l,m){return new Promise(function(C,A){var O={key:l,arg:m,resolve:C,reject:A,next:null};e?e=e.next=O:(t=e=O,n(l,m))})},"function"!=typeof i.return&&(this.return=void 0)}tx.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},tx.prototype.next=function(i){return this._invoke("next",i)},tx.prototype.throw=function(i){return this._invoke("throw",i)},tx.prototype.return=function(i){return this._invoke("return",i)};const AN=1048576;function z1(){return z1=OD(function*(i,t){const e=t?.chunkSize||AN;let n=0;for(;n<i.size;){const r=n+e,l=yield V1(i.slice(n,r).arrayBuffer());n=r,yield l}}),z1.apply(this,arguments)}function IN(i){if(function FD(i){return i&&"object"==typeof i&&i.isBuffer}(i))return i;if(i instanceof ArrayBuffer)return i;if(ArrayBuffer.isView(i))return 0===i.byteOffset&&i.byteLength===i.buffer.byteLength?i.buffer:i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength);if("string"==typeof i){const t=i;return(new TextEncoder).encode(t).buffer}if(i&&"object"==typeof i&&i._toArrayBuffer)return i._toArrayBuffer();throw new Error("toArrayBuffer")}function BD(i,t){return PT?function RN(i,t){return BR.apply(this,arguments)}(i,t):function PN(i,t){return BT.apply(this,arguments)}(i,t)}function BR(){return BR=OD(function*(i,t){const e=i.getReader();let n;try{for(;;){const r=n||e.read();null!=t&&t._streamReadAhead&&(n=e.read());const{done:l,value:m}=yield V1(r);if(l)return;yield IN(m)}}catch{e.releaseLock()}}),BR.apply(this,arguments)}function BT(){return BT=OD(function*(i,t){var r,e=!1,n=!1;try{for(var m,l=N0(i);e=!(m=yield V1(l.next())).done;e=!1){const C=m.value;yield IN(C)}}catch(C){n=!0,r=C}finally{try{e&&null!=l.return&&(yield V1(l.return()))}finally{if(n)throw r}}}),BT.apply(this,arguments)}const _u="Cannot convert supplied data type";function UT(){return UT=(0,Yt.A)(function*(i,t,e){const n=i instanceof ArrayBuffer||ArrayBuffer.isView(i);if("string"==typeof i||n)return function VT(i,t){if(t.text&&"string"==typeof i)return i;if(ZF(i)&&(i=i.buffer),i instanceof ArrayBuffer){const n=i;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(i)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(i);let n=i.buffer;const r=i.byteLength||i.length;return(0!==i.byteOffset||r!==n.byteLength)&&(n=n.slice(i.byteOffset,i.byteOffset+r)),n}throw new Error(_u)}(i,t);if(Ab(i)&&(i=yield xR(i)),D_(i)){const r=i;return yield function cU(i){return wR.apply(this,arguments)}(r),t.binary?yield r.arrayBuffer():yield r.text()}if(K0(i)&&(i=function VR(i,t){if("string"==typeof i)return function*NR(i,t){const e=t?.chunkSize||SN;let n=0;const r=new TextEncoder;for(;n<i.length;){const l=Math.min(i.length-n,e),m=i.slice(n,n+l);n+=l,yield r.encode(m)}}(i,t);if(i instanceof ArrayBuffer)return function MN(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{chunkSize:e=wU}=t;let n=0;for(;n<i.byteLength;){const r=Math.min(i.byteLength-n,e),l=new ArrayBuffer(r),m=new Uint8Array(i,n,r);new Uint8Array(l).set(m),n+=r,yield l}}()}(i,t);if(Ab(i))return function LD(i,t){return z1.apply(this,arguments)}(i,t);if(K0(i))return BD(i,t);if(D_(i))return BD(i.body,t);throw new Error("makeIterator")}(i,e)),pR(i)||gR(i))return function ID(i){return RD.apply(this,arguments)}(i);throw new Error(_u)}),UT.apply(this,arguments)}function zR(i){const t=i?i.lastIndexOf("/"):-1;return t>=0?i.substr(t+1):""}const jR=new D1({id:"loaders.gl"}),jT=()=>{const i=xD();return i.loaderRegistry=i.loaderRegistry||[],i.loaderRegistry},kU=/\.([^.]+)$/;function ix(){return ix=(0,Yt.A)(function*(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!FN(i))return null;let r=HR(i,t,{...e,nothrow:!0},n);if(r)return r;if(Ab(i)&&(r=HR(i=yield i.slice(0,10).arrayBuffer(),t,e,n)),!(r||null!=e&&e.nothrow))throw new Error($R(i));return r}),ix.apply(this,arguments)}function HR(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(!FN(i))return null;if(t&&!Array.isArray(t))return ST(t);let r=[];t&&(r=r.concat(t)),null!=e&&e.ignoreRegisteredLoaders||r.push(...function DU(){return jT()}()),function GD(i){for(const t of i)ST(t)}(r);const l=function IU(i,t,e,n){const r=DT(i),l=oc(i),m=vD(r)||n?.url;let C=null,A="";var O;return null!=e&&e.mimeType&&(C=HT(t,e?.mimeType),A="match forced by supplied MIME type ".concat(e?.mimeType)),C=C||function WR(i,t){const e=t&&kU.exec(t),n=e&&e[1];return n?function k_(i,t){t=t.toLowerCase();for(const e of i)for(const n of e.extensions)if(n.toLowerCase()===t)return e;return null}(i,n):null}(t,m),A=A||(C?"matched url ".concat(m):""),C=C||HT(t,l),A=A||(C?"matched MIME type ".concat(l):""),C=C||function NN(i,t){if(!t)return null;for(const e of i)if("string"==typeof t){if(RU(t,e))return e}else if(ArrayBuffer.isView(t)){if(HD(t.buffer,t.byteOffset,e))return e}else if(t instanceof ArrayBuffer&&HD(t,0,e))return e;return null}(t,i),A=A||(C?"matched initial data ".concat($T(i)):""),C=C||HT(t,e?.fallbackMimeType),A=A||(C?"matched fallback MIME type ".concat(l):""),A&&jR.log(1,"selectLoader selected ".concat(null===(O=C)||void 0===O?void 0:O.name,": ").concat(A,".")),C}(i,r,e,n);if(!(l||null!=e&&e.nothrow))throw new Error($R(i));return l}function FN(i){return!(i instanceof Response&&204===i.status)}function $R(i){const t=DT(i),e=oc(i);let n="No valid loader found (";n+=t?"".concat(zR(t),", "):"no url provided, ",n+="MIME type: ".concat(e?'"'.concat(e,'"'):"not provided",", ");const r=i?$T(i):"";return n+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",n+=")",n}function HT(i,t){for(const e of i)if(e.mimeTypes&&e.mimeTypes.includes(t)||t==="application/x.".concat(e.id))return e;return null}function RU(i,t){return t.testText?t.testText(i):(Array.isArray(t.tests)?t.tests:[t.tests]).some(n=>i.startsWith(n))}function HD(i,t,e){return(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>function BN(i,t,e,n){if(n instanceof ArrayBuffer)return function EN(i,t,e){if(i.byteLength<(e=e||i.byteLength)||t.byteLength<e)return!1;const n=new Uint8Array(i),r=new Uint8Array(t);for(let l=0;l<n.length;++l)if(n[l]!==r[l])return!1;return!0}(n,i,n.byteLength);switch(typeof n){case"function":return n(i,e);case"string":return n===XR(i,t,n.length);default:return!1}}(i,t,e,r))}function $T(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"string"==typeof i?i.slice(0,t):ArrayBuffer.isView(i)?XR(i.buffer,i.byteOffset,t):i instanceof ArrayBuffer?XR(i,0,t):""}function XR(i,t,e){if(i.byteLength<t+e)return"";const n=new DataView(i);let r="";for(let l=0;l<e;l++)r+=String.fromCharCode(n.getUint8(t+l));return r}function $D(i,t,e,n){return WT.apply(this,arguments)}function WT(){return WT=(0,Yt.A)(function*(i,t,e,n){ng(!n||"object"==typeof n),t&&!Array.isArray(t)&&!TT(t)&&(n=void 0,e=t,t=void 0),e=e||{};const r=DT(i=yield i),m=function ON(i,t){if(!t&&i&&!Array.isArray(i))return i;let e;if(i&&(e=Array.isArray(i)?i:[i]),t&&t.loaders){const n=Array.isArray(t.loaders)?t.loaders:[t.loaders];e=e?[...e,...n]:n}return e&&e.length?e:null}(t,n),C=yield function LN(i){return ix.apply(this,arguments)}(i,m,e);return C?(n=function jD(i,t,e){if(e)return e;const n={fetch:ED(t,i),...i};if(n.url){const r=vD(n.url);n.baseUrl=r,n.queryString=function yR(i){const t=i.match(Q0);return t&&t[0]}(n.url),n.filename=zR(r),n.baseUrl=function UR(i){const t=i?i.lastIndexOf("/"):-1;return t>=0?i.substr(0,t):""}(r)}return Array.isArray(n.loaders)||(n.loaders=null),n}({url:r,parse:$D,loaders:m},e=MR(e,C,m,r),n||null),yield function PU(i,t,e,n){return qR.apply(this,arguments)}(C,i,e,n)):null}),WT.apply(this,arguments)}function qR(){return qR=(0,Yt.A)(function*(i,t,e,n){if(function PR(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:RR;ng(i,"no worker provided")}(i),D_(t)){const r=t,{ok:l,redirected:m,status:C,statusText:A,type:O,url:z}=r,$=Object.fromEntries(r.headers.entries());n.response={headers:$,ok:l,redirected:m,status:C,statusText:A,type:O,url:z}}if(t=yield function zT(i,t,e){return UT.apply(this,arguments)}(t,i,e),i.parseTextSync&&"string"==typeof t)return e.dataType="text",i.parseTextSync(t,e,n,i);if(function xN(i,t){return!(!rg.isSupported()||!(TD||null!=t&&t._nodeWorkers))&&i.worker&&t?.worker}(i,e))return yield function wN(i,t,e,n,r){return DD.apply(this,arguments)}(i,t,e,n,$D);if(i.parseText&&"string"==typeof t)return yield i.parseText(t,e,n,i);if(i.parse)return yield i.parse(t,e,n,i);throw ng(!i.parseSync),new Error("".concat(i.id," loader - no parser found and worker is disabled"))}),qR.apply(this,arguments)}function YR(i,t,e,n){return WD.apply(this,arguments)}function WD(){return WD=(0,Yt.A)(function*(i,t,e,n){!Array.isArray(t)&&!TT(t)&&(e=t,t=void 0);const r=ED(e);let l=i;return"string"==typeof i&&(l=yield r(i)),Ab(i)&&(l=yield r(i)),yield $D(l,t,e)}),WD.apply(this,arguments)}class OU{constructor(t,e,n){ye(this,"id",void 0),ye(this,"context",void 0),ye(this,"isLoaded",void 0),ye(this,"persistent",void 0),ye(this,"_loadCount",0),ye(this,"_subscribers",new Set),ye(this,"_data",void 0),ye(this,"_loader",void 0),ye(this,"_error",void 0),ye(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let r=t;"string"==typeof t&&(r=YR(t)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(l=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=l)}).catch(l=>{this._loadCount===n&&(this.isLoaded=!0,this._error=l||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const l of this._subscribers)l.onChange(this.getData())}}class LU{constructor({gl:t,protocol:e}){ye(this,"protocol",void 0),ye(this,"_context",void 0),ye(this,"_resources",void 0),ye(this,"_consumers",void 0),ye(this,"_pruneRequest",void 0),this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:r=!0}){let l=this._resources[t];l?l.setData(e,n):(l=new OU(t,e,this._context),this._resources[t]=l),l.persistent=r}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const n in e){const r=e[n],l=this._resources[r.resourceId];l&&l.unsubscribe(r)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:r="default"}){const{_resources:l,protocol:m}=this;t.startsWith(m)&&(l[t=t.replace(m,"")]||this.add({resourceId:t,data:null,persistent:!1}));const C=l[t];if(this._track(n,r,C,e),C)return C.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,r){const l=this._consumers,m=l[t]=l[t]||{},C=m[e]||{},A=C.resourceId&&this._resources[C.resourceId];A&&(A.unsubscribe(C),this.prune()),n&&(m[e]=C,C.onChange=r,C.resourceId=n.id,n.subscribe(C))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];!e.persistent&&!e.inUse()&&(e.delete(),delete this._resources[t])}}}const kb=new class FU{constructor(t={}){ye(this,"_pool",[]),ye(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,{size:n=1,type:r,padding:l=0,copy:m=!1,initialize:C=!1,maxCount:A}){const O=r||t&&t.constructor||Float32Array,z=e*n+l;if(ArrayBuffer.isView(t)){if(z<=t.length)return t;if(z*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new O(t.buffer,0,z)}let $=1/0;A&&($=A*n+l);const Q=this._allocate(O,z,C,$);return t&&m?Q.set(t):C||Q.fill(0,0,4),this._release(t),Q}release(t){this._release(t)}_allocate(t,e,n,r){let l=Math.max(Math.ceil(e*this.opts.overAlloc),1);l>r&&(l=r);const m=this._pool,C=t.BYTES_PER_ELEMENT*l,A=m.findIndex(O=>O.byteLength>=C);if(A>=0){const O=new t(m.splice(A,1)[0],0,l);return n&&O.fill(0),O}return new t(l)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:r}=n,l=e.findIndex(m=>m.byteLength>=r);l<0?e.push(n):(l>0||e.length<this.opts.poolSize)&&e.splice(l,0,n),e.length>this.opts.poolSize&&e.shift()}},Va=(Math,Math,{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0});function NU(i,{precision:t=Va.precision}={}){return i=function VU(i){return Math.round(i/Va.EPSILON)*Va.EPSILON}(i),"".concat(parseFloat(i.toPrecision(t)))}function I_(i){return Array.isArray(i)||ArrayBuffer.isView(i)&&!(i instanceof DataView)}function R_(i,t,e){return function Fm(i,t,e){if(I_(i)){const n=i;e=e||function zU(i){return i.clone?i.clone():new Array(i.length)}(n);for(let r=0;r<e.length&&r<n.length;++r)e[r]=t(i[r],r,e);return e}return t(i)}(i,n=>Math.max(t,Math.min(e,n)))}function rx(i,t,e){return I_(i)?i.map((n,r)=>rx(n,t[r],e)):e*t+(1-e)*i}function Ib(i,t,e){const n=Va.EPSILON;e&&(Va.EPSILON=e);try{if(i===t)return!0;if(I_(i)&&I_(t)){if(i.length!==t.length)return!1;for(let r=0;r<i.length;++r)if(!Ib(i[r],t[r]))return!1;return!0}return i&&i.equals?i.equals(t):t&&t.equals?t.equals(i):"number"==typeof i&&"number"==typeof t&&Math.abs(i-t)<=Va.EPSILON*Math.max(1,Math.abs(i),Math.abs(t))}finally{Va.EPSILON=n}}class JR extends(function HN(i){function t(){var e=Reflect.construct(i,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return t.prototype=Object.create(i.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i,t}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:I_(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Va)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+NU(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!Ib(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let r=0;r<this.ELEMENTS;++r){const l=t[r];this[r]=l+n*(e[r]-l)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let n=0;n<this.ELEMENTS;++n)this[n]+=e[n];return this.check()}subtract(...t){for(const e of t)for(let n=0;n<this.ELEMENTS;++n)this[n]-=e[n];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(Va.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}function sc(i){if(!Number.isFinite(i))throw new Error("Invalid number ".concat(i));return i}function YT(i,t,e=""){if(Va.debug&&!function $N(i,t){if(i.length!==t)return!1;for(let e=0;e<i.length;++e)if(!Number.isFinite(i[e]))return!1;return!0}(i,t))throw new Error("math.gl: ".concat(e," some fields set to invalid numbers'"));return i}function eP(i,t){if(!i)throw new Error("math.gl assertion ".concat(t))}class tP extends JR{get x(){return this[0]}set x(t){this[0]=sc(t)}get y(){return this[1]}set y(t){this[1]=sc(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return sc(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return sc(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let n=0;n<this.ELEMENTS;++n)this[n]*=e[n];return this.check()}divide(...t){for(const e of t)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return eP(t>=0&&t<this.ELEMENTS,"index is out of range"),sc(this[t])}setComponent(t,e){return eP(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var ox=1e-6,og=typeof Float32Array<"u"?Float32Array:Array;function QD(i,t,e){var n=t[0],r=t[1],l=t[2],m=e[3]*n+e[7]*r+e[11]*l+e[15];return i[0]=(e[0]*n+e[4]*r+e[8]*l+e[12])/(m=m||1),i[1]=(e[1]*n+e[5]*r+e[9]*l+e[13])/m,i[2]=(e[2]*n+e[6]*r+e[10]*l+e[14])/m,i}Math,Math,Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});function JD(i,t,e){const n=t[0],r=t[1],l=e[3]*n+e[7]*r||1;return i[0]=(e[0]*n+e[4]*r)/l,i[1]=(e[1]*n+e[5]*r)/l,i}function oP(i,t,e){const n=t[0],r=t[1],l=t[2],m=e[3]*n+e[7]*r+e[11]*l||1;return i[0]=(e[0]*n+e[4]*r+e[8]*l)/m,i[1]=(e[1]*n+e[5]*r+e[9]*l)/m,i[2]=(e[2]*n+e[6]*r+e[10]*l)/m,i}!function GU(){var i=new og(3);og!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0)}();const sP=[0,0,0];let JT;class Nm extends tP{static get ZERO(){return JT||(JT=new Nm(0,0,0),Object.freeze(JT)),JT}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&I_(t)?this.copy(t):(Va.debug&&(sc(t),sc(e),sc(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Va.debug&&(sc(t.x),sc(t.y),sc(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=sc(t)}angle(t){return function KU(i,t){var e=i[0],n=i[1],r=i[2],l=t[0],m=t[1],C=t[2],z=Math.sqrt(e*e+n*n+r*r)*Math.sqrt(l*l+m*m+C*C),$=z&&function t3(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]}(i,t)/z;return Math.acos(Math.min(Math.max($,-1),1))}(this,t)}cross(t){return function nP(i,t,e){var n=t[0],r=t[1],l=t[2],m=e[0],C=e[1],A=e[2];i[0]=r*A-l*C,i[1]=l*m-n*A,i[2]=n*C-r*m}(this,this,t),this.check()}rotateX({radians:t,origin:e=sP}){return function ZU(i,t,e,n){var r=[],l=[];r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],l[0]=r[0],l[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),l[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),i[0]=l[0]+e[0],i[1]=l[1]+e[1],i[2]=l[2]+e[2]}(this,this,e,t),this.check()}rotateY({radians:t,origin:e=sP}){return function r3(i,t,e,n){var r=[],l=[];r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],l[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),l[1]=r[1],l[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),i[0]=l[0]+e[0],i[1]=l[1]+e[1],i[2]=l[2]+e[2]}(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=sP}){return function o3(i,t,e,n){var r=[],l=[];r[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],l[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),l[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),l[2]=r[2],i[0]=l[0]+e[0],i[1]=l[1]+e[1],i[2]=l[2]+e[2]}(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return QD(this,this,t),this.check()}transformAsVector(t){return oP(this,this,t),this.check()}transformByMatrix3(t){return function qU(i,t,e){var n=t[0],r=t[1],l=t[2];i[0]=n*e[0]+r*e[3]+l*e[6],i[1]=n*e[1]+r*e[4]+l*e[7],i[2]=n*e[2]+r*e[5]+l*e[8]}(this,this,t),this.check()}transformByMatrix2(t){return function i5(i,t,e){const n=t[0],r=t[1];i[0]=e[0]*n+e[2]*r,i[1]=e[1]*n+e[3]*r,i[2]=t[2]}(this,this,t),this.check()}transformByQuaternion(t){return function YU(i,t,e){var n=e[0],r=e[1],l=e[2],C=t[0],A=t[1],O=t[2],z=r*O-l*A,$=l*C-n*O,Q=n*A-r*C,te=r*Q-l*$,de=l*z-n*Q,fe=n*$-r*z,ge=2*e[3];$*=ge,Q*=ge,de*=2,fe*=2,i[0]=C+(z*=ge)+(te*=2),i[1]=A+$+de,i[2]=O+Q+fe}(this,this,t),this.check()}}const cP=new Nm;function sx(i,t,e,n){cP.set(i,t,e);const r=cP.len();return{distance:n/r,normal:new Nm(-i/r,-t/r,-e/r)}}function j1(i){return i-Math.fround(i)}let eS;function tS(i,t){const{size:e=1,startIndex:n=0}=t,r=void 0!==t.endIndex?t.endIndex:i.length,l=(r-n)/e;eS=kb.allocate(eS,l,{type:Float32Array,size:2*e});let m=n,C=0;for(;m<r;){for(let A=0;A<e;A++){const O=i[m++];eS[C+A]=O,eS[C+A+e]=j1(O)}C+=2*e}return eS.subarray(0,l*e*2)}function dP(i){let t=null,e=!1;for(const n of i)n&&(t?(e||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],e=!0),t[0][0]=Math.min(t[0][0],n[0][0]),t[0][1]=Math.min(t[0][1],n[0][1]),t[1][0]=Math.max(t[1][0],n[1][0]),t[1][1]=Math.max(t[1][1],n[1][1])):t=n);return t}class d3 extends JR{toString(){let t="[";if(Va.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=sc(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let r=0;r<this.RANK;++r)e[r]=this[n+r];return e}setColumn(t,e){const n=t*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}function iS(i,t){var e=t[0],n=t[1],r=t[2],l=t[3],m=t[4],C=t[5],A=t[6],O=t[7],z=t[8],$=t[9],Q=t[10],te=t[11],de=t[12],fe=t[13],ge=t[14],Re=t[15],qe=e*C-n*m,et=e*A-r*m,yt=e*O-l*m,Jt=n*A-r*C,fi=n*O-l*C,Hi=r*O-l*A,tn=z*fe-$*de,cn=z*ge-Q*de,_n=z*Re-te*de,Rr=$*ge-Q*fe,to=$*Re-te*fe,Ts=Q*Re-te*ge,ns=qe*Ts-et*to+yt*Rr+Jt*_n-fi*cn+Hi*tn;return ns?(i[0]=(C*Ts-A*to+O*Rr)*(ns=1/ns),i[1]=(r*to-n*Ts-l*Rr)*ns,i[2]=(fe*Hi-ge*fi+Re*Jt)*ns,i[3]=(Q*fi-$*Hi-te*Jt)*ns,i[4]=(A*_n-m*Ts-O*cn)*ns,i[5]=(e*Ts-r*_n+l*cn)*ns,i[6]=(ge*yt-de*Hi-Re*et)*ns,i[7]=(z*Hi-Q*yt+te*et)*ns,i[8]=(m*to-C*_n+O*tn)*ns,i[9]=(n*_n-e*to-l*tn)*ns,i[10]=(de*fi-fe*yt+Re*qe)*ns,i[11]=($*yt-z*fi-te*qe)*ns,i[12]=(C*cn-m*Rr-A*tn)*ns,i[13]=(e*Rr-n*cn+r*tn)*ns,i[14]=(fe*et-de*Jt-ge*qe)*ns,i[15]=(z*Jt-$*et+Q*qe)*ns,i):null}function P_(i,t,e){var n=t[0],r=t[1],l=t[2],m=t[3],C=t[4],A=t[5],O=t[6],z=t[7],$=t[8],Q=t[9],te=t[10],de=t[11],fe=t[12],ge=t[13],Re=t[14],qe=t[15],et=e[0],yt=e[1],Jt=e[2],fi=e[3];return i[0]=et*n+yt*C+Jt*$+fi*fe,i[1]=et*r+yt*A+Jt*Q+fi*ge,i[2]=et*l+yt*O+Jt*te+fi*Re,i[3]=et*m+yt*z+Jt*de+fi*qe,i[4]=(et=e[4])*n+(yt=e[5])*C+(Jt=e[6])*$+(fi=e[7])*fe,i[5]=et*r+yt*A+Jt*Q+fi*ge,i[6]=et*l+yt*O+Jt*te+fi*Re,i[7]=et*m+yt*z+Jt*de+fi*qe,i[8]=(et=e[8])*n+(yt=e[9])*C+(Jt=e[10])*$+(fi=e[11])*fe,i[9]=et*r+yt*A+Jt*Q+fi*ge,i[10]=et*l+yt*O+Jt*te+fi*Re,i[11]=et*m+yt*z+Jt*de+fi*qe,i[12]=(et=e[12])*n+(yt=e[13])*C+(Jt=e[14])*$+(fi=e[15])*fe,i[13]=et*r+yt*A+Jt*Q+fi*ge,i[14]=et*l+yt*O+Jt*te+fi*Re,i[15]=et*m+yt*z+Jt*de+fi*qe,i}function G1(i,t,e){var m,C,A,O,z,$,Q,te,de,fe,ge,Re,n=e[0],r=e[1],l=e[2];return t===i?(i[12]=t[0]*n+t[4]*r+t[8]*l+t[12],i[13]=t[1]*n+t[5]*r+t[9]*l+t[13],i[14]=t[2]*n+t[6]*r+t[10]*l+t[14],i[15]=t[3]*n+t[7]*r+t[11]*l+t[15]):(C=t[1],A=t[2],O=t[3],z=t[4],$=t[5],Q=t[6],te=t[7],de=t[8],fe=t[9],ge=t[10],Re=t[11],i[0]=m=t[0],i[1]=C,i[2]=A,i[3]=O,i[4]=z,i[5]=$,i[6]=Q,i[7]=te,i[8]=de,i[9]=fe,i[10]=ge,i[11]=Re,i[12]=m*n+z*r+de*l+t[12],i[13]=C*n+$*r+fe*l+t[13],i[14]=A*n+Q*r+ge*l+t[14],i[15]=O*n+te*r+Re*l+t[15]),i}function uP(i,t,e){var n=e[0],r=e[1],l=e[2];return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i[8]=t[8]*l,i[9]=t[9]*l,i[10]=t[10]*l,i[11]=t[11]*l,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i}function H1(i,t,e){var n=Math.sin(e),r=Math.cos(e),l=t[4],m=t[5],C=t[6],A=t[7],O=t[8],z=t[9],$=t[10],Q=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=l*r+O*n,i[5]=m*r+z*n,i[6]=C*r+$*n,i[7]=A*r+Q*n,i[8]=O*r-l*n,i[9]=z*r-m*n,i[10]=$*r-C*n,i[11]=Q*r-A*n,i}function ek(i,t,e){var n=Math.sin(e),r=Math.cos(e),l=t[0],m=t[1],C=t[2],A=t[3],O=t[4],z=t[5],$=t[6],Q=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=l*r+O*n,i[1]=m*r+z*n,i[2]=C*r+$*n,i[3]=A*r+Q*n,i[4]=O*r-l*n,i[5]=z*r-m*n,i[6]=$*r-C*n,i[7]=Q*r-A*n,i}function c(i,t,e){return i[0]=t[0]+e[0],i[1]=t[1]+e[1],i}function Fo(i,t,e,n){var r=t[0],l=t[1];return i[0]=r+n*(e[0]-r),i[1]=l+n*(e[1]-l),i}function ik(i,t,e){var n=t[0],r=t[1];return i[0]=e[0]*n+e[4]*r+e[12],i[1]=e[1]*n+e[5]*r+e[13],i}function nk(i,t,e){var n=t[0],r=t[1],l=t[2],m=t[3];return i[0]=e[0]*n+e[4]*r+e[8]*l+e[12]*m,i[1]=e[1]*n+e[5]*r+e[9]*l+e[13]*m,i[2]=e[2]*n+e[6]*r+e[10]*l+e[14]*m,i[3]=e[3]*n+e[7]*r+e[11]*l+e[15]*m,i}!function x3(){var i=new og(2);og!=Float32Array&&(i[0]=0,i[1]=0)}(),function zX(){var i=new og(4);og!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0)}();var A5=function(i){return i[i.COL0ROW0=0]="COL0ROW0",i[i.COL0ROW1=1]="COL0ROW1",i[i.COL0ROW2=2]="COL0ROW2",i[i.COL0ROW3=3]="COL0ROW3",i[i.COL1ROW0=4]="COL1ROW0",i[i.COL1ROW1=5]="COL1ROW1",i[i.COL1ROW2=6]="COL1ROW2",i[i.COL1ROW3=7]="COL1ROW3",i[i.COL2ROW0=8]="COL2ROW0",i[i.COL2ROW1=9]="COL2ROW1",i[i.COL2ROW2=10]="COL2ROW2",i[i.COL2ROW3=11]="COL2ROW3",i[i.COL3ROW0=12]="COL3ROW0",i[i.COL3ROW1=13]="COL3ROW1",i[i.COL3ROW2=14]="COL3ROW2",i[i.COL3ROW3=15]="COL3ROW3",i}(A5||{});const jX=45*Math.PI/180,GX=1,C3=.1,E3=500,HX=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class sg extends d3{static get IDENTITY(){return function WX(){return pP||(pP=new sg,Object.freeze(pP)),pP}()}static get ZERO(){return function $X(){return mP||(mP=new sg([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(mP)),mP}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return A5}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,r,l,m,C,A,O,z,$,Q,te,de,fe,ge){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=l,this[5]=m,this[6]=C,this[7]=A,this[8]=O,this[9]=z,this[10]=$,this[11]=Q,this[12]=te,this[13]=de,this[14]=fe,this[15]=ge,this.check()}setRowMajor(t,e,n,r,l,m,C,A,O,z,$,Q,te,de,fe,ge){return this[0]=t,this[1]=l,this[2]=O,this[3]=te,this[4]=e,this[5]=m,this[6]=z,this[7]=de,this[8]=n,this[9]=C,this[10]=$,this[11]=fe,this[12]=r,this[13]=A,this[14]=Q,this[15]=ge,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(HX)}fromObject(t){return this.check()}fromQuaternion(t){return function f5(i,t){var e=t[0],n=t[1],r=t[2],l=t[3],m=e+e,C=n+n,A=r+r,O=e*m,z=n*m,$=n*C,Q=r*m,te=r*C,de=r*A,fe=l*m,ge=l*C,Re=l*A;i[0]=1-$-de,i[1]=z+Re,i[2]=Q-ge,i[3]=0,i[4]=z-Re,i[5]=1-O-de,i[6]=te+fe,i[7]=0,i[8]=Q+ge,i[9]=te-fe,i[10]=1-O-$,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1}(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:r,top:l,near:m=C3,far:C=E3}=t;return C===1/0?function XX(i,t,e,n,r,l){const C=2*l/(r-n),A=(e+t)/(e-t),O=(r+n)/(r-n),Q=-2*l;i[0]=2*l/(e-t),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=C,i[6]=0,i[7]=0,i[8]=A,i[9]=O,i[10]=-1,i[11]=-1,i[12]=0,i[13]=0,i[14]=Q,i[15]=0}(this,e,n,r,l,m):function m5(i,t,e,n,r,l,m){var C=1/(e-t),A=1/(r-n),O=1/(l-m);i[0]=2*l*C,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*l*A,i[6]=0,i[7]=0,i[8]=(e+t)*C,i[9]=(r+n)*A,i[10]=(m+l)*O,i[11]=-1,i[12]=0,i[13]=0,i[14]=m*l*2*O,i[15]=0}(this,e,n,r,l,m,C),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:r=[0,1,0]}=t;return function b5(i,t,e,n){var r,l,m,C,A,O,z,$,Q,te,de=t[0],fe=t[1],ge=t[2],Re=n[0],qe=n[1],et=n[2],yt=e[0],Jt=e[1],fi=e[2];Math.abs(de-yt)<ox&&Math.abs(fe-Jt)<ox&&Math.abs(ge-fi)<ox?function h3(i){i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1}(i):(z=de-yt,$=fe-Jt,Q=ge-fi,r=qe*(Q*=te=1/Math.hypot(z,$,Q))-et*($*=te),l=et*(z*=te)-Re*Q,m=Re*$-qe*z,(te=Math.hypot(r,l,m))?(r*=te=1/te,l*=te,m*=te):(r=0,l=0,m=0),C=$*m-Q*l,A=Q*r-z*m,O=z*l-$*r,(te=Math.hypot(C,A,O))?(C*=te=1/te,A*=te,O*=te):(C=0,A=0,O=0),i[0]=r,i[1]=C,i[2]=z,i[3]=0,i[4]=l,i[5]=A,i[6]=$,i[7]=0,i[8]=m,i[9]=O,i[10]=Q,i[11]=0,i[12]=-(r*de+l*fe+m*ge),i[13]=-(C*de+A*fe+O*ge),i[14]=-(z*de+$*fe+Q*ge),i[15]=1)}(this,e,n,r),this.check()}ortho(t){const{left:e,right:n,bottom:r,top:l,near:m=C3,far:C=E3}=t;return function _5(i,t,e,n,r,l,m){var C=1/(t-e),A=1/(n-r),O=1/(l-m);i[0]=-2*C,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*A,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*O,i[11]=0,i[12]=(t+e)*C,i[13]=(r+n)*A,i[14]=(m+l)*O,i[15]=1}(this,e,n,r,l,m,C),this.check()}orthographic(t){const{fovy:e=jX,aspect:n=GX,focalDistance:r=1,near:l=C3,far:m=E3}=t;D5(e);const A=r*Math.tan(e/2),O=A*n;return this.ortho({left:-O,right:O,bottom:-A,top:A,near:l,far:m})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:r=.1,far:l=500}=t;return D5(e),function b3(i,t,e,n,r){var m,l=1/Math.tan(t/2);i[0]=l/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,null!=r&&r!==1/0?(i[10]=(r+n)*(m=1/(n-r)),i[14]=2*r*n*m):(i[10]=-1,i[14]=-2*n)}(this,e,n,r,l),this.check()}determinant(){return function p3(i){var t=i[0],e=i[1],n=i[2],r=i[3],l=i[4],m=i[5],C=i[6],A=i[7],O=i[8],z=i[9],$=i[10],Q=i[11],te=i[12],de=i[13],fe=i[14],ge=i[15];return(t*m-e*l)*($*ge-Q*fe)-(t*C-n*l)*(z*ge-Q*de)+(t*A-r*l)*(z*fe-$*de)+(e*C-n*m)*(O*ge-Q*te)-(e*A-r*m)*(O*fe-$*te)+(n*A-r*C)*(O*de-z*te)}(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0];const n=this.getScale(e=e||[-0,-0,-0]),r=1/n[0],l=1/n[1],m=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*l,t[2]=this[2]*m,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*l,t[6]=this[6]*m,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*l,t[10]=this[10]*m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0];const n=this.getScale(e=e||[-0,-0,-0]),r=1/n[0],l=1/n[1],m=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*l,t[2]=this[2]*m,t[3]=this[4]*r,t[4]=this[5]*l,t[5]=this[6]*m,t[6]=this[8]*r,t[7]=this[9]*l,t[8]=this[10]*m,t}transpose(){return function f3(i,t){if(i===t){var e=t[1],n=t[2],r=t[3],l=t[6],m=t[7],C=t[11];i[1]=t[4],i[2]=t[8],i[3]=t[12],i[4]=e,i[6]=t[9],i[7]=t[13],i[8]=n,i[9]=l,i[11]=t[14],i[12]=r,i[13]=m,i[14]=C}else i[0]=t[0],i[1]=t[4],i[2]=t[8],i[3]=t[12],i[4]=t[1],i[5]=t[5],i[6]=t[9],i[7]=t[13],i[8]=t[2],i[9]=t[6],i[10]=t[10],i[11]=t[14],i[12]=t[3],i[13]=t[7],i[14]=t[11],i[15]=t[15]}(this,this),this.check()}invert(){return iS(this,this),this.check()}multiplyLeft(t){return P_(this,t,this),this.check()}multiplyRight(t){return P_(this,this,t),this.check()}rotateX(t){return H1(this,this,t),this.check()}rotateY(t){return function hP(i,t,e){var n=Math.sin(e),r=Math.cos(e),l=t[0],m=t[1],C=t[2],A=t[3],O=t[8],z=t[9],$=t[10],Q=t[11];t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=l*r-O*n,i[1]=m*r-z*n,i[2]=C*r-$*n,i[3]=A*r-Q*n,i[8]=l*n+O*r,i[9]=m*n+z*r,i[10]=C*n+$*r,i[11]=A*n+Q*r}(this,this,t),this.check()}rotateZ(t){return ek(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return function g3(i,t,e,n){var A,O,z,$,Q,te,de,fe,ge,Re,qe,et,yt,Jt,fi,Hi,tn,cn,_n,Rr,to,Ts,ns,ph,r=n[0],l=n[1],m=n[2],C=Math.hypot(r,l,m);C<ox||(r*=C=1/C,l*=C,m*=C,A=Math.sin(e),O=Math.cos(e),Q=t[1],te=t[2],de=t[3],ge=t[5],Re=t[6],qe=t[7],yt=t[9],Jt=t[10],fi=t[11],_n=r*l*(z=1-O)-m*A,Rr=l*l*z+O,to=m*l*z+r*A,Ts=r*m*z+l*A,ns=l*m*z-r*A,ph=m*m*z+O,i[0]=($=t[0])*(Hi=r*r*z+O)+(fe=t[4])*(tn=l*r*z+m*A)+(et=t[8])*(cn=m*r*z-l*A),i[1]=Q*Hi+ge*tn+yt*cn,i[2]=te*Hi+Re*tn+Jt*cn,i[3]=de*Hi+qe*tn+fi*cn,i[4]=$*_n+fe*Rr+et*to,i[5]=Q*_n+ge*Rr+yt*to,i[6]=te*_n+Re*Rr+Jt*to,i[7]=de*_n+qe*Rr+fi*to,i[8]=$*Ts+fe*ns+et*ph,i[9]=Q*Ts+ge*ns+yt*ph,i[10]=te*Ts+Re*ns+Jt*ph,i[11]=de*Ts+qe*ns+fi*ph,t!==i&&(i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]))}(this,this,t,e),this.check()}scale(t){return uP(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return G1(this,this,t),this.check()}transform(t,e){return 4===t.length?(YT(e=nk(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let r;switch(n){case 2:r=ik(e||[-0,-0],t,this);break;case 3:r=QD(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return YT(r,t.length),r}transformAsVector(t,e){let n;switch(t.length){case 2:n=JD(e||[-0,-0],t,this);break;case 3:n=oP(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return YT(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let mP,pP;function D5(i){if(i>2*Math.PI)throw Error("expected radians")}function nS(i,t){const e=nk([],t,i);return function UX(i,t,e){i[0]=t[0]*e,i[1]=t[1]*e,i[2]=t[2]*e,i[3]=t[3]*e}(e,e,1/e[3]),e}function k5(i,t){const e=i%t;return e<0?t+e:e}function T3(i,t,e){return i<t?t:i>e?e:i}const S3=Math.log2||function YX(i){return Math.log(i)*Math.LOG2E};function Rb(i,t){if(!i)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const ag=Math.PI,I5=ag/4,Bm=ag/180,M3=180/ag,rS=512,gP=4003e4,_P=85.051129,ZX=1.5;function rk(i){const[t,e]=i;return Rb(Number.isFinite(t)),Rb(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude"),[rS*(t*Bm+ag)/(2*ag),rS*(ag+Math.log(Math.tan(I5+e*Bm*.5)))/(2*ag)]}function oS(i){const[t,e]=i,n=t/rS*(2*ag)-ag,r=2*(Math.atan(Math.exp(e/rS*(2*ag)-ag))-I5);return[n*M3,r*M3]}function vP(i){const t=Math.cos(i*Bm);return rS/gP/t}function A3(i){const{latitude:t,longitude:e,highPrecision:n=!1}=i;Rb(Number.isFinite(t)&&Number.isFinite(e));const r=rS,l=Math.cos(t*Bm),m=r/360,C=m/l,A=r/gP/l,O={unitsPerMeter:[A,A,A],metersPerUnit:[1/A,1/A,1/A],unitsPerDegree:[m,C,A],degreesPerUnit:[1/m,1/C,1/A]};if(n){const z=Bm*Math.tan(t*Bm)/l,Q=r/gP*z,te=Q/C*A;O.unitsPerDegree2=[0,m*z/2,Q],O.unitsPerMeter2=[te,0,te]}return O}function R5(i,t){const[e,n,r]=i,[l,m,C]=t,{unitsPerMeter:A,unitsPerMeter2:O}=A3({longitude:e,latitude:n,highPrecision:!0}),z=rk(i);z[0]+=l*(A[0]+O[0]*m),z[1]+=m*(A[1]+O[1]*m);const $=oS(z),Q=(r||0)+(C||0);return Number.isFinite(r)||Number.isFinite(C)?[$[0],$[1],Q]:$}function bP(i){return 2*Math.atan(.5/i)*M3}function O5(i){return.5/Math.tan(.5*i*Bm)}function L5(i,t){const[e,n,r=0]=i;return Rb(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(r)),nS(t,[e,n,r,1])}function D3(i,t,e=0){const[n,r,l]=i;if(Rb(Number.isFinite(n)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(l))return nS(t,[n,r,l,1]);const m=nS(t,[n,r,0,1]),C=nS(t,[n,r,1,1]),A=m[2],O=C[2];return Fo([],m,C,A===O?0:((e||0)-A)/(O-A))}const F5=Math.PI/180;function N5(i,t,e){const{pixelUnprojectionMatrix:n}=i,r=nS(n,[t,0,1,1]),l=nS(n,[t,i.height,1,1]),O=oS(Fo([],r,l,(e*i.distanceScales.unitsPerMeter[2]-r[2])/(l[2]-r[2])));return O.push(e),O}const Ro={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Ro,"IDENTITY",{get:()=>(so.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const O_={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},L_={common:0,meters:1,pixels:2},j5={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},o9=Math.PI/180,s9=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],G5=[0,0,0],a9={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class sS{constructor(t={}){ye(this,"id",void 0),ye(this,"x",void 0),ye(this,"y",void 0),ye(this,"width",void 0),ye(this,"height",void 0),ye(this,"padding",void 0),ye(this,"isGeospatial",void 0),ye(this,"zoom",void 0),ye(this,"focalDistance",void 0),ye(this,"position",void 0),ye(this,"modelMatrix",void 0),ye(this,"distanceScales",void 0),ye(this,"scale",void 0),ye(this,"center",void 0),ye(this,"cameraPosition",void 0),ye(this,"projectionMatrix",void 0),ye(this,"viewMatrix",void 0),ye(this,"viewMatrixUncentered",void 0),ye(this,"viewMatrixInverse",void 0),ye(this,"viewProjectionMatrix",void 0),ye(this,"pixelProjectionMatrix",void 0),ye(this,"pixelUnprojectionMatrix",void 0),ye(this,"resolution",void 0),ye(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||a9,this.focalDistance=t.focalDistance||1,this.position=t.position||G5,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?O_.WEB_MERCATOR:O_.WEB_MERCATOR_AUTO_OFFSET:O_.IDENTITY}equals(t){return t instanceof sS&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Ib(t.projectionMatrix,this.projectionMatrix)&&Ib(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const r=L5(this.projectPosition(t),this.pixelProjectionMatrix),[l,m]=r,C=e?m:this.height-m;return 2===t.length?[l,C]:[l,C,r[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,l,m]=t,O=D3([r,e?l:this.height-l,m],this.pixelUnprojectionMatrix,n&&n*this.distanceScales.unitsPerMeter[2]),[z,$,Q]=this.unprojectPosition(O);return Number.isFinite(m)?[z,$,Q]:Number.isFinite(n)?[z,$,n]:[z,$]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=rk(t);return e[1]=R_(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?oS(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),r=this.unproject([this.width,0],e),l=this.unproject([0,this.height],e),m=this.unproject([this.width,this.height],e);return[Math.min(n[0],r[0],l[0],m[0]),Math.min(n[1],r[1],l[1],m[1]),Math.max(n[0],r[0],l[0],m[0]),Math.max(n[1],r[1],l[1],m[1])]}getDistanceScales(t){return t?A3({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:r=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function lP(i){return{left:sx(i[3]+i[0],i[7]+i[4],i[11]+i[8],i[15]+i[12]),right:sx(i[3]-i[0],i[7]-i[4],i[11]-i[8],i[15]-i[12]),bottom:sx(i[3]+i[1],i[7]+i[5],i[11]+i[9],i[15]+i[13]),top:sx(i[3]-i[1],i[7]-i[5],i[11]-i[9],i[15]-i[13]),near:sx(i[3]+i[2],i[7]+i[6],i[11]+i[10],i[15]+i[14]),far:sx(i[3]-i[2],i[7]-i[6],i[11]-i[10],i[15]-i[14])}}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=function QX(i){const{latitude:t}=i;Rb(Number.isFinite(t));const e=Math.cos(t*Bm);return function KX(i){return S3(i)}(gP*e)-9}({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||A3({latitude:n,longitude:e}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:l,modelMatrix:m}=t;let C=G5;if(l&&(C=m?new sg(m).transformAsVector(l,[]):l),this.isGeospatial){const A=this.projectPosition([e,n,0]);this.center=new Nm(C).scale(this.distanceScales.unitsPerMeter).add(A)}else this.center=this.projectPosition(C)}_initMatrices(t){const{viewMatrix:e=s9,projectionMatrix:n=null,orthographic:r=!1,fovyRadians:l,fovy:m=75,near:C=.1,far:A=1e3,padding:O=null,focalDistance:z=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=(new sg).multiplyRight(e).translate(new Nm(this.center).negate()),this.projectionMatrix=n||function l9({width:i,height:t,orthographic:e,fovyRadians:n,focalDistance:r,padding:l,near:m,far:C}){const A=i/t,O=e?(new sg).orthographic({fovy:n,aspect:A,focalDistance:r,near:m,far:C}):(new sg).perspective({fovy:n,aspect:A,near:m,far:C});if(l){const{left:z=0,right:$=0,top:Q=0,bottom:te=0}=l,de=R_((z+i-$)/2,0,i)-i/2,fe=R_((Q+t-te)/2,0,t)-t/2;O[8]-=2*de/i,O[9]+=2*fe/t}return O}({width:this.width,height:this.height,orthographic:r,fovyRadians:l||m*o9,focalDistance:z,padding:O,near:C,far:A});const $=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];P_($,$,this.projectionMatrix),P_($,$,this.viewMatrix),this.viewProjectionMatrix=$,this.viewMatrixInverse=iS([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function aP(i){return[i[12],i[13],i[14]]}(this.viewMatrixInverse);const Q=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],te=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];uP(Q,Q,[this.width/2,-this.height/2,1]),G1(Q,Q,[1,-1,0]),P_(te,Q,this.viewProjectionMatrix),this.pixelProjectionMatrix=te,this.pixelUnprojectionMatrix=iS([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||so.warn("Pixel project matrix not invertible")()}}ye(sS,"displayName","Viewport");const ok="vs",I3="fs";function sf(i,t){if(!i)throw new Error(t||"shadertools: assertion failed.")}const R3={number:{validate:(i,t)=>Number.isFinite(i)&&(!("max"in t)||i<=t.max)&&(!("min"in t)||i>=t.min)},array:{validate:(i,t)=>Array.isArray(i)||ArrayBuffer.isView(i)}};function d9(i){let t=H5(i);return"object"===t?i?"type"in i?Object.assign({},i,R3[i.type]):"value"in i?(t=H5(i.value),Object.assign({type:t},i,R3[t])):{type:"object",value:i}:{type:"object",value:null}:Object.assign({type:t,value:i},R3[t])}function H5(i){return Array.isArray(i)||ArrayBuffer.isView(i)?"array":typeof i}class P3{constructor(t){let{name:e,vs:n,fs:r,dependencies:l=[],uniforms:m,getUniforms:C,deprecations:A=[],defines:O={},inject:z={},vertexShader:$,fragmentShader:Q}=t;sf("string"==typeof e),this.name=e,this.vs=n||$,this.fs=r||Q,this.getModuleUniforms=C,this.dependencies=l,this.deprecations=this._parseDeprecationDefinitions(A),this.defines=O,this.injections=function f9(i){const t={vs:{},fs:{}};for(const e in i){let n=i[e];"string"==typeof n&&(n={order:0,injection:n}),t[e.slice(0,2)][e]=n}return t}(z),m&&(this.uniforms=function c9(i){const t={};for(const e in i){const r=d9(i[e]);t[e]=r}return t}(m))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:sf(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(e,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach(n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())})}_parseDeprecationDefinitions(t){return t.forEach(e=>{e.regex="function"===e.type?new RegExp("\\b".concat(e.old,"\\(")):new RegExp("".concat(e.type," ").concat(e.old,";"))}),t}_defaultGetUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e={},n=this.uniforms;for(const r in n){const l=n[r];r in t&&!l.private?(l.validate&&sf(l.validate(t[r],l),"".concat(this.name,": invalid ").concat(r)),e[r]=t[r]):e[r]=l.value}return e}}function m9(i){return function $5(i){const t={},e={};return O3({modules:i,level:0,moduleMap:t,moduleDepth:e}),Object.keys(e).sort((n,r)=>e[r]-e[n]).map(n=>t[n])}(W5(i))}function O3(i){let{modules:t,level:e,moduleMap:n,moduleDepth:r}=i;if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const l of t)n[l.name]=l,(void 0===r[l.name]||r[l.name]<e)&&(r[l.name]=e);for(const l of t)l.dependencies&&O3({modules:l.dependencies,level:e+1,moduleMap:n,moduleDepth:r})}function W5(i,t){return i.map(e=>(e instanceof P3||(sf("string"!=typeof e,"Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),sf(e.name,"shader module has no name"),(e=new P3(e)).dependencies=W5(e.dependencies)),e))}const g9=7936,_9=7937,v9=7938,b9=35724,L3={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},$1={};function w9(i,t){return i.match(/NVIDIA/i)||t.match(/NVIDIA/i)?"NVIDIA":i.match(/INTEL/i)||t.match(/INTEL/i)?"INTEL":i.match(/AMD/i)||t.match(/AMD/i)||i.match(/ATI/i)||t.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(L3).forEach(i=>{$1[i]=i});const F3={};function X5(i,t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=L3[t];if(sf(n,t),!function p9(){const t=typeof window<"u"&&window.navigator||{},e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).userAgent||t.userAgent||"",n=-1!==e.indexOf("MSIE "),r=-1!==e.indexOf("Trident/");return n||r}(e))return!0;if(t in F3)return F3[t];const l=e.behavior||"enable",m="#extension GL_".concat(n[0]," : ").concat(l,"\nvoid main(void) {}"),C=i.createShader(35633);i.shaderSource(C,m),i.compileShader(C);const A=i.getShaderParameter(C,35713);return i.deleteShader(C),F3[t]=A,A}function yP(i,t){return(t=Array.isArray(t)?t:[t]).every(e=>function C9(i,t){const e=L3[t];sf(e,t);const n=function y9(i){return typeof WebGL2RenderingContext<"u"&&i instanceof WebGL2RenderingContext||!(!i||2!==i._version)}(i)&&e[1]||e[0],r="string"==typeof n?!!i.getExtension(n):n;return sf(!1===r||!0===r),r}(i,e))}const A9={[ok]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[I3]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},xP="__LUMA_INJECT_DECLARATIONS__",q5=/void\s+main\s*\([^)]*\)\s*\{\n?/,Y5=/}\n?[^{}]*$/,N3=[];function Z5(i,t,e){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=t===ok;for(const l in e){const m=e[l];m.sort((A,O)=>A.order-O.order),N3.length=m.length;for(let A=0,O=m.length;A<O;++A)N3[A]=m[A].injection;const C="".concat(N3.join("\n"),"\n");switch(l){case"vs:#decl":r&&(i=i.replace(xP,C));break;case"vs:#main-start":r&&(i=i.replace(q5,A=>A+C));break;case"vs:#main-end":r&&(i=i.replace(Y5,A=>C+A));break;case"fs:#decl":r||(i=i.replace(xP,C));break;case"fs:#main-start":r||(i=i.replace(q5,A=>A+C));break;case"fs:#main-end":r||(i=i.replace(Y5,A=>C+A));break;default:i=i.replace(l,A=>A+C)}}return i=i.replace(xP,""),n&&(i=i.replace(/\}\s*$/,l=>l+A9[t])),i}function B3(i){const t={};return sf(Array.isArray(i)&&i.length>1),i.forEach(e=>{for(const n in e)t[n]=t[n]?"".concat(t[n],"\n").concat(e[n]):e[n]}),t}function aS(i){return new RegExp("\\b".concat(i,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const K5=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],D9=[...K5,[aS("attribute"),"in $1"],[aS("varying"),"out $1"]],k9=[...K5,[aS("varying"),"in $1"]],Q5=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],I9=[...Q5,[aS("in"),"attribute $1"],[aS("out"),"varying $1"]],R9=[...Q5,[aS("in"),"varying $1"]],V3="gl_FragColor",z3=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,P9=/void\s+main\s*\([^)]*\)\s*\{\n?/;function wP(i,t){for(const[e,n]of t)i=i.replace(e,n);return i}const N9="\n\n".concat(xP,"\n\n"),J5={[ok]:"vertex",[I3]:"fragment"};function ej(i,t){let{id:e,source:n,type:r,modules:l,defines:m={},hookFunctions:C=[],inject:A={},transpileToGLSL100:O=!1,prologue:z=!0,log:$}=t;sf("string"==typeof n,"shader source must be a string");const Q=r===ok,te=n.split("\n");let de=100,fe="",ge=n;0===te[0].indexOf("#version ")?(de=300,fe=te[0],ge=te.slice(1).join("\n")):fe="#version ".concat(de);const Re={};l.forEach(Hi=>{Object.assign(Re,Hi.getDefines())}),Object.assign(Re,m);let qe=z?"".concat(fe,"\n").concat(function j9(i){let{id:t,source:e,type:n}=i;return t&&"string"==typeof t&&-1===e.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(t,"_").concat(J5[n],"\n\n"):""}({id:e,source:n,type:r}),"\n").concat(function U9(i){let{type:t}=i;return"\n#define SHADER_TYPE_".concat(J5[t].toUpperCase(),"\n")}({type:r}),"\n").concat(function E9(i){switch(function x9(i){const t=i.getExtension("WEBGL_debug_renderer_info"),e=i.getParameter(t&&t.UNMASKED_VENDOR_WEBGL||g9),n=i.getParameter(t&&t.UNMASKED_RENDERER_WEBGL||_9);return{gpuVendor:w9(e,n),vendor:e,renderer:n,version:i.getParameter(v9),shadingLanguageVersion:i.getParameter(b9)}}(i).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(i),"\n").concat(function T9(i){let n="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return yP(i,$1.GLSL_FRAG_DEPTH)&&(n+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),yP(i,$1.GLSL_DERIVATIVES)&&X5(i,$1.GLSL_DERIVATIVES)&&(n+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),yP(i,$1.GLSL_FRAG_DATA)&&X5(i,$1.GLSL_FRAG_DATA,{behavior:"require"})&&(n+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),yP(i,$1.GLSL_TEXTURE_LOD)&&(n+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),n}(i),"\n").concat(function G9(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=0,e="";for(const n in i){0===t&&(e+="\n// APPLICATION DEFINES\n"),t++;const r=i[n];(r||Number.isFinite(r))&&(e+="#define ".concat(n.toUpperCase()," ").concat(i[n],"\n"))}return 0===t&&(e+="\n"),e}(Re),"\n").concat(Q?"":"precision highp float;\n\n","\n"):"".concat(fe,"\n");const et=function $9(i){const t={vs:{},fs:{}};return i.forEach(e=>{let n;"string"!=typeof e?(n=e,e=n.hook):n={},e=e.trim();const[r,l]=e.split(":"),m=e.replace(/\(.+/,"");t[r][m]=Object.assign(n,{signature:l})}),t}(C),yt={},Jt={},fi={};for(const Hi in A){const tn="string"==typeof A[Hi]?{injection:A[Hi],order:0}:A[Hi],cn=Hi.match(/^(v|f)s:(#)?([\w-]+)$/);cn?cn[2]?"decl"===cn[3]?Jt[Hi]=[tn]:fi[Hi]=[tn]:yt[Hi]=[tn]:fi[Hi]=[tn]}for(const Hi of l){$&&Hi.checkDeprecations(ge,$),qe+=Hi.getModuleSource(r,de);const cn=Hi.injections[r];for(const _n in cn){const Rr=_n.match(/^(v|f)s:#([\w-]+)$/);if(Rr){const Ts="decl"===Rr[2]?Jt:fi;Ts[_n]=Ts[_n]||[],Ts[_n].push(cn[_n])}else yt[_n]=yt[_n]||[],yt[_n].push(cn[_n])}}return qe+=N9,qe=Z5(qe,r,Jt),qe+=function H9(i,t){let e="";for(const n in i){const r=i[n];if(e+="void ".concat(r.signature," {\n"),r.header&&(e+="  ".concat(r.header)),t[n]){const l=t[n];l.sort((m,C)=>m.order-C.order);for(const m of l)e+="  ".concat(m.injection,"\n")}r.footer&&(e+="  ".concat(r.footer)),e+="}\n"}return e}(et[r],yt),qe+=ge,qe=Z5(qe,r,fi),qe=function O9(i,t,e){switch(t){case 300:return e?wP(i,D9):function L9(i){const t=(i=wP(i,k9)).match(z3);if(t){const e=t[1];i=i.replace(new RegExp("\\b".concat(V3,"\\b"),"g"),e)}else{const e="fragmentColor";i=i.replace(P9,n=>"out vec4 ".concat(e,";\n").concat(n)).replace(new RegExp("\\b".concat(V3,"\\b"),"g"),e)}return i}(i);case 100:return e?wP(i,I9):function F9(i){const t=(i=wP(i,R9)).match(z3);if(t){const e=t[1];i=i.replace(z3,"").replace(new RegExp("\\b".concat(e,"\\b"),"g"),V3)}return i}(i);default:throw new Error("unknown GLSL version ".concat(t))}}(qe,O?100:de,Q),qe}function z9(i){return function(e){const n={};for(const r of i){const l=r.getUniforms(e,n);Object.assign(n,l)}return n}}const sk="8.5.21",W1=new class X9{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new _D({id:t})),this.stats.get(t)}};if(globalThis.luma&&globalThis.luma.VERSION!==sk)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(sk));function Cn(i,t){if(!i)throw new Error(t||"luma.gl: assertion failed.")}function U3(i,t){if("string"!=typeof t)return t;const e=Number(t);if(!isNaN(e))return e;const n=i[t=t.replace(/^.*\./,"")];return Cn(void 0!==n,"Accessing undefined constant GL.".concat(t)),n}function lx(i,t){t=Number(t);for(const e in i)if(i[e]===t)return"GL.".concat(e);return String(t)}globalThis.luma||(Jh()&&lr.log(1,"luma.gl ".concat(sk," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:sk,version:sk,log:lr,stats:W1,globals:{modules:{},nodeIO:{}}}),globalThis;const j3={};function F_(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";j3[i]=j3[i]||1;const t=j3[i]++;return"".concat(i,"-").concat(t)}function tj(i){return Cn("number"==typeof i,"Input must be a number"),i&&!(i&i-1)}function lS(i){let t=!0;for(const e in i){t=!1;break}return t}function ij(i,t,e,n){const r="See luma.gl ".concat(e," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),l=Object.getPrototypeOf(i);n.forEach(m=>{l.methodName||(l[m]=()=>{throw lr.removed("Calling removed method ".concat(t,".").concat(m,": "),r)(),new Error(m)})})}const cS="Resource subclass must define virtual methods";class Pb{get[Symbol.toStringTag](){return"Resource"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};X0(t);const{id:n,userData:r={}}=e;this.gl=t,this.gl2=t,this.id=n||F_(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach(n=>n.delete()),this}bind(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof t?(this._bindHandle(t),this):(this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e)}unbind(){this.bind(null)}getParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Cn(t=U3(this.gl,t));const r=(this.constructor.PARAMETERS||{})[t];if(r){const l=go(this.gl);if("webgl2"in r&&!l||"extension"in r&&!this.gl.getExtension(r.extension))return l&&"webgl2"in r?r.webgl2:r.webgl1}return this._getParameter(t,e)}getParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:e,keys:n}=t,r=this.constructor.PARAMETERS||{},l=go(this.gl),m={},C=e||Object.keys(r);for(const A of C){const O=r[A];if(O&&(!("webgl2"in O)||l)&&(!("extension"in O)||this.gl.getExtension(O.extension))){const $=n?lx(this.gl,A):A;m[$]=this.getParameter(A,t),n&&"GLenum"===O.type&&(m[$]=lx(this.gl,m[$]))}}return m}setParameter(t,e){Cn(t=U3(this.gl,t));const r=(this.constructor.PARAMETERS||{})[t];if(r){const l=go(this.gl);if("webgl2"in r&&!l||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(e=U3(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return ij(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(cS)}_deleteHandle(){throw new Error(cS)}_bindHandle(t){throw new Error(cS)}_getOptsFromHandle(){throw new Error(cS)}_getParameter(t,e){throw new Error(cS)}_setParameter(t,e){throw new Error(cS)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this[Symbol.toStringTag],e=W1.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this[Symbol.toStringTag];W1.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(t,e),this._trackAllocatedMemoryForContext(t,e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=t}_trackAllocatedMemoryForContext(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];const r=W1.get("Memory Usage".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:""));r.get("GPU Memory").addCount(t),r.get("".concat(e," Memory")).addCount(t)}_trackDeallocatedMemory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(t),this._trackDeallocatedMemoryForContext(t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];const n=W1.get("Memory Usage".concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:""));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(t," Memory")).subtractCount(this.byteLength)}}const q9="Failed to deduce GL constant from typed array";function G3(i){switch(ArrayBuffer.isView(i)?i.constructor:i){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(q9)}}function ak(i){let{clamped:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(i){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Z9(i){let{data:t,width:e,height:n}=i;const r=Math.round(e/2),l=Math.round(n/2),m=new Uint8Array(r*l*4);for(let C=0;C<l;C++)for(let A=0;A<r;A++)for(let O=0;O<4;O++)m[4*(C*r+A)+O]=t[4*(2*C*e+2*A)+O];return{data:m,width:r,height:l}}function H3(i,t,e){const{removedProps:n={},deprecatedProps:r={},replacedProps:l={}}=e;for(const C in n)if(C in t){const O=n[C]?"".concat(i,".").concat(n[C]):"N/A";lr.removed("".concat(i,".").concat(C),O)()}for(const C in r)if(C in t){const A=r[C];lr.deprecated("".concat(i,".").concat(C),"".concat(i,".").concat(A))()}let m=null;for(const C in l)if(C in t){const A=l[C];lr.deprecated("".concat(i,".").concat(C),"".concat(i,".").concat(A))(),m=m||Object.assign({},t),m[A]=t[C],delete m[C]}return m||t}const K9={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Q9={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class af{static getBytesPerElement(t){return ak(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return Cn(t.size),ak(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new af(K9,...e)}constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return af.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return af.getBytesPerVertex(this)}_assign(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=H3("Accessor",t,Q9),void 0!==t.type&&(this.type=t.type,(5124===t.type||5125===t.type)&&(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&(this.index="boolean"==typeof t.index?t.index?1:0:t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}const rj={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},J9={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:rj},eq={removedProps:rj};class is extends Pb{get[Symbol.toStringTag](){return"Buffer"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(){return Math.round(this.byteLength/af.getBytesPerElement(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}getVertexCount(){return Math.round(this.byteLength/af.getBytesPerVertex(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=H3("Buffer",t,J9),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=H3("Buffer",t,eq))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new af(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:r=0}=t,l=t.byteLength||t.length;Cn(e);const m=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(m,this.handle),0!==r||void 0!==l?(Ac(this.gl),this.gl.bufferSubData(this.target,n,e,r,l)):this.gl.bufferSubData(m,n,e),this.gl.bindBuffer(m,null),this.debugData=null,this._inferType(e),this}copyData(t){let{sourceBuffer:e,readOffset:n=0,writeOffset:r=0,size:l}=t;const{gl:m}=this;return Ac(m),m.bindBuffer(36662,e.handle),m.bindBuffer(36663,this.handle),m.copyBufferSubData(36662,36663,n,r,l),m.bindBuffer(36662,null),m.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ac(this.gl);const l=ak(this.accessor.type||5126,{clamped:!1}),m=this._getAvailableElementCount(e),C=n;let A,O;t?(O=t.length,A=O-C):(A=Math.min(m,r||m),O=C+A);const z=Math.min(m,A);return r=r||z,Cn(r<=z),t=t||new l(O),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,r),this.gl.bindBuffer(36662,null),t}bind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?void 0!==r?this.gl.bindBufferRange(t,e,this.handle,n,r):(Cn(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength+e;Cn(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,e,t),this.gl.bindBuffer(r,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const l=G3(t);return Cn(l),this.setAccessor(new af(this.accessor,{type:l})),this}_setByteLength(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Cn(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const n=t/ak(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-n}_inferType(t){this.accessor.type||this.setAccessor(new af(this.accessor,{type:G3(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return lr.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return lr.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return lr.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return lr.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new af(this.accessor,t),this}}const $3={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},oj={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},sj={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},nq=[9729,9728],aj=globalThis.WebGLBuffer||function(){};class dS extends Pb{get[Symbol.toStringTag](){return"Texture"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:n,linearFiltering:r}=e;let l=!0;return n&&(l=l&&function tq(i,t){const e=$3[t];if(!e)return!1;if(void 0===e.gl1&&void 0===e.gl2)return!0;const n=go(i)&&e.gl2||e.gl1;return"string"==typeof n?i.getExtension(n):n}(t,n),l=l&&(!r||function iq(i,t){const e=$3[t];switch(e&&e.types[0]){case 5126:return i.getExtension("OES_texture_float_linear");case 5131:return i.getExtension("OES_texture_half_float_linear");default:return!0}}(t,n))),l}constructor(t,e){const{id:n=F_("texture"),handle:r,target:l}=e;super(t,{id:n,handle:r}),this.target=l,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data;if(e instanceof Promise)return e.then(qe=>this.initialize(Object.assign({},t,{pixels:qe,data:qe}))),this;const n=typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",()=>this.initialize(t)),this;const{pixels:r=null,format:l=6408,border:m=0,recreate:C=!1,parameters:A={},pixelStore:O={},textureUnit:z}=t;e||(e=r);let{width:$,height:Q,dataFormat:te,type:de,compressed:fe=!1,mipmaps:ge=!0}=t;const{depth:Re=0}=t;return({width:$,height:Q,compressed:fe,dataFormat:te,type:de}=this._deduceParameters({format:l,type:de,dataFormat:te,compressed:fe,data:e,width:$,height:Q})),this.width=$,this.height=Q,this.depth=Re,this.format=l,this.type=de,this.dataFormat=te,this.border=m,this.textureUnit=z,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),ge&&this._isNPOT()&&(lr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),ge=!1,this._updateForNPOT(A)),this.mipmaps=ge,this.setImageData({data:e,width:$,height:Q,depth:Re,format:l,type:de,dataFormat:te,border:m,mipmaps:ge,parameters:O,compressed:fe}),ge&&this.generateMipmap(),this.setParameters(A),C&&(this.data=e),n&&(this._video={video:e,parameters:A,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:n,mipmaps:r=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(lr.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Nl(this.gl,t,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:r=0,format:l=this.format,border:m=this.border,offset:C=0,parameters:A={}}=t;let{data:O=null,type:z=this.type,width:$=this.width,height:Q=this.height,dataFormat:te=this.dataFormat,compressed:de=!1}=t;O||(O=n),({type:z,dataFormat:te,compressed:de,width:$,height:Q}=this._deduceParameters({format:l,type:z,dataFormat:te,compressed:de,data:O,width:$,height:Q}));const{gl:fe}=this;fe.bindTexture(this.target,this.handle);let ge=null;({data:O,dataType:ge}=this._getDataType({data:O,compressed:de}));let Re,qe=0;return Nl(this.gl,A,()=>{switch(ge){case"null":fe.texImage2D(e,r,l,$,Q,m,te,z,O);break;case"typed-array":fe.texImage2D(e,r,l,$,Q,m,te,z,O,C);break;case"buffer":Re=Ac(fe),Re.bindBuffer(35052,O.handle||O),Re.texImage2D(e,r,l,$,Q,m,te,z,C),Re.bindBuffer(35052,null);break;case"browser-object":go(fe)?fe.texImage2D(e,r,l,$,Q,m,te,z,O):fe.texImage2D(e,r,l,te,z,O);break;case"compressed":for(const[et,yt]of O.entries())fe.compressedTexImage2D(e,et,yt.format,yt.width,yt.height,m,yt.data),qe+=yt.levelSize;break;default:Cn(!1,"Unknown image data type")}}),this._trackAllocatedMemory("compressed"===ge?qe:O&&O.byteLength?O.byteLength:this.width*this.height*(oj[this.dataFormat]||4)*(sj[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData(t){let{target:e=this.target,pixels:n=null,data:r=null,x:l=0,y:m=0,width:C=this.width,height:A=this.height,level:O=0,format:z=this.format,type:$=this.type,dataFormat:Q=this.dataFormat,compressed:te=!1,offset:de=0,border:fe=this.border,parameters:ge={}}=t;if(({type:$,dataFormat:Q,compressed:te,width:C,height:A}=this._deduceParameters({format:z,type:$,dataFormat:Q,compressed:te,data:r,width:C,height:A})),Cn(0===this.depth,"texSubImage not supported for 3D textures"),r||(r=n),r&&r.data){const Re=r;r=Re.data,C=Re.shape[0],A=Re.shape[1]}r instanceof is&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),Nl(this.gl,ge,()=>{if(te)this.gl.compressedTexSubImage2D(e,O,l,m,C,A,z,r);else if(null===r)this.gl.texSubImage2D(e,O,l,m,C,A,Q,$,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(e,O,l,m,C,A,Q,$,r,de);else if(r instanceof aj){const Re=Ac(this.gl);Re.bindBuffer(35052,r),Re.texSubImage2D(e,O,l,m,C,A,Q,$,de),Re.bindBuffer(35052,null)}else go(this.gl)?Ac(this.gl).texSubImage2D(e,O,l,m,C,A,Q,$,r):this.gl.texSubImage2D(e,O,l,m,Q,$,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return lr.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:n=!1}=t;return n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof is?{data:e.handle,dataType:"buffer"}:e instanceof aj?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:r,height:l,dataFormat:m,type:C,compressed:A}=t;const O=$3[e];return m=m||O&&O.dataFormat,C=C||O&&O.types[0],A=A||O&&O.compressed,({width:r,height:l}=this._deduceImageSize(n,r,l)),{dataFormat:m,type:C,compressed:A,width:r,height:l,format:e,data:n}}_deduceImageSize(t,e,n){let r;return r=typeof ImageData<"u"&&t instanceof ImageData?{width:t.width,height:t.height}:typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?{width:t.width,height:t.height}:typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},Cn(r,"Could not deduced texture size"),Cn(void 0===e||r.width===e,"Deduced texture width does not match supplied width"),Cn(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:Cn(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(go(this.gl)||!this.width||!this.height||tj(this.width)&&tj(this.height))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===nq.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}function rq(i,t){return Cn("string"==typeof i),i=""+i,new Promise((e,n)=>{try{const r=new Image;r.onload=()=>e(r),r.onerror=()=>n(new Error("Could not load image ".concat(i,"."))),r.crossOrigin=t&&t.crossOrigin||"anonymous",r.src=i}catch(r){n(r)}})}class vu extends dS{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(t,e){return dS.isSupported(t,e)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};X0(t),(e instanceof Promise||"string"==typeof e)&&(e={data:e}),"string"==typeof e.data&&(e=Object.assign({},e,{data:rq(e.data)})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const X1="EXT_color_buffer_float",lj={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:X1,bpp:2},33327:{gl2:X1,bpp:4},34842:{gl2:X1,bpp:8},33326:{gl2:X1,bpp:4},33328:{gl2:X1,bpp:8},34836:{gl2:X1,bpp:16},35898:{gl2:X1,bpp:4}};class uS extends Pb{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(t){let{format:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!e||function oq(i,t,e){const n=e[t];if(!n)return!1;const r=go(i)&&n.gl2||n.gl1;return"string"==typeof r?i.getExtension(r):r}(t,e,lj)}static getSamplesForFormat(t,e){let{format:n}=e;return t.getInternalformatParameter(36161,n,32937)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.initialize(e),Object.seal(this)}initialize(t){let{format:e,width:n=1,height:r=1,samples:l=0}=t;return Cn(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==l&&go(this.gl)?this.gl.renderbufferStorageMultisample(36161,l,e,n,r):this.gl.renderbufferStorage(36161,e,n,r),this.format=e,this.width=n,this.height=r,this.samples=l,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*lj[this.format].bpp),this}resize(t){let{width:e,height:n}=t;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}const cj=6144,fj="clear: bad arguments";function X3(i){let{framebuffer:t=null,color:e=null,depth:n=null,stencil:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const l={};t&&(l.framebuffer=t);let m=0;e&&(m|=16384,!0!==e&&(l.clearColor=e)),n&&(m|=256,!0!==n&&(l.clearDepth=n)),r&&(m|=1024,!0!==n&&(l.clearStencil=n)),Cn(0!==m,fj),Nl(i,l,()=>{i.clear(m)})}function mj(i){switch(i){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Cn(!1),0}}const q3=[34069,34070,34071,34072,34073,34074];let uq=(()=>{class i extends dS{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};X0(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:l=0,y:m=0,mipmapLevel:C=0}=e;return this._subImage({target:n,data:r,x:l,y:m,mipmapLevel:C})}setCubeMapImageData(e){var n=this;return(0,Yt.A)(function*(){let{width:r,height:l,pixels:m,data:C,border:A=0,format:O=6408,type:z=5121}=e;const{gl:$}=n,Q=m||C,te=yield Promise.all(q3.map(de=>{const fe=Q[de];return Promise.all(Array.isArray(fe)?fe:[fe])}));n.bind(),q3.forEach((de,fe)=>{te[fe].length>1&&!1!==n.opts.mipmaps&&lr.warn("".concat(n.id," has mipmap and multiple LODs."))(),te[fe].forEach((ge,Re)=>{r&&l?$.texImage2D(de,Re,O,r,l,A,O,z,ge):$.texImage2D(de,Re,O,O,z,ge)})}),n.unbind()})()}setImageDataForFace(e){const{face:n,width:r,height:l,pixels:m,data:C,border:A=0,format:O=6408,type:z=5121}=e,{gl:$}=this,Q=m||C;return this.bind(),Q instanceof Promise?Q.then(te=>this.setImageDataForFace(Object.assign({},e,{face:n,data:te,pixels:te}))):this.width||this.height?$.texImage2D(n,0,O,r,l,A,O,z,Q):$.texImage2D(n,0,O,O,z,Q),this}}return i.FACES=q3,i})();class hq extends dS{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(t){return go(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ac(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData(t){let{level:e=0,dataFormat:n=6408,width:r,height:l,depth:m=1,border:C=0,format:A,type:O=5121,offset:z=0,data:$,parameters:Q={}}=t;return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Nl(this.gl,Q,()=>{ArrayBuffer.isView($)&&this.gl.texImage3D(this.target,e,n,r,l,m,C,A,O,$),$ instanceof is&&(this.gl.bindBuffer(35052,$.handle),this.gl.texImage3D(this.target,e,n,r,l,m,C,A,O,z))}),this._trackAllocatedMemory($&&$.byteLength?$.byteLength:this.width*this.height*this.depth*(oj[this.dataFormat]||4)*(sj[this.type]||1),"Texture"),this.loaded=!0,this}}function mq(i,t){const{gl:e,width:n,height:r,id:l}=i;return new zl(e,Object.assign({},t,{id:"framebuffer-for-".concat(l),width:n,height:r,attachments:{36064:i}}))}function CP(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:e=0,sourceY:n=0,sourceFormat:r=6408}=t;let{sourceAttachment:l=36064,target:m=null,sourceWidth:C,sourceHeight:A,sourceType:O}=t;const{framebuffer:z,deleteFramebuffer:$}=lk(i);Cn(z);const{gl:Q,handle:te,attachments:de}=z;C=C||z.width,A=A||z.height,36064===l&&null===te&&(l=1028),Cn(de[l]),O=O||de[l].type,m=function pq(i,t,e,n,r){if(i)return i;return new(ak(t=t||5121,{clamped:!1}))(n*r*mj(e))}(m,O,r,C,A),O=O||G3(m);const fe=Q.bindFramebuffer(36160,te);return Q.readPixels(e,n,C,A,r,O,m),Q.bindFramebuffer(36160,fe||null),$&&z.delete(),m}function EP(i,t){let{sourceX:e=0,sourceY:n=0,sourceFormat:r=6408,target:l=null,targetByteOffset:m=0,sourceWidth:C,sourceHeight:A,sourceType:O}=t;const{framebuffer:z,deleteFramebuffer:$}=lk(i);Cn(z),C=C||z.width,A=A||z.height;const Q=Ac(z.gl);if(O=O||(l?l.type:5121),!l){const te=mj(r),de=function dq(i){switch(i){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Cn(!1),0}}(O);l=new is(Q,{byteLength:m+C*A*te*de,accessor:{type:O,size:te}})}return l.bind({target:35051}),Nl(Q,{framebuffer:z},()=>{Q.readPixels(e,n,C,A,r,O,m)}),l.unbind({target:35051}),$&&z.delete(),l}function Y3(i){let{sourceAttachment:t=36064,targetMaxHeight:e=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=CP(i,{sourceAttachment:t}),{width:r,height:l}=i;for(;l>e;)({data:n,width:r,height:l}=Z9({data:n,width:r,height:l}));!function Y9(i){let{data:t,width:e,height:n,bytesPerPixel:r=4,temp:l}=i;const m=e*r;l=l||new Uint8Array(m);for(let C=0;C<n/2;++C){const A=C*m,O=(n-C-1)*m;l.set(t.subarray(A,A+m)),t.copyWithin(A,O,O+m),t.set(l,O)}}({data:n,width:r,height:l});const m=document.createElement("canvas");m.width=r,m.height=l;const C=m.getContext("2d"),A=C.createImageData(r,l);return A.data.set(n),C.putImageData(A,0,0),m.toDataURL()}function lk(i){return i instanceof zl?{framebuffer:i,deleteFramebuffer:!1}:{framebuffer:mq(i),deleteFramebuffer:!0}}const Po_WEBGL2="WEBGL2",Po_VERTEX_ARRAY_OBJECT="VERTEX_ARRAY_OBJECT",Po_TIMER_QUERY="TIMER_QUERY",Po_INSTANCED_RENDERING="INSTANCED_RENDERING",Po_MULTIPLE_RENDER_TARGETS="MULTIPLE_RENDER_TARGETS",Po_ELEMENT_INDEX_UINT32="ELEMENT_INDEX_UINT32",Po_BLEND_EQUATION_MINMAX="BLEND_EQUATION_MINMAX",Po_FLOAT_BLEND="FLOAT_BLEND",Po_COLOR_ENCODING_SRGB="COLOR_ENCODING_SRGB",Po_TEXTURE_DEPTH="TEXTURE_DEPTH",Po_TEXTURE_FLOAT="TEXTURE_FLOAT",Po_TEXTURE_HALF_FLOAT="TEXTURE_HALF_FLOAT",Po_TEXTURE_FILTER_LINEAR_FLOAT="TEXTURE_FILTER_LINEAR_FLOAT",Po_TEXTURE_FILTER_LINEAR_HALF_FLOAT="TEXTURE_FILTER_LINEAR_HALF_FLOAT",Po_TEXTURE_FILTER_ANISOTROPIC="TEXTURE_FILTER_ANISOTROPIC",Po_COLOR_ATTACHMENT_RGBA32F="COLOR_ATTACHMENT_RGBA32F",Po_COLOR_ATTACHMENT_FLOAT="COLOR_ATTACHMENT_FLOAT",Po_COLOR_ATTACHMENT_HALF_FLOAT="COLOR_ATTACHMENT_HALF_FLOAT",Po_GLSL_FRAG_DATA="GLSL_FRAG_DATA",Po_GLSL_FRAG_DEPTH="GLSL_FRAG_DEPTH",Po_GLSL_DERIVATIVES="GLSL_DERIVATIVES",Po_GLSL_TEXTURE_LOD="GLSL_TEXTURE_LOD",pj={[Po_WEBGL2]:[!1,!0],[Po_VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Po_TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Po_INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Po_MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Po_ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Po_BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Po_FLOAT_BLEND]:["EXT_float_blend"],[Po_COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Po_TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Po_TEXTURE_FLOAT]:["OES_texture_float",!0],[Po_TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Po_TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Po_TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Po_TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Po_COLOR_ATTACHMENT_RGBA32F]:[function gq(i){const t=new vu(i,{format:6408,type:5126,dataFormat:6408}),e=new zl(i,{id:"test-framebuffer",check:!1,attachments:{36064:t}}),n=e.getStatus();return t.delete(),e.delete(),36053===n},"EXT_color_buffer_float"],[Po_COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Po_COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Po_GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Po_GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Po_GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Po_GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},_q=2;function gj(i,t){return q1(i,t)}function q1(i,t){return(t=Array.isArray(t)?t:[t]).every(e=>_j(i,e))}function _j(i,t){return i.luma=i.luma||{},i.luma.caps=i.luma.caps||{},void 0===i.luma.caps[t]&&(i.luma.caps[t]=function bq(i,t){const e=pj[t];let n;Cn(e,t);const r=go(i)&&e[1]||e[0];if("function"==typeof r)n=r(i);else if(Array.isArray(r)){n=!0;for(const l of r)n=n&&!!i.getExtension(l)}else"string"==typeof r?n=!!i.getExtension(r):"boolean"==typeof r?n=r:Cn(!1);return n}(i,t)),i.luma.caps[t]||lr.log(_q,"Feature: ".concat(t," not supported"))(),i.luma.caps[t]}const vj="Multiple render targets not supported";class zl extends Pb{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:r}=e;let l=!0;return n&&(l=!!(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),r&&(l=l&&!(!t.getExtension("EXT_color_buffer_float")&&!t.getExtension("EXT_color_buffer_half_float"))),l}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new zl(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=Ac(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=Ac(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(t){let{width:e=1,height:n=1,attachments:r=null,color:l=!0,depth:m=!0,stencil:C=!1,check:A=!0,readBuffer:O,drawBuffers:z}=t;if(Cn(e>=0&&n>=0,"Width and height need to be integers"),this.width=e,this.height=n,r)for(const $ in r){const Q=r[$];(Array.isArray(Q)?Q[0]:Q).resize({width:e,height:n})}else r=this._createDefaultAttachments(l,m,C,e,n);this.update({clearAttachments:!0,attachments:r,readBuffer:O,drawBuffers:z}),r&&A&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update(t){let{attachments:e={},readBuffer:n,drawBuffers:r,clearAttachments:l=!1,resizeAttachments:m=!0}=t;this.attach(e,{clearAttachments:l,resizeAttachments:m});const{gl:C}=this,A=C.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),r&&this._setDrawBuffers(r),C.bindFramebuffer(36160,A||null),this}resize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:e,height:n}=t;if(null===this.handle)return Cn(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&lr.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const r in this.attachments)this.attachments[r].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t){let{clearAttachments:e=!1,resizeAttachments:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={};e&&Object.keys(this.attachments).forEach(m=>{r[m]=null}),Object.assign(r,t);const l=this.gl.bindFramebuffer(36160,this.handle);for(const m in r){Cn(void 0!==m,"Misspelled framebuffer binding point?");const C=Number(m),A=r[C];let O=A;if(O)if(O instanceof uS)this._attachRenderbuffer({attachment:C,renderbuffer:O});else if(Array.isArray(A)){const[z,$=0,Q=0]=A;O=z,this._attachTexture({attachment:C,texture:z,layer:$,level:Q})}else this._attachTexture({attachment:C,texture:O,layer:0,level:0});else this._unattach(C);n&&O&&O.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,l||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter(m=>!this.attachments[m]).forEach(m=>{delete this.attachments[m]})}checkStatus(){const e=this.getStatus();if(36053!==e)throw new Error(function xq(i){return(zl.STATUS||{})[i]||"Framebuffer error ".concat(i)}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,depth:n,stencil:r,drawBuffers:l=[]}=t,m=this.gl.bindFramebuffer(36160,this.handle);return(e||n||r)&&X3(this.gl,{color:e,depth:n,stencil:r}),l.forEach((C,A)=>{!function cq(i){let{framebuffer:t=null,buffer:e=cj,drawBuffer:n=0,value:r=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ac(i),Nl(i,{framebuffer:t},()=>{switch(e){case cj:switch(r.constructor){case Int32Array:i.clearBufferiv(e,n,r);break;case Uint32Array:i.clearBufferuiv(e,n,r);break;case Float32Array:default:i.clearBufferfv(e,n,r)}break;case 6145:i.clearBufferfv(6145,0,[r]);break;case 6146:i.clearBufferiv(6146,0,[r]);break;case 34041:const[l,m]=r;i.clearBufferfi(34041,0,l,m);break;default:Cn(!1,fj)}})}(this.gl,{drawBuffer:A,value:C})}),this.gl.bindFramebuffer(36160,m||null),this}readPixels(){return lr.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return lr.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return lr.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return lr.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return lr.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return lr.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:e=[],x:n=0,y:r=0,width:l,height:m}=t;const C=Ac(this.gl),A=C.bindFramebuffer(36008,this.handle);return 0===n&&0===r&&void 0===l&&void 0===m?C.invalidateFramebuffer(36008,e):C.invalidateFramebuffer(36008,e,n,r,l,m),C.bindFramebuffer(36008,A),this}getAttachmentParameter(t,e,n){let r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=lx(this.gl,r)),r}getAttachmentParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const l of n)r[e?lx(this.gl,l):l]=this.getAttachmentParameter(t,l,e);return r}getParameters(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=Object.keys(this.attachments),n={};for(const r of e){const l=Number(r);n[t?lx(this.gl,l):l]=this.getAttachmentParameters(l,t)}return n}show(){return typeof window<"u"&&window.open(Y3(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>lr.level||typeof window>"u")return this;e=e||"Framebuffer ".concat(this.id);const n=Y3(this,{targetMaxHeight:100});return lr.image({logLevel:t,message:e,image:n},e)(),this}bind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,this.handle),this}unbind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,r,l){let m=null;return t&&(m=m||{},m[36064]=new vu(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:l,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(m[36064])),e&&n?(m=m||{},m[33306]=new uS(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(m[33306])):e?(m=m||{},m[36096]=new uS(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:l}),this.ownResources.push(m[36096])):n&&Cn(!1),m}_unattach(t){const e=this.attachments[t];e&&(e instanceof uS?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer(t){let{attachment:e=36064,renderbuffer:n}=t;const{gl:r}=this;r.framebufferRenderbuffer(36160,e,36161,n.handle),this.attachments[e]=n}_attachTexture(t){let{attachment:e=36064,texture:n,layer:r,level:l}=t;const{gl:m}=this;switch(m.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:Ac(m).framebufferTextureLayer(36160,e,n.target,l,r);break;case 34067:const A=function yq(i){return i<34069?i+34069:i}(r);m.framebufferTexture2D(36160,e,A,n.handle,l);break;case 3553:m.framebufferTexture2D(36160,e,3553,n.handle,l);break;default:Cn(!1,"Illegal texture type")}m.bindTexture(n.target,null),this.attachments[e]=n}_setReadBuffer(t){const e=function TF(i){return go(i)?i:null}(this.gl);e?e.readBuffer(t):Cn(36064===t||1029===t,vj),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=Ac(e);if(n)n.drawBuffers(t);else{const r=e.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(t):Cn(1===t.length&&(36064===t[0]||1029===t[0]),vj)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=function vq(i){i.luma=i.luma||{},i.luma.caps=i.luma.caps||{};for(const t in pj)void 0===i.luma.caps[t]&&(i.luma.caps[t]=_j(i,t));return i.luma.caps}(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}zl.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Cq={5126:_a.bind(null,"uniform1fv",lf,1,Vd),35664:_a.bind(null,"uniform2fv",lf,2,Vd),35665:_a.bind(null,"uniform3fv",lf,3,Vd),35666:_a.bind(null,"uniform4fv",lf,4,Vd),5124:_a.bind(null,"uniform1iv",cx,1,Vd),35667:_a.bind(null,"uniform2iv",cx,2,Vd),35668:_a.bind(null,"uniform3iv",cx,3,Vd),35669:_a.bind(null,"uniform4iv",cx,4,Vd),35670:_a.bind(null,"uniform1iv",cx,1,Vd),35671:_a.bind(null,"uniform2iv",cx,2,Vd),35672:_a.bind(null,"uniform3iv",cx,3,Vd),35673:_a.bind(null,"uniform4iv",cx,4,Vd),35674:_a.bind(null,"uniformMatrix2fv",lf,4,Ob),35675:_a.bind(null,"uniformMatrix3fv",lf,9,Ob),35676:_a.bind(null,"uniformMatrix4fv",lf,16,Ob),35678:Jc,35680:Jc,5125:_a.bind(null,"uniform1uiv",TP,1,Vd),36294:_a.bind(null,"uniform2uiv",TP,2,Vd),36295:_a.bind(null,"uniform3uiv",TP,3,Vd),36296:_a.bind(null,"uniform4uiv",TP,4,Vd),35685:_a.bind(null,"uniformMatrix2x3fv",lf,6,Ob),35686:_a.bind(null,"uniformMatrix2x4fv",lf,8,Ob),35687:_a.bind(null,"uniformMatrix3x2fv",lf,6,Ob),35688:_a.bind(null,"uniformMatrix3x4fv",lf,12,Ob),35689:_a.bind(null,"uniformMatrix4x2fv",lf,8,Ob),35690:_a.bind(null,"uniformMatrix4x3fv",lf,12,Ob),35678:Jc,35680:Jc,35679:Jc,35682:Jc,36289:Jc,36292:Jc,36293:Jc,36298:Jc,36299:Jc,36300:Jc,36303:Jc,36306:Jc,36307:Jc,36308:Jc,36311:Jc},Eq={},Tq={},Sq={},bj=[0];function Z3(i,t,e,n){1===t&&"boolean"==typeof i&&(i=i?1:0),Number.isFinite(i)&&(bj[0]=i,i=bj);const r=i.length;if(r%t&&lr.warn("Uniform size should be multiples of ".concat(t),i)(),i instanceof e)return i;let l=n[r];l||(l=new e(r),n[r]=l);for(let m=0;m<r;m++)l[m]=i[m];return l}function lf(i,t){return Z3(i,t,Float32Array,Eq)}function cx(i,t){return Z3(i,t,Int32Array,Tq)}function TP(i,t){return Z3(i,t,Uint32Array,Sq)}function yj(i,t,e){const n=Cq[e.type];if(!n)throw new Error("Unknown GLSL uniform type ".concat(e.type));return n().bind(null,i,t)}function Mq(i){if("]"!==i[i.length-1])return{name:i,length:1,isArray:!1};const e=i.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(i));return{name:e[1],length:e[2]||1,isArray:!!e[2]}}function Dq(i){return Array.isArray(i)||ArrayBuffer.isView(i)?function Iq(i){if(0===i.length)return!1;const t=Math.min(i.length,16);for(let e=0;e<t;++e)if(!Number.isFinite(i[e]))return!1;return!0}(i):!!(isFinite(i)||!0===i||!1===i||i instanceof dS||i instanceof uS)||i instanceof zl&&!!i.texture}function kq(i,t,e){if(Array.isArray(e)||ArrayBuffer.isView(e))if(i[t]){const n=i[t];for(let r=0,l=e.length;r<l;++r)n[r]=e[r]}else i[t]=e.slice();else i[t]=e}function Jc(){let i=null;return(t,e,n)=>{const r=i!==n;return r&&(t.uniform1i(e,n),i=n),r}}function _a(i,t,e,n){let r=null,l=null;return(m,C,A)=>{const O=t(A,e),z=O.length;let $=!1;if(null===r)r=new Float32Array(z),l=z,$=!0;else{Cn(l===z,"Uniform length cannot change.");for(let Q=0;Q<z;++Q)if(O[Q]!==r[Q]){$=!0;break}}return $&&(n(m,i,C,O),r.set(O)),$}}function Vd(i,t,e,n){i[t](e,n)}function Ob(i,t,e,n){i[t](e,!1,n)}function SP(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=i.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:t}function wj(i,t){let e="";for(let n=0;n<t.length;n++)if((i[n+3]||i[n+2]||i[n+1])&&(e+="".concat(t[n],"\n"),i[n+1])){const l=i[n+1],m=l.split(":",3),C=m[0],A=parseInt(m[1],10)||0,O=l.substring(m.join(":").length+1).trim();e+=Cj("^^^ ".concat(C,": ").concat(O,"\n\n"),A)}return e}function Cj(i,t){let e="";for(let n=0;n<t;++n)e+=" ";return"".concat(e).concat(i)}class ck extends Pb{get[Symbol.toStringTag](){return"Shader"}static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Cn(!1),"unknown"}}constructor(t,e){X0(t),Cn("string"==typeof e.source,"Shader: GLSL source code must be a JavaScript string"),super(t,{id:SP(e.source,null)||e.id||F_("unnamed ".concat(ck.getTypeName(e.shaderType)))}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize(t){let{source:e}=t;const n=SP(e,null);n&&(this.id=F_(n)),this._compile(e)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(ck.getTypeName(this.shaderType),":").concat(this.id)}getName(){return SP(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;if(t.startsWith("#version ")||(t="#version 100\n".concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const n=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:l,warnings:m}=function xj(i,t,e,n){const r=i.split(/\r?\n/),l={},m={},C=n||SP(t)||"(unnamed)",A="".concat(function Oq(i){switch(i){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(e)," shader ").concat(C);for(let z=0;z<r.length;z++){const $=r[z];if($.length<=1)continue;const Q=$.split(":"),te=Q[0],de=parseInt(Q[2],10);if(isNaN(de))throw new Error("GLSL compilation error in ".concat(A,": ").concat(i));"WARNING"!==te?l[de]=$:m[de]=$}const O=function Lq(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const n=i.split(/\r?\n/),r=String(n.length+t-1).length;return n.map((l,m)=>{const C=String(m+t);return Cj(C,r-C.length)+e+l})}(t);return{shaderName:A,errors:wj(l,O),warnings:wj(m,O)}}(n,this.source,this.shaderType,this.id);throw lr.error("GLSL compilation errors in ".concat(r,"\n").concat(l))(),lr.warn("GLSL compilation warnings in ".concat(r,"\n").concat(m))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class K3 extends ck{get[Symbol.toStringTag](){return"VertexShader"}constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Q3 extends ck{get[Symbol.toStringTag](){return"FragmentShader"}constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Nq=5120,Bq=5121,Vq=5122,zq=5123,ac=5126,Uq=35664,jq=35665,Gq=35666,dk=5124,Hq=35667,$q=35668,Wq=35669,uk=5125,Xq=36294,qq=36295,Yq=36296,Zq=35670,Kq=35671,Qq=35672,Jq=35673,eY=35674,tY=35675,iY=35676,nY=35685,rY=35686,oY=35687,sY=35688,aY=35689,lY=35690,J3={[ac]:[ac,1,"float"],[Uq]:[ac,2,"vec2"],[jq]:[ac,3,"vec3"],[Gq]:[ac,4,"vec4"],[dk]:[dk,1,"int"],[Hq]:[dk,2,"ivec2"],[$q]:[dk,3,"ivec3"],[Wq]:[dk,4,"ivec4"],[uk]:[uk,1,"uint"],[Xq]:[uk,2,"uvec2"],[qq]:[uk,3,"uvec3"],[Yq]:[uk,4,"uvec4"],[Zq]:[ac,1,"bool"],[Kq]:[ac,2,"bvec2"],[Qq]:[ac,3,"bvec3"],[Jq]:[ac,4,"bvec4"],[eY]:[ac,8,"mat2"],[nY]:[ac,8,"mat2x3"],[rY]:[ac,8,"mat2x4"],[tY]:[ac,12,"mat3"],[oY]:[ac,12,"mat3x2"],[sY]:[ac,12,"mat3x4"],[iY]:[ac,16,"mat4"],[aY]:[ac,16,"mat4x2"],[lY]:[ac,16,"mat4x3"]};function Dj(i){const t=J3[i];if(!t)return null;const[e,n]=t;return{type:e,components:n}}function kj(i,t){switch(i){case Nq:case Bq:case Vq:case zq:i=ac}for(const e in J3){const[n,r,l]=J3[e];if(n===i&&r===t)return{glType:e,name:l}}return null}class dY{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let r=0;r<n;r++){const{name:l,type:m,size:C}=e.getActiveAttrib(t.handle,r),A=e.getAttribLocation(t.handle,l);A>=0&&this._addAttribute(A,l,m,C)}this.attributeInfos.sort((r,l)=>r.location-l.location)}_readVaryingsFromProgram(t){const{gl:e}=t;if(!go(e))return;const n=e.getProgramParameter(t.handle,35971);for(let r=0;r<n;r++){const{name:l,type:m,size:C}=e.getTransformFeedbackVarying(t.handle,r);this._addVarying(r,l,m,C)}this.varyingInfos.sort((r,l)=>r.location-l.location)}_addAttribute(t,e,n,r){const{type:l,components:m}=Dj(n),C={type:l,size:r*m};this._inferProperties(t,e,C);const A={location:t,name:e,accessor:new af(C)};this.attributeInfos.push(A),this.attributeInfosByLocation[t]=A,this.attributeInfosByName[A.name]=A}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,r){const{type:l,components:m}=Dj(n),A={location:t,name:e,accessor:new af({type:l,size:r*m})};this.varyingInfos.push(A),this.varyingInfosByName[A.name]=A}}const uY=35981,hY=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Rj extends Pb{get[Symbol.toStringTag](){return"Program"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Program","v6.0",hY),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:e,vs:n,fs:r,varyings:l,bufferMode:m=uY}=t;return this.hash=e||"",this.vs="string"==typeof n?new K3(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs="string"==typeof r?new Q3(this.gl,{id:"".concat(t.id,"-fs"),source:r}):r,Cn(this.vs instanceof K3),Cn(this.fs instanceof Q3),this.uniforms={},this._textureUniforms={},l&&l.length>0&&(Ac(this.gl),this.varyings=l,this.gl2.transformFeedbackVaryings(this.handle,l,m)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new dY(this),this.setProps(t)}delete(){return this._isCached?this:super.delete(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw(t){let{logPriority:e,drawMode:n=4,vertexCount:r,offset:l=0,start:m,end:C,isIndexed:A=!1,indexType:O=5123,instanceCount:z=0,isInstanced:$=z>0,vertexArray:Q=null,transformFeedback:te,framebuffer:de,parameters:fe={},uniforms:ge,samplers:Re}=t;if((ge||Re)&&(lr.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(ge||{})),lr.priority>=e){const qe=de?de.id:"default",et="mode=".concat(lx(this.gl,n)," verts=").concat(r," ")+"instances=".concat(z," indexType=").concat(lx(this.gl,O)," ")+"isInstanced=".concat($," isIndexed=").concat(A," ")+"Framebuffer=".concat(qe);lr.log(e,et)()}return Cn(Q),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===r||$&&0===z||(Q.bindForDraw(r,z,()=>{if(void 0!==de&&(fe=Object.assign({},fe,{framebuffer:de})),te){const qe=function Aj(i){switch(i){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return Cn(!1),0}}(n);te.begin(qe)}this._bindTextures(),Nl(this.gl,fe,()=>{A&&$?this.gl2.drawElementsInstanced(n,r,O,l,z):A&&go(this.gl)&&!isNaN(m)&&!isNaN(C)?this.gl2.drawRangeElements(n,m,C,r,O,l):A?this.gl.drawElements(n,r,O,l):$?this.gl2.drawArraysInstanced(n,l,r,z):this.gl.drawArrays(n,l,r)}),te&&te.end()}),0))}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};lr.priority>=2&&function Aq(i,t,e){for(const n in i){const r=i[n];if((!e||e[n])&&!Dq(r))throw t=t?"".concat(t," "):"",console.error("".concat(t," Bad uniform ").concat(n),r),new Error("".concat(t," Bad uniform ").concat(n))}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],r=this._uniformSetters[e];if(r){let l=n,m=!1;if(l instanceof zl&&(l=l.texture),l instanceof dS)if(m=this.uniforms[e]!==n,m){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const C=l,{textureIndex:A}=r;C.bind(A),l=A,this._textureUniforms[e]=C}else l=r.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(r(l)||m)&&kq(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms)this._textureUniforms[t].bind(this._uniformSetters[t].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const r of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new K3({handle:r});break;case 35632:n.fs=new Q3({handle:r})}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const e=this._getName();this.id=F_(e)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),lr.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),lr.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||lr.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:r}=Mq(n.name);let l=t.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=yj(t,l,n),n.size>1)for(let m=0;m<n.size;m++)l=t.getUniformLocation(this.handle,"".concat(r,"[").concat(m,"]")),this._uniformSetters["".concat(r,"[").concat(m,"]")]=yj(t,l,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}class hk{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new hk(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find(e=>e.name===t.name)||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==e),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:e="",fs:n="",defines:r={},inject:l={},varyings:m=[],bufferMode:C=35981,transpileToGLSL100:A=!1}=t,O=this._getModuleList(t.modules),z=this._getHash(e),$=this._getHash(n),Q=O.map(et=>this._getHash(et.name)).sort(),te=m.map(et=>this._getHash(et)),de=Object.keys(r).sort(),fe=Object.keys(l).sort(),ge=[],Re=[];for(const et of de)ge.push(this._getHash(et)),ge.push(this._getHash(r[et]));for(const et of fe)Re.push(this._getHash(et)),Re.push(this._getHash(l[et]));const qe="".concat(z,"/").concat($,"D").concat(ge.join("/"),"M").concat(Q.join("/"),"I").concat(Re.join("/"),"V").concat(te.join("/"),"H").concat(this.stateHash,"B").concat(C).concat(A?"T":"");if(!this._programCache[qe]){const et=function V9(i,t){const{vs:e,fs:n}=t,r=m9(t.modules||[]);return{gl:i,vs:ej(i,Object.assign({},t,{source:e,type:ok,modules:r})),fs:ej(i,Object.assign({},t,{source:n,type:"fs",modules:r})),getUniforms:z9(r)}}(this.gl,{vs:e,fs:n,modules:O,inject:l,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:A});this._programCache[qe]=new Rj(this.gl,{hash:qe,vs:et.vs,fs:et.fs,varyings:m,bufferMode:C}),this._getUniforms[qe]=et.getUniforms||(yt=>{}),this._useCounts[qe]=0}return this._useCounts[qe]++,this._programCache[qe]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=new Array(this._defaultModules.length+t.length),n={};let r=0;for(let l=0,m=this._defaultModules.length;l<m;++l){const C=this._defaultModules[l],A=C.name;e[r++]=C,n[A]=!0}for(let l=0,m=t.length;l<m;++l){const C=t[l],A=C.name;n[A]||(e[r++]=C,n[A]=!0)}return e.length=r,e}}const Pj="#define SMOOTH_EDGE_RADIUS 0.5",gY={name:"geometry",vs:"\n".concat(Pj,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(Pj,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},_Y=Object.keys(Ro).map(i=>"const int COORDINATE_SYSTEM_".concat(i," = ").concat(Ro[i],";")).join(""),vY=Object.keys(O_).map(i=>"const int PROJECTION_MODE_".concat(i," = ").concat(O_[i],";")).join(""),bY=Object.keys(L_).map(i=>"const int UNIT_".concat(i.toUpperCase()," = ").concat(L_[i],";")).join(""),yY="".concat(_Y,"\n").concat(vY,"\n").concat(bY,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n");function xY(i,t){if(i===t)return!0;if(Array.isArray(i)){const e=i.length;if(!t||t.length!==e)return!1;for(let n=0;n<e;n++)if(i[n]!==t[n])return!1;return!0}return!1}function fk(i){let e,t={};return n=>{for(const r in n)if(!xY(n[r],t[r])){e=i(n),t=n;break}return e}}const Oj=[0,0,0,0],wY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Lj=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],CY=[0,0,0],Fj=[0,0,0],EY=fk(function MY({viewport:i,devicePixelRatio:t,coordinateSystem:e,coordinateOrigin:n}){const{projectionCenter:r,viewProjectionMatrix:l,originCommon:m,cameraPosCommon:C,shaderCoordinateOrigin:A,geospatialOrigin:O}=function TY(i,t,e){const{viewMatrixUncentered:n,projectionMatrix:r}=i;let{viewMatrix:l,viewProjectionMatrix:m}=i,C=Oj,A=Oj,O=i.cameraPosition;const{geospatialOrigin:z,shaderCoordinateOrigin:$,offsetMode:Q}=Nj(i,t,e);return Q&&(A=i.projectPosition(z||$),O=[O[0]-A[0],O[1]-A[1],O[2]-A[2]],A[3]=1,C=nk([],A,m),l=n||l,m=P_([],r,l),m=P_([],m,wY)),{viewMatrix:l,viewProjectionMatrix:m,projectionCenter:C,originCommon:A,cameraPosCommon:O,shaderCoordinateOrigin:$,geospatialOrigin:z}}(i,e,n),z=i.getDistanceScales(),$=[i.width*t,i.height*t],Q=nk([],[0,0,-i.focalDistance,1],i.projectionMatrix)[3]||1,te={project_uCoordinateSystem:e,project_uProjectionMode:i.projectionMode,project_uCoordinateOrigin:A,project_uCommonOrigin:m.slice(0,3),project_uCenter:r,project_uPseudoMeters:!!i._pseudoMeters,project_uViewportSize:$,project_uDevicePixelRatio:t,project_uFocalDistance:Q,project_uCommonUnitsPerMeter:z.unitsPerMeter,project_uCommonUnitsPerWorldUnit:z.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:CY,project_uScale:i.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:l,project_uModelMatrix:Lj,project_uCameraPosition:C};if(O){const de=i.getDistanceScales(O);switch(e){case Ro.METER_OFFSETS:te.project_uCommonUnitsPerWorldUnit=de.unitsPerMeter,te.project_uCommonUnitsPerWorldUnit2=de.unitsPerMeter2;break;case Ro.LNGLAT:case Ro.LNGLAT_OFFSETS:i._pseudoMeters||(te.project_uCommonUnitsPerMeter=de.unitsPerMeter),te.project_uCommonUnitsPerWorldUnit=de.unitsPerDegree,te.project_uCommonUnitsPerWorldUnit2=de.unitsPerDegree2;break;case Ro.CARTESIAN:te.project_uCommonUnitsPerWorldUnit=[1,1,de.unitsPerMeter[2]],te.project_uCommonUnitsPerWorldUnit2=[0,0,de.unitsPerMeter2[2]]}}return te});function Nj(i,t,e=Fj){e.length<3&&(e=[e[0],e[1],0]);let r,n=e,l=!0;switch(r=t===Ro.LNGLAT_OFFSETS||t===Ro.METER_OFFSETS?e:i.isGeospatial?[Math.fround(i.longitude),Math.fround(i.latitude),0]:null,i.projectionMode){case O_.WEB_MERCATOR:(t===Ro.LNGLAT||t===Ro.CARTESIAN)&&(r=[0,0,0],l=!1);break;case O_.WEB_MERCATOR_AUTO_OFFSET:t===Ro.LNGLAT?n=r:t===Ro.CARTESIAN&&(n=[Math.fround(i.center[0]),Math.fround(i.center[1]),0],r=i.unprojectPosition(n),n[0]-=e[0],n[1]-=e[1],n[2]-=e[2]);break;case O_.IDENTITY:n=i.position.map(Math.fround),n[2]=n[2]||0;break;case O_.GLOBE:l=!1,r=null;break;default:l=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:n,offsetMode:l}}const AY={},eB={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},gY],vs:yY,getUniforms:function DY(i=AY){return"viewport"in i?function SY({viewport:i,devicePixelRatio:t=1,modelMatrix:e=null,coordinateSystem:n=Ro.DEFAULT,coordinateOrigin:r=Fj,autoWrapLongitude:l=!1}){n===Ro.DEFAULT&&(n=i.isGeospatial?Ro.LNGLAT:Ro.CARTESIAN);const m=EY({viewport:i,devicePixelRatio:t,coordinateSystem:n,coordinateOrigin:r});return m.project_uWrapLongitude=l,m.project_uModelMatrix=e||Lj,m}(i):{}}},kY=[eB],IY=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function RY(i){const t=hk.getDefaultProgramManager(i);for(const e of kY)t.addDefaultModule(e);for(const e of IY)t.addShaderHook(e);return t}class LY{constructor(t,{deck:e,stats:n,viewport:r,timeline:l}={}){ye(this,"layers",void 0),ye(this,"context",void 0),ye(this,"resourceManager",void 0),ye(this,"_lastRenderedLayers",[]),ye(this,"_needsRedraw",!1),ye(this,"_needsUpdate",!1),ye(this,"_nextLayers",null),ye(this,"_debug",!1),ye(this,"activateViewport",m=>{Bl("layerManager.activateViewport",this,m),m&&(this.context.viewport=m)}),this.layers=[],this.resourceManager=new LU({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&RY(t),stats:n||new _D({id:"deck.gl"}),viewport:r||new sS({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:l||new CT,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(t);e=e||r}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter(e=>t.find(n=>0===e.id.indexOf(n))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){Bl("layerManager.setLayers",this,e,t),this._lastRenderedLayers=t;const n=Z0(t,Boolean);for(const r of n)r.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const m of t)n[m.id]?so.warn("Multiple old layers with same id ".concat(m.id))():n[m.id]=m;const r=[];this._updateSublayersRecursively(e,n,r),this._finalizeOldLayers(n);let l=!1;for(const m of r)if(m.hasUniformTransition()){l="Uniform transition in ".concat(m);break}this._needsUpdate=l,this.layers=r}_updateSublayersRecursively(t,e,n){for(const r of t){r.context=this.context;const l=e[r.id];null===l&&so.warn("Multiple new layers with same id ".concat(r.id))(),e[r.id]=null;let m=null;try{this._debug&&l!==r&&r.validateProps(),l?(this._transferLayerState(l,r),this._updateLayer(r)):this._initializeLayer(r),n.push(r),m=r.isComposite?r.getSubLayers():null}catch(C){this._handleError("matching",C,r)}m&&this._updateSublayersRecursively(m,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle="Initialized"}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle="Matched. State transferred from previous layer",e!==t&&(t.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle="No longer matched. Awaiting garbage collection";try{t._finalize(),t.lifecycle="Finalized! Awaiting garbage collection"}catch(e){this._handleError("finalization",e,t)}}}function N_(i,t,e){if(i===t)return!0;if(!e||!i||!t)return!1;if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let n=0;n<i.length;n++)if(!N_(i[n],t[n],e-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"==typeof i&&"object"==typeof t){const n=Object.keys(i),r=Object.keys(t);if(n.length!==r.length)return!1;for(const l of n)if(!t.hasOwnProperty(l)||!N_(i[l],t[l],e-1))return!1;return!0}return!1}class FY{constructor(t){ye(this,"width",void 0),ye(this,"height",void 0),ye(this,"views",void 0),ye(this,"viewState",void 0),ye(this,"controllers",void 0),ye(this,"timeline",void 0),ye(this,"_viewports",void 0),ye(this,"_viewportMap",void 0),ye(this,"_isUpdating",void 0),ye(this,"_needsRedraw",void 0),ye(this,"_needsUpdate",void 0),ye(this,"_eventManager",void 0),ye(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter(e=>e.containsPixel(t)):this._viewports}getViews(){const t={};return this.views.forEach(e=>{t[e.id]=e}),t}getView(t){return this.views.find(e=>e.id===t)}getViewState(t){const e="string"==typeof t?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),r={x:t[0],y:t[1]};for(let l=n.length-1;l>=0;--l){const m=n[l];if(m.containsPixel(r)){const C=t.slice();return C[0]-=m.x,C[1]-=m.y,m.unproject(C,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){(t!==this.width||e!==this.height)&&(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=Z0(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!N_(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):so.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:l=>{var m;return null===(m=this.getView(t.id))||void 0===m?void 0:m.makeViewport({viewState:l,width:this.width,height:this.height})}})}_updateController(t,e,n,r){const l=t.controller;if(l&&n){const m={...e,...l,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!r||r.constructor!==l.type)&&(r=this._createController(t,m)),r&&r.setProps(m),r}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let r=t.length;r--;){const l=t[r],m=this.getViewState(l),C=l.makeViewport({viewState:m,width:this.width,height:this.height});let A=e[l.id];const O=!!l.controller;O&&!A&&(n=!0),(n||!O)&&A&&(A.finalize(),A=null),this.controllers[l.id]=this._updateController(l,m,C,A),C&&this._viewports.unshift(C)}for(const r in e){const l=e[r];l&&!this.controllers[r]&&l.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,e){return t.length!==e.length||t.some((n,r)=>!t[r].equals(e[r]))}}const NY=/([0-9]+\.?[0-9]*)(%|px)/;function dx(i){switch(typeof i){case"number":return{position:i,relative:!1};case"string":const t=NY.exec(i);if(t&&t.length>=3){const e="%"===t[2],n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error("Could not parse position string ".concat(i))}}function ux(i,t){return i.relative?Math.round(i.position*t):i.position}function gl(i,t){if(!i)throw new Error(t||"deck.gl: assertion failed.")}class BY{constructor(t){ye(this,"id",void 0),ye(this,"viewportInstance",void 0),ye(this,"_x",void 0),ye(this,"_y",void 0),ye(this,"_width",void 0),ye(this,"_height",void 0),ye(this,"_padding",void 0),ye(this,"props",void 0);const{id:e,x:n=0,y:r=0,width:l="100%",height:m="100%",padding:C=null,viewportInstance:A}=t||{};gl(!A||A instanceof sS),this.viewportInstance=A,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=dx(n),this._y=dx(r),this._width=dx(l),this._height=dx(m),this._padding=C&&{left:dx(C.left||0),right:dx(C.right||0),top:dx(C.top||0),bottom:dx(C.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?!!t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):this.ViewportType===t.ViewportType&&N_(this.props,t.props,2))}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const r=this.getDimensions({width:t,height:e});return r.height&&r.width?new this.ViewportType({...n,...this.props,...r}):null}getViewStateId(){const{viewState:t}=this.props;return"string"==typeof t?t:t?.id||this.id}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const n in this.props.viewState)"id"!==n&&(e[n]=this.props.viewState[n]);return e}return t}getDimensions({width:t,height:e}){const n={x:ux(this._x,t),y:ux(this._y,e),width:ux(this._width,t),height:ux(this._height,e)};return this._padding&&(n.padding={left:ux(this._padding.left,t),top:ux(this._padding.top,e),right:ux(this._padding.right,t),bottom:ux(this._padding.bottom,e)}),n}get controller(){const t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"==typeof t?{type:t}:{type:this.ControllerType,...t}:null}}class Y1 extends sS{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=0,pitch:l=0,bearing:m=0,nearZMultiplier:C=.1,farZMultiplier:A=1.01,nearZ:O,farZ:z,orthographic:$=!1,projectionMatrix:Q,repeat:te=!1,worldOffset:de=0,position:fe,padding:ge,legacyMeterSizes:Re=!1}=t;let{width:qe,height:et,altitude:yt=1.5}=t;const Jt=Math.pow(2,r);qe=qe||1,et=et||1;let fi,Hi=null;if(Q)yt=Q[5]/2,fi=bP(yt);else{let cn;if(t.fovy?(fi=t.fovy,yt=O5(fi)):fi=bP(yt),ge){const{top:_n=0,bottom:Rr=0}=ge;cn=[0,R_((_n+et-Rr)/2,0,et)-et/2]}Hi=function P5(i){const{width:t,height:e,altitude:n,pitch:r=0,offset:l,center:m,scale:C,nearZMultiplier:A=1,farZMultiplier:O=1}=i;let{fovy:z=bP(ZX)}=i;void 0!==n&&(z=bP(n));const $=z*Bm,Q=r*Bm,te=O5(z);let de=te;m&&(de+=m[2]*C/Math.cos(Q)/e);const fe=$*(.5+(l?l[1]:0)/e),ge=Math.sin(fe)*de/Math.sin(T3(Math.PI/2-Q-fe,.01,Math.PI-.01)),Re=Math.sin(Q)*ge+de;return{fov:$,aspect:t/e,focalDistance:te,near:A,far:Math.min(Re*O,10*de)}}({width:qe,height:et,scale:Jt,center:fe&&[0,0,fe[2]*vP(e)],offset:cn,pitch:l,fovy:fi,nearZMultiplier:C,farZMultiplier:A}),Number.isFinite(O)&&(Hi.near=O),Number.isFinite(z)&&(Hi.far=z)}let tn=function JX(i){const{height:t,pitch:e,bearing:n,altitude:r,scale:l,center:m}=i,C=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];G1(C,C,[0,0,-r]),H1(C,C,-e*Bm),ek(C,C,n*Bm);const A=l/t;return uP(C,C,[A,A,A]),m&&G1(C,C,function JN(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i}([],m)),C}({height:et,pitch:l,bearing:m,scale:Jt,altitude:yt});de&&(tn=(new sg).translate([512*de,0,0]).multiplyLeft(tn)),super({...t,width:qe,height:et,viewMatrix:tn,longitude:n,latitude:e,zoom:r,...Hi,fovy:fi,focalDistance:yt}),ye(this,"longitude",void 0),ye(this,"latitude",void 0),ye(this,"pitch",void 0),ye(this,"bearing",void 0),ye(this,"altitude",void 0),ye(this,"fovy",void 0),ye(this,"orthographic",void 0),ye(this,"_subViewports",void 0),ye(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=r,this.pitch=l,this.bearing=m,this.altitude=yt,this.fovy=fi,this.orthographic=$,this._subViewports=te?[]:null,this._pseudoMeters=Re,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let r=e;r<=n;r++){const l=r?new Y1({...this,worldOffset:r}):this;this._subViewports.push(l)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*vP(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/vP(n)]}addMetersToLngLat(t,e){return R5(t,e)}panByPosition(t,e){const n=D3(e,this.pixelUnprojectionMatrix),l=c([],this.projectFlat(t),function $t(i,t){return i[0]=-t[0],i[1]=-t[1],i}([],n)),m=c([],this.center,l),[C,A]=this.unprojectFlat(m);return{longitude:C,latitude:A}}getBounds(t={}){const e=function i9(i,t=0){const{width:e,height:n,unproject:r}=i,l={targetZ:t},m=r([0,n],l),C=r([e,n],l);let A,O;return(i.fovy?.5*i.fovy*F5:Math.atan(.5/i.altitude))>(90-i.pitch)*F5-.01?(A=N5(i,0,t),O=N5(i,e,t)):(A=r([0,0],l),O=r([e,0],l)),[m,C,O,A]}(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:l,latitude:m,zoom:C}=function e9(i){const{width:t,height:e,bounds:n,minExtent:r=0,maxZoom:l=24,offset:m=[0,0]}=i,[[C,A],[O,z]]=n,$=function t9(i=0){return"number"==typeof i?{top:i,bottom:i,left:i,right:i}:(Rb(Number.isFinite(i.top)&&Number.isFinite(i.bottom)&&Number.isFinite(i.left)&&Number.isFinite(i.right)),i)}(i.padding),Q=rk([C,T3(z,-_P,_P)]),te=rk([O,T3(A,-_P,_P)]),de=[Math.max(Math.abs(te[0]-Q[0]),r),Math.max(Math.abs(te[1]-Q[1]),r)],fe=[t-$.left-$.right-2*Math.abs(m[0]),e-$.top-$.bottom-2*Math.abs(m[1])];Rb(fe[0]>0&&fe[1]>0);const ge=fe[0]/de[0],Re=fe[1]/de[1],Jt=oS([(te[0]+Q[0])/2+($.right-$.left)/2/ge,(te[1]+Q[1])/2+($.top-$.bottom)/2/Re]),fi=Math.min(l,S3(Math.abs(Math.min(ge,Re))));return Rb(Number.isFinite(fi)),{longitude:Jt[0],latitude:Jt[1],zoom:fi}}({width:n,height:r,bounds:t,...e});return new Y1({width:n,height:r,longitude:l,latitude:m,zoom:C})}}ye(Y1,"displayName","WebMercatorViewport");class mk{constructor(t){ye(this,"_inProgress",void 0),ye(this,"_handle",void 0),ye(this,"_timeline",void 0),ye(this,"time",void 0),ye(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,null===(e=(n=this.settings).onStart)||void 0===e||e.call(n,this)}end(){var t,e;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(e=this.settings).onEnd)||void 0===t||t.call(e,this))}cancel(){var t,e;this._inProgress&&(null===(t=(e=this.settings).onInterrupt)||void 0===t||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,e;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:n,settings:r}=this;this._handle=n.addChannel({delay:n.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(e=this.settings).onUpdate)||void 0===t||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Bj=()=>{},VY=i=>i;class UY{constructor(t){ye(this,"getControllerState",void 0),ye(this,"props",void 0),ye(this,"propsInTransition",void 0),ye(this,"transition",void 0),ye(this,"onViewStateChange",void 0),ye(this,"onStateChange",void 0),ye(this,"_onTransitionUpdate",e=>{const{time:n,settings:{interpolator:r,startProps:l,endProps:m,duration:C,easing:A}}=e,O=A(n/C),z=r.interpolateProps(l,m,O);this.propsInTransition=this.getControllerState({...this.props,...z}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new mk(t.timeline),this.onViewStateChange=t.onViewStateChange||Bj,this.onStateChange=t.onStateChange||Bj}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let r=n;if(this.transition.inProgress){const{interruption:l,endProps:m}=this.transition.settings;r={...n,...2===l?m:this.propsInTransition||n}}this._triggerTransition(r,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&!!n}_isUpdateDueToCurrentTransition(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=this.getControllerState(t),r=this.getControllerState(e).shortestPathFrom(n),l=e.transitionInterpolator,m=l.getDuration?l.getDuration(t,e):e.transitionDuration;if(0===m)return;const C=l.initializeProps(t,r);this.propsInTransition={};const A={duration:m,easing:e.transitionEasing||VY,interpolator:l,interruption:e.transitionInterruption||1,startProps:C.start,endProps:C.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(A),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t?.(e)}}}class jY{constructor(t){ye(this,"_propsToCompare",void 0),ye(this,"_propsToExtract",void 0),ye(this,"_requiredProps",void 0);const{compare:e,extract:n,required:r}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=r}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!Ib(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},r={};for(const l of this._propsToExtract)(l in t||l in e)&&(n[l]=t[l],r[l]=e[l]);return this._checkRequiredProps(n),this._checkRequiredProps(r),{start:n,end:r}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(e=>{const n=t[e];gl(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))})}}const GY=["longitude","latitude","zoom","bearing","pitch"],HY=["longitude","latitude","zoom"];class Vj extends jY{constructor(t={}){const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:GY,required:HY},super(n.transitionProps),ye(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:r,around:l}=this.opts;if(r&&l){const m=r(t),C=r(e),A=m.unproject(l);n.start.around=l,Object.assign(n.end,{around:C.project(A),aroundPosition:A,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const r={};for(const l of this._propsToExtract)r[l]=rx(t[l]||0,e[l]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const l=this.opts.makeViewport({...e,...r});Object.assign(r,l.panByPosition(e.aroundPosition,rx(t.around,e.around,n)))}return r}}const hx={transitionDuration:0},AP=i=>1-(1-i)*(1-i),mS_WHEEL=["wheel"],mS_PAN=["panstart","panmove","panend"],mS_PINCH=["pinchstart","pinchmove","pinchend"],mS_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],mS_DOUBLE_TAP=["doubletap"],mS_KEYBOARD=["keydown"],Z1={};class WY{constructor(t){ye(this,"props",void 0),ye(this,"state",{}),ye(this,"transitionManager",void 0),ye(this,"eventManager",void 0),ye(this,"onViewStateChange",void 0),ye(this,"onStateChange",void 0),ye(this,"makeViewport",void 0),ye(this,"_controllerState",void 0),ye(this,"_events",{}),ye(this,"_interactionState",{isDragging:!1}),ye(this,"_customEvents",[]),ye(this,"_eventStartBlocked",null),ye(this,"_panMove",!1),ye(this,"invertPan",!1),ye(this,"dragMode","rotate"),ye(this,"inertia",0),ye(this,"scrollZoom",!0),ye(this,"dragPan",!0),ye(this,"dragRotate",!0),ye(this,"doubleClickZoom",!0),ye(this,"touchZoom",!0),ye(this,"touchRotate",!1),ye(this,"keyboard",!0),this.transitionManager=new UY({...t,getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)if(this._events[e]){var t;null===(t=this.eventManager)||void 0===t||t.off(e,this.handleEvent)}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:r}=t;return[r.x-e,r.y-n]}isPointInBounds(t,e){const{width:n,height:r}=this.props;if(e&&e.handled)return!1;const l=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r;return l&&e&&e.stopPropagation(),l}isFunctionKeyPressed(t){const{srcEvent:e}=t;return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout(()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:!0===e?300:0;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:l=!0,doubleClickZoom:m=!0,touchZoom:C=!0,touchRotate:A=!1,keyboard:O=!0}=t,z=!!this.onViewStateChange;this.toggleEvents(mS_WHEEL,z&&n),this.toggleEvents(mS_PAN,z),this.toggleEvents(mS_PINCH,z&&(C||A)),this.toggleEvents(mS_TRIPLE_PAN,z&&A),this.toggleEvents(mS_DOUBLE_TAP,z&&m),this.toggleEvents(mS_KEYBOARD,z&&O),this.scrollZoom=n,this.dragPan=r,this.dragRotate=l,this.doubleClickZoom=m,this.touchZoom=C,this.touchRotate=A,this.keyboard=O}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach(n=>{this._events[n]!==e&&(this._events[n]=e,e?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(t,e=null,n={}){const r={...t.getViewportProps(),...e},l=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),l){const m=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:m})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(r,hx,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,hx,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),l=this.controllerState.pan({pos:[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2]}).panEnd();this.updateViewport(l,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:AP},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,hx,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),l=this.controllerState.rotate({pos:[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2]}).rotateEnd();this.updateViewport(l,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:AP},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;t.srcEvent.preventDefault();const{speed:n=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:l}=t;let m=2/(1+Math.exp(-Math.abs(l*n)));l<0&&0!==m&&(m=1/m);const C=this.controllerState.zoom({pos:e,scale:m});return this.updateViewport(C,{...this._getTransitionProps({around:e}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,hx,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate||!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,hx,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),r=[n[0],n[1]+=t.velocityY*e/2],l=this.controllerState.rotate({pos:r});this.updateViewport(l,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:AP},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return Z1._startPinchRotation=t.rotation,Z1._lastPinchEvent=t,this.updateViewport(n,hx,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:Z1._startPinchRotation-n})}return this.updateViewport(e,hx,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Z1._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=Z1;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const r=this.getCenter(t);let l=this.controllerState.rotateEnd();const m=Math.log2(t.scale),C=(m-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),A=Math.pow(2,m+C*e/2);l=l.zoom({pos:r,scale:A}).zoomEnd(),this.updateViewport(l,{...this._getTransitionProps({around:r}),transitionDuration:e,transitionEasing:AP},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Z1._startPinchRotation=null,Z1._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:l,rotateSpeedY:m}=!0===this.keyboard?{}:this.keyboard,{controllerState:C}=this;let A;const O={};switch(t.srcEvent.code){case"Minus":A=e?C.zoomOut(n).zoomOut(n):C.zoomOut(n),O.isZooming=!0;break;case"Equal":A=e?C.zoomIn(n).zoomIn(n):C.zoomIn(n),O.isZooming=!0;break;case"ArrowLeft":e?(A=C.rotateLeft(l),O.isRotating=!0):(A=C.moveLeft(r),O.isPanning=!0);break;case"ArrowRight":e?(A=C.rotateRight(l),O.isRotating=!0):(A=C.moveRight(r),O.isPanning=!0);break;case"ArrowUp":e?(A=C.rotateUp(m),O.isRotating=!0):(A=C.moveUp(r),O.isPanning=!0);break;case"ArrowDown":e?(A=C.rotateDown(m),O.isRotating=!0):(A=C.moveDown(r),O.isPanning=!0);break;default:return!1}return this.updateViewport(A,this._getTransitionProps(),O),!0}_getTransitionProps(t){const{transition:e}=this;return e&&e.transitionInterpolator?t?{...e,transitionInterpolator:new Vj({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e:hx}}class XY{constructor(t,e){ye(this,"_viewportProps",void 0),ye(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}class YY extends XY{constructor(t){const{width:e,height:n,latitude:r,longitude:l,zoom:m,bearing:C=0,pitch:A=0,altitude:O=1.5,position:z=[0,0,0],maxZoom:$=20,minZoom:Q=0,maxPitch:te=60,minPitch:de=0,startPanLngLat:fe,startZoomLngLat:ge,startRotatePos:Re,startBearing:qe,startPitch:et,startZoom:yt,normalize:Jt=!0}=t;gl(Number.isFinite(l)),gl(Number.isFinite(r)),gl(Number.isFinite(m)),super({width:e,height:n,latitude:r,longitude:l,zoom:m,bearing:C,pitch:A,altitude:O,maxZoom:$,minZoom:Q,maxPitch:te,minPitch:de,normalize:Jt,position:z},{startPanLngLat:fe,startZoomLngLat:ge,startRotatePos:Re,startBearing:qe,startPitch:et,startZoom:yt}),ye(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this.getState().startPanLngLat||this._unproject(e);if(!n)return this;const l=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(l)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:l,startPitch:m}=this.getState();if(!r||void 0===l||void 0===m)return this;let C;return C=t?this._getNewRotation(t,r,m,l):{bearing:l+e,pitch:m+n},this._getUpdatedState(C)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:r,startZoomLngLat:l}=this.getState();if(l||(r=this.getViewportProps().zoom,l=this._unproject(e)||this._unproject(t)),!l)return this;const{maxZoom:m,minZoom:C}=this.getViewportProps();let A=r+Math.log2(n);A=R_(A,C,m);const O=this.makeViewport({...this.getViewportProps(),zoom:A});return this._getUpdatedState({zoom:A,...O.panByPosition(l,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:r,longitude:l}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(l-e.longitude)>180&&(n.longitude=l<0?l+360:l-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=R_(r,n,e);const{maxPitch:l,minPitch:m,pitch:C}=t;t.pitch=R_(C,m,l);const{normalize:A=!0}=t;return A&&Object.assign(t,function n9(i){const{width:t,height:e,pitch:n=0}=i;let{longitude:r,latitude:l,zoom:m,bearing:C=0}=i;(r<-180||r>180)&&(r=k5(r+180,360)-180),(C<-180||C>180)&&(C=k5(C+180,360)-180);const A=S3(e/512);if(m<=A)m=A,l=0;else{const O=e/2/Math.pow(2,m),z=oS([0,O])[1];if(l<z)l=z;else{const $=oS([0,512-O])[1];l>$&&(l=$)}}return{width:t,height:e,longitude:r,latitude:l,zoom:m,pitch:n,bearing:C}}(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,r){const l=t[0]-e[0],m=t[1]-e[1],C=t[1],A=e[1],{width:O,height:z}=this.getViewportProps(),$=l/O;let Q=0;m>0?Math.abs(z-A)>5&&(Q=m/(A-z)*1.2):m<0&&A>5&&(Q=1-C/A),Q=R_(Q,-1,1);const{minPitch:te,maxPitch:de}=this.getViewportProps();let ge=n;return Q>0?ge=n+Q*(de-n):Q<0&&(ge=n-Q*(te-n)),{pitch:ge,bearing:r+180*$}}}class ZY extends WY{constructor(...t){super(...t),ye(this,"ControllerState",YY),ye(this,"transition",{transitionDuration:300,transitionInterpolator:new Vj({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),ye(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}class iB extends BY{get ViewportType(){return Y1}get ControllerType(){return ZY}}ye(iB,"displayName","MapView");const KY=[255,255,255],QY=1;let JY=0;class eZ{constructor(t={}){ye(this,"id",void 0),ye(this,"color",void 0),ye(this,"intensity",void 0),ye(this,"type","ambient");const{color:e=KY}=t,{intensity:n=QY}=t;this.id=t.id||"ambient-".concat(JY++),this.color=e,this.intensity=n}}const tZ=[255,255,255],iZ=1,nZ=[0,0,-1];let rZ=0;class Uj{constructor(t={}){ye(this,"id",void 0),ye(this,"color",void 0),ye(this,"intensity",void 0),ye(this,"type","directional"),ye(this,"direction",void 0),ye(this,"shadow",void 0);const{color:e=tZ}=t,{intensity:n=iZ}=t,{direction:r=nZ}=t,{_shadow:l=!1}=t;this.id=t.id||"directional-".concat(rZ++),this.color=e,this.intensity=n,this.type="directional",this.direction=new Nm(r).normalize().toArray(),this.shadow=l}getProjectedLight(t){return this}}class oZ{constructor(t,e={id:"pass"}){ye(this,"id",void 0),ye(this,"gl",void 0),ye(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}class nB extends oZ{constructor(...t){super(...t),ye(this,"_lastRenderIndex",-1)}render(t){return nf(this.gl,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:r,views:l,onViewportActive:m,clearStack:C=!0,clearCanvas:A=!0}=t;t.pass=t.pass||"unknown";const O=this.gl;A&&function aZ(i,t){nf(i,{viewport:[0,0,t?t.width:i.drawingBufferWidth,t?t.height:i.drawingBufferHeight]}),i.clear(16640)}(O,e),C&&(this._lastRenderIndex=-1);const z=[];for(const $ of r){const Q=l&&l[$.id];m?.($);const te=this._getDrawLayerParams($,t),de=$.subViewports||[$];for(const fe of de){const ge=this._drawLayersInViewport(O,{target:e,moduleParameters:n,viewport:fe,view:Q,pass:t.pass,layers:t.layers},te);z.push(ge)}}return z}_getDrawLayerParams(t,{layers:e,pass:n,isPicking:r=!1,layerFilter:l,cullRect:m,effects:C,moduleParameters:A},O=!1){const z=[],$=jj(this._lastRenderIndex+1),Q={layer:e[0],viewport:t,isPicking:r,renderPass:n,cullRect:m},te={};for(let de=0;de<e.length;de++){const fe=e[de],ge=this._shouldDrawLayer(fe,Q,l,te),Re={shouldDrawLayer:ge};ge&&!O&&(Re.layerRenderIndex=$(fe,ge),Re.moduleParameters=this._getModuleParameters(fe,C,n,A),Re.layerParameters=this.getLayerParameters(fe,de,t)),z[de]=Re}return z}_drawLayersInViewport(t,{layers:e,moduleParameters:n,pass:r,target:l,viewport:m,view:C},A){const O=function sZ(i,{moduleParameters:t,target:e,viewport:n}){const r=e&&"default-framebuffer"!==e.id,l=t&&t.devicePixelRatio||S_(i);return[n.x*l,(r?e.height:i.drawingBufferHeight)-(n.y+n.height)*l,n.width*l,n.height*l]}(t,{moduleParameters:n,target:l,viewport:m});if(C&&C.props.clear){const $=!0===C.props.clear?{color:!0,depth:!0}:C.props.clear;Nl(t,{scissorTest:!0,scissor:O},()=>X3(t,$))}const z={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};nf(t,{viewport:O});for(let $=0;$<e.length;$++){const Q=e[$],{shouldDrawLayer:te,layerRenderIndex:de,moduleParameters:fe,layerParameters:ge}=A[$];if(te&&Q.props.pickable&&z.pickableCount++,Q.isComposite)z.compositeCount++;else if(te){z.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,de),fe.viewport=m;try{Q._drawLayer({moduleParameters:fe,uniforms:{layerIndex:de},parameters:ge})}catch(Re){Q.raiseError(Re,"drawing ".concat(Q," to ").concat(r))}}}return z}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,r){if(!t.props.visible||!this.shouldDrawLayer(t))return!1;e.layer=t;let m=t.parent;for(;m;){if(!m.props.visible||!m.filterSubLayer(e))return!1;e.layer=m,m=m.parent}if(n){const C=e.layer.id;if(C in r||(r[C]=n(e)),!r[C])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,r){var l;const m=Object.assign(Object.create((null===(l=t.internalState)||void 0===l?void 0:l.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:S_(this.gl)});if(e)for(const A of e){var C;Object.assign(m,null===(C=A.getModuleParameters)||void 0===C?void 0:C.call(A,t))}return Object.assign(m,this.getModuleParameters(t,e),r)}}function jj(i=0,t={}){const e={},n=(r,l)=>{const m=r.props._offset,C=r.id,A=r.parent&&r.parent.id;let O;if(A&&!(A in t)&&n(r.parent,!1),A in e){const z=e[A]=e[A]||jj(t[A],t);O=z(r,l),e[C]=z}else Number.isFinite(m)?(O=m+(t[A]||0),e[C]=null):O=i;return l&&O>=i&&(i=O+1),t[C]=O,O};return n}class lZ extends nB{constructor(t,e){super(t,e),ye(this,"shadowMap",void 0),ye(this,"depthBuffer",void 0),ye(this,"fbo",void 0),this.shadowMap=new vu(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new uS(t,{format:33189,width:1,height:1}),this.fbo=new zl(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;Nl(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const n=t.viewports[0],r=S_(this.gl),l=n.width*r,m=n.height*r;(l!==e.width||m!==e.height)&&e.resize({width:l,height:m}),super.render({...t,target:e,pass:"shadow"})})}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const uZ=fk(function gZ({viewport:i,center:t}){return new sg(i.viewProjectionMatrix).invert().transform(t)}),hZ=fk(function _Z({viewport:i,shadowMatrices:t}){const e=[],n=i.pixelUnprojectionMatrix,r=i.isGeospatial?void 0:1,l=[[0,0,r],[i.width,0,r],[0,i.height,r],[i.width,i.height,r],[0,0,-1],[i.width,0,-1],[0,i.height,-1],[i.width,i.height,-1]].map(m=>function pZ(i,t){const[e,n,r]=i,l=D3([e,n,r],t);return Number.isFinite(r)?l:[l[0],l[1],0]}(m,n));for(const m of t){const C=m.clone().translate(new Nm(i.center).negate()),A=l.map(z=>C.transform(z)),O=(new sg).ortho({left:Math.min(...A.map(z=>z[0])),right:Math.max(...A.map(z=>z[0])),bottom:Math.min(...A.map(z=>z[1])),top:Math.max(...A.map(z=>z[1])),near:Math.min(...A.map(z=>-z[2])),far:Math.max(...A.map(z=>-z[2]))});e.push(O.multiplyRight(m))}return e}),fZ=[0,0,0,1],mZ=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],rB={name:"shadow",dependencies:[eB],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(i={},t={})=>"viewport"in i&&(i.drawToShadowMap||i.shadowMaps&&i.shadowMaps.length>0)?function vZ(i,t){const{shadowEnabled:e=!0}=i;if(!e||!i.shadowMatrices||!i.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const n={shadow_uDrawShadowMap:!!i.drawToShadowMap,shadow_uUseShadowMap:!!i.shadowMaps&&i.shadowMaps.length>0,shadow_uColor:i.shadowColor||fZ,shadow_uLightId:i.shadowLightId||0,shadow_uLightCount:i.shadowMatrices.length},r=uZ({viewport:i.viewport,center:t.project_uCenter}),l=[],m=hZ({shadowMatrices:i.shadowMatrices,viewport:i.viewport}).slice();for(let C=0;C<i.shadowMatrices.length;C++){const A=m[C],O=A.clone().translate(new Nm(i.viewport.center).negate());t.project_uCoordinateSystem===Ro.LNGLAT&&t.project_uProjectionMode===O_.WEB_MERCATOR?(m[C]=O,l[C]=r):(m[C]=A.clone().multiplyRight(mZ),l[C]=O.transform(r))}for(let C=0;C<m.length;C++)n["shadow_uViewProjectionMatrices[".concat(C,"]")]=m[C],n["shadow_uProjectCenters[".concat(C,"]")]=l[C],n["shadow_uShadowMap".concat(C)]=i.shadowMaps&&i.shadowMaps.length>0?i.shadowMaps[C]:i.dummyShadowMap;return n}(i,t):{}},bZ={color:[255,255,255],intensity:1},Gj=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],yZ=[0,0,0,200/255];class Hj{constructor(t={}){ye(this,"id","lighting-effect"),ye(this,"props",void 0),ye(this,"shadowColor",yZ),ye(this,"shadow",void 0),ye(this,"ambientLight",void 0),ye(this,"directionalLights",void 0),ye(this,"pointLights",void 0),ye(this,"shadowPasses",[]),ye(this,"shadowMaps",[]),ye(this,"dummyShadowMap",null),ye(this,"programManager",void 0),ye(this,"shadowMatrices",void 0),this.setProps(t)}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(e=>e.shadow),this.props=t}preRender(t,{layers:e,layerFilter:n,viewports:r,onViewportActive:l,views:m}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=hk.getDefaultProgramManager(t),rB&&this.programManager.addDefaultModule(rB)),this.dummyShadowMap||(this.dummyShadowMap=new vu(t,{width:1,height:1}));for(let C=0;C<this.shadowPasses.length;C++)this.shadowPasses[C].render({layers:e,layerFilter:n,viewports:r,onViewportActive:l,views:m,moduleParameters:{shadowLightId:C,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(n=>n.getProjectedLight({layer:t})),pointLights:this.pointLights.map(n=>n.getProjectedLight({layer:t}))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(rB),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=(new sg).lookAt({eye:new Nm(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new lZ(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;!t&&0===e.length&&0===n.length&&(this.ambientLight=new eZ(bZ),this.directionalLights.push(new Uj(Gj[0]),new Uj(Gj[1])))}}const xZ=new Hj;class CZ{constructor(){ye(this,"effects",void 0),ye(this,"_resolvedEffects",[]),ye(this,"_defaultEffects",[]),ye(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const e=this._defaultEffects;if(!e.find(n=>n.id===t.id)){const n=e.findIndex(r=>function wZ(i,t){var e,n;return(null!==(e=i.order)&&void 0!==e?e:1/0)-(null!==(n=t.order)&&void 0!==n?n:1/0)}(r,t)>0);n<0?e.push(t):e.splice(n,0,t),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(N_(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._resolvedEffects}_setEffects(t){const e={};for(const r of this.effects)e[r.id]=r;const n=[];for(const r of t){const l=e[r.id];l&&l!==r?l.setProps?(l.setProps(r.props),n.push(l)):(l.cleanup(),n.push(r)):n.push(r),delete e[r.id]}for(const r in e)e[r].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some(r=>r instanceof Hj)||this._resolvedEffects.push(xZ),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class EZ extends nB{shouldDrawLayer(t){const{operation:e}=t.props;return e.includes("draw")||e.includes("terrain")}}const $j={blendFunc:[1,0,32771,0],blendEquation:32774};class Wj extends nB{constructor(...t){super(...t),ye(this,"pickZ",void 0),ye(this,"_colorEncoderState",null)}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:l,pickingFBO:m,deviceRect:{x:C,y:A,width:O,height:z},cullRect:$,effects:Q,pass:te="picking",pickZ:de,moduleParameters:fe}){const ge=this.gl;this.pickZ=de;const Re=this._resetColorEncoder(de),qe=Nl(ge,{scissorTest:!0,scissor:[C,A,O,z],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...$j,blend:!de},()=>super.render({target:m,layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:l,cullRect:$,effects:Q?.filter(yt=>yt.useInPicking),pass:te,isPicking:!0,moduleParameters:fe}));return this._colorEncoderState=null,{decodePickingColor:Re&&SZ.bind(null,Re),stats:qe}}shouldDrawLayer(t){const{pickable:e,operation:n}=t.props;return e&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const r={...t.props.parameters},{pickable:l,operation:m}=t.props;return this._colorEncoderState?l&&m.includes("draw")&&(Object.assign(r,$j),r.blend=!0,r.blendColor=function TZ(i,t,e){const{byLayer:n,byAlpha:r}=i;let l,m=n.get(t);return m?(m.viewports.push(e),l=m.a):(l=n.size+1,l<=255?(m={a:l,layer:t,viewports:[e]},n.set(t,m),r[l]=m):(so.warn("Too many pickable layers, only picking the first 255")(),l=0)),[0,0,0,l/255]}(this._colorEncoderState,t,n)):r.blend=!1,m.includes("terrain")&&(r.blend=!1),r}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function SZ(i,t){const e=i.byAlpha[t[3]];return e&&{pickedLayer:e.layer,pickedViewports:e.viewports,pickedObjectIndex:e.layer.decodePickingColor(t)}}class AZ{constructor(t){ye(this,"gl",void 0),ye(this,"layerFilter",void 0),ye(this,"drawPickingColors",void 0),ye(this,"drawLayersPass",void 0),ye(this,"pickLayersPass",void 0),ye(this,"renderCount",void 0),ye(this,"_needsRedraw",void 0),ye(this,"renderBuffers",void 0),ye(this,"lastPostProcessEffect",void 0),this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new EZ(t),this.pickLayersPass=new Wj(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t,target:t.target||zl.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const r=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,l=e.render({...n,target:r});n.effects&&this._postRender(n.effects,n),this.renderCount++,Bl("deckRenderer.renderLayers",this,l,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){this.lastPostProcessEffect=null,e.preRenderStats=e.preRenderStats||{};for(const n of t)e.preRenderStats[n.id]=n.preRender(this.gl,e),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new zl(this.gl),new zl(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,r={...e,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const l of t)if(l.postRender){if(l.id===this.lastPostProcessEffect){r.target=e.target,l.postRender(this.gl,r);break}const m=l.postRender(this.gl,r);r.inputBuffer=m,r.swapBuffer=m===n[0]?n[1]:n[0]}}}const DZ={pickedColor:null,pickedObjectIndex:-1};function kZ({pickedColors:i,decodePickingColor:t,deviceX:e,deviceY:n,deviceRadius:r,deviceRect:l}){const{x:m,y:C,width:A,height:O}=l;let z=r*r,$=-1,Q=0;for(let te=0;te<O;te++){const de=te+C-n,fe=de*de;if(fe>z)Q+=4*A;else for(let ge=0;ge<A;ge++){if(i[Q+3]-1>=0){const qe=ge+m-e,et=qe*qe+fe;et<=z&&(z=et,$=Q)}Q+=4}}if($>=0){const te=i.slice($,$+4),de=t(te);if(de){const fe=Math.floor($/4/A),ge=$/4-fe*A;return{...de,pickedColor:te,pickedX:m+ge,pickedY:C+fe}}so.error("Picked non-existent layer. Is picking buffer corrupt?")()}return DZ}function Xj({pickInfo:i,viewports:t,pixelRatio:e,x:n,y:r,z:l}){let C,m=t[0];if(t.length>1&&(m=function PZ(i,t){for(let e=i.length-1;e>=0;e--){const n=i[e];if(n.containsPixel(t))return n}return i[0]}(i?.pickedViewports||t,{x:n,y:r})),m){const A=[n-m.x,r-m.y];void 0!==l&&(A[2]=l),C=m.unproject(A)}return{color:null,layer:null,viewport:m,index:-1,picked:!1,x:n,y:r,pixel:[n,r],coordinate:C,devicePixel:i&&"pickedX"in i?[i.pickedX,i.pickedY]:void 0,pixelRatio:e}}function RZ(i){const{pickInfo:t,lastPickedInfo:e,mode:n,layers:r}=i,{pickedColor:l,pickedLayer:m,pickedObjectIndex:C}=t,A=m?[m]:[];if("hover"===n){const Q=e.layerId,te=m?m.props.id:null;if(te!==Q||C!==e.index){if(te!==Q){const de=r.find(fe=>fe.props.id===Q);de&&A.unshift(de)}e.layerId=te,e.index=C,e.info=null}}const O=Xj(i),z=new Map;return z.set(null,O),A.forEach($=>{let Q={...O};$===m&&(Q.color=l,Q.index=C,Q.picked=!0),Q=qj({layer:$,info:Q,mode:n});const te=Q.layer;$===m&&"hover"===n&&(e.info=Q),z.set(te.id,Q),"hover"===n&&te.updateAutoHighlight(Q)}),z}function qj({layer:i,info:t,mode:e}){for(;i&&t;){const n=t.layer||null;t.sourceLayer=n,t.layer=i,t=i.getPickingInfo({info:t,mode:e,sourceLayer:n}),i=i.parent}return t}class OZ{constructor(t){ye(this,"gl",void 0),ye(this,"pickingFBO",void 0),ye(this,"depthFBO",void 0),ye(this,"pickLayersPass",void 0),ye(this,"layerFilter",void 0),ye(this,"lastPickedInfo",void 0),ye(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new Wj(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:r},l=this.lastPickedInfo.info){const m=l&&l.layer&&l.layer.id,C=l&&l.viewport&&l.viewport.id,A=m?n.find(Q=>Q.id===m):null,O=C&&r.find(Q=>Q.id===C)||r[0],z=O&&O.unproject([t-O.x,e-O.y]);return{...l,x:t,y:e,viewport:O,coordinate:z,layer:A}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new zl(n),zl.isSupported(n,{colorBufferFloat:!0}))){const r=new zl(n);r.attach({36064:new vu(n,{format:go(n)?34836:6408,type:5126})}),this.depthFBO=r}null===(t=this.pickingFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height}),null===(e=this.depthFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:r,y:l,radius:m=0,depth:C=1,mode:A="query",unproject3D:O,onViewportActive:z,effects:$}){const Q=this._getPickable(t),te=S_(this.gl);if(!Q)return{result:[],emptyInfo:Xj({viewports:n,x:r,y:l,pixelRatio:te})};this._resizeBuffer();const de=xT(this.gl,[r,l],!0),fe=[de.x+Math.floor(de.width/2),de.y+Math.floor(de.height/2)],ge=Math.round(m*te),{width:Re,height:qe}=this.pickingFBO,et=this._getPickingRect({deviceX:fe[0],deviceY:fe[1],deviceRadius:ge,deviceWidth:Re,deviceHeight:qe}),yt={x:r-m,y:l-m,width:2*m+1,height:2*m+1};let Jt;const fi=[],Hi=new Set;for(let tn=0;tn<C;tn++){let cn,_n;if(cn=et?kZ({...this._drawAndSample({layers:Q,views:e,viewports:n,onViewportActive:z,deviceRect:et,cullRect:yt,effects:$,pass:"picking:".concat(A)}),deviceX:fe[0],deviceY:fe[1],deviceRadius:ge,deviceRect:et}):{pickedColor:null,pickedObjectIndex:-1},cn.pickedLayer&&O&&this.depthFBO){const{pickedColors:Rr}=this._drawAndSample({layers:[cn.pickedLayer],views:e,viewports:n,onViewportActive:z,deviceRect:{x:cn.pickedX,y:cn.pickedY,width:1,height:1},cullRect:yt,effects:$,pass:"picking:".concat(A,":z")},!0);Rr[3]&&(_n=Rr[0])}cn.pickedLayer&&tn+1<C&&(Hi.add(cn.pickedLayer),cn.pickedLayer.disablePickingIndex(cn.pickedObjectIndex)),Jt=RZ({pickInfo:cn,lastPickedInfo:this.lastPickedInfo,mode:A,layers:Q,viewports:n,x:r,y:l,z:_n,pixelRatio:te});for(const Rr of Jt.values())Rr.layer&&fi.push(Rr);if(!cn.pickedColor)break}for(const tn of Hi)tn.restorePickingColors();return{result:fi,emptyInfo:Jt.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:r,y:l,width:m=1,height:C=1,mode:A="query",maxObjects:O=null,onViewportActive:z,effects:$}){const Q=this._getPickable(t);if(!Q)return[];this._resizeBuffer();const te=S_(this.gl),de=xT(this.gl,[r,l],!0),fe=de.x,ge=de.y+de.height,Re=xT(this.gl,[r+m,l+C],!0),et=Re.y,fi=function IZ({pickedColors:i,decodePickingColor:t}){const e=new Map;if(i)for(let n=0;n<i.length;n+=4)if(i[n+3]-1>=0){const l=i.slice(n,n+4),m=l.join(",");if(!e.has(m)){const C=t(l);C?e.set(m,{...C,color:l}):so.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(e.values())}(this._drawAndSample({layers:Q,views:e,viewports:n,onViewportActive:z,deviceRect:{x:fe,y:et,width:Re.x+Re.width-fe,height:ge-et},cullRect:{x:r,y:l,width:m,height:C},effects:$,pass:"picking:".concat(A)})),Hi=new Map,tn=Number.isFinite(O);for(let _n=0;_n<fi.length;_n++){var cn;if(tn&&O&&Hi.size>=O)break;const Rr=fi[_n];let to={color:Rr.pickedColor,layer:null,index:Rr.pickedObjectIndex,picked:!0,x:r,y:l,pixelRatio:te};to=qj({layer:Rr.pickedLayer,info:to,mode:A});const Ts=null!==(cn=to.object)&&void 0!==cn?cn:"".concat(to.layer.id,"[").concat(to.index,"]");Hi.has(Ts)||Hi.set(Ts,to)}return Array.from(Hi.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:r,deviceRect:l,cullRect:m,effects:C,pass:A},O=!1){const z=O?this.depthFBO:this.pickingFBO,$={layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:r,pickingFBO:z,deviceRect:l,cullRect:m,effects:C,pass:A,pickZ:O,preRenderStats:{}};for(const qe of C)qe.useInPicking&&($.preRenderStats[qe.id]=qe.preRender(this.gl,$));const{decodePickingColor:Q}=this.pickLayersPass.render($),{x:te,y:de,width:fe,height:ge}=l,Re=new(O?Float32Array:Uint8Array)(fe*ge*4);return CP(z,{sourceX:te,sourceY:de,sourceWidth:fe,sourceHeight:ge,target:Re}),{pickedColors:Re,decodePickingColor:Q}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:r,deviceHeight:l}){const m=Math.max(0,t-n),C=Math.max(0,e-n),A=Math.min(r,t+n+1)-m,O=Math.min(l,e+n+1)-C;return A<=0||O<=0?null:{x:m,y:C,width:A,height:O}}}const LZ={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class FZ{constructor(t){ye(this,"el",null),ye(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,LZ),e.appendChild(this.el))}setTooltip(t,e,n){const r=this.el;if(r){if("string"==typeof t)r.innerText=t;else{if(!t)return this.isVisible=!1,void(r.style.display="none");t.text&&(r.innerText=t.text),t.html&&(r.innerHTML=t.html),t.className&&(r.className=t.className)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(e,"px, ").concat(n,"px)"),t&&"object"==typeof t&&"style"in t&&Object.assign(r.style,t.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}const{_parseImageNode:BZ}=globalThis,oB=typeof Image<"u",sB=typeof ImageBitmap<"u",aB=!!PT||!!BZ;function Yj(i){const t=function Kj(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&i instanceof Image?"image":i&&"object"==typeof i&&i.data&&i.width&&i.height?"data":null}(i);if(!t)throw new Error("Not an image");return t}const UZ=/^data:image\/svg\+xml/,jZ=/\.svg((\?|#).*)?$/;function lB(i){return i&&(UZ.test(i)||jZ.test(i))}function Qj(i,t){if(lB(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(i)])}function Jj(i,t,e){return cB.apply(this,arguments)}function cB(){return cB=(0,Yt.A)(function*(i,t,e){const n=function GZ(i,t){if(lB(t)){let n=(new TextDecoder).decode(i);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(n=unescape(encodeURIComponent(n)))}catch(l){throw new Error(l.message)}return"data:image/svg+xml;base64,".concat(btoa(n))}return Qj(i,t)}(i,e),r=self.URL||self.webkitURL,l="string"!=typeof n&&r.createObjectURL(n);try{return yield function HZ(i,t){return dB.apply(this,arguments)}(l||n,t)}finally{l&&r.revokeObjectURL(l)}}),cB.apply(this,arguments)}function dB(){return dB=(0,Yt.A)(function*(i,t){const e=new Image;return e.src=i,t.image&&t.image.decode&&e.decode?(yield e.decode(),e):yield new Promise((n,r)=>{try{e.onload=()=>n(e),e.onerror=l=>r(new Error("Could not load image ".concat(i,": ").concat(l)))}catch(l){r(l)}})}),dB.apply(this,arguments)}const $Z={};let e6=!0;function uB(){return uB=(0,Yt.A)(function*(i,t,e){let n;n=lB(e)?yield Jj(i,t,e):Qj(i,e);const r=t&&t.imagebitmap;return yield function XZ(i){return hB.apply(this,arguments)}(n,r)}),uB.apply(this,arguments)}function hB(){return hB=(0,Yt.A)(function*(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if((function qZ(i){for(const t in i||$Z)return!1;return!0}(t)||!e6)&&(t=null),t)try{return yield createImageBitmap(i,t)}catch(e){console.warn(e),e6=!1}return yield createImageBitmap(i)}),hB.apply(this,arguments)}const B_=!1,pk=!0;function t6(i){const t=gk(i);return function tK(i){const t=gk(i);return t.byteLength>=24&&2303741511===t.getUint32(0,B_)?{mimeType:"image/png",width:t.getUint32(16,B_),height:t.getUint32(20,B_)}:null}(t)||function rK(i){const t=gk(i);if(!(t.byteLength>=3&&65496===t.getUint16(0,B_)&&255===t.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:r}=function oK(){const i=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)i.add(e);return{tableMarkers:i,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let l=2;for(;l+9<t.byteLength;){const m=t.getUint16(l,B_);if(r.has(m))return{mimeType:"image/jpeg",height:t.getUint16(l+5,B_),width:t.getUint16(l+7,B_)};if(!n.has(m))return null;l+=2,l+=t.getUint16(l,B_)}return null}(t)||function iK(i){const t=gk(i);return t.byteLength>=10&&1195984440===t.getUint32(0,B_)?{mimeType:"image/gif",width:t.getUint16(6,pk),height:t.getUint16(8,pk)}:null}(t)||function nK(i){const t=gk(i);return t.byteLength>=14&&16973===t.getUint16(0,B_)&&t.getUint32(2,pk)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,pk),height:t.getUint32(22,pk)}:null}(t)||function eK(i){const e=function YZ(i){return function JZ(i,t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=function QZ(i){return[...i].map(t=>t.charCodeAt(0))}(t);for(let r=0;r<n.length;++r)if(n[r]!==i[r+e])return!1;return!0}(i,"ftyp",4)&&96&i[8]?function ZZ(i){switch(function KZ(i,t,e){return String.fromCharCode(...i.slice(t,e))}(i,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}(i):null}(new Uint8Array(i instanceof DataView?i.buffer:i));return e?{mimeType:e.mimeType,width:0,height:0}:null}(t)}function gk(i){if(i instanceof DataView)return i;if(ArrayBuffer.isView(i))return new DataView(i.buffer);if(i instanceof ArrayBuffer)return new DataView(i);throw new Error("toDataView")}function fB(){return fB=(0,Yt.A)(function*(i,t){const{mimeType:e}=t6(i)||{},n=globalThis._parseImageNode;return L1(n),yield n(i,e)}),fB.apply(this,arguments)}function mB(){return mB=(0,Yt.A)(function*(i,t,e){const r=((t=t||{}).image||{}).type||"auto",{url:l}=e||{},m=function lK(i){switch(i){case"auto":case"data":return function zZ(){if(sB)return"imagebitmap";if(oB)return"image";if(aB)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function VZ(i){switch(i){case"auto":return sB||oB||aB;case"imagebitmap":return sB;case"image":return oB;case"data":return aB;default:throw new Error("@loaders.gl/images: image ".concat(i," not supported in this environment"))}}(i),i}}(r);let C;switch(m){case"imagebitmap":C=yield function WZ(i,t,e){return uB.apply(this,arguments)}(i,t,l);break;case"image":C=yield Jj(i,t,l);break;case"data":C=yield function sK(i,t){return fB.apply(this,arguments)}(i,t);break;default:L1(!1)}return"data"===r&&(C=function Zj(i){switch(Yj(i)){case"data":return i;case"image":case"imagebitmap":const t=document.createElement("canvas"),e=t.getContext("2d");if(!e)throw new Error("getImageData");return t.width=i.width,t.height=i.height,e.drawImage(i,0,0),e.getImageData(0,0,i.width,i.height);default:throw new Error("getImageData")}}(C)),C}),mB.apply(this,arguments)}const cK={id:"image",module:"images",name:"Images",version:"3.4.15",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:function aK(i,t,e){return mB.apply(this,arguments)},tests:[i=>!!t6(new DataView(i))],options:{image:{type:"auto",decode:!0}}},uK={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function dK(i){const t=i[0],e=i[i.length-1];return"{"===t&&"}"===e||"["===t&&"]"===e},parseTextSync:JSON.parse},fK=function hK(){const i="8.9.35",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==i)throw new Error("deck.gl - multiple versions detected: ".concat(t," vs ").concat(i));return t||(so.log(1,"deck.gl ".concat(i))(),globalThis.deck={...globalThis.deck,VERSION:i,version:i,log:so,_registerLoggers:WF},function GR(i){const t=jT();i=Array.isArray(i)?i:[i];for(const e of i){const n=ST(e);t.find(r=>n===r)||t.unshift(n)}}([uK,[cK,{imagebitmap:{premultiplyAlpha:"none"}}]])),i}(),DP=globalThis;function i6(i){if(!i&&!Jh())return"Node";if(T2(i))return"Electron";const e=i||(typeof navigator<"u"?navigator:{}).userAgent||"";if(e.indexOf("Edge")>-1)return"Edge";const n=-1!==e.indexOf("MSIE "),r=-1!==e.indexOf("Trident/");return n||r?"IE":DP.chrome?"Chrome":DP.safari?"Safari":DP.mozInnerScreenX?"Firefox":"Unknown"}class kP extends Pb{get[Symbol.toStringTag](){return"Query"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=go(t),r=q1(t,"TIMER_QUERY");let l=n||r;for(const m of e)switch(m){case"queries":l=l&&n;break;case"timers":l=l&&r;break;default:Cn(!1)}return l}constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise((n,r)=>{const l=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(l)};requestAnimationFrame(l)}),this._pollingPromise}_createHandle(){return kP.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const n6=Jh()&&typeof document<"u";let CK=0;class EK{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:e=ge=>R1(ge),onAddHTML:n=null,onInitialize:r=()=>{},onRender:l=()=>{},onFinalize:m=()=>{},onError:C,gl:A=null,glOptions:O={},debug:z=!1,createFramebuffer:$=!1,autoResizeViewport:Q=!0,autoResizeDrawingBuffer:te=!0,stats:de=W1.get("animation-loop-".concat(CK++))}=t;let{useDevicePixels:fe=!0}=t;"useDevicePixelRatio"in t&&(lr.deprecated("useDevicePixelRatio","useDevicePixels")(),fe=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:r,onRender:l,onFinalize:m,onError:C,gl:A,glOptions:O,debug:z,createFramebuffer:$},this.gl=A,this.needsRedraw=null,this.timeline=null,this.stats=de,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:Q,autoResizeDrawingBuffer:te,useDevicePixels:fe}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return Cn("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=kP.isSupported(this.gl,["timers"])?new kP(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(n=>{this._running&&(this._addCallbackData(n||{}),!1!==n&&this._startLoop())});return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}toDataURL(){var t=this;return(0,Yt.A)(function*(){return t.setNeedsRedraw("toDataURL"),yield t.waitForRender(),t.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return lr.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=n6?new Promise((t,e)=>{n6&&"complete"===document.readyState?t(document):window.addEventListener("load",()=>{t(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):function wK(i){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(i):clearTimeout(i)}(t)}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):function xK(i){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(i):setTimeout(i,1e3/60)}(t)}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();(t!==this.animationProps.width||e!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"==typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&typeof OffscreenCanvas<"u"&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?P1(this.props.gl,t):this.onCreateContext(t),!vT(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function rR(i){nf(i,bT)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:r}=this.gl;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function aR(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i.canvas){const n=function oR(i){const t=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(i)?i<=0?1:i:i?t:1}(t.useDevicePixels);return void function hR(i,t,e){let n="width"in e?e.width:i.canvas.clientWidth,r="height"in e?e.height:i.canvas.clientHeight;(!n||!r)&&(lr.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,n=i.canvas.width||1,r=i.canvas.height||1),i.luma=i.luma||{},i.luma.canvasSizeInfo=i.luma.canvasSizeInfo||{};const l=i.luma.canvasSizeInfo;if(l.clientWidth!==n||l.clientHeight!==r||l.devicePixelRatio!==t){let m=t;const C=Math.floor(n*m),A=Math.floor(r*m);i.canvas.width=C,i.canvas.height=A,(i.drawingBufferWidth!==C||i.drawingBufferHeight!==A)&&(lr.warn("Device pixel ratio clamped")(),m=Math.min(i.drawingBufferWidth/n,i.drawingBufferHeight/r),i.canvas.width=Math.floor(n*m),i.canvas.height=Math.floor(r*m)),Object.assign(i.luma.canvasSizeInfo,{clientWidth:n,clientHeight:r,devicePixelRatio:t})}}(i,n,t)}const e=i.getExtension("STACKGL_resize_drawingbuffer");e&&"width"in t&&"height"in t&&e.resize(t.width,t.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new zl(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}var IP=It(511);const TK={mousedown:1,mousemove:2,mouseup:4};(function MK(i){const t=i.prototype.handler;i.prototype.handler=function(n){const r=this.store;n.button>0&&"pointerdown"===n.type&&(function SK(i,t){for(let e=0;e<i.length;e++)if(t(i[e]))return!0;return!1}(r,l=>l.pointerId===n.pointerId)||r.push(n)),t.call(this,n)}})(IP.PointerEventInput),function AK(i){i.prototype.handler=function(e){let n=TK[e.type];1&n&&e.button>=0&&(this.pressed=!0),2&n&&0===e.which&&(n=4),this.pressed&&(4&n&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}}(IP.MouseInput);const DK=IP.Manager,V_=IP;class RP{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const kK=V_?[[V_.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[V_.Rotate,{enable:!1}],[V_.Pinch,{enable:!1}],[V_.Swipe,{enable:!1}],[V_.Pan,{threshold:0,enable:!1}],[V_.Press,{enable:!1}],[V_.Tap,{event:"doubletap",taps:2,enable:!1}],[V_.Tap,{event:"anytap",enable:!1}],[V_.Tap,{enable:!1}]]:null,s6={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},IK={doubletap:["tap"]},RK={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},gB={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},PK={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},a6={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},OK=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",pS=typeof window<"u"?window:global;typeof global<"u"?global:window,typeof document<"u"&&document;let _B=!1;try{pS.addEventListener("test",null,{get passive(){return _B=!0,!0}}),pS.removeEventListener("test",null)}catch{_B=!1}const LK=-1!==OK.indexOf("firefox"),{WHEEL_EVENTS:FK}=gB,c6=4.000244140625;class VK extends RP{constructor(t,e,n){super(t,e,n),this.handleEvent=r=>{if(!this.options.enable)return;let l=r.deltaY;pS.WheelEvent&&(LK&&r.deltaMode===pS.WheelEvent.DOM_DELTA_PIXEL&&(l/=pS.devicePixelRatio),r.deltaMode===pS.WheelEvent.DOM_DELTA_LINE&&(l*=40)),0!==l&&l%c6==0&&(l=Math.floor(l/c6)),r.shiftKey&&l&&(l*=.25),this.callback({type:"wheel",center:{x:r.clientX,y:r.clientY},delta:-l,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(FK),this.events.forEach(r=>t.addEventListener(r,this.handleEvent,!!_B&&{passive:!1}))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){"wheel"===t&&(this.options.enable=e)}}const{MOUSE_EVENTS:zK}=gB,d6="pointermove",u6="pointerover",h6="pointerout",f6="pointerenter",m6="pointerleave";class UK extends RP{constructor(t,e,n){super(t,e,n),this.handleEvent=l=>{this.handleOverEvent(l),this.handleOutEvent(l),this.handleEnterEvent(l),this.handleLeaveEvent(l),this.handleMoveEvent(l)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(zK),this.events.forEach(l=>t.addEventListener(l,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===d6&&(this.enableMoveEvent=e),t===u6&&(this.enableOverEvent=e),t===h6&&(this.enableOutEvent=e),t===f6&&(this.enableEnterEvent=e),t===m6&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this._emit(u6,t)}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this._emit(h6,t)}handleEnterEvent(t){this.enableEnterEvent&&"mouseenter"===t.type&&this._emit(f6,t)}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this._emit(m6,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this._emit(d6,t);break;case"mouseup":this.pressed=!1}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:jK}=gB,p6="keydown";class GK extends RP{constructor(t,e,n){super(t,e,n),this.handleEvent=r=>{const l=r.target||r.srcElement;"INPUT"===l.tagName&&"text"===l.type||"TEXTAREA"===l.tagName||(this.enableDownEvent&&"keydown"===r.type&&this.callback({type:p6,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&"keyup"===r.type&&this.callback({type:"keyup",srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(jK),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach(r=>t.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,e){t===p6&&(this.enableDownEvent=e),"keyup"===t&&(this.enableUpEvent=e)}}const _6="contextmenu";class HK extends RP{constructor(t,e,n){super(t,e,n),this.handleEvent=r=>{this.options.enable&&this.callback({type:_6,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===_6&&(this.options.enable=e)}}const $K={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function tQ(i){const t=$K[i.srcEvent.type];if(!t)return null;const{buttons:e,button:n,which:r}=i.srcEvent;let l=!1,m=!1,C=!1;return 4===t||2===t&&!Number.isFinite(e)?(l=1===r,m=2===r,C=3===r):2===t?(l=!!(1&e),m=!!(4&e),C=!!(2&e)):1===t&&(l=0===n,m=1===n,C=2===n),{leftButton:l,middleButton:m,rightButton:C}}function iQ(i,t){const e=i.center;if(!e)return null;const n=t.getBoundingClientRect();return{center:e,offsetCenter:{x:(e.x-n.left-t.clientLeft)/(n.width/t.offsetWidth||1),y:(e.y-n.top-t.clientTop)/(n.height/t.offsetHeight||1)}}}const yB={srcElement:"root",priority:0};class nQ{constructor(t){this.handleEvent=e=>{if(this.isEmpty())return;const n=this._normalizeEvent(e);let r=e.srcEvent.target;for(;r&&r!==n.rootElement;){if(this._emit(n,r),n.handled)return;r=r.parentNode}this._emit(n,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n,r=!1,l=!1){const{handlers:m,handlersByElement:C}=this;let A=yB;"string"==typeof n||n&&n.addEventListener?A={...yB,srcElement:n}:n&&(A={...yB,...n});let O=C.get(A.srcElement);O||(O=[],C.set(A.srcElement,O));const z={type:t,handler:e,srcElement:A.srcElement,priority:A.priority};r&&(z.once=!0),l&&(z.passive=!0),m.push(z),this._active=this._active||!z.passive;let $=O.length-1;for(;$>=0&&!(O[$].priority>=z.priority);)$--;O.splice($+1,0,z)}remove(t,e){const{handlers:n,handlersByElement:r}=this;for(let l=n.length-1;l>=0;l--){const m=n[l];if(m.type===t&&m.handler===e){n.splice(l,1);const C=r.get(m.srcElement);C.splice(C.indexOf(m),1),0===C.length&&r.delete(m.srcElement)}}this._active=n.some(l=>!l.passive)}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let r=!1;const l=()=>{t.handled=!0},m=()=>{t.handled=!0,r=!0},C=[];for(let A=0;A<n.length;A++){const{type:O,handler:z,once:$}=n[A];if(z({...t,type:O,stopPropagation:l,stopImmediatePropagation:m}),$&&C.push(n[A]),r)break}for(let A=0;A<C.length;A++){const{type:O,handler:z}=C[A];this.remove(O,z)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...tQ(t),...iQ(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const rQ={events:null,recognizers:null,recognizerOptions:{},Manager:DK,touchAction:"none",tabIndex:0};class oQ{constructor(t=null,e){this._onBasicInput=r=>{const{srcEvent:l}=r,m=RK[l.type];m&&this.manager.emit(m,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...rQ,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this;this.manager=new(0,e.Manager)(t,{touchAction:e.touchAction,recognizers:e.recognizers||kK}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(s6).forEach(r=>{const l=this.manager.get(r);l&&s6[r].forEach(m=>{l.recognizeWith(m)})});for(const r in e.recognizerOptions){const l=this.manager.get(r);if(l){const m=e.recognizerOptions[r];delete m.enable,l.set(m)}}this.wheelInput=new VK(t,this._onOtherEvent,{enable:!1}),this.moveInput=new UK(t,this._onOtherEvent,{enable:!1}),this.keyInput=new GK(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new HK(t,this._onOtherEvent,{enable:!1});for(const[r,l]of this.events)l.isEmpty()||(this._toggleRecognizer(l.recognizerName,!0),this.manager.on(r,l.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});const l=IK[t];l&&!this.options.recognizers&&l.forEach(m=>{const C=n.get(m);e?(C.requireFailure(t),r.dropRequireFailure(m)):C.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,r,l){if("string"!=typeof t){n=e;for(const z in t)this._addEventHandler(z,t[z],n,r,l);return}const{manager:m,events:C}=this,A=a6[t]||t;let O=C.get(A);O||(O=new nQ(this),C.set(A,O),O.recognizerName=PK[A]||A,m&&m.on(A,O.handleEvent)),O.add(t,e,n,r,l),O.isEmpty()||this._toggleRecognizer(O.recognizerName,!0)}_removeEventHandler(t,e){if("string"!=typeof t){for(const m in t)this._removeEventHandler(m,t[m]);return}const{events:n}=this,l=n.get(a6[t]||t);if(l&&(l.remove(t,e),l.isEmpty())){const{recognizerName:m}=l;let C=!1;for(const A of n.values())if(A.recognizerName===m&&!A.isEmpty()){C=!0;break}C||this._toggleRecognizer(m,!1)}}}function K1(){}const v6={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:K1,onResize:K1,onViewStateChange:K1,onInteractionStateChange:K1,onBeforeRender:K1,onAfterRender:K1,onLoad:K1,onError:i=>so.error(i.message,i.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:i})=>i?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class gS{constructor(t){ye(this,"props",void 0),ye(this,"width",0),ye(this,"height",0),ye(this,"userData",{}),ye(this,"canvas",null),ye(this,"viewManager",null),ye(this,"layerManager",null),ye(this,"effectManager",null),ye(this,"deckRenderer",null),ye(this,"deckPicker",null),ye(this,"eventManager",null),ye(this,"tooltip",null),ye(this,"metrics",void 0),ye(this,"animationLoop",void 0),ye(this,"stats",void 0),ye(this,"viewState",void 0),ye(this,"cursorState",void 0),ye(this,"_needsRedraw",void 0),ye(this,"_pickRequest",void 0),ye(this,"_lastPointerDownInfo",null),ye(this,"_metricsCounter",void 0),ye(this,"_onPointerMove",e=>{const{_pickRequest:n}=this;if("pointerleave"===e.type)n.x=-1,n.y=-1,n.radius=0;else{if(e.leftButton||e.rightButton)return;{const r=e.offsetCenter;if(!r)return;n.x=r.x,n.y=r.y,n.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:n.x,y:n.y}),n.event=e}),ye(this,"_onEvent",e=>{const n=j5[e.type],r=e.offsetCenter;if(!n||!r||!this.layerManager)return;const l=this.layerManager.getLayers(),m=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:l,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:C}=m,A=C&&(C[n.handler]||C.props[n.handler]),O=this.props[n.handler];let z=!1;A&&(z=A.call(C,m,e)),!z&&O&&O(m,e)}),ye(this,"_onPointerDown",e=>{const n=e.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:n.x,y:n.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...v6,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&so.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===i6()&&so.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||typeof document<"u"&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new _D({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&kb.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,r,l,m,C,A,O;null===(t=this.animationLoop)||void 0===t||t.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(n=this.viewManager)||void 0===n||n.finalize(),this.viewManager=null,null===(r=this.effectManager)||void 0===r||r.finalize(),this.effectManager=null,null===(l=this.deckRenderer)||void 0===l||l.finalize(),this.deckRenderer=null,null===(m=this.deckPicker)||void 0===m||m.finalize(),this.deckPicker=null,null===(C=this.eventManager)||void 0===C||C.destroy(),this.eventManager=null,null===(A=this.tooltip)||void 0===A||A.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas||(null===(O=this.canvas.parentElement)||void 0===O||O.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&so.removed("onLayerHover","onHover")(),"onLayerClick"in t&&so.removed("onLayerClick","onClick")(),t.initialViewState&&!N_(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),r=this.layerManager.needsRedraw(t),l=this.effectManager.needsRedraw(t),m=this.deckRenderer.needsRedraw(t);return e=e||n||r||l||m,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return null!==this.viewManager}getViews(){return gl(this.viewManager),this.viewManager.views}getViewports(t){return gl(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_pick(t,e,n){gl(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(e).timeStart();const l=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return r.get(e).timeEnd(),l}_createCanvas(t){let e=t.canvas;return"string"==typeof e&&(e=document.getElementById(e),gl(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||0===e){const l=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=l}if(n||0===n){var r;const l=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(r=t.style)||void 0===r?void 0:r.position)||"absolute",this.canvas.style.height=l}}_updateCanvasSize(){var t,e;const{canvas:n}=this;if(!n)return;const r=null!==(t=n.clientWidth)&&void 0!==t?t:n.width,l=null!==(e=n.clientHeight)&&void 0!==e?e:n.height;var m,C;r===this.width&&l===this.height||(this.width=r,this.height=l,null===(m=this.viewManager)||void 0===m||m.setProps({width:r,height:l}),null===(C=this.layerManager)||void 0===C||C.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:l}))}_createAnimationLoop(t){const{width:e,height:n,gl:r,glOptions:l,debug:m,onError:C,onBeforeRender:A,onAfterRender:O,useDevicePixels:z}=t;return new EK({width:e,height:n,useDevicePixels:z,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,gl:r,onCreateContext:$=>R1({...l,...$,canvas:this.canvas,debug:m,onContextLost:()=>this._onContextLost()}),onInitialize:$=>this._setGLContext($.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:A,onAfterRender:O,onError:C})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new iB({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:r}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let l=r,m=!1;for(const C of n){var e;l=C,m=(null===(e=C.layer)||void 0===e?void 0:e.onHover(C,t.event))||m}if(!m&&this.props.onHover&&this.props.onHover(l,t.event),this.props.getTooltip&&this.tooltip){const C=this.props.getTooltip(l);this.tooltip.setTooltip(C,l.x,l.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,P1(t,{enable:!0,copyState:!0})),this.tooltip=new FZ(this.canvas),nf(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new CT;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new oQ(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in j5)this.eventManager.on(r,this._onEvent);this.viewManager=new FY({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new LY(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new CZ,this.deckRenderer=new AZ(t),this.deckPicker=new OZ(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;nf(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),so.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=W1.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}ye(gS,"defaultProps",v6),ye(gS,"VERSION",fK);class xB extends tP{constructor(t=0,e=0){super(2),I_(t)&&1===arguments.length?this.copy(t):(Va.debug&&(sc(t),sc(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return Va.debug&&(sc(t.x),sc(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return ik(this,this,t),this.check()}transformAsVector(t){return JD(this,this,t),this.check()}transformByMatrix3(t){return function ax(i,t,e){var n=t[0],r=t[1];i[0]=e[0]*n+e[3]*r+e[6],i[1]=e[1]*n+e[4]*r+e[7]}(this,this,t),this.check()}transformByMatrix2x3(t){return function Bd(i,t,e){var n=t[0],r=t[1];i[0]=e[0]*n+e[2]*r+e[4],i[1]=e[1]*n+e[3]*r+e[5]}(this,this,t),this.check()}transformByMatrix2(t){return function pl(i,t,e){var n=t[0],r=t[1];i[0]=e[0]*n+e[2]*r,i[1]=e[1]*n+e[3]*r}(this,this,t),this.check()}}const wB=85.05113;function b6(i,t,e,n){if(e){if(e.userData._googleMap===i)return e;CB(e)}const r={click:null,rightclick:null,dblclick:null,mousemove:null,mouseout:null},l=new gS({...n,useDevicePixels:!!n.interleaved||n.useDevicePixels,style:n.interleaved?null:{pointerEvents:"none"},parent:sQ(t,n.style),initialViewState:{longitude:0,latitude:0,zoom:1},controller:!1});for(const m in r)r[m]=i.addListener(m,C=>cQ(l,m,C));return l.userData._googleMap=i,l.userData._eventListeners=r,l}function sQ(i,t){const e=document.createElement("div");var n,r;return e.style.position="absolute",Object.assign(e.style,t),"getPanes"in i?null===(n=i.getPanes())||void 0===n||n.overlayLayer.appendChild(e):null===(r=i.getMap())||void 0===r||r.getDiv().appendChild(e),e}function CB(i){const{_eventListeners:t}=i.userData;for(const e in t)t[e]&&t[e].remove();i.finalize()}function y6(i,t){const{width:e,height:n}=x6(i),{center:r,heading:l,tilt:m,zoom:C}=t.getCameraParams(),O=n?e/n:1,Q=(new sg).perspective({fovy:25*Math.PI/180,aspect:O,near:.75,far:3e14});return{width:e,height:n,viewState:{altitude:.5*Q[5],bearing:l,latitude:r.lat(),longitude:r.lng(),pitch:m,projectionMatrix:Q,repeat:!0,zoom:C-1}}}function x6(i){const t=i.getDiv().firstChild;return{width:t.offsetWidth,height:t.offsetHeight}}function EB(i,t,e){const n=new google.maps.Point(t,e),r=i.fromContainerPixelToLatLng(n);return[r.lng(),r.lat()]}function lQ(i,t){if(i.pixel)return i.pixel;const e=t.getViewports()[0].project([i.latLng.lng(),i.latLng.lat()]);return{x:e[0],y:e[1]}}function cQ(i,t,e){if(!i.isInitialized)return;const n={type:t,offsetCenter:lQ(e,i),srcEvent:e};switch(t){case"click":case"rightclick":n.type="click",n.tapCount=1,i._onPointerDown(n),i._onEvent(n);break;case"dblclick":n.type="click",n.tapCount=2,i._onEvent(n);break;case"mousemove":n.type="pointermove",i._onPointerMove(n);break;case"mouseout":n.type="pointerleave",i._onPointerMove(n);break;default:return}}const dQ=()=>!1,uQ={depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],blendEquation:32774};function w6(){}const hQ={interleaved:!0};class C6{constructor(t){ye(this,"props",{}),ye(this,"_map",null),ye(this,"_deck",null),ye(this,"_overlay",null),this.setProps({...hQ,...t})}setMap(t){if(t===this._map)return;const{VECTOR:e,UNINITIALIZED:n}=google.maps.RenderingType;var r;this._map&&(!t&&this._map.getRenderingType()===e&&this.props.interleaved&&this._overlay.requestRedraw(),null===(r=this._overlay)||void 0===r||r.setMap(null),this._map=null),t&&(this._map=t,t.getRenderingType()!==n?this._createOverlay(t):t.addListener("renderingtype_changed",()=>{this._createOverlay(t)}))}setProps(t){if(Object.assign(this.props,t),this._deck){const e=this._deck.getCanvas();t.style&&null!=e&&e.parentElement&&(Object.assign(e.parentElement.style,t.style),t.style=null),this._deck.setProps(t)}}pickObject(t){return this._deck&&this._deck.pickObject(t)}pickMultipleObjects(t){return this._deck&&this._deck.pickMultipleObjects(t)}pickObjects(t){return this._deck&&this._deck.pickObjects(t)}finalize(){this.setMap(null),this._deck&&(CB(this._deck),this._deck=null)}_createOverlay(t){const{interleaved:e}=this.props,{VECTOR:n,UNINITIALIZED:r}=google.maps.RenderingType,l=t.getRenderingType();if(l===r)return;const A=new(l===n&&google.maps.WebGLOverlayView?google.maps.WebGLOverlayView:google.maps.OverlayView);A instanceof google.maps.WebGLOverlayView?(e?(A.onAdd=w6,A.onContextRestored=this._onContextRestored.bind(this),A.onDraw=this._onDrawVectorInterleaved.bind(this)):(A.onAdd=this._onAdd.bind(this),A.onContextRestored=w6,A.onDraw=this._onDrawVectorOverlay.bind(this)),A.onContextLost=this._onContextLost.bind(this)):(A.onAdd=this._onAdd.bind(this),A.draw=this._onDrawRaster.bind(this)),A.onRemove=this._onRemove.bind(this),this._overlay=A,this._overlay.setMap(t)}_onAdd(){this._deck=b6(this._map,this._overlay,this._deck,this.props)}_onContextRestored({gl:t}){if(!this._map||!this._overlay)return;const n=b6(this._map,this._overlay,this._deck,{gl:t,_customRender:()=>{this._overlay&&this._overlay.requestRedraw()},...this.props});this._deck=n;const{animationLoop:r}=n;r._renderFrame=()=>{const l=t.getParameter(34964);Nl(t,{},()=>{r.onRender()}),t.bindBuffer(34962,l)}}_onContextLost(){this._deck&&(CB(this._deck),this._deck=null)}_onRemove(){var t;null===(t=this._deck)||void 0===t||t.setProps({layerFilter:dQ})}_onDrawRaster(){if(!this._deck||!this._map)return;const t=this._deck,{width:e,height:n,left:r,top:l,...m}=function aQ(i,t){const{width:e,height:n}=x6(i),r=t.getProjection(),l=i.getBounds();if(!l)return{width:e,height:n,left:0,top:0};const m=l.getNorthEast(),C=l.getSouthWest(),A=r.fromLatLngToDivPixel(m),O=r.fromLatLngToDivPixel(C),z=EB(r,e/2,n/2),$=new google.maps.LatLng(0,z[0]),Q=r.fromLatLngToContainerPixel($),te=r.fromLatLngToDivPixel($);if(!(A&&O&&te&&Q))return{width:e,height:n,left:0,top:0};const de=Math.round(te.x-Q.x);let fe=te.y-Q.y;const ge=EB(r,e/2,0),Re=EB(r,e/2,n);let qe=z[1];const et=z[0];if(Math.abs(qe)>wB){qe=qe>0?wB:-wB;const cn=new google.maps.LatLng(qe,et);fe+=r.fromLatLngToContainerPixel(cn).y-n/2}fe=Math.round(fe);let Jt=180*new xB(ge).sub(Re).verticalAngle()/Math.PI;Jt<0&&(Jt+=360);const fi=i.getHeading()||0;let tn,Hi=i.getZoom()-1;if(0===Jt)tn=n?(O.y-A.y)/n:1;else if(Jt===fi){const cn=new xB([A.x,A.y]).sub([O.x,O.y]).len(),_n=new xB([e,-n]).len();tn=_n?cn/_n:1}return Hi+=Math.log2(tn||1),{width:e,height:n,left:de,top:fe,zoom:Hi,bearing:Jt,pitch:i.getTilt(),latitude:qe,longitude:et}}(this._map,this._overlay),C=t.getCanvas();if(null!=C&&C.parentElement){const O=C.parentElement.style;O.left="".concat(r,"px"),O.top="".concat(l,"px")}t.setProps({width:e,height:n,viewState:{altitude:1e4,repeat:!0,...m}}),t.redraw()}_onDrawVectorInterleaved({gl:t,transformer:e}){if(!this._deck||!this._map)return;const n=this._deck;if(n.setProps({...y6(this._map,e),width:null,height:null}),n.isInitialized){const r=yT(t,36006);n.setProps({_framebuffer:r}),n.needsRedraw({clearRedrawFlags:!0}),nf(t,{viewport:[0,0,t.canvas.width,t.canvas.height],scissor:[0,0,t.canvas.width,t.canvas.height],stencilFunc:[519,0,255,519,0,255]}),Nl(t,uQ,()=>{n._drawLayers("google-vector",{clearCanvas:!1})})}}_onDrawVectorOverlay({transformer:t}){if(!this._deck||!this._map)return;const e=this._deck;e.setProps({...y6(this._map,t)}),e.redraw()}}const TB=512,fQ=Math.PI/180;function E6({map:i,gl:t,deck:e}){if(i.__deck)return i.__deck;const n=e?.props._customRender,r=e?.props.onLoad,l=M6({...e?.props,_customRender:()=>{i.triggerRepaint(),n?.("")}});let m;return(!e||e.props.gl===t)&&(Object.assign(l,{gl:t,width:null,height:null,touchAction:"unset",viewState:_k(i)}),null!=e&&e.isInitialized?T6(e,i):l.onLoad=()=>{r?.(),T6(m,i)}),e?(m=e,e.setProps(l),e.userData.isExternal=!0):(m=new gS(l),i.on("remove",()=>{S6(i)})),m.userData.mapboxLayers=new Set,i.__deck=m,i.on("render",()=>{m.isInitialized&&function bQ(i,t){const{mapboxLayers:e,isExternal:n}=i.userData;if(n){const r=Array.from(e,z=>z.id),m=Z0(i.props.layers,Boolean).some(z=>z&&!r.includes(z.id));let C=i.getViewports();const A=C.findIndex(z=>"mapbox"===z.id);(m||C.length>1||A<0)&&(A>=0&&(C=C.slice(),C[A]=A6(i,t,!1)),i._drawLayers("mapbox-repaint",{viewports:C,layerFilter:z=>(!i.props.layerFilter||i.props.layerFilter(z))&&("mapbox"!==z.viewport.id||!r.includes(z.layer.id)),clearCanvas:!1}))}i.userData.currentViewport=null}(m,i)}),m}function T6(i,t){const e=()=>{i.isInitialized?function yQ(i,t){i.setProps({viewState:_k(t)}),i.needsRedraw({clearRedrawFlags:!0})}(i,t):t.off("move",e)};t.on("move",e)}function S6(i){var t;null===(t=i.__deck)||void 0===t||t.finalize(),i.__deck=null}function M6(i){return{...i,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...i.parameters},views:i.views||[new iB({id:"mapbox"})]}}function _k(i){var t;const{lng:e,lat:n}=i.getCenter(),r={longitude:(e+540)%360-180,latitude:n,zoom:i.getZoom(),bearing:i.getBearing(),pitch:i.getPitch(),padding:i.getPadding(),repeat:i.getRenderWorldCopies()};return null!==(t=i.getTerrain)&&void 0!==t&&t.call(i)&&function vQ(i,t){if(i.getFreeCameraOptions){const{position:e}=i.getFreeCameraOptions();if(!e||void 0===e.z)return;const n=i.transform.height,{longitude:r,latitude:l,pitch:m}=t,C=e.x*TB,A=(1-e.y)*TB,O=e.z*TB,z=rk([r,l]),$=C-z[0],Q=A-z[1],te=Math.sqrt($*$+Q*Q),de=m*fQ,fe=1.5*n,ge=de<.001?fe*Math.cos(de)/O:fe*Math.sin(de)/te;t.zoom=Math.log2(ge);const Re=fe*Math.cos(de)/ge;t.position=[0,0,(O-Re)/vP(l)]}else"number"==typeof i.transform.elevation&&(t.position=[0,0,i.transform.elevation])}(i,r),r}function A6(i,t,e=!0){return new Y1({id:"mapbox",x:0,y:0,width:i.width,height:i.height,..._k(t),nearZMultiplier:e?.02:.1,nearZ:t.transform._nearZ/t.transform.height,farZ:t.transform._farZ/t.transform.height})}function SB(i){if(i.userData.isExternal)return;const t=[];i.userData.mapboxLayers.forEach(e=>{const r=new(0,e.props.type)(e.props);t.push(r)}),i.setProps({layers:t})}class xQ{constructor(t){if(ye(this,"id",void 0),ye(this,"type",void 0),ye(this,"renderingMode",void 0),ye(this,"map",void 0),ye(this,"deck",void 0),ye(this,"props",void 0),!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,e){this.map=t,this.deck=E6({map:t,gl:e,deck:this.props.deck}),function mQ(i,t){i.userData.mapboxLayers.add(t),SB(i)}(this.deck,this)}onRemove(){this.deck&&function pQ(i,t){i.userData.mapboxLayers.delete(t),SB(i)}(this.deck,this)}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&function gQ(i){SB(i)}(this.deck)}render(){!function _Q(i,t,e){let{currentViewport:n}=i.userData,r=!1;n||(n=A6(i,t,!0),i.userData.currentViewport=n,r=!0),i.isInitialized&&i._drawLayers("mapbox-repaint",{viewports:[n],layerFilter:({layer:l})=>e.id===l.id||l.props.operation.includes("terrain"),clearStack:r,clearCanvas:!1})}(this.deck,this.map,this)}}const MB="__UNDEFINED__";function OP(i,t,e,n){if(!(i&&t&&i.style&&i.style._loaded))return;const r=Z0(n,Boolean);if(e!==n){const C=Z0(e,Boolean),A=new Set(C.map(O=>O.id));for(const O of r)A.delete(O.id);for(const O of A)i.getLayer(O)&&i.removeLayer(O)}for(const C of r){const A=i.getLayer(C.id);A?A.implementation.setProps(C.props):i.addLayer(new xQ({id:C.id,deck:t}),C.props.beforeId)}const l=i.style._order,m={};for(const C of r){let{beforeId:A}=C.props;(!A||!l.includes(A))&&(A=MB),m[A]=m[A]||[],m[A].push(C.id)}for(const C in m){const A=m[C];let O=C===MB?l.length:l.indexOf(C),z=C===MB?void 0:C;for(let $=A.length-1;$>=0;$--){const Q=A[$],te=l.indexOf(Q);te!==O-1&&(i.moveLayer(Q,z),te>O&&O++),O--,z=Q}}}class wQ{constructor(t){ye(this,"_props",void 0),ye(this,"_deck",void 0),ye(this,"_map",void 0),ye(this,"_container",void 0),ye(this,"_interleaved",void 0),ye(this,"_lastMouseDownPoint",void 0),ye(this,"_handleStyleChange",()=>{OP(this._map,this._deck,this._props.layers,this._props.layers)}),ye(this,"_updateContainerSize",()=>{if(this._map&&this._container){const{clientWidth:r,clientHeight:l}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(r,"px"),height:"".concat(l,"px")})}}),ye(this,"_updateViewState",()=>{const r=this._deck;r&&(r.setProps({viewState:_k(this._map)}),r.isInitialized&&r.redraw())}),ye(this,"_handleMouseEvent",r=>{const l=this._deck;if(!l||!l.isInitialized)return;const m={type:r.type,offsetCenter:r.point,srcEvent:r},C=this._lastMouseDownPoint;switch(!r.point&&C&&(m.deltaX=r.originalEvent.clientX-C.clientX,m.deltaY=r.originalEvent.clientY-C.clientY,m.offsetCenter={x:C.x+m.deltaX,y:C.y+m.deltaY}),m.type){case"mousedown":l._onPointerDown(m),this._lastMouseDownPoint={...r.point,clientX:r.originalEvent.clientX,clientY:r.originalEvent.clientY};break;case"dragstart":m.type="panstart",l._onEvent(m);break;case"drag":m.type="panmove",l._onEvent(m);break;case"dragend":m.type="panend",l._onEvent(m);break;case"click":m.tapCount=1,l._onEvent(m);break;case"dblclick":m.type="click",m.tapCount=2,l._onEvent(m);break;case"mousemove":m.type="pointermove",l._onPointerMove(m);break;case"mouseout":m.type="pointerleave",l._onPointerMove(m);break;default:return}});const{interleaved:e=!1,...n}=t;this._interleaved=e,this._props=n}setProps(t){this._interleaved&&t.layers&&OP(this._map,this._deck,this._props.layers,t.layers),Object.assign(this._props,t),this._deck&&this._deck.setProps(this._interleaved?M6(this._props):this._props)}onAdd(t){return this._map=t,this._interleaved?this._onAddInterleaved(t):this._onAddOverlaid(t)}_onAddOverlaid(t){const e=document.createElement("div");return Object.assign(e.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=e,this._deck=new gS({...this._props,parent:e,viewState:_k(t)}),t.on("resize",this._updateContainerSize),t.on("render",this._updateViewState),t.on("mousedown",this._handleMouseEvent),t.on("dragstart",this._handleMouseEvent),t.on("drag",this._handleMouseEvent),t.on("dragend",this._handleMouseEvent),t.on("mousemove",this._handleMouseEvent),t.on("mouseout",this._handleMouseEvent),t.on("click",this._handleMouseEvent),t.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),e}_onAddInterleaved(t){return this._deck=E6({map:t,gl:t.painter.context.gl,deck:new gS({...this._props,gl:t.painter.context.gl})}),t.on("styledata",this._handleStyleChange),OP(t,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const t=this._map;t&&(this._interleaved?this._onRemoveInterleaved(t):this._onRemoveOverlaid(t)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(t){var e;t.off("resize",this._updateContainerSize),t.off("render",this._updateViewState),t.off("mousedown",this._handleMouseEvent),t.off("dragstart",this._handleMouseEvent),t.off("drag",this._handleMouseEvent),t.off("dragend",this._handleMouseEvent),t.off("mousemove",this._handleMouseEvent),t.off("mouseout",this._handleMouseEvent),t.off("click",this._handleMouseEvent),t.off("dblclick",this._handleMouseEvent),null===(e=this._deck)||void 0===e||e.finalize()}_onRemoveInterleaved(t){t.off("styledata",this._handleStyleChange),OP(t,this._deck,this._props.layers,[]),S6(t)}getDefaultPosition(){return"top-left"}pickObject(t){return gl(this._deck),this._deck.pickObject(t)}pickMultipleObjects(t){return gl(this._deck),this._deck.pickMultipleObjects(t)}pickObjects(t){return gl(this._deck),this._deck.pickObjects(t)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}class AB{constructor(t,e){ye(this,"opts",void 0),ye(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:r}=e;let l=n;if(n&&n.length!==r){l=new Float32Array(r);const m=e.elementOffset||0;for(let C=0;C<r;++C)l[C]=n[m+C]}return l}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function LP(i){return i.stride||i.size*i.bytesPerElement}function D6(i,t){t.offset&&so.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const e=LP(i),l=(void 0!==t.vertexOffset?t.vertexOffset:i.vertexOffset||0)*e+(t.elementOffset||0)*i.bytesPerElement+(i.offset||0);return{...t,offset:l,stride:e}}class TQ{constructor(t,e,n){ye(this,"gl",void 0),ye(this,"id",void 0),ye(this,"size",void 0),ye(this,"settings",void 0),ye(this,"value",void 0),ye(this,"doublePrecision",void 0),ye(this,"_buffer",void 0),ye(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const r=e.logicalType||e.type,l=5130===r;let C,{defaultValue:m}=e;m=Number.isFinite(m)?[m]:m||new Array(this.size).fill(0),C=l?5126:!r&&e.isIndexed?t&&gj(t,"ELEMENT_INDEX_UINT32")?5125:5123:r||5126;let A=function CQ(i){switch(i){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(r||C||5126);this.doublePrecision=l,l&&!1===e.fp64&&(A=Float32Array),this.value=null,this.settings={...e,defaultType:A,defaultValue:m,logicalType:r,type:C,size:this.size,bytesPerElement:A.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new is(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*LP(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),kb.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},r=this.value instanceof Float64Array,l=function EQ(i,t){const e=D6(i,t);return{high:e,low:{...e,offset:e.offset+4*i.size}}}(this.getAccessor(),e||{});return n[t]=new AB(this,l.high),n["".concat(t,"64Low")]=r?new AB(this,l.low):new Float32Array(this.size),n}if(e){const n=D6(this.getAccessor(),e);return{[t]:new AB(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:r}=this,l=n*r;if(e&&l&&e.length>=l){const m=new Array(r).fill(1/0),C=new Array(r).fill(-1/0);for(let A=0;A<l;)for(let O=0;O<r;O++){const z=e[A++];z<m[O]&&(m[O]=z),z>C[O]&&(C[O]=z)}t=[m,C]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;n=ArrayBuffer.isView(t)?{value:t}:t instanceof is?{buffer:t}:t;const r={...this.settings,...n};if(e.bufferAccessor=r,e.bounds=null,n.constant){let l=n.value;if(l=this._normalizeValue(l,[],0),this.settings.normalized&&(l=this.normalizeConstant(l)),e.constant&&this._areValuesEqual(l,this.value))return!1;e.externalBuffer=null,e.constant=!0,this.value=l}else if(n.buffer){const l=n.buffer;e.externalBuffer=l,e.constant=!1,this.value=n.value||null;const m=n.value instanceof Float64Array;r.type=n.type||l.accessor.type,r.bytesPerElement=l.accessor.BYTES_PER_ELEMENT*(m?2:1),r.stride=LP(r)}else if(n.value){this._checkExternalBuffer(n);let l=n.value;e.externalBuffer=null,e.constant=!1,this.value=l,r.bytesPerElement=l.BYTES_PER_ELEMENT,r.stride=LP(r);const{buffer:m,byteOffset:C}=this;this.doublePrecision&&l instanceof Float64Array&&(l=tS(l,r));const A=l.byteLength+C+2*r.stride;m.byteLength<A&&m.reallocate(A),m.setAccessor(null),m.subData({data:l,offset:C}),r.type=n.type||m.accessor.type}return!0}updateSubBuffer(t={}){this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:r}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?tS(e,{size:this.size,startIndex:n,endIndex:r}):e.subarray(n,r),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t,e=!1){const{state:n}=this,r=n.allocatedValue,l=kb.allocate(r,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=l;const{buffer:m,byteOffset:C}=this;return m.byteLength<l.byteLength+C&&(m.reallocate(l.byteLength+C),e&&r&&m.subData({data:r instanceof Float64Array?tS(r,this):r,offset:C})),n.allocatedValue=l,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=e.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));!(e instanceof n)&&this.settings.normalized&&!("normalized"in t)&&so.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map(e=>(e+128)/255*2-1);case 5122:return new Float32Array(t).map(e=>(e+32768)/65535*2-1);case 5121:return new Float32Array(t).map(e=>e/255);case 5123:return new Float32Array(t).map(e=>e/65535);default:return t}}_normalizeValue(t,e,n){const{defaultValue:r,size:l}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t){let m=l;for(;--m>=0;)e[n+m]=r[m];return e}switch(l){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0];break;default:let m=l;for(;--m>=0;)e[n+m]=Number.isFinite(t[m])?t[m]:r[m]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}}const k6=[],I6=[];function FP(i,t=0,e=1/0){let n=k6;const r={index:-1,data:i,target:[]};return i?"function"==typeof i[Symbol.iterator]?n=i:i.length>0&&(I6.length=i.length,n=I6):n=k6,(t>0||Number.isFinite(e))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(t,e),r.index=t-1),{iterable:n,objectInfo:r}}function R6(i){return i&&i[Symbol.asyncIterator]}function P6(i,t){const{size:e,stride:n,offset:r,startIndices:l,nested:m}=t,C=i.BYTES_PER_ELEMENT,A=n?n/C:e,O=r?r/C:0,z=Math.floor((i.length-O)/A);return($,{index:Q,target:te})=>{if(!l){const Re=Q*A+O;for(let qe=0;qe<e;qe++)te[qe]=i[Re+qe];return te}const de=l[Q],fe=l[Q+1]||z;let ge;if(m){ge=new Array(fe-de);for(let Re=de;Re<fe;Re++){const qe=Re*A+O;te=new Array(e);for(let et=0;et<e;et++)te[et]=i[qe+et];ge[Re-de]=te}}else if(A===e)ge=i.subarray(de*e+O,fe*e+O);else{ge=new i.constructor((fe-de)*e);let Re=0;for(let qe=de;qe<fe;qe++){const et=qe*A+O;for(let yt=0;yt<e;yt++)ge[Re++]=i[et+yt]}}return ge}}const SQ=[],NP=[[0,1/0]];function DB(i){const{source:t,target:e,start:n=0,size:r,getData:l}=i,C=t.length,A=(i.end||e.length)-n;if(C>A)return void e.set(t.subarray(0,A),n);if(e.set(t,n),!l)return;let O=C;for(;O<A;){const z=l(O,t);for(let $=0;$<r;$++)e[n+O]=z[$]||0,O++}}const DQ={interpolation:{duration:0,easing:i=>i},spring:{stiffness:.05,damping:.5}};function O6(i,t){if(!i)return null;Number.isFinite(i)&&(i={type:"interpolation",duration:i});const e=i.type||"interpolation";return{...DQ[e],...t,...i,type:e}}function L6(i,t){const e=t.getBuffer();return e?[e,{divisor:0,size:t.size,normalized:t.settings.normalized}]:t.value}function F6(i){switch(i){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(i,'"'))}}function N6(i){i.push(i.shift())}function kB(i,t){const{doublePrecision:e,settings:n,value:r,size:l}=i,m=e&&r instanceof Float64Array?2:1;return(n.noAlloc?r.length:t*l)*m}function B6({buffer:i,numInstances:t,attribute:e,fromLength:n,fromStartIndices:r,getData:l=m=>m}){const m=e.doublePrecision&&e.value instanceof Float64Array?2:1,C=e.size*m,A=e.byteOffset,O=e.startIndices,z=r&&O,$=kB(e,t),Q=e.isConstant;if(!z&&n>=$)return;const te=Q?e.value:e.getBuffer().getData({srcByteOffset:A});if(e.settings.normalized&&!Q){const Re=l;l=(qe,et)=>e.normalizeConstant(Re(qe,et))}const de=Q?(Re,qe)=>l(te,qe):(Re,qe)=>l(te.subarray(Re,Re+C),qe),fe=i.getData({length:n}),ge=new Float32Array($);(function AQ({source:i,target:t,size:e,getData:n,sourceStartIndices:r,targetStartIndices:l}){if(!Array.isArray(l))return DB({source:i,target:t,size:e,getData:n}),t;let m=0,C=0;const A=n&&((z,$)=>n(z+C,$)),O=Math.min(r.length,l.length);for(let z=1;z<O;z++){const $=r[z]*e,Q=l[z]*e;DB({source:i.subarray(m,$),target:t,start:C,end:Q,size:e,getData:A}),m=$,C=Q}C<t.length&&DB({source:[],target:t,start:C,size:e,getData:A})})({source:fe,target:ge,sourceStartIndices:r,targetStartIndices:O,size:C,getData:de}),i.byteLength<ge.byteLength+A&&i.reallocate(ge.byteLength+A),i.subData({data:ge,offset:A})}class IB extends TQ{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:NP}),ye(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition;return O6(Array.isArray(e)?t[e.find(l=>t[l])]:t[e],n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:n=0,endRow:r=1/0}=e;this.state.updateRanges=function MQ(i,t){if(i===NP||(t[0]<0&&(t[0]=0),t[0]>=t[1]))return i;const e=[],n=i.length;let r=0;for(let l=0;l<n;l++){const m=i[l];m[1]<t[0]?(e.push(m),r=l+1):m[0]>t[1]?e.push(m):t=[Math.min(m[0],t[0]),Math.max(m[1],t[1])]}return e.splice(r,0,t),e}(this.state.updateRanges,[n,r])}else this.state.updateRanges=NP}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=SQ}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&!!n.update&&(super.allocate(t,e.updateRanges!==NP),!0)}updateBuffer({numInstances:t,data:e,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:l},settings:{update:m,noAlloc:C}}=this;let A=!0;if(m){for(const[O,z]of l)m.call(r,this,{data:e,startRow:O,endRow:z,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[O,z]of l){const $=Number.isFinite(O)?this.getVertexOffset(O):0,Q=Number.isFinite(z)?this.getVertexOffset(z):C||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:$,endOffset:Q})}this._checkAttributeArray()}else A=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),A}setConstantValue(t){return void 0!==t&&"function"!=typeof t&&(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:r}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),r.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const m=t;return gl(ArrayBuffer.isView(m.value),"invalid ".concat(r.accessor)),n.binaryAccessor=P6(m.value,{size:m.size||this.size,stride:m.stride,offset:m.offset,startIndices:e,nested:!!m.size&&m.size!==this.size}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:r,props:l,numInstances:m}){if(t.constant)return;const{settings:C,state:A,value:O,size:z,startIndices:$}=t,{accessor:Q,transform:te}=C,de=A.binaryAccessor||("function"==typeof Q?Q:l[Q]);gl("function"==typeof de,'accessor "'.concat(Q,'" is not a function'));let fe=t.getVertexOffset(n);const{iterable:ge,objectInfo:Re}=FP(e,n,r);for(const qe of ge){Re.index++;let et=de(qe,Re);if(te&&(et=te.call(this,et)),$){const yt=(Re.index<$.length-1?$[Re.index+1]:m)-$[Re.index];if(et&&Array.isArray(et[0])){let Jt=fe;for(const fi of et)t._normalizeValue(fi,O,Jt),Jt+=z}else et&&et.length>z?O.set(et,fe):(t._normalizeValue(et,Re.target,0),XF({target:O,source:Re.target,start:fe,count:yt}));fe+=yt*z}else t._normalizeValue(et,O,fe),fe+=z}}_validateAttributeUpdaters(){const{settings:t}=this;if(!t.noAlloc&&"function"!=typeof t.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const V6="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",IQ="#version 300 es\n".concat(V6);function z6(i,t){t=Array.isArray(t)?t:[t];const e=i.replace(/^\s+/,"").split(/\s+/),[n,r,l]=e;return t.includes(n)&&r&&l?{qualifier:n,type:r,name:l.split(";")[0]}:null}function U6(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:t=100,input:e,inputType:n,output:r}=i;if(!e)return 300===t?IQ:t>300?"#version ".concat(t,"\n").concat(V6):"void main() {gl_FragColor = vec4(0);}";const l=function OQ(i,t){switch(t){case"float":return"vec4(".concat(i,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(i,", 0.0, 1.0)");case"vec3":return"vec4(".concat(i,", 1.0)");case"vec4":return i;default:return sf(!1),null}}(e,n);return t>=300?"#version ".concat(t," ").concat(300===t?"es":"","\nin ").concat(n," ").concat(e,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(l,";\n}"):"varying ".concat(n," ").concat(e,";\nvoid main() {\n  gl_FragColor = ").concat(l,";\n}")}class j6 extends Pb{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(t){return go(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ac(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,lS(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind(()=>{for(const e in t)this.setBuffer(e,t[e])}),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:r,byteSize:l,byteOffset:m}=this._getBufferParams(e);return n<0?(this.unused[t]=r,lr.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,r,m,l),this)}begin(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,r;return t instanceof is?r=t:(r=t.buffer,n=t.byteSize,e=t.byteOffset),(void 0!==e||void 0!==n)&&(e=e||0,n=n||r.byteLength-e),{buffer:r,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e){let r=arguments.length>3?arguments[3]:void 0;const l=e&&e.handle;return l&&void 0!==r?this.gl.bindBufferRange(35982,t,l,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r):this.gl.bindBufferBase(35982,t,l),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}class LQ{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:r}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupBuffers(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof is?n:n.buffer:null}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Cn(go(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap)r in e&&(n[this.feedbackMap[r]]=r);Object.assign(n,t.feedbackBuffers);for(const r in n){const l=n[r];if("string"==typeof l){const m=e[l],{byteLength:C,usage:A,accessor:O}=m;n[r]=this._createNewBuffer(r,{byteLength:C,usage:A,accessor:O})}}return n}_setupBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,e){let{model:n}=e;const{program:r}=n;t.transformFeedback=new j6(this.gl,{program:r,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:e,feedbackBuffers:n}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:e,feedbackBuffers:n})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const r in this.feedbackMap){const l=this.feedbackMap[r];e[r]=t.feedbackBuffers[l],n[l]=t.sourceBuffers[r],Cn(n[l]instanceof is)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new is(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function G6(i){let t=100;const e=i.match(/[^\s]+/g);if(e.length>=2&&"#version"===e[0]){const n=parseInt(e[1],10);Number.isFinite(n)&&(t=n)}return t}const FQ={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},BP="transform_uSize_",H6="transform_position";const HQ={10241:9728,10240:9728,10242:33071,10243:33071};class WQ{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,sourceTextures:n,framebuffer:r,targetTexture:l}=this.bindings[this.currentIndex],m=Object.assign({},e,t.attributes),C=Object.assign({},t.uniforms),A=Object.assign({},t.parameters);let O=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){m.transform_elementID=this.elementIDBuffer;for(const $ in this.samplerTextureMap)C[$]=n[this.samplerTextureMap[$]];this._setSourceTextureParameters();const z=function VQ(i){let{sourceTextureMap:t,targetTextureVarying:e,targetTexture:n}=i;const r={};let l,m;e&&(({width:l,height:m}=n),r["".concat(BP).concat(e)]=[l,m]);for(const C in t)({width:l,height:m}=t[C]),r["".concat(BP).concat(C)]=[l,m];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:l});Object.assign(C,z)}return this.hasTargetTexture&&(O=!1,A.viewport=[0,0,r.width,r.height]),{attributes:m,framebuffer:r,uniforms:C,discard:O,parameters:A}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupTextures(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData(){let{packed:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:e}=this.bindings[this.currentIndex],n=CP(e);if(!t)return n;const r=n.constructor,l=function PQ(i){switch(i){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return sf(!1),null}}(this.targetTextureType),m=new r(n.length*l/4);let C=0;for(let A=0;A<n.length;A+=4)for(let O=0;O<l;O++)m[C++]=n[A+O];return m}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof vu)return n;const r=e[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}_setupTextures(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:r}=t,l=this._createTargetTexture({sourceTextures:n,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:l}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!=typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach((n,r,l)=>{l[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new is(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:e,targetTexture:n}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:e,targetTexture:n})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:r,targetTexture:l}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,r),Object.assign(t.sourceBuffers,n),l){t.targetTexture=l;const{width:m,height:C}=l,{framebuffer:A}=t;A?(A.update({attachments:{36064:l},resizeAttachments:!1}),A.resize({width:m,height:C})):t.framebuffer=new zl(this.gl,{id:"transform-framebuffer",width:m,height:C,attachments:{36064:l}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const n in e)e[n].setParameters(HQ)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);return e[this._swapTexture]=t.targetTexture,{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=function fq(i,t){Cn(i instanceof vu||i instanceof uq||i instanceof hq);const e=i.constructor,{gl:n,width:r,height:l,format:m,type:C,dataFormat:A,border:O,mipmaps:z}=i;return new e(n,Object.assign({width:r,height:l,format:m,type:C,dataFormat:A,border:O,mipmaps:z},t))}(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:r,uniforms:l,targetTextureType:m,inject:C,samplerTextureMap:A}=function BQ(i){let{vs:t,sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=i,m=Object.keys(e).length,C=null;const A={};let O=t,z={};if(m>0||n){const $=O.split("\n"),Q=$.slice();if($.forEach((te,de,fe)=>{if(m>0){const ge=function GQ(i,t){const e={},n=function zQ(i){return z6(i,["attribute","in"])}(i);if(!n)return null;const{type:r,name:l}=n;if(l&&t[l]){const m="// ".concat(i," => Replaced by Transform with a sampler"),{samplerName:C,sizeName:A,uniformDeclerations:O}=function UQ(i){const t="".concat("transform_uSampler_").concat(i),e="".concat(BP).concat(i);return{samplerName:t,sizeName:e,uniformDeclerations:"  uniform sampler2D ".concat(t,";\n  uniform vec2 ").concat(e,";")}}(l),z=function RQ(i){switch(i){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return sf(!1),null}}(r),$="  ".concat(r," ").concat(l," = transform_getInput(").concat(C,", ").concat(A,").").concat(z,";\n");return e[C]=l,{updatedLine:m,inject:{"vs:#decl":O,"vs:#main-start":$},samplerTextureMap:e}}return null}(te,e);if(ge){const{updatedLine:Re,inject:qe}=ge;Q[de]=Re,z=B3([z,qe]),Object.assign(A,ge.samplerTextureMap),m--}}n&&!C&&(C=function jQ(i,t){const e=z6(i,["varying","out"]);return e&&e.name===t?e.type:null}(te,n))}),n){Cn(r);const te="".concat(BP).concat(n),de="uniform vec2 ".concat(te,";\n"),fe="     vec2 ".concat(H6," = transform_getPos(").concat(te,");\n     gl_Position = vec4(").concat(H6,", 0, 1.);\n");z=B3([z,{"vs:#decl":de,"vs:#main-start":fe}])}O=Q.join("\n")}return{vs:O,targetTextureType:C,inject:z,samplerTextureMap:A}}({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),O=B3([t.inject||{},C]);return this.targetTextureType=m,this.samplerTextureMap=A,{vs:r,fs:t._fs||U6({version:G6(r),input:this.targetTextureVarying,inputType:m,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[FQ].concat(t.modules||[]):t.modules,uniforms:l,inject:O}}}let VP=null;class cf extends Pb{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(t){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||go(t)||"Chrome"===i6()}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new cf(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return cf.MAX_ATTRIBUTES=cf.MAX_ATTRIBUTES||t.getParameter(34921),cf.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:cf._setConstantFloatArray(t,e,n);break;case Int32Array:cf._setConstantIntArray(t,e,n);break;case Uint32Array:cf._setConstantUintArray(t,e,n);break;default:Cn(!1)}}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,Object.assign({},e,{id:e.id||e.program&&e.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return cf.getMaxAttributes(this.gl)}initialize(){return this.setProps(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Cn(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,t?t.handle:null)}),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:r,type:l,stride:m,offset:C,normalized:A,integer:O,divisor:z}=n,{gl:$,gl2:Q}=this;return t=Number(t),this.bind(()=>{$.bindBuffer(34962,e.handle),O?(Cn(go($)),Q.vertexAttribIPointer(t,r,l,m,C)):$.vertexAttribPointer(t,r,l,A,m,C),$.enableVertexAttribArray(t),Q.vertexAttribDivisor(t,z||0)}),this}enable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!e&&0===t&&!cf.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind(()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),r=n.byteLength*t,l=n.length*t;let m=!this.buffer;if(this.buffer=this.buffer||new is(this.gl,r),m=m||this.buffer.reallocate(r),m=m||!this._compareConstantArrayValues(n,this.bufferValue),m){const C=function qQ(i,t){const e=function XQ(i){return(!VP||VP.byteLength<i)&&(VP=new ArrayBuffer(i)),VP}(i.BYTES_PER_ELEMENT*t);return new i(e,0,t)}(e.constructor,l);(function YQ(i){let{target:t,source:e,start:n=0,count:r=1}=i;const l=e.length,m=r*l;let C=0;for(let A=n;C<l;C++)t[A++]=e[C];for(;C<m;)C<m-C?(t.copyWithin(n+C,n,n+C),C*=2):(t.copyWithin(n+C,n,n+m-C),C=m)})({target:C,source:n,start:0,count:l}),this.buffer.subData(C),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:Cn(!1)}}static _setConstantIntArray(t,e,n){switch(Cn(go(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:Cn(!1)}}static _setConstantUintArray(t,e,n){switch(Cn(go(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:Cn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:n}=e;return Cn(Number.isFinite(n)),this.bind(()=>34373===t?this.gl.getVertexAttribOffset(n,t):this.gl.getVertexAttrib(n,t))}}const QQ=/^(.+)__LOCATION_([0-9]+)$/,JQ=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class eJ{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.id=e.id||e.program&&e.program.id,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new cf(t),ij(this,"VertexArray","v6.0",JQ),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind(()=>{for(const e in t)this._setAttribute(e,t[e]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e,n);const{location:r,accessor:l}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return r>=0&&(this.values[r]=e,this.accessors[r]=l,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,e,l)),this}setConstant(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:r,accessor:l}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return r>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[r]=e,this.accessors[r]=l,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new is(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof is&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof is&&this.setBuffer(t,e)}}),this}bindForDraw(t,e,n){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(t,e),r=n()}),r}_resolveLocationAndAccessor(t,e,n,r){const l={location:-1,accessor:null},{location:m,name:C}=this._getAttributeIndex(t);if(!Number.isFinite(m)||m<0)return this.unused[t]=e,lr.once(3,()=>"unused value ".concat(t," in ").concat(this.id))(),l;const A=this._getAttributeInfo(C||m);if(!A)return l;const z=af.resolve(A.accessor,this.accessors[m]||{},n,r),{size:$,type:Q}=z;return Cn(Number.isFinite($)&&Number.isFinite(Q)),{location:m,accessor:z}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=QQ.exec(t),r=n?n[1]:t,l=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+l,name:r}:{location:-1}}_setAttribute(t,e){if(e instanceof is)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof is)this.setBuffer(t,e[0],e[1]);else if(ArrayBuffer.isView(e)||Array.isArray(e))this.setConstant(t,e);else{if(!(e.buffer instanceof is))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(t,e.buffer,e)}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let l=1;l<this.vertexArrayObject.MAX_ATTRIBUTES;l++)r=this.values[l],ArrayBuffer.isView(r)&&this._setConstantAttribute(l,r)}_setConstantAttributeZero(t,e){if(cf.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){cf.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],r=this.accessors[e];if(!n)return;const{divisor:l}=r,m=l>0;if(t.isInstanced=t.isInstanced||m,n instanceof is){const C=n;if(m){const A=C.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,A)}else{const A=C.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,A)}}}setElements(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return lr.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function vk(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:n=!1}=t;if(Array.isArray(i)||ArrayBuffer.isView(i))return function tJ(i,t){const{maxElts:e=16,size:n=1}=t;let r="[";for(let m=0;m<i.length&&m<e;++m)m>0&&(r+=",".concat(m%n==0?" ":"")),r+=vk(i[m],t);const l=i.length>e?"...":"]";return"".concat(r).concat(l)}(i,t);if(!Number.isFinite(i))return String(i);if(Math.abs(i)<1e-16)return n?"0":"0.";if(n||Math.abs(i)>100&&Math.abs(i)<1e4)return i.toFixed(0);const r=i.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function $6(i,t,e,n){const{gl:r}=i;if(!t)return{[n]:"null","Format ":"N/A"};let O,z,$,l="NOT PROVIDED",m=1,C=0,A=0;if(e&&(l=e.type,m=e.size,l=String(l).replace("Array",""),O=-1!==l.indexOf("nt")),t instanceof is){const Q=t,{data:te,changed:de}=Q.getDebugData();let fe;return z=de?"*":"",$=te,A=Q.byteLength,C=A/te.BYTES_PER_ELEMENT/m,e?fe="".concat(e.divisor>0?"I ":"P "," ").concat(C," (x").concat(m,"=").concat(A," bytes ").concat(lx(r,l),")"):(O=!0,fe="".concat(A," bytes")),{[n]:"".concat(z).concat(vk($,{size:m,isInteger:O})),"Format ":fe}}return $=t,m=t.length,l=String(t.constructor.name).replace("Array",""),O=-1!==l.indexOf("nt"),{[n]:"".concat(vk($,{size:m,isInteger:O})," (constant)"),"Format ":"".concat(m,"x").concat(l," (constant)")}}function nJ(i,t){const{type:e,size:n}=t,r=kj(e,n);return r?"".concat(i," (").concat(r.name,")"):i}function W6(i){let{header:t="Uniforms",program:e,uniforms:n,undefinedOnly:r=!1}=i;Cn(e);const m=".*Matrix",A={},O=Object.keys(e._uniformSetters).sort();let z=0;for(const te of O)!te.match(".*_.*")&&!te.match(m)&&RB({table:A,header:t,uniforms:n,uniformName:te,undefinedOnly:r})&&z++;for(const te of O)te.match(m)&&RB({table:A,header:t,uniforms:n,uniformName:te,undefinedOnly:r})&&z++;for(const te of O)A[te]||RB({table:A,header:t,uniforms:n,uniformName:te,undefinedOnly:r})&&z++;let $=0;const Q={};if(!r)for(const te in n){const de=n[te];A[te]||($++,Q[te]={Type:"NOT USED: ".concat(de),[t]:vk(de)})}return{table:A,count:z,unusedTable:Q,unusedCount:$}}function RB(i){let{table:t,header:e,uniforms:n,uniformName:r,undefinedOnly:l}=i;const m=n[r],C=function rJ(i){return null!=i}(m);return!(l&&C||(t[r]={[e]:C?vk(m):"N/A","Uniform Type":C?m:"NOT PROVIDED"},0))}function X6(i){const{type:t,size:e}=i.accessor,n=kj(t,e);return n?"".concat(n.name," ").concat(i.name):i.name}const sJ={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function lJ(i,t){const{attributeMap:e=sJ}=t||{};return e&&e[i]||i}function cJ(i,t){let e;switch(i){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":e="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":e="vectors"}switch(e){case"vectors":t.size=t.size||3;break;case"uvs":t.size=t.size||2}Cn(Number.isFinite(t.size),"attribute ".concat(i," needs size"))}const q6=()=>{},hJ={};class lg{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:n=F_("model")}=e;Cn(vT(t)),this.id=n,this.gl=t,this.id=e.id||F_("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||hk.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:r,modules:l,defines:m,inject:C,varyings:A,bufferMode:O,transpileToGLSL100:z}=t;this.programProps={program:e,vs:n,fs:r,modules:l,defines:m,inject:C,varyings:A,bufferMode:O,transpileToGLSL100:z},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},Cn(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:r,modules:l,defines:m,inject:C,varyings:A,bufferMode:O,transpileToGLSL100:z}=t;this.programProps={program:e,vs:n,fs:r,modules:l,defines:m,inject:C,varyings:A,bufferMode:O,transpileToGLSL100:z},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return Cn(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return Cn(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function aJ(i,t,e){const n={};let r=t.indices;for(const l in t.attributes){const m=t.attributes[l],C=lJ(l,e);if("indices"===l)r=m;else if(m.constant)n[C]=m.value;else{const A=m.value,O={...m};delete O.value,n[C]=[new is(i,A),O],cJ(l,O)}}if(r){const l=r.value||r;Cn(l instanceof Uint16Array||l instanceof Uint32Array,'attribute array for "indices" must be of integer type');const m={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};n.indices=[new is(i,{data:l,target:34963}),m]}return n}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(lS(t))return this;const e={};for(const n in t){const r=t[n];e[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(e),this}setUniforms(){return Object.assign(this.uniforms,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return X3(this.program.gl,t),this}draw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:r={},attributes:l={},transformFeedback:m=this.transformFeedback,parameters:C={},vertexArray:A=this.vertexArray}=t;let O;this.setAttributes(l),this.updateModuleSettings(e),this.setUniforms(r),lr.priority>=2&&(O=this._logDrawCallStart(2));const z=this.vertexArray.getDrawParams(),{isIndexed:$=z.isIndexed,indexType:Q=z.indexType,indexOffset:te=z.indexOffset,vertexArrayInstanced:de=z.isInstanced}=this.props;de&&!this.isInstanced&&lr.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:fe,instanceCount:ge}=this,{onBeforeRender:Re=q6,onAfterRender:qe=q6}=this.props;Re(),this.program.setUniforms(this.uniforms);const et=this.program.draw(Object.assign(hJ,t,{logPriority:O,uniforms:null,framebuffer:n,parameters:C,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:A,transformFeedback:m,isIndexed:$,indexType:Q,isInstanced:fe,instanceCount:ge,offset:$?te:0}));return qe(),lr.priority>=2&&this._logDrawCallEnd(O,A,n),et}transform(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:e=!0,feedbackBuffers:n,unbindModels:r=[]}=t;let{parameters:l}=t;n&&this._setFeedbackBuffers(n),e&&(l=Object.assign({},l,{35977:e})),r.forEach(m=>m.vertexArray.unbindBuffers());try{this.draw(Object.assign({},t,{parameters:l}))}finally{r.forEach(m=>m.vertexArray.bindBuffers())}return this}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return lr.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:e}=this.programProps;if(e)this._managedProgram=!1;else{const{vs:n,fs:r,modules:l,inject:m,defines:C,varyings:A,bufferMode:O,transpileToGLSL100:z}=this.programProps;e=this.programManager.get({vs:n,fs:r,modules:l,inject:m,defines:C,varyings:A,bufferMode:O,transpileToGLSL100:z}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Cn(e instanceof Rj,"Model needs a program"),this._programDirty=!1,e!==this.program&&(this.program=e,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new eJ(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof is&&e.delete()}}_setAnimationProps(t){this.animated&&Cn(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(lS(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new j6(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),lr.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:lr.level<=2})(),t}_logDrawCallEnd(t,e,n,r){if(void 0===t)return;const l=function iJ(i){let{vertexArray:t,header:e="Attributes"}=i;if(!t.configuration)return{};const n={};t.elements&&(n.ELEMENT_ARRAY_BUFFER=$6(t,t.elements,null,e));const r=t.values;for(const l in r){const m=t._getAttributeInfo(l);if(m){let C="".concat(l,": ").concat(m.name);const A=t.accessors[m.location];A&&(C="".concat(l,": ").concat(nJ(m.name,A))),n[C]=$6(t,r[l],A,e)}}return n}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:m,unusedTable:C,unusedCount:A}=W6({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:O,count:z}=W6({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});z>0&&lr.log("MISSING UNIFORMS",Object.keys(O))(),A>0&&lr.log("UNUSED UNIFORMS",Object.keys(C))();const $=function oJ(i){const t={},e="Accessors for ".concat(i.id);for(const n of i.attributeInfos)if(n){const r=X6(n);t["in ".concat(r)]={[e]:JSON.stringify(n.accessor)}}for(const n of i.varyingInfos)if(n){const r=X6(n);t["out ".concat(r)]={[e]:JSON.stringify(n.accessor)}}return t}(this.vertexArray.configuration);lr.table(t,l)(),lr.table(t,m)(),lr.table(t+1,$)(),r&&r.log({logLevel:2,message:"Rendered to ".concat(r.id)}),lr.groupEnd(2)()}}class vS{static isSupported(t){return go(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();Cn(t,"Nothing to swap")}getBuffer(){return this.bufferTransform&&this.bufferTransform.getBuffer(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const r=n.getData(t);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new lg(e,Object.assign({},t,{fs:t.fs||U6({version:G6(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=r.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function fJ(i){return!(lS(i.feedbackBuffers)&&lS(i.feedbackMap)&&!(i.varyings&&i.varyings.length>0))})(e)&&(this.bufferTransform=new LQ(t,e)),function mJ(i){return!(lS(i._sourceTextures)&&!i._targetTexture&&!i._targetTextureVarying)}(e)&&(this.textureTransform=new WQ(t,e)),Cn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=Object.assign(e,r.getDrawOptions(e));return e}}const wJ={interpolation:class pJ{constructor({gl:t,attribute:e,timeline:n}){ye(this,"gl",void 0),ye(this,"type","interpolation"),ye(this,"attributeInTransition",void 0),ye(this,"settings",void 0),ye(this,"attribute",void 0),ye(this,"transition",void 0),ye(this,"currentStartIndices",void 0),ye(this,"currentLength",void 0),ye(this,"transform",void 0),ye(this,"buffers",void 0),this.gl=t,this.transition=new mk(n),this.attribute=e,this.attributeInTransition=new IB(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function _J(i,t){const e=F6(t.size);return new vS(i,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:e},varyings:["vCurrent"]})}(t,e);const r={byteLength:0,usage:35050};this.buffers=[new is(t,r),new is(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();this.settings=t;const{buffers:r,attribute:l}=this;N6(r);const m={numInstances:e,attribute:l,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const C of r)B6({buffer:C,...m});this.currentStartIndices=l.startIndices,this.currentLength=kB(l,e),this.attributeInTransition.setData({buffer:r[1],value:l.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/l.size),sourceBuffers:{aFrom:r[0],aTo:L6(0,l)},feedbackBuffers:{vCurrent:r[1]}})}update(){const t=this.transition.update();if(t){const{duration:e,easing:n}=this.settings,{time:r}=this.transition;let l=r/e;n&&(l=n(l)),this.transform.run({uniforms:{time:l}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}},spring:class vJ{constructor({gl:t,attribute:e,timeline:n}){ye(this,"gl",void 0),ye(this,"type","spring"),ye(this,"attributeInTransition",void 0),ye(this,"settings",void 0),ye(this,"attribute",void 0),ye(this,"transition",void 0),ye(this,"currentStartIndices",void 0),ye(this,"currentLength",void 0),ye(this,"texture",void 0),ye(this,"framebuffer",void 0),ye(this,"transform",void 0),ye(this,"buffers",void 0),this.gl=t,this.type="spring",this.transition=new mk(n),this.attribute=e,this.attributeInTransition=new IB(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function yJ(i){return new vu(i,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function xJ(i,t){return new zl(i,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:t}})}(t,this.texture),this.transform=function bJ(i,t,e){const n=F6(t.size);return new vS(i,{framebuffer:e,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:n},varyings:["vNext"]})}(t,e,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new is(t,r),new is(t,r),new is(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{buffers:r,attribute:l}=this,m={numInstances:e,attribute:l,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const C of r)B6({buffer:C,...m});this.settings=t,this.currentStartIndices=l.startIndices,this.currentLength=kB(l,e),this.attributeInTransition.setData({buffer:r[1],value:l.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/l.size),sourceBuffers:{aTo:L6(0,l)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:r}=this;if(!r.update())return!1;const m=this.settings;return e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:m.stiffness,damping:m.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),N6(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),CP(n)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class CJ{constructor(t,{id:e,timeline:n}){ye(this,"id",void 0),ye(this,"isSupported",void 0),ye(this,"gl",void 0),ye(this,"timeline",void 0),ye(this,"transitions",void 0),ye(this,"needsRedraw",void 0),ye(this,"numInstances",void 0),this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=vS.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const r in t){const l=t[r],m=l.getTransitionSetting(e);m&&this._updateAttribute(r,l,m)}for(const r in this.transitions){const l=t[r];(!l||!l.getTransitionSetting(e))&&this._removeTransition(r)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const e in this.transitions)this.transitions[e].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const r=this.transitions[t];let l=!r||r.type!==n.type;if(l){if(!this.isSupported)return void so.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();r&&this._removeTransition(t);const m=wJ[n.type];m?this.transitions[t]=new m({attribute:e,timeline:this.timeline,gl:this.gl}):(so.error("unsupported transition type '".concat(n.type,"'"))(),l=!1)}(l||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const Y6="attributeManager.invalidate";class PB{constructor(t,{id:e="attribute-manager",stats:n,timeline:r}={}){ye(this,"id",void 0),ye(this,"gl",void 0),ye(this,"attributes",void 0),ye(this,"updateTriggers",void 0),ye(this,"needsRedraw",void 0),ye(this,"userData",void 0),ye(this,"stats",void 0),ye(this,"attributeTransitionManager",void 0),ye(this,"mergeBoundsMemoized",fk(dP)),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new CJ(t,{id:"".concat(e,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);Bl(Y6,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);Bl(Y6,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:r,props:l={},buffers:m={},context:C={}}){let A=!1;Bl("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const O in this.attributes){const z=this.attributes[O],$=z.settings.accessor;z.startIndices=n,z.numInstances=e,l[O]&&so.removed("props.".concat(O),"data.attributes.".concat(O))(),z.setExternalBuffer(m[O])||z.setBinaryValue("string"==typeof $?m[$]:void 0,t.startIndices)||"string"==typeof $&&!m[$]&&z.setConstantValue(l[$])||z.needsUpdate()&&(A=!0,this._updateAttribute({attribute:z,numInstances:e,data:t,props:l,context:C})),this.needsRedraw=this.needsRedraw||z.needsRedraw()}A&&Bl("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:r})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getBounds(t){const e=t.map(n=>{var r;return null===(r=this.attributes[n])||void 0===r?void 0:r.getBounds()});return this.mergeBoundsMemoized(e)}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const l in e){const m=e[l];m.needsRedraw(t)&&!n.hasAttribute(l)&&(r[l]=m)}return r}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const r in t)e[r]||Object.assign(n,t[r].getShaderAttributes());return n}_add(t,e={}){for(const n in t)this.attributes[n]=this._createAttribute(n,t[n],e);this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const r={...e,id:t,size:(e.isIndexed?1:e.size)||1,divisor:n.instanced?1:e.divisor||0};return new IB(this.gl,r)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach(r=>{t[r]||(t[r]=[]),t[r].push(e)});this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:r}=this,l=r[t];return l&&l.forEach(m=>{const C=n[m];C&&C.setNeedsUpdate(C.id,e)}),l}_updateAttribute(t){const{attribute:e,numInstances:n}=t;Bl("attribute.updateStart",e),e.constant?e.setConstantValue(e.value):(e.allocate(n)&&Bl("attribute.allocate",e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,Bl("attribute.updateEnd",e,n)))}}function K6(i,t,e,n,r){const l=t-i;return(e-t)*r+-l*n+l+t}function Q6(i,t){if(Array.isArray(i)){let e=0;for(let n=0;n<i.length;n++){const r=i[n]-t[n];e+=r*r}return Math.sqrt(e)}return Math.abs(i-t)}const RJ={interpolation:class DJ extends mk{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:r,easing:l}}=this,m=l(t/r);this._value=rx(e,n,m)}},spring:class IJ extends mk{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:r}=this.settings,{_prevValue:l=t,_currValue:m=t}=this;let C=function kJ(i,t,e,n,r){if(Array.isArray(e)){const l=[];for(let m=0;m<e.length;m++)l[m]=K6(i[m],t[m],e[m],n,r);return l}return K6(i,t,e,n,r)}(l,m,e,n,r);const A=Q6(C,e),O=Q6(C,m);A<1e-5&&O<1e-5&&(C=e,this.end()),this._prevValue=m,this._currValue=C}}};class PJ{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,r){const{transitions:l}=this;if(l.has(t)){const A=l.get(t),{value:O=A.settings.fromValue}=A;e=O,this.remove(t)}if(!(r=O6(r)))return;const m=RJ[r.type];if(!m)return void so.error("unsupported transition type '".concat(r.type,"'"))();const C=new m(this.timeline);C.start({...r,fromValue:e,toValue:n}),l.set(t,C)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}function FJ(i,t){if(!i.transitions)return!1;const e={},n=i[M_];let r=!1;for(const l in i.transitions){const m=n[l],C=m&&m.type;("number"===C||"color"===C||"array"===C)&&LB(i[l],t[l],m)&&(e[l]=!0,r=!0)}return!!r&&e}function OB({newProps:i,oldProps:t,ignoreProps:e={},propTypes:n={},triggerName:r="props"}){if(t===i)return!1;if("object"!=typeof i||null===i||"object"!=typeof t||null===t)return"".concat(r," changed shallowly");for(const l of Object.keys(i))if(!(l in e)){if(!(l in t))return"".concat(r,".").concat(l," added");const m=LB(i[l],t[l],n[l]);if(m)return"".concat(r,".").concat(l," ").concat(m)}for(const l of Object.keys(t))if(!(l in e)){if(!(l in i))return"".concat(r,".").concat(l," dropped");if(!Object.hasOwnProperty.call(i,l)){const m=LB(i[l],t[l],n[l]);if(m)return"".concat(r,".").concat(l," ").concat(m)}}return!1}function LB(i,t,e){let n=e&&e.equal;return n&&!n(i,t,e)||!n&&(n=i&&t&&i.equals,n&&!n.call(i,t))?"changed deeply":n||t===i?null:"changed shallowly"}function VJ(i,t){if(null===t)return!0;const e=t.extensions,{extensions:n}=i;if(n===e)return!1;if(!e||!n||n.length!==e.length)return!0;for(let r=0;r<n.length;r++)if(!n[r].equals(e[r]))return!0;return!1}function J6(i,t,e){let n=i.updateTriggers[e];n=n??{};let r=t.updateTriggers[e];return r=r??{},OB({oldProps:r,newProps:n,triggerName:e})}function eG(i,t){if(!t)return i;const e={...i,...t};if("defines"in t&&(e.defines={...i.defines,...t.defines}),"modules"in t&&(e.modules=(i.modules||[]).concat(t.modules),t.modules.some(n=>"project64"===n.name))){const n=e.modules.findIndex(r=>"project32"===r.name);n>=0&&e.modules.splice(n,1)}if("inject"in t)if(i.inject){const n={...i.inject};for(const r in t.inject)n[r]=(n[r]||"")+t.inject[r];e.inject=n}else e.inject=t.inject;return e}const tG=[0,0,0];function FB(i,t,e=!1){const n=t.projectPosition(i);if(e&&t instanceof Y1){const[r,l,m=0]=i,C=t.getDistanceScales([r,l]);n[2]=m*C.unitsPerMeter[2]}return n}function iG(i,{viewport:t,modelMatrix:e,coordinateSystem:n,coordinateOrigin:r,offsetMode:l}){let[m,C,A=0]=i;switch(e&&([m,C,A]=nk([],[m,C,A,1],e)),n){case Ro.LNGLAT:return FB([m,C,A],t,l);case Ro.LNGLAT_OFFSETS:return FB([m+r[0],C+r[1],A+(r[2]||0)],t,l);case Ro.METER_OFFSETS:return FB(R5(r,[m,C,A]),t,l);default:return t.isGeospatial?[m+r[0],C+r[1],A+r[2]]:t.projectPosition([m,C,A])}}const XJ={10241:9987,10240:9729,10242:33071,10243:33071},NB={},ZJ={boolean:{validate:(i,t)=>!0,equal:(i,t,e)=>!!i==!!t},number:{validate:(i,t)=>Number.isFinite(i)&&(!("max"in t)||i<=t.max)&&(!("min"in t)||i>=t.min)},color:{validate:(i,t)=>t.optional&&!i||BB(i)&&(3===i.length||4===i.length),equal:(i,t,e)=>N_(i,t,1)},accessor:{validate(i,t){const e=zP(i);return"function"===e||e===zP(t.value)},equal:(i,t,e)=>"function"==typeof t||N_(i,t,1)},array:{validate:(i,t)=>t.optional&&!i||BB(i),equal(i,t,e){const{compare:n}=e,r=Number.isInteger(n)?n:n?1:0;return n?N_(i,t,r):i===t}},object:{equal(i,t,e){if(e.ignore)return!0;const{compare:n}=e,r=Number.isInteger(n)?n:n?1:0;return n?N_(i,t,r):i===t}},function:{validate:(i,t)=>t.optional&&!i||"function"==typeof i,equal:(i,t,e)=>!e.compare&&!1!==e.ignore||i===t},data:{transform:(i,t,e)=>{const{dataTransform:n}=e.props;return n&&i?n(i):i}},image:{transform:(i,t,e)=>{const n=e.context;return n&&n.gl?function qJ(i,t,e,n){if(e instanceof vu)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let r=null;e.compressed&&(r={10241:e.data.length>1?9985:9729});const l=new vu(t,{...e,parameters:{...XJ,...r,...n}});return NB[l.id]=i,l}(e.id,n.gl,i,{...t.parameters,...e.props.textureParameters}):null},release:(i,t,e)=>{!function YJ(i,t){!t||!(t instanceof vu)||NB[t.id]===i&&(t.delete(),delete NB[t.id])}(e.id,i)}}};function QJ(i,t){switch(zP(t)){case"object":return bk(i,t);case"array":return bk(i,{type:"array",value:t,compare:!1});case"boolean":return bk(i,{type:"boolean",value:t});case"number":return bk(i,{type:"number",value:t});case"function":return bk(i,{type:"function",value:t,compare:!0});default:return{name:i,type:"unknown",value:t}}}function bk(i,t){return"type"in t?{name:i,...ZJ[t.type],...t}:"value"in t?{name:i,type:zP(t.value),...t}:{name:i,type:"object",value:t}}function BB(i){return Array.isArray(i)||ArrayBuffer.isView(i)}function zP(i){return BB(i)?"array":null===i?"null":typeof i}function VB(i,t){let e="_mergedDefaultProps";if(t)for(const r of t){const l=r.constructor;l&&(e+=":".concat(l.extensionName||l.name))}return nG(i,e)||(i[e]=function tee(i,t){if(!i.prototype)return null;const r=VB(Object.getPrototypeOf(i)),m=function KJ(i){const t={},e={},n={};for(const[r,l]of Object.entries(i)){const m=l?.deprecatedFor;if(m)n[r]=Array.isArray(m)?m:[m];else{const C=QJ(r,l);t[r]=C,e[r]=C.value}}return{propTypes:t,defaultProps:e,deprecatedProps:n}}(nG(i,"defaultProps")||{}),C=Object.assign(Object.create(null),r,m.defaultProps),A=Object.assign(Object.create(null),r?.[M_],m.propTypes),O=Object.assign(Object.create(null),r?.[fD],m.deprecatedProps);for(const z of t){const $=VB(z.constructor);$&&(Object.assign(C,$),Object.assign(A,$[M_]),Object.assign(O,$[fD]))}return function iee(i,t){const e=function see(i){const t=i.componentName;return t||so.warn("".concat(i.name,".componentName not specified"))(),t||i.name}(t);Object.defineProperties(i,{id:{writable:!0,value:e}})}(C,i),function ree(i,t){const e={},n={};for(const r in t){const l=t[r],{name:m,value:C}=l;l.async&&(e[m]=C,n[m]=oee(m))}i[A_]=e,i[tg]={},Object.defineProperties(i,n)}(C,A),function nee(i,t){for(const e in t)Object.defineProperty(i,e,{enumerable:!1,set(n){const r="".concat(this.id,": ").concat(e);for(const l of t[e])zB(this,l)||(this[l]=n);so.deprecated(r,t[e].join("/"))()}})}(C,O),C[M_]=A,C[fD]=O,0===t.length&&!zB(i,"_propTypes")&&(i._propTypes=A),C}(i,t||[]))}function oee(i){return{enumerable:!0,set(t){"string"==typeof t||t instanceof Promise||R6(t)?this[tg][i]=t:this[ig][i]=t},get(){if(this[ig]){if(i in this[ig])return this[ig][i]||this[A_][i];if(i in this[tg]){const t=this[ET]&&this[ET].internalState;if(t&&t.hasAsyncProp(i))return t.getAsyncProp(i)||this[A_][i]}}return this[A_][i]}}}function zB(i,t){return Object.prototype.hasOwnProperty.call(i,t)}function nG(i,t){return zB(i,t)&&i[t]}let aee=0;class UB{constructor(...t){ye(this,"id",void 0),ye(this,"props",void 0),ye(this,"count",void 0),this.props=function JJ(i,t){let e;for(let l=t.length-1;l>=0;l--){const m=t[l];"extensions"in m&&(e=m.extensions)}const n=VB(i.constructor,e),r=Object.create(n);r[ET]=i,r[tg]={},r[ig]={};for(let l=0;l<t.length;++l){const m=t[l];for(const C in m)r[C]=m[C]}return Object.freeze(r),r}(this,t),this.id=this.props.id,this.count=aee++}clone(t){const{props:e}=this,n={};for(const r in e[A_])r in e[ig]?n[r]=e[ig][r]:r in e[tg]&&(n[r]=e[tg][r]);return new this.constructor({...e,...n,...t})}}ye(UB,"componentName","Component"),ye(UB,"defaultProps",{});const lee=Object.freeze({});class cee{constructor(t){ye(this,"component",void 0),ye(this,"onAsyncPropUpdated",void 0),ye(this,"asyncProps",void 0),ye(this,"oldProps",void 0),ye(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||lee}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return!!(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){this.component=t[ET]||this.component;const e=t[ig]||{},n=t[tg]||t,r=t[A_]||{};for(const l in e){const m=e[l];this._createAsyncPropData(l,r[l]),this._updateAsyncProp(l,m),e[l]=this.getAsyncProp(l)}for(const l in n){const m=n[l];this._createAsyncPropData(l,r[l]),this._updateAsyncProp(l,m)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if("string"==typeof e&&(e=this._fetch(t,e)),e instanceof Promise)return void this._watchPromise(t,e);if(R6(e))return void this._resolveAsyncIterable(t,e);this._setPropValue(t,e)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const r=n.pendingLoadCount;e.then(l=>{this.component&&(l=this._postProcessValue(n,l),this._setAsyncPropValue(t,l,r),this._onResolve(t,l))}).catch(l=>{this._onError(t,l)})}}_resolveAsyncIterable(t,e){var n=this;return(0,Yt.A)(function*(){if("data"!==t)return void n._setPropValue(t,e);const r=n.asyncProps[t];if(!r)return;r.pendingLoadCount++;const l=r.pendingLoadCount;let m=[],C=0;var z,A=!1,O=!1;try{for(var Q,$=N0(e);A=!(Q=yield $.next()).done;A=!1){const te=Q.value;{if(!n.component)return;const{dataTransform:de}=n.component.props;m=de?de(te,m):m.concat(te),Object.defineProperty(m,"__diff",{enumerable:!1,value:[{startRow:C,endRow:m.length}]}),C=m.length,n._setAsyncPropValue(t,m,l)}}}catch(te){O=!0,z=te}finally{try{A&&null!=$.return&&(yield $.return())}finally{if(O)throw z}}n._onResolve(t,m)})()}_postProcessValue(t,e){const n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const r=this.component&&this.component.props[M_];this.asyncProps[t]={type:r&&r[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}class dee extends cee{constructor({attributeManager:t,layer:e}){super(e),ye(this,"attributeManager",void 0),ye(this,"needsRedraw",void 0),ye(this,"needsUpdate",void 0),ye(this,"subLayers",void 0),ye(this,"usesPickingColorCache",void 0),ye(this,"hasPickingBuffer",void 0),ye(this,"changeFlags",void 0),ye(this,"viewport",void 0),ye(this,"uniformTransitions",void 0),ye(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,e){const n=this.layer,r=n?.props.fetch;return r?r(e,{propName:t,layer:n}):super._fetch(t,e)}_onResolve(t,e){const n=this.layer;if(n){const r=n.props.onDataLoad;"data"===t&&r&&r(e,{propName:t,layer:n})}}_onError(t,e){const n=this.layer;n&&n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}const rG=2**24-1,gee=Object.freeze([]),_ee=fk(({oldViewport:i,viewport:t})=>i.equals(t));let z_=new Uint8ClampedArray(0);const vee={data:{type:"data",value:gee,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:i=>i&&i.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(i,{propName:t,layer:e,loaders:n,loadOptions:r,signal:l})=>{const{resourceManager:m}=e.context;var C;r=r||e.getLoadOptions(),n=n||e.props.loaders,l&&(r={...r,fetch:{...null===(C=r)||void 0===C?void 0:C.fetch,signal:l}});let A=m.contains(i);return!A&&!r&&(m.add({resourceId:i,data:YR(i,n),persistent:!1}),A=!0),A?m.subscribe({resourceId:i,onChange:O=>{var z;return null===(z=e.internalState)||void 0===z?void 0:z.reloadAsyncProp(t,O)},consumerId:e.id,requestId:t}):YR(i,n,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Ro.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:i})=>[0,100*-i]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class cg extends UB{constructor(...t){super(...t),ye(this,"internalState",null),ye(this,"lifecycle","Awaiting state"),ye(this,"context",void 0),ye(this,"state",void 0),ye(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}project(t){gl(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=iG(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,l,m]=L5(n,e.pixelProjectionMatrix);return 2===t.length?[r,l]:[r,l,m]}unproject(t){return gl(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){return gl(this.internalState),function WJ(i,t){const{viewport:e,coordinateSystem:n,coordinateOrigin:r,modelMatrix:l,fromCoordinateSystem:m,fromCoordinateOrigin:C}=function $J(i){const{viewport:t,modelMatrix:e,coordinateOrigin:n}=i;let{coordinateSystem:r,fromCoordinateSystem:l,fromCoordinateOrigin:m}=i;return r===Ro.DEFAULT&&(r=t.isGeospatial?Ro.LNGLAT:Ro.CARTESIAN),void 0===l&&(l=r),void 0===m&&(m=n),{viewport:t,coordinateSystem:r,coordinateOrigin:n,modelMatrix:e,fromCoordinateSystem:l,fromCoordinateOrigin:m}}(t),{autoOffset:A=!0}=t,{geospatialOrigin:O=tG,shaderCoordinateOrigin:z=tG,offsetMode:$=!1}=A?Nj(e,n,r):{},Q=iG(i,{viewport:e,modelMatrix:l,coordinateSystem:m,coordinateOrigin:C,offsetMode:$});$&&function KT(i,t,e){i[0]=t[0]-e[0],i[1]=t[1]-e[1],i[2]=t[2]-e[2]}(Q,Q,e.projectPosition(O||z));return Q}(t,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===Ro.DEFAULT||t===Ro.LNGLAT||t===Ro.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){gl(t instanceof Uint8Array);const[e,n,r]=t;return e+256*n+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function jJ(i){if(!function HJ(i){return null!==i&&"object"==typeof i}(i))throw new Error("count(): argument not an object");if("function"==typeof i.count)return i.count();if(Number.isFinite(i.size))return i.size;if(Number.isFinite(i.length))return i.length;if(function GJ(i){return null!==i&&"object"==typeof i&&i.constructor===Object}(i))return Object.keys(i).length;throw new Error("count(): argument not a container")}(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){for(const e of this.props.extensions)t=eG(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const r of n)e.invalidateAll(r);else e.invalidateAll();if(e){const{props:r}=t,l=this.internalState.hasPickingBuffer,m=Number.isInteger(r.highlightedObjectIndex)||r.pickable||r.extensions.some(C=>C.getNeedsPickingBuffer.call(this,C));if(l!==m){this.internalState.hasPickingBuffer=m;const{pickingColors:C,instancePickingColors:A}=e.attributes,O=C||A;O&&(m&&O.constant&&(O.constant=!1,e.invalidate(O.id)),!O.value&&!m&&(O.constant=!0,O.value=[0,0,0]))}}}finalizeState(t){for(const n of this.getModels())n.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}raiseError(t,e){var n,r,l,m;e&&(t=new Error("".concat(e,": ").concat(t.message),{cause:t})),null!==(n=(r=this.props).onError)&&void 0!==n&&n.call(r,t)||null===(l=this.context)||void 0===l||null===(m=l.onError)||void 0===m||m.call(l,t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,(!e||!_ee({oldViewport:e,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),r=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:r,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const l=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(l)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const r in e)Object.defineProperty(n,r,{value:e[r]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(z_.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>rG&&so.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),z_=kb.allocate(z_,e,{size:3,copy:!0,maxCount:Math.max(e,rG)});const r=Math.floor(z_.length/3),l=[];for(let m=n;m<r;m++)this.encodePickingColor(m,l),z_[3*m+0]=l[0],z_[3*m+1]=l[1],z_[3*m+2]=l[2]}t.value=z_.subarray(0,3*e)}_setModelAttributes(t,e){const l=this.getAttributeManager().getShaderAttributes(e,t.userData.excludeAttributes||{});t.setAttributes(l)}disablePickingIndex(t){const e=this.props.data;if(!("attributes"in e))return void this._disablePickingIndex(t);const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,l=n||r,m=l&&e.attributes&&e.attributes[l.id];if(m&&m.value){const C=m.value,A=this.encodePickingColor(t);for(let O=0;O<e.length;O++){const z=l.getVertexOffset(O);C[z]===A[0]&&C[z+1]===A[1]&&C[z+2]===A[2]&&this._disablePickingIndex(O)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;if(!r)return;const l=r.getVertexOffset(t),m=r.getVertexOffset(t+1);r.buffer.subData({data:new Uint8Array(m-l),offset:l})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==z_.buffer&&(n.value=z_.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){gl(!this.internalState),gl(Number.isFinite(this.props.coordinateSystem)),Bl("layer.initialize",this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new dee({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(so.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new PJ(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const e of this.props.extensions)e.initializeState.call(this,this.context,e);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){Bl("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if(Bl("layer.update",this,t),!t)return;const e=this.props,n=this.context,r=this.internalState,l=n.viewport,m=this._updateUniformTransition();r.propsInTransition=m,n.viewport=r.viewport||l,this.props=m;try{const C=this._getUpdateParams(),A=this.getModels();if(n.gl)this.updateState(C);else try{this.updateState(C)}catch{}for(const z of this.props.extensions)z.updateState.call(this,C,z);const O=this.getModels()[0]!==A[0];this._postUpdate(C,O)}finally{n.viewport=l,this.props=e,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){Bl("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const r=this.props,l=this.context;this.props=this.internalState.propsInTransition||r,e.opacity=Math.pow(this.props.opacity,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:C}=this.props,A=C&&C(e)||[0,0];nf(l.gl,{polygonOffset:A}),Nl(l.gl,n,()=>{const O={moduleParameters:t,uniforms:e,parameters:n,context:l};for(const z of this.props.extensions)z.draw.call(this,O,z);this.draw(O)})}finally{this.props=r}}getChangeFlags(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const r in t)if(t[r]){let l=!1;if("dataChanged"===r){const m=t[r],C=e[r];m&&Array.isArray(C)&&(e.dataChanged=Array.isArray(m)?C.concat(m):m,l=!0)}e[r]||(e[r]=t[r],l=!0),l&&Bl("layer.changeFlag",this,r,t)}const n=!!(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=function LJ(i,t){const e=OB({newProps:i,oldProps:t,propTypes:i[M_],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=function NJ(i,t){if(null===t)return"oldProps is null, initial diff";let e=!1;const{dataComparator:n,_dataDiff:r}=i;return n?n(i.data,t.data)||(e="Data comparator detected a change"):i.data!==t.data&&(e="A new data container was supplied"),e&&r&&(e=r(i.data,t.data)||e),e}(i,t);let r=!1;return n||(r=function BJ(i,t){if(null===t)return{all:!0};if("all"in i.updateTriggers&&J6(i,t,"all"))return{all:!0};const e={};let n=!1;for(const r in i.updateTriggers)"all"!==r&&J6(i,t,r)&&(e[r]=!0,n=!0);return!!n&&e}(i,t)),{dataChanged:n,propsChanged:e,updateTriggersChanged:r,extensionsChanged:VJ(i,t),transitionsChanged:FJ(i,t)}}(t,e);if(n.updateTriggersChanged)for(const l in n.updateTriggersChanged)n.updateTriggersChanged[l]&&this.invalidateAttribute(l);if(n.transitionsChanged)for(const l in n.transitionsChanged){var r;this.internalState.uniformTransitions.add(l,e[l],t[l],null===(r=t.transitions)||void 0===r?void 0:r[l])}return this.setChangeFlags(n)}validateProps(){!function OJ(i){const t=i[M_];for(const e in t){const n=t[e],{validate:r}=n;if(r&&!r(i[e],n))throw new Error("Invalid prop ".concat(e,": ").concat(i[e]))}}(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new PB(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:r}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:l}=this.state;l?.setInstanceCount(this.getNumInstances());const{autoHighlight:m,highlightedObjectIndex:C,highlightColor:A}=n;if(e||r.autoHighlight!==m||r.highlightedObjectIndex!==C||r.highlightColor!==A){const O={};m||(O.pickingSelectedColor=null),Array.isArray(A)&&(O.pickingHighlightColor=A),(e||C!==r.highlightedObjectIndex)&&(O.pickingSelectedColor=Number.isFinite(C)&&C>=0?this.encodePickingColor(C):null),this.setModuleParameters(O)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),r=!!n&&n.getNeedsRedraw(t);if(e=e||r,e)for(const l of this.props.extensions)l.onNeedsRedraw.call(this,l);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}ye(cg,"defaultProps",vee),ye(cg,"layerName","Layer");const fx={name:"project32",dependencies:[eB],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},bee={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},Q1={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function yee(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bee;const t={};if(void 0!==i.pickingSelectedColor)if(i.pickingSelectedColor){const e=i.pickingSelectedColor.slice(0,3);t.picking_uSelectedColorValid=1,t.picking_uSelectedColor=e}else t.picking_uSelectedColorValid=0;if(i.pickingHighlightColor){const e=Array.from(i.pickingHighlightColor,n=>n/255);Number.isFinite(e[3])||(e[3]=1),t.picking_uHighlightColor=e}return void 0!==i.pickingActive&&(t.picking_uActive=!!i.pickingActive,t.picking_uAttribute=!!i.pickingAttribute),t}},oG={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class mx{static get DRAW_MODE(){return oG}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=F_("geometry"),drawMode:n=oG.TRIANGLES,attributes:r={},indices:l=null,vertexCount:m=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(r,l),this.vertexCount=m||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const n in t){let r=t[n];r=ArrayBuffer.isView(r)?{value:r}:r,Cn(ArrayBuffer.isView(r.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),("POSITION"===n||"positions"===n)&&!r.size&&(r.size=3),"indices"===n?(Cn(!this.indices),this.indices=r):this.attributes[n]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const r in t){const l=t[r],{value:m,size:C,constant:A}=l;!A&&m&&C>=1&&(n=Math.min(n,m.length/C))}return Cn(Number.isFinite(n)),n}}const UP=[0,0,0,255],Cee={getSourcePosition:{type:"accessor",value:i=>i.sourcePosition},getTargetPosition:{type:"accessor",value:i=>i.targetPosition},getSourceColor:{type:"accessor",value:UP},getTargetColor:{type:"accessor",value:UP},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,numSegments:{type:"number",value:50,min:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class jB extends cg{constructor(...t){super(...t),ye(this,"state",void 0)}getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  DECKGL_FILTER_GL_POSITION(curr, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[fx,Q1]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:UP},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:UP},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:r}=t;if(r.extensionsChanged||r.propsChanged&&e.numSegments!==n.numSegments){var l;const{gl:m}=this.context;null===(l=this.state.model)||void 0===l||l.delete(),this.state.model=this._getModel(m),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:r,widthMaxPixels:l,greatCircle:m,wrapLongitude:C}=this.props;this.state.model.setUniforms(t).setUniforms({greatCircle:m,widthUnits:L_[e],widthScale:n,widthMinPixels:r,widthMaxPixels:l,useShortestPath:C}).draw()}_getModel(t){const{id:e,numSegments:n}=this.props;let r=[];for(let m=0;m<n;m++)r=r.concat([m,1,0,m,-1,0]);const l=new lg(t,{...this.getShaders(),id:e,geometry:new mx({drawMode:5,attributes:{positions:new Float32Array(r)}}),isInstanced:!0});return l.setUniforms({numSegments:n}),l}}ye(jB,"layerName","ArcLayer"),ye(jB,"defaultProps",Cee);class Eee{constructor(t){ye(this,"opts",void 0),ye(this,"typedArrayManager",void 0),ye(this,"indexStarts",[0]),ye(this,"vertexStarts",[0]),ye(this,"vertexCount",0),ye(this,"instanceCount",0),ye(this,"attributes",void 0),ye(this,"_attributeDefs",void 0),ye(this,"data",void 0),ye(this,"getGeometry",void 0),ye(this,"geometryBuffer",void 0),ye(this,"buffers",void 0),ye(this,"positionSize",void 0),ye(this,"normalize",void 0);const{attributes:e={}}=t;this.typedArrayManager=kb,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:r,geometryBuffer:l,positionFormat:m,dataChanged:C,normalize:A=!0}=this.opts;if(this.data=e,this.getGeometry=r,this.positionSize=l&&l.size||("XY"===m?2:3),this.buffers=n,this.normalize=A,l&&(gl(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(l),A||(n.positions=l)),this.geometryBuffer=n.positions,Array.isArray(C))for(const O of C)this._rebuildGeometry(O);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}getGeometryFromBuffer(t){const e=t.value||t;return ArrayBuffer.isView(e)?P6(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,e){const{attributes:n,buffers:r,_attributeDefs:l,typedArrayManager:m}=this;for(const C in l)if(C in r)m.release(n[C]),n[C]=null;else{const A=l[C];A.copy=e,n[C]=m.allocate(n[C],t,A)}}_forEachGeometry(t,e,n){const{data:r,getGeometry:l}=this,{iterable:m,objectInfo:C}=FP(r,e,n);for(const A of m)C.index++,t(l?l(A,C):null,C.index)}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:e,vertexStarts:n,instanceCount:r}=this;const{data:l,geometryBuffer:m}=this,{startRow:C=0,endRow:A=1/0}=t||{},O={};if(t||(e=[0],n=[0]),this.normalize||!m)this._forEachGeometry(($,Q)=>{const te=$&&this.normalizeGeometry($);O[Q]=te,n[Q+1]=n[Q]+(te?this.getGeometrySize(te):0)},C,A),r=n[n.length-1];else if(n=l.startIndices,r=n[l.length]||0,ArrayBuffer.isView(m))r=r||m.length/this.positionSize;else if(m instanceof is)r=r||m.byteLength/(m.accessor.stride||4*this.positionSize);else if(m.buffer)r=r||m.buffer.byteLength/(m.stride||4*this.positionSize);else if(m.value){const $=m.value;r=r||$.length/(m.stride/$.BYTES_PER_ELEMENT||this.positionSize)}this._allocate(r,!!t),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=r;const z={};this._forEachGeometry(($,Q)=>{const te=O[Q]||$;z.vertexStart=n[Q],z.indexStart=e[Q],z.geometrySize=(Q<n.length-1?n[Q+1]:r)-n[Q],z.geometryIndex=Q,this.updateGeometryAttributes(te,z)},C,A),this.vertexCount=e[e.length-1]}}var jP=It(442);class Aee extends Eee{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?function Tee(i,t,e,n){let r;if(Array.isArray(i[0])){r=new Array(i.length*t);for(let m=0;m<i.length;m++)for(let C=0;C<t;C++)r[m*t+C]=i[m][C]||0}else r=i;return e?(0,jP.Mk)(r,{size:t,gridResolution:e}):n?(0,jP.Iy)(r,{size:t}):r}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(sG(t)){let n=0;for(const r of t)n+=this.getGeometrySize(r);return n}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&sG(t))for(const n of t){const r=this.getGeometrySize(n);e.geometrySize=r,this.updateGeometryAttributes(n,e),e.vertexStart+=r}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const n=this.attributes.segmentTypes,r=!!t&&this.isClosed(t),{vertexStart:l,geometrySize:m}=e;n.fill(0,l,l+m),r?(n[l]=4,n[l+m-2]=4):(n[l]+=1,n[l+m-2]+=2),n[l+m-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n||!t)return;const{vertexStart:r,geometrySize:l}=e,m=new Array(3);for(let C=r,A=0;A<l;C++,A++)this.getPointOnPath(t,A,m),n[3*C]=m[0],n[3*C+1]=m[1],n[3*C+2]=m[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:r}=this;e*r>=t.length&&(e+=1-t.length/r);const l=e*r;return n[0]=t[l],n[1]=t[l+1],n[2]=3===r&&t[l+2]||0,n}isClosed(t){if(!this.normalize)return!!this.opts.loop;const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}function sG(i){return Array.isArray(i[0])}const aG=[0,0,0,255],Iee={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:i=>i.path},getColor:{type:"accessor",value:aG},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},HB={enter:(i,t)=>t.length?t.subarray(t.length-i.length):i};class $B extends cg{constructor(...t){super(...t),ye(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\n    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\n    geometry.position = vec4(currPosition + offset, 1.0);\n    gl_Position = project_common_position_to_clipspace(geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[fx,Q1]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:HB,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:HB,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:HB,defaultValue:aG},instancePickingColors:{size:3,type:5121,accessor:(n,{index:r,target:l})=>this.encodePickingColor(n&&n.__source?n.__source.index:r,l)}}),this.setState({pathTesselator:new Aee({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);const{props:e,changeFlags:n}=t,r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:C}=this.state,A=e.data.attributes||{};C.updateGeometry({data:e.data,geometryBuffer:A.getPath,buffers:A,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:C.instanceCount,startIndices:C.vertexStarts}),n.dataChanged||r.invalidateAll()}if(n.extensionsChanged){var m;const{gl:C}=this.context;null===(m=this.state.model)||void 0===m||m.delete(),this.state.model=this._getModel(C),r.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find(l=>l.__source.index===n)),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else super.disablePickingIndex(t)}draw({uniforms:t}){const{jointRounded:e,capRounded:n,billboard:r,miterLimit:l,widthUnits:m,widthScale:C,widthMinPixels:A,widthMaxPixels:O}=this.props;this.state.model.setUniforms(t).setUniforms({jointType:Number(e),capType:Number(n),billboard:r,widthUnits:L_[m],widthScale:C,miterLimit:l,widthMinPixels:A,widthMaxPixels:O}).draw()}_getModel(t){return new lg(t,{...this.getShaders(),id:this.props.id,geometry:new mx({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}ye($B,"defaultProps",Iee),ye($B,"layerName","PathLayer");const lG=[0,0,0,255],Oee={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:i=>i.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:lG},getLineColor:{type:"accessor",value:lG},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class WB extends cg{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (!filled) {\n    discard;\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[fx,Q1]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:n}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(n),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{radiusUnits:e,radiusScale:n,radiusMinPixels:r,radiusMaxPixels:l,stroked:m,filled:C,billboard:A,antialiasing:O,lineWidthUnits:z,lineWidthScale:$,lineWidthMinPixels:Q,lineWidthMaxPixels:te}=this.props;this.state.model.setUniforms(t).setUniforms({stroked:m?1:0,filled:C,billboard:A,antialiasing:O,radiusUnits:L_[e],radiusScale:n,radiusMinPixels:r,radiusMaxPixels:l,lineWidthUnits:L_[z],lineWidthScale:$,lineWidthMinPixels:Q,lineWidthMaxPixels:te}).draw()}_getModel(t){return new lg(t,{...this.getShaders(),id:this.props.id,geometry:new mx({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}ye(WB,"defaultProps",Oee),ye(WB,"layerName","ScatterplotLayer");const Nee={getSourcePosition:{type:"accessor",value:i=>i.sourcePosition},getTargetPosition:{type:"accessor",value:i=>i.targetPosition},getColor:{type:"accessor",value:[0,0,0,255]},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class XB extends cg{getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  DECKGL_FILTER_GL_POSITION(p, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[fx,Q1]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:n}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(n),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{widthUnits:e,widthScale:n,widthMinPixels:r,widthMaxPixels:l,wrapLongitude:m}=this.props;this.state.model.setUniforms(t).setUniforms({widthUnits:L_[e],widthScale:n,widthMinPixels:r,widthMaxPixels:l,useShortestPath:m?1:0}).draw(),m&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(t){return new lg(t,{...this.getShaders(),id:this.props.id,geometry:new mx({drawMode:5,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0})}}ye(XB,"layerName","LineLayer"),ye(XB,"defaultProps",Nee);var qB=It(307);const cG=new Float32Array(12);function dG(i,t=2){let e=0;for(const n of i)for(let r=0;r<t;r++)cG[e++]=n[r]||0;return cG}class uG extends cg{getShaders(){return{vs:"#define SHADER_NAME heatp-map-layer-vertex-shader\n\nuniform sampler2D maxTexture;\nuniform float intensity;\nuniform vec2 colorDomain;\nuniform float threshold;\nuniform float aggregationMode;\n\nattribute vec3 positions;\nattribute vec2 texCoords;\n\nvarying vec2 vTexCoords;\nvarying float vIntensityMin;\nvarying float vIntensityMax;\n\nvoid main(void) {\n  gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));\n  vTexCoords = texCoords;\n  vec4 maxTexture = texture2D(maxTexture, vec2(0.5));\n  float maxValue = aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;\n  float minValue = maxValue * threshold;\n  if (colorDomain[1] > 0.) {\n    maxValue = colorDomain[1];\n    minValue = colorDomain[0];\n  }\n  vIntensityMax = intensity / maxValue;\n  vIntensityMin = intensity / minValue;\n}\n",fs:"#define SHADER_NAME triangle-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D texture;\nuniform sampler2D colorTexture;\nuniform float aggregationMode;\n\nvarying vec2 vTexCoords;\nvarying float vIntensityMin;\nvarying float vIntensityMax;\n\nvec4 getLinearColor(float value) {\n  float factor = clamp(value * vIntensityMax, 0., 1.);\n  vec4 color = texture2D(colorTexture, vec2(factor, 0.5));\n  color.a *= min(value * vIntensityMin, 1.0);\n  return color;\n}\n\nvoid main(void) {\n  vec4 weights = texture2D(texture, vTexCoords);\n  float weight = weights.r;\n\n  if (aggregationMode > 0.5) {\n    weight /= max(1.0, weights.a);\n  }\n  if (weight <= 0.) {\n     discard;\n  }\n\n  vec4 linearColor = getLinearColor(weight);\n  linearColor.a *= opacity;\n  gl_FragColor =linearColor;\n}\n",modules:[fx]}}initializeState({gl:t}){this.getAttributeManager().add({positions:{size:3,noAlloc:!0},texCoords:{size:2,noAlloc:!0}}),this.setState({model:this._getModel(t)})}_getModel(t){const{vertexCount:e}=this.props;return new lg(t,{...this.getShaders(),id:this.props.id,geometry:new mx({drawMode:6,vertexCount:e})})}draw({uniforms:t}){const{model:e}=this.state,{texture:n,maxTexture:r,colorTexture:l,intensity:m,threshold:C,aggregationMode:A,colorDomain:O}=this.props;e.setUniforms({...t,texture:n,maxTexture:r,colorTexture:l,intensity:m,threshold:C,aggregationMode:A,colorDomain:O}).draw()}}ye(uG,"layerName","TriangleLayer");class YB extends cg{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id&&(t.object=e.__source.object,t.index=e.__source.index),t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"==typeof t){const e={index:-1,data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,r)}return t}getSubLayerProps(t={}){var e;const{opacity:n,pickable:r,visible:l,parameters:m,getPolygonOffset:C,highlightedObjectIndex:A,autoHighlight:O,highlightColor:z,coordinateSystem:$,coordinateOrigin:Q,wrapLongitude:te,positionFormat:de,modelMatrix:fe,extensions:ge,fetch:Re,operation:qe,_subLayerProps:et}=this.props,yt={id:"",updateTriggers:{},opacity:n,pickable:r,visible:l,parameters:m,getPolygonOffset:C,highlightedObjectIndex:A,autoHighlight:O,highlightColor:z,coordinateSystem:$,coordinateOrigin:Q,wrapLongitude:te,positionFormat:de,modelMatrix:fe,extensions:ge,fetch:Re,operation:qe},Jt=et&&t.id&&et[t.id],fi=Jt&&Jt.updateTriggers,Hi=t.id||"sublayer";if(Jt){const tn=this.props[M_],cn=t.type?t.type._propTypes:{};for(const _n in Jt){const Rr=cn[_n]||tn[_n];Rr&&"accessor"===Rr.type&&(Jt[_n]=this.getSubLayerAccessor(Jt[_n]))}}Object.assign(yt,t,Jt),yt.id="".concat(this.props.id,"-").concat(Hi),yt.updateTriggers={all:null===(e=this.props.updateTriggers)||void 0===e?void 0:e.all,...t.updateTriggers,...fi};for(const tn of ge){const cn=tn.getSubLayerProps.call(this,tn);cn&&Object.assign(yt,cn,{updateTriggers:Object.assign(yt.updateTriggers,cn.updateTriggers)})}return yt}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const r=!n||this.needsUpdate();r&&(n=Z0(this.renderLayers(),Boolean),this.internalState.subLayers=n),Bl("compositeLayer.renderLayers",this,r,n);for(const l of n)l.parent=this}}function Wee(i,t){const e={};for(const n in i)t.includes(n)||(e[n]=i[n]);return e}ye(YB,"layerName","CompositeLayer");class yk extends YB{constructor(...t){super(...t),ye(this,"state",void 0)}initializeAggregationLayer(t){super.initializeState(this.context),this.setState({ignoreProps:Wee(this.constructor._propTypes,t.data.props),dimensions:t})}updateState(t){super.updateState(t);const{changeFlags:e}=t;if(e.extensionsChanged){const n=this.getShaders({});n&&n.defines&&(n.defines.NON_INSTANCED_MODEL=1),this.updateShaders(n)}this._updateAttributes()}updateAttributes(t){this.setState({changedAttributes:t})}getAttributes(){return this.getAttributeManager().getShaderAttributes()}getModuleSettings(){const{viewport:t,mousePosition:e,gl:n}=this.context;return Object.assign(Object.create(this.props),{viewport:t,mousePosition:e,pickingActive:0,devicePixelRatio:S_(n)})}updateShaders(t){}isAggregationDirty(t,e={}){const{props:n,oldProps:r,changeFlags:l}=t,{compareAll:m=!1,dimension:C}=e,{ignoreProps:A}=this.state,{props:O,accessors:z=[]}=C,{updateTriggersChanged:$}=l;if(l.dataChanged)return!0;if($){if($.all)return!0;for(const Q of z)if($[Q])return!0}if(m)return!!l.extensionsChanged||OB({oldProps:r,newProps:n,ignoreProps:A,propTypes:this.constructor._propTypes});for(const Q of O)if(n[Q]!==r[Q])return!0;return!1}isAttributeChanged(t){const{changedAttributes:e}=this.state;return t?e&&void 0!==e[t]:!function Xee(i){let t=!0;for(const e in i){t=!1;break}return t}(e)}_getAttributeManager(){return new PB(this.context.gl,{id:this.props.id,stats:this.context.stats})}}ye(yk,"layerName","AggregationLayer");const bS=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function GP(i,t=!1,e=Float32Array){let n;if(Number.isFinite(i[0]))n=new e(i);else{n=new e(4*i.length);let r=0;for(let l=0;l<i.length;l++){const m=i[l];n[r++]=m[0],n[r++]=m[1],n[r++]=m[2],n[r++]=Number.isFinite(m[3])?m[3]:255}}if(t)for(let r=0;r<n.length;r++)n[r]/=255;return n}const ZB={mipmaps:!1,parameters:{10240:9729,10241:9729,10242:33071,10243:33071},dataFormat:6408},hG=[0,0],Jee={SUM:0,MEAN:1},ete={getPosition:{type:"accessor",value:i=>i.position},getWeight:{type:"accessor",value:1},intensity:{type:"number",min:0,value:1},radiusPixels:{type:"number",min:1,max:100,value:50},colorRange:bS,threshold:{type:"number",min:0,max:1,value:.05},colorDomain:{type:"array",value:null,optional:!0},aggregation:"SUM",weightsTextureSize:{type:"number",min:128,max:2048,value:2048},debounceTimeout:{type:"number",min:0,max:1e3,value:500}},tte=["BLEND_EQUATION_MINMAX","TEXTURE_FLOAT"],ite=["COLOR_ATTACHMENT_RGBA32F","FLOAT_BLEND"],nte={data:{props:["radiusPixels"]}};class KB extends yk{constructor(...t){super(...t),ye(this,"state",void 0)}initializeState(){const{gl:t}=this.context;if(!q1(t,tte))return this.setState({supported:!1}),void so.error("HeatmapLayer: ".concat(this.id," is not supported on this browser"))();super.initializeAggregationLayer(nte),this.setState({supported:!0,colorDomain:hG}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState(t){this.state.supported&&(super.updateState(t),this._updateHeatmapState(t))}_updateHeatmapState(t){const{props:e,oldProps:n}=t,r=this._getChangeFlags(t);(r.dataChanged||r.viewportChanged)&&(r.boundsChanged=this._updateBounds(r.dataChanged),this._updateTextureRenderingBounds()),r.dataChanged||r.boundsChanged?(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0})):r.viewportZoomChanged&&this._debouncedUpdateWeightmap(),e.colorRange!==n.colorRange&&this._updateColorTexture(t),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:t.context.viewport.zoom})}renderLayers(){if(!this.state.supported)return[];const{weightsTexture:t,triPositionBuffer:e,triTexCoordBuffer:n,maxWeightsTexture:r,colorTexture:l,colorDomain:m}=this.state,{updateTriggers:C,intensity:A,threshold:O,aggregation:z}=this.props;return new(this.getSubLayerClass("triangle",uG))(this.getSubLayerProps({id:"triangle-layer",updateTriggers:C}),{coordinateSystem:Ro.DEFAULT,data:{attributes:{positions:e,texCoords:n}},vertexCount:4,maxTexture:r,colorTexture:l,aggregationMode:Jee[z]||0,texture:t,intensity:A,threshold:O,colorDomain:m})}finalizeState(t){super.finalizeState(t);const{weightsTransform:e,weightsTexture:n,maxWeightTransform:r,maxWeightsTexture:l,triPositionBuffer:m,triTexCoordBuffer:C,colorTexture:A,updateTimer:O}=this.state;e?.delete(),n?.delete(),r?.delete(),l?.delete(),m?.delete(),C?.delete(),A?.delete(),O&&clearTimeout(O)}_getAttributeManager(){return new PB(this.context.gl,{id:this.props.id,stats:this.context.stats})}_getChangeFlags(t){const e={},{dimensions:n}=this.state;e.dataChanged=this.isAttributeChanged()||this.isAggregationDirty(t,{compareAll:!0,dimension:n.data}),e.viewportChanged=t.changeFlags.viewportChanged;const{zoom:r}=this.state;return(!t.context.viewport||t.context.viewport.zoom!==r)&&(e.viewportZoomChanged=!0),e}_createTextures(){const{gl:t}=this.context,{textureSize:e,format:n,type:r}=this.state;this.setState({weightsTexture:new vu(t,{width:e,height:e,format:n,type:r,...ZB}),maxWeightsTexture:new vu(t,{format:n,type:r,...ZB})})}_setupAttributes(){this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"},weights:{size:1,accessor:"getWeight"}}),this.setState({positionAttributeName:"positions"})}_setupTextureParams(){const{gl:t}=this.context,{weightsTextureSize:e}=this.props,n=Math.min(e,yT(t,3379)),r=q1(t,ite),{format:l,type:m}=function jee({gl:i,floatTargetSupport:t}){return t?{format:go(i)?34836:6408,type:5126}:{format:6408,type:5121}}({gl:t,floatTargetSupport:r});this.setState({textureSize:n,format:l,type:m,weightsScale:r?1:1/255}),r||so.warn("HeatmapLayer: ".concat(this.id," rendering to float texture not supported, fallingback to low precession format"))()}getShaders(t){return super.getShaders("max-weights-transform"===t?{vs:"attribute vec4 inTexture;\nvarying vec4 outTexture;\n\nvoid main()\n{\noutTexture = inTexture;\ngl_Position = vec4(0, 0, 0, 1.);\ngl_PointSize = 1.0;\n}\n",_fs:"varying vec4 outTexture;\nvoid main() {\n  gl_FragColor = outTexture;\n  gl_FragColor.g = outTexture.r / max(1.0, outTexture.a);\n}\n"}:{vs:"attribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float weights;\nvarying vec4 weightsTexture;\nuniform float radiusPixels;\nuniform float textureWidth;\nuniform vec4 commonBounds;\nuniform float weightsScale;\nvoid main()\n{\n  weightsTexture = vec4(weights * weightsScale, 0., 0., 1.);\n\n  float radiusTexels  = project_pixel_size(radiusPixels) * textureWidth / (commonBounds.z - commonBounds.x);\n  gl_PointSize = radiusTexels * 2.;\n\n  vec3 commonPosition = project_position(positions, positions64Low);\n  gl_Position.xy = (commonPosition.xy - commonBounds.xy) / (commonBounds.zw - commonBounds.xy) ;\n  gl_Position.xy = (gl_Position.xy * 2.) - (1.);\n}\n",_fs:"varying vec4 weightsTexture;\nfloat gaussianKDE(float u){\n  return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);\n}\nvoid main()\n{\n  float dist = length(gl_PointCoord - vec2(0.5, 0.5));\n  if (dist > 0.5) {\n    discard;\n  }\n  gl_FragColor = weightsTexture * gaussianKDE(2. * dist);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}_createWeightsTransform(t={}){var e;const{gl:n}=this.context;let{weightsTransform:r}=this.state;const{weightsTexture:l}=this.state;null===(e=r)||void 0===e||e.delete(),r=new vS(n,{id:"".concat(this.id,"-weights-transform"),elementCount:1,_targetTexture:l,_targetTextureVarying:"weightsTexture",...t}),this.setState({weightsTransform:r})}_setupResources(){const{gl:t}=this.context;this._createTextures();const{textureSize:e,weightsTexture:n,maxWeightsTexture:r}=this.state,l=this.getShaders("weights-transform");this._createWeightsTransform(l);const m=this.getShaders("max-weights-transform"),C=new vS(t,{id:"".concat(this.id,"-max-weights-transform"),_sourceTextures:{inTexture:n},_targetTexture:r,_targetTextureVarying:"outTexture",...m,elementCount:e*e});this.setState({weightsTexture:n,maxWeightsTexture:r,maxWeightTransform:C,zoom:null,triPositionBuffer:new is(t,{byteLength:48,accessor:{size:3}}),triTexCoordBuffer:new is(t,{byteLength:48,accessor:{size:2}})})}updateShaders(t){this._createWeightsTransform(t)}_updateMaxWeightValue(){const{maxWeightTransform:t}=this.state;t.run({parameters:{blend:!0,depthTest:!1,blendFunc:[1,1],blendEquation:32776}})}_updateBounds(t=!1){const{viewport:e}=this.context,n=[e.unproject([0,0]),e.unproject([e.width,0]),e.unproject([e.width,e.height]),e.unproject([0,e.height])].map(C=>C.map(Math.fround)),r=function Bee(i){const t=i.map(C=>C[0]),e=i.map(C=>C[1]),n=Math.min.apply(null,t),r=Math.max.apply(null,t);return[n,Math.min.apply(null,e),r,Math.max.apply(null,e)]}(n),l={visibleWorldBounds:r,viewportCorners:n};let m=!1;if(t||!this.state.worldBounds||!function Vee(i,t){return t[0]>=i[0]&&t[2]<=i[2]&&t[1]>=i[1]&&t[3]<=i[3]}(this.state.worldBounds,r)){const C=this._worldToCommonBounds(r),A=this._commonToWorldBounds(C);this.props.coordinateSystem===Ro.LNGLAT&&(A[1]=Math.max(A[1],-85.051129),A[3]=Math.min(A[3],85.051129),A[0]=Math.max(A[0],-360),A[2]=Math.min(A[2],360));const O=this._worldToCommonBounds(A);l.worldBounds=A,l.normalizedCommonBounds=O,m=!0}return this.setState(l),m}_updateTextureRenderingBounds(){const{triPositionBuffer:t,triTexCoordBuffer:e,normalizedCommonBounds:n,viewportCorners:r}=this.state,{viewport:l}=this.context;t.subData(dG(r,3));const m=r.map(C=>function Uee(i,t){const[e,n,r,l]=t;return[(i[0]-e)/(r-e),(i[1]-n)/(l-n)]}(l.projectPosition(C),n));e.subData(dG(m,2))}_updateColorTexture(t){const{colorRange:e}=t.props;let{colorTexture:n}=this.state;const r=GP(e,!1,Uint8Array);n?n.setImageData({data:r,width:e.length}):n=new vu(this.context.gl,{data:r,width:e.length,height:1,...ZB}),this.setState({colorTexture:n})}_updateWeightmap(){const{radiusPixels:t,colorDomain:e,aggregation:n}=this.props,{weightsTransform:r,worldBounds:l,textureSize:m,weightsTexture:C,weightsScale:A}=this.state;this.state.isWeightMapDirty=!1;const O=this._worldToCommonBounds(l,{useLayerCoordinateSystem:!0});if(e&&"SUM"===n){const{viewport:$}=this.context,Q=$.distanceScales.metersPerUnit[2]*(O[2]-O[0])/m;this.state.colorDomain=e.map(te=>te*Q*A)}else this.state.colorDomain=e||hG;const z={radiusPixels:t,commonBounds:O,textureWidth:m,weightsScale:A};r.update({elementCount:this.getNumInstances()}),Nl(this.context.gl,{clearColor:[0,0,0,0]},()=>{r.run({uniforms:z,parameters:{blend:!0,depthTest:!1,blendFunc:[1,1],blendEquation:32774},clearRenderTarget:!0,attributes:this.getAttributes(),moduleSettings:this.getModuleSettings()})}),this._updateMaxWeightValue(),C.setParameters({10240:9729,10241:9729})}_debouncedUpdateWeightmap(t=!1){let{updateTimer:e}=this.state;const{debounceTimeout:n}=this.props;t?(e=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(e),e=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),n)),this.setState({updateTimer:e})}_worldToCommonBounds(t,e={}){const{useLayerCoordinateSystem:n=!1}=e,[r,l,m,C]=t,{viewport:A}=this.context,{textureSize:O}=this.state,{coordinateSystem:z}=this.props,$=n&&(z===Ro.LNGLAT_OFFSETS||z===Ro.METER_OFFSETS),Q=$?A.projectPosition(this.props.coordinateOrigin):[0,0],te=2*O/A.scale;let de,fe;return n&&!$?(de=this.projectPosition([r,l,0]),fe=this.projectPosition([m,C,0])):(de=A.projectPosition([r,l,0]),fe=A.projectPosition([m,C,0])),function zee(i,t,e){const[n,r,l,m]=i,C=l-n,A=m-r;let O=C,z=A;C/A<t/e?O=t/e*A:z=e/t*C,O<t&&(O=t,z=e);const $=(l+n)/2,Q=(m+r)/2;return[$-O/2,Q-z/2,$+O/2,Q+z/2]}([de[0]-Q[0],de[1]-Q[1],fe[0]-Q[0],fe[1]-Q[1]],te,te)}_commonToWorldBounds(t){const[e,n,r,l]=t,{viewport:m}=this.context,C=m.unprojectPosition([e,n]),A=m.unprojectPosition([r,l]);return C.slice(0,2).concat(A.slice(0,2))}}ye(KB,"layerName","HeatmapLayer"),ye(KB,"defaultProps",ete);const fG="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",rte={lightSources:{}};function QB(){let{color:i=[0,0,0],intensity:t=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.map(e=>e*t/255)}const pG={name:"lights",vs:fG,fs:fG,getUniforms:function mG(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rte;if("lightSources"in i){const{ambientLight:t,pointLights:e,directionalLights:n}=i.lightSources||{};return t||e&&e.length>0||n&&n.length>0?Object.assign({},function ote(i){let{ambientLight:t,pointLights:e=[],directionalLights:n=[]}=i;const r={};return r["lighting_uAmbientLight.color"]=t?QB(t):[0,0,0],e.forEach((l,m)=>{r["lighting_uPointLight[".concat(m,"].color")]=QB(l),r["lighting_uPointLight[".concat(m,"].position")]=l.position,r["lighting_uPointLight[".concat(m,"].attenuation")]=l.attenuation||[1,0,0]}),r.lighting_uPointLightCount=e.length,n.forEach((l,m)=>{r["lighting_uDirectionalLight[".concat(m,"].color")]=QB(l),r["lighting_uDirectionalLight[".concat(m,"].direction")]=l.direction}),r.lighting_uDirectionalLightCount=n.length,r}({ambientLight:t,pointLights:e,directionalLights:n}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in i){const t={pointLights:[],directionalLights:[]};for(const e of i.lights||[])switch(e.type){case"ambient":t.ambientLight=e;break;case"directional":t.directionalLights.push(e);break;case"point":t.pointLights.push(e)}return mG({lightSources:t})}return{}},defines:{MAX_LIGHTS:3}},gG="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",ste={};function _G(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ste;if(!("material"in i))return{};const{material:t}=i;return t?function ate(i){const{ambient:t=.35,diffuse:e=.6,shininess:n=32,specularColor:r=[30,30,30]}=i;return{lighting_uAmbient:t,lighting_uDiffuse:e,lighting_uShininess:n,lighting_uSpecularColor:r.map(l=>l/255)}}(t):{lighting_uEnabled:!1}}const vG={name:"gouraud-lighting",dependencies:[pG],vs:gG,defines:{LIGHTING_VERTEX:1},getUniforms:_G},lte={name:"phong-lighting",dependencies:[pG],fs:gG,defines:{LIGHTING_FRAGMENT:1},getUniforms:_G};class cte extends mx{constructor(t){const{id:e=F_("column-geometry")}=t,{indices:n,attributes:r}=function dte(i){const{radius:t,height:e=1,nradial:n=10}=i;let{vertices:r}=i;r&&(so.assert(r.length>=n),r=r.flatMap(te=>[te[0],te[1]]),(0,jP.UD)(r,jP.rJ.COUNTER_CLOCKWISE));const l=e>0,m=n+1,C=l?3*m+1:n,A=2*Math.PI/n,O=new Uint16Array(l?3*n*2:0),z=new Float32Array(3*C),$=new Float32Array(3*C);let Q=0;if(l){for(let te=0;te<m;te++){const de=te*A,fe=te%n,ge=Math.sin(de),Re=Math.cos(de);for(let qe=0;qe<2;qe++)z[Q+0]=r?r[2*fe]:Re*t,z[Q+1]=r?r[2*fe+1]:ge*t,z[Q+2]=(.5-qe)*e,$[Q+0]=r?r[2*fe]:Re,$[Q+1]=r?r[2*fe+1]:ge,Q+=3}z[Q+0]=z[Q-3],z[Q+1]=z[Q-2],z[Q+2]=z[Q-1],Q+=3}for(let te=l?0:1;te<m;te++){const de=Math.floor(te/2)*Math.sign(.5-te%2),fe=de*A,ge=(de+n)%n,Re=Math.sin(fe),qe=Math.cos(fe);z[Q+0]=r?r[2*ge]:qe*t,z[Q+1]=r?r[2*ge+1]:Re*t,z[Q+2]=e/2,$[Q+2]=1,Q+=3}if(l){let te=0;for(let de=0;de<n;de++)O[te++]=2*de+0,O[te++]=2*de+2,O[te++]=2*de+0,O[te++]=2*de+1,O[te++]=2*de+1,O[te++]=2*de+3}return{indices:O,attributes:{POSITION:{size:3,value:z},NORMAL:{size:3,value:$}}}}(t);super({...t,id:e,indices:n,attributes:r})}}const HP=[0,0,0,255],fte={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:i=>i.position},getFillColor:{type:"accessor",value:HP},getLineColor:{type:"accessor",value:HP},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class $P extends cg{getShaders(){const{gl:t}=this.context,e=!go(t),n={},r=this.props.flatShading&&gj(t,"GLSL_DERIVATIVES");return r&&(n.FLAT_SHADING=1),super.getShaders({vs:"#version 300 es\n\n#define SHADER_NAME column-layer-vertex-shader\n\nin vec3 positions;\nin vec3 normals;\n\nin vec3 instancePositions;\nin float instanceElevations;\nin vec3 instancePositions64Low;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin float instanceStrokeWidths;\n\nin vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool stroked;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int radiusUnits;\nuniform int widthUnits;\nout vec4 vColor;\n#ifdef FLAT_SHADING\nout vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (stroked) {\n    float widthPixels = clamp(\n      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n    if (isStroke) {\n      strokeOffsetRatio -= sign(positions.z) * halfOffset;\n    } else {\n      strokeOffsetRatio -= halfOffset;\n    }\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\n  if (radiusUnits == UNIT_METERS) {\n    offset = project_size(offset);\n  }\n  vec3 pos = vec3(offset, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n#ifdef FLAT_SHADING\n    position_commonspace = geometry.position;\n    vColor = vec4(color.rgb, color.a * opacity);\n#else\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n#endif\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nuniform vec3 project_uCameraPosition;\nuniform bool extruded;\nuniform bool isStroke;\n\nout vec4 fragColor;\n\nin vec4 vColor;\n#ifdef FLAT_SHADING\nin vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  fragColor = vColor;\n#ifdef FLAT_SHADING\n  if (extruded && !isStroke && !picking_uActive) {\n    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\n  }\n#endif\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:n,transpileToGLSL100:e,modules:[fx,r?lte:vG,Q1]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:HP},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:HP},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:r}=t,l=r.extensionsChanged||e.flatShading!==n.flatShading;if(l){var m;const{gl:C}=this.context;null===(m=this.state.model)||void 0===m||m.delete(),this.state.model=this._getModel(C),this.getAttributeManager().invalidateAll()}(l||e.diskResolution!==n.diskResolution||e.vertices!==n.vertices||(e.extruded||e.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(e)}getGeometry(t,e,n){const r=new cte({radius:1,height:n?2:0,vertices:e,nradial:t});let l=0;if(e)for(let m=0;m<t;m++){const C=e[m];l+=Math.sqrt(C[0]*C[0]+C[1]*C[1])/t}else l=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*l}),r}_getModel(t){return new lg(t,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:t,vertices:e,extruded:n,stroked:r}){const l=this.getGeometry(t,e,n||r);this.setState({fillVertexCount:l.attributes.POSITION.value.length/3,wireframeVertexCount:l.indices.value.length}),this.state.model.setProps({geometry:l})}draw({uniforms:t}){const{lineWidthUnits:e,lineWidthScale:n,lineWidthMinPixels:r,lineWidthMaxPixels:l,radiusUnits:m,elevationScale:C,extruded:A,filled:O,stroked:z,wireframe:$,offset:Q,coverage:te,radius:de,angle:fe}=this.props,{model:ge,fillVertexCount:Re,wireframeVertexCount:qe,edgeDistance:et}=this.state;ge.setUniforms(t).setUniforms({radius:de,angle:fe/180*Math.PI,offset:Q,extruded:A,stroked:z,coverage:te,elevationScale:C,edgeDistance:et,radiusUnits:L_[m],widthUnits:L_[e],widthScale:n,widthMinPixels:r,widthMaxPixels:l}),A&&$&&(ge.setProps({isIndexed:!0}),ge.setVertexCount(qe).setDrawMode(1).setUniforms({isStroke:!0}).draw()),O&&(ge.setProps({isIndexed:!1}),ge.setVertexCount(Re).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!A&&z&&(ge.setProps({isIndexed:!1}),ge.setVertexCount(2*Re/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}ye($P,"layerName","ColumnLayer"),ye($P,"defaultProps",fte);var yS=Math.PI/3,mte=[0,yS,2*yS,3*yS,4*yS,5*yS];function pte(i){return i[0]}function gte(i){return i[1]}function _te(){var m,C,A,i=0,t=0,e=1,n=1,r=pte,l=gte;function O($){var de,Q={},te=[],fe=$.length;for(de=0;de<fe;++de)if(!isNaN(Re=+r.call(null,ge=$[de],de,$))&&!isNaN(qe=+l.call(null,ge,de,$))){var ge,Re,qe,et=Math.round(qe/=A),yt=Math.round(Re=Re/C-(1&et)/2),Jt=qe-et;if(3*Math.abs(Jt)>1){var fi=Re-yt,Hi=yt+(Re<yt?-1:1)/2,tn=et+(qe<et?-1:1),cn=Re-Hi,_n=qe-tn;fi*fi+Jt*Jt>cn*cn+_n*_n&&(yt=Hi+(1&et?1:-1)/2,et=tn)}var Rr=yt+"-"+et,to=Q[Rr];to?to.push(ge):(te.push(to=Q[Rr]=[ge]),to.x=(yt+(1&et)/2)*C,to.y=et*A)}return te}function z($){var Q=0,te=0;return mte.map(function(de){var fe=Math.sin(de)*$,ge=-Math.cos(de)*$,Re=fe-Q,qe=ge-te;return Q=fe,te=ge,[Re,qe]})}return O.hexagon=function($){return"m"+z(null==$?m:+$).join("l")+"z"},O.centers=function(){for(var $=[],Q=Math.round(t/A),te=Math.round(i/C),de=Q*A;de<n+m;de+=A,++Q)for(var fe=te*C+(1&Q)*C/2;fe<e+C/2;fe+=C)$.push([fe,de]);return $},O.mesh=function(){var $=z(m).slice(0,4).join("l");return O.centers().map(function(Q){return"M"+Q+"m"+$}).join("")},O.x=function($){return arguments.length?(r=$,O):r},O.y=function($){return arguments.length?(l=$,O):l},O.radius=function($){return arguments.length?(C=2*(m=+$)*Math.sin(yS),A=1.5*m,O):m},O.size=function($){return arguments.length?(i=t=0,e=+$[0],n=+$[1],O):[e-i,n-t]},O.extent=function($){return arguments.length?(i=+$[0][0],t=+$[0][1],e=+$[1][0],n=+$[1][1],O):[[i,t],[e,n]]},O.radius(1)}function WP(i,t,e){const n=e;return n.domain=()=>i,n.range=()=>t,n}function bG(i,t){return WP(i,t,n=>function Ate(i,t,e){const n=i[1]-i[0];if(n<=0)return so.warn("quantizeScale: invalid domain, returning range[0]")(),t[0];const l=Math.floor((e-i[0])/(n/t.length));return t[Math.max(Math.min(l,t.length-1),0)]}(i,t,n))}function xte(i,t){return WP(i,t,n=>function Dte(i,t,e){return(e-i[0])/(i[1]-i[0])*(t[1]-t[0])+t[0]}(i,t,n))}function wte(i,t){const e=i.sort(yG);let n=0;const r=Math.max(1,t.length),l=new Array(r-1);for(;++n<r;)l[n-1]=Cte(e,n/r);const m=C=>function Tte(i,t,e){return t[function Ete(i,t){let e=0,n=i.length;for(;e<n;){const r=e+n>>>1;yG(i[r],t)>0?n=r:e=r+1}return e}(i,e)]}(l,t,C);return m.thresholds=()=>l,WP(i,t,m)}function yG(i,t){return i-t}function Cte(i,t){const e=i.length;if(t<=0||e<2)return i[0];if(t>=1)return i[e-1];const n=(e-1)*t,r=Math.floor(n),l=i[r];return l+(i[r+1]-l)*(n-r)}function Mte(i,t){const e=new Map,n=[];for(const l of i){const m="".concat(l);e.has(m)||e.set(m,n.push(l))}return WP(i,t,l=>function Ste(i,t,e,n){const r="".concat(n);let l=t.get(r);return void 0===l&&(l=i.push(n),t.set(r,l)),e[(l-1)%e.length]}(n,e,t,l))}function xG(i){return null!=i}function JB(i,t){return("function"==typeof t?i.map(t):i).filter(xG)}const TG=i=>i.length,SG=i=>i.points,MG=i=>i.index,AG=(i,t)=>i<t?-1:i>t?1:i>=t?0:NaN,Ote={getValue:TG,getPoints:SG,getIndex:MG,filterData:null};class DG{constructor(t=[],e=Ote){ye(this,"maxCount",void 0),ye(this,"maxValue",void 0),ye(this,"minValue",void 0),ye(this,"totalCount",void 0),ye(this,"aggregatedBins",void 0),ye(this,"sortedBins",void 0),ye(this,"binMap",void 0),this.aggregatedBins=this.getAggregatedBins(t,e),this._updateMinMaxValues(),this.binMap=this.getBinMap()}getAggregatedBins(t,e){const{getValue:n=TG,getPoints:r=SG,getIndex:l=MG,filterData:m}=e,C="function"==typeof m,A=t.length,O=[];let z=0;for(let $=0;$<A;$++){const Q=t[$],te=r(Q),de=l(Q),fe=C?te.filter(m):te;Q.filteredPoints=C?fe:null;const ge=fe.length?n(fe):null;null!=ge&&(O[z]={i:Number.isFinite(de)?de:$,value:ge,counts:fe.length},z++)}return O}_percentileToIndex(t){const e=this.sortedBins.length;if(e<2)return[0,0];const[n,r]=t.map(C=>function Ite(i,t,e){return Math.max(t,Math.min(e,i))}(C,0,100));return[Math.ceil(n/100*(e-1)),Math.floor(r/100*(e-1))]}getBinMap(){const t={};for(const e of this.aggregatedBins)t[e.i]=e;return t}_updateMinMaxValues(){let t=0,e=0,n=3402823466e29,r=0;for(const l of this.aggregatedBins)t=t>l.counts?t:l.counts,e=e>l.value?e:l.value,n=n<l.value?n:l.value,r+=l.counts;this.maxCount=t,this.maxValue=e,this.minValue=n,this.totalCount=r}getValueRange(t){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((r,l)=>AG(r.value,l.value))),!this.sortedBins.length)return[];let e=0,n=this.sortedBins.length-1;if(Array.isArray(t)){const r=this._percentileToIndex(t);e=r[0],n=r[1]}return[this.sortedBins[e].value,this.sortedBins[n].value]}getValueDomainByScale(t,[e=0,n=100]=[]){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((l,m)=>AG(l.value,m.value))),!this.sortedBins.length)return[];const r=this._percentileToIndex([e,n]);return this._getScaleDomain(t,r)}_getScaleDomain(t,[e,n]){const r=this.sortedBins;switch(t){case"quantize":case"linear":default:return[r[e].value,r[n].value];case"quantile":return function CG(i,t){return JB(i,t)}(r.slice(e,n+1),l=>l.value);case"ordinal":return function EG(i,t){return function kte(i){const t=[];return i.forEach(e=>{!t.includes(e)&&xG(e)&&t.push(e)}),t}(JB(i,t))}(r,l=>l.value)}}}const Dc={SUM:1,MEAN:2,MIN:3,MAX:4};function kG(i,t){return i+t}function Lte(i,t){return t>i?t:i}function Fte(i,t){return t<i?t:i}function IG(i,t,e){const n=Dc[i]||Dc.SUM;switch(t=function Ute(i,t={}){return Number.isFinite(i)?i:e=>(t.index=e.index,i(e.source,t))}(t,e),n){case Dc.MIN:return r=>function zte(i,t){if(Number.isFinite(t))return i.length?t:null;const e=i.map(t).filter(Number.isFinite);return e.length?e.reduce(Fte,1/0):null}(r,t);case Dc.SUM:return r=>function Bte(i,t){if(Number.isFinite(t))return i.length?i.length*t:null;const e=i.map(t).filter(Number.isFinite);return e.length?e.reduce(kG,0):null}(r,t);case Dc.MEAN:return r=>function Nte(i,t){if(Number.isFinite(t))return i.length?t:null;const e=i.map(t).filter(Number.isFinite);return e.length?e.reduce(kG,0)/e.length:null}(r,t);case Dc.MAX:return r=>function Vte(i,t){if(Number.isFinite(t))return i.length?t:null;const e=i.map(t).filter(Number.isFinite);return e.length?e.reduce(Lte,-1/0):null}(r,t);default:return null}}function jte(i,t={}){return e=>(t.indices=e.map(n=>n.index),i(e.map(n=>n.source),t))}function RG(){}const PG=["getBins","getDomain","getScaleFunc"],OG=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],Gte=i=>i.cellSize;class LG{constructor(t){this.state={layerData:{},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=t.getCellSize||Gte,this._getAggregator=t.getAggregator,this._addDimension(t.dimensions||OG)}static defaultDimensions(){return OG}updateState(t,e){const{oldProps:n,props:r,changeFlags:l}=t;this.updateGetValueFuncs(n,r,l);const m=this.needsReProjectPoints(n,r,l);let C=!1;return l.dataChanged||m?(this.getAggregatedData(r,e),C=!0):((this.getDimensionChanges(n,r,l)||[]).forEach(O=>"function"==typeof O&&O()),C=!0),this.setState({aggregationDirty:C}),this.state}setState(t){this.state={...this.state,...t}}setDimensionState(t,e){this.setState({dimensions:{...this.state.dimensions,[t]:{...this.state.dimensions[t],...e}}})}normalizeResult(t={}){return t.hexagons?{data:t.hexagons,...t}:t.layerData?{data:t.layerData,...t}:t}getAggregatedData(t,e){const r=this._getAggregator(t)(t,e);this.setState({layerData:this.normalizeResult(r)}),this.changeFlags={layerData:!0},this.getSortedBins(t)}updateGetValueFuncs(t,e,n){for(const r in this.dimensionUpdaters){const{value:l,weight:m,aggregation:C}=this.dimensionUpdaters[r].getBins.triggers;let A=e[l.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[r].getBins,t,e,n)&&(A=A?jte(A,{data:e.data}):IG(e[C.prop],e[m.prop],{data:e.data})),A&&this.setDimensionState(r,{getValue:A})}}needsReProjectPoints(t,e,n){return this._getCellSize(t)!==this._getCellSize(e)||this._getAggregator(t)!==this._getAggregator(e)||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPosition)}addDimension(t){this._addDimension(t)}_addDimension(t=[]){t.forEach(e=>{const{key:n}=e;this.dimensionUpdaters[n]=this.getDimensionUpdaters(e),this.state.dimensions[n]={getValue:null,domain:null,sortedBins:null,scaleFunc:RG}})}getDimensionUpdaters({key:t,accessor:e,pickingInfo:n,getBins:r,getDomain:l,getScaleFunc:m,nullValue:C}){return{key:t,accessor:e,pickingInfo:n,getBins:{updater:this.getDimensionSortedBins,...r},getDomain:{updater:this.getDimensionValueDomain,...l},getScaleFunc:{updater:this.getDimensionScale,...m},attributeAccessor:this.getSubLayerDimensionAttribute(t,C)}}needUpdateDimensionStep(t,e,n,r){return Object.values(t.triggers).some(l=>l.updateTrigger?r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged[l.updateTrigger]):e[l.prop]!==n[l.prop])}getDimensionChanges(t,e,n){const r=[];for(const l in this.dimensionUpdaters){const m=PG.find(C=>this.needUpdateDimensionStep(this.dimensionUpdaters[l][C],t,e,n));m&&r.push(this.dimensionUpdaters[l][m].updater.bind(this,e,this.dimensionUpdaters[l]))}return r.length?r:null}getUpdateTriggers(t){const e=t.updateTriggers||{},n={};for(const r in this.dimensionUpdaters){const{accessor:l}=this.dimensionUpdaters[r];n[l]={},PG.forEach(m=>{Object.values(this.dimensionUpdaters[r][m].triggers).forEach(({prop:C,updateTrigger:A})=>{if(A){const O=e[A];"object"!=typeof O||Array.isArray(O)?void 0!==O&&(n[l][C]=O):Object.assign(n[l],O)}else n[l][C]=t[C]})})}return n}getSortedBins(t){for(const e in this.dimensionUpdaters)this.getDimensionSortedBins(t,this.dimensionUpdaters[e])}getDimensionSortedBins(t,e){const{key:n}=e,{getValue:r}=this.state.dimensions[n],l=new DG(this.state.layerData.data||[],{getValue:r,filterData:t._filterData});this.setDimensionState(n,{sortedBins:l}),this.getDimensionValueDomain(t,e)}getDimensionValueDomain(t,e){const{getDomain:n,key:r}=e,{triggers:{lowerPercentile:l,upperPercentile:m,scaleType:C}}=n,A=this.state.dimensions[r].sortedBins.getValueDomainByScale(t[C.prop],[t[l.prop],t[m.prop]]);this.setDimensionState(r,{valueDomain:A}),this.getDimensionScale(t,e)}getDimensionScale(t,e){const{key:n,getScaleFunc:r,getDomain:l}=e,{domain:m,range:C}=r.triggers,{scaleType:A}=l.triggers,{onSet:O}=r,z=t[C.prop],$=t[m.prop]||this.state.dimensions[n].valueDomain,te=function Rte(i){switch(i){case"quantize":default:return bG;case"linear":return xte;case"quantile":return wte;case"ordinal":return Mte}}(A&&t[A.prop])($,z);"object"==typeof O&&"function"==typeof t[O.props]&&t[O.props](te.domain()),this.setDimensionState(n,{scaleFunc:te})}getSubLayerDimensionAttribute(t,e){return n=>{const{sortedBins:r,scaleFunc:l}=this.state.dimensions[t],m=r.binMap[n.index];if(m&&0===m.counts)return e;const C=m&&m.value,A=l.domain();return C>=A[0]&&C<=A[A.length-1]?l(C):e}}getSubLayerAccessors(t){const e={};for(const n in this.dimensionUpdaters){const{accessor:r}=this.dimensionUpdaters[n];e[r]=this.getSubLayerDimensionAttribute(t,n)}return e}getPickingInfo({info:t}){let n=null;if(t.picked&&t.index>-1){const r=this.state.layerData.data[t.index],l={};for(const m in this.dimensionUpdaters){const{pickingInfo:C}=this.dimensionUpdaters[m],{sortedBins:A}=this.state.dimensions[m];l[C]=A.binMap[r.index]&&A.binMap[r.index].value}n=Object.assign(l,r,{points:r.filteredPoints||r.points})}return t.picked=!!n,t.object=n,t}getAccessor(t){return this.dimensionUpdaters.hasOwnProperty(t)?this.dimensionUpdaters[t].attributeAccessor:RG}}function FG(){}const Hte={colorDomain:null,colorRange:bS,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:FG,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:FG,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function vte(i,t){const{data:e,radius:n}=i,{viewport:r,attributes:l}=t,m=e.length?function bte(i,t){const{attributes:e}=t,n=e.positions.value,{size:r}=e.positions.getAccessor();let O,l=1/0,m=1/0,C=-1/0,A=-1/0;for(O=0;O<r*i.length;O+=r){const z=n[O],$=n[O+1];Number.isFinite(z)&&Number.isFinite($)&&(l=Math.min(z,l),C=Math.max(z,C),m=Math.min($,m),A=Math.max($,A))}return[l,m,C,A].every(Number.isFinite)?[(l+C)/2,(m+A)/2]:null}(e,t):null,C=function yte(i,t,e){const{unitsPerMeter:n}=t.getDistanceScales(e);return i*n[0]}(n,r,m),A=[],{iterable:O,objectInfo:z}=FP(e),$=l.positions.value,{size:Q}=l.positions.getAccessor();for(const fe of O){z.index++;const ge=z.index*Q,Re=[$[ge],$[ge+1]];Number.isFinite(Re[0])&&Number.isFinite(Re[1])?A.push({screenCoord:r.projectFlat(Re),source:fe,index:z.index}):so.warn("HexagonLayer: invalid position")()}return{hexagons:_te().radius(C).x(fe=>fe.screenCoord[0]).y(fe=>fe.screenCoord[1])(A).map((fe,ge)=>({position:r.unprojectFlat([fe.x,fe.y]),points:fe,index:ge})),radiusCommon:C}},getPosition:{type:"accessor",value:i=>i.position},material:!0,_filterData:{type:"function",value:null,optional:!0}};class eV extends yk{constructor(...t){super(...t),ye(this,"state",void 0)}initializeState(){const t=new LG({getAggregator:n=>n.hexagonAggregator,getCellSize:n=>n.radius});this.state={cpuAggregator:t,aggregatorState:t.state,vertices:null},this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}updateState(t){if(super.updateState(t),t.changeFlags.propsOrDataChanged){const e=this.state.cpuAggregator.updateState(t,{viewport:this.context.viewport,attributes:this.getAttributes()});if(this.state.aggregatorState.layerData!==e.layerData){const{hexagonVertices:n}=e.layerData||{};this.setState({vertices:n&&this.convertLatLngToMeterOffset(n)})}this.setState({aggregatorState:e})}}convertLatLngToMeterOffset(t){const{viewport:e}=this.context;if(Array.isArray(t)&&6===t.length){const n=t[0],r=t[3],l=[(n[0]+r[0])/2,(n[1]+r[1])/2],m=e.projectFlat(l),{metersPerUnit:C}=e.getDistanceScales(l);return t.map(O=>{const z=e.projectFlat(O);return[(z[0]-m[0])*C[0],(z[1]-m[1])*C[1]]})}return so.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}getPickingInfo({info:t}){return this.state.cpuAggregator.getPickingInfo({info:t})}_onGetSublayerColor(t){return this.state.cpuAggregator.getAccessor("fillColor")(t)}_onGetSublayerElevation(t){return this.state.cpuAggregator.getAccessor("elevation")(t)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:t,extruded:e,coverage:n,material:r,transitions:l}=this.props,{aggregatorState:m,vertices:C}=this.state,A=this.getSubLayerClass("hexagon-cell",$P),O=this._getSublayerUpdateTriggers();return new A({...C?{vertices:C,radius:1}:{radius:m.layerData.radiusCommon||1,radiusUnits:"common",angle:90},diskResolution:6,elevationScale:t,extruded:e,coverage:n,material:r,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:l&&{getFillColor:l.getColorValue||l.getColorWeight,getElevation:l.getElevationValue||l.getElevationWeight}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:O}),{data:m.layerData.data})}}function tV(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=Math.fround(i),r=i-n;return t[e]=n,t[e+1]=r,t}ye(eV,"layerName","HexagonLayer"),ye(eV,"defaultProps",Hte);const Xte={ONE:1},XP={name:"fp64-arithmetic",vs:"uniform float ONE;\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",fs:null,getUniforms:function qte(){return Xte},fp64ify:tV,fp64LowPart:function NG(i){return i-Math.fround(i)},fp64ifyMatrix4:function BG(i){const t=new Float32Array(32);for(let e=0;e<4;++e)for(let n=0;n<4;++n)tV(i[4*n+e],t,2*(4*e+n));return t}},Yte={projectPoints:!1,viewport:null,createBufferObjects:!0,moduleSettings:{}},J1=3402823466e29,VG=[32775,32774],zG=[32776,32774],Zte=[32776,32775],UG={[Dc.SUM]:32774,[Dc.MEAN]:32774,[Dc.MIN]:VG,[Dc.MAX]:zG},Kte={size:1,operation:Dc.SUM,needMin:!1,needMax:!1,combineMaxMin:!1},rie={10240:9728,10241:9728};function qP(i,t={}){const{width:e=1,height:n=1,data:r=null,unpackFlipY:l=!0,parameters:m=rie}=t;return new vu(i,{data:r,format:go(i)?34836:6408,type:5126,border:0,mipmaps:!1,parameters:m,dataFormat:6408,width:e,height:n,unpackFlipY:l})}function YP(i,t){const{id:e,width:n=1,height:r=1,texture:l}=t;return new zl(i,{id:e,width:n,height:r,attachments:{36064:l}})}const oie=["aggregationBuffer","maxMinBuffer","minBuffer","maxBuffer"],jG={maxData:"maxBuffer",minData:"minBuffer",maxMinData:"maxMinBuffer"},sie=["WEBGL2","COLOR_ATTACHMENT_RGBA32F","BLEND_EQUATION_MINMAX","FLOAT_BLEND","TEXTURE_FLOAT"];class eC{static getAggregationData({aggregationData:t,maxData:e,minData:n,maxMinData:r,pixelIndex:l}){const m=4*l,C={};return t&&(C.cellCount=t[m+3],C.cellWeight=t[m]),r?(C.maxCellWieght=r[0],C.minCellWeight=r[3]):(e&&(C.maxCellWieght=e[0],C.totalCount=e[3]),n&&(C.minCellWeight=n[0],C.totalCount=e[3])),C}static getCellData({countsData:t,size:e=1}){const n=t.length/4,r=new Float32Array(n*e),l=new Uint32Array(n);for(let m=0;m<n;m++){for(let C=0;C<e;C++)r[m*e+C]=t[4*m+C];l[m]=t[4*m+3]}return{cellCounts:l,cellWeights:r}}static isSupported(t){return q1(t,sie)}constructor(t,e={}){this.id=e.id||"gpu-grid-aggregator",this.gl=t,this.state={weightAttributes:{},textures:{},meanTextures:{},buffers:{},framebuffers:{},maxMinFramebuffers:{},minFramebuffers:{},maxFramebuffers:{},equations:{},resources:{},results:{}},this._hasGPUSupport=go(t)&&q1(this.gl,"BLEND_EQUATION_MINMAX"),this._hasGPUSupport&&this._setupModels()}delete(){const{gridAggregationModel:t,allAggregationModel:e,meanTransform:n}=this,{textures:r,framebuffers:l,maxMinFramebuffers:m,minFramebuffers:C,maxFramebuffers:A,meanTextures:O,resources:z}=this.state;t?.delete(),e?.delete(),n?.delete(),function lie(i){(i=Array.isArray(i)?i:[i]).forEach(t=>{for(const e in t)t[e].delete()})}([l,r,m,C,A,O,z])}run(t={}){this.setState({results:{}});const e=this._normalizeAggregationParams(t);return this._hasGPUSupport||so.log(1,"GPUGridAggregator: not supported")(),this._runAggregation(e)}getData(t){const e={},n=this.state.results;n[t].aggregationData||(n[t].aggregationData=n[t].aggregationBuffer.getData()),e.aggregationData=n[t].aggregationData;for(const r in jG){const l=jG[r];(n[t][r]||n[t][l])&&(n[t][r]=n[t][r]||n[t][l].getData(),e[r]=n[t][r])}return e}updateShaders(t={}){this.setState({shaderOptions:t,modelDirty:!0})}_normalizeAggregationParams(t){const e={...Yte,...t},{weights:n}=e;return n&&(e.weights=function aie(i){const t={};for(const e in i)t[e]={...Kte,...i[e]};return t}(n)),e}setState(t){Object.assign(this.state,t)}_getAggregateData(t){const e={},{textures:n,framebuffers:r,maxMinFramebuffers:l,minFramebuffers:m,maxFramebuffers:C,resources:A}=this.state,{weights:O}=t;for(const z in O){e[z]={};const{needMin:$,needMax:Q,combineMaxMin:te}=O[z];e[z].aggregationTexture=n[z],e[z].aggregationBuffer=EP(r[z],{target:O[z].aggregationBuffer,sourceType:5126}),$&&Q&&te?(e[z].maxMinBuffer=EP(l[z],{target:O[z].maxMinBuffer,sourceType:5126}),e[z].maxMinTexture=A["".concat(z,"-maxMinTexture")]):($&&(e[z].minBuffer=EP(m[z],{target:O[z].minBuffer,sourceType:5126}),e[z].minTexture=A["".concat(z,"-minTexture")]),Q&&(e[z].maxBuffer=EP(C[z],{target:O[z].maxBuffer,sourceType:5126}),e[z].maxTexture=A["".concat(z,"-maxTexture")]))}return this._trackGPUResultBuffers(e,O),e}_renderAggregateData(t){const{cellSize:e,projectPoints:n,attributes:r,moduleSettings:l,numCol:m,numRow:C,weights:A,translation:O,scaling:z}=t,{maxMinFramebuffers:$,minFramebuffers:Q,maxFramebuffers:te}=this.state,de=[m,C],fe={blend:!0,depthTest:!1,blendFunc:[1,1]},ge={cellSize:e,gridSize:de,projectPoints:n,translation:O,scaling:z};for(const Re in A){const{needMin:qe,needMax:et}=A[Re],yt=qe&&et&&A[Re].combineMaxMin;this._renderToWeightsTexture({id:Re,parameters:fe,moduleSettings:l,uniforms:ge,gridSize:de,attributes:r,weights:A}),yt?this._renderToMaxMinTexture({id:Re,parameters:{...fe,blendEquation:Zte},gridSize:de,minOrMaxFb:$[Re],clearParams:{clearColor:[0,0,0,J1]},combineMaxMin:yt}):(qe&&this._renderToMaxMinTexture({id:Re,parameters:{...fe,blendEquation:VG},gridSize:de,minOrMaxFb:Q[Re],clearParams:{clearColor:[J1,J1,J1,0]},combineMaxMin:yt}),et&&this._renderToMaxMinTexture({id:Re,parameters:{...fe,blendEquation:zG},gridSize:de,minOrMaxFb:te[Re],clearParams:{clearColor:[0,0,0,0]},combineMaxMin:yt}))}}_renderToMaxMinTexture(t){const{id:e,parameters:n,gridSize:r,minOrMaxFb:l,combineMaxMin:m,clearParams:C={}}=t,{framebuffers:A}=this.state,{gl:O,allAggregationModel:z}=this;Nl(O,{...C,framebuffer:l,viewport:[0,0,r[0],r[1]]},()=>{O.clear(16384),z.draw({parameters:n,uniforms:{uSampler:A[e].texture,gridSize:r,combineMaxMin:m}})})}_renderToWeightsTexture(t){const{id:e,parameters:n,moduleSettings:r,uniforms:l,gridSize:m,weights:C}=t,{framebuffers:A,equations:O,weightAttributes:z}=this.state,{gl:$,gridAggregationModel:Q}=this,{operation:te}=C[e];if(Nl($,{framebuffer:A[e],viewport:[0,0,m[0],m[1]],clearColor:te===Dc.MIN?[J1,J1,J1,0]:[0,0,0,0]},()=>{$.clear(16384),Q.draw({parameters:{...n,blendEquation:O[e]},moduleSettings:r,uniforms:l,attributes:{weights:z[e]}})}),te===Dc.MEAN){const{meanTextures:fe,textures:ge}=this.state,Re={_sourceTextures:{aggregationValues:fe[e]},_targetTexture:ge[e],elementCount:ge[e].width*ge[e].height};this.meanTransform?this.meanTransform.update(Re):this.meanTransform=function uie(i,t){return new vS(i,{vs:"#define SHADER_NAME gpu-aggregation-transform-mean-vs\nattribute vec4 aggregationValues;\nvarying vec4 meanValues;\n\nvoid main()\n{\n  bool isCellValid = bool(aggregationValues.w > 0.);\n  meanValues.xyz = isCellValid ? aggregationValues.xyz/aggregationValues.w : vec3(0, 0, 0);\n  meanValues.w = aggregationValues.w;\n  gl_PointSize = 1.0;\n}\n",_targetTextureVarying:"meanValues",...t})}($,Re),this.meanTransform.run({parameters:{blend:!1,depthTest:!1}}),A[e].attach({36064:ge[e]})}}_runAggregation(t){this._updateModels(t),this._setupFramebuffers(t),this._renderAggregateData(t);const e=this._getAggregateData(t);return this.setState({results:e}),e}_setupFramebuffers(t){const{textures:e,framebuffers:n,maxMinFramebuffers:r,minFramebuffers:l,maxFramebuffers:m,meanTextures:C,equations:A}=this.state,{weights:O}=t,{numCol:z,numRow:$}=t,Q={width:z,height:$};for(const te in O){const{needMin:de,needMax:fe,combineMaxMin:ge,operation:Re}=O[te];e[te]=O[te].aggregationTexture||e[te]||qP(this.gl,{id:"".concat(te,"-texture"),width:z,height:$}),e[te].resize(Q);let qe=e[te];Re===Dc.MEAN&&(C[te]=C[te]||qP(this.gl,{id:"".concat(te,"-mean-texture"),width:z,height:$}),C[te].resize(Q),qe=C[te]),n[te]?n[te].attach({36064:qe}):n[te]=YP(this.gl,{id:"".concat(te,"-fb"),width:z,height:$,texture:qe}),n[te].resize(Q),A[te]=UG[Re]||UG.SUM,(de||fe)&&(de&&fe&&ge?r[te]||(qe=O[te].maxMinTexture||this._getMinMaxTexture("".concat(te,"-maxMinTexture")),r[te]=YP(this.gl,{id:"".concat(te,"-maxMinFb"),texture:qe})):(de&&(l[te]||(qe=O[te].minTexture||this._getMinMaxTexture("".concat(te,"-minTexture")),l[te]=YP(this.gl,{id:"".concat(te,"-minFb"),texture:qe}))),fe&&(m[te]||(qe=O[te].maxTexture||this._getMinMaxTexture("".concat(te,"-maxTexture")),m[te]=YP(this.gl,{id:"".concat(te,"-maxFb"),texture:qe})))))}}_getMinMaxTexture(t){const{resources:e}=this.state;return e[t]||(e[t]=qP(this.gl,{id:"resourceName"})),e[t]}_setupModels({numCol:t=0,numRow:e=0}={}){var n;const{gl:r}=this,{shaderOptions:l}=this.state;null===(n=this.gridAggregationModel)||void 0===n||n.delete(),this.gridAggregationModel=function cie(i,t){const e=eG({vs:"#define SHADER_NAME gpu-aggregation-to-grid-vs\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute vec3 weights;\nuniform vec2 cellSize;\nuniform vec2 gridSize;\nuniform bool projectPoints;\nuniform vec2 translation;\nuniform vec3 scaling;\n\nvarying vec3 vWeights;\n\nvec2 project_to_pixel(vec4 pos) {\n  vec4 result;\n  pos.xy = pos.xy/pos.w;\n  result = pos + vec4(translation, 0., 0.);\n  result.xy = scaling.z > 0. ? result.xy * scaling.xy : result.xy;\n  return result.xy;\n}\n\nvoid main(void) {\n\n  vWeights = weights;\n\n  vec4 windowPos = vec4(positions, 1.);\n  if (projectPoints) {\n    windowPos = project_position_to_clipspace(positions, positions64Low, vec3(0));\n  }\n\n  vec2 pos = project_to_pixel(windowPos);\n\n  vec2 pixelXY64[2];\n  pixelXY64[0] = vec2(pos.x, 0.);\n  pixelXY64[1] = vec2(pos.y, 0.);\n  vec2 gridXY64[2];\n  gridXY64[0] = div_fp64(pixelXY64[0], vec2(cellSize.x, 0));\n  gridXY64[1] = div_fp64(pixelXY64[1], vec2(cellSize.y, 0));\n  float x = floor(gridXY64[0].x);\n  float y = floor(gridXY64[1].x);\n  pos = vec2(x, y);\n  pos = (pos * (2., 2.) / (gridSize)) - (1., 1.);\n  vec2 offset = 1.0 / gridSize;\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n  gl_PointSize = 1.0;\n}\n",fs:"#define SHADER_NAME gpu-aggregation-to-grid-fs\n\nprecision highp float;\n\nvarying vec3 vWeights;\n\nvoid main(void) {\n  gl_FragColor = vec4(vWeights, 1.0);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[XP,fx]},t);return new lg(i,{id:"Gird-Aggregation-Model",vertexCount:1,drawMode:0,...e})}(r,l),this.allAggregationModel||(this.allAggregationModel=function die(i,t){return new lg(i,{id:"All-Aggregation-Model",vs:"#version 300 es\n#define SHADER_NAME gpu-aggregation-all-vs-64\n\nin vec2 position;\nuniform ivec2 gridSize;\nout vec2 vTextureCoord;\n\nvoid main(void) {\n  vec2 pos = vec2(-1.0, -1.0);\n  vec2 offset = 1.0 / vec2(gridSize);\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n\n  int yIndex = gl_InstanceID / gridSize[0];\n  int xIndex = gl_InstanceID - (yIndex * gridSize[0]);\n\n  vec2 yIndexFP64 = vec2(float(yIndex), 0.);\n  vec2 xIndexFP64 = vec2(float(xIndex), 0.);\n  vec2 gridSizeYFP64 = vec2(gridSize[1], 0.);\n  vec2 gridSizeXFP64 = vec2(gridSize[0], 0.);\n\n  vec2 texCoordXFP64 = div_fp64(yIndexFP64, gridSizeYFP64);\n  vec2 texCoordYFP64 = div_fp64(xIndexFP64, gridSizeXFP64);\n\n  vTextureCoord = vec2(texCoordYFP64.x, texCoordXFP64.x);\n  gl_PointSize = 1.0;\n}\n",fs:"#version 300 es\n#define SHADER_NAME gpu-aggregation-all-fs\n\nprecision highp float;\n\nin vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform bool combineMaxMin;\nout vec4 fragColor;\nvoid main(void) {\n  vec4 textureColor = texture(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n  if (textureColor.a == 0.) {\n    discard;\n  }\n  fragColor.rgb = textureColor.rgb;\n  fragColor.a = combineMaxMin ? textureColor.r : textureColor.a;\n}\n",modules:[XP],vertexCount:1,drawMode:0,isInstanced:!0,instanceCount:t,attributes:{position:[0,0]}})}(r,t*e))}_setupWeightAttributes(t){const{weightAttributes:e}=this.state,{weights:n}=t;for(const r in n)e[r]=t.attributes[r]}_trackGPUResultBuffers(t,e){const{resources:n}=this.state;for(const r in t)if(t[r])for(const l of oie)if(t[r][l]&&e[r][l]!==t[r][l]){const m="gpu-result-".concat(r,"-").concat(l);n[m]&&n[m].delete(),n[m]=t[r][l]}}_updateModels(t){const{vertexCount:e,attributes:n,numCol:r,numRow:l}=t,{modelDirty:m}=this.state;m&&(this._setupModels(t),this.setState({modelDirty:!1})),this._setupWeightAttributes(t),this.gridAggregationModel.setVertexCount(e),this.gridAggregationModel.setAttributes(n),this.allAggregationModel.setInstanceCount(r*l)}}const hie=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),fie=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),mie=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),pie=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),gie={POSITION:{size:3,value:new Float32Array(fie)},NORMAL:{size:3,value:new Float32Array(mie)},TEXCOORD_0:{size:2,value:new Float32Array(pie)}};class GG extends mx{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=F_("cube-geometry")}=t;super({...t,id:e,indices:{size:1,value:new Uint16Array(hie)},attributes:{...gie,...t.attributes}})}}const bie={colorDomain:null,colorRange:bS,elevationDomain:null,elevationRange:[0,1e3],elevationScale:{type:"number",min:0,value:1},gridSize:{type:"array",value:[1,1]},gridOrigin:{type:"array",value:[0,0]},gridOffset:{type:"array",value:[0,0]},cellSize:{type:"number",min:0,max:1e3,value:1e3},offset:{type:"array",value:[1,1]},coverage:{type:"number",min:0,max:1,value:1},extruded:!0,material:!0};class rV extends cg{getShaders(){return super.getShaders({vs:"#version 300 es\n#define SHADER_NAME gpu-grid-cell-layer-vertex-shader\n#define RANGE_COUNT 6\n\nin vec3 positions;\nin vec3 normals;\n\nin vec4 colors;\nin vec4 elevations;\nin vec3 instancePickingColors;\nuniform vec2 offset;\nuniform bool extruded;\nuniform float cellSize;\nuniform float coverage;\nuniform float opacity;\nuniform float elevationScale;\n\nuniform ivec2 gridSize;\nuniform vec2 gridOrigin;\nuniform vec2 gridOriginLow;\nuniform vec2 gridOffset;\nuniform vec2 gridOffsetLow;\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 elevationRange;\nuniform vec2 colorDomain;\nuniform bool colorDomainValid;\nuniform vec2 elevationDomain;\nuniform bool elevationDomainValid;\n\nlayout(std140) uniform;\nuniform ColorData\n{\n  vec4 maxMinCount;\n} colorData;\nuniform ElevationData\n{\n  vec4 maxMinCount;\n} elevationData;\n\n#define EPSILON 0.00001\nout vec4 vColor;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= (domain.x - EPSILON) && value <= (domain.y + EPSILON)) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  return outColor;\n}\n\nfloat linearScale(vec2 domain, vec2 range, float value) {\n  if (value >= (domain.x - EPSILON) && value <= (domain.y + EPSILON)) {\n    return ((value - domain.x) / (domain.y - domain.x)) * (range.y - range.x) + range.x;\n  }\n  return -1.;\n}\n\nvoid main(void) {\n  vec2 clrDomain = colorDomainValid ? colorDomain : vec2(colorData.maxMinCount.a, colorData.maxMinCount.r);\n  vec4 color = quantizeScale(clrDomain, colorRange, colors.r);\n\n  float elevation = 0.0;\n\n  if (extruded) {\n    vec2 elvDomain = elevationDomainValid ? elevationDomain : vec2(elevationData.maxMinCount.a, elevationData.maxMinCount.r);\n    elevation = linearScale(elvDomain, elevationRange, elevations.r);\n    elevation = elevation  * (positions.z + 1.0) / 2.0 * elevationScale;\n  }\n  float shouldRender = float(color.r > 0.0 && elevations.r >= 0.0);\n  float dotRadius = cellSize / 2. * coverage * shouldRender;\n\n  int yIndex = (gl_InstanceID / gridSize[0]);\n  int xIndex = gl_InstanceID - (yIndex * gridSize[0]);\n\n  vec2 instancePositionXFP64 = mul_fp64(vec2(gridOffset[0], gridOffsetLow[0]), vec2(float(xIndex), 0.));\n  instancePositionXFP64 = sum_fp64(instancePositionXFP64, vec2(gridOrigin[0], gridOriginLow[0]));\n  vec2 instancePositionYFP64 = mul_fp64(vec2(gridOffset[1], gridOffsetLow[1]), vec2(float(yIndex), 0.));\n  instancePositionYFP64 = sum_fp64(instancePositionYFP64, vec2(gridOrigin[1], gridOriginLow[1]));\n\n  vec3 centroidPosition = vec3(instancePositionXFP64[0], instancePositionYFP64[0], elevation);\n  vec3 centroidPosition64Low = vec3(instancePositionXFP64[1], instancePositionYFP64[1], 0.0);\n  geometry.worldPosition = centroidPosition;\n  vec3 pos = vec3(project_size(positions.xy + offset) * dotRadius, 0.);\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n\n  vec3 normals_commonspace = project_normal(normals);\n\n   if (extruded) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, normals_commonspace);\n    vColor = vec4(lightColor, color.a * opacity) / 255.;\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity) / 255.;\n  }\n}\n",fs:"#version 300 es\n#define SHADER_NAME gpu-grid-cell-layer-fragment-shader\n\nprecision highp float;\n\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  fragColor = vColor;\n  fragColor = picking_filterColor(fragColor);\n}\n",modules:[fx,vG,Q1,XP]})}initializeState({gl:t}){this.getAttributeManager().addInstanced({colors:{size:4,noAlloc:!0},elevations:{size:4,noAlloc:!0}});const n=this._getModel(t);this._setupUniformBuffer(n),this.setState({model:n})}_getModel(t){return new lg(t,{...this.getShaders(),id:this.props.id,geometry:new GG,isInstanced:!0})}draw({uniforms:t}){const{cellSize:e,offset:n,extruded:r,elevationScale:l,coverage:m,gridSize:C,gridOrigin:A,gridOffset:O,elevationRange:z,colorMaxMinBuffer:$,elevationMaxMinBuffer:Q}=this.props,te=[j1(A[0]),j1(A[1])],de=[j1(O[0]),j1(O[1])],fe=this.getDomainUniforms(),ge=GP(this.props.colorRange);this.bindUniformBuffers($,Q),this.state.model.setUniforms(t).setUniforms(fe).setUniforms({cellSize:e,offset:n,extruded:r,elevationScale:l,coverage:m,gridSize:C,gridOrigin:A,gridOriginLow:te,gridOffset:O,gridOffsetLow:de,colorRange:ge,elevationRange:z}).draw(),this.unbindUniformBuffers($,Q)}bindUniformBuffers(t,e){t.bind({target:35345,index:0}),e.bind({target:35345,index:1})}unbindUniformBuffers(t,e){t.unbind({target:35345,index:0}),e.unbind({target:35345,index:1})}getDomainUniforms(){const{colorDomain:t,elevationDomain:e}=this.props,n={};return null!==t?(n.colorDomainValid=!0,n.colorDomain=t):n.colorDomainValid=!1,null!==e?(n.elevationDomainValid=!0,n.elevationDomain=e):n.elevationDomainValid=!1,n}_setupUniformBuffer(t){const e=this.context.gl,n=t.program.handle,r=e.getUniformBlockIndex(n,"ColorData"),l=e.getUniformBlockIndex(n,"ElevationData");e.uniformBlockBinding(n,r,0),e.uniformBlockBinding(n,l,1)}}ye(rV,"layerName","GPUGridCellLayer"),ye(rV,"defaultProps",bie);const HG=6378e3;function ZP(i){return Number.isFinite(i)?i:0}function $G(i,t){const e=i<0?-1:1;let n=e<0?Math.abs(i)+t:Math.abs(i);return n=Math.floor(n/t)*t,n*e}function WG(i,t,e=!0){if(!e)return{xOffset:t,yOffset:t};const{yMin:n,yMax:r}=i;return function Cie(i,t){const e=function Eie(i){return i/HG*(180/Math.PI)}(i),n=function Tie(i,t){return t/HG*(180/Math.PI)/Math.cos(i*Math.PI/180)}(t,i);return{yOffset:e,xOffset:n}}(t,(n+r)/2)}function oV(i,t){const e=function Sie(i,t){const{data:e=[],cellSize:n}=i,{attributes:r,viewport:l,projectPoints:m,numInstances:C}=t,A=r.positions.value,{size:O}=r.positions.getAccessor(),z=t.boundingBox||function Aie(i,t){const e=i.value,{size:n}=i.getAccessor();let A,O,r=1/0,l=-1/0,m=1/0,C=-1/0;for(let z=0;z<t;z++)O=e[z*n],A=e[z*n+1],Number.isFinite(O)&&Number.isFinite(A)&&(r=A<r?A:r,l=A>l?A:l,m=O<m?O:m,C=O>C?O:C);return{xMin:m,xMax:C,yMin:r,yMax:l}}(r.positions,C),$=t.posOffset||[180,90],Q=t.gridOffset||WG(z,n);if(Q.xOffset<=0||Q.yOffset<=0)return{gridHash:{},gridOffset:Q};const{width:te,height:de}=l,fe=Math.ceil(te/Q.xOffset),ge=Math.ceil(de/Q.yOffset),Re={},{iterable:qe,objectInfo:et}=FP(e),yt=new Array(3);for(const Jt of qe){et.index++,yt[0]=A[et.index*O],yt[1]=A[et.index*O+1],yt[2]=O>=3?A[et.index*O+2]:0;const[fi,Hi]=m?l.project(yt):yt;if(Number.isFinite(fi)&&Number.isFinite(Hi)){const tn=Math.floor((Hi+$[1])/Q.yOffset),cn=Math.floor((fi+$[0])/Q.xOffset);if(!m||cn>=0&&cn<fe&&tn>=0&&tn<ge){const _n="".concat(tn,"-").concat(cn);Re[_n]=Re[_n]||{count:0,points:[],lonIdx:cn,latIdx:tn},Re[_n].count+=1,Re[_n].points.push({source:Jt,index:et.index})}}}return{gridHash:Re,gridOffset:Q,offsets:[-1*$[0],-1*$[1]]}}(i,t),n=function Mie({gridHash:i,gridOffset:t,offsets:e}){const n=new Array(Object.keys(i).length);let r=0;for(const l in i){const m=l.split("-"),C=parseInt(m[0],10),A=parseInt(m[1],10),O=r++;n[O]={index:O,position:[e[0]+t.xOffset*A,e[1]+t.yOffset*C],...i[l]}}return n}(e);return{gridHash:e.gridHash,gridOffset:e.gridOffset,data:n}}class sV extends yk{constructor(...t){super(...t),ye(this,"state",void 0)}initializeAggregationLayer({dimensions:t}){const{gl:e}=this.context;super.initializeAggregationLayer(t),this.setState({layerData:{},gpuGridAggregator:new eC(e,{id:"".concat(this.id,"-gpu-aggregator")}),cpuGridAggregator:oV})}updateState(t){super.updateState(t),this.updateAggregationState(t);const{aggregationDataDirty:e,aggregationWeightsDirty:n,gpuAggregation:r}=this.state;if(this.getNumInstances()<=0)return;let l=!1;(e||r&&n)&&(this._updateAggregation(t),l=!0),!r&&(e||n)&&(this._updateWeightBins(),this._uploadAggregationResults(),l=!0),this.setState({aggregationDirty:l})}finalizeState(t){var e;const{count:n}=this.state.weights;n&&n.aggregationBuffer&&n.aggregationBuffer.delete(),null===(e=this.state.gpuGridAggregator)||void 0===e||e.delete(),super.finalizeState(t)}updateShaders(t){this.state.gpuAggregation&&this.state.gpuGridAggregator.updateShaders(t)}updateAggregationState(t){so.assert(!1)}allocateResources(t,e){if(this.state.numRow!==t||this.state.numCol!==e){const n=e*t*4*4,r=this.context.gl,{weights:l}=this.state;for(const m in l){const C=l[m];C.aggregationBuffer&&C.aggregationBuffer.delete(),C.aggregationBuffer=new is(r,{byteLength:n,accessor:{size:4,type:5126,divisor:1}})}}}updateResults({aggregationData:t,maxMinData:e,maxData:n,minData:r}){const{count:l}=this.state.weights;l&&(l.aggregationData=t,l.maxMinData=e,l.maxData=n,l.minData=r)}_updateAggregation(t){const{cpuGridAggregator:e,gpuGridAggregator:n,gridOffset:r,posOffset:l,translation:m=[0,0],scaling:C=[0,0,0],boundingBox:A,projectPoints:O,gpuAggregation:z,numCol:$,numRow:Q}=this.state,{props:te}=t,{viewport:de}=this.context,fe=this.getAttributes(),ge=this.getNumInstances();if(z){const{weights:Re}=this.state;n.run({weights:Re,cellSize:[r.xOffset,r.yOffset],numCol:$,numRow:Q,translation:m,scaling:C,vertexCount:ge,projectPoints:O,attributes:fe,moduleSettings:this.getModuleSettings()})}else{const Re=e(te,{gridOffset:r,projectPoints:O,attributes:fe,viewport:de,posOffset:l,boundingBox:A});this.setState({layerData:Re})}}_updateWeightBins(){const{getValue:t}=this.state,e=new DG(this.state.layerData.data||[],{getValue:t});this.setState({sortedBins:e})}_uploadAggregationResults(){const{numCol:t,numRow:e}=this.state,{data:n}=this.state.layerData,{aggregatedBins:r,minValue:l,maxValue:m,totalCount:C}=this.state.sortedBins,z=new Float32Array(t*e*4).fill(0);for(const de of r){const{lonIdx:fe,latIdx:ge}=n[de.i],{value:Re,counts:qe}=de,et=4*(fe+ge*t);z[et]=Re,z[et+4-1]=qe}const $=new Float32Array([m,0,0,l]),Q=new Float32Array([m,0,0,C]),te=new Float32Array([l,0,0,C]);this.updateResults({aggregationData:z,maxMinData:$,maxData:Q,minData:te})}}ye(sV,"layerName","GridAggregationLayer");const Die={colorDomain:null,colorRange:bS,getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",elevationDomain:null,elevationRange:[0,1e3],getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},cellSize:{type:"number",min:1,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:i=>i.position},extruded:!1,material:!0},kie={data:{props:["cellSize","colorAggregation","elevationAggregation"]}},XG="positions";class KP extends sV{initializeState({gl:t}){const e=eC.isSupported(t);e||so.error("GPUGridLayer is not supported on this browser, use GridLayer instead")(),super.initializeAggregationLayer({dimensions:kie}),this.setState({gpuAggregation:!0,projectPoints:!1,isSupported:e,weights:{color:{needMin:!0,needMax:!0,combineMaxMin:!0,maxMinBuffer:new is(t,{byteLength:16,accessor:{size:4,type:5126,divisor:1}})},elevation:{needMin:!0,needMax:!0,combineMaxMin:!0,maxMinBuffer:new is(t,{byteLength:16,accessor:{size:4,type:5126,divisor:1}})}},positionAttributeName:"positions"}),this.getAttributeManager().add({[XG]:{size:3,accessor:"getPosition",type:5130,fp64:this.use64bitPositions()},color:{size:3,accessor:"getColorWeight"},elevation:{size:3,accessor:"getElevationWeight"}})}updateState(t){if(!1===this.state.isSupported)return;super.updateState(t);const{aggregationDirty:e}=this.state;e&&this.setState({gridHash:null})}getHashKeyForIndex(t){const{numRow:e,numCol:n,boundingBox:r,gridOffset:l}=this.state,m=[n,e],C=[r.xMin,r.yMin],A=[l.xOffset,l.yOffset],O=Math.floor(t/m[0]),z=t-O*m[0],$=Math.floor((O*A[1]+C[1]+90+A[1]/2)/A[1]),Q=Math.floor((z*A[0]+C[0]+180+A[0]/2)/A[0]);return"".concat($,"-").concat(Q)}getPositionForIndex(t){const{numRow:e,numCol:n,boundingBox:r,gridOffset:l}=this.state,m=[n,e],C=[r.xMin,r.yMin],A=[l.xOffset,l.yOffset],O=Math.floor(t/m[0]);return[(t-O*m[0])*A[0]+C[0],O*A[1]+C[1]]}getPickingInfo({info:t,mode:e}){const{index:n}=t;let r=null;if(n>=0){const{gpuGridAggregator:l}=this.state,m=this.getPositionForIndex(n),C=eC.getAggregationData({pixelIndex:n,...l.getData("color")}),A=eC.getAggregationData({pixelIndex:n,...l.getData("elevation")});if(r={colorValue:C.cellWeight,elevationValue:A.cellWeight,count:C.cellCount||A.cellCount,position:m,totalCount:C.totalCount||A.totalCount},"hover"!==e){const{props:O}=this;let{gridHash:z}=this.state;if(!z){const{gridOffset:te,translation:de,boundingBox:fe}=this.state,{viewport:ge}=this.context;z=oV(O,{gridOffset:te,attributes:this.getAttributes(),viewport:ge,translation:de,boundingBox:fe}).gridHash,this.setState({gridHash:z})}const $=this.getHashKeyForIndex(n);Object.assign(r,z[$])}}return t.picked=!!r,t.object=r,t}renderLayers(){if(!this.state.isSupported)return null;const{elevationScale:t,extruded:e,cellSize:n,coverage:r,material:l,elevationRange:m,colorDomain:C,elevationDomain:A}=this.props,{weights:O,numRow:z,numCol:$,gridOrigin:Q,gridOffset:te}=this.state,{color:de,elevation:fe}=O,ge=GP(this.props.colorRange);return new(this.getSubLayerClass("gpu-grid-cell",rV))({gridSize:[$,z],gridOrigin:Q,gridOffset:[te.xOffset,te.yOffset],colorRange:ge,elevationRange:m,colorDomain:C,elevationDomain:A,cellSize:n,coverage:r,material:l,elevationScale:t,extruded:e},this.getSubLayerProps({id:"gpu-grid-cell"}),{data:{attributes:{colors:de.aggregationBuffer,elevations:fe.aggregationBuffer}},colorMaxMinBuffer:de.maxMinBuffer,elevationMaxMinBuffer:fe.maxMinBuffer,numInstances:$*z})}finalizeState(t){const{color:e,elevation:n}=this.state.weights;[e,n].forEach(r=>{const{aggregationBuffer:l,maxMinBuffer:m}=r;m.delete(),l?.delete()}),super.finalizeState(t)}updateAggregationState(t){const{props:e,oldProps:n}=t,{cellSize:r,coordinateSystem:l}=e,{viewport:m}=this.context,C=n.cellSize!==r,{dimensions:A}=this.state,O=this.isAttributeChanged(XG),z=O||this.isAttributeChanged();let{boundingBox:$}=this.state;if(O&&($=function yie(i,t){const e=i.positions.value;let C,A,n=1/0,r=-1/0,l=1/0,m=-1/0;for(let z=0;z<t;z++)A=e[3*z],C=e[3*z+1],n=C<n?C:n,r=C>r?C:r,l=A<l?A:l,m=A>m?A:m;return{xMin:ZP(l),xMax:ZP(m),yMin:ZP(n),yMax:ZP(r)}}(this.getAttributes(),this.getNumInstances()),this.setState({boundingBox:$})),O||C){const{gridOffset:te,translation:de,width:fe,height:ge,numCol:Re,numRow:qe}=function wie(i,t,e,n){const r=WG(i,t,n!==Ro.CARTESIAN),l=function xie(i,t,e,n){const{width:r,height:l}=n,m=e===Ro.CARTESIAN?[-r/2,-l/2]:[-180,-90];so.assert(e===Ro.CARTESIAN||e===Ro.LNGLAT||e===Ro.DEFAULT);const{xMin:C,yMin:A}=i;return[-1*($G(C-m[0],t.xOffset)+m[0]),-1*($G(A-m[1],t.yOffset)+m[1])]}(i,r,n,e),{xMin:m,yMin:C,xMax:A,yMax:O}=i,z=A-m+r.xOffset,$=O-C+r.yOffset;return{gridOffset:r,translation:l,width:z,height:$,numCol:Math.ceil(z/r.xOffset),numRow:Math.ceil($/r.yOffset)}}($,r,m,l);this.allocateResources(qe,Re),this.setState({gridOffset:te,translation:de,gridOrigin:[-1*de[0],-1*de[1]],width:fe,height:ge,numCol:Re,numRow:qe})}const Q=z||this.isAggregationDirty(t,{dimension:A.data,compareAll:!0});Q&&this._updateAccessors(t),this.setState({aggregationDataDirty:Q})}_updateAccessors(t){const{colorAggregation:e,elevationAggregation:n}=t.props,{color:r,elevation:l}=this.state.weights;r.operation=Dc[e],l.operation=Dc[n]}}ye(KP,"layerName","GPUGridLayer"),ye(KP,"defaultProps",Die);class aV extends $P{getGeometry(t){return new GG}draw({uniforms:t}){const{elevationScale:e,extruded:n,offset:r,coverage:l,cellSize:m,angle:C,radiusUnits:A}=this.props;this.state.model.setUniforms(t).setUniforms({radius:m/2,radiusUnits:L_[A],angle:C,offset:r,extruded:n,coverage:l,elevationScale:e,edgeDistance:1,isWireframe:!1}).draw()}}function qG(){}ye(aV,"layerName","GridCellLayer"),ye(aV,"defaultProps",{cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}});const Rie={colorDomain:null,colorRange:bS,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:qG,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:qG,gridAggregator:oV,cellSize:{type:"number",min:0,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:i=>i.position},extruded:!1,material:!0,_filterData:{type:"function",value:null,optional:!0}};class QP extends yk{initializeState(){const t=new LG({getAggregator:n=>n.gridAggregator,getCellSize:n=>n.cellSize});this.state={cpuAggregator:t,aggregatorState:t.state},this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}updateState(t){super.updateState(t),this.setState({aggregatorState:this.state.cpuAggregator.updateState(t,{viewport:this.context.viewport,attributes:this.getAttributes(),numInstances:this.getNumInstances()})})}getPickingInfo({info:t}){return this.state.cpuAggregator.getPickingInfo({info:t})}_onGetSublayerColor(t){return this.state.cpuAggregator.getAccessor("fillColor")(t)}_onGetSublayerElevation(t){return this.state.cpuAggregator.getAccessor("elevation")(t)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:t,extruded:e,cellSize:n,coverage:r,material:l,transitions:m}=this.props,{cpuAggregator:C}=this.state,A=this.getSubLayerClass("grid-cell",aV),O=this._getSublayerUpdateTriggers();return new A({cellSize:n,coverage:r,material:l,elevationScale:t,extruded:e,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:m&&{getFillColor:m.getColorValue||m.getColorWeight,getElevation:m.getElevationValue||m.getElevationWeight}},this.getSubLayerProps({id:"grid-cell",updateTriggers:O}),{data:C.state.layerData.data})}}ye(QP,"layerName","CPUGridLayer"),ye(QP,"defaultProps",Rie);const Pie={...KP.defaultProps,...QP.defaultProps,gpuAggregation:!1};class lV extends YB{constructor(...t){super(...t),ye(this,"state",void 0)}initializeState(){this.state={useGPUAggregation:!0}}updateState({props:t}){this.setState({useGPUAggregation:this.canUseGPUAggregation(t)})}renderLayers(){const{data:t,updateTriggers:e}=this.props,n=this.state.useGPUAggregation?"GPU":"CPU";return new(this.state.useGPUAggregation?this.getSubLayerClass("GPU",KP):this.getSubLayerClass("CPU",QP))(this.props,this.getSubLayerProps({id:n,updateTriggers:e}),{data:t})}canUseGPUAggregation(t){const{gpuAggregation:e,lowerPercentile:n,upperPercentile:r,getColorValue:l,getElevationValue:m,colorScaleType:C}=t;return!(!e||!eC.isSupported(this.context.gl)||0!==n||100!==r||null!==l||null!==m||"quantile"===C||"ordinal"===C)}}ye(lV,"layerName","GridLayer"),ye(lV,"defaultProps",Pie);const Fie=[0,0,0,0],Nie=[0,255,0,255],Bie=["minColor","maxColor","colorRange","colorDomain"],Vie={cellSizePixels:{value:100,min:1},cellMarginPixels:{value:2,min:0,max:5},colorDomain:null,colorRange:bS};class xk extends cg{constructor(...t){super(...t),ye(this,"state",void 0)}static isSupported(t){return q1(t,["TEXTURE_FLOAT"])}getShaders(){return{vs:"#define SHADER_NAME screen-grid-layer-vertex-shader\n#define RANGE_COUNT 6\n\nattribute vec3 positions;\nattribute vec3 instancePositions;\nattribute vec4 instanceCounts;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform vec3 cellScale;\nuniform vec4 minColor;\nuniform vec4 maxColor;\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 colorDomain;\nuniform bool shouldUseMinMax;\nuniform sampler2D maxTexture;\n\nvarying vec4 vColor;\nvarying float vSampleCount;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= domain.x && value <= domain.y) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  outColor = outColor / 255.;\n  return outColor;\n}\n\nvoid main(void) {\n  vSampleCount = instanceCounts.a;\n\n  float weight = instanceCounts.r;\n  float maxWeight = texture2D(maxTexture, vec2(0.5)).r;\n\n  float step = weight / maxWeight;\n  vec4 minMaxColor = mix(minColor, maxColor, step) / 255.;\n\n  vec2 domain = colorDomain;\n  float domainMaxValid = float(colorDomain.y != 0.);\n  domain.y = mix(maxWeight, colorDomain.y, domainMaxValid);\n  vec4 rangeColor = quantizeScale(domain, colorRange, weight);\n\n  float rangeMinMax = float(shouldUseMinMax);\n  vec4 color = mix(rangeColor, minMaxColor, rangeMinMax);\n  vColor = vec4(color.rgb, color.a * opacity);\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = vec4(instancePositions + positions * cellScale, 1.);\n}\n",fs:"#define SHADER_NAME screen-grid-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying float vSampleCount;\n\nvoid main(void) {\n  if (vSampleCount <= 0.0) {\n    discard;\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Q1]}}initializeState(){const{gl:t}=this.context;this.getAttributeManager().addInstanced({instancePositions:{size:3,update:this.calculateInstancePositions},instanceCounts:{size:4,noAlloc:!0}}),this.setState({model:this._getModel(t)})}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState(t){super.updateState(t);const{oldProps:e,props:n,changeFlags:r}=t,l=this.getAttributeManager();n.numInstances!==e.numInstances?l.invalidateAll():e.cellSizePixels!==n.cellSizePixels&&l.invalidate("instancePositions"),this._updateUniforms(e,n,r)}draw({uniforms:t}){const{parameters:e,maxTexture:n}=this.props,r=this.props.minColor||Fie,l=this.props.maxColor||Nie,m=this.props.colorDomain||[1,0],{model:C}=this.state;C.setUniforms(t).setUniforms({minColor:r,maxColor:l,maxTexture:n,colorDomain:m}).draw({parameters:{depthTest:!1,depthMask:!1,...e}})}calculateInstancePositions(t,{numInstances:e}){const{width:n,height:r}=this.context.viewport,{cellSizePixels:l}=this.props,m=Math.ceil(n/l),{value:C,size:A}=t;for(let O=0;O<e;O++){const z=O%m,$=Math.floor(O/m);C[O*A+0]=z*l/n*2-1,C[O*A+1]=1-$*l/r*2,C[O*A+2]=0}}_getModel(t){return new lg(t,{...this.getShaders(),id:this.props.id,geometry:new mx({drawMode:6,attributes:{positions:new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0])}}),isInstanced:!0})}_shouldUseMinMax(){const{minColor:t,maxColor:e,colorDomain:n,colorRange:r}=this.props;return t||e?(so.deprecated("ScreenGridLayer props: minColor and maxColor","colorRange, colorDomain")(),!0):!(n||r)}_updateUniforms(t,e,n){const{model:r}=this.state;if(Bie.some(l=>t[l]!==e[l])&&r.setUniforms({shouldUseMinMax:this._shouldUseMinMax()}),t.colorRange!==e.colorRange&&r.setUniforms({colorRange:GP(e.colorRange)}),t.cellMarginPixels!==e.cellMarginPixels||t.cellSizePixels!==e.cellSizePixels||n.viewportChanged){const{width:l,height:m}=this.context.viewport,{cellSizePixels:C,cellMarginPixels:A}=this.props,O=C>A?A:0,z=new Float32Array([(C-O)/l*2,-(C-O)/m*2,1]);r.setUniforms({cellScale:z})}}}ye(xk,"layerName","ScreenGridCellLayer"),ye(xk,"defaultProps",Vie);const zie={...xk.defaultProps,getPosition:{type:"accessor",value:i=>i.position},getWeight:{type:"accessor",value:1},gpuAggregation:!0,aggregation:"SUM"},YG="positions",Uie={data:{props:["cellSizePixels"]},weights:{props:["aggregation"],accessors:["getWeight"]}};class cV extends sV{constructor(...t){super(...t),ye(this,"state",void 0)}initializeState(){const{gl:t}=this.context;if(!xk.isSupported(t))return this.setState({supported:!1}),void so.error("ScreenGridLayer: ".concat(this.id," is not supported on this browser"))();super.initializeAggregationLayer({dimensions:Uie,getCellSize:r=>r.cellSizePixels});const e={count:{size:1,operation:Dc.SUM,needMax:!0,maxTexture:qP(t,{id:"".concat(this.id,"-max-texture")})}};this.setState({supported:!0,projectPoints:!0,weights:e,subLayerData:{attributes:{}},maxTexture:e.count.maxTexture,positionAttributeName:"positions",posOffset:[0,0],translation:[1,-1]}),this.getAttributeManager().add({[YG]:{size:3,accessor:"getPosition",type:5130,fp64:this.use64bitPositions()},count:{size:3,accessor:"getWeight"}})}shouldUpdateState({changeFlags:t}){return this.state.supported&&t.somethingChanged}updateState(t){super.updateState(t)}renderLayers(){if(!this.state.supported)return[];const{maxTexture:t,numRow:e,numCol:n,weights:r}=this.state,{updateTriggers:l}=this.props,{aggregationBuffer:m}=r.count;return new(this.getSubLayerClass("cells",xk))(this.props,this.getSubLayerProps({id:"cell-layer",updateTriggers:l}),{data:{attributes:{instanceCounts:m}},maxTexture:t,numInstances:e*n})}finalizeState(t){super.finalizeState(t);const{aggregationBuffer:e,maxBuffer:n,maxTexture:r}=this.state;e?.delete(),n?.delete(),r?.delete()}getPickingInfo({info:t}){const{index:e}=t;if(e>=0){const{gpuGridAggregator:n,gpuAggregation:r,weights:l}=this.state,m=r?n.getData("count"):l.count;t.object=eC.getAggregationData({pixelIndex:e,...m})}return t}updateResults({aggregationData:t,maxData:e}){const{count:n}=this.state.weights;n.aggregationData=t,n.aggregationBuffer.setData({data:t}),n.maxData=e,n.maxTexture.setImageData({data:e})}updateAggregationState(t){const e=t.props.cellSizePixels,n=t.oldProps.cellSizePixels!==e,{viewportChanged:r}=t.changeFlags;let l=t.props.gpuAggregation;this.state.gpuAggregation!==t.props.gpuAggregation&&l&&!eC.isSupported(this.context.gl)&&(so.warn("GPU Grid Aggregation not supported, falling back to CPU")(),l=!1);const m=l!==this.state.gpuAggregation;this.setState({gpuAggregation:l});const C=this.isAttributeChanged(YG),{dimensions:A}=this.state,{data:O,weights:z}=A,$=C||m||r||this.isAggregationDirty(t,{compareAll:l,dimension:O}),Q=this.isAggregationDirty(t,{dimension:z});this.setState({aggregationDataDirty:$,aggregationWeightsDirty:Q});const{viewport:te}=this.context;if(r||n){const{width:de,height:fe}=te,ge=Math.ceil(de/e),Re=Math.ceil(fe/e);this.allocateResources(Re,ge),this.setState({scaling:[de/2,-fe/2,1],gridOffset:{xOffset:e,yOffset:e},width:de,height:fe,numCol:ge,numRow:Re})}Q&&this._updateAccessors(t),($||Q)&&this._resetResults()}_updateAccessors(t){const{getWeight:e,aggregation:n,data:r}=t.props,{count:l}=this.state.weights;l&&(l.getWeight=e,l.operation=Dc[n]),this.setState({getValue:IG(n,e,{data:r})})}_resetResults(){const{count:t}=this.state.weights;t&&(t.aggregationData=null)}}ye(cV,"layerName","ScreenGridLayer"),ye(cV,"defaultProps",zie);const U__baseUrl="https://api.wildlife-tracker.com/";var mn=function(i){return i[i.ArcLayer=0]="ArcLayer",i[i.ContourLayer=1]="ContourLayer",i[i.GeoJsonLayer=2]="GeoJsonLayer",i[i.GPUGridLayer=3]="GPUGridLayer",i[i.GridLayer=4]="GridLayer",i[i.HeatmapLayer=5]="HeatmapLayer",i[i.HexagonLayer=6]="HexagonLayer",i[i.IconLayer=7]="IconLayer",i[i.LineLayer=8]="LineLayer",i[i.PointCloudLayer=9]="PointCloudLayer",i[i.PathLayer=10]="PathLayer",i[i.ScatterplotLayer=11]="ScatterplotLayer",i[i.ScenegraphLayer=12]="ScenegraphLayer",i[i.ScreenGridLayer=13]="ScreenGridLayer",i[i.TerrainLayer=14]="TerrainLayer",i[i.TextLayer=15]="TextLayer",i[i.TileLayer=16]="TileLayer",i[i.Tile3DLayer=17]="Tile3DLayer",i[i.TripsLayer=18]="TripsLayer",i[i.WMSLayer=19]="WMSLayer",i}(mn||{});class ZG{constructor(t,e){this.currentActiveOverlay=(0,o.vPA)("google"),this.colorRange=[[1,152,189],[73,227,206],[216,254,181],[254,237,177],[254,173,84],[209,55,78]],this.pathLayers=new Set([mn.ArcLayer,mn.PathLayer,mn.LineLayer,mn.GeoJsonLayer,mn.TripsLayer]),this.pointLayers=new Set([mn.ScatterplotLayer]),this.aggregationLayers=new Set([mn.HeatmapLayer,mn.HexagonLayer,mn.ScreenGridLayer]),this.textDecoder=new TextDecoder,this.textEncoder=new TextEncoder,this.cumulativeData=this.emptyBinaryLineStringResponse("AggregatedEvents"),this.dataChunks=[],this.currentLayers=[],this.contentArray=[],this.streamStatus=(0,o.vPA)("standby"),this.individualColors=new Map,this.currentIndividuals=(0,o.vPA)(new Set),this.currentLayer=mn.LineLayer,this.currentData=[],this.tooltipEnabled=!0,this.defaultBaseLayerOptions={autoHighlight:!1,transitions:{}},this.defaultPointOptions={radiusUnits:"meters",radiusScale:1,lineWidthUnits:"meters",autoHighlight:!0,radiusMinPixels:1,opacity:1},this.defaultPathOptions={widthUnits:"pixels",widthScale:1,getWidth:1,opacity:1},this.defaultAggregationOptions={radius:1e3,coverage:1,elevationRange:[0,1e3],elevationScale:1,upperPercentile:100,lowerPercentile:0,elevationUpperPercentile:100,elevationLowerPercentile:0,colorScaleType:"quantize",material:!0,colorAggregation:"SUM",elevationAggregation:"SUM",getElevationValue:null,getColorWeight:1,getColorValue:null,getElevationWeight:1,gpuAggregation:!0},this.MetadataDefaultOptions={layer:this.currentLayer,numberOfEvents:0,numberOfIndividuals:0,currentIndividuals:new Set,focusedIndividual:"",pathWidth:3,widthUnits:"pixel",textLayer:!1},this.currentMetaData=(0,o.vPA)({layer:this.currentLayer,numberOfEvents:0,numberOfIndividuals:0,currentIndividuals:new Set,focusedIndividual:"",pathWidth:3,widthUnits:"pixel",textLayer:!1}),this.map=t,this.currentLayer=e,typeof Worker<"u"?(this.webWorker=new Worker(It.tu(new URL(It.p+It.u(307),It.b))),this.webWorker.onmessage=n=>{switch(n.data.type){case"BinaryLineString":this.cumulativeData=this.mergeBinaryResponse(this.cumulativeData,n.data),this.handleBinaryResponse(n.data);break;case"StreamEnded":this.streamStatus.set("standby");break;case"StreamError":this.streamStatus.set("error");break;default:return}}):console.error("Web worker api not supported.")}get StreamStatus(){return this.streamStatus.asReadonly()}get NumberofIndividuals(){return(0,o.EWP)(()=>this.currentIndividuals().size)}get CurrentIndividuals(){return this.currentIndividuals.asReadonly()}releaseResources(){this.dataChunks=[],this.contentArray=[],this.currentLayers=[],this.cumulativeData=this.emptyBinaryLineStringResponse("AggregatedEvents"),this.individualColors.clear(),this.currentMetaData.set(structuredClone(this.MetadataDefaultOptions)),this.currentIndividuals.set(new Set),this.deckOverlay?.finalize(),console.log("Releasing all release in deckOvelayController.")}createOverlay(t){switch(t){case"google":case"arcgis":return new C6({getTooltip:e=>e.layer&&this.renderTooltip(e),_typedArrayManagerProps:{overAlloc:1,poolSize:0}});case"mapbox":return new wQ({interleaved:!1,getTooltip:e=>e.layer&&this.renderTooltip(e),_typedArrayManagerProps:{overAlloc:1,poolSize:0}})}}changeOverlayType(t){this.releaseResources(),t!==this.currentActiveOverlay()&&this.currentActiveOverlay.set(t)}setLayerAttributes(t){if("toggleTooltip"===t.field)return void this.setTooltip(t.change.value);switch(t.formType){case"point":this.defaultPointOptions[t.field]=t.change.value;break;case"path":this.defaultPathOptions[t.field]=t.change.value;break;case"aggregation":this.defaultAggregationOptions[t.field]=t.change.value}const e=this.currentLayers.map(n=>null!==n?this.setLayerAttributesHelper(t,n):n);this.deckOverlay?.setProps({layers:e}),this.currentLayers=e}setLayerAttributesHelper(t,e){return e.clone({[t.field]:t.change.value})}loadData(t,e){return this.releaseResources(),this.streamStatus.set("streaming"),this.currentActiveOverlay.set(e.type),"google"==e.type?(this.deckOverlay=this.createOverlay(this.currentActiveOverlay()),this.deckOverlay.setMap(e.map)):"mapbox"===e.type&&(this.deckOverlay=this.createOverlay(this.currentActiveOverlay()),e.map.addControl(this.deckOverlay)),void 0!==this.webWorker?this.webWorker.postMessage({data:{type:"FetchRequest",request:t},type:"FetchRequest"}):this.sendFetchRequest(t).then(r=>{if(null!==r)for(const l of r)null!==l&&(this.cumulativeData=this.mergeBinaryResponse(this.cumulativeData,l[0]),this.handleBinaryResponse(l[0]))}),this.deckOverlay}sendFetchRequest(t){return(0,Yt.A)(function*(){try{const r=(yield(yield fetch(U__baseUrl+"api/MoveBank/GetEventData",{method:"POST",headers:{Accept:"application/json, text/plain","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify({studyId:t.StudyId,localIdentifiers:t.LocalIdentifiers,sensorType:t.SensorType,geometryType:t.GeometryType,options:{eventProfiles:t.Options.EventProfile}})})).json()).map((l,m)=>(0,qB.gL)({features:l.features,individualLocalIdentifier:"N/A",count:l.features.length,index:m},"BinaryLineString"));return yield Promise.all(r)}catch(e){return console.error(e),null}})()}renderTooltip(t){const e=t.index;if(-1===e||!this.tooltipEnabled)return null;const n=this.getContentHelper(e,t);return void 0===n?null:{html:n}}getContentHelper(t,e){const n=Number(e.layer?.id.split("-").at(1)),r=Number(e.layer?.id.split("-").at(0));if(void 0===n)return;if(r===mn.ScatterplotLayer)return`\n        <h5>Coordinates</h5>\n        <p>Longitude: ${e.coordinate?.at(0)}</p>\n        <p>Latitude: ${e.coordinate?.at(1)}</p>\n      `;if(r===mn.HexagonLayer)return`\n        <p>Events: ${e.object.points.length}</p>\n      `;if(r===mn.ScreenGridLayer)return`\n        <p>Events: ${e.object.cellCount}</p>\n      `;const l=this.contentArray.at(n)?.at(t);return void 0===l?void 0:this.textDecoder.decode(new Uint8Array(l))}setTooltip(t){this.tooltipEnabled=t}changeActiveLayer(t){if(this.currentLayer===t||(this.currentLayer=t,0===this.dataChunks.length))return;let e=[];e=this.isAggregationLayer(t)?[this.createActiveLayer(t,this.processBinaryData(this.cumulativeData),0)]:this.dataChunks.map((n,r)=>this.createActiveLayer(t,n.lines,r)),this.currentLayers=e,this.deckOverlay?.setProps({layers:e})}isPointLayer(t){return this.pointLayers.has(t)}isPathLayer(t){return this.pathLayers.has(t)}isAggregationLayer(t){return this.aggregationLayers.has(t)}createActiveLayer(t,e,n){switch(this.currentLayer=t,t){case mn.ArcLayer:return this.createArcLayer(e,n);case mn.ScatterplotLayer:return this.createScatterplotLayer(e,n);case mn.HexagonLayer:return this.createHexagonLayer(e,n);case mn.LineLayer:return this.createLineLayer(e,n);case mn.ScreenGridLayer:return this.createScreenGridLayer(e,n);case mn.GridLayer:return this.createGridLayer(e,n);case mn.HeatmapLayer:return this.createHeatmapLayer(e,n);default:return null}}getCoordinateHelper(t){return`position: ${t.coordinate}`}mergeBinaryResponse(t,e){if(0===t.length)return e;const n=new Float32Array(t.position.value),r=new Float32Array(e.position.value),l={size:e.position.size,value:new Float32Array(n.length+r.length)};l.value.set(n),l.value.set(r,n.length);const m=new Uint16Array(t.pathIndices.value),C=new Uint16Array(e.pathIndices.value),A={size:e.pathIndices.size,value:new Uint16Array(m.length+C.length)};return A.value.set(m),A.value.set(C,m.length),{type:"AggregatedEvents",featureId:e.featureId,globalFeatureIds:e.globalFeatureIds,position:l,index:0,pathIndices:A,length:t.length+e.length,content:e.content,colors:e.colors,individualLocalIdentifier:"N/A",numericProps:e.numericProps}}processBinaryData(t){return{type:"LineString",featureIds:{size:t.featureId.size,value:new Uint16Array(t.featureId.value)},globalFeatureIds:{size:t.globalFeatureIds.size,value:new Uint16Array(t.globalFeatureIds.value)},positions:{size:t.position.size,value:new Float32Array(t.position.value)},pathIndices:{size:t.pathIndices.size,value:new Uint16Array(t.pathIndices.value)},length:t.length,content:t.content,colors:{size:t.colors.size,value:new Uint8Array(t.colors.value)},individualLocalIdentifier:t.individualLocalIdentifier,numericProps:this.numericPropsHelper(t.numericProps),properties:[]}}handleBinaryResponse(t){const e=this.processBinaryData(t),[n,r]=this.BinaryFeaturesPlaceholder();this.dataChunks.push({points:n,lines:e,polygons:r}),this.contentArray.push(e.content.contentArray),this.currentIndividuals.update(m=>(m.add(e.individualLocalIdentifier),m)),this.currentMetaData.update(m=>({numberOfEvents:m.numberOfEvents+e.length,numberOfIndividuals:this.currentIndividuals().size,currentIndividuals:this.currentIndividuals(),layer:this.currentLayer,pathWidth:m.pathWidth,widthUnits:m.widthUnits,textLayer:m.textLayer}));let l=[];l=this.isAggregationLayer(this.currentLayer)?[this.createActiveLayer(this.currentLayer,this.processBinaryData(this.cumulativeData),0)]:this.dataChunks.map((m,C)=>this.createActiveLayer(this.currentLayer,m.lines,C)),this.currentLayers=l,this.deckOverlay?.setProps({layers:l})}setAppropriateLayers(){}numericPropsHelper(t){return{sourceTimestamp:{size:t.sourceTimestamp.size,value:new Float64Array(t.sourceTimestamp.value)},destinationTimestamp:{size:t.destinationTimestamp.size,value:new Float64Array(t.destinationTimestamp.value)},distanceKm:{size:t.distanceKm.size,value:new Float64Array(t.distanceKm.value)},distanceTravelledKm:{size:t.distanceTravelledKm.size,value:new Float64Array(t.distanceTravelledKm.value)}}}BinaryFeaturesPlaceholder(){return[{type:"Point",featureIds:{size:1,value:new Uint16Array},globalFeatureIds:{size:1,value:new Uint16Array},positions:{size:2,value:new Float32Array},numericProps:{},properties:[]},{type:"Polygon",featureIds:{size:1,value:new Uint16Array},globalFeatureIds:{size:1,value:new Uint16Array},positions:{size:2,value:new Float32Array},polygonIndices:{size:1,value:new Uint16Array},primitivePolygonIndices:{size:1,value:new Uint16Array},numericProps:{},properties:[]}]}createAllLayers(t,e){return[this.createArcLayer(t,e),this.createLineLayer(t,e),this.createScatterplotLayer(t,e)]}setOptionsHelper(t,e){let n=Object.entries(this.defaultPathOptions);n=Object.entries("point"===e?this.defaultPointOptions:"path"===e?this.defaultPathOptions:this.defaultAggregationOptions),n.forEach(([r,l])=>{t[r]=l})}createArcLayer(t,e){const r=t.positions,l=r.size,m=2*l*4,C=this.getColorHelper(t.individualLocalIdentifier),A={id:`${mn.ArcLayer}-${e}`,data:{length:t.length,attributes:{getSourcePosition:{value:new Float32Array(r.value),size:l,stride:m,offset:0},getTargetPosition:{value:new Float32Array(r.value),size:l,stride:m,offset:m/2},individualLocalIdentifier:this.textEncoder.encode(t.individualLocalIdentifier)}},getSourceColor:C[0],getTargetColor:C[1],autoHighlight:!0,colorFormat:"RGBA",pickable:this.currentLayer===mn.ArcLayer,visible:this.currentLayer===mn.ArcLayer,updateTriggers:{visible:this.currentLayer,pickable:this.currentLayer}};return this.setOptionsHelper(A,"path"),new jB(A)}createPathLayer(t,e){const m=2*t.positions.size*4,C=[0];for(let O=0;O<t.length-1;O++)C.push(C[C.length+1]+t.positions.size);const A={id:`${mn.PathLayer}-${e}`,data:{length:t.length,attributes:{getPath:{value:new Float32Array(t.positions.value),size:t.positions.size,stride:m,offset:0},startIndices:new Uint16Array(C),getColor:{value:new Float32Array(t.colors.value),size:t.colors.size,stride:4*t.colors.size}},individualLocalIdentifier:this.textEncoder.encode(t.individualLocalIdentifier)},pickable:this.currentLayer===mn.PathLayer,visible:this.currentLayer===mn.PathLayer,positionFormat:"XY",_pathType:"open",updateTriggers:{visible:this.currentLayer,pickable:this.currentLayer}};return this.setOptionsHelper(A,"path"),new $B}createScatterplotLayer(t,e){const r=t.positions,l=r.size,m=2*l*4,C={id:`${mn.ScatterplotLayer}-${e}`,data:{length:t.length,attributes:{getPosition:{value:new Float32Array(r.value),size:l,stride:m,offset:0},individualLocalIdentifier:this.textEncoder.encode(t.individualLocalIdentifier)}},radiusScale:30,getRadius:4,opacity:.8,radiusMinPixels:1,getFillColor:[255,0,30],autoHighlight:!0,pickable:this.currentLayer===mn.ScatterplotLayer,visible:this.currentLayer===mn.ScatterplotLayer,updateTriggers:{visible:this.currentLayer,pickable:this.currentLayer}};return this.setOptionsHelper(C,"point"),new WB(C)}createHeatmapLayer(t,e){const r=t.positions,l=r.size,m=2*l*4,C={id:`${mn.HeatmapLayer}-${e}`,data:{length:t.length,attributes:{getPosition:{value:new Float32Array(r.value),size:l,stride:m,offset:0},individualLocalIdentifier:this.textEncoder.encode(t.individualLocalIdentifier)}},pickable:!1,aggregation:"SUM",radiusPixels:30,intensity:1,threshold:.3,visible:this.currentLayer===mn.HeatmapLayer,getWeight:1,updateTriggers:{visible:this.currentLayer,pickable:this.currentLayer}};return new KB(C)}createHexagonLayer(t,e){const r=t.positions,l=r.size,m=2*l*4,C={id:`${mn.HexagonLayer}-${e}`,data:{length:t.length,attributes:{getPosition:{value:new Float32Array(r.value),size:l,stride:m,offset:0},individualLocalIdentifier:this.textEncoder.encode(t.individualLocalIdentifier)}},elevationRange:[0,3e3],radius:1e3,pickable:this.currentLayer===mn.HexagonLayer,visible:this.currentLayer===mn.HexagonLayer,autoHighlight:!0,extruded:!0,updateTriggers:{visible:this.currentLayer,pickable:this.currentLayer}};return this.setOptionsHelper(C,"aggregation"),new eV(C)}createGridLayer(t,e){const r=t.positions,l=r.size,m=2*l*4,C={id:`${mn.GridLayer}-${e}`,data:{length:t.length,attributes:{getPosition:{value:new Float32Array(r.value),size:l,stride:m,offset:0}},individualLocalIdentifier:this.textEncoder.encode(t.individualLocalIdentifier)},pickable:this.currentLayer===mn.GridLayer,visible:this.currentLayer===mn.GridLayer,updateTriggers:{visible:this.currentLayer,pickable:this.currentLayer}};return this.setOptionsHelper(C,"aggregation"),new lV(C)}createScreenGridLayer(t,e){const r=t.positions,l=r.size,m=2*l*4,C={id:`${mn.ScreenGridLayer}-${e}`,data:{length:t.length,attributes:{getPosition:{value:new Float32Array(r.value),size:l,stride:m,offset:0}},individualLocalIdentifier:this.textEncoder.encode(t.individualLocalIdentifier)},pickable:this.currentLayer===mn.ScreenGridLayer,visible:this.currentLayer===mn.ScreenGridLayer,cellSizePixels:20,opacity:.8,updateTriggers:{visible:this.currentLayer,pickable:this.currentLayer}};return this.setOptionsHelper(C,"aggregation"),new cV(C)}createLineLayer(t,e){const r=t.positions,l=r.size,m=2*l*4,C=this.getColorHelper(t.individualLocalIdentifier),A={id:`${mn.LineLayer}-${e}`,data:{length:t.length,attributes:{getSourcePosition:{value:new Float32Array(r.value),size:l,stride:m,offset:0},getTargetPosition:{value:new Float32Array(r.value),size:l,stride:m,offset:m/2},individualLocalIdentifier:this.textEncoder.encode(t.individualLocalIdentifier)}},colorFormat:"RGBA",pickable:this.currentLayer===mn.LineLayer,visible:this.currentLayer===mn.LineLayer,getColor:C[0],autoHighlight:!0,updateTriggers:{visible:this.currentLayer,pickable:this.currentLayer}};return this.setOptionsHelper(A,"path"),new XB(A)}getColorHelper(t){const e=this.individualColors.get(t);if(void 0!==e)return e;const n=[(0,qB.XL)(),(0,qB.XL)()];return this.individualColors.set(t,n),n}emptyBinaryLineStringResponse(t){return{type:t,index:0,length:0,individualLocalIdentifier:"none",featureId:{size:3,value:new Uint8Array},globalFeatureIds:{size:3,value:new Uint16Array},pathIndices:{size:3,value:new Int8Array},numericProps:{distanceTravelledKm:{size:3,value:new Float64Array},sourceTimestamp:{size:3,value:new Float64Array},destinationTimestamp:{size:3,value:new Float64Array},distanceKm:{size:3,value:new Float64Array}},position:{size:3,value:new Float32Array},colors:{size:3,value:new Uint8Array},content:{contentArray:[]}}}}const jie=["determinateSpinner"];function Gie(i,t){if(1&i&&(o.qSk(),o.j41(0,"svg",11),o.nrm(1,"circle",12),o.k0s()),2&i){const e=o.XpG();o.BMQ("viewBox",e._viewBox()),o.R7$(),o.xc7("stroke-dasharray",e._strokeCircumference(),"px")("stroke-dashoffset",e._strokeCircumference()/2,"px")("stroke-width",e._circleStrokeWidth(),"%"),o.BMQ("r",e._circleRadius())}}const Hie=new o.nKC("mat-progress-spinner-default-options",{providedIn:"root",factory:function $ie(){return{diameter:KG}}}),KG=100;let dV=(()=>{class i{get color(){return this._color||this._defaultColor}set color(e){this._color=e}constructor(e,n,r){this._elementRef=e,this._defaultColor="primary",this._value=0,this._diameter=KG,this._noopAnimations="NoopAnimations"===n&&!!r&&!r._forceAnimations,this.mode="mat-spinner"===e.nativeElement.nodeName.toLowerCase()?"indeterminate":"determinate",r&&(r.color&&(this.color=this._defaultColor=r.color),r.diameter&&(this.diameter=r.diameter),r.strokeWidth&&(this.strokeWidth=r.strokeWidth))}get value(){return"determinate"===this.mode?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,e||0))}get diameter(){return this._diameter}set diameter(e){this._diameter=e||0}get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(e){this._strokeWidth=e||0}_circleRadius(){return(this.diameter-10)/2}_viewBox(){const e=2*this._circleRadius()+this.strokeWidth;return`0 0 ${e} ${e}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.bc$,8),o.rXU(Hie))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(n,r){if(1&n&&o.GBs(jie,5),2&n){let l;o.mGM(l=o.lsd())&&(r._determinateCircle=l.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(n,r){2&n&&(o.BMQ("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow","determinate"===r.mode?r.value:null)("mode",r.mode),o.HbH("mat-"+r.color),o.xc7("width",r.diameter,"px")("height",r.diameter,"px")("--mdc-circular-progress-size",r.diameter+"px")("--mdc-circular-progress-active-indicator-width",r.diameter+"px"),o.AVh("_mat-animation-noopable",r._noopAnimations)("mdc-circular-progress--indeterminate","indeterminate"===r.mode))},inputs:{color:"color",mode:"mode",value:[2,"value","value",o.Udg],diameter:[2,"diameter","diameter",o.Udg],strokeWidth:[2,"strokeWidth","strokeWidth",o.Udg]},exportAs:["matProgressSpinner"],standalone:!0,features:[o.GFd,o.aNF],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(n,r){if(1&n&&(o.DNE(0,Gie,2,8,"ng-template",null,0,o.C5r),o.j41(2,"div",2,1),o.qSk(),o.j41(4,"svg",3),o.nrm(5,"circle",4),o.k0s()(),o.joV(),o.j41(6,"div",5)(7,"div",6)(8,"div",7),o.eu8(9,8),o.k0s(),o.j41(10,"div",9),o.eu8(11,8),o.k0s(),o.j41(12,"div",10),o.eu8(13,8),o.k0s()()()),2&n){const l=o.sdS(1);o.R7$(4),o.BMQ("viewBox",r._viewBox()),o.R7$(),o.xc7("stroke-dasharray",r._strokeCircumference(),"px")("stroke-dashoffset",r._strokeDashOffset(),"px")("stroke-width",r._circleStrokeWidth(),"%"),o.BMQ("r",r._circleRadius()),o.R7$(4),o.Y8G("ngTemplateOutlet",l),o.R7$(2),o.Y8G("ngTemplateOutlet",l),o.R7$(2),o.Y8G("ngTemplateOutlet",l)}},dependencies:[Nc],styles:["@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-color-1-fade-in-out{from{opacity:.99}25%{opacity:.99}26%{opacity:0}89%{opacity:0}90%{opacity:.99}to{opacity:.99}}@keyframes mdc-circular-progress-color-2-fade-in-out{from{opacity:0}15%{opacity:0}25%{opacity:.99}50%{opacity:.99}51%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-3-fade-in-out{from{opacity:0}40%{opacity:0}50%{opacity:.99}75%{opacity:.99}76%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-4-fade-in-out{from{opacity:0}65%{opacity:0}75%{opacity:.99}90%{opacity:.99}to{opacity:0}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}.mdc-circular-progress{display:inline-flex;position:relative;direction:ltr;line-height:0;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-1{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-1-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-2{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-2-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-3{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-3-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-4{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both,mdc-circular-progress-color-4-fade-in-out 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--closed{opacity:0}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width)}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-1 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-2 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-3 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mat-mdc-progress-spinner .mdc-circular-progress--four-color .mdc-circular-progress__color-4 .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mat-mdc-progress-spinner .mdc-circular-progress{width:var(--mdc-circular-progress-size) !important;height:var(--mdc-circular-progress-size) !important}.mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.cdk-high-contrast-active .mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}"],encapsulation:2,changeDetection:0})}}return i})(),uV=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[os,qn]})}}return i})();function wk(i,t){!t?.injector&&(0,o.Af3)(wk);const e=t?.injector??(0,o.WQX)(o.zZn),n=new Sm(1),r=(0,o.QZP)(()=>{let l;try{l=i()}catch(m){return void(0,o.O8t)(()=>n.error(m))}(0,o.O8t)(()=>n.next(l))},{injector:e,manualCleanup:!0});return e.get(o.abz).onDestroy(()=>{r.destroy(),n.complete()}),n.asObservable()}function Yie(i,t){1&i&&o.nrm(0,"div",2)}const Zie=new o.nKC("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");let Qie=(()=>{class i{constructor(e,n,r,l,m){this._elementRef=e,this._ngZone=n,this._changeDetectorRef=r,this._animationMode=l,this._isNoopAnimation=!1,this._defaultColor="primary",this._value=0,this._bufferValue=0,this.animationEnd=new o.bkB,this._mode="determinate",this._transitionendHandler=C=>{0===this.animationEnd.observers.length||!C.target||!C.target.classList.contains("mdc-linear-progress__primary-bar")||("determinate"===this.mode||"buffer"===this.mode)&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))},this._isNoopAnimation="NoopAnimations"===l,m&&(m.color&&(this.color=this._defaultColor=m.color),this.mode=m.mode||this.mode)}get color(){return this._color||this._defaultColor}set color(e){this._color=e}get value(){return this._value}set value(e){this._value=JG(e||0),this._changeDetectorRef.markForCheck()}get bufferValue(){return this._bufferValue||0}set bufferValue(e){this._bufferValue=JG(e||0),this._changeDetectorRef.markForCheck()}get mode(){return this._mode}set mode(e){this._mode=e,this._changeDetectorRef.markForCheck()}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("transitionend",this._transitionendHandler)})}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._transitionendHandler)}_getPrimaryBarTransform(){return`scaleX(${this._isIndeterminate()?1:this.value/100})`}_getBufferBarFlexBasis(){return`${"buffer"===this.mode?this.bufferValue:100}%`}_isIndeterminate(){return"indeterminate"===this.mode||"query"===this.mode}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.SKi),o.rXU(o.gRc),o.rXU(o.bc$,8),o.rXU(Zie,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-progress-bar"]],hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-mdc-progress-bar","mdc-linear-progress"],hostVars:10,hostBindings:function(n,r){2&n&&(o.BMQ("aria-valuenow",r._isIndeterminate()?null:r.value)("mode",r.mode),o.HbH("mat-"+r.color),o.AVh("_mat-animation-noopable",r._isNoopAnimation)("mdc-linear-progress--animation-ready",!r._isNoopAnimation)("mdc-linear-progress--indeterminate",r._isIndeterminate()))},inputs:{color:"color",value:[2,"value","value",o.Udg],bufferValue:[2,"bufferValue","bufferValue",o.Udg],mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],standalone:!0,features:[o.GFd,o.aNF],decls:7,vars:5,consts:[["aria-hidden","true",1,"mdc-linear-progress__buffer"],[1,"mdc-linear-progress__buffer-bar"],[1,"mdc-linear-progress__buffer-dots"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__primary-bar"],[1,"mdc-linear-progress__bar-inner"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__secondary-bar"]],template:function(n,r){1&n&&(o.j41(0,"div",0),o.nrm(1,"div",1),o.DNE(2,Yie,1,0,"div",2),o.k0s(),o.j41(3,"div",3),o.nrm(4,"span",4),o.k0s(),o.j41(5,"div",5),o.nrm(6,"span",4),o.k0s()),2&n&&(o.R7$(),o.xc7("flex-basis",r._getBufferBarFlexBasis()),o.R7$(),o.vxM("buffer"===r.mode?2:-1),o.R7$(),o.xc7("transform",r._getPrimaryBarTransform()))},styles:[".mat-mdc-progress-bar{display:block;text-align:start}.mat-mdc-progress-bar[mode=query]{transform:scaleX(-1)}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-dots,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__secondary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__bar-inner.mdc-linear-progress__bar-inner{animation:none}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-bar{transition:transform 1ms}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid rgba(0,0,0,0);overflow-x:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:max(var(--mdc-linear-progress-track-height),var(--mdc-linear-progress-active-indicator-height))}.cdk-high-contrast-active .mdc-linear-progress{outline-color:CanvasText}.mdc-linear-progress__bar{position:absolute;top:0;bottom:0;margin:auto 0;width:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:var(--mdc-linear-progress-active-indicator-height)}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}[dir=rtl] .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid;border-color:var(--mdc-linear-progress-active-indicator-color);border-top-width:var(--mdc-linear-progress-active-indicator-height)}.mdc-linear-progress__buffer{display:flex;position:absolute;top:0;bottom:0;margin:auto 0;width:100%;overflow:hidden;height:var(--mdc-linear-progress-track-height);border-radius:var(--mdc-linear-progress-track-shape)}.mdc-linear-progress__buffer-dots{-webkit-mask-image:url(\"data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E\");mask-image:url(\"data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E\");background-repeat:repeat-x;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear;background-color:var(--mdc-linear-progress-track-color)}.cdk-high-contrast-active .mdc-linear-progress__buffer-dots{background-color:ButtonBorder}[dir=rtl] .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;transform:rotate(0)}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);background-color:var(--mdc-linear-progress-track-color)}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(calc(var(--mdc-linear-progress-track-height) * -2.5))}}@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}"],encapsulation:2,changeDetection:0})}}return i})();function JG(i,t=0,e=100){return Math.max(t,Math.min(e,i))}let e8=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn]})}}return i})();class hV{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class xS extends hV{constructor(t,e,n,r,l){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=r,this.projectableNodes=l}}class px extends hV{constructor(t,e,n,r){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class Jie extends hV{constructor(t){super(),this.element=t instanceof o.aKT?t.nativeElement:t}}class fV{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof xS?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof px?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof Jie?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class ene extends fV{constructor(t,e,n,r,l){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=m=>{const C=m.element,A=this._document.createComment("dom-portal");C.parentNode.insertBefore(A,C),this.outletElement.appendChild(C),this._attachedPortal=m,super.setDisposeFn(()=>{A.parentNode&&A.parentNode.replaceChild(C,A)})},this._document=l}attachComponentPortal(t){const n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let r;return t.viewContainerRef?(r=t.viewContainerRef.createComponent(n,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=n.create(t.injector||this._defaultInjector||o.zZn.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=t,r}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=e.indexOf(n);-1!==r&&e.remove(r)}),this._attachedPortal=t,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let tne=(()=>{class i extends px{constructor(e,n){super(e,n)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q),o.rXU(o.c1b))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],standalone:!0,features:[o.Vt3]})}}return i})(),gx=(()=>{class i extends fV{constructor(e,n,r){super(),this._componentFactoryResolver=e,this._viewContainerRef=n,this._isInitialized=!1,this.attached=new o.bkB,this.attachDomPortal=l=>{const m=l.element,C=this._document.createComment("dom-portal");l.setAttachedHost(this),m.parentNode.insertBefore(C,m),this._getRootNode().appendChild(m),this._attachedPortal=l,super.setDisposeFn(()=>{C.parentNode&&C.parentNode.replaceChild(m,C)})},this._document=r}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);const n=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,l=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),m=n.createComponent(l,n.length,e.injector||n.injector,e.projectableNodes||void 0);return n!==this._viewContainerRef&&this._getRootNode().appendChild(m.hostView.rootNodes[0]),super.setDisposeFn(()=>m.destroy()),this._attachedPortal=e,this._attachedRef=m,this.attached.emit(m),m}attachTemplatePortal(e){e.setAttachedHost(this);const n=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=n,this.attached.emit(n),n}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.OM3),o.rXU(o.c1b),o.rXU(Nn))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[o.Vt3]})}}return i})(),JP=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({})}}return i})();const ine=["addListener","removeListener"],nne=["addEventListener","removeEventListener"],rne=["on","off"];function bu(i,t,e,n){if((0,_.T)(e)&&(n=e,e=void 0),n)return bu(i,t,e).pipe(ai(n));const[r,l]=function ane(i){return(0,_.T)(i.addEventListener)&&(0,_.T)(i.removeEventListener)}(i)?nne.map(m=>C=>i[m](t,C,e)):function one(i){return(0,_.T)(i.addListener)&&(0,_.T)(i.removeListener)}(i)?ine.map(t8(i,t)):function sne(i){return(0,_.T)(i.on)&&(0,_.T)(i.off)}(i)?rne.map(t8(i,t)):[];if(!r&&zr(i))return hr(m=>bu(m,t,e))(pn(i));if(!r)throw new TypeError("Invalid event target");return new Ai.c(m=>{const C=(...A)=>m.next(1<A.length?A:A[0]);return r(C),()=>l(C)})}function t8(i,t){return e=>n=>i[e](t,n)}const Ck={schedule(i){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:n}=Ck;n&&(t=n.requestAnimationFrame,e=n.cancelAnimationFrame);const r=t(l=>{e=void 0,i(l)});return new On.yU(()=>e?.(r))},requestAnimationFrame(...i){const{delegate:t}=Ck;return(t?.requestAnimationFrame||requestAnimationFrame)(...i)},cancelAnimationFrame(...i){const{delegate:t}=Ck;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...i)},delegate:void 0};new class cne extends Jl{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;t=t||n.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,r){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw r}}}(class lne extends Bv{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=Ck.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(t,e,n);const{actions:l}=t;null!=e&&(null===(r=l[l.length-1])||void 0===r?void 0:r.id)!==e&&(Ck.cancelAnimationFrame(e),t._scheduled=void 0)}});let mV,une=1;const eO={};function i8(i){return i in eO&&(delete eO[i],!0)}const hne={setImmediate(i){const t=une++;return eO[t]=!0,mV||(mV=Promise.resolve()),mV.then(()=>i8(t)&&i()),t},clearImmediate(i){i8(i)}},{setImmediate:fne,clearImmediate:mne}=hne,tO={setImmediate(...i){const{delegate:t}=tO;return(t?.setImmediate||fne)(...i)},clearImmediate(i){const{delegate:t}=tO;return(t?.clearImmediate||mne)(i)},delegate:void 0},pV=new class gne extends Jl{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:n}=this;let r;t=t||n.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=n[0])&&t.id===e&&n.shift());if(this._active=!1,r){for(;(t=n[0])&&t.id===e&&n.shift();)t.unsubscribe();throw r}}}(class pne extends Bv{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t._scheduled||(t._scheduled=tO.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,n=0){var r;if(null!=n?n>0:this.delay>0)return super.recycleAsyncId(t,e,n);const{actions:l}=t;null!=e&&(null===(r=l[l.length-1])||void 0===r?void 0:r.id)!==e&&(tO.clearImmediate(e),t._scheduled===e&&(t._scheduled=void 0))}});function gV(i=0,t,e=Kg){let n=-1;return null!=t&&(Tr(t)?e=t:n=t),new Ai.c(r=>{let l=function vne(i){return i instanceof Date&&!isNaN(i)}(i)?+i-e.now():i;l<0&&(l=0);let m=0;return e.schedule(function(){r.closed||(r.next(m++),0<=n?this.schedule(void 0,n):r.complete())},l)})}function n8(i,t=zh){return function _ne(i){return(0,ut.N)((t,e)=>{let n=!1,r=null,l=null,m=!1;const C=()=>{if(l?.unsubscribe(),l=null,n){n=!1;const O=r;r=null,e.next(O)}m&&e.complete()},A=()=>{l=null,m&&e.complete()};t.subscribe((0,bt._)(e,O=>{n=!0,r=O,l||pn(i(O)).subscribe(l=(0,bt._)(e,C,A))},()=>{m=!0,(!n||!l||l.closed)&&e.complete()}))})}(()=>gV(i,t))}let Ek=(()=>{class i{constructor(e,n,r){this._ngZone=e,this._platform=n,this._scrolled=new xi.B,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const n=this.scrollContainers.get(e);n&&(n.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Ai.c(n=>{this._globalSubscription||this._addGlobalListener();const r=e>0?this._scrolled.pipe(n8(e)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):di()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(e,n){const r=this.getAncestorScrollContainers(e);return this.scrolled(n).pipe(Ur(l=>!l||r.indexOf(l)>-1))}getAncestorScrollContainers(e){const n=[];return this.scrollContainers.forEach((r,l)=>{this._scrollableContainsElement(l,e)&&n.push(l)}),n}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,n){let r=lu(n),l=e.getElementRef().nativeElement;do{if(r==l)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>bu(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(o.SKi),o.KVO(wo),o.KVO(Nn,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),wS=(()=>{class i{constructor(e,n,r,l){this.elementRef=e,this.scrollDispatcher=n,this.ngZone=r,this.dir=l,this._destroyed=new xi.B,this._elementScrolled=new Ai.c(m=>this.ngZone.runOutsideAngular(()=>bu(this.elementRef.nativeElement,"scroll").pipe(dn(this._destroyed)).subscribe(m)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const n=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=r?e.end:e.start),null==e.right&&(e.right=r?e.start:e.end),null!=e.bottom&&(e.top=n.scrollHeight-n.clientHeight-e.bottom),r&&am()!=Ku.NORMAL?(null!=e.left&&(e.right=n.scrollWidth-n.clientWidth-e.left),am()==Ku.INVERTED?e.left=e.right:am()==Ku.NEGATED&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=n.scrollWidth-n.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const n=this.elementRef.nativeElement;_w()?n.scrollTo(e):(null!=e.top&&(n.scrollTop=e.top),null!=e.left&&(n.scrollLeft=e.left))}measureScrollOffset(e){const n="left",r="right",l=this.elementRef.nativeElement;if("top"==e)return l.scrollTop;if("bottom"==e)return l.scrollHeight-l.clientHeight-l.scrollTop;const m=this.dir&&"rtl"==this.dir.value;return"start"==e?e=m?r:n:"end"==e&&(e=m?n:r),m&&am()==Ku.INVERTED?e==n?l.scrollWidth-l.clientWidth-l.scrollLeft:l.scrollLeft:m&&am()==Ku.NEGATED?e==n?l.scrollLeft+l.scrollWidth-l.clientWidth:-l.scrollLeft:e==n?l.scrollLeft:l.scrollWidth-l.clientWidth-l.scrollLeft}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(Ek),o.rXU(o.SKi),o.rXU(Us,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}}return i})(),_x=(()=>{class i{constructor(e,n,r){this._platform=e,this._change=new xi.B,this._changeListener=l=>{this._change.next(l)},this._document=r,n.runOutsideAngular(()=>{if(e.isBrowser){const l=this._getWindow();l.addEventListener("resize",this._changeListener),l.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,n=this._getWindow(),r=e.documentElement,l=r.getBoundingClientRect();return{top:-l.top||e.body.scrollTop||n.scrollY||r.scrollTop||0,left:-l.left||e.body.scrollLeft||n.scrollX||r.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(n8(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(wo),o.KVO(o.SKi),o.KVO(Nn,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Lb=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({})}}return i})(),_V=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[Op,Lb,Op,Lb]})}}return i})();const r8=_w();class wne{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Vs(-this._previousScrollPosition.left),t.style.top=Vs(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,n=t.style,r=this._document.body.style,l=n.scrollBehavior||"",m=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),r8&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),r8&&(n.scrollBehavior=l,r.scrollBehavior=m)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,n=this._viewportRuler.getViewportSize();return e.scrollHeight>n.height||e.scrollWidth>n.width}}class Cne{constructor(t,e,n,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0).pipe(Ur(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class o8{enable(){}disable(){}attach(){}}function vV(i,t){return t.some(e=>i.bottom<e.top||i.top>e.bottom||i.right<e.left||i.left>e.right)}function s8(i,t){return t.some(e=>i.top<e.top||i.bottom>e.bottom||i.left<e.left||i.right>e.right)}class Ene{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();vV(e,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Tne=(()=>{class i{constructor(e,n,r,l){this._scrollDispatcher=e,this._viewportRuler=n,this._ngZone=r,this.noop=()=>new o8,this.close=m=>new Cne(this._scrollDispatcher,this._ngZone,this._viewportRuler,m),this.block=()=>new wne(this._viewportRuler,this._document),this.reposition=m=>new Ene(this._scrollDispatcher,this._viewportRuler,this._ngZone,m),this._document=l}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Ek),o.KVO(_x),o.KVO(o.SKi),o.KVO(Nn))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();class CS{constructor(t){if(this.scrollStrategy=new o8,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class Sne{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}let a8=(()=>{class i{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const n=this._attachedOverlays.indexOf(e);n>-1&&this._attachedOverlays.splice(n,1),0===this._attachedOverlays.length&&this.detach()}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Mne=(()=>{class i extends a8{constructor(e,n){super(e),this._ngZone=n,this._keydownListener=r=>{const l=this._attachedOverlays;for(let m=l.length-1;m>-1;m--)if(l[m]._keydownEvents.observers.length>0){const C=l[m]._keydownEvents;this._ngZone?this._ngZone.run(()=>C.next(r)):C.next(r);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn),o.KVO(o.SKi,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Ane=(()=>{class i extends a8{constructor(e,n,r){super(e),this._platform=n,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=l=>{this._pointerDownEventTarget=Td(l)},this._clickListener=l=>{const m=Td(l),C="click"===l.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:m;this._pointerDownEventTarget=null;const A=this._attachedOverlays.slice();for(let O=A.length-1;O>-1;O--){const z=A[O];if(z._outsidePointerEvents.observers.length<1||!z.hasAttached())continue;if(l8(z.overlayElement,m)||l8(z.overlayElement,C))break;const $=z._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>$.next(l)):$.next(l)}}}add(e){if(super.add(e),!this._isAttached){const n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn),o.KVO(wo),o.KVO(o.SKi,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function l8(i,t){const e=typeof ShadowRoot<"u"&&ShadowRoot;let n=t;for(;n;){if(n===i)return!0;n=e&&n instanceof ShadowRoot?n.host:n.parentNode}return!1}let c8=(()=>{class i{constructor(e,n){this._platform=n,this._document=e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||Gg()){const r=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let l=0;l<r.length;l++)r[l].remove()}const n=this._document.createElement("div");n.classList.add(e),Gg()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Nn),o.KVO(wo))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();class Dne{constructor(t,e,n,r,l,m,C,A,O,z=!1,$){this._portalOutlet=t,this._host=e,this._pane=n,this._config=r,this._ngZone=l,this._keyboardDispatcher=m,this._document=C,this._location=A,this._outsideClickDispatcher=O,this._animationsDisabled=z,this._injector=$,this._backdropElement=null,this._backdropClick=new xi.B,this._attachments=new xi.B,this._detachments=new xi.B,this._locationChanges=On.yU.EMPTY,this._backdropClickHandler=Q=>this._backdropClick.next(Q),this._backdropTransitionendHandler=Q=>{this._disposeBackdrop(Q.target)},this._keydownEvents=new xi.B,this._outsidePointerEvents=new xi.B,this._renders=new xi.B,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy,this._afterRenderRef=(0,o.O8t)(()=>(0,o.Tzd)(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),(0,o.mal)(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=Vs(this._config.width),t.height=Vs(this._config.height),t.minWidth=Vs(this._config.minWidth),t.minHeight=Vs(this._config.minHeight),t.maxWidth=Vs(this._config.maxWidth),t.maxHeight=Vs(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,e,n){const r=Vv(e||[]).filter(l=>!!l);r.length&&(n?t.classList.add(...r):t.classList.remove(...r))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{const t=this._renders.pipe(dn(Io(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const d8="cdk-overlay-connected-position-bounding-box",kne=/([A-Za-z%]+)$/;class Ine{get positions(){return this._preferredPositions}constructor(t,e,n,r,l){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=l,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new xi.B,this._resizeSubscription=On.yU.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._validatePositions(),t.hostElement.classList.add(d8),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,r=this._containerRect,l=[];let m;for(let C of this._preferredPositions){let A=this._getOriginPoint(t,r,C),O=this._getOverlayPoint(A,e,C),z=this._getOverlayFit(O,e,n,C);if(z.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(C,A);this._canFitWithFlexibleDimensions(z,O,n)?l.push({position:C,origin:A,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(A,C)}):(!m||m.overlayFit.visibleArea<z.visibleArea)&&(m={overlayFit:z,overlayPoint:O,originPoint:A,position:C,overlayRect:e})}if(l.length){let C=null,A=-1;for(const O of l){const z=O.boundingBoxRect.width*O.boundingBoxRect.height*(O.position.weight||1);z>A&&(A=z,C=O)}return this._isPushed=!1,void this._applyPosition(C.position,C.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(m.position,m.originPoint);this._applyPosition(m.position,m.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&tC(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(d8),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,n){let r,l;if("center"==n.originX)r=t.left+t.width/2;else{const m=this._isRtl()?t.right:t.left,C=this._isRtl()?t.left:t.right;r="start"==n.originX?m:C}return e.left<0&&(r-=e.left),l="center"==n.originY?t.top+t.height/2:"top"==n.originY?t.top:t.bottom,e.top<0&&(l-=e.top),{x:r,y:l}}_getOverlayPoint(t,e,n){let r,l;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,l="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+r,y:t.y+l}}_getOverlayFit(t,e,n,r){const l=h8(e);let{x:m,y:C}=t,A=this._getOffset(r,"x"),O=this._getOffset(r,"y");A&&(m+=A),O&&(C+=O);let Q=0-C,te=C+l.height-n.height,de=this._subtractOverflows(l.width,0-m,m+l.width-n.width),fe=this._subtractOverflows(l.height,Q,te),ge=de*fe;return{visibleArea:ge,isCompletelyWithinViewport:l.width*l.height===ge,fitsInViewportVertically:fe===l.height,fitsInViewportHorizontally:de==l.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const r=n.bottom-e.y,l=n.right-e.x,m=u8(this._overlayRef.getConfig().minHeight),C=u8(this._overlayRef.getConfig().minWidth);return(t.fitsInViewportVertically||null!=m&&m<=r)&&(t.fitsInViewportHorizontally||null!=C&&C<=l)}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=h8(e),l=this._viewportRect,m=Math.max(t.x+r.width-l.width,0),C=Math.max(t.y+r.height-l.height,0),A=Math.max(l.top-n.top-t.y,0),O=Math.max(l.left-n.left-t.x,0);let z=0,$=0;return z=r.width<=l.width?O||-m:t.x<this._viewportMargin?l.left-n.left-t.x:0,$=r.height<=l.height?A||-C:t.y<this._viewportMargin?l.top-n.top-t.y:0,this._previousPushAmount={x:z,y:$},{x:t.x+z,y:t.y+$}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._positionChanges.observers.length){const n=this._getScrollVisibility();if(t!==this._lastPosition||!this._lastScrollVisibility||!function Rne(i,t){return i===t||i.isOriginClipped===t.isOriginClipped&&i.isOriginOutsideView===t.isOriginOutsideView&&i.isOverlayClipped===t.isOverlayClipped&&i.isOverlayOutsideView===t.isOverlayOutsideView}(this._lastScrollVisibility,n)){const r=new Sne(t,n);this._positionChanges.next(r)}this._lastScrollVisibility=n}this._lastPosition=t,this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let l=0;l<e.length;l++)e[l].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,r=this._isRtl();let l,m,C,z,$,Q;if("top"===e.overlayY)m=t.y,l=n.height-m+this._viewportMargin;else if("bottom"===e.overlayY)C=n.height-t.y+2*this._viewportMargin,l=n.height-C+this._viewportMargin;else{const te=Math.min(n.bottom-t.y+n.top,t.y),de=this._lastBoundingBoxSize.height;l=2*te,m=t.y-te,l>de&&!this._isInitialRender&&!this._growAfterOpen&&(m=t.y-de/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)Q=n.width-t.x+2*this._viewportMargin,z=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)$=t.x,z=n.right-t.x;else{const te=Math.min(n.right-t.x+n.left,t.x),de=this._lastBoundingBoxSize.width;z=2*te,$=t.x-te,z>de&&!this._isInitialRender&&!this._growAfterOpen&&($=t.x-de/2)}return{top:m,left:$,bottom:C,right:Q,width:z,height:l}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const l=this._overlayRef.getConfig().maxHeight,m=this._overlayRef.getConfig().maxWidth;r.height=Vs(n.height),r.top=Vs(n.top),r.bottom=Vs(n.bottom),r.width=Vs(n.width),r.left=Vs(n.left),r.right=Vs(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",l&&(r.maxHeight=Vs(l)),m&&(r.maxWidth=Vs(m))}this._lastBoundingBoxSize=n,tC(this._boundingBox.style,r)}_resetBoundingBoxStyles(){tC(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){tC(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={},r=this._hasExactPosition(),l=this._hasFlexibleDimensions,m=this._overlayRef.getConfig();if(r){const z=this._viewportRuler.getViewportScrollPosition();tC(n,this._getExactOverlayY(e,t,z)),tC(n,this._getExactOverlayX(e,t,z))}else n.position="static";let C="",A=this._getOffset(e,"x"),O=this._getOffset(e,"y");A&&(C+=`translateX(${A}px) `),O&&(C+=`translateY(${O}px)`),n.transform=C.trim(),m.maxHeight&&(r?n.maxHeight=Vs(m.maxHeight):l&&(n.maxHeight="")),m.maxWidth&&(r?n.maxWidth=Vs(m.maxWidth):l&&(n.maxWidth="")),tC(this._pane.style,n)}_getExactOverlayY(t,e,n){let r={top:"",bottom:""},l=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(l=this._pushOverlayOnScreen(l,this._overlayRect,n)),"bottom"===t.overlayY?r.bottom=this._document.documentElement.clientHeight-(l.y+this._overlayRect.height)+"px":r.top=Vs(l.y),r}_getExactOverlayX(t,e,n){let m,r={left:"",right:""},l=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(l=this._pushOverlayOnScreen(l,this._overlayRect,n)),m=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===m?r.right=this._document.documentElement.clientWidth-(l.x+this._overlayRect.width)+"px":r.left=Vs(l.x),r}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:s8(t,n),isOriginOutsideView:vV(t,n),isOverlayClipped:s8(e,n),isOverlayOutsideView:vV(e,n)}}_subtractOverflows(t,...e){return e.reduce((n,r)=>n-Math.max(r,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&Vv(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof o.aKT)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}}function tC(i,t){for(let e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return i}function u8(i){if("number"!=typeof i&&null!=i){const[t,e]=i.split(kne);return e&&"px"!==e?null:parseFloat(t)}return i||null}function h8(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}const f8="cdk-global-overlay-wrapper";class Pne{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(f8),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:l,maxWidth:m,maxHeight:C}=n,A=!("100%"!==r&&"100vw"!==r||m&&"100%"!==m&&"100vw"!==m),O=!("100%"!==l&&"100vh"!==l||C&&"100%"!==C&&"100vh"!==C),z=this._xPosition,$=this._xOffset,Q="rtl"===this._overlayRef.getConfig().direction;let te="",de="",fe="";A?fe="flex-start":"center"===z?(fe="center",Q?de=$:te=$):Q?"left"===z||"end"===z?(fe="flex-end",te=$):("right"===z||"start"===z)&&(fe="flex-start",de=$):"left"===z||"start"===z?(fe="flex-start",te=$):("right"===z||"end"===z)&&(fe="flex-end",de=$),t.position=this._cssPosition,t.marginLeft=A?"0":te,t.marginTop=O?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=A?"0":de,e.justifyContent=fe,e.alignItems=O?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove(f8),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let One=(()=>{class i{constructor(e,n,r,l){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=l}global(){return new Pne}flexibleConnectedTo(e){return new Ine(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(_x),o.KVO(Nn),o.KVO(wo),o.KVO(c8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Lne=0,_l=(()=>{class i{constructor(e,n,r,l,m,C,A,O,z,$,Q,te){this.scrollStrategies=e,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=l,this._keyboardDispatcher=m,this._injector=C,this._ngZone=A,this._document=O,this._directionality=z,this._location=$,this._outsideClickDispatcher=Q,this._animationsModuleType=te}create(e){const n=this._createHostElement(),r=this._createPaneElement(n),l=this._createPortalOutlet(r),m=new CS(e);return m.direction=m.direction||this._directionality.value,new Dne(l,n,r,m,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType,this._injector.get(o.uvJ))}position(){return this._positionBuilder}_createPaneElement(e){const n=this._document.createElement("div");return n.id="cdk-overlay-"+Lne++,n.classList.add("cdk-overlay-pane"),e.appendChild(n),n}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(o.o8S)),new ene(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Tne),o.KVO(c8),o.KVO(o.OM3),o.KVO(One),o.KVO(Mne),o.KVO(o.zZn),o.KVO(o.SKi),o.KVO(Nn),o.KVO(Us),o.KVO(Ma),o.KVO(Ane),o.KVO(o.bc$,8))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const Fne=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],m8=new o.nKC("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{const i=(0,o.WQX)(_l);return()=>i.scrollStrategies.reposition()}});let iO=(()=>{class i{constructor(e){this.elementRef=e}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0})}}return i})(),p8=(()=>{class i{get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(e){this._disposeOnNavigation=e}constructor(e,n,r,l,m){this._overlay=e,this._dir=m,this._backdropSubscription=On.yU.EMPTY,this._attachSubscription=On.yU.EMPTY,this._detachSubscription=On.yU.EMPTY,this._positionSubscription=On.yU.EMPTY,this._disposeOnNavigation=!1,this._ngZone=(0,o.WQX)(o.SKi),this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.hasBackdrop=!1,this.lockPosition=!1,this.flexibleDimensions=!1,this.growAfterOpen=!1,this.push=!1,this.backdropClick=new o.bkB,this.positionChange=new o.bkB,this.attach=new o.bkB,this.detach=new o.bkB,this.overlayKeydown=new o.bkB,this.overlayOutsideClick=new o.bkB,this._templatePortal=new px(n,r),this._scrollStrategyFactory=l,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=Fne);const e=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=e.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=e.detachments().subscribe(()=>this.detach.emit()),e.keydownEvents().subscribe(n=>{this.overlayKeydown.next(n),27===n.keyCode&&!this.disableClose&&!oa(n)&&(n.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(n=>{const r=this._getOriginElement(),l=Td(n);(!r||r!==l&&!r.contains(l))&&this.overlayOutsideClick.next(n)})}_buildConfig(){const e=this._position=this.positionStrategy||this._createPositionStrategy(),n=new CS({direction:this._dir,positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||0===this.width)&&(n.width=this.width),(this.height||0===this.height)&&(n.height=this.height),(this.minWidth||0===this.minWidth)&&(n.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(n.minHeight=this.minHeight),this.backdropClass&&(n.backdropClass=this.backdropClass),this.panelClass&&(n.panelClass=this.panelClass),n}_updatePositionStrategy(e){const n=this.positions.map(r=>({originX:r.originX,originY:r.originY,overlayX:r.overlayX,overlayY:r.overlayY,offsetX:r.offsetX||this.offsetX,offsetY:r.offsetY||this.offsetY,panelClass:r.panelClass||void 0}));return e.setOrigin(this._getOrigin()).withPositions(n).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const e=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(e),e}_getOrigin(){return this.origin instanceof iO?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof iO?this.origin.elementRef.nativeElement:this.origin instanceof o.aKT?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(e=>{this.backdropClick.emit(e)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(function xne(i,t=!1){return(0,ut.N)((e,n)=>{let r=0;e.subscribe((0,bt._)(n,l=>{const m=i(l,r++);(m||t)&&n.next(l),!m&&n.complete()}))})}(()=>this.positionChange.observers.length>0)).subscribe(e=>{this._ngZone.run(()=>this.positionChange.emit(e)),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(_l),o.rXU(o.C4Q),o.rXU(o.c1b),o.rXU(m8),o.rXU(Us,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[0,"cdkConnectedOverlayOrigin","origin"],positions:[0,"cdkConnectedOverlayPositions","positions"],positionStrategy:[0,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[0,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[0,"cdkConnectedOverlayOffsetY","offsetY"],width:[0,"cdkConnectedOverlayWidth","width"],height:[0,"cdkConnectedOverlayHeight","height"],minWidth:[0,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[0,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[0,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[0,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[0,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[0,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[0,"cdkConnectedOverlayOpen","open"],disableClose:[0,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[0,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[2,"cdkConnectedOverlayHasBackdrop","hasBackdrop",o.L39],lockPosition:[2,"cdkConnectedOverlayLockPosition","lockPosition",o.L39],flexibleDimensions:[2,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",o.L39],growAfterOpen:[2,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",o.L39],push:[2,"cdkConnectedOverlayPush","push",o.L39],disposeOnNavigation:[2,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",o.L39]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[o.GFd,o.OA$]})}}return i})();const Bne={provide:m8,deps:[_l],useFactory:function Nne(i){return()=>i.scrollStrategies.reposition()}};let ES=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[_l,Bne],imports:[Op,JP,_V,_V]})}}return i})();function Vne(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",1)(1,"button",2),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.action())}),o.EFF(2),o.k0s()()}if(2&i){const e=o.XpG();o.R7$(2),o.SpI(" ",e.data.action," ")}}const zne=["label"];function Une(i,t){}const jne=Math.pow(2,31)-1;class nO{constructor(t,e){this._overlayRef=e,this._afterDismissed=new xi.B,this._afterOpened=new xi.B,this._onAction=new xi.B,this._dismissedByAction=!1,this.containerInstance=t,t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,jne))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}const bV=new o.nKC("MatSnackBarData");class rO{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}let yV=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"],standalone:!0})}}return i})(),g8=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"],standalone:!0})}}return i})(),xV=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"],standalone:!0})}}return i})(),Gne=(()=>{class i{constructor(e,n){this.snackBarRef=e,this.data=n}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(nO),o.rXU(bV))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],standalone:!0,features:[o.aNF],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(n,r){1&n&&(o.j41(0,"div",0),o.EFF(1),o.k0s(),o.DNE(2,Vne,3,1,"div",1)),2&n&&(o.R7$(),o.SpI(" ",r.data.message,"\n"),o.R7$(),o.vxM(r.hasAction?2:-1))},dependencies:[Sc,yV,g8,xV],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0})}}return i})();const Hne={snackBarState:js("state",[Lo("void, hidden",gn({transform:"scale(0.8)",opacity:0})),Lo("visible",gn({transform:"scale(1)",opacity:1})),oo("* => visible",co("150ms cubic-bezier(0, 0, 0.2, 1)")),oo("* => void, * => hidden",co("75ms cubic-bezier(0.4, 0.0, 1, 1)",gn({opacity:0})))])};let $ne=0,_8=(()=>{class i extends fV{constructor(e,n,r,l,m){super(),this._ngZone=e,this._elementRef=n,this._changeDetectorRef=r,this._platform=l,this.snackBarConfig=m,this._document=(0,o.WQX)(Nn),this._trackedModals=new Set,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new xi.B,this._onExit=new xi.B,this._onEnter=new xi.B,this._animationState="void",this._liveElementId="mat-snack-bar-container-live-"+$ne++,this.attachDomPortal=C=>{this._assertNotAttached();const A=this._portalOutlet.attachDomPortal(C);return this._afterPortalAttached(),A},this._live="assertive"!==m.politeness||m.announcementMessage?"off"===m.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();const n=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),n}attachTemplatePortal(e){this._assertNotAttached();const n=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),n}onAnimationEnd(e){const{fromState:n,toState:r}=e;if(("void"===r&&"void"!==n||"hidden"===r)&&this._completeExit(),"visible"===r){const l=this._onEnter;this._ngZone.run(()=>{l.next(),l.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){const e=this._elementRef.nativeElement,n=this.snackBarConfig.panelClass;n&&(Array.isArray(n)?n.forEach(m=>e.classList.add(m)):e.classList.add(n)),this._exposeToModals();const r=this._label.nativeElement,l="mdc-snackbar__label";r.classList.toggle(l,!r.querySelector(`.${l}`))}_exposeToModals(){const e=this._liveElementId,n=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<n.length;r++){const l=n[r],m=l.getAttribute("aria-owns");this._trackedModals.add(l),m?-1===m.indexOf(e)&&l.setAttribute("aria-owns",m+" "+e):l.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{const n=e.getAttribute("aria-owns");if(n){const r=n.replace(this._liveElementId,"").trim();r.length>0?e.setAttribute("aria-owns",r):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),n=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&n){let r=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(r=document.activeElement),e.removeAttribute("aria-hidden"),n.appendChild(e),r?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.SKi),o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(wo),o.rXU(rO))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-snack-bar-container"]],viewQuery:function(n,r){if(1&n&&(o.GBs(gx,7),o.GBs(zne,7)),2&n){let l;o.mGM(l=o.lsd())&&(r._portalOutlet=l.first),o.mGM(l=o.lsd())&&(r._label=l.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:1,hostBindings:function(n,r){1&n&&o.Kam("@state.done",function(m){return r.onAnimationEnd(m)}),2&n&&o.zvX("@state",r._animationState)},standalone:!0,features:[o.Vt3,o.aNF],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(n,r){1&n&&(o.j41(0,"div",1)(1,"div",2,0)(3,"div",3),o.DNE(4,Une,0,0,"ng-template",4),o.k0s(),o.nrm(5,"div"),o.k0s()()),2&n&&(o.R7$(5),o.BMQ("aria-live",r._live)("role",r._role)("id",r._liveElementId))},dependencies:[gx],styles:[".mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}.cdk-high-contrast-active .mat-mdc-snackbar-surface{outline:solid 1px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mdc-snackbar-supporting-text-color);border-radius:var(--mdc-snackbar-container-shape);background-color:var(--mdc-snackbar-container-color)}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mdc-snackbar-supporting-text-font);font-size:var(--mdc-snackbar-supporting-text-size);font-weight:var(--mdc-snackbar-supporting-text-weight);line-height:var(--mdc-snackbar-supporting-text-line-height)}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){color:var(--mat-snack-bar-button-color);--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}"],encapsulation:2,data:{animation:[Hne.snackBarState]}})}}return i})();const Xne=new o.nKC("mat-snack-bar-default-options",{providedIn:"root",factory:function Wne(){return new rO}});let v8=(()=>{class i{get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(e,n,r,l,m,C){this._overlay=e,this._live=n,this._injector=r,this._breakpointObserver=l,this._parentSnackBar=m,this._defaultConfig=C,this._snackBarRefAtThisLevel=null,this.simpleSnackBarComponent=Gne,this.snackBarContainerComponent=_8,this.handsetCssClass="mat-mdc-snack-bar-handset"}openFromComponent(e,n){return this._attach(e,n)}openFromTemplate(e,n){return this._attach(e,n)}open(e,n="",r){const l={...this._defaultConfig,...r};return l.data={message:e,action:n},l.announcementMessage===e&&(l.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,l)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,n){const l=o.zZn.create({parent:n&&n.viewContainerRef&&n.viewContainerRef.injector||this._injector,providers:[{provide:rO,useValue:n}]}),m=new xS(this.snackBarContainerComponent,n.viewContainerRef,l),C=e.attach(m);return C.instance.snackBarConfig=n,C.instance}_attach(e,n){const r={...new rO,...this._defaultConfig,...n},l=this._createOverlay(r),m=this._attachSnackBarContainer(l,r),C=new nO(m,l);if(e instanceof o.C4Q){const A=new px(e,null,{$implicit:r.data,snackBarRef:C});C.instance=m.attachTemplatePortal(A)}else{const A=this._createInjector(r,C),O=new xS(e,void 0,A),z=m.attachComponentPortal(O);C.instance=z.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(dn(l.detachments())).subscribe(A=>{l.overlayElement.classList.toggle(this.handsetCssClass,A.matches)}),r.announcementMessage&&m._onAnnounce.subscribe(()=>{this._live.announce(r.announcementMessage,r.politeness)}),this._animateSnackBar(C,r),this._openedSnackBarRef=C,this._openedSnackBarRef}_animateSnackBar(e,n){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),n.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),n.duration&&n.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(n.duration))}_createOverlay(e){const n=new CS;n.direction=e.direction;let r=this._overlay.position().global();const l="rtl"===e.direction,m="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!l||"end"===e.horizontalPosition&&l,C=!m&&"center"!==e.horizontalPosition;return m?r.left("0"):C?r.right("0"):r.centerHorizontally(),"top"===e.verticalPosition?r.top("0"):r.bottom("0"),n.positionStrategy=r,this._overlay.create(n)}_createInjector(e,n){return o.zZn.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:nO,useValue:n},{provide:bV,useValue:e.data}]})}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(_l),o.KVO(Ow),o.KVO(o.zZn),o.KVO(sa),o.KVO(i,12),o.KVO(Xne))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),b8=(()=>{class i{constructor(e){this.data=e,this.snackBarRef=(0,o.WQX)(nO)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(bV))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-google-maps-snackbar"]],standalone:!0,features:[o.aNF],decls:5,vars:1,consts:[["matSnackBarLabel","",1,"snackbar-label"],["id","button-container","matSnackBarActions","",1,"dense-2"],["mat-button","","matSnackBarAction","",3,"click"]],template:function(n,r){1&n&&(o.j41(0,"span",0),o.EFF(1),o.k0s(),o.j41(2,"span",1)(3,"button",2),o.bIt("click",function(){return r.snackBarRef.dismissWithAction()}),o.EFF(4,"Dismiss"),o.k0s()()),2&n&&(o.R7$(),o.SpI(" ",r.data," "))},dependencies:[ea,Sc,yV,xV],styles:["[_nghost-%COMP%]{display:flex}#button-container[_ngcontent-%COMP%]{margin-top:.5em}"]})}}return i})(),oO=(()=>{class i{constructor(e){this.httpClient=e}getStudy(e){const n=U__baseUrl+"api/MoveBank/GetStudy",r=(new La).set("studyId",e.toString());return this.httpClient.get(n,{params:r})}getStudies(e,n,r,l,m,C){const A=U__baseUrl+"api/MoveBank/GetStudies";let O=(new La).set("pageIndex",e.toString()).set("pageSize",n.toString()).set("sortColumn",r).set("sortOrder",l);return m&&C&&(O=O.set("filterColumn",m).set("filterQuery",C)),this.httpClient.get(A,{params:O})}getAllStudies(){return this.httpClient.get(U__baseUrl+"api/MoveBank/GetAllStudies")}getAllStudiesGeoJSON(){const e=U__baseUrl+"api/MoveBank/GetAllStudies",n=(new La).set("geojsonFormat","true");return this.httpClient.get(e,{params:n})}jsonRequest(e,n,r="asc"){const l=U__baseUrl+"api/MoveBank/GetJsonData",C={params:(new La).set("entityType",e).set("studyId",n.toString()).set("sortOrder",r),observe:"response",responseType:"json"};return this.httpClient.get(l,C).pipe((0,st.T)(O=>O.status==Rd.NoContent?[]:200==O.status?O.body:[]))}getEventData(e,n,r,l){const m=U__baseUrl+"api/MoveBank/GetEventData",C=this.eventHelper(e,n,r,l);return this.httpClient.get(m,{params:C})}getGeoJsonFetchRequest(e){return new Request(U__baseUrl+"api/MoveBank/GetEventData",{method:"POST",body:JSON.stringify(e)})}eventHelper(e,n,r,l){let m=(new La).set("studyId",e.toString());for(const A of n)m=m.append("individualLocalIdentifiers",A);if(void 0!==r&&(m=m.set("sensorType",r)),void 0===l)return m;const C=Object.keys(l);for(const A of C){const O=l[A];void 0!==O&&Array.isArray(O)?O.forEach(z=>{m=m.append(A,z)}):null!=O&&(m=m.set(A,O.toString()))}return m}autoComplete(e,n){const r=U__baseUrl+"api/MoveBank/AutoComplete",l=(new La).set("prefix",e).set("maxCount",n.toString());return this.httpClient.get(r,{params:l}).pipe(xa(m=>(console.error(m.message),di([]))))}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Em))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function qne(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",1)(1,"button",3),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.initMap())}),o.EFF(2,"Load Map"),o.k0s()()}}function Yne(i,t){1&i&&(o.j41(0,"div",2),o.nrm(1,"mat-spinner",4),o.k0s())}let Zne=(()=>{class i{constructor(e,n,r){this.studyService=e,this.snackbar=n,this.injector=r,this.mapState=(0,o.vPA)("initial"),this.eventState=(0,o.vPA)("initial"),this.mapType="roadmap",this.markersVisible=!0,this.selectedLayer=mn.ArcLayer,this.defaultMapOptions={center:{lat:40,lng:-100},zoom:4,tilt:30,mapId:"ccfbcc384aa699ff",gestureHandling:"auto"},this.defaultAlgorithmOptions={radius:160},this.loader=new Cb({apiKey:"AIzaSyB3YlH9v4TYdeP8Qc3x-HA6jRNYiHJKz1s",version:"weekly",libraries:["marker"]}),this.studiesEmitter=new o.bkB,this.studyEmitter=new o.bkB,this.mapStateEmitter=new o.bkB,this.chunkInfoEmitter=new o.bkB,this.streamStatusEmitter=new o.bkB,this.JsonDataEmitter=new o.bkB,this.componentInitialized=new o.bkB,this.eventMetaData=new o.bkB}ngOnInit(){}ngAfterViewInit(){this.componentInitialized.emit(!0)}ngOnChanges(e){for(const n in e){const r=e[n].currentValue;if(void 0!==r)switch(n){case"pathEventData$":this.pathEventData$=r;break;case"focusedMarker":this.panToMarker(r);break;case"eventRequest":this.eventRequest=r,this.handleEventRequest(r);break;case"mapType":this.mapType=r,this.map?.setMapTypeId(this.mapType);break;case"markersVisible":this.markersVisible=r,this.toggleMarkerVisibility(this.markersVisible).then(()=>console.log("Toggled markers asynchronously."));break;case"selectedLayer":this.selectedLayer=r,this.deckOverlay?.changeActiveLayer(this.selectedLayer);break;case"deckOverlayControls":this.deckOverlayControls=r,this.deckOverlay?.setLayerAttributes(this.deckOverlayControls)}}}ngOnDestroy(){this.mainSubscription$?.unsubscribe(),this.streamStatusSubscription?.unsubscribe(),this.chunkLoadSubscription?.unsubscribe()}toggleMarkerVisibility(e){var n=this;return(0,Yt.A)(function*(){if(!n.mapCluster||!n.markers)return;const r=n.mapCluster,l=[];var A,m=!1,C=!1;try{for(var z,O=N0(n.markers.values());m=!(z=yield O.next()).done;m=!1){const $=z.value;$.map=e?n.map:void 0,l.push($)}}catch($){C=!0,A=$}finally{try{m&&null!=O.return&&(yield O.return())}finally{if(C)throw A}}e?n.mapCluster=new YA({map:n.map,markers:l,renderer:new ZA,algorithm:new qA(n.defaultAlgorithmOptions)}):r.clearMarkers()})()}handleEventRequest(e){this.map?this.deckOverlay?this.deckOverlay.loadData(e,{type:"google",map:this.map}):console.error("DeckOverlay not instantiated before calling loadData method."):console.error("Map not set before handling event request.")}coordinateToLatLng(e){return new google.maps.LatLng(e[0],e[1])}sendMapState(e){this.mapStateEmitter.emit(e)}initMap(){var e=this;return(0,Yt.A)(function*(){if(void 0!==e.map)return!0;e.mapState.set("loading");const n=Pn(e.loader.importLibrary("maps")),r=Pn(e.loader.importLibrary("marker")),l=e.studyService.getAllStudies();return e.mainSubscription$=uu({map:n,marker:r,studies:l}).subscribe({next:m=>{e.mapState.set("loading"),console.log("Successfully loaded google maps markers and map.");const C=document.getElementById("map");e.defaultMapOptions.mapTypeControl=!1,e.defaultMapOptions.mapTypeControlOptions={style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.TOP_CENTER},e.defaultMapOptions.fullscreenControl=!0,e.defaultMapOptions.fullscreenControlOptions={position:google.maps.ControlPosition.BOTTOM_RIGHT},e.map=new google.maps.Map(C,e.defaultMapOptions),e.infoWindow=new google.maps.InfoWindow({disableAutoPan:!0}),e.infoWindow.set("toggle",!1),e.infoWindow.set("studyId",-1n);const A=m.studies,O=new Map;A.forEach(Q=>{O.set(Q.id,Q)}),e.studies=O,e.emitStudies(e.studies);const z=new Map,$=new Set;for(const Q of e.studies.values()){if(void 0===Q.mainLocationLon||void 0===Q.mainLocationLat)continue;let te=`${Q.mainLocationLon.toString()},${Q.mainLocationLat.toString()}`;for(;$.has(te);)Q.mainLocationLon+=.002,te=`${Q.mainLocationLon.toString()},${Q.mainLocationLat.toString()}`;$.add(te);const de=document.createElement("img");de.src="../../assets/location-pin2-small.png";const fe=new google.maps.marker.AdvancedMarkerElement({map:e.map,content:de,position:{lat:Q.mainLocationLat,lng:Q.mainLocationLon},title:Q.name});fe.addListener("click",()=>{if(void 0!==e.infoWindow){if(void 0!==e.infoWindow.get("studyId")&&e.infoWindow.get("studyId")===Q.id&&!0===e.infoWindow.get("toggle"))return e.infoWindow.close(),void e.infoWindow.set("toggle",!1);e.infoWindow.close(),e.infoWindow.setContent(e.buildInfoWindowContent(Q)),e.infoWindow.set("toggle",!e.infoWindow.get("toggle")),e.infoWindow.set("studyId",Q.id),e.infoWindow.open(e.map,fe)}}),z.set(Q.id,fe)}e.markers=z,console.log("About to instantiate mapCluser with markers"),console.log(e.markers),e.mapCluster=new YA({map:e.map,markers:Array.from(z.values()),renderer:new ZA,algorithm:new qA(e.defaultAlgorithmOptions)}),e.initializeDeckOverlay(e.map),e.mapState.set("loaded"),e.sendMapState(!0)},error:m=>{console.error(m),e.mapState.set("error")}}),!0})()}initializeDeckOverlay(e){this.deckOverlay=new ZG(e,this.selectedLayer),this.streamStatus$=wk(this.deckOverlay.StreamStatus,{injector:this.injector}),wk(this.deckOverlay.currentMetaData,{injector:this.injector}).pipe(ou(1)).subscribe({next:r=>this.emitChunkData(r),error:r=>console.error(r)}),this.streamStatusSubscription=this.streamStatus$.pipe(ou(1),su()).subscribe({next:r=>{const l=this.deckOverlay?.CurrentIndividuals().size??0;switch(r){case"standby":if(this.emitStreamStatus("standby"),0===l){this.openSnackBar("No Events Found.");break}this.openSnackBar(`Events found for ${l} animal(s).`);break;case"error":this.emitStreamStatus("error"),this.openSnackBar("Error retrieving events.");break;case"streaming":this.emitStreamStatus("streaming");break;default:return}},error:r=>console.error(r)})}openSnackBar(e,n=2){this.snackbar.openFromComponent(b8,{duration:1e3*n,data:e})}buildInfoWindowContent(e){const n=document.createElement("info-window-el");return n.currentStudy=e,n.eventRequest=this.studyEmitter,n}getJsonData(e,n){return this.studyService.jsonRequest(e,n)}panToCurrentMarker(){this.focusedMarker&&this.panToMarker(this.focusedMarker)}panToMarker(e){const n=this.markers?.get(e);if(!n||!this.infoWindow||!this.map)return;const r=n.position;r&&(this.map.panTo(r),this.map.setZoom(10),google.maps.event.trigger(n,"click"))}emitStudy(e){this.studyEmitter.emit(e)}emitStudies(e){this.studiesEmitter.emit(e)}emitChunkData(e){this.chunkInfoEmitter.emit(e)}emitStreamStatus(e){this.streamStatusEmitter.emit(e)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(oO),o.rXU(v8),o.rXU(o.zZn))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-google-map"]],inputs:{focusedMarker:"focusedMarker",pathEventData$:"pathEventData$",eventRequest:"eventRequest",mapType:"mapType",markersVisible:"markersVisible",selectedLayer:"selectedLayer",deckOverlayControls:"deckOverlayControls"},outputs:{studiesEmitter:"studiesEmitter",studyEmitter:"studyEmitter",mapStateEmitter:"mapStateEmitter",chunkInfoEmitter:"chunkInfoEmitter",streamStatusEmitter:"streamStatusEmitter",JsonDataEmitter:"JsonDataEmitter",componentInitialized:"componentInitialized",eventMetaData:"eventMetaData"},standalone:!0,features:[o.OA$,o.aNF],decls:3,vars:1,consts:[["id","map",1,"map-container"],[1,"button-container"],[1,"spinner-container"],["mat-raised-button","",3,"click"],["id","spinner"]],template:function(n,r){if(1&n&&(o.nrm(0,"div",0),o.DNE(1,qne,3,0,"div",1)(2,Yne,2,0,"div",2)),2&n){let l;o.R7$(),o.vxM("initial"===(l=r.mapState())?1:"loading"===l?2:-1)}},dependencies:[ea,Sc,e8,Er,uV,dV],styles:[".map-container[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;background-color:#fff}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;z-index:54}.spinner-container[_ngcontent-%COMP%]{display:flex;justify-content:center}button[_ngcontent-%COMP%]{margin-top:50vh}#tooltip[_ngcontent-%COMP%]{z-index:100;position:absolute;color:#a0a7b4;background-color:#29323c;padding:10px}#spinner[_ngcontent-%COMP%]{top:47vh}"],changeDetection:0})}}return i})();function y8(i,t){return(0,ut.N)(Bf(i,t,arguments.length>=2,!1,!0))}let x8=(()=>{class i{constructor(e,n){this._renderer=e,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,n){this._renderer.setProperty(this._elementRef.nativeElement,e,n)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.sFG),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i})}}return i})(),iC=(()=>{class i extends x8{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,features:[o.Vt3]})}}return i})();const Ya=new o.nKC(""),Qne={provide:Ya,useExisting:(0,o.Rfq)(()=>Tk),multi:!0},ere=new o.nKC("");let Tk=(()=>{class i extends x8{constructor(e,n,r){super(e,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Jne(){const i=rs()?rs().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.sFG),o.rXU(o.aKT),o.rXU(ere,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){1&n&&o.bIt("input",function(m){return r._handleInput(m.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(m){return r._compositionEnd(m.target.value)})},features:[o.Jv_([Qne]),o.Vt3]})}}return i})();function vx(i){return null==i||("string"==typeof i||Array.isArray(i))&&0===i.length}function C8(i){return null!=i&&"number"==typeof i.length}const vl=new o.nKC(""),bx=new o.nKC(""),tre=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class TS{static min(t){return function E8(i){return t=>{if(vx(t.value)||vx(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}(t)}static max(t){return function T8(i){return t=>{if(vx(t.value)||vx(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}(t)}static required(t){return S8(t)}static requiredTrue(t){return function M8(i){return!0===i.value?null:{required:!0}}(t)}static email(t){return function A8(i){return vx(i.value)||tre.test(i.value)?null:{email:!0}}(t)}static minLength(t){return function D8(i){return t=>vx(t.value)||!C8(t.value)?null:t.value.length<i?{minlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function k8(i){return t=>C8(t.value)&&t.value.length>i?{maxlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static pattern(t){return function I8(i){if(!i)return sO;let t,e;return"string"==typeof i?(e="","^"!==i.charAt(0)&&(e+="^"),e+=i,"$"!==i.charAt(i.length-1)&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),n=>{if(vx(n.value))return null;const r=n.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}(t)}static nullValidator(t){return null}static compose(t){return N8(t)}static composeAsync(t){return B8(t)}}function S8(i){return vx(i.value)?{required:!0}:null}function sO(i){return null}function R8(i){return null!=i}function P8(i){return(0,o.jNT)(i)?Pn(i):i}function O8(i){let t={};return i.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function L8(i,t){return t.map(e=>e(i))}function F8(i){return i.map(t=>function ire(i){return!i.validate}(t)?t:e=>t.validate(e))}function N8(i){if(!i)return null;const t=i.filter(R8);return 0==t.length?null:function(e){return O8(L8(e,t))}}function wV(i){return null!=i?N8(F8(i)):null}function B8(i){if(!i)return null;const t=i.filter(R8);return 0==t.length?null:function(e){return uu(L8(e,t).map(P8)).pipe((0,st.T)(O8))}}function CV(i){return null!=i?B8(F8(i)):null}function V8(i,t){return null===i?[t]:Array.isArray(i)?[...i,t]:[i,t]}function z8(i){return i._rawValidators}function U8(i){return i._rawAsyncValidators}function EV(i){return i?Array.isArray(i)?i:[i]:[]}function aO(i,t){return Array.isArray(i)?i.includes(t):i===t}function j8(i,t){const e=EV(t);return EV(i).forEach(r=>{aO(e,r)||e.push(r)}),e}function G8(i,t){return EV(t).filter(e=>!aO(i,e))}class H8{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=wV(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=CV(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class yu extends H8{get formDirective(){return null}get path(){return null}}class dg extends H8{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class $8{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Sk=(()=>{class i extends $8{constructor(e){super(e)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(dg,2))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){2&n&&o.AVh("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[o.Vt3]})}}return i})(),lO=(()=>{class i extends $8{constructor(e){super(e)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(yu,10))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,r){2&n&&o.AVh("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[o.Vt3]})}}return i})();const Mk="VALID",dO="INVALID",SS="PENDING",Ak="DISABLED";class MS{}class X8 extends MS{constructor(t,e){super(),this.value=t,this.source=e}}class MV extends MS{constructor(t,e){super(),this.pristine=t,this.source=e}}class AV extends MS{constructor(t,e){super(),this.touched=t,this.source=e}}class uO extends MS{constructor(t,e){super(),this.status=t,this.source=e}}class are extends MS{constructor(t){super(),this.source=t}}class lre extends MS{constructor(t){super(),this.source=t}}function DV(i){return(hO(i)?i.validators:i)||null}function kV(i,t){return(hO(t)?t.asyncValidators:i)||null}function hO(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}function q8(i,t,e){const n=i.controls;if(!(t?Object.keys(n):n).length)throw new o.wOt(1e3,"");if(!n[e])throw new o.wOt(1001,"")}function Y8(i,t,e){i._forEachChild((n,r)=>{if(void 0===e[r])throw new o.wOt(1002,"")})}class fO{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._events=new xi.B,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Mk}get invalid(){return this.status===dO}get pending(){return this.status==SS}get disabled(){return this.status===Ak}get enabled(){return this.status!==Ak}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(j8(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(j8(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(G8(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(G8(t,this._rawAsyncValidators))}hasValidator(t){return aO(this._rawValidators,t)}hasAsyncValidator(t){return aO(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){const e=!1===this.touched;this.touched=!0;const n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched({...t,sourceControl:n}),e&&!1!==t.emitEvent&&this._events.next(new AV(!0,n))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){const e=!0===this.touched;this.touched=!1,this._pendingTouched=!1;const n=t.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:n})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,n),e&&!1!==t.emitEvent&&this._events.next(new AV(!1,n))}markAsDirty(t={}){const e=!0===this.pristine;this.pristine=!1;const n=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty({...t,sourceControl:n}),e&&!1!==t.emitEvent&&this._events.next(new MV(!1,n))}markAsPristine(t={}){const e=!1===this.pristine;this.pristine=!0,this._pendingDirty=!1;const n=t.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,n),e&&!1!==t.emitEvent&&this._events.next(new MV(!0,n))}markAsPending(t={}){this.status=SS;const e=t.sourceControl??this;!1!==t.emitEvent&&(this._events.next(new uO(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending({...t,sourceControl:e})}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Ak,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue();const n=t.sourceControl??this;!1!==t.emitEvent&&(this._events.next(new X8(this.value,n)),this._events.next(new uO(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e},this),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Mk,this._forEachChild(n=>{n.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e},this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){const n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Mk||this.status===SS)&&this._runAsyncValidator(n,t.emitEvent)}const e=t.sourceControl??this;!1!==t.emitEvent&&(this._events.next(new X8(this.value,e)),this._events.next(new uO(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity({...t,sourceControl:e})}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ak:Mk}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=SS,this._hasOwnPendingAsyncValidator={emitEvent:!1!==e};const n=P8(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();const t=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent,this,e.shouldHaveEmitted)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((n,r)=>n&&n._find(r),this)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,n){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||n)&&this._events.next(new uO(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,n)}_initObservables(){this.valueChanges=new o.bkB,this.statusChanges=new o.bkB}_calculateStatus(){return this._allControlsDisabled()?Ak:this.errors?dO:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(SS)?SS:this._anyControlsHaveStatus(dO)?dO:Mk}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){const n=!this._anyControlsDirty(),r=this.pristine!==n;this.pristine=n,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),r&&this._events.next(new MV(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new AV(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){hO(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function cre(i){return Array.isArray(i)?wV(i):i||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function dre(i){return Array.isArray(i)?CV(i):i||null}(this._rawAsyncValidators)}}class nC extends fO{constructor(t,e,n){super(DV(e),kV(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){Y8(this,0,t),Object.keys(t).forEach(n=>{q8(this,!0,n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(n=>{const r=this.controls[n];r&&r.patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t?t[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,n)=>!!n._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,n]of Object.entries(this.controls))if(this.contains(e)&&t(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,n,r)=>((n.enabled||this.disabled)&&(e[r]=n.value),e))}_reduceChildren(t,e){let n=t;return this._forEachChild((r,l)=>{n=e(n,r,l)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class Z8 extends nC{}const rC=new o.nKC("CallSetDisabledState",{providedIn:"root",factory:()=>Dk}),Dk="always";function mO(i,t){return[...t.path,i]}function kk(i,t,e=Dk){IV(i,t),t.valueAccessor.writeValue(i.value),(i.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(i.disabled),function hre(i,t){t.valueAccessor.registerOnChange(e=>{i._pendingValue=e,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&K8(i,t)})}(i,t),function mre(i,t){const e=(n,r)=>{t.valueAccessor.writeValue(n),r&&t.viewToModelUpdate(n)};i.registerOnChange(e),t._registerOnDestroy(()=>{i._unregisterOnChange(e)})}(i,t),function fre(i,t){t.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&K8(i,t),"submit"!==i.updateOn&&i.markAsTouched()})}(i,t),function ure(i,t){if(t.valueAccessor.setDisabledState){const e=n=>{t.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(e),t._registerOnDestroy(()=>{i._unregisterOnDisabledChange(e)})}}(i,t)}function pO(i,t,e=!0){const n=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),_O(i,t),i&&(t._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function gO(i,t){i.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function IV(i,t){const e=z8(i);null!==t.validator?i.setValidators(V8(e,t.validator)):"function"==typeof e&&i.setValidators([e]);const n=U8(i);null!==t.asyncValidator?i.setAsyncValidators(V8(n,t.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const r=()=>i.updateValueAndValidity();gO(t._rawValidators,r),gO(t._rawAsyncValidators,r)}function _O(i,t){let e=!1;if(null!==i){if(null!==t.validator){const r=z8(i);if(Array.isArray(r)&&r.length>0){const l=r.filter(m=>m!==t.validator);l.length!==r.length&&(e=!0,i.setValidators(l))}}if(null!==t.asyncValidator){const r=U8(i);if(Array.isArray(r)&&r.length>0){const l=r.filter(m=>m!==t.asyncValidator);l.length!==r.length&&(e=!0,i.setAsyncValidators(l))}}}const n=()=>{};return gO(t._rawValidators,n),gO(t._rawAsyncValidators,n),e}function K8(i,t){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function Q8(i,t){IV(i,t)}function PV(i,t){if(!i.hasOwnProperty("model"))return!1;const e=i.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function J8(i,t){i._syncPendingControls(),t.forEach(e=>{const n=e.control;"submit"===n.updateOn&&n._pendingChange&&(e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function OV(i,t){if(!t)return null;let e,n,r;return Array.isArray(t),t.forEach(l=>{l.constructor===Tk?e=l:function _re(i){return Object.getPrototypeOf(i.constructor)===iC}(l)?n=l:r=l}),r||n||e||null}const bre={provide:yu,useExisting:(0,o.Rfq)(()=>AS)},Ik=Promise.resolve();let AS=(()=>{class i extends yu{constructor(e,n,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new o.bkB,this.form=new nC({},wV(e),CV(n))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Ik.then(()=>{const n=this._findContainer(e.path);e.control=n.registerControl(e.name,e.control),kk(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Ik.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Ik.then(()=>{const n=this._findContainer(e.path),r=new nC({});Q8(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Ik.then(()=>{const n=this._findContainer(e.path);n&&n.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,n){Ik.then(()=>{this.form.get(e.path).setValue(n)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,J8(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(vl,10),o.rXU(bx,10),o.rXU(rC,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,r){1&n&&o.bIt("submit",function(m){return r.onSubmit(m)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[o.Jv_([bre]),o.Vt3]})}}return i})();function eH(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}function tH(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}const df=class extends fO{constructor(t=null,e,n){super(DV(e),kV(n,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),hO(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=tH(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){eH(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){eH(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){tH(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};let iH=(()=>{class i extends yu{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return mO(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,features:[o.Vt3]})}}return i})();const wre={provide:dg,useExisting:(0,o.Rfq)(()=>LV)},rH=Promise.resolve();let LV=(()=>{class i extends dg{constructor(e,n,r,l,m,C){super(),this._changeDetectorRef=m,this.callSetDisabledState=C,this.control=new df,this._registered=!1,this.name="",this.update=new o.bkB,this._parent=e,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=OV(0,l)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const n=e.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),PV(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){kk(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){rH.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const n=e.isDisabled.currentValue,r=0!==n&&(0,o.L39)(n);rH.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?mO(e,this._parent):[e]}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(yu,9),o.rXU(vl,10),o.rXU(bx,10),o.rXU(Ya,10),o.rXU(o.gRc,8),o.rXU(rC,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[o.Jv_([wre]),o.Vt3,o.OA$]})}}return i})(),vO=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return i})();const FV=new o.nKC(""),Are={provide:yu,useExisting:(0,o.Rfq)(()=>Fb)};let Fb=(()=>{class i extends yu{constructor(e,n,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new o.bkB,this._setValidators(e),this._setAsyncValidators(n)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(_O(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const n=this.form.get(e.path);return kk(n,e,this.callSetDisabledState),n.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),n}getControl(e){return this.form.get(e.path)}removeControl(e){pO(e.control||null,e,!1),function vre(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,n){this.form.get(e.path).setValue(n)}onSubmit(e){return this.submitted=!0,J8(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new are(this.control)),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1,this.form._events.next(new lre(this.form))}_updateDomValue(){this.directives.forEach(e=>{const n=e.control,r=this.form.get(e.path);n!==r&&(pO(n||null,e),(i=>i instanceof df)(r)&&(kk(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const n=this.form.get(e.path);Q8(n,e),n.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const n=this.form.get(e.path);n&&function pre(i,t){return _O(i,t)}(n,e)&&n.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){IV(this.form,this),this._oldForm&&_O(this._oldForm,this)}_checkFormPresent(){}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(vl,10),o.rXU(bx,10),o.rXU(rC,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","formGroup",""]],hostBindings:function(n,r){1&n&&o.bIt("submit",function(m){return r.onSubmit(m)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[o.Jv_([Are]),o.Vt3,o.OA$]})}}return i})();const Dre={provide:yu,useExisting:(0,o.Rfq)(()=>NV)};let NV=(()=>{class i extends iH{constructor(e,n,r){super(),this.name=null,this._parent=e,this._setValidators(n),this._setAsyncValidators(r)}_checkParentType(){cH(this._parent)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(yu,13),o.rXU(vl,10),o.rXU(bx,10))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},features:[o.Jv_([Dre]),o.Vt3]})}}return i})();const kre={provide:yu,useExisting:(0,o.Rfq)(()=>bO)};let bO=(()=>{class i extends yu{constructor(e,n,r){super(),this.name=null,this._parent=e,this._setValidators(n),this._setAsyncValidators(r)}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return mO(null==this.name?this.name:this.name.toString(),this._parent)}_checkParentType(){cH(this._parent)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(yu,13),o.rXU(vl,10),o.rXU(bx,10))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},features:[o.Jv_([kre]),o.Vt3]})}}return i})();function cH(i){return!(i instanceof NV||i instanceof Fb||i instanceof bO)}const Ire={provide:dg,useExisting:(0,o.Rfq)(()=>Rk)};let Rk=(()=>{class i extends dg{set isDisabled(e){}static{this._ngModelWarningSentOnce=!1}constructor(e,n,r,l,m){super(),this._ngModelWarningConfig=m,this._added=!1,this.name=null,this.update=new o.bkB,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=OV(0,l)}ngOnChanges(e){this._added||this._setUpControl(),PV(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return mO(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(yu,13),o.rXU(vl,10),o.rXU(bx,10),o.rXU(Ya,10),o.rXU(FV,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[o.Jv_([Ire]),o.Vt3,o.OA$]})}}return i})(),oC=(()=>{class i{constructor(){this._validator=sO}ngOnChanges(e){if(this.inputName in e){const n=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(n),this._validator=this._enabled?this.createValidator(n):sO,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,features:[o.OA$]})}}return i})();const zre={provide:vl,useExisting:(0,o.Rfq)(()=>yO),multi:!0};let yO=(()=>{class i extends oC{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=o.L39,this.createValidator=e=>S8}enabled(e){return e}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,r){2&n&&o.BMQ("required",r._enabled?"":null)},inputs:{required:"required"},features:[o.Jv_([zre]),o.Vt3]})}}return i})(),yH=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({})}}return i})();class zV extends fO{constructor(t,e,n){super(DV(e),kV(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,n={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(t,e={}){let n=this._adjustIndex(t);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,n={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),e&&(this.controls.splice(r,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){Y8(this,0,t),t.forEach((n,r)=>{q8(this,!1,r),this.at(r).setValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((n,r)=>{this.at(r)&&this.at(r).patchValue(n,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,n)=>!!n._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function xH(i){return!!i&&(void 0!==i.asyncValidators||void 0!==i.validators||void 0!==i.updateOn)}let Wre=(()=>{class i{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new i;return e.useNonNullable=!0,e}group(e,n=null){const r=this._reduceControls(e);let l={};return xH(n)?l=n:null!==n&&(l.validators=n.validator,l.asyncValidators=n.asyncValidator),new nC(r,l)}record(e,n=null){const r=this._reduceControls(e);return new Z8(r,n)}control(e,n,r){let l={};return this.useNonNullable?(xH(n)?l=n:(l.validators=n,l.asyncValidators=r),new df(e,{...l,nonNullable:!0})):new df(e,n,r)}array(e,n,r){const l=e.map(m=>this._createControl(m));return new zV(l,n,r)}_reduceControls(e){const n={};return Object.keys(e).forEach(r=>{n[r]=this._createControl(e[r])}),n}_createControl(e){return e instanceof df||e instanceof fO?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Pk=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:rC,useValue:e.callSetDisabledState??Dk}]}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[yH]})}}return i})(),wO=(()=>{class i{static withConfig(e){return{ngModule:i,providers:[{provide:FV,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:rC,useValue:e.callSetDisabledState??Dk}]}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[yH]})}}return i})();class qre{constructor(t){this._box=t,this._destroyed=new xi.B,this._resizeSubject=new xi.B,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(e=>this._resizeSubject.next(e)))}observe(t){return this._elementObservables.has(t)||this._elementObservables.set(t,new Ai.c(e=>{const n=this._resizeSubject.subscribe(e);return this._resizeObserver?.observe(t,{box:this._box}),()=>{this._resizeObserver?.unobserve(t),n.unsubscribe(),this._elementObservables.delete(t)}}).pipe(Ur(e=>e.some(n=>n.target===t)),function Xre(i,t,e){let n,r=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:t=1/0,refCount:r=!1,scheduler:e}=i):n=i??1/0,p_({connector:()=>new Sm(n,t,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}({bufferSize:1,refCount:!0}),dn(this._destroyed))),this._elementObservables.get(t)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}}let wH=(()=>{class i{constructor(){this._observers=new Map,this._ngZone=(0,o.WQX)(o.SKi)}ngOnDestroy(){for(const[,e]of this._observers)e.destroy();this._observers.clear()}observe(e,n){const r=n?.box||"content-box";return this._observers.has(r)||this._observers.set(r,new qre(r)),this._observers.get(r).observe(e)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const Yre=["notch"],Zre=["matFormFieldNotchedOutline",""],Kre=["*"],Qre=["textField"],Jre=["iconPrefixContainer"],eoe=["textPrefixContainer"],toe=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],ioe=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function noe(i,t){1&i&&o.nrm(0,"span",19)}function roe(i,t){if(1&i&&(o.j41(0,"label",18),o.SdG(1,1),o.DNE(2,noe,1,0,"span",19),o.k0s()),2&i){const e=o.XpG(2);o.Y8G("floating",e._shouldLabelFloat())("monitorResize",e._hasOutline())("id",e._labelId),o.BMQ("for",e._control.disableAutomaticLabeling?null:e._control.id),o.R7$(2),o.vxM(!e.hideRequiredMarker&&e._control.required?2:-1)}}function ooe(i,t){if(1&i&&o.DNE(0,roe,3,5,"label",18),2&i){const e=o.XpG();o.vxM(e._hasFloatingLabel()?0:-1)}}function soe(i,t){1&i&&o.nrm(0,"div",5)}function aoe(i,t){}function loe(i,t){if(1&i&&o.DNE(0,aoe,0,0,"ng-template",11),2&i){o.XpG(2);const e=o.sdS(1);o.Y8G("ngTemplateOutlet",e)}}function coe(i,t){if(1&i&&(o.j41(0,"div",7),o.DNE(1,loe,1,1,null,11),o.k0s()),2&i){const e=o.XpG();o.Y8G("matFormFieldNotchedOutlineOpen",e._shouldLabelFloat()),o.R7$(),o.vxM(e._forceDisplayInfixLabel()?-1:1)}}function doe(i,t){1&i&&(o.j41(0,"div",8,2),o.SdG(2,2),o.k0s())}function uoe(i,t){1&i&&(o.j41(0,"div",9,3),o.SdG(2,3),o.k0s())}function hoe(i,t){}function foe(i,t){if(1&i&&o.DNE(0,hoe,0,0,"ng-template",11),2&i){o.XpG();const e=o.sdS(1);o.Y8G("ngTemplateOutlet",e)}}function moe(i,t){1&i&&(o.j41(0,"div",12),o.SdG(1,4),o.k0s())}function poe(i,t){1&i&&(o.j41(0,"div",13),o.SdG(1,5),o.k0s())}function goe(i,t){1&i&&o.nrm(0,"div",14)}function _oe(i,t){if(1&i&&(o.j41(0,"div",16),o.SdG(1,6),o.k0s()),2&i){const e=o.XpG();o.Y8G("@transitionMessages",e._subscriptAnimationState)}}function voe(i,t){if(1&i&&(o.j41(0,"mat-hint",20),o.EFF(1),o.k0s()),2&i){const e=o.XpG(2);o.Y8G("id",e._hintLabelId),o.R7$(),o.JRh(e.hintLabel)}}function boe(i,t){if(1&i&&(o.j41(0,"div",17),o.DNE(1,voe,2,2,"mat-hint",20),o.SdG(2,7),o.nrm(3,"div",21),o.SdG(4,8),o.k0s()),2&i){const e=o.XpG();o.Y8G("@transitionMessages",e._subscriptAnimationState),o.R7$(),o.vxM(e.hintLabel?1:-1)}}let Ok=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-label"]],standalone:!0})}}return i})(),yoe=0;const CH=new o.nKC("MatError");let EH=(()=>{class i{constructor(e,n){this.id="mat-mdc-error-"+yoe++,e||n.nativeElement.setAttribute("aria-live","polite")}static{this.\u0275fac=function(n){return new(n||i)(o.kS0("aria-live"),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-error"],["","matError",""]],hostAttrs:["aria-atomic","true",1,"mat-mdc-form-field-error","mat-mdc-form-field-bottom-align"],hostVars:1,hostBindings:function(n,r){2&n&&o.Mr5("id",r.id)},inputs:{id:"id"},standalone:!0,features:[o.Jv_([{provide:CH,useExisting:i}])]})}}return i})(),xoe=0,TH=(()=>{class i{constructor(){this.align="start",this.id="mat-mdc-hint-"+xoe++}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(n,r){2&n&&(o.Mr5("id",r.id),o.BMQ("align",null),o.AVh("mat-mdc-form-field-hint-end","end"===r.align))},inputs:{align:"align",id:"id"},standalone:!0})}}return i})();const SH=new o.nKC("MatPrefix");let woe=(()=>{class i{constructor(){this._isText=!1}set _isTextSelector(e){this._isText=!0}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matPrefix",""],["","matIconPrefix",""],["","matTextPrefix",""]],inputs:{_isTextSelector:[0,"matTextPrefix","_isTextSelector"]},standalone:!0,features:[o.Jv_([{provide:SH,useExisting:i}])]})}}return i})();const MH=new o.nKC("MatSuffix");let UV=(()=>{class i{constructor(){this._isText=!1}set _isTextSelector(e){this._isText=!0}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:[0,"matTextSuffix","_isTextSelector"]},standalone:!0,features:[o.Jv_([{provide:MH,useExisting:i}])]})}}return i})();const AH=new o.nKC("FloatingLabelParent");let DH=(()=>{class i{get floating(){return this._floating}set floating(e){this._floating=e,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(e){this._monitorResize=e,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(e){this._elementRef=e,this._floating=!1,this._monitorResize=!1,this._resizeObserver=(0,o.WQX)(wH),this._ngZone=(0,o.WQX)(o.SKi),this._parent=(0,o.WQX)(AH),this._resizeSubscription=new On.yU}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return function Coe(i){if(null!==i.offsetParent)return i.scrollWidth;const e=i.cloneNode(!0);e.style.setProperty("position","absolute"),e.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(e);const n=e.scrollWidth;return e.remove(),n}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(n,r){2&n&&o.AVh("mdc-floating-label--float-above",r.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0})}}return i})();const kH="mdc-line-ripple--active",CO="mdc-line-ripple--deactivating";let IH=(()=>{class i{constructor(e,n){this._elementRef=e,this._handleTransitionEnd=r=>{const l=this._elementRef.nativeElement.classList,m=l.contains(CO);"opacity"===r.propertyName&&m&&l.remove(kH,CO)},n.runOutsideAngular(()=>{e.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const e=this._elementRef.nativeElement.classList;e.remove(CO),e.add(kH)}deactivate(){this._elementRef.nativeElement.classList.add(CO)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.SKi))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0})}}return i})(),RH=(()=>{class i{constructor(e,n){this._elementRef=e,this._ngZone=n,this.open=!1}ngAfterViewInit(){const e=this._elementRef.nativeElement.querySelector(".mdc-floating-label");e?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(e.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>e.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(e){this._notch.nativeElement.style.width=this.open&&e?`calc(${e}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:""}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.SKi))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(n,r){if(1&n&&o.GBs(Yre,5),2&n){let l;o.mGM(l=o.lsd())&&(r._notch=l.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(n,r){2&n&&o.AVh("mdc-notched-outline--notched",r.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[o.aNF],attrs:Zre,ngContentSelectors:Kre,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(n,r){1&n&&(o.NAR(),o.nrm(0,"div",1),o.j41(1,"div",2,0),o.SdG(3),o.k0s(),o.nrm(4,"div",3))},encapsulation:2,changeDetection:0})}}return i})();const Eoe={transitionMessages:js("transitionMessages",[Lo("enter",gn({opacity:1,transform:"translateY(0%)"})),oo("void => enter",[gn({opacity:0,transform:"translateY(-5px)"}),co("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let EO=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i})}}return i})();const DS=new o.nKC("MatFormField"),Toe=new o.nKC("MAT_FORM_FIELD_DEFAULT_OPTIONS");let PH=0,Lk=(()=>{class i{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=Es(e)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(e){const n=this._appearance;this._appearance=e||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==n&&(this._needsOutlineLabelOffsetUpdate=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(e){this._subscriptSizing=e||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(e){this._explicitFormFieldControl=e}constructor(e,n,r,l,m,C,A,O){this._elementRef=e,this._changeDetectorRef=n,this._dir=l,this._platform=m,this._defaults=C,this._animationMode=A,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+PH++,this._hintLabelId="mat-mdc-hint-"+PH++,this._subscriptAnimationState="",this._destroyed=new xi.B,this._isFocused=null,this._needsOutlineLabelOffsetUpdate=!1,this._injector=(0,o.WQX)(o.zZn),C&&(C.appearance&&(this.appearance=C.appearance),this._hideRequiredMarker=!!C?.hideRequiredMarker,C.color&&(this.color=C.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${e.controlType}`),e.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(dn(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(e=>!e._isText),this._hasTextPrefix=!!this._prefixChildren.find(e=>e._isText),this._hasIconSuffix=!!this._suffixChildren.find(e=>!e._isText),this._hasTextSuffix=!!this._suffixChildren.find(e=>e._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Io(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0),(0,o.Tzd)(()=>{this._needsOutlineLabelOffsetUpdate&&(this._needsOutlineLabelOffsetUpdate=!1,this._updateOutlineLabelOffset())},{injector:this._injector}),this._dir.change.pipe(dn(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(e){const n=this._control?this._control.ngControl:null;return n&&n[e]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){this._hasOutline()&&this._floatingLabel&&this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth()):this._notchedOutline?._setNotchWidth(0)}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const n=this._hintChildren?this._hintChildren.find(l=>"start"===l.align):null,r=this._hintChildren?this._hintChildren.find(l=>"end"===l.align):null;n?e.push(n.id):this._hintLabel&&e.push(this._hintLabelId),r&&e.push(r.id)}else this._errorChildren&&e.push(...this._errorChildren.map(n=>n.id));this._control.setDescribedByIds(e)}}_updateOutlineLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return;const e=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(e.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdate=!0);const n=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,l=n?.getBoundingClientRect().width??0,m=r?.getBoundingClientRect().width??0;e.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${l+m}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const e=this._elementRef.nativeElement;if(e.getRootNode){const n=e.getRootNode();return n&&n!==e}return document.documentElement.contains(e)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(o.SKi),o.rXU(Us),o.rXU(wo),o.rXU(Toe,8),o.rXU(o.bc$,8),o.rXU(Nn))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-form-field"]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,Ok,5),o.wni(l,Ok,7),o.wni(l,EO,5),o.wni(l,SH,5),o.wni(l,MH,5),o.wni(l,CH,5),o.wni(l,TH,5)),2&n){let m;o.mGM(m=o.lsd())&&(r._labelChildNonStatic=m.first),o.mGM(m=o.lsd())&&(r._labelChildStatic=m.first),o.mGM(m=o.lsd())&&(r._formFieldControl=m.first),o.mGM(m=o.lsd())&&(r._prefixChildren=m),o.mGM(m=o.lsd())&&(r._suffixChildren=m),o.mGM(m=o.lsd())&&(r._errorChildren=m),o.mGM(m=o.lsd())&&(r._hintChildren=m)}},viewQuery:function(n,r){if(1&n&&(o.GBs(Qre,5),o.GBs(Jre,5),o.GBs(eoe,5),o.GBs(DH,5),o.GBs(RH,5),o.GBs(IH,5)),2&n){let l;o.mGM(l=o.lsd())&&(r._textField=l.first),o.mGM(l=o.lsd())&&(r._iconPrefixContainer=l.first),o.mGM(l=o.lsd())&&(r._textPrefixContainer=l.first),o.mGM(l=o.lsd())&&(r._floatingLabel=l.first),o.mGM(l=o.lsd())&&(r._notchedOutline=l.first),o.mGM(l=o.lsd())&&(r._lineRipple=l.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(n,r){2&n&&o.AVh("mat-mdc-form-field-label-always-float",r._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",r._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",r._hasIconSuffix)("mat-form-field-invalid",r._control.errorState)("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===r._animationMode)("mat-form-field-appearance-fill","fill"==r.appearance)("mat-form-field-appearance-outline","outline"==r.appearance)("mat-form-field-hide-placeholder",r._hasFloatingLabel()&&!r._shouldLabelFloat())("mat-focused",r._control.focused)("mat-primary","accent"!==r.color&&"warn"!==r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[o.Jv_([{provide:DS,useExisting:i},{provide:AH,useExisting:i}]),o.aNF],ngContentSelectors:ioe,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(n,r){if(1&n){const l=o.RV6();o.NAR(toe),o.DNE(0,ooe,1,1,"ng-template",null,0,o.C5r),o.j41(2,"div",4,1),o.bIt("click",function(C){return o.eBV(l),o.Njj(r._control.onContainerClick(C))}),o.DNE(4,soe,1,0,"div",5),o.j41(5,"div",6),o.DNE(6,coe,2,2,"div",7)(7,doe,3,0,"div",8)(8,uoe,3,0,"div",9),o.j41(9,"div",10),o.DNE(10,foe,1,1,null,11),o.SdG(11),o.k0s(),o.DNE(12,moe,2,0,"div",12)(13,poe,2,0,"div",13),o.k0s(),o.DNE(14,goe,1,0,"div",14),o.k0s(),o.j41(15,"div",15),o.DNE(16,_oe,2,1,"div",16)(17,boe,5,2,"div",17),o.k0s()}if(2&n){let l;o.R7$(2),o.AVh("mdc-text-field--filled",!r._hasOutline())("mdc-text-field--outlined",r._hasOutline())("mdc-text-field--no-label",!r._hasFloatingLabel())("mdc-text-field--disabled",r._control.disabled)("mdc-text-field--invalid",r._control.errorState),o.R7$(2),o.vxM(r._hasOutline()||r._control.disabled?-1:4),o.R7$(2),o.vxM(r._hasOutline()?6:-1),o.R7$(),o.vxM(r._hasIconPrefix?7:-1),o.R7$(),o.vxM(r._hasTextPrefix?8:-1),o.R7$(2),o.vxM(!r._hasOutline()||r._forceDisplayInfixLabel()?10:-1),o.R7$(2),o.vxM(r._hasTextSuffix?12:-1),o.R7$(),o.vxM(r._hasIconSuffix?13:-1),o.R7$(),o.vxM(r._hasOutline()?-1:14),o.R7$(),o.AVh("mat-mdc-form-field-subscript-dynamic-size","dynamic"===r.subscriptSizing),o.R7$(),o.vxM("error"===(l=r._getDisplayedMessages())?16:"hint"===l?17:-1)}},dependencies:[DH,RH,Nc,IH,TH],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[Eoe.transitionMessages]},changeDetection:0})}}return i})(),kS=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,os,kp,qn]})}}return i})();class FH{}function jV(i){return i&&"function"==typeof i.connect&&!(i instanceof Ps)}var Nb=function(i){return i[i.REPLACED=0]="REPLACED",i[i.INSERTED=1]="INSERTED",i[i.MOVED=2]="MOVED",i[i.REMOVED=3]="REMOVED",i}(Nb||{});const Fk=new o.nKC("_ViewRepeater");class NH{applyChanges(t,e,n,r,l){t.forEachOperation((m,C,A)=>{let O,z;if(null==m.previousIndex){const $=n(m,C,A);O=e.createEmbeddedView($.templateRef,$.context,$.index),z=Nb.INSERTED}else null==A?(e.remove(C),z=Nb.REMOVED):(O=e.get(C),e.move(O,A),z=Nb.MOVED);l&&l({context:O?.context,operation:z,record:m})})}detach(){}}class Nk{get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(t=!1,e,n=!0,r){this._multiple=t,this._emitChanges=n,this.compareWith=r,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new xi.B,e&&e.length&&(t?e.forEach(l=>this._markSelected(l)):this._markSelected(e[0]),this._selectedToEmit.length=0)}select(...t){this._verifyValueAssignment(t),t.forEach(n=>this._markSelected(n));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}deselect(...t){this._verifyValueAssignment(t),t.forEach(n=>this._unmarkSelected(n));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}setSelection(...t){this._verifyValueAssignment(t);const e=this.selected,n=new Set(t);t.forEach(l=>this._markSelected(l)),e.filter(l=>!n.has(this._getConcreteValue(l,n))).forEach(l=>this._unmarkSelected(l));const r=this._hasQueuedChanges();return this._emitChangeEvent(),r}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();const e=this._hasQueuedChanges();return t&&this._emitChangeEvent(),e}isSelected(t){return this._selection.has(this._getConcreteValue(t))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){t=this._getConcreteValue(t),this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){t=this._getConcreteValue(t),this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(t,e){if(this.compareWith){e=e??this._selection;for(let n of e)if(this.compareWith(t,n))return n;return t}return t}}let GV=(()=>{class i{constructor(){this._listeners=[]}notify(e,n){for(let r of this._listeners)r(e,n)}listen(e){return this._listeners.push(e),()=>{this._listeners=this._listeners.filter(n=>e!==n)}}ngOnDestroy(){this._listeners=[]}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const Aoe=["trigger"],Doe=["panel"],koe=[[["mat-select-trigger"]],"*"],Ioe=["mat-select-trigger","*"];function Roe(i,t){if(1&i&&(o.j41(0,"span",4),o.EFF(1),o.k0s()),2&i){const e=o.XpG();o.R7$(),o.JRh(e.placeholder)}}function Poe(i,t){1&i&&o.SdG(0)}function Ooe(i,t){if(1&i&&(o.j41(0,"span",11),o.EFF(1),o.k0s()),2&i){const e=o.XpG(2);o.R7$(),o.JRh(e.triggerValue)}}function Loe(i,t){if(1&i&&(o.j41(0,"span",5),o.DNE(1,Poe,1,0)(2,Ooe,2,1,"span",11),o.k0s()),2&i){const e=o.XpG();o.R7$(),o.vxM(e.customTrigger?1:2)}}function Foe(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",12,1),o.bIt("@transformPanel.done",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._panelDoneAnimatingStream.next(r.toState))})("keydown",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._handleKeydown(r))}),o.SdG(2,1),o.k0s()}if(2&i){const e=o.XpG();o.ZvI("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",e._getPanelTheme(),""),o.Y8G("ngClass",e.panelClass)("@transformPanel","showing"),o.BMQ("id",e.id+"-panel")("aria-multiselectable",e.multiple)("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby())}}const Noe={transformPanelWrap:js("transformPanelWrap",[oo("* => void",s1("@transformPanel",[OI()],{optional:!0}))]),transformPanel:js("transformPanel",[Lo("void",gn({opacity:0,transform:"scale(1, 0.8)"})),oo("void => showing",co("120ms cubic-bezier(0, 0, 0.2, 1)",gn({opacity:1,transform:"scale(1, 1)"}))),oo("* => void",co("100ms linear",gn({opacity:0})))])};let VH=0;const zH=new o.nKC("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{const i=(0,o.WQX)(_l);return()=>i.scrollStrategies.reposition()}}),Voe=new o.nKC("MAT_SELECT_CONFIG"),zoe={provide:zH,deps:[_l],useFactory:function Boe(i){return()=>i.scrollStrategies.reposition()}},Uoe=new o.nKC("MatSelectTrigger");class joe{constructor(t,e){this.source=t,this.value=e}}let UH=(()=>{class i{_scrollOptionIntoView(e){const n=this.options.toArray()[e];if(n){const r=this.panel.nativeElement,l=s0(e,this.options,this.optionGroups),m=n._getHostElement();r.scrollTop=0===e&&1===l?0:h_(m.offsetTop,m.offsetHeight,r.scrollTop,r.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(e){return new joe(this,e)}get focused(){return this._focused||this._panelOpen}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._syncParentProperties()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(TS.required)??!1}set required(e){this._required=e,this.stateChanges.next()}get multiple(){return this._multiple}set multiple(e){this._multiple=e}get compareWith(){return this._compareWith}set compareWith(e){this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){this._assignValue(e)&&this._onChange(e)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(e){this._errorStateTracker.matcher=e}get id(){return this._id}set id(e){this._id=e||this._uid,this.stateChanges.next()}get errorState(){return this._errorStateTracker.errorState}set errorState(e){this._errorStateTracker.errorState=e}constructor(e,n,r,l,m,C,A,O,z,$,Q,te,de,fe){this._viewportRuler=e,this._changeDetectorRef=n,this._elementRef=m,this._dir=C,this._parentFormField=z,this.ngControl=$,this._liveAnnouncer=de,this._defaultOptions=fe,this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._panelOpen=!1,this._compareWith=(ge,Re)=>ge===Re,this._uid="mat-select-"+VH++,this._triggerAriaLabelledBy=null,this._destroy=new xi.B,this.stateChanges=new xi.B,this.disableAutomaticLabeling=!0,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+VH++,this._panelDoneAnimatingStream=new xi.B,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1,this._multiple=!1,this.disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto",this._initialized=new xi.B,this.optionSelectionChanges=ir(()=>{const ge=this.options;return ge?ge.changes.pipe(As(ge),So(()=>Io(...ge.map(Re=>Re.onSelectionChange)))):this._initialized.pipe(So(()=>this.optionSelectionChanges))}),this.openedChange=new o.bkB,this._openedStream=this.openedChange.pipe(Ur(ge=>ge),(0,st.T)(()=>{})),this._closedStream=this.openedChange.pipe(Ur(ge=>!ge),(0,st.T)(()=>{})),this.selectionChange=new o.bkB,this.valueChange=new o.bkB,this._trackedModal=null,this._skipPredicate=ge=>!this.panelOpen&&ge.disabled,this.ngControl&&(this.ngControl.valueAccessor=this),null!=fe?.typeaheadDebounceInterval&&(this.typeaheadDebounceInterval=fe.typeaheadDebounceInterval),this._errorStateTracker=new Qv(l,$,O,A,this.stateChanges),this._scrollStrategyFactory=te,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(Q)||0,this.id=this.id}ngOnInit(){this._selectionModel=new Nk(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(su(),dn(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen)),this._viewportRuler.change().pipe(dn(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}ngAfterContentInit(){this._initialized.next(),this._initialized.complete(),this._initKeyManager(),this._selectionModel.changed.pipe(dn(this._destroy)).subscribe(e=>{e.added.forEach(n=>n.select()),e.removed.forEach(n=>n.deselect())}),this.options.changes.pipe(As(null),dn(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const e=this._getTriggerAriaLabelledby(),n=this.ngControl;if(e!==this._triggerAriaLabelledBy){const r=this._elementRef.nativeElement;this._triggerAriaLabelledBy=e,e?r.setAttribute("aria-labelledby",e):r.removeAttribute("aria-labelledby")}n&&(this._previousControl!==n.control&&(void 0!==this._previousControl&&null!==n.disabled&&n.disabled!==this.disabled&&(this.disabled=n.disabled),this._previousControl=n.control),this.updateErrorState())}ngOnChanges(e){(e.disabled||e.userAriaDescribedBy)&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this.typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_applyModalPanelOwnership(){const e=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!e)return;const n=`${this.id}-panel`;this._trackedModal&&pm(this._trackedModal,"aria-owns",n),jh(e,"aria-owns",n),this._trackedModal=e}_clearFromModal(){this._trackedModal&&(pm(this._trackedModal,"aria-owns",`${this.id}-panel`),this._trackedModal=null)}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.stateChanges.next())}writeValue(e){this._assignValue(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const e=this._selectionModel.selected.map(n=>n.viewValue);return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}updateErrorState(){this._errorStateTracker.updateErrorState()}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}_handleClosedKeydown(e){const n=e.keyCode,r=40===n||38===n||37===n||39===n,l=13===n||32===n,m=this._keyManager;if(!m.isTyping()&&l&&!oa(e)||(this.multiple||e.altKey)&&r)e.preventDefault(),this.open();else if(!this.multiple){const C=this.selected;m.onKeydown(e);const A=this.selected;A&&C!==A&&this._liveAnnouncer.announce(A.viewValue,1e4)}}_handleOpenKeydown(e){const n=this._keyManager,r=e.keyCode,l=40===r||38===r,m=n.isTyping();if(l&&e.altKey)e.preventDefault(),this.close();else if(m||13!==r&&32!==r||!n.activeItem||oa(e))if(!m&&this._multiple&&65===r&&e.ctrlKey){e.preventDefault();const C=this.options.some(A=>!A.disabled&&!A.selected);this.options.forEach(A=>{A.disabled||(C?A.select():A.deselect())})}else{const C=n.activeItemIndex;n.onKeydown(e),this._multiple&&l&&e.shiftKey&&n.activeItem&&n.activeItemIndex!==C&&n.activeItem._selectViaInteraction()}else e.preventDefault(),n.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(gs(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(e){if(this.options.forEach(n=>n.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&e)Array.isArray(e),e.forEach(n=>this._selectOptionByValue(n)),this._sortValues();else{const n=this._selectOptionByValue(e);n?this._keyManager.updateActiveItem(n):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(e){const n=this.options.find(r=>{if(this._selectionModel.isSelected(r))return!1;try{return null!=r.value&&this._compareWith(r.value,e)}catch{return!1}});return n&&this._selectionModel.select(n),n}_assignValue(e){return!!(e!==this._value||this._multiple&&Array.isArray(e))&&(this.options&&this._setSelectionByValue(e),this._value=e,!0)}_getOverlayWidth(e){return"auto"===this.panelWidth?(e instanceof iO?e.elementRef:e||this._elementRef).nativeElement.getBoundingClientRect().width:null===this.panelWidth?"":this.panelWidth}_syncParentProperties(){if(this.options)for(const e of this.options)e._changeDetectorRef.markForCheck()}_initKeyManager(){this._keyManager=new $r(this.options).withTypeAhead(this.typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const e=Io(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(dn(e)).subscribe(n=>{this._onSelect(n.source,n.isUserInput),n.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),Io(...this.options.map(n=>n._stateChanges)).pipe(dn(e)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(e,n){const r=this._selectionModel.isSelected(e);null!=e.value||this._multiple?(r!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),n&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),n&&this.focus())):(e.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(e.value)),r!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const e=this.options.toArray();this._selectionModel.sort((n,r)=>this.sortComparator?this.sortComparator(n,r,e):e.indexOf(n)-e.indexOf(r)),this.stateChanges.next()}}_propagateChanges(e){let n;n=this.multiple?this.selected.map(r=>r.value):this.selected?this.selected.value:e,this._value=n,this.valueChange.emit(n),this._onChange(n),this.selectionChange.emit(this._getChangeEvent(n)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let e=-1;for(let n=0;n<this.options.length;n++)if(!this.options.get(n).disabled){e=n;break}this._keyManager.setActiveItem(e)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(e){this._elementRef.nativeElement.focus(e)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();return this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();let n=(e?e+" ":"")+this._valueId;return this.ariaLabelledby&&(n+=" "+this.ariaLabelledby),n}_panelDoneAnimating(e){this.openedChange.emit(e)}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(_x),o.rXU(o.gRc),o.rXU(o.SKi),o.rXU(eh),o.rXU(o.aKT),o.rXU(Us,8),o.rXU(AS,8),o.rXU(Fb,8),o.rXU(DS,8),o.rXU(dg,10),o.kS0("tabindex"),o.rXU(zH),o.rXU(Ow),o.rXU(Voe,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-select"]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,Uoe,5),o.wni(l,Gp,5),o.wni(l,Ec,5)),2&n){let m;o.mGM(m=o.lsd())&&(r.customTrigger=m.first),o.mGM(m=o.lsd())&&(r.options=m),o.mGM(m=o.lsd())&&(r.optionGroups=m)}},viewQuery:function(n,r){if(1&n&&(o.GBs(Aoe,5),o.GBs(Doe,5),o.GBs(p8,5)),2&n){let l;o.mGM(l=o.lsd())&&(r.trigger=l.first),o.mGM(l=o.lsd())&&(r.panel=l.first),o.mGM(l=o.lsd())&&(r._overlayDir=l.first)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(n,r){1&n&&o.bIt("keydown",function(m){return r._handleKeydown(m)})("focus",function(){return r._onFocus()})("blur",function(){return r._onBlur()}),2&n&&(o.BMQ("id",r.id)("tabindex",r.disabled?-1:r.tabIndex)("aria-controls",r.panelOpen?r.id+"-panel":null)("aria-expanded",r.panelOpen)("aria-label",r.ariaLabel||null)("aria-required",r.required.toString())("aria-disabled",r.disabled.toString())("aria-invalid",r.errorState)("aria-activedescendant",r._getAriaActiveDescendant()),o.AVh("mat-mdc-select-disabled",r.disabled)("mat-mdc-select-invalid",r.errorState)("mat-mdc-select-required",r.required)("mat-mdc-select-empty",r.empty)("mat-mdc-select-multiple",r.multiple))},inputs:{userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",disabled:[2,"disabled","disabled",o.L39],disableRipple:[2,"disableRipple","disableRipple",o.L39],tabIndex:[2,"tabIndex","tabIndex",e=>null==e?0:(0,o.Udg)(e)],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",o.L39],placeholder:"placeholder",required:[2,"required","required",o.L39],multiple:[2,"multiple","multiple",o.L39],disableOptionCentering:[2,"disableOptionCentering","disableOptionCentering",o.L39],compareWith:"compareWith",value:"value",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:[2,"typeaheadDebounceInterval","typeaheadDebounceInterval",o.Udg],sortComparator:"sortComparator",id:"id",panelWidth:"panelWidth"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],standalone:!0,features:[o.Jv_([{provide:EO,useExisting:i},{provide:Up,useExisting:i}]),o.GFd,o.OA$,o.aNF],ngContentSelectors:Ioe,decls:11,vars:8,consts:[["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],["panel",""],["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],[1,"mat-mdc-select-value"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"backdropClick","attach","detach","cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"keydown","ngClass"]],template:function(n,r){if(1&n){const l=o.RV6();o.NAR(koe),o.j41(0,"div",2,0),o.bIt("click",function(){return o.eBV(l),o.Njj(r.open())}),o.j41(3,"div",3),o.DNE(4,Roe,2,1,"span",4)(5,Loe,3,1,"span",5),o.k0s(),o.j41(6,"div",6)(7,"div",7),o.qSk(),o.j41(8,"svg",8),o.nrm(9,"path",9),o.k0s()()()(),o.DNE(10,Foe,3,9,"ng-template",10),o.bIt("backdropClick",function(){return o.eBV(l),o.Njj(r.close())})("attach",function(){return o.eBV(l),o.Njj(r._onAttached())})("detach",function(){return o.eBV(l),o.Njj(r.close())})}if(2&n){const l=o.sdS(1);o.R7$(3),o.BMQ("id",r._valueId),o.R7$(),o.vxM(r.empty?4:5),o.R7$(6),o.Y8G("cdkConnectedOverlayPanelClass",r._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",r._scrollStrategy)("cdkConnectedOverlayOrigin",r._preferredOverlayOrigin||l)("cdkConnectedOverlayOpen",r.panelOpen)("cdkConnectedOverlayPositions",r._positions)("cdkConnectedOverlayWidth",r._overlayWidth)}},dependencies:[iO,p8,Hm],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color);font-family:var(--mat-select-trigger-text-font);line-height:var(--mat-select-trigger-text-line-height);font-size:var(--mat-select-trigger-text-size);font-weight:var(--mat-select-trigger-text-weight);letter-spacing:var(--mat-select-trigger-text-tracking)}div.mat-mdc-select-panel{box-shadow:var(--mat-select-container-elevation-shadow)}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color)}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow,.mat-form-field-invalid:not(.mat-form-field-disabled) .mat-mdc-form-field-infix::after{color:var(--mat-select-invalid-arrow-color)}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color)}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color)}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color)}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}div.mat-mdc-select-panel{width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color)}.cdk-high-contrast-active div.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}div.mat-mdc-select-panel .mat-mdc-option{--mdc-list-list-item-container-color: var(--mat-select-panel-background-color)}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:var(--mat-select-arrow-transform)}'],encapsulation:2,data:{animation:[Noe.transformPanel]},changeDetection:0})}}return i})(),jH=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[zoe],imports:[os,ES,rb,qn,Lb,kS,rb,qn]})}}return i})();const Goe=["tooltip"],HH=new o.nKC("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{const i=(0,o.WQX)(_l);return()=>i.scrollStrategies.reposition({scrollThrottle:20})}}),$oe={provide:HH,deps:[_l],useFactory:function Hoe(i){return()=>i.scrollStrategies.reposition({scrollThrottle:20})}},Xoe=new o.nKC("mat-tooltip-default-options",{providedIn:"root",factory:function Woe(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),$H="tooltip-panel",WH=Ql({passive:!0});let HV=(()=>{class i{get position(){return this._position}set position(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(e){this._positionAtOrigin=Es(e),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(e){this._disabled=Es(e),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=au(e)}get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=au(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=e?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(e,n,r,l,m,C,A,O,z,$,Q,te){this._overlay=e,this._elementRef=n,this._scrollDispatcher=r,this._viewContainerRef=l,this._ngZone=m,this._platform=C,this._ariaDescriber=A,this._focusMonitor=O,this._dir=$,this._defaultOptions=Q,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._tooltipComponent=Qoe,this._viewportMargin=8,this._cssClassPrefix="mat-mdc",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new xi.B,this._injector=(0,o.WQX)(o.zZn),this._scrollStrategy=z,this._document=te,Q&&(this._showDelay=Q.showDelay,this._hideDelay=Q.hideDelay,Q.position&&(this.position=Q.position),Q.positionAtOrigin&&(this.positionAtOrigin=Q.positionAtOrigin),Q.touchGestures&&(this.touchGestures=Q.touchGestures)),$.change.pipe(dn(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=8}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(dn(this._destroyed)).subscribe(e=>{e?"keyboard"===e&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const e=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([n,r])=>{e.removeEventListener(n,r,WH)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay,n){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const r=this._createOverlay(n);this._detach(),this._portal=this._portal||new xS(this._tooltipComponent,this._viewContainerRef);const l=this._tooltipInstance=r.attach(this._portal).instance;l._triggerElement=this._elementRef.nativeElement,l._mouseLeaveHideDelay=this._hideDelay,l.afterHidden().pipe(dn(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),l.show(e)}hide(e=this.hideDelay){const n=this._tooltipInstance;n&&(n.isVisible()?n.hide(e):(n._cancelPendingAnimations(),this._detach()))}toggle(e){this._isTooltipVisible()?this.hide():this.show(void 0,e)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(e){if(this._overlayRef){const l=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!e)&&l._origin instanceof o.aKT)return this._overlayRef;this._detach()}const n=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&e||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(n);return r.positionChanges.pipe(dn(this._destroyed)).subscribe(l=>{this._updateCurrentPositionClass(l.connectionPair),this._tooltipInstance&&l.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${$H}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(dn(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(dn(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(dn(this._destroyed)).subscribe(l=>{this._isTooltipVisible()&&27===l.keyCode&&!oa(l)&&(l.preventDefault(),l.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){const n=e.getConfig().positionStrategy,r=this._getOrigin(),l=this._getOverlayPosition();n.withPositions([this._addOffset({...r.main,...l.main}),this._addOffset({...r.fallback,...l.fallback})])}_addOffset(e){const r=!this._dir||"ltr"==this._dir.value;return"top"===e.originY?e.offsetY=-8:"bottom"===e.originY?e.offsetY=8:"start"===e.originX?e.offsetX=r?-8:8:"end"===e.originX&&(e.offsetX=r?8:-8),e}_getOrigin(){const e=!this._dir||"ltr"==this._dir.value,n=this.position;let r;"above"==n||"below"==n?r={originX:"center",originY:"above"==n?"top":"bottom"}:"before"==n||"left"==n&&e||"right"==n&&!e?r={originX:"start",originY:"center"}:("after"==n||"right"==n&&e||"left"==n&&!e)&&(r={originX:"end",originY:"center"});const{x:l,y:m}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:l,originY:m}}}_getOverlayPosition(){const e=!this._dir||"ltr"==this._dir.value,n=this.position;let r;"above"==n?r={overlayX:"center",overlayY:"bottom"}:"below"==n?r={overlayX:"center",overlayY:"top"}:"before"==n||"left"==n&&e||"right"==n&&!e?r={overlayX:"end",overlayY:"center"}:("after"==n||"right"==n&&e||"left"==n&&!e)&&(r={overlayX:"start",overlayY:"center"});const{x:l,y:m}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:l,overlayY:m}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),(0,o.mal)(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,n){return"above"===this.position||"below"===this.position?"top"===n?n="bottom":"bottom"===n&&(n="top"):"end"===e?e="start":"start"===e&&(e="end"),{x:e,y:n}}_updateCurrentPositionClass(e){const{overlayY:n,originX:r,originY:l}=e;let m;if(m="center"===n?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===n&&"top"===l?"above":"below",m!==this._currentPosition){const C=this._overlayRef;if(C){const A=`${this._cssClassPrefix}-${$H}-`;C.removePanelClass(A+this._currentPosition),C.addPanelClass(A+m)}this._currentPosition=m}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",e=>{let n;this._setupPointerExitEventsIfNeeded(),void 0!==e.x&&void 0!==e.y&&(n=e),this.show(void 0,n)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",e=>{const n=e.targetTouches?.[0],r=n?{x:n.clientX,y:n.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(void 0,r),this._defaultOptions.touchLongPressShowDelay??500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",n=>{const r=n.relatedTarget;(!r||!this._overlayRef?.overlayElement.contains(r))&&this.hide()}],["wheel",n=>this._wheelListener(n)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const n=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};e.push(["touchend",n],["touchcancel",n])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([n,r])=>{this._elementRef.nativeElement.addEventListener(n,r,WH)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){const n=this._document.elementFromPoint(e.clientX,e.clientY),r=this._elementRef.nativeElement;n!==r&&!r.contains(n)&&this.hide()}}_disableNativeGesturesIfNecessary(){const e=this.touchGestures;if("off"!==e){const n=this._elementRef.nativeElement,r=n.style;("on"===e||"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===e||!n.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(_l),o.rXU(o.aKT),o.rXU(Ek),o.rXU(o.c1b),o.rXU(o.SKi),o.rXU(wo),o.rXU(Uv),o.rXU(Kc),o.rXU(HH),o.rXU(Us),o.rXU(Xoe,8),o.rXU(Nn))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(n,r){2&n&&o.AVh("mat-mdc-tooltip-disabled",r.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"],standalone:!0})}}return i})(),Qoe=(()=>{class i{constructor(e,n,r){this._changeDetectorRef=e,this._elementRef=n,this._isMultiline=!1,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new xi.B,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide",this._animationsDisabled="NoopAnimations"===r}show(e){null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const e=this._elementRef.nativeElement.getBoundingClientRect();return e.height>24&&e.width>=200}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_cancelPendingAnimations(){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){const n=this._tooltip.nativeElement,r=this._showAnimation,l=this._hideAnimation;if(n.classList.remove(e?l:r),n.classList.add(e?r:l),this._isVisible!==e&&(this._isVisible=e,this._changeDetectorRef.markForCheck()),e&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const m=getComputedStyle(n);("0s"===m.getPropertyValue("animation-duration")||"none"===m.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(n.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.rXU(o.aKT),o.rXU(o.bc$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-tooltip-component"]],viewQuery:function(n,r){if(1&n&&o.GBs(Goe,7),2&n){let l;o.mGM(l=o.lsd())&&(r._tooltip=l.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(n,r){1&n&&o.bIt("mouseleave",function(m){return r._handleMouseLeave(m)}),2&n&&o.xc7("zoom",r.isVisible()?1:null)},standalone:!0,features:[o.aNF],decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(n,r){if(1&n){const l=o.RV6();o.j41(0,"div",1,0),o.bIt("animationend",function(C){return o.eBV(l),o.Njj(r._handleAnimationEnd(C))}),o.j41(2,"div",2),o.EFF(3),o.k0s()()}2&n&&(o.AVh("mdc-tooltip--multiline",r._isMultiline),o.Y8G("ngClass",r.tooltipClass),o.R7$(3),o.JRh(r.message))},dependencies:[Hm],styles:['.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color);color:var(--mdc-plain-tooltip-supporting-text-color);border-radius:var(--mdc-plain-tooltip-container-shape);font-family:var(--mdc-plain-tooltip-supporting-text-font);font-size:var(--mdc-plain-tooltip-supporting-text-size);font-weight:var(--mdc-plain-tooltip-supporting-text-weight);line-height:var(--mdc-plain-tooltip-supporting-text-line-height);letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking)}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}}return i})(),TO=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[$oe],imports:[ec,os,ES,qn,qn,Lb]})}}return i})();function Joe(i,t){if(1&i&&(o.j41(0,"mat-option",17),o.EFF(1),o.k0s()),2&i){const e=t.$implicit;o.Y8G("value",e),o.R7$(),o.SpI(" ",e," ")}}function ese(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-form-field",14)(1,"mat-select",16,0),o.bIt("selectionChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l._changePageSize(r.value))}),o.Z7z(3,Joe,2,2,"mat-option",17,o.fX1),o.k0s(),o.j41(5,"div",18),o.bIt("click",function(){o.eBV(e);const r=o.sdS(2);return o.Njj(r.open())}),o.k0s()()}if(2&i){const e=o.XpG(2);o.Y8G("appearance",e._formFieldAppearance)("color",e.color),o.R7$(),o.Y8G("value",e.pageSize)("disabled",e.disabled)("aria-labelledby",e._pageSizeLabelId)("panelClass",e.selectConfig.panelClass||"")("disableOptionCentering",e.selectConfig.disableOptionCentering),o.R7$(2),o.Dyx(e._displayedPageSizeOptions)}}function tse(i,t){if(1&i&&(o.j41(0,"div",15),o.EFF(1),o.k0s()),2&i){const e=o.XpG(2);o.R7$(),o.JRh(e.pageSize)}}function ise(i,t){if(1&i&&(o.j41(0,"div",3)(1,"div",13),o.EFF(2),o.k0s(),o.DNE(3,ese,6,7,"mat-form-field",14)(4,tse,2,1,"div",15),o.k0s()),2&i){const e=o.XpG();o.R7$(),o.BMQ("id",e._pageSizeLabelId),o.R7$(),o.SpI(" ",e._intl.itemsPerPageLabel," "),o.R7$(),o.vxM(e._displayedPageSizeOptions.length>1?3:-1),o.R7$(),o.vxM(e._displayedPageSizeOptions.length<=1?4:-1)}}function nse(i,t){if(1&i){const e=o.RV6();o.j41(0,"button",19),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.firstPage())}),o.qSk(),o.j41(1,"svg",8),o.nrm(2,"path",20),o.k0s()()}if(2&i){const e=o.XpG();o.Y8G("matTooltip",e._intl.firstPageLabel)("matTooltipDisabled",e._previousButtonsDisabled())("matTooltipPosition","above")("disabled",e._previousButtonsDisabled()),o.BMQ("aria-label",e._intl.firstPageLabel)}}function rse(i,t){if(1&i){const e=o.RV6();o.j41(0,"button",21),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.lastPage())}),o.qSk(),o.j41(1,"svg",8),o.nrm(2,"path",22),o.k0s()()}if(2&i){const e=o.XpG();o.Y8G("matTooltip",e._intl.lastPageLabel)("matTooltipDisabled",e._nextButtonsDisabled())("matTooltipPosition","above")("disabled",e._nextButtonsDisabled()),o.BMQ("aria-label",e._intl.lastPageLabel)}}let SO=(()=>{class i{constructor(){this.changes=new xi.B,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(e,n,r)=>{if(0==r||0==n)return`0 of ${r}`;const l=e*n;return`${l+1} \u2013 ${l<(r=Math.max(r,0))?Math.min(l+n,r):l+n} of ${r}`}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const sse={provide:SO,deps:[[new o.Xx1,new o.kdw,SO]],useFactory:function ose(i){return i||new SO}};class XH{}const lse=new o.nKC("MAT_PAGINATOR_DEFAULT_OPTIONS");let cse=0,$V=(()=>{class i{get pageIndex(){return this._pageIndex}set pageIndex(e){this._pageIndex=Math.max(e||0,0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(e){this._length=e||0,this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(e){this._pageSize=Math.max(e||0,0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(e){this._pageSizeOptions=(e||[]).map(n=>(0,o.Udg)(n,0)),this._updateDisplayedPageSizeOptions()}constructor(e,n,r){if(this._intl=e,this._changeDetectorRef=n,this._pageSizeLabelId="mat-paginator-page-size-label-"+cse++,this._isInitialized=!1,this._initializedStream=new Sm(1),this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this.hidePageSize=!1,this.showFirstLastButtons=!1,this.selectConfig={},this.disabled=!1,this.page=new o.bkB,this.initialized=this._initializedStream,this._intlChanges=e.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),r){const{pageSize:l,pageSizeOptions:m,hidePageSize:C,showFirstLastButtons:A}=r;null!=l&&(this._pageSize=l),null!=m&&(this._pageSizeOptions=m),null!=C&&(this.hidePageSize=C),null!=A&&(this.showFirstLastButtons=A)}this._formFieldAppearance=r?.formFieldAppearance||"outline"}ngOnInit(){this._isInitialized=!0,this._updateDisplayedPageSizeOptions(),this._initializedStream.next()}ngOnDestroy(){this._initializedStream.complete(),this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;const e=this.pageIndex;this.pageIndex=this.pageIndex+1,this._emitPageEvent(e)}previousPage(){if(!this.hasPreviousPage())return;const e=this.pageIndex;this.pageIndex=this.pageIndex-1,this._emitPageEvent(e)}firstPage(){if(!this.hasPreviousPage())return;const e=this.pageIndex;this.pageIndex=0,this._emitPageEvent(e)}lastPage(){if(!this.hasNextPage())return;const e=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(e)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const e=this.getNumberOfPages()-1;return this.pageIndex<e&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(e){const r=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/e)||0,this.pageSize=e,this._emitPageEvent(r)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._isInitialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((e,n)=>e-n),this._changeDetectorRef.markForCheck())}_emitPageEvent(e){this.page.emit({previousPageIndex:e,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(SO),o.rXU(o.gRc),o.rXU(lse,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{color:"color",pageIndex:[2,"pageIndex","pageIndex",o.Udg],length:[2,"length","length",o.Udg],pageSize:[2,"pageSize","pageSize",o.Udg],pageSizeOptions:"pageSizeOptions",hidePageSize:[2,"hidePageSize","hidePageSize",o.L39],showFirstLastButtons:[2,"showFirstLastButtons","showFirstLastButtons",o.L39],selectConfig:"selectConfig",disabled:[2,"disabled","disabled",o.L39]},outputs:{page:"page"},exportAs:["matPaginator"],standalone:!0,features:[o.GFd,o.aNF],decls:14,vars:14,consts:[["selectRef",""],[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-previous",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-next",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],[1,"mat-mdc-paginator-page-size-label"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],[1,"mat-mdc-paginator-page-size-value"],["hideSingleSelectionIndicator","",3,"selectionChange","value","disabled","aria-labelledby","panelClass","disableOptionCentering"],[3,"value"],[1,"mat-mdc-paginator-touch-target",3,"click"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(n,r){1&n&&(o.j41(0,"div",1)(1,"div",2),o.DNE(2,ise,5,4,"div",3),o.j41(3,"div",4)(4,"div",5),o.EFF(5),o.k0s(),o.DNE(6,nse,3,5,"button",6),o.j41(7,"button",7),o.bIt("click",function(){return r.previousPage()}),o.qSk(),o.j41(8,"svg",8),o.nrm(9,"path",9),o.k0s()(),o.joV(),o.j41(10,"button",10),o.bIt("click",function(){return r.nextPage()}),o.qSk(),o.j41(11,"svg",8),o.nrm(12,"path",11),o.k0s()(),o.DNE(13,rse,3,5,"button",12),o.k0s()()()),2&n&&(o.R7$(2),o.vxM(r.hidePageSize?-1:2),o.R7$(3),o.SpI(" ",r._intl.getRangeLabel(r.pageIndex,r.pageSize,r.length)," "),o.R7$(),o.vxM(r.showFirstLastButtons?6:-1),o.R7$(),o.Y8G("matTooltip",r._intl.previousPageLabel)("matTooltipDisabled",r._previousButtonsDisabled())("matTooltipPosition","above")("disabled",r._previousButtonsDisabled()),o.BMQ("aria-label",r._intl.previousPageLabel),o.R7$(3),o.Y8G("matTooltip",r._intl.nextPageLabel)("matTooltipDisabled",r._nextButtonsDisabled())("matTooltipPosition","above")("disabled",r._nextButtonsDisabled()),o.BMQ("aria-label",r._intl.nextPageLabel),o.R7$(3),o.vxM(r.showFirstLastButtons?13:-1))},dependencies:[Lk,UH,Gp,mu,HV],styles:[".mat-mdc-paginator{display:block;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-paginator-container-text-color);background-color:var(--mat-paginator-container-background-color);font-family:var(--mat-paginator-container-text-font);line-height:var(--mat-paginator-container-text-line-height);font-size:var(--mat-paginator-container-text-size);font-weight:var(--mat-paginator-container-text-weight);letter-spacing:var(--mat-paginator-container-text-tracking);--mat-form-field-container-height:var(--mat-paginator-form-field-container-height);--mat-form-field-container-vertical-padding:var(--mat-paginator-form-field-container-vertical-padding)}.mat-mdc-paginator .mat-mdc-select-value{font-size:var(--mat-paginator-select-trigger-text-size)}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap;width:100%;min-height:var(--mat-paginator-container-size)}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px;fill:var(--mat-paginator-enabled-icon-color)}.mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon{fill:var(--mat-paginator-disabled-icon-color)}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}.cdk-high-contrast-active .mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon,.cdk-high-contrast-active .mat-mdc-paginator-icon{fill:currentColor;fill:CanvasText}.cdk-high-contrast-active .mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}.mat-mdc-paginator-touch-target{display:var(--mat-paginator-touch-target-display);position:absolute;top:50%;left:50%;width:84px;height:48px;background-color:rgba(0,0,0,0);transform:translate(-50%, -50%);cursor:pointer}"],encapsulation:2,changeDetection:0})}}return i})(),qH=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[sse],imports:[ea,jH,TO,$V]})}}return i})();const dse=["input"],use=["formField"],hse=["*"];let YH=0;class ZH{constructor(t,e){this.source=t,this.value=e}}const fse={provide:Ya,useExisting:(0,o.Rfq)(()=>QH),multi:!0},KH=new o.nKC("MatRadioGroup"),mse=new o.nKC("mat-radio-default-options",{providedIn:"root",factory:function pse(){return{color:"accent"}}});let QH=(()=>{class i{get name(){return this._name}set name(e){this._name=e,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(e){this._labelPosition="before"===e?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(e){this._selected=e,this.value=e?e.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._markRadiosForCheck()}get required(){return this._required}set required(e){this._required=e,this._markRadiosForCheck()}constructor(e){this._changeDetector=e,this._value=null,this._name="mat-radio-group-"+YH++,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=()=>{},this.onTouched=()=>{},this.change=new o.bkB}ngAfterContentInit(){this._isInitialized=!0,this._buttonChanges=this._radios.changes.subscribe(()=>{this.selected&&!this._radios.find(e=>e===this.selected)&&(this._selected=null)})}ngOnDestroy(){this._buttonChanges?.unsubscribe()}_touch(){this.onTouched&&(this.onTouched(),this._changeDetector.markForCheck())}_updateRadioButtonNames(){this._radios&&this._radios.forEach(e=>{e.name=this.name,e._markForCheck()})}_updateSelectedRadioFromValue(){this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(n=>{n.checked=this.value===n.value,n.checked&&(this._selected=n)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new ZH(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(e=>e._markForCheck())}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetector.markForCheck()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-radio-group"]],contentQueries:function(n,r,l){if(1&n&&o.wni(l,WV,5),2&n){let m;o.mGM(m=o.lsd())&&(r._radios=m)}},hostAttrs:["role","radiogroup",1,"mat-mdc-radio-group"],inputs:{color:"color",name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:[2,"disabled","disabled",o.L39],required:[2,"required","required",o.L39]},outputs:{change:"change"},exportAs:["matRadioGroup"],standalone:!0,features:[o.Jv_([fse,{provide:KH,useExisting:i}]),o.GFd]})}}return i})(),WV=(()=>{class i{get checked(){return this._checked}set checked(e){this._checked!==e&&(this._checked=e,e&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!e&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),e&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===e),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(e){this._labelPosition=e}get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(e){this._setDisabled(e)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(e){this._required=e}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"}set color(e){this._color=e}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(e,n,r,l,m,C,A,O){this._elementRef=n,this._changeDetector=r,this._focusMonitor=l,this._radioDispatcher=m,this._providerOverride=A,this._uniqueId="mat-radio-"+ ++YH,this.id=this._uniqueId,this.disableRipple=!1,this.tabIndex=0,this.change=new o.bkB,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this._injector=(0,o.WQX)(o.zZn),this.radioGroup=e,this._noopAnimations="NoopAnimations"===C,O&&(this.tabIndex=(0,o.Udg)(O,0))}focus(e,n){n?this._focusMonitor.focusVia(this._inputElement,n,e):this._inputElement.nativeElement.focus(e)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((e,n)=>{e!==this.id&&n===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{!e&&this.radioGroup&&this.radioGroup._touch()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new ZH(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputClick(e){e.stopPropagation()}_onInputInteraction(e){if(e.stopPropagation(),!this.checked&&!this.disabled){const n=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),n&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(e){this._onInputInteraction(e),this.disabled||this._inputElement.nativeElement.focus()}_setDisabled(e){this._disabled!==e&&(this._disabled=e,this._changeDetector.markForCheck())}_updateTabIndex(){const e=this.radioGroup;let n;if(n=e&&e.selected&&!this.disabled?e.selected===this?this.tabIndex:-1:this.tabIndex,n!==this._previousTabIndex){const r=this._inputElement?.nativeElement;r&&(r.setAttribute("tabindex",n+""),this._previousTabIndex=n,(0,o.mal)(()=>{queueMicrotask(()=>{e&&e.selected&&e.selected!==this&&document.activeElement===r&&(e.selected?._inputElement.nativeElement.focus(),document.activeElement===r&&this._inputElement.nativeElement.blur())})},{injector:this._injector}))}}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(KH,8),o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(Kc),o.rXU(GV),o.rXU(o.bc$,8),o.rXU(mse,8),o.kS0("tabindex"))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-radio-button"]],viewQuery:function(n,r){if(1&n&&(o.GBs(dse,5),o.GBs(use,7,o.aKT)),2&n){let l;o.mGM(l=o.lsd())&&(r._inputElement=l.first),o.mGM(l=o.lsd())&&(r._rippleTrigger=l.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:15,hostBindings:function(n,r){1&n&&o.bIt("focus",function(){return r._inputElement.nativeElement.focus()}),2&n&&(o.BMQ("id",r.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),o.AVh("mat-primary","primary"===r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("mat-mdc-radio-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],disableRipple:[2,"disableRipple","disableRipple",o.L39],tabIndex:[2,"tabIndex","tabIndex",e=>null==e?0:(0,o.Udg)(e)],checked:[2,"checked","checked",o.L39],value:"value",labelPosition:"labelPosition",disabled:[2,"disabled","disabled",o.L39],required:[2,"required","required",o.L39],color:"color"},outputs:{change:"change"},exportAs:["matRadioButton"],standalone:!0,features:[o.GFd,o.aNF],ngContentSelectors:hse,decls:13,vars:16,consts:[["formField",""],["input",""],["mat-internal-form-field","",3,"labelPosition"],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"change","id","checked","disabled","required"],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(n,r){if(1&n){const l=o.RV6();o.NAR(),o.j41(0,"div",2,0)(2,"div",3)(3,"div",4),o.bIt("click",function(C){return o.eBV(l),o.Njj(r._onTouchTargetClick(C))}),o.k0s(),o.j41(4,"input",5,1),o.bIt("change",function(C){return o.eBV(l),o.Njj(r._onInputInteraction(C))}),o.k0s(),o.j41(6,"div",6),o.nrm(7,"div",7)(8,"div",8),o.k0s(),o.j41(9,"div",9),o.nrm(10,"div",10),o.k0s()(),o.j41(11,"label",11),o.SdG(12),o.k0s()()}2&n&&(o.Y8G("labelPosition",r.labelPosition),o.R7$(2),o.AVh("mdc-radio--disabled",r.disabled),o.R7$(2),o.Y8G("id",r.inputId)("checked",r.checked)("disabled",r.disabled)("required",r.required),o.BMQ("name",r.name)("value",r.value)("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby),o.R7$(5),o.Y8G("matRippleTrigger",r._rippleTrigger.nativeElement)("matRippleDisabled",r._isRippleDisabled())("matRippleCentered",!0),o.R7$(2),o.Y8G("for",r.inputId))},dependencies:[dl,sb],styles:['.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color;padding:calc((var(--mdc-radio-state-layer-size) - 20px)/2)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled])~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color)}.mat-mdc-radio-button .mdc-radio:active .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio:active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color)}.mat-mdc-radio-button .mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mat-mdc-radio-button .mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size);top:calc(-1*(var(--mdc-radio-state-layer-size) - 20px)/2);left:calc(-1*(var(--mdc-radio-state-layer-size) - 20px)/2)}.mat-mdc-radio-button .mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;top:0;right:0;left:0;cursor:inherit;z-index:1;width:var(--mdc-radio-state-layer-size);height:var(--mdc-radio-state-layer-size)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color);opacity:var(--mdc-radio-disabled-unselected-icon-opacity)}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{cursor:default}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color);opacity:var(--mdc-radio-disabled-selected-icon-opacity)}.mat-mdc-radio-button .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color)}.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color)}.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio--disabled{cursor:default;pointer-events:none}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color)}.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element{background-color:var(--mat-radio-checked-ripple-color)}.mat-mdc-radio-button .mat-internal-form-field{color:var(--mat-radio-label-text-color);font-family:var(--mat-radio-label-text-font);line-height:var(--mat-radio-label-text-line-height);font-size:var(--mat-radio-label-text-size);letter-spacing:var(--mat-radio-label-text-tracking);font-weight:var(--mat-radio-label-text-weight)}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color)}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple .mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, black)}.mat-mdc-radio-button.cdk-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-radio-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display)}[dir=rtl] .mat-mdc-radio-touch-target{left:auto;right:50%;transform:translate(50%, -50%)}'],encapsulation:2,changeDetection:0})}}return i})(),JH=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,os,ul,WV,qn]})}}return i})();const gse=[[["caption"]],[["colgroup"],["col"]],"*"],_se=["caption","colgroup, col","*"];function vse(i,t){1&i&&o.SdG(0,2)}function bse(i,t){1&i&&(o.j41(0,"thead",0),o.eu8(1,1),o.k0s(),o.j41(2,"tbody",0),o.eu8(3,2)(4,3),o.k0s(),o.j41(5,"tfoot",0),o.eu8(6,4),o.k0s())}function yse(i,t){1&i&&o.eu8(0,1)(1,2)(2,3)(3,4)}const j_=new o.nKC("CDK_TABLE");let IS=(()=>{class i{constructor(e){this.template=e}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkCellDef",""]],standalone:!0})}}return i})(),RS=(()=>{class i{constructor(e){this.template=e}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkHeaderCellDef",""]],standalone:!0})}}return i})(),MO=(()=>{class i{constructor(e){this.template=e}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkFooterCellDef",""]],standalone:!0})}}return i})(),Bb=(()=>{class i{get name(){return this._name}set name(e){this._setNameInput(e)}get sticky(){return this._sticky}set sticky(e){e!==this._sticky&&(this._sticky=e,this._hasStickyChanged=!0)}get stickyEnd(){return this._stickyEnd}set stickyEnd(e){e!==this._stickyEnd&&(this._stickyEnd=e,this._hasStickyChanged=!0)}constructor(e){this._table=e,this._hasStickyChanged=!1,this._sticky=!1,this._stickyEnd=!1}hasStickyChanged(){const e=this._hasStickyChanged;return this.resetStickyChanged(),e}resetStickyChanged(){this._hasStickyChanged=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(e){e&&(this._name=e,this.cssClassFriendlyName=e.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(j_,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkColumnDef",""]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,IS,5),o.wni(l,RS,5),o.wni(l,MO,5)),2&n){let m;o.mGM(m=o.lsd())&&(r.cell=m.first),o.mGM(m=o.lsd())&&(r.headerCell=m.first),o.mGM(m=o.lsd())&&(r.footerCell=m.first)}},inputs:{name:[0,"cdkColumnDef","name"],sticky:[2,"sticky","sticky",o.L39],stickyEnd:[2,"stickyEnd","stickyEnd",o.L39]},standalone:!0,features:[o.Jv_([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:i}]),o.GFd]})}}return i})();class XV{constructor(t,e){e.nativeElement.classList.add(...t._columnCssClassName)}}let qV=(()=>{class i extends XV{constructor(e,n){super(e,n)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(Bb),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],standalone:!0,features:[o.Vt3]})}}return i})(),e$=(()=>{class i extends XV{constructor(e,n){super(e,n);const r=e._table?._getCellRole();r&&n.nativeElement.setAttribute("role",r)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(Bb),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["cdk-footer-cell"],["td","cdk-footer-cell",""]],hostAttrs:[1,"cdk-footer-cell"],standalone:!0,features:[o.Vt3]})}}return i})(),YV=(()=>{class i extends XV{constructor(e,n){super(e,n);const r=e._table?._getCellRole();r&&n.nativeElement.setAttribute("role",r)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(Bb),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],standalone:!0,features:[o.Vt3]})}}return i})();class t${constructor(){this.tasks=[],this.endTasks=[]}}const ZV=new o.nKC("_COALESCED_STYLE_SCHEDULER");let i$=(()=>{class i{constructor(e){this._currentSchedule=null,this._ngZone=(0,o.WQX)(o.SKi)}schedule(e){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(e)}scheduleEnd(e){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(e)}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new t$,this._ngZone.runOutsideAngular(()=>queueMicrotask(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const e=this._currentSchedule;this._currentSchedule=new t$;for(const n of e.tasks)n();for(const n of e.endTasks)n()}this._currentSchedule=null})))}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(o.SKi))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})(),KV=(()=>{class i{constructor(e,n){this.template=e,this._differs=n}ngOnChanges(e){if(!this._columnsDiffer){const n=e.columns&&e.columns.currentValue||[];this._columnsDiffer=this._differs.find(n).create(),this._columnsDiffer.diff(n)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(e){return this instanceof Bk?e.headerCell.template:this instanceof Vk?e.footerCell.template:e.cell.template}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q),o.rXU(o._q3))}}static{this.\u0275dir=o.FsC({type:i,features:[o.OA$]})}}return i})(),Bk=(()=>{class i extends KV{get sticky(){return this._sticky}set sticky(e){e!==this._sticky&&(this._sticky=e,this._hasStickyChanged=!0)}constructor(e,n,r){super(e,n),this._table=r,this._hasStickyChanged=!1,this._sticky=!1}ngOnChanges(e){super.ngOnChanges(e)}hasStickyChanged(){const e=this._hasStickyChanged;return this.resetStickyChanged(),e}resetStickyChanged(){this._hasStickyChanged=!1}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q),o.rXU(o._q3),o.rXU(j_,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:[0,"cdkHeaderRowDef","columns"],sticky:[2,"cdkHeaderRowDefSticky","sticky",o.L39]},standalone:!0,features:[o.GFd,o.Vt3,o.OA$]})}}return i})(),Vk=(()=>{class i extends KV{get sticky(){return this._sticky}set sticky(e){e!==this._sticky&&(this._sticky=e,this._hasStickyChanged=!0)}constructor(e,n,r){super(e,n),this._table=r,this._hasStickyChanged=!1,this._sticky=!1}ngOnChanges(e){super.ngOnChanges(e)}hasStickyChanged(){const e=this._hasStickyChanged;return this.resetStickyChanged(),e}resetStickyChanged(){this._hasStickyChanged=!1}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q),o.rXU(o._q3),o.rXU(j_,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:[0,"cdkFooterRowDef","columns"],sticky:[2,"cdkFooterRowDefSticky","sticky",o.L39]},standalone:!0,features:[o.GFd,o.Vt3,o.OA$]})}}return i})(),AO=(()=>{class i extends KV{constructor(e,n,r){super(e,n),this._table=r}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q),o.rXU(o._q3),o.rXU(j_,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkRowDef",""]],inputs:{columns:[0,"cdkRowDefColumns","columns"],when:[0,"cdkRowDefWhen","when"]},standalone:!0,features:[o.Vt3]})}}return i})(),Vb=(()=>{class i{static{this.mostRecentCellOutlet=null}constructor(e){this._viewContainer=e,i.mostRecentCellOutlet=this}ngOnDestroy(){i.mostRecentCellOutlet===this&&(i.mostRecentCellOutlet=null)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.c1b))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","cdkCellOutlet",""]],standalone:!0})}}return i})(),QV=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],standalone:!0,features:[o.aNF],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,r){1&n&&o.eu8(0,0)},dependencies:[Vb],encapsulation:2})}}return i})(),JV=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["cdk-footer-row"],["tr","cdk-footer-row",""]],hostAttrs:["role","row",1,"cdk-footer-row"],standalone:!0,features:[o.aNF],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,r){1&n&&o.eu8(0,0)},dependencies:[Vb],encapsulation:2})}}return i})(),ez=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],standalone:!0,features:[o.aNF],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,r){1&n&&o.eu8(0,0)},dependencies:[Vb],encapsulation:2})}}return i})(),DO=(()=>{class i{constructor(e){this.templateRef=e,this._contentClassName="cdk-no-data-row"}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["ng-template","cdkNoDataRow",""]],standalone:!0})}}return i})();const n$=["top","bottom","left","right"];class Ese{constructor(t,e,n,r,l=!0,m=!0,C){this._isNativeHtmlTable=t,this._stickCellCss=e,this.direction=n,this._coalescedStyleScheduler=r,this._isBrowser=l,this._needsPositionStickyOnElement=m,this._positionListener=C,this._cachedCellWidths=[],this._borderCellCss={top:`${e}-border-elem-top`,bottom:`${e}-border-elem-bottom`,left:`${e}-border-elem-left`,right:`${e}-border-elem-right`}}clearStickyPositioning(t,e){const n=[];for(const r of t)if(r.nodeType===r.ELEMENT_NODE){n.push(r);for(let l=0;l<r.children.length;l++)n.push(r.children[l])}this._coalescedStyleScheduler.schedule(()=>{for(const r of n)this._removeStickyStyle(r,e)})}updateStickyColumns(t,e,n,r=!0){t.length&&this._isBrowser&&(e.some(l=>l)||n.some(l=>l))?this._coalescedStyleScheduler.schedule(()=>{const l=t[0],m=l.children.length,C=this._getCellWidths(l,r),A=this._getStickyStartColumnPositions(C,e),O=this._getStickyEndColumnPositions(C,n),z=e.lastIndexOf(!0),$=n.indexOf(!0),Q="rtl"===this.direction,te=Q?"right":"left",de=Q?"left":"right";for(const fe of t)for(let ge=0;ge<m;ge++){const Re=fe.children[ge];e[ge]&&this._addStickyStyle(Re,te,A[ge],ge===z),n[ge]&&this._addStickyStyle(Re,de,O[ge],ge===$)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===z?[]:C.slice(0,z+1).map((fe,ge)=>e[ge]?fe:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===$?[]:C.slice($).map((fe,ge)=>n[ge+$]?fe:null).reverse()}))}):this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]}))}stickRows(t,e,n){this._isBrowser&&this._coalescedStyleScheduler.schedule(()=>{const r="bottom"===n?t.slice().reverse():t,l="bottom"===n?e.slice().reverse():e,m=[],C=[],A=[];for(let z=0,$=0;z<r.length;z++){if(!l[z])continue;m[z]=$;const Q=r[z];A[z]=this._isNativeHtmlTable?Array.from(Q.children):[Q];const te=Q.getBoundingClientRect().height;$+=te,C[z]=te}const O=l.lastIndexOf(!0);for(let z=0;z<r.length;z++){if(!l[z])continue;const $=m[z],Q=z===O;for(const te of A[z])this._addStickyStyle(te,n,$,Q)}"top"===n?this._positionListener?.stickyHeaderRowsUpdated({sizes:C,offsets:m,elements:A}):this._positionListener?.stickyFooterRowsUpdated({sizes:C,offsets:m,elements:A})})}updateStickyFooterContainer(t,e){this._isNativeHtmlTable&&this._coalescedStyleScheduler.schedule(()=>{const n=t.querySelector("tfoot");n&&(e.some(r=>!r)?this._removeStickyStyle(n,["bottom"]):this._addStickyStyle(n,"bottom",0,!1))})}_removeStickyStyle(t,e){for(const r of e)t.style[r]="",t.classList.remove(this._borderCellCss[r]);n$.some(r=>-1===e.indexOf(r)&&t.style[r])?t.style.zIndex=this._getCalculatedZIndex(t):(t.style.zIndex="",this._needsPositionStickyOnElement&&(t.style.position=""),t.classList.remove(this._stickCellCss))}_addStickyStyle(t,e,n,r){t.classList.add(this._stickCellCss),r&&t.classList.add(this._borderCellCss[e]),t.style[e]=`${n}px`,t.style.zIndex=this._getCalculatedZIndex(t),this._needsPositionStickyOnElement&&(t.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(t){const e={top:100,bottom:10,left:1,right:1};let n=0;for(const r of n$)t.style[r]&&(n+=e[r]);return n?`${n}`:""}_getCellWidths(t,e=!0){if(!e&&this._cachedCellWidths.length)return this._cachedCellWidths;const n=[],r=t.children;for(let l=0;l<r.length;l++)n.push(r[l].getBoundingClientRect().width);return this._cachedCellWidths=n,n}_getStickyStartColumnPositions(t,e){const n=[];let r=0;for(let l=0;l<t.length;l++)e[l]&&(n[l]=r,r+=t[l]);return n}_getStickyEndColumnPositions(t,e){const n=[];let r=0;for(let l=t.length;l>0;l--)e[l]&&(n[l]=r,r+=t[l]);return n}}const tz=new o.nKC("CDK_SPL");let iz=(()=>{class i{constructor(e,n){this.viewContainer=e,this.elementRef=n;const r=(0,o.WQX)(j_);r._rowOutlet=this,r._outletAssigned()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.c1b),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","rowOutlet",""]],standalone:!0})}}return i})(),nz=(()=>{class i{constructor(e,n){this.viewContainer=e,this.elementRef=n;const r=(0,o.WQX)(j_);r._headerRowOutlet=this,r._outletAssigned()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.c1b),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","headerRowOutlet",""]],standalone:!0})}}return i})(),rz=(()=>{class i{constructor(e,n){this.viewContainer=e,this.elementRef=n;const r=(0,o.WQX)(j_);r._footerRowOutlet=this,r._outletAssigned()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.c1b),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","footerRowOutlet",""]],standalone:!0})}}return i})(),oz=(()=>{class i{constructor(e,n){this.viewContainer=e,this.elementRef=n;const r=(0,o.WQX)(j_);r._noDataRowOutlet=this,r._outletAssigned()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.c1b),o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","noDataRowOutlet",""]],standalone:!0})}}return i})(),kO=(()=>{class i{_getCellRole(){if(void 0===this._cellRoleInternal){const e=this._elementRef.nativeElement.getAttribute("role"),n="grid"===e||"treegrid"===e?"gridcell":"cell";this._cellRoleInternal=this._isNativeHtmlTable&&"cell"===n?null:n}return this._cellRoleInternal}get trackBy(){return this._trackByFn}set trackBy(e){this._trackByFn=e}get dataSource(){return this._dataSource}set dataSource(e){this._dataSource!==e&&this._switchDataSource(e)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(e){this._multiTemplateDataRows=e,this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(e){this._fixedLayout=e,this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(e,n,r,l,m,C,A,O,z,$,Q,te){this._differs=e,this._changeDetectorRef=n,this._elementRef=r,this._dir=m,this._platform=A,this._viewRepeater=O,this._coalescedStyleScheduler=z,this._viewportRuler=$,this._stickyPositioningListener=Q,this._onDestroy=new xi.B,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._hasAllOutlets=!1,this._hasInitialized=!1,this._cellRoleInternal=void 0,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new o.bkB,this.viewChange=new ro.t({start:0,end:Number.MAX_VALUE}),this._injector=(0,o.WQX)(o.zZn),l||r.nativeElement.setAttribute("role","table"),this._document=C,this._isServer=!A.isBrowser,this._isNativeHtmlTable="TABLE"===r.nativeElement.nodeName}ngOnInit(){this._setupStickyStyler(),this._dataDiffer=this._differs.find([]).create((e,n)=>this.trackBy?this.trackBy(n.dataIndex,n.data):n),this._viewportRuler.change().pipe(dn(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentInit(){this._hasInitialized=!0}ngAfterContentChecked(){this._canRender()&&this._render()}ngOnDestroy(){[this._rowOutlet?.viewContainer,this._headerRowOutlet?.viewContainer,this._footerRowOutlet?.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(e=>{e?.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),jV(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const e=this._dataDiffer.diff(this._renderRows);if(!e)return this._updateNoDataRow(),void this.contentChanged.next();const n=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(e,n,(r,l,m)=>this._getEmbeddedViewArgs(r.item,m),r=>r.item.data,r=>{r.operation===Nb.INSERTED&&r.context&&this._renderCellTemplateForItem(r.record.item.rowDef,r.context)}),this._updateRowIndexContext(),e.forEachIdentityChange(r=>{n.get(r.currentIndex).context.$implicit=r.item.data}),this._updateNoDataRow(),(0,o.mal)(()=>{this.updateStickyColumnStyles()},{injector:this._injector}),this.contentChanged.next()}addColumnDef(e){this._customColumnDefs.add(e)}removeColumnDef(e){this._customColumnDefs.delete(e)}addRowDef(e){this._customRowDefs.add(e)}removeRowDef(e){this._customRowDefs.delete(e)}addHeaderRowDef(e){this._customHeaderRowDefs.add(e),this._headerRowDefChanged=!0}removeHeaderRowDef(e){this._customHeaderRowDefs.delete(e),this._headerRowDefChanged=!0}addFooterRowDef(e){this._customFooterRowDefs.add(e),this._footerRowDefChanged=!0}removeFooterRowDef(e){this._customFooterRowDefs.delete(e),this._footerRowDefChanged=!0}setNoDataRow(e){this._customNoDataRow=e}updateStickyHeaderRowStyles(){const e=this._getRenderedRows(this._headerRowOutlet);if(this._isNativeHtmlTable){const r=r$(this._headerRowOutlet,"thead");r&&(r.style.display=e.length?"":"none")}const n=this._headerRowDefs.map(r=>r.sticky);this._stickyStyler.clearStickyPositioning(e,["top"]),this._stickyStyler.stickRows(e,n,"top"),this._headerRowDefs.forEach(r=>r.resetStickyChanged())}updateStickyFooterRowStyles(){const e=this._getRenderedRows(this._footerRowOutlet);if(this._isNativeHtmlTable){const r=r$(this._footerRowOutlet,"tfoot");r&&(r.style.display=e.length?"":"none")}const n=this._footerRowDefs.map(r=>r.sticky);this._stickyStyler.clearStickyPositioning(e,["bottom"]),this._stickyStyler.stickRows(e,n,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,n),this._footerRowDefs.forEach(r=>r.resetStickyChanged())}updateStickyColumnStyles(){const e=this._getRenderedRows(this._headerRowOutlet),n=this._getRenderedRows(this._rowOutlet),r=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...e,...n,...r],["left","right"]),this._stickyColumnStylesNeedReset=!1),e.forEach((l,m)=>{this._addStickyColumnStyles([l],this._headerRowDefs[m])}),this._rowDefs.forEach(l=>{const m=[];for(let C=0;C<n.length;C++)this._renderRows[C].rowDef===l&&m.push(n[C]);this._addStickyColumnStyles(m,l)}),r.forEach((l,m)=>{this._addStickyColumnStyles([l],this._footerRowDefs[m])}),Array.from(this._columnDefsByName.values()).forEach(l=>l.resetStickyChanged())}_outletAssigned(){!this._hasAllOutlets&&this._rowOutlet&&this._headerRowOutlet&&this._footerRowOutlet&&this._noDataRowOutlet&&(this._hasAllOutlets=!0,this._canRender()&&this._render())}_canRender(){return this._hasAllOutlets&&this._hasInitialized}_render(){this._cacheRowDefs(),this._cacheColumnDefs();const n=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||n,this._forceRecalculateCellWidths=n,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}_getAllRenderRows(){const e=[],n=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let r=0;r<this._data.length;r++){let l=this._data[r];const m=this._getRenderRowsForData(l,r,n.get(l));this._cachedRenderRowsMap.has(l)||this._cachedRenderRowsMap.set(l,new WeakMap);for(let C=0;C<m.length;C++){let A=m[C];const O=this._cachedRenderRowsMap.get(A.data);O.has(A.rowDef)?O.get(A.rowDef).push(A):O.set(A.rowDef,[A]),e.push(A)}}return e}_getRenderRowsForData(e,n,r){return this._getRowDefs(e,n).map(m=>{const C=r&&r.has(m)?r.get(m):[];if(C.length){const A=C.shift();return A.dataIndex=n,A}return{data:e,rowDef:m,dataIndex:n}})}_cacheColumnDefs(){this._columnDefsByName.clear(),IO(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(n=>{this._columnDefsByName.has(n.name),this._columnDefsByName.set(n.name,n)})}_cacheRowDefs(){this._headerRowDefs=IO(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=IO(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=IO(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const e=this._rowDefs.filter(n=>!n.when);this._defaultRowDef=e[0]}_renderUpdatedColumns(){const e=(m,C)=>m||!!C.getColumnsDiff(),n=this._rowDefs.reduce(e,!1);n&&this._forceRenderDataRows();const r=this._headerRowDefs.reduce(e,!1);r&&this._forceRenderHeaderRows();const l=this._footerRowDefs.reduce(e,!1);return l&&this._forceRenderFooterRows(),n||r||l}_switchDataSource(e){this._data=[],jV(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),e||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet&&this._rowOutlet.viewContainer.clear()),this._dataSource=e}_observeRenderChanges(){if(!this.dataSource)return;let e;jV(this.dataSource)?e=this.dataSource.connect(this):Tt(this.dataSource)?e=this.dataSource:Array.isArray(this.dataSource)&&(e=di(this.dataSource)),this._renderChangeSubscription=e.pipe(dn(this._onDestroy)).subscribe(n=>{this._data=n||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((e,n)=>this._renderRow(this._headerRowOutlet,e,n)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((e,n)=>this._renderRow(this._footerRowOutlet,e,n)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(e,n){const r=Array.from(n.columns||[]).map(C=>this._columnDefsByName.get(C)),l=r.map(C=>C.sticky),m=r.map(C=>C.stickyEnd);this._stickyStyler.updateStickyColumns(e,l,m,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(e){const n=[];for(let r=0;r<e.viewContainer.length;r++){const l=e.viewContainer.get(r);n.push(l.rootNodes[0])}return n}_getRowDefs(e,n){if(1==this._rowDefs.length)return[this._rowDefs[0]];let r=[];if(this.multiTemplateDataRows)r=this._rowDefs.filter(l=>!l.when||l.when(n,e));else{let l=this._rowDefs.find(m=>m.when&&m.when(n,e))||this._defaultRowDef;l&&r.push(l)}return r}_getEmbeddedViewArgs(e,n){return{templateRef:e.rowDef.template,context:{$implicit:e.data},index:n}}_renderRow(e,n,r,l={}){const m=e.viewContainer.createEmbeddedView(n.template,l,r);return this._renderCellTemplateForItem(n,l),m}_renderCellTemplateForItem(e,n){for(let r of this._getCellTemplates(e))Vb.mostRecentCellOutlet&&Vb.mostRecentCellOutlet._viewContainer.createEmbeddedView(r,n);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const e=this._rowOutlet.viewContainer;for(let n=0,r=e.length;n<r;n++){const m=e.get(n).context;m.count=r,m.first=0===n,m.last=n===r-1,m.even=n%2==0,m.odd=!m.even,this.multiTemplateDataRows?(m.dataIndex=this._renderRows[n].dataIndex,m.renderIndex=n):m.index=this._renderRows[n].dataIndex}}_getCellTemplates(e){return e&&e.columns?Array.from(e.columns,n=>{const r=this._columnDefsByName.get(n);return e.extractCellTemplate(r)}):[]}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const e=(n,r)=>n||r.hasStickyChanged();this._headerRowDefs.reduce(e,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(e,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(e,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new Ese(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:di()).pipe(dn(this._onDestroy)).subscribe(n=>{this._stickyStyler.direction=n,this.updateStickyColumnStyles()})}_getOwnDefs(e){return e.filter(n=>!n._table||n._table===this)}_updateNoDataRow(){const e=this._customNoDataRow||this._noDataRow;if(!e)return;const n=0===this._rowOutlet.viewContainer.length;if(n===this._isShowingNoDataRow)return;const r=this._noDataRowOutlet.viewContainer;if(n){const l=r.createEmbeddedView(e.templateRef),m=l.rootNodes[0];1===l.rootNodes.length&&m?.nodeType===this._document.ELEMENT_NODE&&(m.setAttribute("role","row"),m.classList.add(e._contentClassName))}else r.clear();this._isShowingNoDataRow=n,this._changeDetectorRef.markForCheck()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o._q3),o.rXU(o.gRc),o.rXU(o.aKT),o.kS0("role"),o.rXU(Us,8),o.rXU(Nn),o.rXU(wo),o.rXU(Fk),o.rXU(ZV),o.rXU(_x),o.rXU(tz,12),o.rXU(o.SKi,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,DO,5),o.wni(l,Bb,5),o.wni(l,AO,5),o.wni(l,Bk,5),o.wni(l,Vk,5)),2&n){let m;o.mGM(m=o.lsd())&&(r._noDataRow=m.first),o.mGM(m=o.lsd())&&(r._contentColumnDefs=m),o.mGM(m=o.lsd())&&(r._contentRowDefs=m),o.mGM(m=o.lsd())&&(r._contentHeaderRowDefs=m),o.mGM(m=o.lsd())&&(r._contentFooterRowDefs=m)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(n,r){2&n&&o.AVh("cdk-table-fixed-layout",r.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:[2,"multiTemplateDataRows","multiTemplateDataRows",o.L39],fixedLayout:[2,"fixedLayout","fixedLayout",o.L39]},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],standalone:!0,features:[o.Jv_([{provide:j_,useExisting:i},{provide:Fk,useClass:NH},{provide:ZV,useClass:i$},{provide:tz,useValue:null}]),o.GFd,o.aNF],ngContentSelectors:_se,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(n,r){1&n&&(o.NAR(gse),o.SdG(0),o.SdG(1,1),o.DNE(2,vse,1,0)(3,bse,7,0)(4,yse,4,0)),2&n&&(o.R7$(2),o.vxM(r._isServer?2:-1),o.R7$(),o.vxM(r._isNativeHtmlTable?3:4))},dependencies:[nz,iz,oz,rz],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2})}}return i})();function IO(i,t){return i.concat(Array.from(t))}function r$(i,t){const e=t.toUpperCase();let n=i.viewContainer.element.nativeElement;for(;n;){const r=1===n.nodeType?n.nodeName:null;if(r===e)return n;if("TABLE"===r)break;n=n.parentNode}return null}let Sse=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[_V]})}}return i})();const Mse=[[["caption"]],[["colgroup"],["col"]],"*"],Ase=["caption","colgroup, col","*"];function Dse(i,t){1&i&&o.SdG(0,2)}function kse(i,t){1&i&&(o.j41(0,"thead",0),o.eu8(1,1),o.k0s(),o.j41(2,"tbody",2),o.eu8(3,3)(4,4),o.k0s(),o.j41(5,"tfoot",0),o.eu8(6,5),o.k0s())}function Ise(i,t){1&i&&o.eu8(0,1)(1,3)(2,4)(3,5)}let sz=(()=>{class i extends kO{constructor(){super(...arguments),this.stickyCssClass="mat-mdc-table-sticky",this.needsPositionStickyOnElement=!1}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(n,r){2&n&&o.AVh("mdc-table-fixed-layout",r.fixedLayout)},exportAs:["matTable"],standalone:!0,features:[o.Jv_([{provide:kO,useExisting:i},{provide:j_,useExisting:i},{provide:ZV,useClass:i$},{provide:Fk,useClass:NH},{provide:tz,useValue:null}]),o.Vt3,o.aNF],ngContentSelectors:Ase,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["role","rowgroup",1,"mdc-data-table__content"],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(n,r){1&n&&(o.NAR(Mse),o.SdG(0),o.SdG(1,1),o.DNE(2,Dse,1,0)(3,kse,7,0)(4,Ise,4,0)),2&n&&(o.R7$(2),o.vxM(r._isServer?2:-1),o.R7$(),o.vxM(r._isNativeHtmlTable?3:4))},dependencies:[nz,iz,oz,rz],styles:[".mat-mdc-table-sticky{position:sticky !important}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table{min-width:100%;border:0;border-spacing:0;table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color)}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell{text-align:right}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px}.mat-mdc-header-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-header-headline-font, Roboto, sans-serif);line-height:var(--mat-table-header-headline-line-height);font-size:var(--mat-table-header-headline-size, 14px);font-weight:var(--mat-table-header-headline-weight, 500)}.mat-mdc-row{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87))}.mat-mdc-row,.mdc-data-table__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, Roboto, sans-serif);line-height:var(--mat-table-row-item-label-text-line-height);font-size:var(--mat-table-row-item-label-text-size, 14px);font-weight:var(--mat-table-row-item-label-text-weight)}.mat-mdc-footer-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-footer-supporting-text-font, Roboto, sans-serif);line-height:var(--mat-table-footer-supporting-text-line-height);font-size:var(--mat-table-footer-supporting-text-size, 14px);font-weight:var(--mat-table-footer-supporting-text-weight);letter-spacing:var(--mat-table-footer-supporting-text-tracking)}.mat-mdc-header-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking);font-weight:inherit;line-height:inherit;box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mat-mdc-header-cell{text-align:right}.mat-mdc-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking);line-height:inherit}.mdc-data-table__row:last-child .mat-mdc-cell{border-bottom:none}.mat-mdc-footer-cell{letter-spacing:var(--mat-table-row-item-label-text-tracking)}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2})}}return i})(),RO=(()=>{class i extends IS{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matCellDef",""]],standalone:!0,features:[o.Jv_([{provide:IS,useExisting:i}]),o.Vt3]})}}return i})(),PO=(()=>{class i extends RS{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matHeaderCellDef",""]],standalone:!0,features:[o.Jv_([{provide:RS,useExisting:i}]),o.Vt3]})}}return i})(),s$=(()=>{class i extends MO{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matFooterCellDef",""]],standalone:!0,features:[o.Jv_([{provide:MO,useExisting:i}]),o.Vt3]})}}return i})(),OO=(()=>{class i extends Bb{get name(){return this._name}set name(e){this._setNameInput(e)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matColumnDef",""]],inputs:{name:[0,"matColumnDef","name"]},standalone:!0,features:[o.Jv_([{provide:Bb,useExisting:i},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:i}]),o.Vt3]})}}return i})(),LO=(()=>{class i extends qV{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],standalone:!0,features:[o.Vt3]})}}return i})(),a$=(()=>{class i extends e${static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-footer-cell"],["td","mat-footer-cell",""]],hostAttrs:[1,"mat-mdc-footer-cell","mdc-data-table__cell"],standalone:!0,features:[o.Vt3]})}}return i})(),FO=(()=>{class i extends YV{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],standalone:!0,features:[o.Vt3]})}}return i})(),az=(()=>{class i extends Bk{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matHeaderRowDef",""]],inputs:{columns:[0,"matHeaderRowDef","columns"],sticky:[2,"matHeaderRowDefSticky","sticky",o.L39]},standalone:!0,features:[o.Jv_([{provide:Bk,useExisting:i}]),o.GFd,o.Vt3]})}}return i})(),l$=(()=>{class i extends Vk{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matFooterRowDef",""]],inputs:{columns:[0,"matFooterRowDef","columns"],sticky:[2,"matFooterRowDefSticky","sticky",o.L39]},standalone:!0,features:[o.Jv_([{provide:Vk,useExisting:i}]),o.GFd,o.Vt3]})}}return i})(),lz=(()=>{class i extends AO{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matRowDef",""]],inputs:{columns:[0,"matRowDefColumns","columns"],when:[0,"matRowDefWhen","when"]},standalone:!0,features:[o.Jv_([{provide:AO,useExisting:i}]),o.Vt3]})}}return i})(),cz=(()=>{class i extends QV{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],standalone:!0,features:[o.Jv_([{provide:QV,useExisting:i}]),o.Vt3,o.aNF],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,r){1&n&&o.eu8(0,0)},dependencies:[Vb],encapsulation:2})}}return i})(),c$=(()=>{class i extends JV{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-footer-row"],["tr","mat-footer-row",""]],hostAttrs:["role","row",1,"mat-mdc-footer-row","mdc-data-table__row"],exportAs:["matFooterRow"],standalone:!0,features:[o.Jv_([{provide:JV,useExisting:i}]),o.Vt3,o.aNF],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,r){1&n&&o.eu8(0,0)},dependencies:[Vb],encapsulation:2})}}return i})(),dz=(()=>{class i extends ez{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],standalone:!0,features:[o.Jv_([{provide:ez,useExisting:i}]),o.Vt3,o.aNF],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(n,r){1&n&&o.eu8(0,0)},dependencies:[Vb],encapsulation:2})}}return i})(),d$=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,Sse,qn]})}}return i})();class Fse extends FH{get data(){return this._data.value}set data(t){t=Array.isArray(t)?t:[],this._data.next(t),this._renderChangesSubscription||this._filterData(t)}get filter(){return this._filter.value}set filter(t){this._filter.next(t),this._renderChangesSubscription||this._filterData(this.data)}get sort(){return this._sort}set sort(t){this._sort=t,this._updateChangeSubscription()}get paginator(){return this._paginator}set paginator(t){this._paginator=t,this._updateChangeSubscription()}constructor(t=[]){super(),this._renderData=new ro.t([]),this._filter=new ro.t(""),this._internalPageChanges=new xi.B,this._renderChangesSubscription=null,this.sortingDataAccessor=(e,n)=>{const r=e[n];if(Dw(r)){const l=Number(r);return l<9007199254740991?l:r}return r},this.sortData=(e,n)=>{const r=n.active,l=n.direction;return r&&""!=l?e.sort((m,C)=>{let A=this.sortingDataAccessor(m,r),O=this.sortingDataAccessor(C,r);const z=typeof A,$=typeof O;z!==$&&("number"===z&&(A+=""),"number"===$&&(O+=""));let Q=0;return null!=A&&null!=O?A>O?Q=1:A<O&&(Q=-1):null!=A?Q=1:null!=O&&(Q=-1),Q*("asc"==l?1:-1)}):e},this.filterPredicate=(e,n)=>{const r=Object.keys(e).reduce((m,C)=>m+e[C]+"\u25ec","").toLowerCase(),l=n.trim().toLowerCase();return-1!=r.indexOf(l)},this._data=new ro.t(t),this._updateChangeSubscription()}_updateChangeSubscription(){const t=this._sort?Io(this._sort.sortChange,this._sort.initialized):di(null),e=this._paginator?Io(this._paginator.page,this._internalPageChanges,this._paginator.initialized):di(null),r=ri([this._data,this._filter]).pipe((0,st.T)(([C])=>this._filterData(C))),l=ri([r,t]).pipe((0,st.T)(([C])=>this._orderData(C))),m=ri([l,e]).pipe((0,st.T)(([C])=>this._pageData(C)));this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=m.subscribe(C=>this._renderData.next(C))}_filterData(t){return this.filteredData=null==this.filter||""===this.filter?t:t.filter(e=>this.filterPredicate(e,this.filter)),this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(t){return this.sort?this.sortData(t.slice(),this.sort):t}_pageData(t){if(!this.paginator)return t;const e=this.paginator.pageIndex*this.paginator.pageSize;return t.slice(e,e+this.paginator.pageSize)}_updatePaginator(t){Promise.resolve().then(()=>{const e=this.paginator;if(e&&(e.length=t,e.pageIndex>0)){const n=Math.ceil(e.length/e.pageSize)-1||0,r=Math.min(e.pageIndex,n);r!==e.pageIndex&&(e.pageIndex=r,this._internalPageChanges.next())}})}connect(){return this._renderChangesSubscription||this._updateChangeSubscription(),this._renderData}disconnect(){this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=null}}const u$=new o.nKC("CdkAccordion");let Nse=0,Bse=(()=>{class i{get expanded(){return this._expanded}set expanded(e){this._expanded!==e&&(this._expanded=e,this.expandedChange.emit(e),e?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}constructor(e,n,r){this.accordion=e,this._changeDetectorRef=n,this._expansionDispatcher=r,this._openCloseAllSubscription=On.yU.EMPTY,this.closed=new o.bkB,this.opened=new o.bkB,this.destroyed=new o.bkB,this.expandedChange=new o.bkB,this.id="cdk-accordion-child-"+Nse++,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=r.listen((l,m)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===m&&this.id!==l&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(e=>{this.disabled||(this.expanded=e)})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(u$,12),o.rXU(o.gRc),o.rXU(GV))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[2,"expanded","expanded",o.L39],disabled:[2,"disabled","disabled",o.L39]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[o.Jv_([{provide:u$,useValue:void 0}]),o.GFd]})}}return i})(),Vse=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({})}}return i})();const zse=["body"],Use=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],jse=["mat-expansion-panel-header","*","mat-action-row"];function Gse(i,t){}const Hse=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],$se=["mat-panel-title","mat-panel-description","*"];function Wse(i,t){if(1&i&&(o.j41(0,"span",1),o.qSk(),o.j41(1,"svg",2),o.nrm(2,"path",3),o.k0s()()),2&i){const e=o.XpG();o.Y8G("@indicatorRotate",e._getExpandedState())}}const h$=new o.nKC("MAT_ACCORDION"),f$="225ms cubic-bezier(0.4,0.0,0.2,1)",m$={indicatorRotate:js("indicatorRotate",[Lo("collapsed, void",gn({transform:"rotate(0deg)"})),Lo("expanded",gn({transform:"rotate(180deg)"})),oo("expanded <=> collapsed, void => collapsed",co(f$))]),bodyExpansion:js("bodyExpansion",[Lo("collapsed, void",gn({height:"0px",visibility:"hidden"})),Lo("expanded",gn({height:"*",visibility:""})),oo("expanded <=> collapsed, void => collapsed",co(f$))])},p$=new o.nKC("MAT_EXPANSION_PANEL");let g$=(()=>{class i{constructor(e,n){this._template=e,this._expansionPanel=n}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q),o.rXU(p$,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0})}}return i})(),Xse=0;const _$=new o.nKC("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let v$=(()=>{class i extends Bse{get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(e){this._hideToggle=e}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(e){this._togglePosition=e}constructor(e,n,r,l,m,C,A){super(e,n,r),this._viewContainerRef=l,this._animationMode=C,this._hideToggle=!1,this.afterExpand=new o.bkB,this.afterCollapse=new o.bkB,this._inputChanges=new xi.B,this._headerId="mat-expansion-panel-header-"+Xse++,this.accordion=e,this._document=m,this._animationsDisabled="NoopAnimations"===C,A&&(this.hideToggle=A.hideToggle)}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(As(null),Ur(()=>this.expanded&&!this._portal),gs(1)).subscribe(()=>{this._portal=new px(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(e){this._inputChanges.next(e)}ngOnDestroy(){super.ngOnDestroy(),this._inputChanges.complete()}_containsFocus(){if(this._body){const e=this._document.activeElement,n=this._body.nativeElement;return e===n||n.contains(e)}return!1}_animationStarted(e){!b$(e)&&!this._animationsDisabled&&this._body&&this._body?.nativeElement.setAttribute("inert","")}_animationDone(e){b$(e)||("expanded"===e.toState?this.afterExpand.emit():"collapsed"===e.toState&&this.afterCollapse.emit(),!this._animationsDisabled&&this._body&&this._body.nativeElement.removeAttribute("inert"))}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(h$,12),o.rXU(o.gRc),o.rXU(GV),o.rXU(o.c1b),o.rXU(Nn),o.rXU(o.bc$,8),o.rXU(_$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-expansion-panel"]],contentQueries:function(n,r,l){if(1&n&&o.wni(l,g$,5),2&n){let m;o.mGM(m=o.lsd())&&(r._lazyContent=m.first)}},viewQuery:function(n,r){if(1&n&&o.GBs(zse,5),2&n){let l;o.mGM(l=o.lsd())&&(r._body=l.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(n,r){2&n&&o.AVh("mat-expanded",r.expanded)("_mat-animation-noopable",r._animationsDisabled)("mat-expansion-panel-spacing",r._hasSpacing())},inputs:{hideToggle:[2,"hideToggle","hideToggle",o.L39],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[o.Jv_([{provide:h$,useValue:void 0},{provide:p$,useExisting:i}]),o.GFd,o.Vt3,o.OA$,o.aNF],ngContentSelectors:jse,decls:7,vars:4,consts:[["body",""],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(n,r){if(1&n){const l=o.RV6();o.NAR(Use),o.SdG(0),o.j41(1,"div",1,0),o.bIt("@bodyExpansion.start",function(C){return o.eBV(l),o.Njj(r._animationStarted(C))})("@bodyExpansion.done",function(C){return o.eBV(l),o.Njj(r._animationDone(C))}),o.j41(3,"div",2),o.SdG(4,1),o.DNE(5,Gse,0,0,"ng-template",3),o.k0s(),o.SdG(6,2),o.k0s()}2&n&&(o.R7$(),o.Y8G("@bodyExpansion",r._getExpandedState())("id",r.id),o.BMQ("aria-labelledby",r._headerId),o.R7$(4),o.Y8G("cdkPortalOutlet",r._portal))},dependencies:[gx],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color);color:var(--mat-expansion-container-text-color);border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font);font-size:var(--mat-expansion-container-text-size);font-weight:var(--mat-expansion-container-text-weight);line-height:var(--mat-expansion-container-text-line-height);letter-spacing:var(--mat-expansion-container-text-tracking)}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color)}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[m$.bodyExpansion]},changeDetection:0})}}return i})();function b$(i){return"void"===i.fromState}let qse=(()=>{class i{constructor(e,n,r,l,m,C,A){this.panel=e,this._element=n,this._focusMonitor=r,this._changeDetectorRef=l,this._animationMode=C,this._parentChangeSubscription=On.yU.EMPTY,this.tabIndex=0;const O=e.accordion?e.accordion._stateChanges.pipe(Ur(z=>!(!z.hideToggle&&!z.togglePosition))):nr;this.tabIndex=parseInt(A||"")||0,this._parentChangeSubscription=Io(e.opened,e.closed,O,e._inputChanges.pipe(Ur(z=>!!(z.hideToggle||z.disabled||z.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),e.closed.pipe(Ur(()=>e._containsFocus())).subscribe(()=>r.focusVia(n,"program")),m&&(this.expandedHeight=m.expandedHeight,this.collapsedHeight=m.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const e=this._isExpanded();return e&&this.expandedHeight?this.expandedHeight:!e&&this.collapsedHeight?this.collapsedHeight:null}_keydown(e){switch(e.keyCode){case 32:case 13:oa(e)||(e.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(e))}}focus(e,n){e?this._focusMonitor.focusVia(this._element,e,n):this._element.nativeElement.focus(n)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(e=>{e&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(v$,1),o.rXU(o.aKT),o.rXU(Kc),o.rXU(o.gRc),o.rXU(_$,8),o.rXU(o.bc$,8),o.kS0("tabindex"))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(n,r){1&n&&o.bIt("click",function(){return r._toggle()})("keydown",function(m){return r._keydown(m)}),2&n&&(o.BMQ("id",r.panel._headerId)("tabindex",r.disabled?-1:r.tabIndex)("aria-controls",r._getPanelId())("aria-expanded",r._isExpanded())("aria-disabled",r.panel.disabled),o.xc7("height",r._getHeaderHeight()),o.AVh("mat-expanded",r._isExpanded())("mat-expansion-toggle-indicator-after","after"===r._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===r._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===r._animationMode))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[2,"tabIndex","tabIndex",e=>null==e?0:(0,o.Udg)(e)]},standalone:!0,features:[o.GFd,o.aNF],ngContentSelectors:$se,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(n,r){1&n&&(o.NAR(Hse),o.j41(0,"span",0),o.SdG(1),o.SdG(2,1),o.SdG(3,2),o.k0s(),o.DNE(4,Wse,3,1,"span",1)),2&n&&(o.AVh("mat-content-hide-toggle",!r._showToggle()),o.R7$(4),o.vxM(r._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font);font-size:var(--mat-expansion-header-text-size);font-weight:var(--mat-expansion-header-text-weight);line-height:var(--mat-expansion-header-text-line-height);letter-spacing:var(--mat-expansion-header-text-tracking)}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color)}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color)}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color)}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color);display:inline-block;display:var(--mat-expansion-legacy-header-indicator-display, inline-block)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color);display:none;display:var(--mat-expansion-header-indicator-display, none)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[m$.indicatorRotate]},changeDetection:0})}}return i})(),y$=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,Vse,JP]})}}return i})();const x$=Ql({passive:!0});let Yse=(()=>{class i{constructor(e,n){this._platform=e,this._ngZone=n,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return nr;const n=lu(e),r=this._monitoredElements.get(n);if(r)return r.subject;const l=new xi.B,m="cdk-text-field-autofilled",C=A=>{"cdk-text-field-autofill-start"!==A.animationName||n.classList.contains(m)?"cdk-text-field-autofill-end"===A.animationName&&n.classList.contains(m)&&(n.classList.remove(m),this._ngZone.run(()=>l.next({target:A.target,isAutofilled:!1}))):(n.classList.add(m),this._ngZone.run(()=>l.next({target:A.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{n.addEventListener("animationstart",C,x$),n.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(n,{subject:l,unlisten:()=>{n.removeEventListener("animationstart",C,x$)}}),l}stopMonitoring(e){const n=lu(e),r=this._monitoredElements.get(n);r&&(r.unlisten(),r.subject.complete(),n.classList.remove("cdk-text-field-autofill-monitored"),n.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(n))}ngOnDestroy(){this._monitoredElements.forEach((e,n)=>this.stopMonitoring(n))}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(wo),o.KVO(o.SKi))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Zse=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({})}}return i})();const uz=new o.nKC("MAT_INPUT_VALUE_ACCESSOR"),Kse=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let Qse=0,hz=(()=>{class i{get disabled(){return this._disabled}set disabled(e){this._disabled=Es(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(TS.required)??!1}set required(e){this._required=Es(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&YC().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(e){this._errorStateTracker.matcher=e}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=Es(e)}get errorState(){return this._errorStateTracker.errorState}set errorState(e){this._errorStateTracker.errorState=e}constructor(e,n,r,l,m,C,A,O,z,$){this._elementRef=e,this._platform=n,this.ngControl=r,this._autofillMonitor=O,this._formField=$,this._uid="mat-input-"+Qse++,this.focused=!1,this.stateChanges=new xi.B,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(de=>YC().has(de)),this._iOSKeyupListener=de=>{const fe=de.target;!fe.value&&0===fe.selectionStart&&0===fe.selectionEnd&&(fe.setSelectionRange(1,1),fe.setSelectionRange(0,0))};const Q=this._elementRef.nativeElement,te=Q.nodeName.toLowerCase();this._inputValueAccessor=A||Q,this._previousNativeValue=this.value,this.id=this.id,n.IOS&&z.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new Qv(C,r,m,l,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===te,this._isTextarea="textarea"===te,this._isInFormField=!!$,this._isNativeSelect&&(this.controlType=Q.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),null!==this.ngControl.disabled&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_dirtyCheckPlaceholder(){const e=this._getPlaceholder();if(e!==this._previousPlaceholder){const n=this._elementRef.nativeElement;this._previousPlaceholder=e,e?n.setAttribute("placeholder",e):n.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){Kse.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,n=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&n&&n.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(wo),o.rXU(dg,10),o.rXU(AS,8),o.rXU(Fb,8),o.rXU(eh),o.rXU(uz,10),o.rXU(Yse),o.rXU(o.SKi),o.rXU(DS,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(n,r){1&n&&o.bIt("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),2&n&&(o.Mr5("id",r.id)("disabled",r.disabled)("required",r.required),o.BMQ("name",r.name||null)("readonly",r.readonly&&!r._isNativeSelect||null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required)("id",r.id),o.AVh("mat-input-server",r._isServer)("mat-mdc-form-field-textarea-control",r._isInFormField&&r._isTextarea)("mat-mdc-form-field-input-control",r._isInFormField)("mdc-text-field__input",r._isInFormField)("mat-mdc-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[o.Jv_([{provide:EO,useExisting:i}]),o.OA$]})}}return i})(),fz=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,kS,kS,Zse,qn]})}}return i})();function w$(i,t){return t?e=>bo(t.pipe(gs(1),function Jse(){return(0,ut.N)((i,t)=>{i.subscribe((0,bt._)(t,Gc.l))})}()),e.pipe(w$(i))):hr((e,n)=>pn(i(e,n)).pipe(gs(1),vo(e)))}function NO(i,t=zh){const e=gV(i,t);return w$(()=>e)}const eae=["panel"],tae=["*"];function iae(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",1,0),o.bIt("@panelAnimation.done",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._animationDone.next(r))}),o.SdG(2),o.k0s()}if(2&i){const e=t.id,n=o.XpG();o.HbH(n._classList),o.AVh("mat-mdc-autocomplete-visible",n.showPanel)("mat-mdc-autocomplete-hidden",!n.showPanel)("mat-primary","primary"===n._color)("mat-accent","accent"===n._color)("mat-warn","warn"===n._color),o.Y8G("id",n.id)("@panelAnimation",n.isOpen?"visible":"hidden"),o.BMQ("aria-label",n.ariaLabel||null)("aria-labelledby",n._getPanelAriaLabelledby(e))}}const nae=js("panelAnimation",[Lo("void, hidden",gn({opacity:0,transform:"scaleY(0.8)"})),oo(":enter, hidden => visible",[RI([co("0.03s linear",gn({opacity:1})),co("0.12s cubic-bezier(0, 0, 0.2, 1)",gn({transform:"scaleY(1)"}))])]),oo(":leave, visible => hidden",[co("0.075s linear",gn({opacity:0}))])]);let rae=0;class oae{constructor(t,e){this.source=t,this.option=e}}const C$=new o.nKC("mat-autocomplete-default-options",{providedIn:"root",factory:function sae(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}});let aae=(()=>{class i{get isOpen(){return this._isOpen&&this.showPanel}_setColor(e){this._color=e,this._changeDetectorRef.markForCheck()}set classList(e){this._classList=e,this._elementRef.nativeElement.className=""}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const e of this.options)e._changeDetectorRef.markForCheck()}constructor(e,n,r,l){this._changeDetectorRef=e,this._elementRef=n,this._defaults=r,this._activeOptionChanges=On.yU.EMPTY,this._animationDone=new o.bkB,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new o.bkB,this.opened=new o.bkB,this.closed=new o.bkB,this.optionActivated=new o.bkB,this.id="mat-autocomplete-"+rae++,this.inertGroups=l?.SAFARI||!1,this.autoActiveFirstOption=!!r.autoActiveFirstOption,this.autoSelectActiveOption=!!r.autoSelectActiveOption,this.requireSelection=!!r.requireSelection,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}ngAfterContentInit(){this._keyManager=new $r(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(e=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[e]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe(),this._animationDone.complete()}_setScrollTop(e){this.panel&&(this.panel.nativeElement.scrollTop=e)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._changeDetectorRef.markForCheck()}_emitSelectEvent(e){const n=new oae(this,e);this.optionSelected.emit(n)}_getPanelAriaLabelledby(e){return this.ariaLabel?null:this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_skipPredicate(){return!1}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.rXU(o.aKT),o.rXU(C$),o.rXU(wo))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-autocomplete"]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,Gp,5),o.wni(l,Ec,5)),2&n){let m;o.mGM(m=o.lsd())&&(r.options=m),o.mGM(m=o.lsd())&&(r.optionGroups=m)}},viewQuery:function(n,r){if(1&n&&(o.GBs(o.C4Q,7),o.GBs(eae,5)),2&n){let l;o.mGM(l=o.lsd())&&(r.template=l.first),o.mGM(l=o.lsd())&&(r.panel=l.first)}},hostAttrs:[1,"mat-mdc-autocomplete"],inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:[2,"autoActiveFirstOption","autoActiveFirstOption",o.L39],autoSelectActiveOption:[2,"autoSelectActiveOption","autoSelectActiveOption",o.L39],requireSelection:[2,"requireSelection","requireSelection",o.L39],panelWidth:"panelWidth",disableRipple:[2,"disableRipple","disableRipple",o.L39],classList:[0,"class","classList"],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",o.L39]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},exportAs:["matAutocomplete"],standalone:!0,features:[o.Jv_([{provide:Up,useExisting:i}]),o.GFd,o.aNF],ngContentSelectors:tae,decls:1,vars:0,consts:[["panel",""],["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id"]],template:function(n,r){1&n&&(o.NAR(),o.DNE(0,iae,3,16,"ng-template"))},styles:["div.mat-mdc-autocomplete-panel{width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;position:static;border-radius:var(--mat-autocomplete-container-shape);box-shadow:var(--mat-autocomplete-container-elevation-shadow);background-color:var(--mat-autocomplete-background-color)}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden;pointer-events:none}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[nae]},changeDetection:0})}}return i})();const lae={provide:Ya,useExisting:(0,o.Rfq)(()=>T$),multi:!0},E$=new o.nKC("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{const i=(0,o.WQX)(_l);return()=>i.scrollStrategies.reposition()}}),dae={provide:E$,deps:[_l],useFactory:function cae(i){return()=>i.scrollStrategies.reposition()}};let T$=(()=>{class i{constructor(e,n,r,l,m,C,A,O,z,$,Q){this._element=e,this._overlay=n,this._viewContainerRef=r,this._zone=l,this._changeDetectorRef=m,this._dir=A,this._formField=O,this._document=z,this._viewportRuler=$,this._defaults=Q,this._componentDestroyed=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=On.yU.EMPTY,this._breakpointObserver=(0,o.WQX)(sa),this._handsetLandscapeSubscription=On.yU.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new xi.B,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._initialized=new xi.B,this._injector=(0,o.WQX)(o.zZn),this._aboveClass="mat-mdc-autocomplete-panel-above",this._overlayAttached=!1,this.optionSelections=ir(()=>{const te=this.autocomplete?this.autocomplete.options:null;return te?te.changes.pipe(As(te),So(()=>Io(...te.map(de=>de.onSelectionChange)))):this._initialized.pipe(So(()=>this.optionSelections))}),this._handlePanelKeydown=te=>{(27===te.keyCode&&!oa(te)||38===te.keyCode&&oa(te,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),te.stopPropagation(),te.preventDefault())},this._trackedModal=null,this._scrollStrategy=C}ngAfterViewInit(){this._initialized.next(),this._initialized.complete();const e=this._getWindow();typeof e<"u"&&this._zone.runOutsideAngular(()=>e.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(e){e.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const e=this._getWindow();typeof e<"u"&&e.removeEventListener("blur",this._windowBlurHandler),this._handsetLandscapeSubscription.unsubscribe(),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._openPanelInternal()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._latestOpeningTrigger===this&&(this.autocomplete._isOpen=!1,this.autocomplete._latestOpeningTrigger=null),this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal&&pm(this._trackedModal,"aria-owns",this.autocomplete.id))}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return Io(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(Ur(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(Ur(()=>this._overlayAttached)):di()).pipe((0,st.T)(e=>e instanceof wm?e:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return Io(bu(this._document,"click"),bu(this._document,"auxclick"),bu(this._document,"touchend")).pipe(Ur(e=>{const n=Td(e),r=this._formField?this._formField.getConnectedOverlayOrigin().nativeElement:null,l=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&n!==this._element.nativeElement&&this._document.activeElement!==this._element.nativeElement&&(!r||!r.contains(n))&&(!l||!l.contains(n))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(n)}))}writeValue(e){Promise.resolve(null).then(()=>this._assignOptionValue(e))}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._element.nativeElement.disabled=e,this._changeDetectorRef.markForCheck()}_handleKeydown(e){const n=e.keyCode,r=oa(e);if(27===n&&!r&&e.preventDefault(),this._valueOnLastKeydown=this._element.nativeElement.value,this.activeOption&&13===n&&this.panelOpen&&!r)this.activeOption._selectViaInteraction(),this._resetActiveItem(),e.preventDefault();else if(this.autocomplete){const l=this.autocomplete._keyManager.activeItem,m=38===n||40===n;9===n||m&&!r&&this.panelOpen?this.autocomplete._keyManager.onKeydown(e):m&&this._canOpen()&&this._openPanelInternal(this._valueOnLastKeydown),(m||this.autocomplete._keyManager.activeItem!==l)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._valueOnLastKeydown),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(e){let n=e.target,r=n.value;if("number"===n.type&&(r=""==r?null:parseFloat(r)),this._previousValue!==r){if(this._previousValue=r,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(r),r){if(this.panelOpen&&!this.autocomplete.requireSelection){const l=this.autocomplete.options?.find(m=>m.selected);l&&r!==this._getDisplayValue(l.value)&&l.deselect(!1)}}else this._clearPreviousSelectedOption(null,!1);if(this._canOpen()&&this._document.activeElement===e.target){const l=this._valueOnLastKeydown??this._element.nativeElement.value;this._valueOnLastKeydown=null,this._openPanelInternal(l)}}}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(this._previousValue),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this._openPanelInternal()}_floatLabel(e=!1){this._formField&&"auto"===this._formField.floatLabel&&(e?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){return Io(new Ai.c(r=>{(0,o.mal)(()=>{r.next()},{injector:this._injector})}),this.autocomplete.options.changes.pipe(Oo(()=>this._positionStrategy.reapplyLastPosition()),NO(0))).pipe(So(()=>this._zone.run(()=>{const r=this.panelOpen;return this._resetActiveItem(),this._updatePanelState(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),r!==this.panelOpen&&(this.panelOpen?this._emitOpened():this.autocomplete.closed.emit()),this.panelClosingActions})),gs(1)).subscribe(r=>this._setValueAndClose(r))}_emitOpened(){this.autocomplete.opened.emit()}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_getDisplayValue(e){const n=this.autocomplete;return n&&n.displayWith?n.displayWith(e):e}_assignOptionValue(e){const n=this._getDisplayValue(e);null==e&&this._clearPreviousSelectedOption(null,!1),this._updateNativeInputValue(n??"")}_updateNativeInputValue(e){this._formField?this._formField._control.value=e:this._element.nativeElement.value=e,this._previousValue=e}_setValueAndClose(e){const n=this.autocomplete,r=e?e.source:this._pendingAutoselectedOption;r?(this._clearPreviousSelectedOption(r),this._assignOptionValue(r.value),this._onChange(r.value),n._emitSelectEvent(r),this._element.nativeElement.focus()):n.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),n._animationDone?n._animationDone.pipe(gs(1)).subscribe(()=>this._onChange(null)):this._onChange(null)),this.closePanel()}_clearPreviousSelectedOption(e,n){this.autocomplete?.options?.forEach(r=>{r!==e&&r.selected&&r.deselect(n)})}_openPanelInternal(e=this._element.nativeElement.value){this._attachOverlay(e),this._floatLabel(),this._trackedModal&&jh(this._trackedModal,"aria-owns",this.autocomplete.id)}_attachOverlay(e){let n=this._overlayRef;n?(this._positionStrategy.setOrigin(this._getConnectedElement()),n.updateSize({width:this._getPanelWidth()})):(this._portal=new px(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),n=this._overlay.create(this._getOverlayConfig()),this._overlayRef=n,this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&n&&n.updateSize({width:this._getPanelWidth()})}),this._handsetLandscapeSubscription=this._breakpointObserver.observe("(max-width: 959.98px) and (orientation: landscape)").subscribe(l=>{l.matches?this._positionStrategy.withFlexibleDimensions(!0).withGrowAfterOpen(!0).withViewportMargin(8):this._positionStrategy.withFlexibleDimensions(!1).withGrowAfterOpen(!1).withViewportMargin(0)})),n&&!n.hasAttached()&&(n.attach(this._portal),this._valueOnAttach=e,this._valueOnLastKeydown=null,this._closingActionsSubscription=this._subscribeToClosingActions());const r=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._latestOpeningTrigger=this,this.autocomplete._setColor(this._formField?.color),this._updatePanelState(),this._applyModalPanelOwnership(),this.panelOpen&&r!==this.panelOpen&&this._emitOpened()}_updatePanelState(){if(this.autocomplete._setVisibility(),this.panelOpen){const e=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=e.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=e.outsidePointerEvents().subscribe())}else this._keydownSubscription?.unsubscribe(),this._outsideClickSubscription?.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}_getOverlayConfig(){return new CS({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){const e=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(e),this._positionStrategy=e,e}_setStrategyPositions(e){const n=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],r=this._aboveClass,l=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:r},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:r}];let m;m="above"===this.position?l:"below"===this.position?n:[...n,...l],e.withPositions(m)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const e=this.autocomplete;if(e.autoActiveFirstOption){let n=-1;for(let r=0;r<e.options.length;r++)if(!e.options.get(r).disabled){n=r;break}e._keyManager.setActiveItem(n)}else e._keyManager.setActiveItem(-1)}_canOpen(){const e=this._element.nativeElement;return!e.readOnly&&!e.disabled&&!this.autocompleteDisabled}_getWindow(){return this._document?.defaultView||window}_scrollToOption(e){const n=this.autocomplete,r=s0(e,n.options,n.optionGroups);if(0===e&&1===r)n._setScrollTop(0);else if(n.panel){const l=n.options.toArray()[e];if(l){const m=l._getHostElement(),C=h_(m.offsetTop,m.offsetHeight,n._getScrollTop(),n.panel.nativeElement.offsetHeight);n._setScrollTop(C)}}}_applyModalPanelOwnership(){const e=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!e)return;const n=this.autocomplete.id;this._trackedModal&&pm(this._trackedModal,"aria-owns",n),jh(e,"aria-owns",n),this._trackedModal=e}_clearFromModal(){this._trackedModal&&(pm(this._trackedModal,"aria-owns",this.autocomplete.id),this._trackedModal=null)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(_l),o.rXU(o.c1b),o.rXU(o.SKi),o.rXU(o.gRc),o.rXU(E$),o.rXU(Us,8),o.rXU(DS,9),o.rXU(Nn,8),o.rXU(_x),o.rXU(C$,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(n,r){1&n&&o.bIt("focusin",function(){return r._handleFocus()})("blur",function(){return r._onTouched()})("input",function(m){return r._handleInput(m)})("keydown",function(m){return r._handleKeydown(m)})("click",function(){return r._handleClick()}),2&n&&o.BMQ("autocomplete",r.autocompleteAttribute)("role",r.autocompleteDisabled?null:"combobox")("aria-autocomplete",r.autocompleteDisabled?null:"list")("aria-activedescendant",r.panelOpen&&r.activeOption?r.activeOption.id:null)("aria-expanded",r.autocompleteDisabled?null:r.panelOpen.toString())("aria-controls",r.autocompleteDisabled||!r.panelOpen||null==r.autocomplete?null:r.autocomplete.id)("aria-haspopup",r.autocompleteDisabled?null:"listbox")},inputs:{autocomplete:[0,"matAutocomplete","autocomplete"],position:[0,"matAutocompletePosition","position"],connectedTo:[0,"matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:[0,"autocomplete","autocompleteAttribute"],autocompleteDisabled:[2,"matAutocompleteDisabled","autocompleteDisabled",o.L39]},exportAs:["matAutocompleteTrigger"],standalone:!0,features:[o.Jv_([lae]),o.GFd,o.OA$]})}}return i})(),uae=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[dae],imports:[ES,rb,qn,os,Lb,rb,qn]})}}return i})();class hae extends Map{set(t,e){return"string"==typeof t&&(t=this.normalizeAccents(t).toLocaleLowerCase()),super.set(t,e)}get(t){return"string"==typeof t&&(t=this.normalizeAccents(t).toLocaleLowerCase()),super.get(t)}has(t){return"string"==typeof t&&(t=this.normalizeAccents(t).toLocaleLowerCase()),super.has(t)}normalizeAccents(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}}class S${constructor(t,e){this.value=t,this.count=0,this.children=new hae,this.word=e??""}get Value(){return this.value}get Count(){return this.count}set Count(t){this.count=t}set Word(t){this.word=t}get Word(){return this.word}incrementCount(){this.count++}}class fae{constructor(){this._rootNode=new S$("\0"),this.totalCount=0}Count(){return this.totalCount}Insert(t){let n,e=this._rootNode.children;for(let r=0;r<t.length;r++){const l=t[r];n=e.get(l),void 0===n&&(n=new S$(l),e.set(l,n)),e=n.children}n&&(n.incrementCount(),n.Word=t,this.totalCount++)}startWithGetNode(t){let e=this._rootNode.children;if(0===t.length)return[[this._rootNode.Value],this._rootNode];let n=null;const r=[];for(let l=0;l<t.length;l++){const C=e.get(t[l]);if(void 0===C)return null;r.push(t[l]),n=C,e=C.children}return null===n?null:[r,n]}getWordsWithPrefix(t,e=10){if(e<=0)return[];const n=this.startWithGetNode(t);if(null==n)return[];const[r,l]=n;return this.traverse(l,r,e)}traverse(t,e,n){if(void 0!==n&&n<0)return console.error("Invalid input in traverse method in Trie"),[];const r=[],l=new Set;e=e??[],n=n??this.totalCount,(t=t??this._rootNode)===this._rootNode&&e.pop();const m=C=>{for(const A of C.children.values())!l.has(A)&&r.length<n&&(l.add(A),e.push(A.Value),m(A));C.Count>0&&r.push(C.Word),e.length>0&&e?.pop()};return m(t),console.log(r),r}}class mae{constructor(t){this.collection=t,this.trie=new fae,this.words=[];for(const e of t)this.trie.Insert(e),this.words.push(e)}getWordsWithPrefix(t,e){return this.trie.getWordsWithPrefix(t,e)}get Words(){return this.words}}let M$=(()=>{class i{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(e){this._vertical=Es(e)}get inset(){return this._inset}set inset(e){this._inset=Es(e)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(n,r){2&n&&(o.BMQ("aria-orientation",r.vertical?"vertical":"horizontal"),o.AVh("mat-divider-vertical",r.vertical)("mat-divider-horizontal",!r.vertical)("mat-divider-inset",r.inset))},inputs:{vertical:"vertical",inset:"inset"},standalone:!0,features:[o.aNF],decls:0,vars:0,template:function(n,r){},styles:[".mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color);border-top-width:var(--mat-divider-width)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color);border-right-width:var(--mat-divider-width)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0})}}return i})(),BO=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,qn]})}}return i})(),pae=(()=>{class i{constructor(e){this.httpClient=e,this.EnaBaseUrl="https://www.ebi.ac.uk/ena/taxonomy/rest/",this.generalTaxaUrl="https://www.ebi.ac.uk/ena/taxonomy/rest/",this.suggestTaxaUrl="https://www.ebi.ac.uk/ena/taxonomy/rest/suggest-for-submission/"}getCommonName(e){let n=this.EnaBaseUrl+"scientific-name/";return n+=encodeURIComponent(e),this.httpClient.get(n)}getScientificName(e){const n=(new La).set("any-name",e);return this.httpClient.get(this.EnaBaseUrl,{params:n})}suggestName(e){const n=(new La).set("suggest-for-submission",e);return this.httpClient.get(this.EnaBaseUrl,{params:n})}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Em))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),gae=(()=>{class i{constructor(e){this.httpClient=e,this.baseUrl="https://api.wikimedia.org/core/v1/wikipedia/",this.endpoint="/search/page",this.openSearchUrl="https://en.wikipedia.org/w/api.php"}search(e,n=2,r="en"){const l=this.baseUrl+r+this.endpoint,m=(new La).set("q",e).set("limit",n);return this.httpClient.get(l,{params:m})}searchTitles(e,n=2){const r=this.openSearchUrl,l=(new La).set("action","opensearch").set("namespace","0").set("limit",n.toString()).set("search",e).set("origin","*").set("format","json");return this.httpClient.get(r,{params:l})}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Em))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const _ae=(i,t)=>t.link,vae=()=>[10,20,50];function bae(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",6)(1,"button",7),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.emitCloseComponentMessage())}),o.j41(2,"mat-icon"),o.EFF(3,"close"),o.k0s()()(),o.j41(4,"div",8),o.nrm(5,"mat-spinner"),o.k0s()}}function yae(i,t){if(1&i&&(o.nrm(0,"mat-divider"),o.j41(1,"mat-option",25),o.EFF(2),o.k0s()),2&i){const e=t.$implicit;o.R7$(),o.Y8G("value",e),o.R7$(),o.JRh(e)}}function xae(i,t){if(1&i){const e=o.RV6();o.j41(0,"button",26),o.bIt("click",function(){o.eBV(e);const r=o.XpG(3);return o.Njj(r.clearInput())}),o.j41(1,"mat-icon"),o.EFF(2,"clear"),o.k0s()()}}function wae(i,t){1&i&&o.nrm(0,"button",23)}function Cae(i,t){if(1&i){const e=o.RV6();o.j41(0,"th",15)(1,"div",16)(2,"form",17)(3,"mat-form-field",18)(4,"button",19),o.bIt("click",function(){o.eBV(e);const r=o.sdS(10),l=o.XpG(2);return o.Njj(l.loadData(r.value))}),o.j41(5,"mat-icon"),o.EFF(6,"search"),o.k0s()(),o.j41(7,"mat-label"),o.EFF(8,"Search"),o.k0s(),o.j41(9,"input",20,0),o.bIt("keyup",function(){o.eBV(e);const r=o.sdS(10),l=o.XpG(2);return o.Njj(l.filterEvent(r.value))}),o.k0s(),o.j41(11,"mat-autocomplete",21,1),o.bIt("optionSelected",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.selectOption(r))}),o.Z7z(13,yae,3,2,null,null,o.fX1),o.k0s(),o.DNE(15,xae,3,0,"button",22)(16,wae,1,0,"button",23),o.k0s()(),o.nrm(17,"span",24),o.j41(18,"button",7),o.bIt("click",function(){o.eBV(e);const r=o.XpG(2);return o.Njj(r.emitCloseComponentMessage())}),o.j41(19,"mat-icon"),o.EFF(20,"close"),o.k0s()()()()}if(2&i){const e=o.sdS(10),n=o.sdS(12),r=o.XpG(2);o.R7$(2),o.Y8G("formGroup",r.searchForm),o.R7$(7),o.Y8G("matAutocomplete",n),o.R7$(4),o.Dyx(r.currentOptions()),o.R7$(2),o.vxM(e.value.length>0?15:16)}}function Eae(i,t){if(1&i){const e=o.RV6();o.j41(0,"span"),o.nrm(1,"br"),o.EFF(2),o.nI1(3,"date"),o.nrm(4,"br"),o.EFF(5),o.nI1(6,"date"),o.nrm(7,"br")(8,"br"),o.k0s(),o.nrm(9,"div",24),o.j41(10,"button",37),o.bIt("click",function(){o.eBV(e);const r=o.XpG(2).$implicit,l=o.XpG(2);return o.Njj(l.panToMarker(r.id))}),o.nrm(11,"mat-icon",38),o.k0s()}if(2&i){const e=o.XpG(2).$implicit;o.R7$(2),o.SpI(" First Deployment: ",o.i5U(3,2,e.timestampFirstDeployedLocation,"short")," "),o.R7$(3),o.SpI(" Last Deployment: ",o.i5U(6,5,e.timestampLastDeployedLocation,"short")," ")}}function Tae(i,t){if(1&i){const e=o.RV6();o.nrm(0,"div",39)(1,"div",24),o.j41(2,"button",37),o.bIt("click",function(){o.eBV(e);const r=o.XpG(2).$implicit,l=o.XpG(2);return o.Njj(l.panToMarker(r.id))}),o.nrm(3,"mat-icon",40),o.k0s()}}function Sae(i,t){1&i&&(o.j41(0,"p"),o.EFF(1),o.k0s()),2&i&&(o.R7$(),o.SpI("Taxa: ",t,""))}function Mae(i,t){if(1&i&&(o.j41(0,"p"),o.EFF(1),o.k0s()),2&i){const e=o.XpG(2).$implicit;o.R7$(),o.SpI("Taxa: ",e.taxonIds,"")}}function Aae(i,t){if(1&i&&(o.j41(0,"h4"),o.EFF(1,"Objective"),o.k0s(),o.j41(2,"p"),o.EFF(3),o.k0s()),2&i){const e=o.XpG(2).$implicit;o.R7$(3),o.JRh(e.studyObjective)}}function Dae(i,t){if(1&i&&(o.j41(0,"p"),o.EFF(1),o.k0s()),2&i){const e=o.XpG(2).$implicit;o.R7$(),o.SpI("Sensors Used: ",e.sensorTypeIds,"")}}function kae(i,t){if(1&i&&(o.j41(0,"h4"),o.EFF(1,"Supported by"),o.k0s(),o.j41(2,"p"),o.EFF(3),o.k0s()),2&i){const e=o.XpG(2).$implicit;o.R7$(3),o.JRh(e.grantsUsed)}}function Iae(i,t){if(1&i&&(o.j41(0,"p"),o.EFF(1),o.k0s()),2&i){const e=o.XpG(2).$implicit;o.R7$(),o.JRh(e.citation)}}function Rae(i,t){if(1&i&&(o.j41(0,"a",41),o.EFF(1),o.k0s(),o.nrm(2,"br")),2&i){const e=t.$implicit;o.Y8G("href",e.link,o.B4B),o.R7$(),o.JRh(e.link)}}function Pae(i,t){1&i&&(o.nrm(0,"br"),o.j41(1,"h4"),o.EFF(2,"Links"),o.k0s(),o.Z7z(3,Rae,3,2,null,null,_ae)),2&i&&(o.R7$(3),o.Dyx(t))}function Oae(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",33),o.nI1(1,"async"),o.j41(2,"div",34),o.DNE(3,Eae,12,8)(4,Tae,4,0),o.k0s(),o.DNE(5,Sae,2,1,"p"),o.nI1(6,"async"),o.DNE(7,Mae,2,1,"p")(8,Aae,4,1),o.j41(9,"span"),o.EFF(10),o.k0s(),o.nrm(11,"br"),o.j41(12,"span"),o.EFF(13),o.k0s(),o.nrm(14,"br"),o.j41(15,"span"),o.EFF(16),o.k0s(),o.nrm(17,"br"),o.j41(18,"span"),o.EFF(19),o.k0s(),o.nrm(20,"br"),o.DNE(21,Dae,2,1,"p")(22,kae,4,1),o.j41(23,"div")(24,"h4"),o.EFF(25,"Acknowledgements"),o.k0s(),o.DNE(26,Iae,2,1,"p"),o.j41(27,"em"),o.EFF(28),o.nI1(29,"date"),o.k0s()(),o.DNE(30,Pae,5,0),o.nI1(31,"async"),o.nrm(32,"br"),o.j41(33,"div",35)(34,"button",36),o.bIt("click",function(){o.eBV(e),o.XpG();const r=o.sdS(2);return o.Njj(r.close())}),o.j41(35,"mat-icon"),o.EFF(36,"expand_less"),o.k0s()()()()}if(2&i){let e,n;const r=o.XpG(),l=r.$implicit,m=r.index,C=o.XpG(2);o.Y8G("ngStyle",o.bMT(1,15,C.screenChange)?C.smallContentStyle:C.largeContentStyle),o.R7$(3),o.vxM(l.timestampFirstDeployedLocation&&l.timestampLastDeployedLocation?3:4),o.R7$(2),o.vxM((e=l.taxonIds&&o.bMT(6,17,C.commonNames$[m]))?5:l.taxonIds?7:-1,e),o.R7$(3),o.vxM(l.studyObjective?8:-1),o.R7$(2),o.SpI("Deployments: ",l.numberOfDeployments,""),o.R7$(3),o.SpI("Individuals: ",l.numberOfIndividuals,""),o.R7$(3),o.SpI("# Of Sensors: ",l.numberOfTags,""),o.R7$(3),o.SpI("Number of deployed locations: ",l.numberOfDeployedLocations,""),o.R7$(2),o.vxM(l.sensorTypeIds?21:-1),o.R7$(),o.vxM(l.grantsUsed?22:-1),o.R7$(4),o.vxM(l.citation?26:-1),o.R7$(2),o.E5c('This study is was accessed from Movebank.org ("',l.name,'", study ID ',l.id,") on ",o.i5U(29,19,C.currentDate(),"full"),""),o.R7$(2),o.vxM((n=o.bMT(31,22,C.wikipediaLinks$[m]))?30:-1,n)}}function Lae(i,t){if(1&i&&(o.j41(0,"td",27)(1,"mat-expansion-panel",28,2),o.nI1(3,"async"),o.j41(4,"mat-expansion-panel-header",29)(5,"div",30)(6,"span",31),o.EFF(7),o.k0s()()(),o.DNE(8,Oae,37,24,"ng-template",32),o.k0s()()),2&i){const e=t.$implicit,n=o.XpG(2);o.R7$(),o.Y8G("ngStyle",o.bMT(3,2,n.screenChange)?n.smallHeaderStyle:n.largeHeaderStyle),o.R7$(6),o.SpI(" ",e.name,"")}}function Fae(i,t){1&i&&o.nrm(0,"tr",42)}function Nae(i,t){1&i&&o.nrm(0,"tr",43)}function Bae(i,t){if(1&i&&(o.j41(0,"table",9),o.qex(1,10),o.DNE(2,Cae,21,3,"th",11)(3,Lae,9,4,"td",12),o.bVm(),o.DNE(4,Fae,1,0,"tr",13)(5,Nae,1,0,"tr",14),o.k0s()),2&i){const e=o.XpG();o.Y8G("dataSource",e.studies)("trackBy",e.trackStudy),o.R7$(4),o.Y8G("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),o.R7$(),o.Y8G("matRowDefColumns",e.displayedColumns)}}let Vae=(()=>{class i{constructor(e,n,r,l){this.studyService=e,this.enaService=n,this.wikipediaService=r,this.breakpointObserver=l,this.displayedColumns=["name"],this.commonNames$=[],this.wikipediaLinks$=[],this.defaultPageIndex=0,this.defaultPageSize=10,this.defaultSortColumn="name",this.defaultFilterColumn="name",this.filterTextChanged=new xi.B,this.currentOptions=(0,o.vPA)([]),this.studiesLoaded=(0,o.vPA)(!1),this.searchForm=new nC({filterQuery:new df("",{nonNullable:!0}),dropDownList:new df("asc",{nonNullable:!0})}),this.panToMarkerEvent=new o.bkB,this.componentInitialized=new o.bkB,this.closeComponent=new o.bkB,this.studyNames=[],this.breakpointMatches=(0,o.vPA)(!1),this.smallHeaderStyle={"min-width":"80px","max-width":"350px","word-break":"break-word"},this.largeHeaderStyle={width:"350px","word-break":"break-word"},this.smallContentStyle={"min-width":"80px","max-width":"310px","word-break":"break-word"},this.largeContentStyle={width:"310px","word-break":"break-word"}}currentDate(){return new Date}ngOnInit(){for(let e=0;e<this.defaultPageSize;e++)this.commonNames$.push(void 0),this.wikipediaLinks$.push(void 0);this.loadData(),this.screenChange=this.breakpointObserver.observe([Cc_XSmall,Cc_Small]).pipe((0,st.T)(e=>(this.breakpointMatches.set(e.matches),e.matches)))}ngOnChanges(e){for(const n in e){const r=e[n].currentValue;void 0!==r&&"allStudies"===n&&(this.allStudies=r,this.studyNames=Array.from(this.allStudies.values()).map(l=>l.name),this.initializeAutoComplete(this.studyNames))}}ngAfterViewInit(){this.componentInitialized.emit(!0)}ngOnDestroy(){}emitCloseComponentMessage(){this.closeComponent.emit(!0)}getAutoCompleteOptions(e){return this.autoComplete?.getWordsWithPrefix(e,5)??[]}initializeAutoComplete(e){void 0===this.autoComplete&&(this.autoComplete=new mae(e))}trackStudy(e,n){return`${n.id}`}hasLocation(e){return!!this.studies&&void 0!==e.mainLocationLat&&void 0!==e.mainLocationLon}filterEvent(e){void 0!==e&&(this.filterTextChanged.observed||this.filterTextChanged.pipe(Uh(100),su()).subscribe({next:n=>{this.currentOptions.set(this.getAutoCompleteOptions(n))},error:n=>console.log(n)}),this.filterTextChanged.next(e))}panToMarker(e){this.panToMarkerEvent.emit(e),this.breakpointMatches()&&this.emitCloseComponentMessage()}get filterQuery(){return this.searchForm.controls.filterQuery}get dropDownList(){return this.searchForm.controls.dropDownList}getTaxa(e){const n=e.trim().split(",");return e&&0!==n.length?bo(...n.map(l=>this.enaService.getCommonName(l.trim()).pipe((0,st.T)(m=>m.length>0?[l,m[0].commonName??null]:[l,null]),xa(()=>(console.error("Caught error in ENA service with taxon: "+l),di([l,null])))))).pipe(y8((l,m)=>(l.push(null!==m[1]?`${m[0]} (${m[1]})`:`${m[0]}`),l),[]),(0,st.T)(l=>l.join(", "))):nr}searchWikipedia(e){const n=e.trim().split(",");return e&&0!==n.length?bo(...n.map(l=>this.wikipediaService.searchTitles(l).pipe((0,st.T)(m=>{const C=[];return m[1].forEach((A,O)=>{C.push({title:A,link:m[3][O]})}),C}),xa(m=>(console.error(m),di([])))))).pipe(y8((l,m)=>(l.push(...m),l),[])):di([])}isExpanded(e){return!!this.panelExpanded&&0<=e&&e<this.panelExpanded.length&&this.panelExpanded[e]}sortData(e){this.searchForm.controls.dropDownList.setValue(e);const n=new XH;n.pageIndex=0,n.pageSize=this.paginator?.pageSize??this.defaultPageSize,this.getData(n)}clearInput(){""!==this.filterQuery.value&&(this.filterQuery.setValue(""),this.loadData())}loadData(e){e&&this.filterQuery.setValue(e);const n=new XH;n.pageIndex=this.defaultPageIndex,n.pageSize=this.defaultPageSize,this.getData(n)}selectOption(e){this.loadData(e.option.viewValue)}getData(e){this.studyService.getStudies(e.pageIndex,e.pageSize,this.defaultSortColumn,this.dropDownList.value,this.defaultFilterColumn,this.filterQuery.value).subscribe({next:O=>{this.studiesLoaded.set(!0),this.paginator.length=O.totalCount,this.paginator.pageIndex=O.pageIndex,this.paginator.pageSize=O.pageSize,this.studies=new Fse(O.data),this.commonNames$=[],this.wikipediaLinks$=[];for(let z=0;z<Math.min(this.paginator.pageSize,O.data.length);z++)this.studies.data[z].taxonIds?(this.commonNames$.push(this.getTaxa(this.studies.data[z].taxonIds??"")),this.wikipediaLinks$.push(this.searchWikipedia(this.studies.data[z].taxonIds??""))):(this.commonNames$.push(void 0),this.wikipediaLinks$.push(void 0))},error:O=>{console.error(O)}})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(oO),o.rXU(pae),o.rXU(gae),o.rXU(sa))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-simple-search"]],viewQuery:function(n,r){if(1&n&&o.GBs($V,5),2&n){let l;o.mGM(l=o.lsd())&&(r.paginator=l.first)}},inputs:{allStudies:"allStudies"},outputs:{panToMarkerEvent:"panToMarkerEvent",componentInitialized:"componentInitialized",closeComponent:"closeComponent"},standalone:!0,features:[o.OA$,o.aNF],decls:4,vars:5,consts:[["Filter",""],["auto","matAutocomplete"],["ExpansionPanel",""],[1,"table-container"],["mat-table","","class","mat-elevation-z8",3,"dataSource","trackBy",4,"ngIf"],["showFirstLastButtons","",1,"paginator",3,"page","pageSize","pageSizeOptions"],[1,"unloaded"],["mat-icon-button","","aria-label","Close Search Menu",1,"close-button",3,"click"],[1,"spinner"],["mat-table","",1,"mat-elevation-z8",3,"dataSource","trackBy"],["matColumnDef","name",1,"cell-container"],["mat-header-cell","","class","cell-header",4,"matHeaderCellDef"],["mat-cell","","class","study-header-cell",4,"matCellDef"],["mat-header-row","","class","header-row",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","study-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"cell-header"],[1,"first-row"],[3,"formGroup"],["id","search-form","appearance","outline",1,"dense-3"],["matPrefix","","mat-icon-button","","aria-label","Search",3,"click"],["matInput","","type","text","formControlName","filterQuery",1,"search-input",3,"keyup","matAutocomplete"],[1,"auto-complete",3,"optionSelected"],["matSuffix","","mat-icon-button","","aria-label","clear search"],["matSuffix","","mat-icon-button","","aria-label","placeholder",2,"visibility","hidden"],[1,"spacer"],[3,"value"],["matSuffix","","mat-icon-button","","aria-label","clear search",3,"click"],["mat-cell","",1,"study-header-cell"],["id","expansion-panel",1,"mat-elevation-z0",3,"ngStyle"],["collapsedHeight","auto","expandedHeight","auto"],[1,"header-container"],[1,"header-content"],["matExpansionPanelContent","",1,"expansion-panel-content"],[1,"expansion-content",3,"ngStyle"],[1,"content-first-row"],[1,"close-button-container"],["mat-icon-button","","aria-label","Close the expansion panel.",3,"click"],["matTooltip","Pan to study location.","mat-mini-fab","",1,"mini-button",3,"click"],["aria-label","Pan to study location.","fontIcon","location_searching"],["hidden",""],["aria-label","Location not available.","fontIcon","location_searching"],[1,"link",3,"href"],["mat-header-row","",1,"header-row"],["mat-row","",1,"study-row"]],template:function(n,r){1&n&&(o.j41(0,"div",3),o.DNE(1,bae,6,0)(2,Bae,6,5,"table",4),o.k0s(),o.j41(3,"mat-paginator",5),o.bIt("page",function(m){return r.getData(m)}),o.k0s()),2&n&&(o.R7$(),o.vxM(void 0===r.studies?1:-1),o.R7$(),o.Y8G("ngIf",r.studies),o.R7$(),o.Y8G("pageSize",10)("pageSizeOptions",o.lJ4(4,vae)))},dependencies:[fc,d$,sz,PO,az,OO,RO,lz,LO,FO,cz,dz,TO,HV,Pk,vO,Tk,Sk,lO,wO,Fb,Rk,kS,Lk,Ok,woe,UV,fz,hz,rb,Gp,y$,v$,qse,g$,Er,Mr,mc,qH,$V,BO,M$,xf,Z_,uV,dV,JH,ea,mu,jE,uae,aae,T$],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.unloaded[_ngcontent-%COMP%]{display:flex;justify-content:right;align-items:right}.first-row[_ngcontent-%COMP%]{display:flex}#search-form[_ngcontent-%COMP%]{margin-left:1em;margin-top:1em}.content-first-row[_ngcontent-%COMP%]{display:flex}.link[_ngcontent-%COMP%]{word-break:break-all}.table-container[_ngcontent-%COMP%]{position:relative;max-height:90vh;overflow-y:scroll}.mini-button[_ngcontent-%COMP%]{position:relative;margin-top:1em;background-color:#efefef;color:#000}.spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.close-button-container[_ngcontent-%COMP%]{display:flex;justify-content:right;height:4em}.close-button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:5px}.close-button[_ngcontent-%COMP%]{margin-top:.5em}.close-button-fab[_ngcontent-%COMP%]{position:fixed;z-index:100;top:45vh;left:370px;background-color:#fff;color:#000}.paginator-container[_ngcontent-%COMP%]{align-content:left;justify-content:left;justify-items:left}.column-header[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}}return i})();const VO=["*"],zae=["content"],Uae=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],jae=["mat-drawer","mat-drawer-content","*"];function Gae(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",1),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r._onBackdropClicked())}),o.k0s()}if(2&i){const e=o.XpG();o.AVh("mat-drawer-shown",e._isShowingBackdrop())}}function Hae(i,t){1&i&&(o.j41(0,"mat-drawer-content"),o.SdG(1,2),o.k0s())}const $ae=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],Wae=["mat-sidenav","mat-sidenav-content","*"];function Xae(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",1),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r._onBackdropClicked())}),o.k0s()}if(2&i){const e=o.XpG();o.AVh("mat-drawer-shown",e._isShowingBackdrop())}}function qae(i,t){1&i&&(o.j41(0,"mat-sidenav-content"),o.SdG(1,2),o.k0s())}const A$={transformDrawer:js("transform",[Lo("open, open-instant",gn({transform:"none",visibility:"visible"})),Lo("void",gn({"box-shadow":"none",visibility:"hidden"})),oo("void => open-instant",co("0ms")),oo("void <=> open, open-instant => void",co("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},Zae=new o.nKC("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Kae(){return!1}}),mz=new o.nKC("MAT_DRAWER_CONTAINER");let zO=(()=>{class i extends wS{constructor(e,n,r,l,m){super(r,l,m),this._changeDetectorRef=e,this._container=n}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.rXU((0,o.Rfq)(()=>k$)),o.rXU(o.aKT),o.rXU(Ek),o.rXU(o.SKi))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(n,r){2&n&&o.xc7("margin-left",r._container._contentMargins.left,"px")("margin-right",r._container._contentMargins.right,"px")},standalone:!0,features:[o.Jv_([{provide:wS,useExisting:i}]),o.Vt3,o.aNF],ngContentSelectors:VO,decls:1,vars:0,template:function(n,r){1&n&&(o.NAR(),o.SdG(0))},encapsulation:2,changeDetection:0})}}return i})(),D$=(()=>{class i{get position(){return this._position}set position(e){(e="end"===e?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(e),this._position=e,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(e){this._disableClose=Es(e)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(e){("true"===e||"false"===e||null==e)&&(e=Es(e)),this._autoFocus=e}get opened(){return this._opened}set opened(e){this.toggle(Es(e))}constructor(e,n,r,l,m,C,A,O){this._elementRef=e,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=l,this._ngZone=m,this._interactivityChecker=C,this._doc=A,this._container=O,this._focusTrap=null,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new xi.B,this._animationEnd=new xi.B,this._animationState="void",this.openedChange=new o.bkB(!0),this._openedStream=this.openedChange.pipe(Ur(z=>z),(0,st.T)(()=>{})),this.openedStart=this._animationStarted.pipe(Ur(z=>z.fromState!==z.toState&&0===z.toState.indexOf("open")),vo(void 0)),this._closedStream=this.openedChange.pipe(Ur(z=>!z),(0,st.T)(()=>{})),this.closedStart=this._animationStarted.pipe(Ur(z=>z.fromState!==z.toState&&"void"===z.toState),vo(void 0)),this._destroyed=new xi.B,this.onPositionChanged=new o.bkB,this._modeChanged=new xi.B,this._injector=(0,o.WQX)(o.zZn),this._changeDetectorRef=(0,o.WQX)(o.gRc),this.openedChange.pipe(dn(this._destroyed)).subscribe(z=>{z?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{bu(this._elementRef.nativeElement,"keydown").pipe(Ur(z=>27===z.keyCode&&!this.disableClose&&!oa(z)),dn(this._destroyed)).subscribe(z=>this._ngZone.run(()=>{this.close(),z.stopPropagation(),z.preventDefault()}))}),this._animationEnd.pipe(su((z,$)=>z.fromState===$.fromState&&z.toState===$.toState)).subscribe(z=>{const{fromState:$,toState:Q}=z;(0===Q.indexOf("open")&&"void"===$||"void"===Q&&0===$.indexOf("open"))&&this.openedChange.emit(this._opened)})}_forceFocus(e,n){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{e.removeEventListener("blur",r),e.removeEventListener("mousedown",r),e.removeAttribute("tabindex")};e.addEventListener("blur",r),e.addEventListener("mousedown",r)})),e.focus(n)}_focusByCssSelector(e,n){let r=this._elementRef.nativeElement.querySelector(e);r&&this._forceFocus(r,n)}_takeFocus(){if(!this._focusTrap)return;const e=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":(0,o.mal)(()=>{!this._focusTrap.focusInitialElement()&&"function"==typeof e.focus&&e.focus()},{injector:this._injector});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(e){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,e):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const e=this._doc.activeElement;return!!e&&this._elementRef.nativeElement.contains(e)}ngAfterViewInit(){this._isAttached=!0,"end"===this._position&&this._updatePositionInParent("end"),this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState())}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap?.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(e){return this.toggle(!0,e)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(e=!this.opened,n){e&&n&&(this._openedVia=n);const r=this._setOpen(e,!e&&this._isFocusWithinDrawer(),this._openedVia||"program");return e||(this._openedVia=null),r}_setOpen(e,n,r){return this._opened=e,e?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",n&&this._restoreFocus(r)),this._changeDetectorRef.markForCheck(),this._updateFocusTrapState(),new Promise(l=>{this.openedChange.pipe(gs(1)).subscribe(m=>l(m?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=!!this._container?.hasBackdrop)}_updatePositionInParent(e){if(!this._platform.isBrowser)return;const n=this._elementRef.nativeElement,r=n.parentNode;"end"===e?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,n)),r.appendChild(n)):this._anchor&&this._anchor.parentNode.insertBefore(n,this._anchor)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o_),o.rXU(Kc),o.rXU(wo),o.rXU(o.SKi),o.rXU(Dd),o.rXU(Nn,8),o.rXU(mz,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-drawer"]],viewQuery:function(n,r){if(1&n&&o.GBs(zae,5),2&n){let l;o.mGM(l=o.lsd())&&(r._content=l.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(n,r){1&n&&o.Kam("@transform.start",function(m){return r._animationStarted.next(m)})("@transform.done",function(m){return r._animationEnd.next(m)}),2&n&&(o.zvX("@transform",r._animationState),o.BMQ("align",null),o.AVh("mat-drawer-end","end"===r.position)("mat-drawer-over","over"===r.mode)("mat-drawer-push","push"===r.mode)("mat-drawer-side","side"===r.mode)("mat-drawer-opened",r.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],standalone:!0,features:[o.aNF],ngContentSelectors:VO,decls:3,vars:0,consts:[["content",""],["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(n,r){1&n&&(o.NAR(),o.j41(0,"div",1,0),o.SdG(2),o.k0s())},dependencies:[wS],encapsulation:2,data:{animation:[A$.transformDrawer]},changeDetection:0})}}return i})(),k$=(()=>{class i{get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(e){this._autosize=Es(e)}get hasBackdrop(){return this._drawerHasBackdrop(this._start)||this._drawerHasBackdrop(this._end)}set hasBackdrop(e){this._backdropOverride=null==e?null:Es(e)}get scrollable(){return this._userContent||this._content}constructor(e,n,r,l,m,C=!1,A){this._dir=e,this._element=n,this._ngZone=r,this._changeDetectorRef=l,this._animationMode=A,this._drawers=new o.rOR,this.backdropClick=new o.bkB,this._destroyed=new xi.B,this._doCheckSubject=new xi.B,this._contentMargins={left:null,right:null},this._contentMarginChanges=new xi.B,this._injector=(0,o.WQX)(o.zZn),e&&e.change.pipe(dn(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),m.change().pipe(dn(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=C}ngAfterContentInit(){this._allDrawers.changes.pipe(As(this._allDrawers),dn(this._destroyed)).subscribe(e=>{this._drawers.reset(e.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(As(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(e=>{this._watchDrawerToggle(e),this._watchDrawerPosition(e),this._watchDrawerMode(e)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(Uh(10),dn(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(e=>e.open())}close(){this._drawers.forEach(e=>e.close())}updateContentMargins(){let e=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)e+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();e+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();n+=r,e-=r}e=e||null,n=n||null,(e!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:e,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(e){e._animationStarted.pipe(Ur(n=>n.fromState!==n.toState),dn(this._drawers.changes)).subscribe(n=>{"open-instant"!==n.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==e.mode&&e.openedChange.pipe(dn(this._drawers.changes)).subscribe(()=>this._setContainerClass(e.opened))}_watchDrawerPosition(e){e&&e.onPositionChanged.pipe(dn(this._drawers.changes)).subscribe(()=>{(0,o.mal)(()=>{this._validateDrawers()},{injector:this._injector,phase:o.wjH.Read})})}_watchDrawerMode(e){e&&e._modeChanged.pipe(dn(Io(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(e){const n=this._element.nativeElement.classList,r="mat-drawer-container-has-open";e?n.add(r):n.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(e=>{"end"==e.position?this._end=e:this._start=e}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(e=>e&&!e.disableClose&&this._drawerHasBackdrop(e)).forEach(e=>e._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._drawerHasBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._drawerHasBackdrop(this._end)}_isDrawerOpen(e){return null!=e&&e.opened}_drawerHasBackdrop(e){return null==this._backdropOverride?!!e&&"side"!==e.mode:this._backdropOverride}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(Us,8),o.rXU(o.aKT),o.rXU(o.SKi),o.rXU(o.gRc),o.rXU(_x),o.rXU(Zae),o.rXU(o.bc$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,zO,5),o.wni(l,D$,5)),2&n){let m;o.mGM(m=o.lsd())&&(r._content=m.first),o.mGM(m=o.lsd())&&(r._allDrawers=m)}},viewQuery:function(n,r){if(1&n&&o.GBs(zO,5),2&n){let l;o.mGM(l=o.lsd())&&(r._userContent=l.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(n,r){2&n&&o.AVh("mat-drawer-container-explicit-backdrop",r._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],standalone:!0,features:[o.Jv_([{provide:mz,useExisting:i}]),o.aNF],ngContentSelectors:jae,decls:4,vars:2,consts:[[1,"mat-drawer-backdrop",3,"mat-drawer-shown"],[1,"mat-drawer-backdrop",3,"click"]],template:function(n,r){1&n&&(o.NAR(Uae),o.DNE(0,Gae,1,2,"div",0),o.SdG(1),o.SdG(2,1),o.DNE(3,Hae,2,0,"mat-drawer-content")),2&n&&(o.vxM(r.hasBackdrop?0:-1),o.R7$(3),o.vxM(r._content?-1:3))},dependencies:[zO],styles:['.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color);background-color:var(--mat-sidenav-content-background-color);box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color)}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;color:var(--mat-sidenav-container-text-color);box-shadow:var(--mat-sidenav-container-elevation-shadow);background-color:var(--mat-sidenav-container-background-color);border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);width:var(--mat-sidenav-container-width);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0})}}return i})(),pz=(()=>{class i extends zO{constructor(e,n,r,l,m){super(e,n,r,l,m)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.rXU((0,o.Rfq)(()=>R$)),o.rXU(o.aKT),o.rXU(Ek),o.rXU(o.SKi))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(n,r){2&n&&o.xc7("margin-left",r._container._contentMargins.left,"px")("margin-right",r._container._contentMargins.right,"px")},standalone:!0,features:[o.Jv_([{provide:wS,useExisting:i}]),o.Vt3,o.aNF],ngContentSelectors:VO,decls:1,vars:0,template:function(n,r){1&n&&(o.NAR(),o.SdG(0))},encapsulation:2,changeDetection:0})}}return i})(),I$=(()=>{class i extends D${constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(e){this._fixedInViewport=Es(e)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(e){this._fixedTopGap=au(e)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(e){this._fixedBottomGap=au(e)}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(n,r){2&n&&(o.BMQ("align",null),o.xc7("top",r.fixedInViewport?r.fixedTopGap:null,"px")("bottom",r.fixedInViewport?r.fixedBottomGap:null,"px"),o.AVh("mat-drawer-end","end"===r.position)("mat-drawer-over","over"===r.mode)("mat-drawer-push","push"===r.mode)("mat-drawer-side","side"===r.mode)("mat-drawer-opened",r.opened)("mat-sidenav-fixed",r.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],standalone:!0,features:[o.Vt3,o.aNF],ngContentSelectors:VO,decls:3,vars:0,consts:[["content",""],["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(n,r){1&n&&(o.NAR(),o.j41(0,"div",1,0),o.SdG(2),o.k0s())},dependencies:[wS],encapsulation:2,data:{animation:[A$.transformDrawer]},changeDetection:0})}}return i})(),R$=(()=>{class i extends k${constructor(){super(...arguments),this._allDrawers=void 0,this._content=void 0}static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=o.xGo(i)))(r||i)}})()}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,pz,5),o.wni(l,I$,5)),2&n){let m;o.mGM(m=o.lsd())&&(r._content=m.first),o.mGM(m=o.lsd())&&(r._allDrawers=m)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(n,r){2&n&&o.AVh("mat-drawer-container-explicit-backdrop",r._backdropOverride)},exportAs:["matSidenavContainer"],standalone:!0,features:[o.Jv_([{provide:mz,useExisting:i}]),o.Vt3,o.aNF],ngContentSelectors:Wae,decls:4,vars:2,consts:[[1,"mat-drawer-backdrop",3,"mat-drawer-shown"],[1,"mat-drawer-backdrop",3,"click"]],template:function(n,r){1&n&&(o.NAR($ae),o.DNE(0,Xae,1,2,"div",0),o.SdG(1),o.SdG(2,1),o.DNE(3,qae,2,0,"mat-sidenav-content")),2&n&&(o.vxM(r.hasBackdrop?0:-1),o.R7$(3),o.vxM(r._content?-1:3))},dependencies:[pz],styles:['.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color);background-color:var(--mat-sidenav-content-background-color);box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color)}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;color:var(--mat-sidenav-container-text-color);box-shadow:var(--mat-sidenav-container-elevation-shadow);background-color:var(--mat-sidenav-container-background-color);border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);width:var(--mat-sidenav-container-width);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape);border-bottom-left-radius:var(--mat-sidenav-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape);border-bottom-right-radius:var(--mat-sidenav-container-shape);border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0})}}return i})(),Qae=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,Lb,Lb,qn]})}}return i})();const ele=["gps","bird ring","radio transmitter","argos doppler shift","natural mark","solar geolocator","acoustic telemetry","sigfox geolocation"];function tle(i){return void 0===i?[]:("string"==typeof i&&(i=i.trim().split(",")),i.filter(e=>function P$(i){return ele.some(t=>i.toLowerCase()===t)}(e)))}let Ile=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[kp,os,qn,ul,xm,BO]})}}return i})();const _z=["*"];function Rle(i,t){1&i&&o.SdG(0)}const Ple=["tabListContainer"],Ole=["tabList"],Lle=["tabListInner"],Fle=["nextPaginator"],Nle=["previousPaginator"],Ble=i=>({animationDuration:i}),Vle=(i,t)=>({value:i,params:t});function zle(i,t){}const Ule=["tabBodyWrapper"],jle=["tabHeader"];function Gle(i,t){}function Hle(i,t){if(1&i&&o.DNE(0,Gle,0,0,"ng-template",12),2&i){const e=o.XpG().$implicit;o.Y8G("cdkPortalOutlet",e.templateLabel)}}function $le(i,t){if(1&i&&o.EFF(0),2&i){const e=o.XpG().$implicit;o.JRh(e.textLabel)}}function Wle(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",7,2),o.bIt("click",function(){const r=o.eBV(e),l=r.$implicit,m=r.$index,C=o.XpG(),A=o.sdS(1);return o.Njj(C._handleClick(l,A,m))})("cdkFocusChange",function(r){const l=o.eBV(e).$index,m=o.XpG();return o.Njj(m._tabFocusChanged(r,l))}),o.nrm(2,"span",8)(3,"div",9),o.j41(4,"span",10)(5,"span",11),o.DNE(6,Hle,1,1,null,12)(7,$le,1,1),o.k0s()()()}if(2&i){const e=t.$implicit,n=t.$index,r=o.sdS(1),l=o.XpG();o.HbH(e.labelClass),o.AVh("mdc-tab--active",l.selectedIndex===n),o.Y8G("id",l._getTabLabelId(n))("disabled",e.disabled)("fitInkBarToContent",l.fitInkBarToContent),o.BMQ("tabIndex",l._getTabIndex(n))("aria-posinset",n+1)("aria-setsize",l._tabs.length)("aria-controls",l._getTabContentId(n))("aria-selected",l.selectedIndex===n)("aria-label",e.ariaLabel||null)("aria-labelledby",!e.ariaLabel&&e.ariaLabelledby?e.ariaLabelledby:null),o.R7$(3),o.Y8G("matRippleTrigger",r)("matRippleDisabled",e.disabled||l.disableRipple),o.R7$(3),o.vxM(e.templateLabel?6:7)}}function Xle(i,t){1&i&&o.SdG(0)}function qle(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-tab-body",13),o.bIt("_onCentered",function(){o.eBV(e);const r=o.XpG();return o.Njj(r._removeTabBodyWrapperHeight())})("_onCentering",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._setTabBodyWrapperHeight(r))}),o.k0s()}if(2&i){const e=t.$implicit,n=t.$index,r=o.XpG();o.HbH(e.bodyClass),o.AVh("mat-mdc-tab-body-active",r.selectedIndex===n),o.Y8G("id",r._getTabContentId(n))("content",e.content)("position",e.position)("origin",e.origin)("animationDuration",r.animationDuration)("preserveContent",r.preserveContent),o.BMQ("tabindex",null!=r.contentTabIndex&&r.selectedIndex===n?r.contentTabIndex:null)("aria-labelledby",r._getTabLabelId(n))("aria-hidden",r.selectedIndex!==n)}}const Yle=new o.nKC("MatTabContent");let Zle=(()=>{class i{constructor(e){this.template=e}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matTabContent",""]],standalone:!0,features:[o.Jv_([{provide:Yle,useExisting:i}])]})}}return i})();const Kle=new o.nKC("MatTabLabel"),B$=new o.nKC("MAT_TAB");let Qle=(()=>{class i extends tne{constructor(e,n,r){super(e,n),this._closestTab=r}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.C4Q),o.rXU(o.c1b),o.rXU(B$,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],standalone:!0,features:[o.Jv_([{provide:Kle,useExisting:i}]),o.Vt3]})}}return i})();const V$=new o.nKC("MAT_TAB_GROUP");let z$=(()=>{class i{get templateLabel(){return this._templateLabel}set templateLabel(e){this._setTemplateLabelInput(e)}get content(){return this._contentPortal}constructor(e,n){this._viewContainerRef=e,this._closestTabGroup=n,this.disabled=!1,this._explicitContent=void 0,this.textLabel="",this._contentPortal=null,this._stateChanges=new xi.B,this.position=null,this.origin=null,this.isActive=!1}ngOnChanges(e){(e.hasOwnProperty("textLabel")||e.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new px(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(e){e&&e._closestTab===this&&(this._templateLabel=e)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.c1b),o.rXU(V$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-tab"]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,Qle,5),o.wni(l,Zle,7,o.C4Q)),2&n){let m;o.mGM(m=o.lsd())&&(r.templateLabel=m.first),o.mGM(m=o.lsd())&&(r._explicitContent=m.first)}},viewQuery:function(n,r){if(1&n&&o.GBs(o.C4Q,7),2&n){let l;o.mGM(l=o.lsd())&&(r._implicitContent=l.first)}},hostAttrs:["hidden",""],inputs:{disabled:[2,"disabled","disabled",o.L39],textLabel:[0,"label","textLabel"],ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],labelClass:"labelClass",bodyClass:"bodyClass"},exportAs:["matTab"],standalone:!0,features:[o.Jv_([{provide:B$,useExisting:i}]),o.GFd,o.OA$,o.aNF],ngContentSelectors:_z,decls:1,vars:0,template:function(n,r){1&n&&(o.NAR(),o.DNE(0,Rle,1,0,"ng-template"))},encapsulation:2})}}return i})();const vz="mdc-tab-indicator--active",U$="mdc-tab-indicator--no-transition";class Jle{constructor(t){this._items=t}hide(){this._items.forEach(t=>t.deactivateInkBar())}alignToElement(t){const e=this._items.find(r=>r.elementRef.nativeElement===t),n=this._currentItem;if(e!==n&&(n?.deactivateInkBar(),e)){const r=n?.elementRef.nativeElement.getBoundingClientRect?.();e.activateInkBar(r),this._currentItem=e}}}let ece=(()=>{class i{constructor(){this._elementRef=(0,o.WQX)(o.aKT),this._fitToContent=!1}get fitInkBarToContent(){return this._fitToContent}set fitInkBarToContent(e){this._fitToContent!==e&&(this._fitToContent=e,this._inkBarElement&&this._appendInkBarElement())}activateInkBar(e){const n=this._elementRef.nativeElement;if(!e||!n.getBoundingClientRect||!this._inkBarContentElement)return void n.classList.add(vz);const r=n.getBoundingClientRect(),l=e.width/r.width,m=e.left-r.left;n.classList.add(U$),this._inkBarContentElement.style.setProperty("transform",`translateX(${m}px) scaleX(${l})`),n.getBoundingClientRect(),n.classList.remove(U$),n.classList.add(vz),this._inkBarContentElement.style.setProperty("transform","")}deactivateInkBar(){this._elementRef.nativeElement.classList.remove(vz)}ngOnInit(){this._createInkBarElement()}ngOnDestroy(){this._inkBarElement?.remove(),this._inkBarElement=this._inkBarContentElement=null}_createInkBarElement(){const e=this._elementRef.nativeElement.ownerDocument||document,n=this._inkBarElement=e.createElement("span"),r=this._inkBarContentElement=e.createElement("span");n.className="mdc-tab-indicator",r.className="mdc-tab-indicator__content mdc-tab-indicator__content--underline",n.appendChild(this._inkBarContentElement),this._appendInkBarElement()}_appendInkBarElement(){(this._fitToContent?this._elementRef.nativeElement.querySelector(".mdc-tab__content"):this._elementRef.nativeElement).appendChild(this._inkBarElement)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,inputs:{fitInkBarToContent:[2,"fitInkBarToContent","fitInkBarToContent",o.L39]},features:[o.GFd]})}}return i})(),j$=(()=>{class i extends ece{constructor(e){super(),this.elementRef=e,this.disabled=!1}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(n,r){2&n&&(o.BMQ("aria-disabled",!!r.disabled),o.AVh("mat-mdc-tab-disabled",r.disabled))},inputs:{disabled:[2,"disabled","disabled",o.L39]},standalone:!0,features:[o.GFd,o.Vt3]})}}return i})();const G$=Ql({passive:!0});let rce=(()=>{class i{get selectedIndex(){return this._selectedIndex}set selectedIndex(e){const n=isNaN(e)?0:e;this._selectedIndex!=n&&(this._selectedIndexChanged=!0,this._selectedIndex=n,this._keyManager&&this._keyManager.updateActiveItem(n))}constructor(e,n,r,l,m,C,A){this._elementRef=e,this._changeDetectorRef=n,this._viewportRuler=r,this._dir=l,this._ngZone=m,this._platform=C,this._animationMode=A,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new xi.B,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new xi.B,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new o.bkB,this.indexFocused=new o.bkB,this._sharedResizeObserver=(0,o.WQX)(wH),this._injector=(0,o.WQX)(o.zZn),m.runOutsideAngular(()=>{bu(e.nativeElement,"mouseleave").pipe(dn(this._destroyed)).subscribe(()=>{this._stopInterval()})})}ngAfterViewInit(){bu(this._previousPaginator.nativeElement,"touchstart",G$).pipe(dn(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),bu(this._nextPaginator.nativeElement,"touchstart",G$).pipe(dn(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const e=this._dir?this._dir.change:di("ltr"),n=this._sharedResizeObserver.observe(this._elementRef.nativeElement).pipe(Uh(32),dn(this._destroyed)),r=this._viewportRuler.change(150).pipe(dn(this._destroyed)),l=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new jv(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap().skipPredicate(()=>!1),this._keyManager.updateActiveItem(this._selectedIndex),(0,o.mal)(l,{injector:this._injector}),Io(e,r,n,this._items.changes,this._itemsResized()).pipe(dn(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>{Promise.resolve().then(()=>{this._scrollDistance=Math.max(0,Math.min(this._getMaxScrollDistance(),this._scrollDistance)),l()})}),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.subscribe(m=>{this.indexFocused.emit(m),this._setTabFocus(m)})}_itemsResized(){return"function"!=typeof ResizeObserver?nr:this._items.changes.pipe(As(this._items),So(e=>new Ai.c(n=>this._ngZone.runOutsideAngular(()=>{const r=new ResizeObserver(l=>n.next(l));return e.forEach(l=>r.observe(l.elementRef.nativeElement)),()=>{r.disconnect()}}))),ou(1),Ur(e=>e.some(n=>n.contentRect.width>0&&n.contentRect.height>0)))}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._keyManager?.destroy(),this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(e){if(!oa(e))switch(e.keyCode){case 13:case 32:if(this.focusIndex!==this.selectedIndex){const n=this._items.get(this.focusIndex);n&&!n.disabled&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(e))}break;default:this._keyManager.onKeydown(e)}}_onContentChanges(){const e=this._elementRef.nativeElement.textContent;e!==this._currentTextContent&&(this._currentTextContent=e||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(e){!this._isValidIndex(e)||this.focusIndex===e||!this._keyManager||this._keyManager.setActiveItem(e)}_isValidIndex(e){return!this._items||!!this._items.toArray()[e]}_setTabFocus(e){if(this._showPaginationControls&&this._scrollToLabel(e),this._items&&this._items.length){this._items.toArray()[e].focus();const n=this._tabListContainer.nativeElement;n.scrollLeft="ltr"==this._getLayoutDirection()?0:n.scrollWidth-n.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const e=this.scrollDistance,n="ltr"===this._getLayoutDirection()?-e:e;this._tabList.nativeElement.style.transform=`translateX(${Math.round(n)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(e){this._scrollTo(e)}_scrollHeader(e){return this._scrollTo(this._scrollDistance+("before"==e?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(e){this._stopInterval(),this._scrollHeader(e)}_scrollToLabel(e){if(this.disablePagination)return;const n=this._items?this._items.toArray()[e]:null;if(!n)return;const r=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:l,offsetWidth:m}=n.elementRef.nativeElement;let C,A;"ltr"==this._getLayoutDirection()?(C=l,A=C+m):(A=this._tabListInner.nativeElement.offsetWidth-l,C=A-m);const O=this.scrollDistance,z=this.scrollDistance+r;C<O?this.scrollDistance-=O-C:A>z&&(this.scrollDistance+=Math.min(A-z,C-O))}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const r=this._tabListInner.nativeElement.scrollWidth-this._elementRef.nativeElement.offsetWidth>=5;r||(this.scrollDistance=0),r!==this._showPaginationControls&&(this._showPaginationControls=r,this._changeDetectorRef.markForCheck())}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabListInner.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const e=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,n=e?e.elementRef.nativeElement:null;n?this._inkBar.alignToElement(n):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(e,n){n&&null!=n.button&&0!==n.button||(this._stopInterval(),gV(650,100).pipe(dn(Io(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:r,distance:l}=this._scrollHeader(e);(0===l||l>=r)&&this._stopInterval()}))}_scrollTo(e){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const n=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(n,e)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:n,distance:this._scrollDistance}}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(_x),o.rXU(Us,8),o.rXU(o.SKi),o.rXU(wo),o.rXU(o.bc$,8))}}static{this.\u0275dir=o.FsC({type:i,inputs:{disablePagination:[2,"disablePagination","disablePagination",o.L39],selectedIndex:[2,"selectedIndex","selectedIndex",o.Udg]},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[o.GFd]})}}return i})(),oce=(()=>{class i extends rce{constructor(e,n,r,l,m,C,A){super(e,n,r,l,m,C,A),this.disableRipple=!1}ngAfterContentInit(){this._inkBar=new Jle(this._items),super.ngAfterContentInit()}_itemSelected(e){e.preventDefault()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(_x),o.rXU(Us,8),o.rXU(o.SKi),o.rXU(wo),o.rXU(o.bc$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-tab-header"]],contentQueries:function(n,r,l){if(1&n&&o.wni(l,j$,4),2&n){let m;o.mGM(m=o.lsd())&&(r._items=m)}},viewQuery:function(n,r){if(1&n&&(o.GBs(Ple,7),o.GBs(Ole,7),o.GBs(Lle,7),o.GBs(Fle,5),o.GBs(Nle,5)),2&n){let l;o.mGM(l=o.lsd())&&(r._tabListContainer=l.first),o.mGM(l=o.lsd())&&(r._tabList=l.first),o.mGM(l=o.lsd())&&(r._tabListInner=l.first),o.mGM(l=o.lsd())&&(r._nextPaginator=l.first),o.mGM(l=o.lsd())&&(r._previousPaginator=l.first)}},hostAttrs:[1,"mat-mdc-tab-header"],hostVars:4,hostBindings:function(n,r){2&n&&o.AVh("mat-mdc-tab-header-pagination-controls-enabled",r._showPaginationControls)("mat-mdc-tab-header-rtl","rtl"==r._getLayoutDirection())},inputs:{disableRipple:[2,"disableRipple","disableRipple",o.L39]},standalone:!0,features:[o.GFd,o.Vt3,o.aNF],ngContentSelectors:_z,decls:13,vars:10,consts:[["previousPaginator",""],["tabListContainer",""],["tabList",""],["tabListInner",""],["nextPaginator",""],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-before",3,"click","mousedown","touchend","matRippleDisabled","disabled"],[1,"mat-mdc-tab-header-pagination-chevron"],[1,"mat-mdc-tab-label-container",3,"keydown"],["role","tablist",1,"mat-mdc-tab-list",3,"cdkObserveContent"],[1,"mat-mdc-tab-labels"],["aria-hidden","true","type","button","mat-ripple","","tabindex","-1",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-after",3,"mousedown","click","touchend","matRippleDisabled","disabled"]],template:function(n,r){if(1&n){const l=o.RV6();o.NAR(),o.j41(0,"button",5,0),o.bIt("click",function(){return o.eBV(l),o.Njj(r._handlePaginatorClick("before"))})("mousedown",function(C){return o.eBV(l),o.Njj(r._handlePaginatorPress("before",C))})("touchend",function(){return o.eBV(l),o.Njj(r._stopInterval())}),o.nrm(2,"div",6),o.k0s(),o.j41(3,"div",7,1),o.bIt("keydown",function(C){return o.eBV(l),o.Njj(r._handleKeydown(C))}),o.j41(5,"div",8,2),o.bIt("cdkObserveContent",function(){return o.eBV(l),o.Njj(r._onContentChanges())}),o.j41(7,"div",9,3),o.SdG(9),o.k0s()()(),o.j41(10,"button",10,4),o.bIt("mousedown",function(C){return o.eBV(l),o.Njj(r._handlePaginatorPress("after",C))})("click",function(){return o.eBV(l),o.Njj(r._handlePaginatorClick("after"))})("touchend",function(){return o.eBV(l),o.Njj(r._stopInterval())}),o.nrm(12,"div",6),o.k0s()}2&n&&(o.AVh("mat-mdc-tab-header-pagination-disabled",r._disableScrollBefore),o.Y8G("matRippleDisabled",r._disableScrollBefore||r.disableRipple)("disabled",r._disableScrollBefore||null),o.R7$(3),o.AVh("_mat-animation-noopable","NoopAnimations"===r._animationMode),o.R7$(7),o.AVh("mat-mdc-tab-header-pagination-disabled",r._disableScrollAfter),o.Y8G("matRippleDisabled",r._disableScrollAfter||r.disableRipple)("disabled",r._disableScrollAfter||null))},dependencies:[dl,uE],styles:[".mat-mdc-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mdc-tab-indicator .mdc-tab-indicator__content{transition-duration:var(--mat-tab-animation-duration, 250ms)}.mat-mdc-tab-header-pagination{-webkit-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:rgba(0,0,0,0);touch-action:none;box-sizing:content-box;background:none;border:none;outline:0;padding:0}.mat-mdc-tab-header-pagination::-moz-focus-inner{border:0}.mat-mdc-tab-header-pagination .mat-ripple-element{opacity:.12;background-color:var(--mat-tab-header-inactive-ripple-color)}.mat-mdc-tab-header-pagination-controls-enabled .mat-mdc-tab-header-pagination{display:flex}.mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after{padding-left:4px}.mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-pagination-after{padding-right:4px}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-mdc-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;height:8px;width:8px;border-color:var(--mat-tab-header-pagination-icon-color)}.mat-mdc-tab-header-pagination-disabled{box-shadow:none;cursor:default;pointer-events:none}.mat-mdc-tab-header-pagination-disabled .mat-mdc-tab-header-pagination-chevron{opacity:.4}.mat-mdc-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-mdc-tab-list{transition:none}.mat-mdc-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1;border-bottom-style:solid;border-bottom-width:var(--mat-tab-header-divider-height);border-bottom-color:var(--mat-tab-header-divider-color)}.mat-mdc-tab-group-inverted-header .mat-mdc-tab-label-container{border-bottom:none;border-top-style:solid;border-top-width:var(--mat-tab-header-divider-height);border-top-color:var(--mat-tab-header-divider-color)}.mat-mdc-tab-labels{display:flex;flex:1 0 auto}[mat-align-tabs=center]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:flex-end}.mat-mdc-tab::before{margin:5px}.cdk-high-contrast-active .mat-mdc-tab[aria-disabled=true]{color:GrayText}"],encapsulation:2})}}return i})();const sce=new o.nKC("MAT_TABS_CONFIG"),ace={translateTab:js("translateTab",[Lo("center, void, left-origin-center, right-origin-center",gn({transform:"none"})),Lo("left",gn({transform:"translate3d(-100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),Lo("right",gn({transform:"translate3d(100%, 0, 0)",minHeight:"1px",visibility:"hidden"})),oo("* => left, * => right, left => center, right => center",co("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),oo("void => left-origin-center",[gn({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"}),co("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),oo("void => right-origin-center",[gn({transform:"translate3d(100%, 0, 0)",visibility:"hidden"}),co("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let lce=(()=>{class i extends gx{constructor(e,n,r,l){super(e,n,l),this._host=r,this._centeringSub=On.yU.EMPTY,this._leavingSub=On.yU.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(As(this._host._isCenterPosition(this._host._position))).subscribe(e=>{e&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this._host.preserveContent||this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.OM3),o.rXU(o.c1b),o.rXU((0,o.Rfq)(()=>H$)),o.rXU(Nn))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matTabBodyHost",""]],standalone:!0,features:[o.Vt3]})}}return i})(),H$=(()=>{class i{set position(e){this._positionIndex=e,this._computePositionAnimationState()}constructor(e,n,r){this._elementRef=e,this._dir=n,this._dirChangeSubscription=On.yU.EMPTY,this._translateTabComplete=new xi.B,this._onCentering=new o.bkB,this._beforeCentering=new o.bkB,this._afterLeavingCenter=new o.bkB,this._onCentered=new o.bkB(!0),this.animationDuration="500ms",this.preserveContent=!1,n&&(this._dirChangeSubscription=n.change.subscribe(l=>{this._computePositionAnimationState(l),r.markForCheck()})),this._translateTabComplete.pipe(su((l,m)=>l.fromState===m.fromState&&l.toState===m.toState)).subscribe(l=>{this._isCenterPosition(l.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(l.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(e){const n=this._isCenterPosition(e.toState);this._beforeCentering.emit(n),n&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(e){return"center"==e||"left-origin-center"==e||"right-origin-center"==e}_computePositionAnimationState(e=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==e?"left":"right":this._positionIndex>0?"ltr"==e?"right":"left":"center"}_computePositionFromOrigin(e){const n=this._getLayoutDirection();return"ltr"==n&&e<=0||"rtl"==n&&e>0?"left-origin-center":"right-origin-center"}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(Us,8),o.rXU(o.gRc))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-tab-body"]],viewQuery:function(n,r){if(1&n&&o.GBs(gx,5),2&n){let l;o.mGM(l=o.lsd())&&(r._portalHost=l.first)}},hostAttrs:[1,"mat-mdc-tab-body"],inputs:{_content:[0,"content","_content"],origin:"origin",animationDuration:"animationDuration",preserveContent:"preserveContent",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"},standalone:!0,features:[o.aNF],decls:3,vars:6,consts:[["content",""],["cdkScrollable","",1,"mat-mdc-tab-body-content"],["matTabBodyHost",""]],template:function(n,r){if(1&n){const l=o.RV6();o.j41(0,"div",1,0),o.bIt("@translateTab.start",function(C){return o.eBV(l),o.Njj(r._onTranslateTabStarted(C))})("@translateTab.done",function(C){return o.eBV(l),o.Njj(r._translateTabComplete.next(C))}),o.DNE(2,zle,0,0,"ng-template",2),o.k0s()}2&n&&o.Y8G("@translateTab",o.l_i(3,Vle,r._position,o.eq3(1,Ble,r.animationDuration)))},dependencies:[lce,wS],styles:['.mat-mdc-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-mdc-tab-body.mat-mdc-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-mdc-tab-group.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body.mat-mdc-tab-body-active{overflow-y:hidden}.mat-mdc-tab-body-content{height:100%;overflow:auto}.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body-content{overflow:hidden}.mat-mdc-tab-body-content[style*="visibility: hidden"]{display:none}'],encapsulation:2,data:{animation:[ace.translateTab]}})}}return i})(),cce=0,uce=(()=>{class i{get fitInkBarToContent(){return this._fitInkBarToContent}set fitInkBarToContent(e){this._fitInkBarToContent=e,this._changeDetectorRef.markForCheck()}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){this._indexToSelect=isNaN(e)?null:e}get animationDuration(){return this._animationDuration}set animationDuration(e){const n=e+"";this._animationDuration=/^\d+$/.test(n)?e+"ms":n}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(e){this._contentTabIndex=isNaN(e)?null:e}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){const n=this._elementRef.nativeElement.classList;n.remove("mat-tabs-with-background",`mat-background-${this.backgroundColor}`),e&&n.add("mat-tabs-with-background",`mat-background-${e}`),this._backgroundColor=e}constructor(e,n,r,l){this._elementRef=e,this._changeDetectorRef=n,this._animationMode=l,this._tabs=new o.rOR,this._indexToSelect=0,this._lastFocusedTabIndex=null,this._tabBodyWrapperHeight=0,this._tabsSubscription=On.yU.EMPTY,this._tabLabelSubscription=On.yU.EMPTY,this._fitInkBarToContent=!1,this.stretchTabs=!0,this.dynamicHeight=!1,this._selectedIndex=null,this.headerPosition="above",this.disablePagination=!1,this.disableRipple=!1,this.preserveContent=!1,this.selectedIndexChange=new o.bkB,this.focusChange=new o.bkB,this.animationDone=new o.bkB,this.selectedTabChange=new o.bkB(!0),this._isServer=!(0,o.WQX)(wo).isBrowser,this._groupId=cce++,this.animationDuration=r&&r.animationDuration?r.animationDuration:"500ms",this.disablePagination=!(!r||null==r.disablePagination)&&r.disablePagination,this.dynamicHeight=!(!r||null==r.dynamicHeight)&&r.dynamicHeight,null!=r?.contentTabIndex&&(this.contentTabIndex=r.contentTabIndex),this.preserveContent=!!r?.preserveContent,this.fitInkBarToContent=!(!r||null==r.fitInkBarToContent)&&r.fitInkBarToContent,this.stretchTabs=!r||null==r.stretchTabs||r.stretchTabs}ngAfterContentChecked(){const e=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=e){const n=null==this._selectedIndex;if(!n){this.selectedTabChange.emit(this._createChangeEvent(e));const r=this._tabBodyWrapper.nativeElement;r.style.minHeight=r.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((r,l)=>r.isActive=l===e),n||(this.selectedIndexChange.emit(e),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((n,r)=>{n.position=r-e,null!=this._selectedIndex&&0==n.position&&!n.origin&&(n.origin=e-this._selectedIndex)}),this._selectedIndex!==e&&(this._selectedIndex=e,this._lastFocusedTabIndex=null,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{const e=this._clampTabIndex(this._indexToSelect);if(e===this._selectedIndex){const n=this._tabs.toArray();let r;for(let l=0;l<n.length;l++)if(n[l].isActive){this._indexToSelect=this._selectedIndex=l,this._lastFocusedTabIndex=null,r=n[l];break}!r&&n[e]&&Promise.resolve().then(()=>{n[e].isActive=!0,this.selectedTabChange.emit(this._createChangeEvent(e))})}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(As(this._allTabs)).subscribe(e=>{this._tabs.reset(e.filter(n=>n._closestTabGroup===this||!n._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}updatePagination(){this._tabHeader&&this._tabHeader.updatePagination()}focusTab(e){const n=this._tabHeader;n&&(n.focusIndex=e)}_focusChanged(e){this._lastFocusedTabIndex=e,this.focusChange.emit(this._createChangeEvent(e))}_createChangeEvent(e){const n=new hce;return n.index=e,this._tabs&&this._tabs.length&&(n.tab=this._tabs.toArray()[e]),n}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=Io(...this._tabs.map(e=>e._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(e){return Math.min(this._tabs.length-1,Math.max(e||0,0))}_getTabLabelId(e){return`mat-tab-label-${this._groupId}-${e}`}_getTabContentId(e){return`mat-tab-content-${this._groupId}-${e}`}_setTabBodyWrapperHeight(e){if(!this.dynamicHeight||!this._tabBodyWrapperHeight)return;const n=this._tabBodyWrapper.nativeElement;n.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(n.style.height=e+"px")}_removeTabBodyWrapperHeight(){const e=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=e.clientHeight,e.style.height="",this.animationDone.emit()}_handleClick(e,n,r){n.focusIndex=r,e.disabled||(this.selectedIndex=r)}_getTabIndex(e){return e===(this._lastFocusedTabIndex??this.selectedIndex)?0:-1}_tabFocusChanged(e,n){e&&"mouse"!==e&&"touch"!==e&&(this._tabHeader.focusIndex=n)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(sce,8),o.rXU(o.bc$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-tab-group"]],contentQueries:function(n,r,l){if(1&n&&o.wni(l,z$,5),2&n){let m;o.mGM(m=o.lsd())&&(r._allTabs=m)}},viewQuery:function(n,r){if(1&n&&(o.GBs(Ule,5),o.GBs(jle,5)),2&n){let l;o.mGM(l=o.lsd())&&(r._tabBodyWrapper=l.first),o.mGM(l=o.lsd())&&(r._tabHeader=l.first)}},hostAttrs:[1,"mat-mdc-tab-group"],hostVars:10,hostBindings:function(n,r){2&n&&(o.HbH("mat-"+(r.color||"primary")),o.xc7("--mat-tab-animation-duration",r.animationDuration),o.AVh("mat-mdc-tab-group-dynamic-height",r.dynamicHeight)("mat-mdc-tab-group-inverted-header","below"===r.headerPosition)("mat-mdc-tab-group-stretch-tabs",r.stretchTabs))},inputs:{color:"color",fitInkBarToContent:[2,"fitInkBarToContent","fitInkBarToContent",o.L39],stretchTabs:[2,"mat-stretch-tabs","stretchTabs",o.L39],dynamicHeight:[2,"dynamicHeight","dynamicHeight",o.L39],selectedIndex:[2,"selectedIndex","selectedIndex",o.Udg],headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:[2,"contentTabIndex","contentTabIndex",o.Udg],disablePagination:[2,"disablePagination","disablePagination",o.L39],disableRipple:[2,"disableRipple","disableRipple",o.L39],preserveContent:[2,"preserveContent","preserveContent",o.L39],backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},exportAs:["matTabGroup"],standalone:!0,features:[o.Jv_([{provide:V$,useExisting:i}]),o.GFd,o.aNF],ngContentSelectors:_z,decls:9,vars:6,consts:[["tabHeader",""],["tabBodyWrapper",""],["tabNode",""],[3,"indexFocused","selectFocusedIndex","selectedIndex","disableRipple","disablePagination"],["role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",1,"mdc-tab","mat-mdc-tab","mat-mdc-focus-indicator",3,"id","mdc-tab--active","class","disabled","fitInkBarToContent"],[1,"mat-mdc-tab-body-wrapper"],["role","tabpanel",3,"id","mat-mdc-tab-body-active","class","content","position","origin","animationDuration","preserveContent"],["role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",1,"mdc-tab","mat-mdc-tab","mat-mdc-focus-indicator",3,"click","cdkFocusChange","id","disabled","fitInkBarToContent"],[1,"mdc-tab__ripple"],["mat-ripple","",1,"mat-mdc-tab-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mdc-tab__content"],[1,"mdc-tab__text-label"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"_onCentered","_onCentering","id","content","position","origin","animationDuration","preserveContent"]],template:function(n,r){if(1&n){const l=o.RV6();o.NAR(),o.j41(0,"mat-tab-header",3,0),o.bIt("indexFocused",function(C){return o.eBV(l),o.Njj(r._focusChanged(C))})("selectFocusedIndex",function(C){return o.eBV(l),o.Njj(r.selectedIndex=C)}),o.Z7z(2,Wle,8,17,"div",4,o.fX1),o.k0s(),o.DNE(4,Xle,1,0),o.j41(5,"div",5,1),o.Z7z(7,qle,1,13,"mat-tab-body",6,o.fX1),o.k0s()}2&n&&(o.Y8G("selectedIndex",r.selectedIndex||0)("disableRipple",r.disableRipple)("disablePagination",r.disablePagination),o.R7$(2),o.Dyx(r._tabs),o.R7$(2),o.vxM(r._isServer?4:-1),o.R7$(),o.AVh("_mat-animation-noopable","NoopAnimations"===r._animationMode),o.R7$(2),o.Dyx(r._tabs))},dependencies:[oce,j$,Jy,dl,gx,H$],styles:['.mdc-tab{min-width:90px;padding:0 24px;display:flex;flex:1 0 auto;justify-content:center;box-sizing:border-box;border:none;outline:none;text-align:center;white-space:nowrap;cursor:pointer;z-index:1}.mdc-tab__content{display:flex;align-items:center;justify-content:center;height:inherit;pointer-events:none}.mdc-tab__text-label{transition:150ms color linear;display:inline-block;line-height:1;z-index:2}.mdc-tab--active .mdc-tab__text-label{transition-delay:100ms}._mat-animation-noopable .mdc-tab__text-label{transition:none}.mdc-tab-indicator{display:flex;position:absolute;top:0;left:0;justify-content:center;width:100%;height:100%;pointer-events:none;z-index:1}.mdc-tab-indicator__content{transition:var(--mat-tab-animation-duration, 250ms) transform cubic-bezier(0.4, 0, 0.2, 1);transform-origin:left;opacity:0}.mdc-tab-indicator__content--underline{align-self:flex-end;box-sizing:border-box;width:100%;border-top-style:solid}.mdc-tab-indicator--active .mdc-tab-indicator__content{opacity:1}._mat-animation-noopable .mdc-tab-indicator__content,.mdc-tab-indicator--no-transition .mdc-tab-indicator__content{transition:none}.mat-mdc-tab-ripple{position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none}.mat-mdc-tab{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-decoration:none;background:none;height:var(--mdc-secondary-navigation-tab-container-height);font-family:var(--mat-tab-header-label-text-font);font-size:var(--mat-tab-header-label-text-size);letter-spacing:var(--mat-tab-header-label-text-tracking);line-height:var(--mat-tab-header-label-text-line-height);font-weight:var(--mat-tab-header-label-text-weight)}.mat-mdc-tab.mdc-tab{flex-grow:0}.mat-mdc-tab .mdc-tab-indicator__content--underline{border-color:var(--mdc-tab-indicator-active-indicator-color);border-top-width:var(--mdc-tab-indicator-active-indicator-height);border-radius:var(--mdc-tab-indicator-active-indicator-shape)}.mat-mdc-tab:hover .mdc-tab__text-label{color:var(--mat-tab-header-inactive-hover-label-text-color)}.mat-mdc-tab:focus .mdc-tab__text-label{color:var(--mat-tab-header-inactive-focus-label-text-color)}.mat-mdc-tab.mdc-tab--active .mdc-tab__text-label{color:var(--mat-tab-header-active-label-text-color)}.mat-mdc-tab.mdc-tab--active .mdc-tab__ripple::before,.mat-mdc-tab.mdc-tab--active .mat-ripple-element{background-color:var(--mat-tab-header-active-ripple-color)}.mat-mdc-tab.mdc-tab--active:hover .mdc-tab__text-label{color:var(--mat-tab-header-active-hover-label-text-color)}.mat-mdc-tab.mdc-tab--active:hover .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-header-active-hover-indicator-color)}.mat-mdc-tab.mdc-tab--active:focus .mdc-tab__text-label{color:var(--mat-tab-header-active-focus-label-text-color)}.mat-mdc-tab.mdc-tab--active:focus .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-header-active-focus-indicator-color)}.mat-mdc-tab.mat-mdc-tab-disabled{opacity:.4;pointer-events:none}.mat-mdc-tab.mat-mdc-tab-disabled .mdc-tab__content{pointer-events:none}.mat-mdc-tab.mat-mdc-tab-disabled .mdc-tab__ripple::before,.mat-mdc-tab.mat-mdc-tab-disabled .mat-ripple-element{background-color:var(--mat-tab-header-disabled-ripple-color)}.mat-mdc-tab .mdc-tab__ripple::before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;pointer-events:none;background-color:var(--mat-tab-header-inactive-ripple-color)}.mat-mdc-tab .mdc-tab__text-label{color:var(--mat-tab-header-inactive-label-text-color);display:inline-flex;align-items:center}.mat-mdc-tab .mdc-tab__content{position:relative;pointer-events:auto}.mat-mdc-tab:hover .mdc-tab__ripple::before{opacity:.04}.mat-mdc-tab.cdk-program-focused .mdc-tab__ripple::before,.mat-mdc-tab.cdk-keyboard-focused .mdc-tab__ripple::before{opacity:.12}.mat-mdc-tab .mat-ripple-element{opacity:.12;background-color:var(--mat-tab-header-inactive-ripple-color)}.mat-mdc-tab-group.mat-mdc-tab-group-stretch-tabs>.mat-mdc-tab-header .mat-mdc-tab{flex-grow:1}.mat-mdc-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination{background-color:var(--mat-tab-header-with-background-background-color)}.mat-mdc-tab-group.mat-tabs-with-background.mat-primary>.mat-mdc-tab-header .mat-mdc-tab .mdc-tab__text-label{color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background.mat-primary>.mat-mdc-tab-header .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background:not(.mat-primary)>.mat-mdc-tab-header .mat-mdc-tab:not(.mdc-tab--active) .mdc-tab__text-label{color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background:not(.mat-primary)>.mat-mdc-tab-header .mat-mdc-tab:not(.mdc-tab--active) .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-focus-indicator::before,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-focus-indicator::before{border-color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mdc-tab__ripple::before,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mdc-tab__ripple::before{background-color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-tab-header-pagination-chevron{color:var(--mat-tab-header-with-background-foreground-color)}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header{flex-direction:column-reverse}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header .mdc-tab-indicator__content--underline{align-self:flex-start}.mat-mdc-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-mdc-tab-body-wrapper._mat-animation-noopable{transition:none !important;animation:none !important}'],encapsulation:2})}}return i})();class hce{}let fce=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,qn]})}}return i})();const mce=["input"],pce=["label"],gce=["*"],_ce=new o.nKC("mat-checkbox-default-options",{providedIn:"root",factory:$$});function $$(){return{color:"accent",clickAction:"check-indeterminate"}}var zd=function(i){return i[i.Init=0]="Init",i[i.Checked=1]="Checked",i[i.Unchecked=2]="Unchecked",i[i.Indeterminate=3]="Indeterminate",i}(zd||{});const vce={provide:Ya,useExisting:(0,o.Rfq)(()=>UO),multi:!0};class bce{}let yce=0;const W$=$$();let UO=(()=>{class i{focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(e){const n=new bce;return n.source=this,n.checked=e,n}_getAnimationTargetElement(){return this._inputElement?.nativeElement}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(e,n,r,l,m,C){this._elementRef=e,this._changeDetectorRef=n,this._ngZone=r,this._animationMode=m,this._options=C,this._animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"},this.ariaLabel="",this.ariaLabelledby=null,this.labelPosition="after",this.name=null,this.change=new o.bkB,this.indeterminateChange=new o.bkB,this._onTouched=()=>{},this._currentAnimationClass="",this._currentCheckState=zd.Init,this._controlValueAccessorChangeFn=()=>{},this._validatorChangeFn=()=>{},this._checked=!1,this._disabled=!1,this._indeterminate=!1,this._options=this._options||W$,this.color=this._options.color||W$.color,this.tabIndex=parseInt(l)||0,this.id=this._uniqueId="mat-mdc-checkbox-"+ ++yce}ngOnChanges(e){e.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(e){e!=this.checked&&(this._checked=e,this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(e){e!==this.disabled&&(this._disabled=e,this._changeDetectorRef.markForCheck())}get indeterminate(){return this._indeterminate}set indeterminate(e){const n=e!=this._indeterminate;this._indeterminate=e,n&&(this._transitionCheckState(this._indeterminate?zd.Indeterminate:this.checked?zd.Checked:zd.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(e){this.checked=!!e}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}validate(e){return this.required&&!0!==e.value?{required:!0}:null}registerOnValidatorChange(e){this._validatorChangeFn=e}_transitionCheckState(e){let n=this._currentCheckState,r=this._getAnimationTargetElement();if(n!==e&&r&&(this._currentAnimationClass&&r.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(n,e),this._currentCheckState=e,this._currentAnimationClass.length>0)){r.classList.add(this._currentAnimationClass);const l=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{r.classList.remove(l)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){const e=this._options?.clickAction;this.disabled||"noop"===e?!this.disabled&&"noop"===e&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==e&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?zd.Checked:zd.Unchecked),this._emitChangeEvent())}_onInteractionEvent(e){e.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(e,n){if("NoopAnimations"===this._animationMode)return"";switch(e){case zd.Init:if(n===zd.Checked)return this._animationClasses.uncheckedToChecked;if(n==zd.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case zd.Unchecked:return n===zd.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case zd.Checked:return n===zd.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case zd.Indeterminate:return n===zd.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(e){const n=this._inputElement;n&&(n.nativeElement.indeterminate=e)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(e){e.target&&this._labelElement.nativeElement.contains(e.target)&&e.stopPropagation()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(o.SKi),o.kS0("tabindex"),o.rXU(o.bc$,8),o.rXU(_ce,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-checkbox"]],viewQuery:function(n,r){if(1&n&&(o.GBs(mce,5),o.GBs(pce,5),o.GBs(dl,5)),2&n){let l;o.mGM(l=o.lsd())&&(r._inputElement=l.first),o.mGM(l=o.lsd())&&(r._labelElement=l.first),o.mGM(l=o.lsd())&&(r.ripple=l.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:14,hostBindings:function(n,r){2&n&&(o.Mr5("id",r.id),o.BMQ("tabindex",null)("aria-label",null)("aria-labelledby",null),o.HbH(r.color?"mat-"+r.color:"mat-accent"),o.AVh("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mdc-checkbox--disabled",r.disabled)("mat-mdc-checkbox-disabled",r.disabled)("mat-mdc-checkbox-checked",r.checked))},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],id:"id",required:[2,"required","required",o.L39],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[2,"disableRipple","disableRipple",o.L39],tabIndex:[2,"tabIndex","tabIndex",e=>null==e?void 0:(0,o.Udg)(e)],color:"color",checked:[2,"checked","checked",o.L39],disabled:[2,"disabled","disabled",o.L39],indeterminate:[2,"indeterminate","indeterminate",o.L39]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],standalone:!0,features:[o.Jv_([vce,{provide:vl,useExisting:i,multi:!0}]),o.GFd,o.OA$,o.aNF],ngContentSelectors:gce,decls:15,vars:19,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(n,r){if(1&n){const l=o.RV6();o.NAR(),o.j41(0,"div",3),o.bIt("click",function(C){return o.eBV(l),o.Njj(r._preventBubblingFromLabel(C))}),o.j41(1,"div",4,0)(3,"div",5),o.bIt("click",function(){return o.eBV(l),o.Njj(r._onTouchTargetClick())}),o.k0s(),o.j41(4,"input",6,1),o.bIt("blur",function(){return o.eBV(l),o.Njj(r._onBlur())})("click",function(){return o.eBV(l),o.Njj(r._onInputClick())})("change",function(C){return o.eBV(l),o.Njj(r._onInteractionEvent(C))}),o.k0s(),o.nrm(6,"div",7),o.j41(7,"div",8),o.qSk(),o.j41(8,"svg",9),o.nrm(9,"path",10),o.k0s(),o.joV(),o.nrm(10,"div",11),o.k0s(),o.nrm(11,"div",12),o.k0s(),o.j41(12,"label",13,2),o.SdG(14),o.k0s()()}if(2&n){const l=o.sdS(2);o.Y8G("labelPosition",r.labelPosition),o.R7$(4),o.AVh("mdc-checkbox--selected",r.checked),o.Y8G("checked",r.checked)("indeterminate",r.indeterminate)("disabled",r.disabled)("id",r.inputId)("required",r.required)("tabIndex",r.disabled?-1:r.tabIndex),o.BMQ("aria-label",r.ariaLabel||null)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby)("aria-checked",r.indeterminate?"mixed":null)("name",r.name)("value",r.value),o.R7$(7),o.Y8G("matRippleTrigger",l)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),o.R7$(),o.Y8G("for",r.inputId)}},dependencies:[dl,sb],styles:['.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom;padding:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);margin:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity);background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity);background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity);background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color)}.mdc-checkbox .mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;width:var(--mdc-checkbox-state-layer-size, 40px);height:var(--mdc-checkbox-state-layer-size, 40px);top:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);right:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1);border-color:var(--mdc-checkbox-unselected-icon-color);top:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2)}.mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color);background-color:var(--mdc-checkbox-selected-icon-color)}.mdc-checkbox--disabled .mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color)}.mdc-checkbox__native-control:disabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:disabled:indeterminate~.mdc-checkbox__background{background-color:var(--mdc-checkbox-disabled-selected-icon-color);border-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:not(:checked)~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color);background-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color);background-color:var(--mdc-checkbox-selected-hover-icon-color)}.mdc-checkbox__native-control:focus:focus:not(:checked)~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color)}.mdc-checkbox__native-control:focus:focus:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color);background-color:var(--mdc-checkbox-selected-focus-icon-color)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms cubic-bezier(0.4, 0, 0.6, 1);color:var(--mdc-checkbox-selected-checkmark-color)}.mdc-checkbox--disabled .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);border-color:var(--mdc-checkbox-selected-checkmark-color)}.cdk-high-contrast-active .mdc-checkbox__mixedmark{margin:0 1px}.mdc-checkbox--disabled .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color)}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms cubic-bezier(0, 0, 0.2, 1),transform 180ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *,.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox .mdc-checkbox__background{-webkit-print-color-adjust:exact;color-adjust:exact}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox .mat-internal-form-field{color:var(--mat-checkbox-label-text-color);font-family:var(--mat-checkbox-label-text-font);line-height:var(--mat-checkbox-label-text-line-height);font-size:var(--mat-checkbox-label-text-size);letter-spacing:var(--mat-checkbox-label-text-tracking);font-weight:var(--mat-checkbox-label-text-weight)}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color)}.mat-mdc-checkbox label:empty{display:none}.cdk-high-contrast-active .mat-mdc-checkbox.mat-mdc-checkbox-disabled{opacity:.5}.cdk-high-contrast-active .mat-mdc-checkbox .mdc-checkbox__checkmark{--mdc-checkbox-selected-checkmark-color: CanvasText;--mdc-checkbox-disabled-selected-checkmark-color: CanvasText}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return i})(),X$=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[UO,qn,qn]})}}return i})();const Ece=["mat-sort-header",""],Tce=["*"];function Sce(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",2),o.bIt("@arrowPosition.start",function(){o.eBV(e);const r=o.XpG();return o.Njj(r._disableViewStateAnimation=!0)})("@arrowPosition.done",function(){o.eBV(e);const r=o.XpG();return o.Njj(r._disableViewStateAnimation=!1)}),o.nrm(1,"div",3),o.j41(2,"div",4),o.nrm(3,"div",5)(4,"div",6)(5,"div",7),o.k0s()()}if(2&i){const e=o.XpG();o.Y8G("@arrowOpacity",e._getArrowViewState())("@arrowPosition",e._getArrowViewState())("@allowChildren",e._getArrowDirectionState()),o.R7$(2),o.Y8G("@indicator",e._getArrowDirectionState()),o.R7$(),o.Y8G("@leftPointer",e._getArrowDirectionState()),o.R7$(),o.Y8G("@rightPointer",e._getArrowDirectionState())}}const q$=new o.nKC("MAT_SORT_DEFAULT_OPTIONS");let bz=(()=>{class i{get direction(){return this._direction}set direction(e){this._direction=e}constructor(e){this._defaultOptions=e,this._initializedStream=new Sm(1),this.sortables=new Map,this._stateChanges=new xi.B,this.start="asc",this._direction="",this.disabled=!1,this.sortChange=new o.bkB,this.initialized=this._initializedStream}register(e){this.sortables.set(e.id,e)}deregister(e){this.sortables.delete(e.id)}sort(e){this.active!=e.id?(this.active=e.id,this.direction=e.start?e.start:this.start):this.direction=this.getNextSortDirection(e),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(e){if(!e)return"";let r=function Mce(i,t){let e=["asc","desc"];return"desc"==i&&e.reverse(),t||e.push(""),e}(e.start||this.start,e?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear),l=r.indexOf(this.direction)+1;return l>=r.length&&(l=0),r[l]}ngOnInit(){this._initializedStream.next()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete(),this._initializedStream.complete()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(q$,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{active:[0,"matSortActive","active"],start:[0,"matSortStart","start"],direction:[0,"matSortDirection","direction"],disableClear:[2,"matSortDisableClear","disableClear",o.L39],disabled:[2,"matSortDisabled","disabled",o.L39]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],standalone:!0,features:[o.GFd,o.OA$]})}}return i})();const yx=Lp.ENTERING+" "+xE.STANDARD_CURVE,PS={indicator:js("indicator",[Lo("active-asc, asc",gn({transform:"translateY(0px)"})),Lo("active-desc, desc",gn({transform:"translateY(10px)"})),oo("active-asc <=> active-desc",co(yx))]),leftPointer:js("leftPointer",[Lo("active-asc, asc",gn({transform:"rotate(-45deg)"})),Lo("active-desc, desc",gn({transform:"rotate(45deg)"})),oo("active-asc <=> active-desc",co(yx))]),rightPointer:js("rightPointer",[Lo("active-asc, asc",gn({transform:"rotate(45deg)"})),Lo("active-desc, desc",gn({transform:"rotate(-45deg)"})),oo("active-asc <=> active-desc",co(yx))]),arrowOpacity:js("arrowOpacity",[Lo("desc-to-active, asc-to-active, active",gn({opacity:1})),Lo("desc-to-hint, asc-to-hint, hint",gn({opacity:.54})),Lo("hint-to-desc, active-to-desc, desc, hint-to-asc, active-to-asc, asc, void",gn({opacity:0})),oo("* => asc, * => desc, * => active, * => hint, * => void",co("0ms")),oo("* <=> *",co(yx))]),arrowPosition:js("arrowPosition",[oo("* => desc-to-hint, * => desc-to-active",co(yx,pb([gn({transform:"translateY(-25%)"}),gn({transform:"translateY(0)"})]))),oo("* => hint-to-desc, * => active-to-desc",co(yx,pb([gn({transform:"translateY(0)"}),gn({transform:"translateY(25%)"})]))),oo("* => asc-to-hint, * => asc-to-active",co(yx,pb([gn({transform:"translateY(25%)"}),gn({transform:"translateY(0)"})]))),oo("* => hint-to-asc, * => active-to-asc",co(yx,pb([gn({transform:"translateY(0)"}),gn({transform:"translateY(-25%)"})]))),Lo("desc-to-hint, asc-to-hint, hint, desc-to-active, asc-to-active, active",gn({transform:"translateY(0)"})),Lo("hint-to-desc, active-to-desc, desc",gn({transform:"translateY(-25%)"})),Lo("hint-to-asc, active-to-asc, asc",gn({transform:"translateY(25%)"}))]),allowChildren:js("allowChildren",[oo("* <=> *",[s1("@*",OI(),{optional:!0})])])};let jO=(()=>{class i{constructor(){this.changes=new xi.B}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const Dce={provide:jO,deps:[[new o.Xx1,new o.kdw,jO]],useFactory:function Ace(i){return i||new jO}};let kce=(()=>{class i{get sortActionDescription(){return this._sortActionDescription}set sortActionDescription(e){this._updateSortActionDescription(e)}constructor(e,n,r,l,m,C,A,O){this._intl=e,this._changeDetectorRef=n,this._sort=r,this._columnDef=l,this._focusMonitor=m,this._elementRef=C,this._ariaDescriber=A,this._showIndicatorHint=!1,this._viewState={},this._arrowDirection="",this._disableViewStateAnimation=!1,this.arrowPosition="after",this.disabled=!1,this._sortActionDescription="Sort",O?.arrowPosition&&(this.arrowPosition=O?.arrowPosition),this._handleStateChanges()}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._updateArrowDirection(),this._setAnimationTransitionState({toState:this._isSorted()?"active":this._arrowDirection}),this._sort.register(this),this._sortButton=this._elementRef.nativeElement.querySelector(".mat-sort-header-container"),this._updateSortActionDescription(this._sortActionDescription)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{const n=!!e;n!==this._showIndicatorHint&&(this._setIndicatorHintVisible(n),this._changeDetectorRef.markForCheck())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._rerenderSubscription.unsubscribe(),this._sortButton&&this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription)}_setIndicatorHintVisible(e){this._isDisabled()&&e||(this._showIndicatorHint=e,this._isSorted()||(this._updateArrowDirection(),this._setAnimationTransitionState(this._showIndicatorHint?{fromState:this._arrowDirection,toState:"hint"}:{fromState:"hint",toState:this._arrowDirection})))}_setAnimationTransitionState(e){this._viewState=e||{},this._disableViewStateAnimation&&(this._viewState={toState:e.toState})}_toggleOnInteraction(){this._sort.sort(this),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0)}_handleClick(){this._isDisabled()||this._sort.sort(this)}_handleKeydown(e){!this._isDisabled()&&(32===e.keyCode||13===e.keyCode)&&(e.preventDefault(),this._toggleOnInteraction())}_isSorted(){return this._sort.active==this.id&&("asc"===this._sort.direction||"desc"===this._sort.direction)}_getArrowDirectionState(){return`${this._isSorted()?"active-":""}${this._arrowDirection}`}_getArrowViewState(){const e=this._viewState.fromState;return(e?`${e}-to-`:"")+this._viewState.toState}_updateArrowDirection(){this._arrowDirection=this._isSorted()?this._sort.direction:this.start||this._sort.start}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?"asc"==this._sort.direction?"ascending":"descending":"none"}_renderArrow(){return!this._isDisabled()||this._isSorted()}_updateSortActionDescription(e){this._sortButton&&(this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription),this._ariaDescriber?.describe(this._sortButton,e)),this._sortActionDescription=e}_handleStateChanges(){this._rerenderSubscription=Io(this._sort.sortChange,this._sort._stateChanges,this._intl.changes).subscribe(()=>{this._isSorted()&&(this._updateArrowDirection(),("hint"===this._viewState.toState||"active"===this._viewState.toState)&&(this._disableViewStateAnimation=!0),this._setAnimationTransitionState({fromState:this._arrowDirection,toState:"active"}),this._showIndicatorHint=!1),!this._isSorted()&&this._viewState&&"active"===this._viewState.toState&&(this._disableViewStateAnimation=!1,this._setAnimationTransitionState({fromState:"active",toState:this._arrowDirection})),this._changeDetectorRef.markForCheck()})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(jO),o.rXU(o.gRc),o.rXU(bz,8),o.rXU("MAT_SORT_HEADER_COLUMN_DEF",8),o.rXU(Kc),o.rXU(o.aKT),o.rXU(Uv,8),o.rXU(q$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(n,r){1&n&&o.bIt("click",function(){return r._handleClick()})("keydown",function(m){return r._handleKeydown(m)})("mouseenter",function(){return r._setIndicatorHintVisible(!0)})("mouseleave",function(){return r._setIndicatorHintVisible(!1)}),2&n&&(o.BMQ("aria-sort",r._getAriaSortAttribute()),o.AVh("mat-sort-header-disabled",r._isDisabled()))},inputs:{id:[0,"mat-sort-header","id"],arrowPosition:"arrowPosition",start:"start",disabled:[2,"disabled","disabled",o.L39],sortActionDescription:"sortActionDescription",disableClear:[2,"disableClear","disableClear",o.L39]},exportAs:["matSortHeader"],standalone:!0,features:[o.GFd,o.aNF],attrs:Ece,ngContentSelectors:Tce,decls:4,vars:7,consts:[[1,"mat-sort-header-container","mat-focus-indicator"],[1,"mat-sort-header-content"],[1,"mat-sort-header-arrow"],[1,"mat-sort-header-stem"],[1,"mat-sort-header-indicator"],[1,"mat-sort-header-pointer-left"],[1,"mat-sort-header-pointer-right"],[1,"mat-sort-header-pointer-middle"]],template:function(n,r){1&n&&(o.NAR(),o.j41(0,"div",0)(1,"div",1),o.SdG(2),o.k0s(),o.DNE(3,Sce,6,6,"div",2),o.k0s()),2&n&&(o.AVh("mat-sort-header-sorted",r._isSorted())("mat-sort-header-position-before","before"===r.arrowPosition),o.BMQ("tabindex",r._isDisabled()?null:0)("role",r._isDisabled()?null:"button"),o.R7$(3),o.vxM(r._renderArrow()?3:-1))},styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-container,[mat-sort-header].cdk-program-focused .mat-sort-header-container{border-bottom:solid 1px currentColor}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-container::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-sort-header-content{text-align:center;display:flex;align-items:center}.mat-sort-header-position-before{flex-direction:row-reverse}.mat-sort-header-arrow{height:12px;width:12px;min-width:12px;position:relative;display:flex;color:var(--mat-sort-arrow-color);opacity:0}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}.mat-sort-header-stem{background:currentColor;height:10px;width:2px;margin:auto;display:flex;align-items:center}.cdk-high-contrast-active .mat-sort-header-stem{width:0;border-left:solid 2px}.mat-sort-header-indicator{width:100%;height:2px;display:flex;align-items:center;position:absolute;top:0;left:0}.mat-sort-header-pointer-middle{margin:auto;height:2px;width:2px;background:currentColor;transform:rotate(45deg)}.cdk-high-contrast-active .mat-sort-header-pointer-middle{width:0;height:0;border-top:solid 2px;border-left:solid 2px}.mat-sort-header-pointer-left,.mat-sort-header-pointer-right{background:currentColor;width:6px;height:2px;position:absolute;top:0}.cdk-high-contrast-active .mat-sort-header-pointer-left,.cdk-high-contrast-active .mat-sort-header-pointer-right{width:0;height:0;border-left:solid 6px;border-top:solid 2px}.mat-sort-header-pointer-left{transform-origin:right;left:0}.mat-sort-header-pointer-right{transform-origin:left;right:0}"],encapsulation:2,data:{animation:[PS.indicator,PS.leftPointer,PS.rightPointer,PS.arrowOpacity,PS.arrowPosition,PS.allowChildren]},changeDetection:0})}}return i})(),Ice=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[Dce],imports:[qn]})}}return i})();class Rce{constructor(t,e){this.studyService=t,this.formArrayInput=e,this.dataState=(0,o.vPA)("initial"),this.dataState$=new ro.t("initial"),this.currentSource=(0,o.vPA)([]),this.currentAnimals=(0,o.vPA)(new Map),this.currentTaggedAnimals=(0,o.vPA)(new Map),this.selectionModel=new Nk(!0,[]),this.hasValue=(0,o.vPA)(!1),this.formArray=(0,o.vPA)(e),this.sourceSubject$=new ro.t(this.formArray())}connect(t){return this.sourceSubject$.asObservable().pipe((0,st.T)(e=>e.controls))}disconnect(t){this.sourceSubject$.complete()}getAnimalData(t,e="asc"){this.dataState.set("loading"),this.dataState$.next("loading"),this.formArray().clear(),this.selectionModel.clear(),this.currentSource.set([]),this.currentAnimals.set(new Map),this.currentTaggedAnimals.set(new Map),this.hasValue.set(!1),this.sourceSubject$.next(this.formArray()),bo(this.studyService.jsonRequest("individual",t,e),this.studyService.jsonRequest("tag",t,e)).pipe((0,st.T)(m=>{let C=m.filter(O=>"individual"===O.type);C=C.filter(O=>null!=O.LocalIdentifier).filter(O=>O.LocalIdentifier.length>0);let A=m.filter(O=>"tag"===O.type);return A=A.filter(O=>null!=O.LocalIdentifier).filter(O=>O.LocalIdentifier.length>0),[C,A]}),Oo(m=>{const C=this.currentAnimals(),A=this.currentTaggedAnimals();m[0].forEach(O=>{C.set(O.LocalIdentifier,O)}),m[1].forEach(O=>{A.set(O.LocalIdentifier,O)}),this.currentAnimals.set(C),this.currentTaggedAnimals.set(A)}),xa(m=>(console.error(m),this.dataState.set("error"),this.dataState$.next("error"),di([[],[]]))),(0,st.T)(m=>{const C=[],A=m[0].length+m[1].length;this.currentSource.update(O=>O.concat(m[0]).concat(m[1]));for(let O=0;O<A;O++){const z=new df({value:!1,disabled:!0},{nonNullable:!0});C.push(z)}return C}),Ir(()=>{this.dataState.set("loaded"),this.dataState$.next("loaded"),this.formArray().controls.forEach(m=>{})})).subscribe({next:m=>{m.forEach(C=>this.formArray().push(C)),this.formArray.set(this.formArray()),this.sourceSubject$.next(this.formArray())},error:m=>console.error(m)})}toggleAllRows(){if(this.IsAllSelected()){this.selectionModel.clear();const t=this.formArray().value;return this.formArray().setValue(t.map(()=>!1)),this.formArray.set(this.formArray()),void this.hasValue.set(this.selectionModel.hasValue())}for(let t=0;t<this.TableSize();t++){this.selectionModel.select(t);const e=this.formArray().controls[t];this.setFormValue(e,this.selectionModel.isSelected(t))}this.hasValue.set(this.selectionModel.hasValue()),this.formArray.set(this.formArray())}get IsAllSelected(){return(0,o.EWP)(()=>this.FormArray().controls.length===this.selectionModel.selected.length)}toggleRow(t){"loaded"===this.dataState()&&(this.selectionModel.toggle(t),this.hasValue.set(this.selectionModel.hasValue()))}toggleFormHelper(t){t.setValue(!t.value)}setFormValue(t,e){t.setValue(e)}isSelected(t){return(0,o.EWP)(()=>t<0||t>=this.TableSize()?(console.error(`index ${t} was out of bounds.`),!1):this.formArray().controls[t].value)}isToggled(){return this.selectionModel.hasValue()}isTagged(t){return(0,o.EWP)(()=>this.currentTaggedAnimals().has(t))}groupIndividuals(){return(0,o.EWP)(()=>[[],[]])}get FormArray(){return(0,o.EWP)(()=>this.formArray())}get HasValue(){return(0,o.EWP)(()=>this.hasValue())}get TableState(){return this.dataState}get TableSize(){return(0,o.EWP)(()=>this.formArray().controls.length)}get DataStateAsObservable(){return this.dataState$.asObservable()}get allIndividuals(){return(0,o.EWP)(()=>this.currentAnimals())}get taggedAndSelectedIndividuals(){return(0,o.EWP)(()=>{if(this.currentSource().length!==this.formArray().length)return[];const t=[],e=this.formArray().value,n=this.currentSource().length;for(let r=0;r<n;r++){const l=this.currentSource()[r];!0===e[r]&&t.push(l.LocalIdentifier)}return t})}getIndividual(t){return(0,o.EWP)(()=>t<0||t>=this.currentSource().length?(console.error("Out of bounds error."),null):this.currentSource()[t])}get allTaggedIndividuals(){return(0,o.EWP)(()=>this.currentTaggedAnimals())}}const Pce=["mat-calendar-body",""];function Oce(i,t){return this._trackRow(t)}const Y$=(i,t)=>t.id;function Lce(i,t){if(1&i&&(o.j41(0,"tr",0)(1,"td",3),o.EFF(2),o.k0s()()),2&i){const e=o.XpG();o.R7$(),o.xc7("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),o.BMQ("colspan",e.numCols),o.R7$(),o.SpI(" ",e.label," ")}}function Fce(i,t){if(1&i&&(o.j41(0,"td",3),o.EFF(1),o.k0s()),2&i){const e=o.XpG(2);o.xc7("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),o.BMQ("colspan",e._firstRowOffset),o.R7$(),o.SpI(" ",e._firstRowOffset>=e.labelMinRequiredCells?e.label:""," ")}}function Nce(i,t){if(1&i){const e=o.RV6();o.j41(0,"td",6)(1,"button",7),o.bIt("click",function(r){const l=o.eBV(e).$implicit,m=o.XpG(2);return o.Njj(m._cellClicked(l,r))})("focus",function(r){const l=o.eBV(e).$implicit,m=o.XpG(2);return o.Njj(m._emitActiveDateChange(l,r))}),o.j41(2,"span",8),o.EFF(3),o.k0s(),o.nrm(4,"span",9),o.k0s()()}if(2&i){const e=t.$implicit,n=t.$index,r=o.XpG().$index,l=o.XpG();o.xc7("width",l._cellWidth)("padding-top",l._cellPadding)("padding-bottom",l._cellPadding),o.BMQ("data-mat-row",r)("data-mat-col",n),o.R7$(),o.AVh("mat-calendar-body-disabled",!e.enabled)("mat-calendar-body-active",l._isActiveCell(r,n))("mat-calendar-body-range-start",l._isRangeStart(e.compareValue))("mat-calendar-body-range-end",l._isRangeEnd(e.compareValue))("mat-calendar-body-in-range",l._isInRange(e.compareValue))("mat-calendar-body-comparison-bridge-start",l._isComparisonBridgeStart(e.compareValue,r,n))("mat-calendar-body-comparison-bridge-end",l._isComparisonBridgeEnd(e.compareValue,r,n))("mat-calendar-body-comparison-start",l._isComparisonStart(e.compareValue))("mat-calendar-body-comparison-end",l._isComparisonEnd(e.compareValue))("mat-calendar-body-in-comparison-range",l._isInComparisonRange(e.compareValue))("mat-calendar-body-preview-start",l._isPreviewStart(e.compareValue))("mat-calendar-body-preview-end",l._isPreviewEnd(e.compareValue))("mat-calendar-body-in-preview",l._isInPreview(e.compareValue)),o.Y8G("ngClass",e.cssClasses)("tabindex",l._isActiveCell(r,n)?0:-1),o.BMQ("aria-label",e.ariaLabel)("aria-disabled",!e.enabled||null)("aria-pressed",l._isSelected(e.compareValue))("aria-current",l.todayValue===e.compareValue?"date":null)("aria-describedby",l._getDescribedby(e.compareValue)),o.R7$(),o.AVh("mat-calendar-body-selected",l._isSelected(e.compareValue))("mat-calendar-body-comparison-identical",l._isComparisonIdentical(e.compareValue))("mat-calendar-body-today",l.todayValue===e.compareValue),o.R7$(),o.SpI(" ",e.displayValue," ")}}function Bce(i,t){if(1&i&&(o.j41(0,"tr",1),o.DNE(1,Fce,2,6,"td",4),o.Z7z(2,Nce,5,48,"td",5,Y$),o.k0s()),2&i){const e=t.$implicit,n=t.$index,r=o.XpG();o.R7$(),o.vxM(0===n&&r._firstRowOffset?1:-1),o.R7$(),o.Dyx(e)}}function Vce(i,t){if(1&i&&(o.j41(0,"th",2)(1,"span",6),o.EFF(2),o.k0s(),o.j41(3,"span",3),o.EFF(4),o.k0s()()),2&i){const e=t.$implicit;o.R7$(2),o.JRh(e.long),o.R7$(2),o.JRh(e.narrow)}}const zce=["*"];function Uce(i,t){}function jce(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-month-view",4),o.mxI("activeDateChange",function(r){o.eBV(e);const l=o.XpG();return o.DH7(l.activeDate,r)||(l.activeDate=r),o.Njj(r)}),o.bIt("_userSelection",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._dateSelected(r))})("dragStarted",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._dragStarted(r))})("dragEnded",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._dragEnded(r))}),o.k0s()}if(2&i){const e=o.XpG();o.R50("activeDate",e.activeDate),o.Y8G("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)("comparisonStart",e.comparisonStart)("comparisonEnd",e.comparisonEnd)("startDateAccessibleName",e.startDateAccessibleName)("endDateAccessibleName",e.endDateAccessibleName)("activeDrag",e._activeDrag)}}function Gce(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-year-view",5),o.mxI("activeDateChange",function(r){o.eBV(e);const l=o.XpG();return o.DH7(l.activeDate,r)||(l.activeDate=r),o.Njj(r)}),o.bIt("monthSelected",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._monthSelectedInYearView(r))})("selectedChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._goToDateInView(r,"month"))}),o.k0s()}if(2&i){const e=o.XpG();o.R50("activeDate",e.activeDate),o.Y8G("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function Hce(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-multi-year-view",6),o.mxI("activeDateChange",function(r){o.eBV(e);const l=o.XpG();return o.DH7(l.activeDate,r)||(l.activeDate=r),o.Njj(r)}),o.bIt("yearSelected",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._yearSelectedInMultiYearView(r))})("selectedChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._goToDateInView(r,"year"))}),o.k0s()}if(2&i){const e=o.XpG();o.R50("activeDate",e.activeDate),o.Y8G("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function $ce(i,t){}const Wce=["button"],Xce=[[["","matDatepickerToggleIcon",""]]],qce=["[matDatepickerToggleIcon]"];function Yce(i,t){1&i&&(o.qSk(),o.j41(0,"svg",2),o.nrm(1,"path",3),o.k0s())}let zk=(()=>{class i{constructor(){this.changes=new xi.B,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(e,n){return`${e} \u2013 ${n}`}formatYearRangeLabel(e,n){return`${e} to ${n}`}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Zce=0;class yz{constructor(t,e,n,r,l={},m=t,C){this.value=t,this.displayValue=e,this.ariaLabel=n,this.enabled=r,this.cssClasses=l,this.compareValue=m,this.rawValue=C,this.id=Zce++}}let Kce=1;const Z$=Ql({passive:!1,capture:!0}),xx=Ql({passive:!0,capture:!0}),GO=Ql({passive:!0});let OS=(()=>{class i{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(e,n){this._elementRef=e,this._ngZone=n,this._platform=(0,o.WQX)(wo),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new o.bkB,this.previewChange=new o.bkB,this.activeDateChange=new o.bkB,this.dragStarted=new o.bkB,this.dragEnded=new o.bkB,this._didDragSinceMouseDown=!1,this._injector=(0,o.WQX)(o.zZn),this._trackRow=r=>r,this._enterHandler=r=>{if(this._skipNextFocus&&"focus"===r.type)this._skipNextFocus=!1;else if(r.target&&this.isRange){const l=this._getCellFromElement(r.target);l&&this._ngZone.run(()=>this.previewChange.emit({value:l.enabled?l:null,event:r}))}},this._touchmoveHandler=r=>{if(!this.isRange)return;const l=K$(r),m=l?this._getCellFromElement(l):null;l!==r.target&&(this._didDragSinceMouseDown=!0),wz(r.target)&&r.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:m?.enabled?m:null,event:r}))},this._leaveHandler=r=>{null!==this.previewEnd&&this.isRange&&("blur"!==r.type&&(this._didDragSinceMouseDown=!0),r.target&&this._getCellFromElement(r.target)&&(!r.relatedTarget||!this._getCellFromElement(r.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:r})))},this._mousedownHandler=r=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;const l=r.target&&this._getCellFromElement(r.target);!l||!this._isInRange(l.compareValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:l.rawValue,event:r})})},this._mouseupHandler=r=>{if(!this.isRange)return;const l=wz(r.target);l?l.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{const m=this._getCellFromElement(l);this.dragEnded.emit({value:m?.rawValue??null,event:r})}):this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:r})})},this._touchendHandler=r=>{const l=K$(r);l&&this._mouseupHandler({target:l})},this._id="mat-calendar-body-"+Kce++,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,n.runOutsideAngular(()=>{const r=e.nativeElement;r.addEventListener("touchmove",this._touchmoveHandler,Z$),r.addEventListener("mouseenter",this._enterHandler,xx),r.addEventListener("focus",this._enterHandler,xx),r.addEventListener("mouseleave",this._leaveHandler,xx),r.addEventListener("blur",this._leaveHandler,xx),r.addEventListener("mousedown",this._mousedownHandler,GO),r.addEventListener("touchstart",this._mousedownHandler,GO),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(e,n){this._didDragSinceMouseDown||e.enabled&&this.selectedValueChange.emit({value:e.value,event:n})}_emitActiveDateChange(e,n){e.enabled&&this.activeDateChange.emit({value:e.value,event:n})}_isSelected(e){return this.startValue===e||this.endValue===e}ngOnChanges(e){const n=e.numCols,{rows:r,numCols:l}=this;(e.rows||n)&&(this._firstRowOffset=r&&r.length&&r[0].length?l-r[0].length:0),(e.cellAspectRatio||n||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/l+"%"),(n||!this._cellWidth)&&(this._cellWidth=100/l+"%")}ngOnDestroy(){const e=this._elementRef.nativeElement;e.removeEventListener("touchmove",this._touchmoveHandler,Z$),e.removeEventListener("mouseenter",this._enterHandler,xx),e.removeEventListener("focus",this._enterHandler,xx),e.removeEventListener("mouseleave",this._leaveHandler,xx),e.removeEventListener("blur",this._leaveHandler,xx),e.removeEventListener("mousedown",this._mousedownHandler,GO),e.removeEventListener("touchstart",this._mousedownHandler,GO),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(e,n){let r=e*this.numCols+n;return e&&(r-=this._firstRowOffset),r==this.activeCell}_focusActiveCell(e=!0){(0,o.mal)(()=>{setTimeout(()=>{const n=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");n&&(e||(this._skipNextFocus=!0),n.focus())})},{injector:this._injector})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(e){return Cz(e,this.startValue,this.endValue)}_isRangeEnd(e){return Ez(e,this.startValue,this.endValue)}_isInRange(e){return Tz(e,this.startValue,this.endValue,this.isRange)}_isComparisonStart(e){return Cz(e,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(e,n,r){if(!this._isComparisonStart(e)||this._isRangeStart(e)||!this._isInRange(e))return!1;let l=this.rows[n][r-1];if(!l){const m=this.rows[n-1];l=m&&m[m.length-1]}return l&&!this._isRangeEnd(l.compareValue)}_isComparisonBridgeEnd(e,n,r){if(!this._isComparisonEnd(e)||this._isRangeEnd(e)||!this._isInRange(e))return!1;let l=this.rows[n][r+1];if(!l){const m=this.rows[n+1];l=m&&m[0]}return l&&!this._isRangeStart(l.compareValue)}_isComparisonEnd(e){return Ez(e,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(e){return Tz(e,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(e){return this.comparisonStart===this.comparisonEnd&&e===this.comparisonStart}_isPreviewStart(e){return Cz(e,this.previewStart,this.previewEnd)}_isPreviewEnd(e){return Ez(e,this.previewStart,this.previewEnd)}_isInPreview(e){return Tz(e,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(e){return this.isRange?this.startValue===e&&this.endValue===e?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===e?this._startDateLabelId:this.endValue===e?this._endDateLabelId:null:null}_getCellFromElement(e){const n=wz(e);if(n){const r=n.getAttribute("data-mat-row"),l=n.getAttribute("data-mat-col");if(r&&l)return this.rows[parseInt(r)][parseInt(l)]}return null}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.SKi))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],standalone:!0,features:[o.OA$,o.aNF],attrs:Pce,decls:7,vars:5,consts:[["aria-hidden","true"],["role","row"],[1,"mat-calendar-body-hidden-label",3,"id"],[1,"mat-calendar-body-label"],[1,"mat-calendar-body-label",3,"paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"click","focus","ngClass","tabindex"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(n,r){1&n&&(o.DNE(0,Lce,3,6,"tr",0),o.Z7z(1,Bce,4,1,"tr",1,Oce,!0),o.j41(3,"label",2),o.EFF(4),o.k0s(),o.j41(5,"label",2),o.EFF(6),o.k0s()),2&n&&(o.vxM(r._firstRowOffset<r.labelMinRequiredCells?0:-1),o.R7$(),o.Dyx(r.rows),o.R7$(2),o.Y8G("id",r._startDateLabelId),o.R7$(),o.SpI(" ",r.startDateAccessibleName,"\n"),o.R7$(),o.Y8G("id",r._endDateLabelId),o.R7$(),o.SpI(" ",r.endDateAccessibleName,"\n"))},dependencies:[Hm],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color)}.mat-calendar-body-label{height:0;line-height:0;text-align:start;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size);font-weight:var(--mat-datepicker-calendar-body-label-text-weight);color:var(--mat-datepicker-calendar-body-label-text-color)}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color)}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color)}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color);border-color:var(--mat-datepicker-calendar-date-outline-color)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color)}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color)}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color);color:var(--mat-datepicker-calendar-date-selected-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color)}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color)}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color)}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color)}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}'],encapsulation:2,changeDetection:0})}}return i})();function xz(i){return"TD"===i?.nodeName}function wz(i){let t;return xz(i)?t=i:xz(i.parentNode)?t=i.parentNode:xz(i.parentNode?.parentNode)&&(t=i.parentNode.parentNode),null!=t?.getAttribute("data-mat-row")?t:null}function Cz(i,t,e){return null!==e&&t!==e&&i<e&&i===t}function Ez(i,t,e){return null!==t&&t!==e&&i>=t&&i===e}function Tz(i,t,e,n){return n&&null!==t&&null!==e&&t!==e&&i>=t&&i<=e}function K$(i){const t=i.changedTouches[0];return document.elementFromPoint(t.clientX,t.clientY)}class xu{constructor(t,e){this.start=t,this.end=e}}let sC=(()=>{class i{constructor(e,n){this.selection=e,this._adapter=n,this._selectionChanged=new xi.B,this.selectionChanged=this._selectionChanged,this.selection=e}updateSelection(e,n){const r=this.selection;this.selection=e,this._selectionChanged.next({selection:e,source:n,oldValue:r})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(e){return this._adapter.isDateInstance(e)&&this._adapter.isValid(e)}static{this.\u0275fac=function(n){o.QTQ()}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})(),Qce=(()=>{class i extends sC{constructor(e){super(null,e)}add(e){super.updateSelection(e,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const e=new i(this._adapter);return e.updateSelection(this.selection,this),e}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Xa))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const tde={provide:sC,deps:[[new o.Xx1,new o.kdw,sC],Xa],useFactory:function ede(i,t){return i||new Qce(t)}},HO=new o.nKC("MAT_DATE_RANGE_SELECTION_STRATEGY");let ode=0,Q$=(()=>{class i{get activeDate(){return this._activeDate}set activeDate(e){const n=this._activeDate,r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),this._hasSameMonthAndYear(n,this._activeDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof xu?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,n,r,l,m){this._changeDetectorRef=e,this._dateFormats=n,this._dateAdapter=r,this._dir=l,this._rangeStrategy=m,this._rerenderSubscription=On.yU.EMPTY,this.activeDrag=null,this.selectedChange=new o.bkB,this._userSelection=new o.bkB,this.dragStarted=new o.bkB,this.dragEnded=new o.bkB,this.activeDateChange=new o.bkB,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(As(null)).subscribe(()=>this._init())}ngOnChanges(e){const n=e.comparisonStart||e.comparisonEnd;n&&!n.firstChange&&this._setRanges(this.selected),e.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(e){const n=e.value,r=this._getDateFromDayOfMonth(n);let l,m;this._selected instanceof xu?(l=this._getDateInCurrentMonth(this._selected.start),m=this._getDateInCurrentMonth(this._selected.end)):l=m=this._getDateInCurrentMonth(this._selected),(l!==n||m!==n)&&this.selectedChange.emit(r),this._userSelection.emit({value:r,event:e.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(e){const n=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&e.preventDefault());case 27:return void(null!=this._previewEnd&&!oa(e)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:e}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:e})),e.preventDefault(),e.stopPropagation()));default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let e=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(e)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(e){this._matCalendarBody._focusActiveCell(e)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:e,value:n}){if(this._rangeStrategy){const r=n?n.rawValue:null,l=this._rangeStrategy.createPreview(r,this.selected,e);if(this._previewStart=this._getCellCompareValue(l.start),this._previewEnd=this._getCellCompareValue(l.end),this.activeDrag&&r){const m=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,r,e);m&&(this._previewStart=this._getCellCompareValue(m.start),this._previewEnd=this._getCellCompareValue(m.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(e){if(this.activeDrag)if(e.value){const n=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,e.value,e.event);this.dragEnded.emit({value:n??null,event:e.event})}else this.dragEnded.emit({value:null,event:e.event})}_getDateFromDayOfMonth(e){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),e)}_initWeekdays(){const e=this._dateAdapter.getFirstDayOfWeek(),n=this._dateAdapter.getDayOfWeekNames("narrow");let l=this._dateAdapter.getDayOfWeekNames("long").map((m,C)=>({long:m,narrow:n[C],id:ode++}));this._weekdays=l.slice(e).concat(l.slice(0,e))}_createWeekCells(){const e=this._dateAdapter.getNumDaysInMonth(this.activeDate),n=this._dateAdapter.getDateNames();this._weeks=[[]];for(let r=0,l=this._firstWeekOffset;r<e;r++,l++){7==l&&(this._weeks.push([]),l=0);const m=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),r+1),C=this._shouldEnableDate(m),A=this._dateAdapter.format(m,this._dateFormats.display.dateA11yLabel),O=this.dateClass?this.dateClass(m,"month"):void 0;this._weeks[this._weeks.length-1].push(new yz(r+1,n[r],A,C,O,this._getCellCompareValue(m),m))}}_shouldEnableDate(e){return!!e&&(!this.minDate||this._dateAdapter.compareDate(e,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(e,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(e))}_getDateInCurrentMonth(e){return e&&this._hasSameMonthAndYear(e,this.activeDate)?this._dateAdapter.getDate(e):null}_hasSameMonthAndYear(e,n){return!(!e||!n||this._dateAdapter.getMonth(e)!=this._dateAdapter.getMonth(n)||this._dateAdapter.getYear(e)!=this._dateAdapter.getYear(n))}_getCellCompareValue(e){if(e){const n=this._dateAdapter.getYear(e),r=this._dateAdapter.getMonth(e),l=this._dateAdapter.getDate(e);return new Date(n,r,l).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(e){e instanceof xu?(this._rangeStart=this._getCellCompareValue(e.start),this._rangeEnd=this._getCellCompareValue(e.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(e),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(e){return!this.dateFilter||this.dateFilter(e)}_clearPreview(){this._previewStart=this._previewEnd=null}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.rXU(Bp,8),o.rXU(Xa,8),o.rXU(Us,8),o.rXU(HO,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-month-view"]],viewQuery:function(n,r){if(1&n&&o.GBs(OS,5),2&n){let l;o.mGM(l=o.lsd())&&(r._matCalendarBody=l.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],standalone:!0,features:[o.OA$,o.aNF],decls:8,vars:14,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col"],["aria-hidden","true"],["colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown","label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName"],[1,"cdk-visually-hidden"]],template:function(n,r){1&n&&(o.j41(0,"table",0)(1,"thead",1)(2,"tr"),o.Z7z(3,Vce,5,2,"th",2,Y$),o.k0s(),o.j41(5,"tr",3),o.nrm(6,"th",4),o.k0s()(),o.j41(7,"tbody",5),o.bIt("selectedValueChange",function(m){return r._dateSelected(m)})("activeDateChange",function(m){return r._updateActiveDate(m)})("previewChange",function(m){return r._previewChanged(m)})("dragStarted",function(m){return r.dragStarted.emit(m)})("dragEnded",function(m){return r._dragEnded(m)})("keyup",function(m){return r._handleCalendarBodyKeyup(m)})("keydown",function(m){return r._handleCalendarBodyKeydown(m)}),o.k0s()()),2&n&&(o.R7$(3),o.Dyx(r._weekdays),o.R7$(4),o.Y8G("label",r._monthLabel)("rows",r._weeks)("todayValue",r._todayDate)("startValue",r._rangeStart)("endValue",r._rangeEnd)("comparisonStart",r._comparisonRangeStart)("comparisonEnd",r._comparisonRangeEnd)("previewStart",r._previewStart)("previewEnd",r._previewEnd)("isRange",r._isRange)("labelMinRequiredCells",3)("activeCell",r._dateAdapter.getDate(r.activeDate)-1)("startDateAccessibleName",r.startDateAccessibleName)("endDateAccessibleName",r.endDateAccessibleName))},dependencies:[OS],encapsulation:2,changeDetection:0})}}return i})();const uf=24;let J$=(()=>{class i{get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate;const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),e7(this._dateAdapter,n,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof xu?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedYear(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,n,r){this._changeDetectorRef=e,this._dateAdapter=n,this._dir=r,this._rerenderSubscription=On.yU.EMPTY,this.selectedChange=new o.bkB,this.yearSelected=new o.bkB,this.activeDateChange=new o.bkB,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(As(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const n=this._dateAdapter.getYear(this._activeDate)-Uk(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let r=0,l=[];r<uf;r++)l.push(n+r),4==l.length&&(this._years.push(l.map(m=>this._createCellForYear(m))),l=[]);this._changeDetectorRef.markForCheck()}_yearSelected(e){const n=e.value,r=this._dateAdapter.createDate(n,0,1),l=this._getDateFromYear(n);this.yearSelected.emit(r),this.selectedChange.emit(l)}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromYear(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const n=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-Uk(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,uf-Uk(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*-uf:-uf);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*uf:uf);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_getActiveCell(){return Uk(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(e){const n=this._dateAdapter.getMonth(this.activeDate),r=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(e,n,1));return this._dateAdapter.createDate(e,n,Math.min(this._dateAdapter.getDate(this.activeDate),r))}_createCellForYear(e){const n=this._dateAdapter.createDate(e,0,1),r=this._dateAdapter.getYearName(n),l=this.dateClass?this.dateClass(n,"multi-year"):void 0;return new yz(e,r,r,this._shouldEnableYear(e),l)}_shouldEnableYear(e){if(null==e||this.maxDate&&e>this._dateAdapter.getYear(this.maxDate)||this.minDate&&e<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let r=this._dateAdapter.createDate(e,0,1);this._dateAdapter.getYear(r)==e;r=this._dateAdapter.addCalendarDays(r,1))if(this.dateFilter(r))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(e){if(this._selectedYear=null,e instanceof xu){const n=e.start||e.end;n&&(this._selectedYear=this._dateAdapter.getYear(n))}else e&&(this._selectedYear=this._dateAdapter.getYear(e))}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.rXU(Xa,8),o.rXU(Us,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-multi-year-view"]],viewQuery:function(n,r){if(1&n&&o.GBs(OS,5),2&n){let l;o.mGM(l=o.lsd())&&(r._matCalendarBody=l.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],standalone:!0,features:[o.aNF],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell"]],template:function(n,r){1&n&&(o.j41(0,"table",0)(1,"thead",1)(2,"tr"),o.nrm(3,"th",2),o.k0s()(),o.j41(4,"tbody",3),o.bIt("selectedValueChange",function(m){return r._yearSelected(m)})("activeDateChange",function(m){return r._updateActiveDate(m)})("keyup",function(m){return r._handleCalendarBodyKeyup(m)})("keydown",function(m){return r._handleCalendarBodyKeydown(m)}),o.k0s()()),2&n&&(o.R7$(4),o.Y8G("rows",r._years)("todayValue",r._todayYear)("startValue",r._selectedYear)("endValue",r._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",r._getActiveCell()))},dependencies:[OS],encapsulation:2,changeDetection:0})}}return i})();function e7(i,t,e,n,r){const l=i.getYear(t),m=i.getYear(e),C=t7(i,n,r);return Math.floor((l-C)/uf)===Math.floor((m-C)/uf)}function Uk(i,t,e,n){return function sde(i,t){return(i%t+t)%t}(i.getYear(t)-t7(i,e,n),uf)}function t7(i,t,e){let n=0;return e?n=i.getYear(e)-uf+1:t&&(n=i.getYear(t)),n}let i7=(()=>{class i{get activeDate(){return this._activeDate}set activeDate(e){let n=this._activeDate;const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),this._dateAdapter.getYear(n)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof xu?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedMonth(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,n,r,l){this._changeDetectorRef=e,this._dateFormats=n,this._dateAdapter=r,this._dir=l,this._rerenderSubscription=On.yU.EMPTY,this.selectedChange=new o.bkB,this.monthSelected=new o.bkB,this.activeDateChange=new o.bkB,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(As(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(e){const n=e.value,r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),n,1);this.monthSelected.emit(r);const l=this._getDateFromMonth(n);this.selectedChange.emit(l)}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromMonth(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const n=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(n,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let e=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(n=>n.map(r=>this._createCellForMonth(r,e[r]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(e){return e&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(e):null}_getDateFromMonth(e){const n=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),r=this._dateAdapter.getNumDaysInMonth(n);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,Math.min(this._dateAdapter.getDate(this.activeDate),r))}_createCellForMonth(e,n){const r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),l=this._dateAdapter.format(r,this._dateFormats.display.monthYearA11yLabel),m=this.dateClass?this.dateClass(r,"year"):void 0;return new yz(e,n.toLocaleUpperCase(),l,this._shouldEnableMonth(e),m)}_shouldEnableMonth(e){const n=this._dateAdapter.getYear(this.activeDate);if(null==e||this._isYearAndMonthAfterMaxDate(n,e)||this._isYearAndMonthBeforeMinDate(n,e))return!1;if(!this.dateFilter)return!0;for(let l=this._dateAdapter.createDate(n,e,1);this._dateAdapter.getMonth(l)==e;l=this._dateAdapter.addCalendarDays(l,1))if(this.dateFilter(l))return!0;return!1}_isYearAndMonthAfterMaxDate(e,n){if(this.maxDate){const r=this._dateAdapter.getYear(this.maxDate),l=this._dateAdapter.getMonth(this.maxDate);return e>r||e===r&&n>l}return!1}_isYearAndMonthBeforeMinDate(e,n){if(this.minDate){const r=this._dateAdapter.getYear(this.minDate),l=this._dateAdapter.getMonth(this.minDate);return e<r||e===r&&n<l}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(e){this._selectedMonth=e instanceof xu?this._getMonthInCurrentYear(e.start)||this._getMonthInCurrentYear(e.end):this._getMonthInCurrentYear(e)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.rXU(Bp,8),o.rXU(Xa,8),o.rXU(Us,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-year-view"]],viewQuery:function(n,r){if(1&n&&o.GBs(OS,5),2&n){let l;o.mGM(l=o.lsd())&&(r._matCalendarBody=l.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],standalone:!0,features:[o.aNF],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"selectedValueChange","activeDateChange","keyup","keydown","label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell"]],template:function(n,r){1&n&&(o.j41(0,"table",0)(1,"thead",1)(2,"tr"),o.nrm(3,"th",2),o.k0s()(),o.j41(4,"tbody",3),o.bIt("selectedValueChange",function(m){return r._monthSelected(m)})("activeDateChange",function(m){return r._updateActiveDate(m)})("keyup",function(m){return r._handleCalendarBodyKeyup(m)})("keydown",function(m){return r._handleCalendarBodyKeydown(m)}),o.k0s()()),2&n&&(o.R7$(4),o.Y8G("label",r._yearLabel)("rows",r._months)("todayValue",r._todayMonth)("startValue",r._selectedMonth)("endValue",r._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",r._dateAdapter.getMonth(r.activeDate)))},dependencies:[OS],encapsulation:2,changeDetection:0})}}return i})(),ade=1,n7=(()=>{class i{constructor(e,n,r,l,m){this._intl=e,this.calendar=n,this._dateAdapter=r,this._dateFormats=l,this._id="mat-calendar-header-"+ade++,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>m.markForCheck())}get periodButtonText(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-uf)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:uf)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(e,n){return"month"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n)&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(n):"year"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(n):e7(this._dateAdapter,e,n,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){const n=this._dateAdapter.getYear(this.calendar.activeDate)-Uk(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),r=n+uf-1;return[this._dateAdapter.getYearName(this._dateAdapter.createDate(n,0,1)),this._dateAdapter.getYearName(this._dateAdapter.createDate(r,0,1))]}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(zk),o.rXU((0,o.Rfq)(()=>Az)),o.rXU(Xa,8),o.rXU(Bp,8),o.rXU(o.gRc))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],standalone:!0,features:[o.aNF],ngContentSelectors:zce,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["aria-live","polite",1,"cdk-visually-hidden",3,"id"],["mat-button","","type","button",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"click","disabled"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"click","disabled"]],template:function(n,r){1&n&&(o.NAR(),o.j41(0,"div",0)(1,"div",1)(2,"label",2),o.EFF(3),o.k0s(),o.j41(4,"button",3),o.bIt("click",function(){return r.currentPeriodClicked()}),o.j41(5,"span",4),o.EFF(6),o.k0s(),o.qSk(),o.j41(7,"svg",5),o.nrm(8,"polygon",6),o.k0s()(),o.joV(),o.nrm(9,"div",7),o.SdG(10),o.j41(11,"button",8),o.bIt("click",function(){return r.previousClicked()}),o.k0s(),o.j41(12,"button",9),o.bIt("click",function(){return r.nextClicked()}),o.k0s()()()),2&n&&(o.R7$(2),o.Y8G("id",r._periodButtonLabelId),o.R7$(),o.JRh(r.periodButtonDescription),o.R7$(),o.BMQ("aria-label",r.periodButtonLabel)("aria-describedby",r._periodButtonLabelId),o.R7$(2),o.JRh(r.periodButtonText),o.R7$(),o.AVh("mat-calendar-invert","month"!==r.calendar.currentView),o.R7$(4),o.Y8G("disabled",!r.previousEnabled()),o.BMQ("aria-label",r.prevButtonLabel),o.R7$(),o.Y8G("disabled",!r.nextEnabled()),o.BMQ("aria-label",r.nextButtonLabel))},dependencies:[Sc,mu],encapsulation:2,changeDetection:0})}}return i})(),Az=(()=>{class i{get startAt(){return this._startAt}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get selected(){return this._selected}set selected(e){this._selected=e instanceof xu?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get activeDate(){return this._clampedActiveDate}set activeDate(e){this._clampedActiveDate=this._dateAdapter.clampDate(e,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(e){const n=this._currentView!==e?e:null;this._currentView=e,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),n&&this.viewChanged.emit(n)}constructor(e,n,r,l){this._dateAdapter=n,this._dateFormats=r,this._changeDetectorRef=l,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new o.bkB,this.yearSelected=new o.bkB,this.monthSelected=new o.bkB,this.viewChanged=new o.bkB(!0),this._userSelection=new o.bkB,this._userDragDrop=new o.bkB,this._activeDrag=null,this.stateChanges=new xi.B,this._intlChanges=e.changes.subscribe(()=>{l.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new xS(this.headerComponent||n7),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(e){const n=e.minDate&&!this._dateAdapter.sameDate(e.minDate.previousValue,e.minDate.currentValue)?e.minDate:void 0,r=e.maxDate&&!this._dateAdapter.sameDate(e.maxDate.previousValue,e.maxDate.currentValue)?e.maxDate:void 0,l=n||r||e.dateFilter;if(l&&!l.firstChange){const m=this._getCurrentViewComponent();m&&(this._moveFocusOnNextTick=!0,this._changeDetectorRef.detectChanges(),m._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(e){const n=e.value;(this.selected instanceof xu||n&&!this._dateAdapter.sameDate(n,this.selected))&&this.selectedChange.emit(n),this._userSelection.emit(e)}_yearSelectedInMultiYearView(e){this.yearSelected.emit(e)}_monthSelectedInYearView(e){this.monthSelected.emit(e)}_goToDateInView(e,n){this.activeDate=e,this.currentView=n}_dragStarted(e){this._activeDrag=e}_dragEnded(e){this._activeDrag&&(e.value&&this._userDragDrop.emit(e),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(zk),o.rXU(Xa,8),o.rXU(Bp,8),o.rXU(o.gRc))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-calendar"]],viewQuery:function(n,r){if(1&n&&(o.GBs(Q$,5),o.GBs(i7,5),o.GBs(J$,5)),2&n){let l;o.mGM(l=o.lsd())&&(r.monthView=l.first),o.mGM(l=o.lsd())&&(r.yearView=l.first),o.mGM(l=o.lsd())&&(r.multiYearView=l.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],standalone:!0,features:[o.Jv_([tde]),o.OA$,o.aNF],decls:5,vars:2,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","_userSelection","dragStarted","dragEnded","activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag"],[3,"activeDateChange","monthSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"],[3,"activeDateChange","yearSelected","selectedChange","activeDate","selected","dateFilter","maxDate","minDate","dateClass"]],template:function(n,r){if(1&n&&(o.DNE(0,Uce,0,0,"ng-template",0),o.j41(1,"div",1),o.DNE(2,jce,1,11,"mat-month-view",2)(3,Gce,1,6,"mat-year-view",3)(4,Hce,1,6,"mat-multi-year-view",3),o.k0s()),2&n){let l;o.Y8G("cdkPortalOutlet",r._calendarHeaderPortal),o.R7$(2),o.vxM("month"===(l=r.currentView)?2:"year"===l?3:"multi-year"===l?4:-1)}},dependencies:[gx,Jy,Q$,i7,J$],styles:['.mat-calendar{display:block;font-family:var(--mat-datepicker-calendar-text-font);font-size:var(--mat-datepicker-calendar-text-size)}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size);font-weight:var(--mat-datepicker-calendar-period-button-text-weight);--mdc-text-button-label-text-color:var(--mat-datepicker-calendar-period-button-text-color)}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color)}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-datepicker-content .mat-calendar-previous-button:not(.mat-mdc-button-disabled),.mat-datepicker-content .mat-calendar-next-button:not(.mat-mdc-button-disabled){color:var(--mat-datepicker-calendar-navigation-button-icon-color)}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color);font-size:var(--mat-datepicker-calendar-header-text-size);font-weight:var(--mat-datepicker-calendar-header-text-weight)}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return i})();const r7={transformPanel:js("transformPanel",[oo("void => enter-dropdown",co("120ms cubic-bezier(0, 0, 0.2, 1)",pb([gn({opacity:0,transform:"scale(1, 0.8)"}),gn({opacity:1,transform:"scale(1, 1)"})]))),oo("void => enter-dialog",co("150ms cubic-bezier(0, 0, 0.2, 1)",pb([gn({opacity:0,transform:"scale(0.7)"}),gn({transform:"none",opacity:1})]))),oo("* => void",co("100ms linear",gn({opacity:0})))]),fadeInCalendar:js("fadeInCalendar",[Lo("void",gn({opacity:0})),Lo("enter",gn({opacity:1})),oo("void => *",co("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])},lde=new o.nKC("mat-datepicker-scroll-strategy",{providedIn:"root",factory:()=>{const i=(0,o.WQX)(_l);return()=>i.scrollStrategies.reposition()}}),dde={provide:lde,deps:[_l],useFactory:function cde(i){return()=>i.scrollStrategies.reposition()}};let ude=(()=>{class i{constructor(e,n,r,l,m,C){this._elementRef=e,this._changeDetectorRef=n,this._globalModel=r,this._dateAdapter=l,this._rangeSelectionStrategy=m,this._subscriptions=new On.yU,this._animationDone=new xi.B,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=C.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(e){const n=this._model.selection,r=e.value,l=n instanceof xu;if(l&&this._rangeSelectionStrategy){const m=this._rangeSelectionStrategy.selectionFinished(r,n,e.event);this._model.updateSelection(m,this)}else r&&(l||!this._dateAdapter.sameDate(r,n))&&this._model.add(r);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(e){this._model.updateSelection(e.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(e){this._isAnimating="start"===e.phaseName,this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(e,n){this._model=e?this._globalModel.clone():this._globalModel,this._actionsPortal=e,n&&this._changeDetectorRef.detectChanges()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(sC),o.rXU(Xa),o.rXU(HO,8),o.rXU(zk))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-datepicker-content"]],viewQuery:function(n,r){if(1&n&&o.GBs(Az,5),2&n){let l;o.mGM(l=o.lsd())&&(r._calendar=l.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:5,hostBindings:function(n,r){1&n&&o.Kam("@transformPanel.start",function(m){return r._handleAnimationEvent(m)})("@transformPanel.done",function(m){return r._handleAnimationEvent(m)}),2&n&&(o.zvX("@transformPanel",r._animationState),o.HbH(r.color?"mat-"+r.color:""),o.AVh("mat-datepicker-content-touch",r.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],standalone:!0,features:[o.aNF],decls:5,vars:27,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop","id","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"focus","blur","click","color"]],template:function(n,r){if(1&n&&(o.j41(0,"div",0)(1,"mat-calendar",1),o.bIt("yearSelected",function(m){return r.datepicker._selectYear(m)})("monthSelected",function(m){return r.datepicker._selectMonth(m)})("viewChanged",function(m){return r.datepicker._viewChanged(m)})("_userSelection",function(m){return r._handleUserSelection(m)})("_userDragDrop",function(m){return r._handleUserDragDrop(m)}),o.k0s(),o.DNE(2,$ce,0,0,"ng-template",2),o.j41(3,"button",3),o.bIt("focus",function(){return r._closeButtonFocused=!0})("blur",function(){return r._closeButtonFocused=!1})("click",function(){return r.datepicker.close()}),o.EFF(4),o.k0s()()),2&n){let l;o.AVh("mat-datepicker-content-container-with-custom-header",r.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",r._actionsPortal),o.BMQ("aria-modal",!0)("aria-labelledby",null!==(l=r._dialogLabelId)&&void 0!==l?l:void 0),o.R7$(),o.HbH(r.datepicker.panelClass),o.Y8G("id",r.datepicker.id)("startAt",r.datepicker.startAt)("startView",r.datepicker.startView)("minDate",r.datepicker._getMinDate())("maxDate",r.datepicker._getMaxDate())("dateFilter",r.datepicker._getDateFilter())("headerComponent",r.datepicker.calendarHeaderComponent)("selected",r._getSelected())("dateClass",r.datepicker.dateClass)("comparisonStart",r.comparisonStart)("comparisonEnd",r.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",r.startDateAccessibleName)("endDateAccessibleName",r.endDateAccessibleName),o.R7$(),o.Y8G("cdkPortalOutlet",r._actionsPortal),o.R7$(),o.AVh("cdk-visually-hidden",!r._closeButtonFocused),o.Y8G("color",r.color||"primary"),o.R7$(),o.JRh(r._closeButtonText)}},dependencies:[pE,Az,gx,Sc],styles:[".mat-datepicker-content{display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color);color:var(--mat-datepicker-calendar-container-text-color);box-shadow:var(--mat-datepicker-calendar-container-elevation-shadow);border-radius:var(--mat-datepicker-calendar-container-shape)}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;box-shadow:var(--mat-datepicker-calendar-container-touch-elevation-shadow);border-radius:var(--mat-datepicker-calendar-container-touch-shape);position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[r7.transformPanel,r7.fadeInCalendar]},changeDetection:0})}}return i})(),gde=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","matDatepickerToggleIcon",""]],standalone:!0})}}return i})(),_de=(()=>{class i{get disabled(){return void 0===this._disabled&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(e){this._disabled=e}constructor(e,n,r){this._intl=e,this._changeDetectorRef=n,this._stateChanges=On.yU.EMPTY;const l=Number(r);this.tabIndex=l||0===l?l:null}ngOnChanges(e){e.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.datepicker&&!this.disabled&&(this.datepicker.open(),e.stopPropagation())}_watchStateChanges(){const e=this.datepicker?this.datepicker.stateChanges:di(),n=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:di(),r=this.datepicker?Io(this.datepicker.openedStream,this.datepicker.closedStream):di();this._stateChanges.unsubscribe(),this._stateChanges=Io(this._intl.changes,e,n,r).subscribe(()=>this._changeDetectorRef.markForCheck())}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(zk),o.rXU(o.gRc),o.kS0("tabindex"))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-datepicker-toggle"]],contentQueries:function(n,r,l){if(1&n&&o.wni(l,gde,5),2&n){let m;o.mGM(m=o.lsd())&&(r._customIcon=m.first)}},viewQuery:function(n,r){if(1&n&&o.GBs(Wce,5),2&n){let l;o.mGM(l=o.lsd())&&(r._button=l.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(n,r){1&n&&o.bIt("click",function(m){return r._open(m)}),2&n&&(o.BMQ("tabindex",null)("data-mat-calendar",r.datepicker?r.datepicker.id:null),o.AVh("mat-datepicker-toggle-active",r.datepicker&&r.datepicker.opened)("mat-accent",r.datepicker&&"accent"===r.datepicker.color)("mat-warn",r.datepicker&&"warn"===r.datepicker.color))},inputs:{datepicker:[0,"for","datepicker"],tabIndex:"tabIndex",ariaLabel:[0,"aria-label","ariaLabel"],disabled:[2,"disabled","disabled",o.L39],disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],standalone:!0,features:[o.GFd,o.OA$,o.aNF],ngContentSelectors:qce,decls:4,vars:6,consts:[["button",""],["mat-icon-button","","type","button",3,"disabled","disableRipple"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(n,r){1&n&&(o.NAR(Xce),o.j41(0,"button",1,0),o.DNE(2,Yce,2,0,":svg:svg",2),o.SdG(3),o.k0s()),2&n&&(o.Y8G("disabled",r.disabled)("disableRipple",r.disableRipple),o.BMQ("aria-haspopup",r.datepicker?"dialog":null)("aria-label",r.ariaLabel||r._intl.openCalendarLabel)("tabindex",r.disabled?-1:r.tabIndex),o.R7$(2),o.vxM(r._customIcon?-1:2))},dependencies:[mu],styles:[".mat-datepicker-toggle{pointer-events:auto;color:var(--mat-datepicker-toggle-icon-color)}.mat-datepicker-toggle-active{color:var(--mat-datepicker-toggle-active-state-icon-color)}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0})}}return i})(),yde=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[zk,dde],imports:[os,ea,ES,ec,JP,qn,ude,_de,n7,Lb]})}}return i})();const xde=["switch"],wde=["*"];function Cde(i,t){1&i&&(o.j41(0,"div",10),o.qSk(),o.j41(1,"svg",12),o.nrm(2,"path",13),o.k0s(),o.j41(3,"svg",14),o.nrm(4,"path",15),o.k0s()())}const Ede=new o.nKC("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1})}),Tde={provide:Ya,useExisting:(0,o.Rfq)(()=>l7),multi:!0};class a7{constructor(t,e){this.source=t,this.checked=e}}let Sde=0,l7=(()=>{class i{_createChangeEvent(e){return new a7(this,e)}get buttonId(){return`${this.id||this._uniqueId}-button`}focus(){this._switchElement.nativeElement.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}constructor(e,n,r,l,m,C){this._elementRef=e,this._focusMonitor=n,this._changeDetectorRef=r,this.defaults=m,this._onChange=A=>{},this._onTouched=()=>{},this._validatorOnChange=()=>{},this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.disabled=!1,this.disableRipple=!1,this.tabIndex=0,this.change=new o.bkB,this.toggleChange=new o.bkB,this.tabIndex=parseInt(l)||0,this.color=m.color||"accent",this._noopAnimations="NoopAnimations"===C,this.id=this._uniqueId="mat-mdc-slide-toggle-"+ ++Sde,this.hideIcon=m.hideIcon??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{"keyboard"===e||"program"===e?(this._focused=!0,this._changeDetectorRef.markForCheck()):e||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(e){e.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(e){this.checked=!!e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}validate(e){return this.required&&!0!==e.value?{required:!0}:null}registerOnValidatorChange(e){this._validatorOnChange=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new a7(this,this.checked)))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(Kc),o.rXU(o.gRc),o.kS0("tabindex"),o.rXU(Ede),o.rXU(o.bc$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-slide-toggle"]],viewQuery:function(n,r){if(1&n&&o.GBs(xde,5),2&n){let l;o.mGM(l=o.lsd())&&(r._switchElement=l.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(n,r){2&n&&(o.Mr5("id",r.id),o.BMQ("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),o.HbH(r.color?"mat-"+r.color:""),o.AVh("mat-mdc-slide-toggle-focused",r._focused)("mat-mdc-slide-toggle-checked",r.checked)("_mat-animation-noopable",r._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],required:[2,"required","required",o.L39],color:"color",disabled:[2,"disabled","disabled",o.L39],disableRipple:[2,"disableRipple","disableRipple",o.L39],tabIndex:[2,"tabIndex","tabIndex",e=>null==e?0:(0,o.Udg)(e)],checked:[2,"checked","checked",o.L39],hideIcon:[2,"hideIcon","hideIcon",o.L39]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],standalone:!0,features:[o.Jv_([Tde,{provide:vl,useExisting:i,multi:!0}]),o.GFd,o.OA$,o.aNF],ngContentSelectors:wde,decls:13,vars:24,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(n,r){if(1&n){const l=o.RV6();o.NAR(),o.j41(0,"div",1)(1,"button",2,0),o.bIt("click",function(){return o.eBV(l),o.Njj(r._handleClick())}),o.nrm(3,"div",3),o.j41(4,"div",4)(5,"div",5)(6,"div",6),o.nrm(7,"div",7),o.k0s(),o.j41(8,"div",8),o.nrm(9,"div",9),o.k0s(),o.DNE(10,Cde,5,0,"div",10),o.k0s()()(),o.j41(11,"label",11),o.bIt("click",function(C){return o.eBV(l),o.Njj(C.stopPropagation())}),o.SdG(12),o.k0s()()}if(2&n){const l=o.sdS(2);o.Y8G("labelPosition",r.labelPosition),o.R7$(),o.AVh("mdc-switch--selected",r.checked)("mdc-switch--unselected",!r.checked)("mdc-switch--checked",r.checked)("mdc-switch--disabled",r.disabled),o.Y8G("tabIndex",r.disabled?-1:r.tabIndex)("disabled",r.disabled),o.BMQ("id",r.buttonId)("name",r.name)("aria-label",r.ariaLabel)("aria-labelledby",r._getAriaLabelledBy())("aria-describedby",r.ariaDescribedby)("aria-required",r.required||null)("aria-checked",r.checked),o.R7$(8),o.Y8G("matRippleTrigger",l)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),o.R7$(),o.vxM(r.hideIcon?-1:10),o.R7$(),o.Y8G("for",r.buttonId),o.BMQ("id",r._labelId)}},dependencies:[dl,sb],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:var(--mdc-elevation-overlay-color)}.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative}.mdc-switch[hidden]{display:none}.mdc-switch:disabled{cursor:default;pointer-events:none}.mdc-switch__track{overflow:hidden;position:relative;width:100%}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%}@media screen and (forced-colors: active){.mdc-switch__track::before,.mdc-switch__track::after{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(-100%)}[dir=rtl] .mdc-switch__track::after,.mdc-switch__track[dir=rtl]::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track[dir=rtl]::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::after{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0)}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0)}[dir=rtl] .mdc-switch__handle-track,.mdc-switch__handle-track[dir=rtl]{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track,.mdc-switch--selected .mdc-switch__handle-track[dir=rtl]{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto}[dir=rtl] .mdc-switch__handle,.mdc-switch__handle[dir=rtl]{left:auto;right:0}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media screen and (forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-elevation-overlay{bottom:0;left:0;right:0;top:0}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1}.mdc-switch:disabled .mdc-switch__ripple{display:none}.mdc-switch__icons{height:100%;position:relative;width:100%;z-index:1}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle .mat-internal-form-field{color:var(--mat-switch-label-text-color);font-family:var(--mat-switch-label-text-font);line-height:var(--mat-switch-label-text-line-height);font-size:var(--mat-switch-label-text-size);letter-spacing:var(--mat-switch-label-text-tracking);font-weight:var(--mat-switch-label-text-weight)}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}.mdc-switch{width:var(--mdc-switch-track-width)}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color)}.mdc-switch.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color)}.mdc-switch .mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation)}.mdc-switch .mdc-switch__focus-ring-wrapper,.mdc-switch .mdc-switch__handle{height:var(--mdc-switch-handle-height)}.mdc-switch .mdc-switch__handle{border-radius:var(--mdc-switch-handle-shape)}.mdc-switch .mdc-switch__handle{width:var(--mdc-switch-handle-width)}.mdc-switch .mdc-switch__handle-track{width:calc(100% - var(--mdc-switch-handle-width))}.mdc-switch.mdc-switch--selected:enabled .mdc-switch__icon{fill:var(--mdc-switch-selected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color)}.mdc-switch.mdc-switch--unselected:enabled .mdc-switch__icon{fill:var(--mdc-switch-unselected-icon-color)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color)}.mdc-switch.mdc-switch--selected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity)}.mdc-switch.mdc-switch--unselected:disabled .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity)}.mdc-switch.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size);height:var(--mdc-switch-selected-icon-size)}.mdc-switch.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size);height:var(--mdc-switch-unselected-icon-size)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-hover-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-focus-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-selected-pressed-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-hover-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-focus-state-layer-color)}.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background-color:var(--mdc-switch-unselected-pressed-state-layer-color)}.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-selected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--selected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-selected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--selected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--selected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-selected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus):hover .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:hover:not(:focus).mdc-ripple-surface--hover .mdc-switch__ripple::before{opacity:var(--mdc-switch-unselected-hover-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:focus.mdc-ripple-upgraded--background-focused .mdc-switch__ripple::before,.mdc-switch.mdc-switch--unselected:enabled:focus:not(.mdc-ripple-upgraded):focus .mdc-switch__ripple::before{transition-duration:75ms;opacity:var(--mdc-switch-unselected-focus-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded) .mdc-switch__ripple::after{transition:opacity 150ms linear}.mdc-switch.mdc-switch--unselected:enabled:active:not(.mdc-ripple-upgraded):active .mdc-switch__ripple::after{transition-duration:75ms;opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch.mdc-switch--unselected:enabled:active.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity)}.mdc-switch .mdc-switch__ripple{height:var(--mdc-switch-state-layer-size);width:var(--mdc-switch-state-layer-size)}.mdc-switch .mdc-switch__track{height:var(--mdc-switch-track-height)}.mdc-switch:disabled .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity)}.mdc-switch:enabled .mdc-switch__track::after{background:var(--mdc-switch-selected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color)}.mdc-switch:enabled .mdc-switch__track::before{background:var(--mdc-switch-unselected-track-color)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color)}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color)}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color)}.mdc-switch:disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color)}.mdc-switch .mdc-switch__track{border-radius:var(--mdc-switch-track-shape)}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mdc-switch:disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mat-mdc-slide-toggle{display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle .mdc-switch__ripple::after{content:"";opacity:0}.mat-mdc-slide-toggle .mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:opacity 75ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-mdc-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-elevation-overlay,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mdc-switch__handle{transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity);transition:var(--mat-switch-visible-track-transition)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity);transition:var(--mat-switch-hidden-track-transition)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size);height:var(--mat-switch-unselected-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size);height:var(--mat-switch-selected-handle-size)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size);height:var(--mat-switch-with-icon-handle-size)}.mat-mdc-slide-toggle:active .mdc-switch:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size);height:var(--mat-switch-pressed-handle-size)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{margin:var(--mat-switch-selected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{margin:var(--mat-switch-unselected-handle-horizontal-margin)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--selected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin)}.mat-mdc-slide-toggle:active .mdc-switch--unselected:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin)}.mdc-switch__track::after,.mdc-switch__track::before{border-width:var(--mat-switch-track-outline-width);border-color:var(--mat-switch-track-outline-color)}.mdc-switch--selected .mdc-switch__track::after,.mdc-switch--selected .mdc-switch__track::before{border-width:var(--mat-switch-selected-track-outline-width);border-color:var(--mat-switch-selected-track-outline-color)}.mdc-switch--disabled .mdc-switch__track::after,.mdc-switch--disabled .mdc-switch__track::before{border-width:var(--mat-switch-disabled-unselected-track-outline-width);border-color:var(--mat-switch-disabled-unselected-track-outline-color)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity)}'],encapsulation:2,changeDetection:0})}}return i})(),Dde=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[l7,qn,qn]})}}return i})();const Ide=["knob"],Rde=["valueIndicatorContainer"];function Pde(i,t){if(1&i&&(o.j41(0,"div",2,1)(2,"div",5)(3,"span",6),o.EFF(4),o.k0s()()()),2&i){const e=o.XpG();o.R7$(4),o.JRh(e.valueIndicatorText)}}const Ode=["trackActive"],Lde=["*"];function Fde(i,t){if(1&i&&o.nrm(0,"div"),2&i){const e=t.$implicit,n=t.$index,r=o.XpG(3);o.HbH(0===e?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive"),o.xc7("transform",r._calcTickMarkTransform(n))}}function Nde(i,t){if(1&i&&o.Z7z(0,Fde,1,4,"div",8,o.Vm6),2&i){const e=o.XpG(2);o.Dyx(e._tickMarks)}}function Bde(i,t){if(1&i&&(o.j41(0,"div",6,1),o.DNE(2,Nde,2,0),o.k0s()),2&i){const e=o.XpG();o.R7$(2),o.vxM(e._cachedWidth?2:-1)}}function Vde(i,t){if(1&i&&o.nrm(0,"mat-slider-visual-thumb",7),2&i){const e=o.XpG();o.Y8G("discrete",e.discrete)("thumbPosition",1)("valueIndicatorText",e.startValueIndicatorText)}}var Zr=function(i){return i[i.START=1]="START",i[i.END=2]="END",i}(Zr||{}),LS=function(i){return i[i.ACTIVE=0]="ACTIVE",i[i.INACTIVE=1]="INACTIVE",i}(LS||{});const WO=new o.nKC("_MatSlider"),c7=new o.nKC("_MatSliderThumb"),d7=new o.nKC("_MatSliderRangeThumb"),u7=new o.nKC("_MatSliderVisualThumb");let zde=(()=>{class i{constructor(e,n,r,l){this._cdr=e,this._ngZone=n,this._slider=l,this._isHovered=!1,this._isActive=!1,this._isValueIndicatorVisible=!1,this._platform=(0,o.WQX)(wo),this._onPointerMove=m=>{if(this._sliderInput._isFocused)return;const C=this._hostElement.getBoundingClientRect(),A=this._slider._isCursorOnSliderThumb(m,C);this._isHovered=A,A?this._showHoverRipple():this._hideRipple(this._hoverRippleRef)},this._onMouseLeave=()=>{this._isHovered=!1,this._hideRipple(this._hoverRippleRef)},this._onFocus=()=>{this._hideRipple(this._hoverRippleRef),this._showFocusRipple(),this._hostElement.classList.add("mdc-slider__thumb--focused")},this._onBlur=()=>{this._isActive||this._hideRipple(this._focusRippleRef),this._isHovered&&this._showHoverRipple(),this._hostElement.classList.remove("mdc-slider__thumb--focused")},this._onDragStart=m=>{0===m.button&&(this._isActive=!0,this._showActiveRipple())},this._onDragEnd=()=>{this._isActive=!1,this._hideRipple(this._activeRippleRef),this._sliderInput._isFocused||this._hideRipple(this._focusRippleRef),this._platform.SAFARI&&this._showHoverRipple()},this._hostElement=r.nativeElement}ngAfterViewInit(){this._ripple.radius=24,this._sliderInput=this._slider._getInput(this.thumbPosition),this._sliderInputEl=this._sliderInput._hostElement;const e=this._sliderInputEl;this._ngZone.runOutsideAngular(()=>{e.addEventListener("pointermove",this._onPointerMove),e.addEventListener("pointerdown",this._onDragStart),e.addEventListener("pointerup",this._onDragEnd),e.addEventListener("pointerleave",this._onMouseLeave),e.addEventListener("focus",this._onFocus),e.addEventListener("blur",this._onBlur)})}ngOnDestroy(){const e=this._sliderInputEl;e&&(e.removeEventListener("pointermove",this._onPointerMove),e.removeEventListener("pointerdown",this._onDragStart),e.removeEventListener("pointerup",this._onDragEnd),e.removeEventListener("pointerleave",this._onMouseLeave),e.removeEventListener("focus",this._onFocus),e.removeEventListener("blur",this._onBlur))}_showHoverRipple(){this._isShowingRipple(this._hoverRippleRef)||(this._hoverRippleRef=this._showRipple({enterDuration:0,exitDuration:0}),this._hoverRippleRef?.element.classList.add("mat-mdc-slider-hover-ripple"))}_showFocusRipple(){this._isShowingRipple(this._focusRippleRef)||(this._focusRippleRef=this._showRipple({enterDuration:0,exitDuration:0},!0),this._focusRippleRef?.element.classList.add("mat-mdc-slider-focus-ripple"))}_showActiveRipple(){this._isShowingRipple(this._activeRippleRef)||(this._activeRippleRef=this._showRipple({enterDuration:225,exitDuration:400}),this._activeRippleRef?.element.classList.add("mat-mdc-slider-active-ripple"))}_isShowingRipple(e){return e?.state===cl.FADING_IN||e?.state===cl.VISIBLE}_showRipple(e,n){if(!this._slider.disabled&&(this._showValueIndicator(),this._slider._isRange&&this._slider._getThumb(this.thumbPosition===Zr.START?Zr.END:Zr.START)._showValueIndicator(),!this._slider._globalRippleOptions?.disabled||n))return this._ripple.launch({animation:this._slider._noopAnimations?{enterDuration:0,exitDuration:0}:e,centered:!0,persistent:!0})}_hideRipple(e){if(e?.fadeOut(),this._isShowingAnyRipple())return;this._slider._isRange||this._hideValueIndicator();const n=this._getSibling();n._isShowingAnyRipple()||(this._hideValueIndicator(),n._hideValueIndicator())}_showValueIndicator(){this._hostElement.classList.add("mdc-slider__thumb--with-indicator")}_hideValueIndicator(){this._hostElement.classList.remove("mdc-slider__thumb--with-indicator")}_getSibling(){return this._slider._getThumb(this.thumbPosition===Zr.START?Zr.END:Zr.START)}_getValueIndicatorContainer(){return this._valueIndicatorContainer?.nativeElement}_getKnob(){return this._knob.nativeElement}_isShowingAnyRipple(){return this._isShowingRipple(this._hoverRippleRef)||this._isShowingRipple(this._focusRippleRef)||this._isShowingRipple(this._activeRippleRef)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.rXU(o.SKi),o.rXU(o.aKT),o.rXU(WO))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-slider-visual-thumb"]],viewQuery:function(n,r){if(1&n&&(o.GBs(dl,5),o.GBs(Ide,5),o.GBs(Rde,5)),2&n){let l;o.mGM(l=o.lsd())&&(r._ripple=l.first),o.mGM(l=o.lsd())&&(r._knob=l.first),o.mGM(l=o.lsd())&&(r._valueIndicatorContainer=l.first)}},hostAttrs:[1,"mdc-slider__thumb","mat-mdc-slider-visual-thumb"],inputs:{discrete:"discrete",thumbPosition:"thumbPosition",valueIndicatorText:"valueIndicatorText"},standalone:!0,features:[o.Jv_([{provide:u7,useExisting:i}]),o.aNF],decls:4,vars:2,consts:[["knob",""],["valueIndicatorContainer",""],[1,"mdc-slider__value-indicator-container"],[1,"mdc-slider__thumb-knob"],["matRipple","",1,"mat-mdc-focus-indicator",3,"matRippleDisabled"],[1,"mdc-slider__value-indicator"],[1,"mdc-slider__value-indicator-text"]],template:function(n,r){1&n&&(o.DNE(0,Pde,5,1,"div",2),o.nrm(1,"div",3,0)(3,"div",4)),2&n&&(o.vxM(r.discrete?0:-1),o.R7$(3),o.Y8G("matRippleDisabled",!0))},dependencies:[dl],styles:[".mat-mdc-slider-visual-thumb .mat-ripple{height:100%;width:100%}.mat-mdc-slider .mdc-slider__tick-marks{justify-content:start}.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-marks .mdc-slider__tick-mark--inactive{position:absolute;left:2px}"],encapsulation:2,changeDetection:0})}}return i})(),Ude=(()=>{class i{get disabled(){return this._disabled}set disabled(e){this._disabled=e;const n=this._getInput(Zr.END),r=this._getInput(Zr.START);n&&(n.disabled=this._disabled),r&&(r.disabled=this._disabled)}get discrete(){return this._discrete}set discrete(e){this._discrete=e,this._updateValueIndicatorUIs()}get min(){return this._min}set min(e){const n=isNaN(e)?this._min:e;this._min!==n&&this._updateMin(n)}_updateMin(e){const n=this._min;this._min=e,this._isRange?this._updateMinRange({old:n,new:e}):this._updateMinNonRange(e),this._onMinMaxOrStepChange()}_updateMinRange(e){const n=this._getInput(Zr.END),r=this._getInput(Zr.START),l=n.value,m=r.value;r.min=e.new,n.min=Math.max(e.new,r.value),r.max=Math.min(n.max,n.value),r._updateWidthInactive(),n._updateWidthInactive(),e.new<e.old?this._onTranslateXChangeBySideEffect(n,r):this._onTranslateXChangeBySideEffect(r,n),l!==n.value&&this._onValueChange(n),m!==r.value&&this._onValueChange(r)}_updateMinNonRange(e){const n=this._getInput(Zr.END);if(n){const r=n.value;n.min=e,n._updateThumbUIByValue(),this._updateTrackUI(n),r!==n.value&&this._onValueChange(n)}}get max(){return this._max}set max(e){const n=isNaN(e)?this._max:e;this._max!==n&&this._updateMax(n)}_updateMax(e){const n=this._max;this._max=e,this._isRange?this._updateMaxRange({old:n,new:e}):this._updateMaxNonRange(e),this._onMinMaxOrStepChange()}_updateMaxRange(e){const n=this._getInput(Zr.END),r=this._getInput(Zr.START),l=n.value,m=r.value;n.max=e.new,r.max=Math.min(e.new,n.value),n.min=r.value,n._updateWidthInactive(),r._updateWidthInactive(),e.new>e.old?this._onTranslateXChangeBySideEffect(r,n):this._onTranslateXChangeBySideEffect(n,r),l!==n.value&&this._onValueChange(n),m!==r.value&&this._onValueChange(r)}_updateMaxNonRange(e){const n=this._getInput(Zr.END);if(n){const r=n.value;n.max=e,n._updateThumbUIByValue(),this._updateTrackUI(n),r!==n.value&&this._onValueChange(n)}}get step(){return this._step}set step(e){const n=isNaN(e)?this._step:e;this._step!==n&&this._updateStep(n)}_updateStep(e){this._step=e,this._isRange?this._updateStepRange():this._updateStepNonRange(),this._onMinMaxOrStepChange()}_updateStepRange(){const e=this._getInput(Zr.END),n=this._getInput(Zr.START),r=e.value,l=n.value,m=n.value;e.min=this._min,n.max=this._max,e.step=this._step,n.step=this._step,this._platform.SAFARI&&(e.value=e.value,n.value=n.value),e.min=Math.max(this._min,n.value),n.max=Math.min(this._max,e.value),n._updateWidthInactive(),e._updateWidthInactive(),e.value<m?this._onTranslateXChangeBySideEffect(n,e):this._onTranslateXChangeBySideEffect(e,n),r!==e.value&&this._onValueChange(e),l!==n.value&&this._onValueChange(n)}_updateStepNonRange(){const e=this._getInput(Zr.END);if(e){const n=e.value;e.step=this._step,this._platform.SAFARI&&(e.value=e.value),e._updateThumbUIByValue(),n!==e.value&&this._onValueChange(e)}}constructor(e,n,r,l,m,C){this._ngZone=e,this._cdr=n,this._elementRef=r,this._dir=l,this._globalRippleOptions=m,this._disabled=!1,this._discrete=!1,this.showTickMarks=!1,this._min=0,this.disableRipple=!1,this._max=100,this._step=1,this.displayWith=A=>`${A}`,this._rippleRadius=24,this.startValueIndicatorText="",this.endValueIndicatorText="",this._isRange=!1,this._isRtl=!1,this._hasViewInitialized=!1,this._tickMarkTrackWidth=0,this._hasAnimation=!1,this._resizeTimer=null,this._platform=(0,o.WQX)(wo),this._knobRadius=8,this._thumbsOverlap=!1,this._noopAnimations="NoopAnimations"===C,this._dirChangeSubscription=this._dir.change.subscribe(()=>this._onDirChange()),this._isRtl="rtl"===this._dir.value}ngAfterViewInit(){this._platform.isBrowser&&this._updateDimensions();const e=this._getInput(Zr.END),n=this._getInput(Zr.START);this._isRange=!!e&&!!n,this._cdr.detectChanges();const r=this._getThumb(Zr.END);this._rippleRadius=r._ripple.radius,this._inputPadding=this._rippleRadius-this._knobRadius,this._isRange?this._initUIRange(e,n):this._initUINonRange(e),this._updateTrackUI(e),this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._observeHostResize(),this._cdr.detectChanges()}_initUINonRange(e){e.initProps(),e.initUI(),this._updateValueIndicatorUI(e),this._hasViewInitialized=!0,e._updateThumbUIByValue()}_initUIRange(e,n){e.initProps(),e.initUI(),n.initProps(),n.initUI(),e._updateMinMax(),n._updateMinMax(),e._updateStaticStyles(),n._updateStaticStyles(),this._updateValueIndicatorUIs(),this._hasViewInitialized=!0,e._updateThumbUIByValue(),n._updateThumbUIByValue()}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._resizeObserver?.disconnect(),this._resizeObserver=null}_onDirChange(){this._isRtl="rtl"===this._dir.value,this._isRange?this._onDirChangeRange():this._onDirChangeNonRange(),this._updateTickMarkUI()}_onDirChangeRange(){const e=this._getInput(Zr.END),n=this._getInput(Zr.START);e._setIsLeftThumb(),n._setIsLeftThumb(),e.translateX=e._calcTranslateXByValue(),n.translateX=n._calcTranslateXByValue(),e._updateStaticStyles(),n._updateStaticStyles(),e._updateWidthInactive(),n._updateWidthInactive(),e._updateThumbUIByValue(),n._updateThumbUIByValue()}_onDirChangeNonRange(){this._getInput(Zr.END)._updateThumbUIByValue()}_observeHostResize(){typeof ResizeObserver>"u"||!ResizeObserver||this._ngZone.runOutsideAngular(()=>{this._resizeObserver=new ResizeObserver(()=>{this._isActive()||(this._resizeTimer&&clearTimeout(this._resizeTimer),this._onResize())}),this._resizeObserver.observe(this._elementRef.nativeElement)})}_isActive(){return this._getThumb(Zr.START)._isActive||this._getThumb(Zr.END)._isActive}_getValue(e=Zr.END){const n=this._getInput(e);return n?n.value:this.min}_skipUpdate(){return!(!this._getInput(Zr.START)?._skipUIUpdate&&!this._getInput(Zr.END)?._skipUIUpdate)}_updateDimensions(){this._cachedWidth=this._elementRef.nativeElement.offsetWidth,this._cachedLeft=this._elementRef.nativeElement.getBoundingClientRect().left}_setTrackActiveStyles(e){const n=this._trackActive.nativeElement.style;n.left=e.left,n.right=e.right,n.transformOrigin=e.transformOrigin,n.transform=e.transform}_calcTickMarkTransform(e){return`translateX(${e*(this._tickMarkTrackWidth/(this._tickMarks.length-1))}px`}_onTranslateXChange(e){this._hasViewInitialized&&(this._updateThumbUI(e),this._updateTrackUI(e),this._updateOverlappingThumbUI(e))}_onTranslateXChangeBySideEffect(e,n){this._hasViewInitialized&&(e._updateThumbUIByValue(),n._updateThumbUIByValue())}_onValueChange(e){this._hasViewInitialized&&(this._updateValueIndicatorUI(e),this._updateTickMarkUI(),this._cdr.detectChanges())}_onMinMaxOrStepChange(){this._hasViewInitialized&&(this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.markForCheck())}_onResize(){if(this._hasViewInitialized){if(this._updateDimensions(),this._isRange){const e=this._getInput(Zr.END),n=this._getInput(Zr.START);e._updateThumbUIByValue(),n._updateThumbUIByValue(),e._updateStaticStyles(),n._updateStaticStyles(),e._updateMinMax(),n._updateMinMax(),e._updateWidthInactive(),n._updateWidthInactive()}else{const e=this._getInput(Zr.END);e&&e._updateThumbUIByValue()}this._updateTickMarkUI(),this._updateTickMarkTrackUI(),this._cdr.detectChanges()}}_areThumbsOverlapping(){const e=this._getInput(Zr.START),n=this._getInput(Zr.END);return!(!e||!n)&&n.translateX-e.translateX<20}_updateOverlappingThumbClassNames(e){const n=e.getSibling(),r=this._getThumb(e.thumbPosition);this._getThumb(n.thumbPosition)._hostElement.classList.remove("mdc-slider__thumb--top"),r._hostElement.classList.toggle("mdc-slider__thumb--top",this._thumbsOverlap)}_updateOverlappingThumbUI(e){!this._isRange||this._skipUpdate()||this._thumbsOverlap!==this._areThumbsOverlapping()&&(this._thumbsOverlap=!this._thumbsOverlap,this._updateOverlappingThumbClassNames(e))}_updateThumbUI(e){this._skipUpdate()||(this._getThumb(e.thumbPosition===Zr.END?Zr.END:Zr.START)._hostElement.style.transform=`translateX(${e.translateX}px)`)}_updateValueIndicatorUI(e){if(this._skipUpdate())return;const n=this.displayWith(e.value);if(this._hasViewInitialized?e._valuetext.set(n):e._hostElement.setAttribute("aria-valuetext",n),this.discrete){e.thumbPosition===Zr.START?this.startValueIndicatorText=n:this.endValueIndicatorText=n;const r=this._getThumb(e.thumbPosition);n.length<3?r._hostElement.classList.add("mdc-slider__thumb--short-value"):r._hostElement.classList.remove("mdc-slider__thumb--short-value")}}_updateValueIndicatorUIs(){const e=this._getInput(Zr.END),n=this._getInput(Zr.START);e&&this._updateValueIndicatorUI(e),n&&this._updateValueIndicatorUI(n)}_updateTickMarkTrackUI(){if(!this.showTickMarks||this._skipUpdate())return;const e=this._step&&this._step>0?this._step:1,r=(Math.floor(this.max/e)*e-this.min)/(this.max-this.min);this._tickMarkTrackWidth=this._cachedWidth*r-6}_updateTrackUI(e){this._skipUpdate()||(this._isRange?this._updateTrackUIRange(e):this._updateTrackUINonRange(e))}_updateTrackUIRange(e){const n=e.getSibling();if(!n||!this._cachedWidth)return;const r=Math.abs(n.translateX-e.translateX)/this._cachedWidth;this._setTrackActiveStyles(e._isLeftThumb&&this._cachedWidth?{left:"auto",right:this._cachedWidth-n.translateX+"px",transformOrigin:"right",transform:`scaleX(${r})`}:{left:`${n.translateX}px`,right:"auto",transformOrigin:"left",transform:`scaleX(${r})`})}_updateTrackUINonRange(e){this._setTrackActiveStyles(this._isRtl?{left:"auto",right:"0px",transformOrigin:"right",transform:`scaleX(${1-e.fillPercentage})`}:{left:"0px",right:"auto",transformOrigin:"left",transform:`scaleX(${e.fillPercentage})`})}_updateTickMarkUI(){if(!this.showTickMarks||void 0===this.step||void 0===this.min||void 0===this.max)return;const e=this.step>0?this.step:1;this._isRange?this._updateTickMarkUIRange(e):this._updateTickMarkUINonRange(e),this._isRtl&&this._tickMarks.reverse()}_updateTickMarkUINonRange(e){const n=this._getValue();let r=Math.max(Math.round((n-this.min)/e),0),l=Math.max(Math.round((this.max-n)/e),0);this._isRtl?r++:l++,this._tickMarks=Array(r).fill(LS.ACTIVE).concat(Array(l).fill(LS.INACTIVE))}_updateTickMarkUIRange(e){const n=this._getValue(),r=this._getValue(Zr.START),l=Math.max(Math.round((r-this.min)/e),0),m=Math.max(Math.round((n-r)/e)+1,0),C=Math.max(Math.round((this.max-n)/e),0);this._tickMarks=Array(l).fill(LS.INACTIVE).concat(Array(m).fill(LS.ACTIVE),Array(C).fill(LS.INACTIVE))}_getInput(e){return e===Zr.END&&this._input?this._input:this._inputs?.length?e===Zr.START?this._inputs.first:this._inputs.last:void 0}_getThumb(e){return e===Zr.END?this._thumbs?.last:this._thumbs?.first}_setTransition(e){this._hasAnimation=!this._platform.IOS&&e&&!this._noopAnimations,this._elementRef.nativeElement.classList.toggle("mat-mdc-slider-with-animation",this._hasAnimation)}_isCursorOnSliderThumb(e,n){const r=n.width/2,A=e.clientY-(n.y+r);return Math.pow(e.clientX-(n.x+r),2)+Math.pow(A,2)<Math.pow(r,2)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.SKi),o.rXU(o.gRc),o.rXU(o.aKT),o.rXU(Us,8),o.rXU(zp,8),o.rXU(o.bc$,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-slider"]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,c7,5),o.wni(l,d7,4)),2&n){let m;o.mGM(m=o.lsd())&&(r._input=m.first),o.mGM(m=o.lsd())&&(r._inputs=m)}},viewQuery:function(n,r){if(1&n&&(o.GBs(Ode,5),o.GBs(u7,5)),2&n){let l;o.mGM(l=o.lsd())&&(r._trackActive=l.first),o.mGM(l=o.lsd())&&(r._thumbs=l)}},hostAttrs:[1,"mat-mdc-slider","mdc-slider"],hostVars:12,hostBindings:function(n,r){2&n&&(o.HbH("mat-"+(r.color||"primary")),o.AVh("mdc-slider--range",r._isRange)("mdc-slider--disabled",r.disabled)("mdc-slider--discrete",r.discrete)("mdc-slider--tick-marks",r.showTickMarks)("_mat-animation-noopable",r._noopAnimations))},inputs:{disabled:[2,"disabled","disabled",o.L39],discrete:[2,"discrete","discrete",o.L39],showTickMarks:[2,"showTickMarks","showTickMarks",o.L39],min:[2,"min","min",o.Udg],color:"color",disableRipple:[2,"disableRipple","disableRipple",o.L39],max:[2,"max","max",o.Udg],step:[2,"step","step",o.Udg],displayWith:"displayWith"},exportAs:["matSlider"],standalone:!0,features:[o.Jv_([{provide:WO,useExisting:i}]),o.GFd,o.aNF],ngContentSelectors:Lde,decls:9,vars:5,consts:[["trackActive",""],["tickMarkContainer",""],[1,"mdc-slider__track"],[1,"mdc-slider__track--inactive"],[1,"mdc-slider__track--active"],[1,"mdc-slider__track--active_fill"],[1,"mdc-slider__tick-marks"],[3,"discrete","thumbPosition","valueIndicatorText"],[3,"class","transform"]],template:function(n,r){1&n&&(o.NAR(),o.SdG(0),o.j41(1,"div",2),o.nrm(2,"div",3),o.j41(3,"div",4),o.nrm(4,"div",5,0),o.k0s(),o.DNE(6,Bde,3,1,"div",6),o.k0s(),o.DNE(7,Vde,1,3,"mat-slider-visual-thumb",7),o.nrm(8,"mat-slider-visual-thumb",7)),2&n&&(o.R7$(6),o.vxM(r.showTickMarks?6:-1),o.R7$(),o.vxM(r._isRange?7:-1),o.R7$(),o.Y8G("discrete",r.discrete)("thumbPosition",2)("valueIndicatorText",r.endValueIndicatorText))},dependencies:[zde],styles:['.mdc-slider{cursor:pointer;height:48px;margin:0 24px;position:relative;touch-action:pan-y}.mdc-slider .mdc-slider__track{position:absolute;top:50%;transform:translateY(-50%);width:100%}.mdc-slider .mdc-slider__track--active,.mdc-slider .mdc-slider__track--inactive{display:flex;height:100%;position:absolute;width:100%}.mdc-slider .mdc-slider__track--active{overflow:hidden}.mdc-slider .mdc-slider__track--active_fill{border-top-style:solid;box-sizing:border-box;height:100%;width:100%;position:relative;-webkit-transform-origin:left;transform-origin:left}[dir=rtl] .mdc-slider .mdc-slider__track--active_fill,.mdc-slider .mdc-slider__track--active_fill[dir=rtl]{-webkit-transform-origin:right;transform-origin:right}.mdc-slider .mdc-slider__track--inactive{left:0;top:0}.mdc-slider .mdc-slider__track--inactive::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__track--inactive::before{border-color:CanvasText}}.mdc-slider .mdc-slider__value-indicator-container{bottom:44px;left:50%;left:var(--slider-value-indicator-container-left, 50%);pointer-events:none;position:absolute;right:var(--slider-value-indicator-container-right);transform:translateX(-50%);transform:var(--slider-value-indicator-container-transform, translateX(-50%))}.mdc-slider .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0.4, 0, 1, 1);align-items:center;border-radius:4px;display:flex;height:32px;padding:0 12px;transform:scale(0);transform-origin:bottom}.mdc-slider .mdc-slider__value-indicator::before{border-left:6px solid rgba(0,0,0,0);border-right:6px solid rgba(0,0,0,0);border-top:6px solid;bottom:-5px;content:"";height:0;left:50%;left:var(--slider-value-indicator-caret-left, 50%);position:absolute;right:var(--slider-value-indicator-caret-right);transform:translateX(-50%);transform:var(--slider-value-indicator-caret-transform, translateX(-50%));width:0}.mdc-slider .mdc-slider__value-indicator::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-slider .mdc-slider__value-indicator::after{border-color:CanvasText}}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator-container{pointer-events:auto}.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:transform 100ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale(1)}@media(prefers-reduced-motion){.mdc-slider .mdc-slider__value-indicator,.mdc-slider .mdc-slider__thumb--with-indicator .mdc-slider__value-indicator{transition:none}}.mdc-slider .mdc-slider__thumb{display:flex;left:-24px;outline:none;position:absolute;user-select:none;height:48px;width:48px}.mdc-slider .mdc-slider__thumb--top{z-index:1}.mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-style:solid;border-width:1px;box-sizing:content-box}.mdc-slider .mdc-slider__thumb-knob{box-sizing:border-box;left:50%;position:absolute;top:50%;transform:translate(-50%, -50%)}.mdc-slider .mdc-slider__tick-marks{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:space-between;padding:0 1px;position:absolute;width:100%}.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:transform 80ms ease}@media(prefers-reduced-motion){.mdc-slider--discrete .mdc-slider__thumb,.mdc-slider--discrete .mdc-slider__track--active_fill{transition:none}}.mdc-slider--disabled{cursor:auto}.mdc-slider--disabled .mdc-slider__thumb{pointer-events:none}.mdc-slider__input{cursor:pointer;left:2px;margin:0;height:44px;opacity:0;pointer-events:none;position:absolute;top:2px;width:44px}.mat-mdc-slider{display:inline-block;box-sizing:border-box;outline:none;vertical-align:middle;margin-left:8px;margin-right:8px;width:auto;min-width:112px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-slider .mdc-slider__thumb-knob{background-color:var(--mdc-slider-handle-color);border-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb-knob{background-color:var(--mdc-slider-disabled-handle-color);border-color:var(--mdc-slider-disabled-handle-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider.mdc-slider--disabled .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb::before,.mat-mdc-slider .mdc-slider__thumb::after{background-color:var(--mdc-slider-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover::before,.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-surface--hover::before{opacity:var(--mdc-ripple-hover-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded--background-focused::before,.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:var(--mdc-ripple-focus-opacity)}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mat-mdc-slider .mdc-slider__thumb:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__thumb.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity)}.mat-mdc-slider .mdc-slider__track--active_fill{border-color:var(--mdc-slider-active-track-color)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--active_fill{border-color:var(--mdc-slider-disabled-active-track-color)}.mat-mdc-slider .mdc-slider__track--inactive{background-color:var(--mdc-slider-inactive-track-color);opacity:.24}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__track--inactive{background-color:var(--mdc-slider-disabled-inactive-track-color);opacity:.24}.mat-mdc-slider .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--active{background-color:var(--mdc-slider-with-tick-marks-active-container-color);opacity:var(--mdc-slider-with-tick-marks-active-container-opacity)}.mat-mdc-slider .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-inactive-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider.mdc-slider--disabled .mdc-slider__tick-mark--inactive{background-color:var(--mdc-slider-with-tick-marks-disabled-container-color);opacity:var(--mdc-slider-with-tick-marks-inactive-container-opacity)}.mat-mdc-slider .mdc-slider__value-indicator{background-color:var(--mdc-slider-label-container-color);opacity:1}.mat-mdc-slider .mdc-slider__value-indicator::before{border-top-color:var(--mdc-slider-label-container-color)}.mat-mdc-slider .mdc-slider__value-indicator{color:var(--mdc-slider-label-label-text-color)}.mat-mdc-slider .mdc-slider__track{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__track--active{height:var(--mdc-slider-active-track-height);top:calc((var(--mdc-slider-inactive-track-height) - var(--mdc-slider-active-track-height)) / 2)}.mat-mdc-slider .mdc-slider__track--active_fill{border-top-width:var(--mdc-slider-active-track-height)}.mat-mdc-slider .mdc-slider__track--inactive{height:var(--mdc-slider-inactive-track-height)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{height:var(--mdc-slider-with-tick-marks-container-size);width:var(--mdc-slider-with-tick-marks-container-size)}.mat-mdc-slider.mdc-slider--disabled{opacity:0.38}.mat-mdc-slider .mdc-slider__value-indicator-text{letter-spacing:var(--mdc-slider-label-label-text-tracking);font-size:var(--mdc-slider-label-label-text-size);font-family:var(--mdc-slider-label-label-text-font);font-weight:var(--mdc-slider-label-label-text-weight);line-height:var(--mdc-slider-label-label-text-line-height)}.mat-mdc-slider .mdc-slider__track--active{border-radius:var(--mdc-slider-active-track-shape)}.mat-mdc-slider .mdc-slider__track--inactive{border-radius:var(--mdc-slider-inactive-track-shape)}.mat-mdc-slider .mdc-slider__thumb-knob{border-radius:var(--mdc-slider-handle-shape);width:var(--mdc-slider-handle-width);height:var(--mdc-slider-handle-height);border-style:solid;border-width:calc(var(--mdc-slider-handle-height) / 2) calc(var(--mdc-slider-handle-width) / 2)}.mat-mdc-slider .mdc-slider__tick-mark--active,.mat-mdc-slider .mdc-slider__tick-mark--inactive{border-radius:var(--mdc-slider-with-tick-marks-container-shape)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb-knob{background-color:var(--mdc-slider-hover-handle-color);border-color:var(--mdc-slider-hover-handle-color)}.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:hover .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb-knob{background-color:var(--mdc-slider-focus-handle-color);border-color:var(--mdc-slider-focus-handle-color)}.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--focused .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb:not(:disabled):active .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:#fff}.mat-mdc-slider .mdc-slider__thumb--top .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb:hover .mdc-slider__thumb-knob,.mat-mdc-slider .mdc-slider__thumb--top.mdc-slider__thumb--focused .mdc-slider__thumb-knob{border-color:var(--mdc-slider-with-overlap-handle-outline-color);border-width:var(--mdc-slider-with-overlap-handle-outline-width)}.mat-mdc-slider .mdc-slider__thumb-knob{box-shadow:var(--mdc-slider-handle-elevation)}.mat-mdc-slider .mdc-slider__input{box-sizing:content-box;pointer-events:auto}.mat-mdc-slider .mdc-slider__input.mat-mdc-slider-input-no-pointer-events{pointer-events:none}.mat-mdc-slider .mdc-slider__input.mat-slider__right-input{left:auto;right:0}.mat-mdc-slider .mdc-slider__thumb,.mat-mdc-slider .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider.mdc-slider--discrete .mdc-slider__track--active_fill{transition-duration:0ms}.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__thumb,.mat-mdc-slider.mat-mdc-slider-with-animation .mdc-slider__track--active_fill{transition-duration:80ms}.mat-mdc-slider .mdc-slider__track,.mat-mdc-slider .mdc-slider__thumb{pointer-events:none}.mat-mdc-slider .mdc-slider__value-indicator-container{transform:var(--mat-slider-value-indicator-container-transform)}.mat-mdc-slider .mdc-slider__value-indicator{width:var(--mat-slider-value-indicator-width);height:var(--mat-slider-value-indicator-height);padding:var(--mat-slider-value-indicator-padding);opacity:var(--mat-slider-value-indicator-opacity);border-radius:var(--mat-slider-value-indicator-border-radius)}.mat-mdc-slider .mdc-slider__value-indicator::before{display:var(--mat-slider-value-indicator-caret-display)}.mat-mdc-slider .mdc-slider__value-indicator-text{width:var(--mat-slider-value-indicator-width);transform:var(--mat-slider-value-indicator-text-transform)}.mat-mdc-slider .mat-ripple .mat-ripple-element{background-color:var(--mat-slider-ripple-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-hover-ripple{background-color:var(--mat-slider-hover-state-layer-color)}.mat-mdc-slider .mat-ripple .mat-mdc-slider-focus-ripple,.mat-mdc-slider .mat-ripple .mat-mdc-slider-active-ripple{background-color:var(--mat-slider-focus-state-layer-color)}.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__thumb,.mat-mdc-slider._mat-animation-noopable.mdc-slider--discrete .mdc-slider__track--active_fill,.mat-mdc-slider._mat-animation-noopable .mdc-slider__value-indicator{transition:none}.mat-mdc-slider .mat-mdc-focus-indicator::before{border-radius:50%}.mat-mdc-slider .mdc-slider__value-indicator{word-break:normal}.mat-mdc-slider .mdc-slider__value-indicator-text{text-align:center}.mdc-slider__thumb--focused .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}}return i})();const Gde={provide:Ya,useExisting:(0,o.Rfq)(()=>kz),multi:!0};let kz=(()=>{class i{get value(){return(0,o.Udg)(this._hostElement.value,0)}set value(e){const n=(e=isNaN(e)?0:e)+"";this._hasSetInitialValue?this._isActive||this._setValue(n):this._initialValue=n}_setValue(e){this._hostElement.value=e,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges(),this._slider._cdr.markForCheck()}get translateX(){return this._slider.min>=this._slider.max?(this._translateX=this._tickMarkOffset,this._translateX):(void 0===this._translateX&&(this._translateX=this._calcTranslateXByValue()),this._translateX)}set translateX(e){this._translateX=e}get min(){return(0,o.Udg)(this._hostElement.min,0)}set min(e){this._hostElement.min=e+"",this._cdr.detectChanges()}get max(){return(0,o.Udg)(this._hostElement.max,0)}set max(e){this._hostElement.max=e+"",this._cdr.detectChanges()}get step(){return(0,o.Udg)(this._hostElement.step,0)}set step(e){this._hostElement.step=e+"",this._cdr.detectChanges()}get disabled(){return(0,o.L39)(this._hostElement.disabled)}set disabled(e){this._hostElement.disabled=e,this._cdr.detectChanges(),this._slider.disabled!==this.disabled&&(this._slider.disabled=this.disabled)}get percentage(){return this._slider.min>=this._slider.max?this._slider._isRtl?1:0:(this.value-this._slider.min)/(this._slider.max-this._slider.min)}get fillPercentage(){return this._slider._cachedWidth?0===this._translateX?0:this.translateX/this._slider._cachedWidth:this._slider._isRtl?1:0}_setIsFocused(e){this._isFocused=e}constructor(e,n,r,l){this._ngZone=e,this._elementRef=n,this._cdr=r,this._slider=l,this.valueChange=new o.bkB,this.dragStart=new o.bkB,this.dragEnd=new o.bkB,this.thumbPosition=Zr.END,this._valuetext=(0,o.vPA)(""),this._knobRadius=8,this._tickMarkOffset=3,this._isActive=!1,this._isFocused=!1,this._hasSetInitialValue=!1,this._destroyed=new xi.B,this._skipUIUpdate=!1,this._onTouchedFn=()=>{},this._isControlInitialized=!1,this._platform=(0,o.WQX)(wo),this._hostElement=n.nativeElement,this._ngZone.runOutsideAngular(()=>{this._hostElement.addEventListener("pointerdown",this._onPointerDown.bind(this)),this._hostElement.addEventListener("pointermove",this._onPointerMove.bind(this)),this._hostElement.addEventListener("pointerup",this._onPointerUp.bind(this))})}ngOnDestroy(){this._hostElement.removeEventListener("pointerdown",this._onPointerDown),this._hostElement.removeEventListener("pointermove",this._onPointerMove),this._hostElement.removeEventListener("pointerup",this._onPointerUp),this._destroyed.next(),this._destroyed.complete(),this.dragStart.complete(),this.dragEnd.complete()}initProps(){this._updateWidthInactive(),this.disabled!==this._slider.disabled&&(this._slider.disabled=!0),this.step=this._slider.step,this.min=this._slider.min,this.max=this._slider.max,this._initValue()}initUI(){this._updateThumbUIByValue()}_initValue(){this._hasSetInitialValue=!0,void 0===this._initialValue?this.value=this._getDefaultValue():(this._hostElement.value=this._initialValue,this._updateThumbUIByValue(),this._slider._onValueChange(this),this._cdr.detectChanges())}_getDefaultValue(){return this.min}_onBlur(){this._setIsFocused(!1),this._onTouchedFn()}_onFocus(){this._slider._setTransition(!1),this._slider._updateTrackUI(this),this._setIsFocused(!0)}_onChange(){this.valueChange.emit(this.value),this._isActive&&this._updateThumbUIByValue({withAnimation:!0})}_onInput(){this._onChangeFn?.(this.value),(this._slider.step||!this._isActive)&&this._updateThumbUIByValue({withAnimation:!0}),this._slider._onValueChange(this)}_onNgControlValueChange(){(!this._isActive||!this._isFocused)&&(this._slider._onValueChange(this),this._updateThumbUIByValue()),this._slider.disabled=this._formControl.disabled}_onPointerDown(e){if(!this.disabled&&0===e.button){if(this._platform.IOS){const n=this._slider._isCursorOnSliderThumb(e,this._slider._getThumb(this.thumbPosition)._hostElement.getBoundingClientRect());return this._isActive=n,this._updateWidthActive(),void this._slider._updateDimensions()}this._isActive=!0,this._setIsFocused(!0),this._updateWidthActive(),this._slider._updateDimensions(),this._slider.step||this._updateThumbUIByPointerEvent(e,{withAnimation:!0}),this.disabled||(this._handleValueCorrection(e),this.dragStart.emit({source:this,parent:this._slider,value:this.value}))}}_handleValueCorrection(e){this._skipUIUpdate=!0,setTimeout(()=>{this._skipUIUpdate=!1,this._fixValue(e)},0)}_fixValue(e){const n=e.clientX-this._slider._cachedLeft,r=this._slider._cachedWidth,l=0===this._slider.step?1:this._slider.step,m=Math.floor((this._slider.max-this._slider.min)/l),O=Math.round((this._slider._isRtl?1-n/r:n/r)*m)/m*(this._slider.max-this._slider.min)+this._slider.min,z=Math.round(O/l)*l;if(z===this.value)return this._slider._onValueChange(this),void(this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(e,{withAnimation:this._slider._hasAnimation}));this.value=z,this.valueChange.emit(this.value),this._onChangeFn?.(this.value),this._slider._onValueChange(this),this._slider.step>0?this._updateThumbUIByValue():this._updateThumbUIByPointerEvent(e,{withAnimation:this._slider._hasAnimation})}_onPointerMove(e){!this._slider.step&&this._isActive&&this._updateThumbUIByPointerEvent(e)}_onPointerUp(){this._isActive&&(this._isActive=!1,this._platform.SAFARI&&this._setIsFocused(!1),this.dragEnd.emit({source:this,parent:this._slider,value:this.value}),setTimeout(()=>this._updateWidthInactive(),this._platform.IOS?10:0))}_clamp(e){const n=this._tickMarkOffset;return Math.max(Math.min(e,this._slider._cachedWidth-this._tickMarkOffset),n)}_calcTranslateXByValue(){return this._slider._isRtl?(1-this.percentage)*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset:this.percentage*(this._slider._cachedWidth-2*this._tickMarkOffset)+this._tickMarkOffset}_calcTranslateXByPointerEvent(e){return e.clientX-this._slider._cachedLeft}_updateWidthActive(){}_updateWidthInactive(){this._hostElement.style.padding=`0 ${this._slider._inputPadding}px`,this._hostElement.style.width=`calc(100% + ${this._slider._inputPadding-2*this._tickMarkOffset}px)`,this._hostElement.style.left=`-${this._slider._rippleRadius-this._tickMarkOffset}px`}_updateThumbUIByValue(e){this.translateX=this._clamp(this._calcTranslateXByValue()),this._updateThumbUI(e)}_updateThumbUIByPointerEvent(e,n){this.translateX=this._clamp(this._calcTranslateXByPointerEvent(e)),this._updateThumbUI(n)}_updateThumbUI(e){this._slider._setTransition(!!e?.withAnimation),this._slider._onTranslateXChange(this)}writeValue(e){(this._isControlInitialized||null!==e)&&(this.value=e)}registerOnChange(e){this._onChangeFn=e,this._isControlInitialized=!0}registerOnTouched(e){this._onTouchedFn=e}setDisabledState(e){this.disabled=e}focus(){this._hostElement.focus()}blur(){this._hostElement.blur()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.SKi),o.rXU(o.aKT),o.rXU(o.gRc),o.rXU(WO))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["input","matSliderThumb",""]],hostAttrs:["type","range",1,"mdc-slider__input"],hostVars:1,hostBindings:function(n,r){1&n&&o.bIt("change",function(){return r._onChange()})("input",function(){return r._onInput()})("blur",function(){return r._onBlur()})("focus",function(){return r._onFocus()}),2&n&&o.BMQ("aria-valuetext",r._valuetext())},inputs:{value:[2,"value","value",o.Udg]},outputs:{valueChange:"valueChange",dragStart:"dragStart",dragEnd:"dragEnd"},exportAs:["matSliderThumb"],standalone:!0,features:[o.Jv_([Gde,{provide:c7,useExisting:i}]),o.GFd]})}}return i})(),Wde=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,ul]})}}return i})();const Xde=["*"],Zde=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],Kde=["[mat-card-avatar], [matCardAvatar]","mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","*"],Qde=new o.nKC("MAT_CARD_CONFIG");let f7=(()=>{class i{constructor(e){this.appearance=e?.appearance||"raised"}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(Qde,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(n,r){2&n&&o.AVh("mat-mdc-card-outlined","outlined"===r.appearance)("mdc-card--outlined","outlined"===r.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],standalone:!0,features:[o.aNF],ngContentSelectors:Xde,decls:1,vars:0,template:function(n,r){1&n&&(o.NAR(),o.SdG(0))},styles:['.mdc-card{display:flex;flex-direction:column;box-sizing:border-box}.mdc-card::after{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none;pointer-events:none}@media screen and (forced-colors: active){.mdc-card::after{border-color:CanvasText}}.mdc-card--outlined::after{border:none}.mdc-card__content{border-radius:inherit;height:100%}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:none;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{color:rgba(0, 0, 0, 0.6);flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons,.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl]{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:none}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}[dir=rtl] .mdc-card__action--button,.mdc-card__action--button[dir=rtl]{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-card__action--button:last-child,.mdc-card__action--button:last-child[dir=rtl]{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button,.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl]{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mdc-card__action--icon:not(:disabled){color:rgba(0, 0, 0, 0.6)}.mat-mdc-card{border-radius:var(--mdc-elevated-card-container-shape);background-color:var(--mdc-elevated-card-container-color);border-width:0;border-style:solid;border-color:var(--mdc-elevated-card-container-color);box-shadow:var(--mdc-elevated-card-container-elevation)}.mat-mdc-card .mdc-card::after{border-radius:var(--mdc-elevated-card-container-shape)}.mat-mdc-card-outlined{border-width:var(--mdc-outlined-card-outline-width);border-style:solid;border-color:var(--mdc-outlined-card-outline-color);border-radius:var(--mdc-outlined-card-container-shape);background-color:var(--mdc-outlined-card-container-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.mat-mdc-card-outlined .mdc-card::after{border-radius:var(--mdc-outlined-card-container-shape)}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font);line-height:var(--mat-card-title-text-line-height);font-size:var(--mat-card-title-text-size);letter-spacing:var(--mat-card-title-text-tracking);font-weight:var(--mat-card-title-text-weight)}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color);font-family:var(--mat-card-subtitle-text-font);line-height:var(--mat-card-subtitle-text-line-height);font-size:var(--mat-card-subtitle-text-size);letter-spacing:var(--mat-card-subtitle-text-tracking);font-weight:var(--mat-card-subtitle-text-weight)}.mat-mdc-card{position:relative}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}}return i})(),m7=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"],standalone:!0})}}return i})(),p7=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],standalone:!0,features:[o.aNF],ngContentSelectors:Kde,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(n,r){1&n&&(o.NAR(Zde),o.SdG(0),o.j41(1,"div",0),o.SdG(2,1),o.k0s(),o.SdG(3,2))},encapsulation:2,changeDetection:0})}}return i})(),nue=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,os,qn]})}}return i})(),rue=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[ec,qn,qn]})}}return i})();class FS{static{this.pathTypeLayers=new Set([mn.PathLayer,mn.ArcLayer,mn.LineLayer])}static{this.pointTypeLayers=new Set([mn.ScatterplotLayer])}static{this.aggregationLayers=new Set([mn.GridLayer,mn.ScreenGridLayer,mn.HeatmapLayer,mn.HexagonLayer])}static isPathTypeLayer(t){return this.pathTypeLayers.has(t)}static isPointTypeLayer(t){return this.pointTypeLayers.has(t)}static isAggregationLayer(t){return this.aggregationLayers.has(t)}static layerToString(t){switch(t){case mn.ArcLayer:return"arc";case mn.LineLayer:return"line";case mn.TextLayer:return"text";case mn.TripsLayer:return"trip";case mn.GeoJsonLayer:return"geojson";case mn.ScreenGridLayer:return"screen grid";case mn.TileLayer:return"tile";case mn.GPUGridLayer:return"gpu grid";case mn.ScatterplotLayer:return"scatterplot";case mn.HeatmapLayer:return"heatmap";case mn.PathLayer:return"path";case mn.GridLayer:return"grid";case mn.HexagonLayer:return"hexagon";default:return"no supported"}}}const g7=["*"];class sue{constructor(){this.columnIndex=0,this.rowIndex=0}get rowCount(){return this.rowIndex+1}get rowspan(){const t=Math.max(...this.tracker);return t>1?this.rowCount+t-1:this.rowCount}update(t,e){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(t),this.tracker.fill(0,0,this.tracker.length),this.positions=e.map(n=>this._trackTile(n))}_trackTile(t){const e=this._findMatchingGap(t.colspan);return this._markTilePosition(e,t),this.columnIndex=e+t.colspan,new aue(this.rowIndex,e)}_findMatchingGap(t){let e=-1,n=-1;do{this.columnIndex+t>this.tracker.length?(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e)):(e=this.tracker.indexOf(0,this.columnIndex),-1!=e?(n=this._findGapEndIndex(e),this.columnIndex=e+1):(this._nextRow(),e=this.tracker.indexOf(0,this.columnIndex),n=this._findGapEndIndex(e)))}while(n-e<t||0==n);return Math.max(e,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let t=0;t<this.tracker.length;t++)this.tracker[t]=Math.max(0,this.tracker[t]-1)}_findGapEndIndex(t){for(let e=t+1;e<this.tracker.length;e++)if(0!=this.tracker[e])return e;return this.tracker.length}_markTilePosition(t,e){for(let n=0;n<e.colspan;n++)this.tracker[t+n]=e.rowspan}}class aue{constructor(t,e){this.row=t,this.col=e}}const _7=new o.nKC("MAT_GRID_LIST");let v7=(()=>{class i{constructor(e,n){this._element=e,this._gridList=n,this._rowspan=1,this._colspan=1}get rowspan(){return this._rowspan}set rowspan(e){this._rowspan=Math.round(au(e))}get colspan(){return this._colspan}set colspan(e){this._colspan=Math.round(au(e))}_setStyle(e,n){this._element.nativeElement.style[e]=n}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(_7,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(n,r){2&n&&o.BMQ("rowspan",r.rowspan)("colspan",r.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],standalone:!0,features:[o.aNF],ngContentSelectors:g7,decls:2,vars:0,consts:[[1,"mat-grid-tile-content"]],template:function(n,r){1&n&&(o.NAR(),o.j41(0,"div",0),o.SdG(1),o.k0s())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-header{font-size:var(--mat-grid-list-tile-header-primary-text-size)}.mat-grid-tile-header .mat-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;box-sizing:border-box}.mat-grid-tile-header .mat-line:nth-child(n+2){font-size:var(--mat-grid-list-tile-header-secondary-text-size)}.mat-grid-tile-footer{font-size:var(--mat-grid-list-tile-footer-primary-text-size)}.mat-grid-tile-footer .mat-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;box-sizing:border-box}.mat-grid-tile-footer .mat-line:nth-child(n+2){font-size:var(--mat-grid-list-tile-footer-secondary-text-size)}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}"],encapsulation:2,changeDetection:0})}}return i})();const lue=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/;class Iz{constructor(){this._rows=0,this._rowspan=0}init(t,e,n,r){this._gutterSize=b7(t),this._rows=e.rowCount,this._rowspan=e.rowspan,this._cols=n,this._direction=r}getBaseTileSize(t,e){return`(${t}% - (${this._gutterSize} * ${e}))`}getTilePosition(t,e){return 0===e?"0":aC(`(${t} + ${this._gutterSize}) * ${e}`)}getTileSize(t,e){return`(${t} * ${e}) + (${e-1} * ${this._gutterSize})`}setStyle(t,e,n){let r=100/this._cols,l=(this._cols-1)/this._cols;this.setColStyles(t,n,r,l),this.setRowStyles(t,e,r,l)}setColStyles(t,e,n,r){let l=this.getBaseTileSize(n,r);t._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(l,e)),t._setStyle("width",aC(this.getTileSize(l,t.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(t){return`${this._rowspan} * ${this.getTileSize(t,1)}`}getComputedHeight(){return null}}class cue extends Iz{constructor(t){super(),this.fixedRowHeight=t}init(t,e,n,r){super.init(t,e,n,r),this.fixedRowHeight=b7(this.fixedRowHeight),lue.test(this.fixedRowHeight)}setRowStyles(t,e){t._setStyle("top",this.getTilePosition(this.fixedRowHeight,e)),t._setStyle("height",aC(this.getTileSize(this.fixedRowHeight,t.rowspan)))}getComputedHeight(){return["height",aC(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["height",null]),t._tiles&&t._tiles.forEach(e=>{e._setStyle("top",null),e._setStyle("height",null)})}}class due extends Iz{constructor(t){super(),this._parseRatio(t)}setRowStyles(t,e,n,r){this.baseTileHeight=this.getBaseTileSize(n/this.rowHeightRatio,r),t._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,e)),t._setStyle("paddingTop",aC(this.getTileSize(this.baseTileHeight,t.rowspan)))}getComputedHeight(){return["paddingBottom",aC(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(t){t._setListStyle(["paddingBottom",null]),t._tiles.forEach(e=>{e._setStyle("marginTop",null),e._setStyle("paddingTop",null)})}_parseRatio(t){const e=t.split(":");this.rowHeightRatio=parseFloat(e[0])/parseFloat(e[1])}}class uue extends Iz{setRowStyles(t,e){let l=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);t._setStyle("top",this.getTilePosition(l,e)),t._setStyle("height",aC(this.getTileSize(l,t.rowspan)))}reset(t){t._tiles&&t._tiles.forEach(e=>{e._setStyle("top",null),e._setStyle("height",null)})}}function aC(i){return`calc(${i})`}function b7(i){return i.match(/([A-Za-z%]+)$/)?i:`${i}px`}let fue=(()=>{class i{constructor(e,n){this._element=e,this._dir=n,this._gutter="1px"}get cols(){return this._cols}set cols(e){this._cols=Math.max(1,Math.round(au(e)))}get gutterSize(){return this._gutter}set gutterSize(e){this._gutter=`${e??""}`}get rowHeight(){return this._rowHeight}set rowHeight(e){const n=`${e??""}`;n!==this._rowHeight&&(this._rowHeight=n,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(e){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===e?new uue:e&&e.indexOf(":")>-1?new due(e):new cue(e)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new sue);const e=this._tileCoordinator,n=this._tiles.filter(l=>!l._gridList||l._gridList===this),r=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,n),this._tileStyler.init(this.gutterSize,e,this.cols,r),n.forEach((l,m)=>{const C=e.positions[m];this._tileStyler.setStyle(l,C.row,C.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(e){e&&(this._element.nativeElement.style[e[0]]=e[1])}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(Us,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-grid-list"]],contentQueries:function(n,r,l){if(1&n&&o.wni(l,v7,5),2&n){let m;o.mGM(m=o.lsd())&&(r._tiles=m)}},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(n,r){2&n&&o.BMQ("cols",r.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],standalone:!0,features:[o.Jv_([{provide:_7,useExisting:i}]),o.aNF],ngContentSelectors:g7,decls:2,vars:0,template:function(n,r){1&n&&(o.NAR(),o.j41(0,"div"),o.SdG(1),o.k0s())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-header{font-size:var(--mat-grid-list-tile-header-primary-text-size)}.mat-grid-tile-header .mat-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;box-sizing:border-box}.mat-grid-tile-header .mat-line:nth-child(n+2){font-size:var(--mat-grid-list-tile-header-secondary-text-size)}.mat-grid-tile-footer{font-size:var(--mat-grid-list-tile-footer-primary-text-size)}.mat-grid-tile-footer .mat-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;box-sizing:border-box}.mat-grid-tile-footer .mat-line:nth-child(n+2){font-size:var(--mat-grid-list-tile-footer-secondary-text-size)}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}"],encapsulation:2,changeDetection:0})}}return i})(),mue=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[th,qn,th,qn]})}}return i})();function ed(i,t){(function pue(i){return"string"==typeof i&&-1!==i.indexOf(".")&&1===parseFloat(i)})(i)&&(i="100%");var e=function gue(i){return"string"==typeof i&&-1!==i.indexOf("%")}(i);return i=360===t?i:Math.min(t,Math.max(0,parseFloat(i))),e&&(i=parseInt(String(i*t),10)/100),Math.abs(i-t)<1e-6?1:i=360===t?(i<0?i%t+t:i%t)/parseFloat(String(t)):i%t/parseFloat(String(t))}function XO(i){return Math.min(1,Math.max(0,i))}function y7(i){return i=parseFloat(i),(isNaN(i)||i<0||i>1)&&(i=1),i}function qO(i){return i<=1?"".concat(100*Number(i),"%"):i}function lC(i){return 1===i.length?"0"+i:String(i)}function x7(i,t,e){i=ed(i,255),t=ed(t,255),e=ed(e,255);var n=Math.max(i,t,e),r=Math.min(i,t,e),l=0,m=0,C=(n+r)/2;if(n===r)m=0,l=0;else{var A=n-r;switch(m=C>.5?A/(2-n-r):A/(n+r),n){case i:l=(t-e)/A+(t<e?6:0);break;case t:l=(e-i)/A+2;break;case e:l=(i-t)/A+4}l/=6}return{h:l,s:m,l:C}}function Rz(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+6*e*(t-i):e<.5?t:e<2/3?i+(t-i)*(2/3-e)*6:i}function w7(i,t,e){i=ed(i,255),t=ed(t,255),e=ed(e,255);var n=Math.max(i,t,e),r=Math.min(i,t,e),l=0,m=n,C=n-r,A=0===n?0:C/n;if(n===r)l=0;else{switch(n){case i:l=(t-e)/C+(t<e?6:0);break;case t:l=(e-i)/C+2;break;case e:l=(i-t)/C+4}l/=6}return{h:l,s:A,v:m}}function C7(i,t,e,n){var r=[lC(Math.round(i).toString(16)),lC(Math.round(t).toString(16)),lC(Math.round(e).toString(16))];return n&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function E7(i){return Math.round(255*parseFloat(i)).toString(16)}function T7(i){return hf(i)/255}function hf(i){return parseInt(i,16)}var Pz={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var wx="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),Oz="[\\s|\\(]+(".concat(wx,")[,|\\s]+(").concat(wx,")[,|\\s]+(").concat(wx,")\\s*\\)?"),Lz="[\\s|\\(]+(".concat(wx,")[,|\\s]+(").concat(wx,")[,|\\s]+(").concat(wx,")[,|\\s]+(").concat(wx,")\\s*\\)?"),ug={CSS_UNIT:new RegExp(wx),rgb:new RegExp("rgb"+Oz),rgba:new RegExp("rgba"+Lz),hsl:new RegExp("hsl"+Oz),hsla:new RegExp("hsla"+Lz),hsv:new RegExp("hsv"+Oz),hsva:new RegExp("hsva"+Lz),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function zb(i){return!!ug.CSS_UNIT.exec(String(i))}var Ub=function(){function i(t,e){var n;if(void 0===t&&(t=""),void 0===e&&(e={}),t instanceof i)return t;"number"==typeof t&&(t=function xue(i){return{r:i>>16,g:(65280&i)>>8,b:255&i}}(t)),this.originalInput=t;var r=function wue(i){var t={r:0,g:0,b:0},e=1,n=null,r=null,l=null,m=!1,C=!1;return"string"==typeof i&&(i=function Tue(i){if(0===(i=i.trim().toLowerCase()).length)return!1;var t=!1;if(Pz[i])i=Pz[i],t=!0;else if("transparent"===i)return{r:0,g:0,b:0,a:0,format:"name"};var e=ug.rgb.exec(i);return e?{r:e[1],g:e[2],b:e[3]}:(e=ug.rgba.exec(i))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=ug.hsl.exec(i))?{h:e[1],s:e[2],l:e[3]}:(e=ug.hsla.exec(i))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=ug.hsv.exec(i))?{h:e[1],s:e[2],v:e[3]}:(e=ug.hsva.exec(i))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=ug.hex8.exec(i))?{r:hf(e[1]),g:hf(e[2]),b:hf(e[3]),a:T7(e[4]),format:t?"name":"hex8"}:(e=ug.hex6.exec(i))?{r:hf(e[1]),g:hf(e[2]),b:hf(e[3]),format:t?"name":"hex"}:(e=ug.hex4.exec(i))?{r:hf(e[1]+e[1]),g:hf(e[2]+e[2]),b:hf(e[3]+e[3]),a:T7(e[4]+e[4]),format:t?"name":"hex8"}:!!(e=ug.hex3.exec(i))&&{r:hf(e[1]+e[1]),g:hf(e[2]+e[2]),b:hf(e[3]+e[3]),format:t?"name":"hex"}}(i)),"object"==typeof i&&(zb(i.r)&&zb(i.g)&&zb(i.b)?(t=function _ue(i,t,e){return{r:255*ed(i,255),g:255*ed(t,255),b:255*ed(e,255)}}(i.r,i.g,i.b),m=!0,C="%"===String(i.r).substr(-1)?"prgb":"rgb"):zb(i.h)&&zb(i.s)&&zb(i.v)?(n=qO(i.s),r=qO(i.v),t=function bue(i,t,e){i=6*ed(i,360),t=ed(t,100),e=ed(e,100);var n=Math.floor(i),r=i-n,l=e*(1-t),m=e*(1-r*t),C=e*(1-(1-r)*t),A=n%6;return{r:255*[e,m,l,l,C,e][A],g:255*[C,e,e,m,l,l][A],b:255*[l,l,C,e,e,m][A]}}(i.h,n,r),m=!0,C="hsv"):zb(i.h)&&zb(i.s)&&zb(i.l)&&(n=qO(i.s),l=qO(i.l),t=function vue(i,t,e){var n,r,l;if(i=ed(i,360),t=ed(t,100),e=ed(e,100),0===t)r=e,l=e,n=e;else{var m=e<.5?e*(1+t):e+t-e*t,C=2*e-m;n=Rz(C,m,i+1/3),r=Rz(C,m,i),l=Rz(C,m,i-1/3)}return{r:255*n,g:255*r,b:255*l}}(i.h,n,l),m=!0,C="hsl"),Object.prototype.hasOwnProperty.call(i,"a")&&(e=i.a)),e=y7(e),{ok:m,format:i.format||C,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:e}}(t);this.originalInput=t,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(n=e.format)&&void 0!==n?n:r.format,this.gradientType=e.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}return i.prototype.isDark=function(){return this.getBrightness()<128},i.prototype.isLight=function(){return!this.isDark()},i.prototype.getBrightness=function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},i.prototype.getLuminance=function(){var t=this.toRgb(),l=t.r/255,m=t.g/255,C=t.b/255;return.2126*(l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4))+.7152*(m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4))+.0722*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))},i.prototype.getAlpha=function(){return this.a},i.prototype.setAlpha=function(t){return this.a=y7(t),this.roundA=Math.round(100*this.a)/100,this},i.prototype.isMonochrome=function(){return 0===this.toHsl().s},i.prototype.toHsv=function(){var t=w7(this.r,this.g,this.b);return{h:360*t.h,s:t.s,v:t.v,a:this.a}},i.prototype.toHsvString=function(){var t=w7(this.r,this.g,this.b),e=Math.round(360*t.h),n=Math.round(100*t.s),r=Math.round(100*t.v);return 1===this.a?"hsv(".concat(e,", ").concat(n,"%, ").concat(r,"%)"):"hsva(".concat(e,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},i.prototype.toHsl=function(){var t=x7(this.r,this.g,this.b);return{h:360*t.h,s:t.s,l:t.l,a:this.a}},i.prototype.toHslString=function(){var t=x7(this.r,this.g,this.b),e=Math.round(360*t.h),n=Math.round(100*t.s),r=Math.round(100*t.l);return 1===this.a?"hsl(".concat(e,", ").concat(n,"%, ").concat(r,"%)"):"hsla(".concat(e,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},i.prototype.toHex=function(t){return void 0===t&&(t=!1),C7(this.r,this.g,this.b,t)},i.prototype.toHexString=function(t){return void 0===t&&(t=!1),"#"+this.toHex(t)},i.prototype.toHex8=function(t){return void 0===t&&(t=!1),function yue(i,t,e,n,r){var l=[lC(Math.round(i).toString(16)),lC(Math.round(t).toString(16)),lC(Math.round(e).toString(16)),lC(E7(n))];return r&&l[0].startsWith(l[0].charAt(1))&&l[1].startsWith(l[1].charAt(1))&&l[2].startsWith(l[2].charAt(1))&&l[3].startsWith(l[3].charAt(1))?l[0].charAt(0)+l[1].charAt(0)+l[2].charAt(0)+l[3].charAt(0):l.join("")}(this.r,this.g,this.b,this.a,t)},i.prototype.toHex8String=function(t){return void 0===t&&(t=!1),"#"+this.toHex8(t)},i.prototype.toHexShortString=function(t){return void 0===t&&(t=!1),1===this.a?this.toHexString(t):this.toHex8String(t)},i.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},i.prototype.toRgbString=function(){var t=Math.round(this.r),e=Math.round(this.g),n=Math.round(this.b);return 1===this.a?"rgb(".concat(t,", ").concat(e,", ").concat(n,")"):"rgba(".concat(t,", ").concat(e,", ").concat(n,", ").concat(this.roundA,")")},i.prototype.toPercentageRgb=function(){var t=function(e){return"".concat(Math.round(100*ed(e,255)),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},i.prototype.toPercentageRgbString=function(){var t=function(e){return Math.round(100*ed(e,255))};return 1===this.a?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},i.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var t="#"+C7(this.r,this.g,this.b,!1),e=0,n=Object.entries(Pz);e<n.length;e++){var r=n[e];if(t===r[1])return r[0]}return!1},i.prototype.toString=function(t){var e=!!t;t=t??this.format;var n=!1;return!e&&this.a<1&&this.a>=0&&(t.startsWith("hex")||"name"===t)?"name"===t&&0===this.a?this.toName():this.toRgbString():("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),("hex"===t||"hex6"===t)&&(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString())},i.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},i.prototype.clone=function(){return new i(this.toString())},i.prototype.lighten=function(t){void 0===t&&(t=10);var e=this.toHsl();return e.l+=t/100,e.l=XO(e.l),new i(e)},i.prototype.brighten=function(t){void 0===t&&(t=10);var e=this.toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(-t/100*255))),e.g=Math.max(0,Math.min(255,e.g-Math.round(-t/100*255))),e.b=Math.max(0,Math.min(255,e.b-Math.round(-t/100*255))),new i(e)},i.prototype.darken=function(t){void 0===t&&(t=10);var e=this.toHsl();return e.l-=t/100,e.l=XO(e.l),new i(e)},i.prototype.tint=function(t){return void 0===t&&(t=10),this.mix("white",t)},i.prototype.shade=function(t){return void 0===t&&(t=10),this.mix("black",t)},i.prototype.desaturate=function(t){void 0===t&&(t=10);var e=this.toHsl();return e.s-=t/100,e.s=XO(e.s),new i(e)},i.prototype.saturate=function(t){void 0===t&&(t=10);var e=this.toHsl();return e.s+=t/100,e.s=XO(e.s),new i(e)},i.prototype.greyscale=function(){return this.desaturate(100)},i.prototype.spin=function(t){var e=this.toHsl(),n=(e.h+t)%360;return e.h=n<0?360+n:n,new i(e)},i.prototype.mix=function(t,e){void 0===e&&(e=50);var n=this.toRgb(),r=new i(t).toRgb(),l=e/100;return new i({r:(r.r-n.r)*l+n.r,g:(r.g-n.g)*l+n.g,b:(r.b-n.b)*l+n.b,a:(r.a-n.a)*l+n.a})},i.prototype.analogous=function(t,e){void 0===t&&(t=6),void 0===e&&(e=30);var n=this.toHsl(),r=360/e,l=[this];for(n.h=(n.h-(r*t>>1)+720)%360;--t;)n.h=(n.h+r)%360,l.push(new i(n));return l},i.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new i(t)},i.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var e=this.toHsv(),n=e.h,r=e.s,l=e.v,m=[],C=1/t;t--;)m.push(new i({h:n,s:r,v:l})),l=(l+C)%1;return m},i.prototype.splitcomplement=function(){var t=this.toHsl(),e=t.h;return[this,new i({h:(e+72)%360,s:t.s,l:t.l}),new i({h:(e+216)%360,s:t.s,l:t.l})]},i.prototype.onBackground=function(t){var e=this.toRgb(),n=new i(t).toRgb(),r=e.a+n.a*(1-e.a);return new i({r:(e.r*e.a+n.r*n.a*(1-e.a))/r,g:(e.g*e.a+n.g*n.a*(1-e.a))/r,b:(e.b*e.a+n.b*n.a*(1-e.a))/r,a:r})},i.prototype.triad=function(){return this.polyad(3)},i.prototype.tetrad=function(){return this.polyad(4)},i.prototype.polyad=function(t){for(var e=this.toHsl(),n=e.h,r=[this],l=360/t,m=1;m<t;m++)r.push(new i({h:(n+m*l)%360,s:e.s,l:e.l}));return r},i.prototype.equals=function(t){return this.toRgbString()===new i(t).toRgbString()},i}();function Sue(i,t){if(1&i){const e=o.RV6();o.j41(0,"span",3),o.bIt("mousedown",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.handleMousedown(r))}),o.EFF(1),o.k0s()}if(2&i){const e=o.XpG();o.Y8G("id",e.uniqueId)("ngStyle",e.labelStyle),o.R7$(),o.SpI(" ",e.label," ")}}function Mue(i,t){if(1&i&&(o.j41(0,"div",2),o.nrm(1,"div",3),o.k0s()),2&i){const e=o.XpG();o.xc7("left",e.left)("top",e.top),o.R7$(),o.Y8G("ngStyle",e.pointer)}}const Fz={};let S7=(()=>{class i{white="transparent";size=8;grey="rgba(0,0,0,.08)";boxShadow;borderRadius;gridStyles;ngOnInit(){const e=function Due(i,t,e){const n=`${i}-${t}-${e}`;if(Fz[n])return Fz[n];const r=function Aue(i,t,e){if(typeof document>"u")return null;const n=document.createElement("canvas");n.width=2*e,n.height=2*e;const r=n.getContext("2d");return r?(r.fillStyle=i,r.fillRect(0,0,n.width,n.height),r.fillStyle=t,r.fillRect(0,0,e,e),r.translate(e,e),r.fillRect(0,0,e,e),n.toDataURL()):null}(i,t,e);return r?(Fz[n]=r,r):null}(this.white,this.grey,this.size);this.gridStyles={borderRadius:this.borderRadius,boxShadow:this.boxShadow,background:`url(${e}) center left`}}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=o.VBU({type:i,selectors:[["color-checkboard"]],inputs:{white:"white",size:"size",grey:"grey",boxShadow:"boxShadow",borderRadius:"borderRadius"},decls:1,vars:1,consts:[[1,"grid",3,"ngStyle"]],template:function(n,r){1&n&&o.nrm(0,"div",0),2&n&&o.Y8G("ngStyle",r.gridStyles)},dependencies:[mc],styles:[".grid[_ngcontent-%COMP%]{inset:0;position:absolute}"],changeDetection:0})}return i})(),M7=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=o.$C({type:i});static \u0275inj=o.G2t({imports:[os]})}return i})(),Nz=(()=>{class i{el;coordinatesChange=new xi.B;mousechange=new xi.B;mouseListening=!1;sub;mousemove(e,n,r,l=!1){this.mouseListening&&(e.preventDefault(),this.mousechange.next({$event:e,x:n,y:r,isTouch:l}))}mouseup(){this.mouseListening=!1}mousedown(e,n,r,l=!1){e.preventDefault(),this.mouseListening=!0,this.mousechange.next({$event:e,x:n,y:r,isTouch:l})}constructor(e){this.el=e}ngOnInit(){this.sub=this.mousechange.pipe(su((e,n)=>e.x===n.x&&e.y===n.y)).subscribe(e=>this.handleChange(e.x,e.y,e.$event,e.isTouch))}ngOnDestroy(){this.sub?.unsubscribe()}handleChange(e,n,r,l){const m=this.el.nativeElement.clientWidth,C=this.el.nativeElement.clientHeight,A=e-(this.el.nativeElement.getBoundingClientRect().left+window.pageXOffset);let O=n-this.el.nativeElement.getBoundingClientRect().top;l||(O-=window.pageYOffset),this.coordinatesChange.next({x:e,y:n,top:O,left:A,containerWidth:m,containerHeight:C,$event:r})}static \u0275fac=function(n){return new(n||i)(o.rXU(o.aKT))};static \u0275dir=o.FsC({type:i,selectors:[["","ngx-color-coordinates",""]],hostBindings:function(n,r){1&n&&o.bIt("mousemove",function(m){return r.mousemove(m,m.pageX,m.pageY)},!1,o.tSv)("touchmove",function(m){return r.mousemove(m,m.touches[0].clientX,m.touches[0].clientY,!0)},!1,o.tSv)("mouseup",function(){return r.mouseup()},!1,o.tSv)("touchend",function(){return r.mouseup()},!1,o.tSv)("mousedown",function(m){return r.mousedown(m,m.pageX,m.pageY)})("touchstart",function(m){return r.mousedown(m,m.touches[0].clientX,m.touches[0].clientY,!0)})},outputs:{coordinatesChange:"coordinatesChange"}})}return i})(),Bz=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=o.$C({type:i});static \u0275inj=o.G2t({})}return i})(),kue=(()=>{class i{hsl;rgb;pointer;shadow;radius;direction="horizontal";onChange=new o.bkB;gradient;pointerLeft;pointerTop;ngOnChanges(){"vertical"===this.direction?(this.pointerLeft=0,this.pointerTop=100*this.rgb.a,this.gradient={background:`linear-gradient(to bottom, rgba(${this.rgb.r},${this.rgb.g},${this.rgb.b}, 0) 0%,\n          rgba(${this.rgb.r},${this.rgb.g},${this.rgb.b}, 1) 100%)`}):(this.gradient={background:`linear-gradient(to right, rgba(${this.rgb.r},${this.rgb.g},${this.rgb.b}, 0) 0%,\n          rgba(${this.rgb.r},${this.rgb.g},${this.rgb.b}, 1) 100%)`},this.pointerLeft=100*this.rgb.a)}handleChange({top:e,left:n,containerHeight:r,containerWidth:l,$event:m}){let C;if("vertical"===this.direction){let A;A=e<0?0:e>r?1:Math.round(100*e/r)/100,this.hsl.a!==A&&(C={h:this.hsl.h,s:this.hsl.s,l:this.hsl.l,a:A,source:"rgb"})}else{let A;A=n<0?0:n>l?1:Math.round(100*n/l)/100,this.hsl.a!==A&&(C={h:this.hsl.h,s:this.hsl.s,l:this.hsl.l,a:A,source:"rgb"})}C&&this.onChange.emit({data:C,$event:m})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=o.VBU({type:i,selectors:[["color-alpha"]],inputs:{hsl:"hsl",rgb:"rgb",pointer:"pointer",shadow:"shadow",radius:"radius",direction:"direction"},outputs:{onChange:"onChange"},features:[o.OA$],decls:7,vars:15,consts:[[1,"alpha"],[1,"alpha-checkboard"],[1,"alpha-gradient",3,"ngStyle"],["ngx-color-coordinates","",3,"coordinatesChange"],[1,"alpha-pointer"],[1,"alpha-slider",3,"ngStyle"]],template:function(n,r){1&n&&(o.j41(0,"div",0)(1,"div",1),o.nrm(2,"color-checkboard"),o.k0s(),o.nrm(3,"div",2),o.j41(4,"div",3),o.bIt("coordinatesChange",function(m){return r.handleChange(m)}),o.j41(5,"div",4),o.nrm(6,"div",5),o.k0s()()()),2&n&&(o.xc7("border-radius",r.radius),o.R7$(3),o.xc7("box-shadow",r.shadow)("border-radius",r.radius),o.Y8G("ngStyle",r.gradient),o.R7$(),o.ZvI("alpha-container color-alpha-",r.direction,""),o.R7$(),o.xc7("left",r.pointerLeft,"%")("top",r.pointerTop,"%"),o.R7$(),o.Y8G("ngStyle",r.pointer))},dependencies:[mc,S7,Nz],styles:[".alpha[_ngcontent-%COMP%]{position:absolute;inset:0}.alpha-checkboard[_ngcontent-%COMP%]{position:absolute;inset:0;overflow:hidden}.alpha-gradient[_ngcontent-%COMP%]{position:absolute;inset:0}.alpha-container[_ngcontent-%COMP%]{position:relative;height:100%;margin:0 3px}.alpha-pointer[_ngcontent-%COMP%]{position:absolute}.alpha-slider[_ngcontent-%COMP%]{width:4px;border-radius:1px;height:8px;box-shadow:0 0 2px #0009;background:#fff;margin-top:1px;transform:translate(-2px)}"],changeDetection:0})}return i})(),Iue=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=o.$C({type:i});static \u0275inj=o.G2t({imports:[os,M7,Bz]})}return i})();function A7(i){let e=0,n=0;return["r","g","b","a","h","s","l","v"].forEach(r=>{i[r]&&(e+=1,isNaN(i[r])||(n+=1),("s"===r||"l"===r)&&/^\d+%$/.test(i[r])&&(n+=1))}),e===n&&i}function jk(i,t,e){const n=new Ub(i.hex?i.hex:i);e&&n.setAlpha(1);const r=n.toHsl(),l=n.toHsv(),m=n.toRgb(),C=n.toHex();return 0===r.s&&(r.h=t||0,l.h=t||0),{hsl:r,hex:"000000"===C&&0===m.a?"transparent":n.toHexString(),rgb:m,hsv:l,oldHue:i.h||t||r.h,source:i.source}}var NS=function(i){return i.HEX="hex",i.HSL="hsl",i.HSV="hsv",i.RGB="rgb",i}(NS||{});let D7=(()=>{class i{className;mode=NS.HEX;color={h:250,s:.5,l:.2,a:1};colorChange=new o.bkB;onChange=new o.bkB;onChangeComplete=new o.bkB;onSwatchHover=new o.bkB;oldHue;hsl;hsv;rgb;hex;source;currentColor;changes;disableAlpha;_onChangeCompleteSubscription=new On.yU;_onSwatchHoverSubscription=new On.yU;ngOnInit(){this.changes=this.onChange.pipe(Uh(100),Oo(e=>{switch(this.onChangeComplete.emit(e),this.mode){case NS.HEX:this.colorChange.emit(e.color.hex);break;case NS.HSL:this.colorChange.emit(e.color.hsl);break;case NS.HSV:this.colorChange.emit(e.color.hsv);break;case NS.RGB:this.colorChange.emit(e.color.rgb);break;default:const n=`The mode '${this.mode}' is not supported`;if((0,o.naY)())throw new Error(n);console.warn(n)}})).subscribe(),this.setState(jk(this.color,0)),this.currentColor=this.hex}ngOnChanges(){this.setState(jk(this.color,this.oldHue))}ngOnDestroy(){this.changes?.unsubscribe(),this._onChangeCompleteSubscription?.unsubscribe(),this._onSwatchHoverSubscription?.unsubscribe()}setState(e){this.oldHue=e.oldHue,this.hsl=e.hsl,this.hsv=e.hsv,this.rgb=e.rgb,this.hex=e.hex,this.source=e.source,this.afterValidChange()}handleChange(e,n){if(A7(e)){const l=jk(e,e.h||this.oldHue,this.disableAlpha);this.setState(l),this.onChange.emit({color:l,$event:n}),this.afterValidChange()}}afterValidChange(){}handleSwatchHover(e,n){if(A7(e)){const l=jk(e,e.h||this.oldHue);this.setState(l),this.onSwatchHover.emit({color:l,$event:n})}}registerOnChange(e){this._onChangeCompleteSubscription.add(this.onChangeComplete.pipe(Oo(n=>e(n.color.hex))).subscribe())}registerOnTouched(e){this._onSwatchHoverSubscription.add(this.onSwatchHover.pipe(Oo(()=>e())).subscribe())}setDisabledState(e){}writeValue(e){this.color=e}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=o.VBU({type:i,selectors:[["color-wrap"]],inputs:{className:"className",mode:"mode",color:"color"},outputs:{colorChange:"colorChange",onChange:"onChange",onChangeComplete:"onChangeComplete",onSwatchHover:"onSwatchHover"},features:[o.Jv_([{provide:Ya,useExisting:(0,o.Rfq)(()=>i),multi:!0}]),o.OA$],decls:0,vars:0,template:function(n,r){},encapsulation:2})}return i})(),Pue=0,Oue=(()=>{class i{style;label;value;arrowOffset;dragLabel;dragMax;placeholder="";onChange=new o.bkB;currentValue;blurValue;wrapStyle;inputStyle;labelStyle;focus=!1;mousemove;mouseup;uniqueId="editableInput-"+ ++Pue;ngOnInit(){this.wrapStyle=this.style&&this.style.wrap?this.style.wrap:{},this.inputStyle=this.style&&this.style.input?this.style.input:{},this.labelStyle=this.style&&this.style.label?this.style.label:{},this.dragLabel&&(this.labelStyle.cursor="ew-resize")}handleFocus(e){this.focus=!0}handleFocusOut(e){this.focus=!1,this.currentValue=this.blurValue}handleKeydown(e){const n=String(e.target.value),r=n.indexOf("%")>-1,l=Number(n.replace(/%/g,""));if(isNaN(l))return;const m=this.arrowOffset||1;38===e.keyCode&&(this.onChange.emit(this.label?{data:{[this.label]:l+m},$event:e}:{data:l+m,$event:e}),this.currentValue=r?`${l+m}%`:l+m),40===e.keyCode&&(this.onChange.emit(this.label?{data:{[this.label]:l-m},$event:e}:{data:l-m,$event:e}),this.currentValue=r?l-m+"%":l-m)}handleKeyup(e){40===e.keyCode||38===e.keyCode||`${this.currentValue}`!==e.target.value&&this.onChange.emit(this.label?{data:{[this.label]:e.target.value},$event:e}:{data:e.target.value,$event:e})}ngOnChanges(){this.focus||(this.currentValue=String(this.value).toUpperCase()),this.blurValue=String(this.value).toUpperCase()}ngOnDestroy(){this.unsubscribe()}subscribe(){this.mousemove=bu(document,"mousemove").subscribe(e=>this.handleDrag(e)),this.mouseup=bu(document,"mouseup").subscribe(()=>this.unsubscribe())}unsubscribe(){this.mousemove?.unsubscribe(),this.mouseup?.unsubscribe()}handleMousedown(e){this.dragLabel&&(e.preventDefault(),this.handleDrag(e),this.subscribe())}handleDrag(e){if(this.dragLabel){const n=Math.round(this.value+e.movementX);n>=0&&n<=this.dragMax&&this.onChange.emit({data:{[this.label]:n},$event:e})}}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=o.VBU({type:i,selectors:[["color-editable-input"]],inputs:{style:"style",label:"label",value:"value",arrowOffset:"arrowOffset",dragLabel:"dragLabel",dragMax:"dragMax",placeholder:"placeholder"},outputs:{onChange:"onChange"},features:[o.OA$],decls:3,vars:6,consts:[[1,"wrap",3,"ngStyle"],["spellCheck","false",3,"keydown","keyup","focus","focusout","ngStyle","value","placeholder"],[3,"id","ngStyle","mousedown",4,"ngIf"],[3,"mousedown","id","ngStyle"]],template:function(n,r){1&n&&(o.j41(0,"div",0)(1,"input",1),o.bIt("keydown",function(m){return r.handleKeydown(m)})("keyup",function(m){return r.handleKeyup(m)})("focus",function(m){return r.handleFocus(m)})("focusout",function(m){return r.handleFocusOut(m)}),o.k0s(),o.DNE(2,Sue,2,3,"span",2),o.k0s()),2&n&&(o.Y8G("ngStyle",r.wrapStyle),o.R7$(),o.Y8G("ngStyle",r.inputStyle)("value",r.currentValue)("placeholder",r.placeholder),o.BMQ("aria-labelledby",r.uniqueId),o.R7$(),o.Y8G("ngIf",r.label))},dependencies:[fc,mc],styles:["[_nghost-%COMP%]{display:flex}.wrap[_ngcontent-%COMP%]{position:relative}"],changeDetection:0})}return i})(),Lue=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=o.$C({type:i});static \u0275inj=o.G2t({imports:[os]})}return i})(),Fue=(()=>{class i{hsl;pointer;radius;shadow;hidePointer=!1;direction="horizontal";onChange=new o.bkB;left="0px";top="";ngOnChanges(){"horizontal"===this.direction?this.left=100*this.hsl.h/360+"%":this.top=-100*this.hsl.h/360+100+"%"}handleChange({top:e,left:n,containerHeight:r,containerWidth:l,$event:m}){let C;if("vertical"===this.direction){let A;A=e<0?359:e>r?0:360*(-100*e/r+100)/100,this.hsl.h!==A&&(C={h:A,s:this.hsl.s,l:this.hsl.l,a:this.hsl.a,source:"rgb"})}else{let A;A=n<0?0:n>l?359:100*n/l*360/100,this.hsl.h!==A&&(C={h:A,s:this.hsl.s,l:this.hsl.l,a:this.hsl.a,source:"rgb"})}C&&this.onChange.emit({data:C,$event:m})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=o.VBU({type:i,selectors:[["color-hue"]],inputs:{hsl:"hsl",pointer:"pointer",radius:"radius",shadow:"shadow",hidePointer:"hidePointer",direction:"direction"},outputs:{onChange:"onChange"},features:[o.OA$],decls:3,vars:8,consts:[["ngx-color-coordinates","",1,"color-hue-container",3,"coordinatesChange"],["class","color-hue-pointer",3,"left","top",4,"ngIf"],[1,"color-hue-pointer"],[1,"color-hue-slider",3,"ngStyle"]],template:function(n,r){1&n&&(o.j41(0,"div")(1,"div",0),o.bIt("coordinatesChange",function(m){return r.handleChange(m)}),o.DNE(2,Mue,2,5,"div",1),o.k0s()()),2&n&&(o.ZvI("color-hue color-hue-",r.direction,""),o.xc7("border-radius",r.radius,"px")("box-shadow",r.shadow),o.R7$(2),o.Y8G("ngIf",!r.hidePointer))},dependencies:[fc,mc,Nz],styles:[".color-hue[_ngcontent-%COMP%]{position:absolute;inset:0}.color-hue-container[_ngcontent-%COMP%]{margin:0 2px;position:relative;height:100%}.color-hue-pointer[_ngcontent-%COMP%]{position:absolute}.color-hue-slider[_ngcontent-%COMP%]{margin-top:1px;width:4px;border-radius:1px;height:8px;box-shadow:0 0 2px #0009;background:#fff;transform:translate(-2px)}.color-hue-horizontal[_ngcontent-%COMP%]{background:linear-gradient(to right,#f00 0%,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,#f00 100%)}.color-hue-vertical[_ngcontent-%COMP%]{background:linear-gradient(to top,#f00 0%,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,#f00 100%)}"],changeDetection:0})}return i})(),Nue=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=o.$C({type:i});static \u0275inj=o.G2t({imports:[os,Bz]})}return i})(),Bue=(()=>{class i{hsl;hsv;radius;pointer;circle;onChange=new o.bkB;background;pointerTop;pointerLeft;ngOnChanges(){this.background=`hsl(${this.hsl.h}, 100%, 50%)`,this.pointerTop=-100*this.hsv.v+1+100+"%",this.pointerLeft=100*this.hsv.s+"%"}handleChange({top:e,left:n,containerHeight:r,containerWidth:l,$event:m}){n<0?n=0:n>l?n=l:e<0?e=0:e>r&&(e=r);let A=-e/r+1;A=A>0?A:0,A=A>1?1:A,this.onChange.emit({data:{h:this.hsl.h,s:n/l,v:A,a:this.hsl.a,source:"hsva"},$event:m})}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=o.VBU({type:i,selectors:[["color-saturation"]],inputs:{hsl:"hsl",hsv:"hsv",radius:"radius",pointer:"pointer",circle:"circle"},outputs:{onChange:"onChange"},features:[o.OA$],decls:5,vars:8,consts:[["ngx-color-coordinates","",1,"color-saturation",3,"coordinatesChange"],[1,"saturation-white"],[1,"saturation-black"],[1,"saturation-pointer",3,"ngStyle"],[1,"saturation-circle",3,"ngStyle"]],template:function(n,r){1&n&&(o.j41(0,"div",0),o.bIt("coordinatesChange",function(m){return r.handleChange(m)}),o.j41(1,"div",1),o.nrm(2,"div",2),o.j41(3,"div",3),o.nrm(4,"div",4),o.k0s()()()),2&n&&(o.xc7("background",r.background),o.R7$(3),o.xc7("top",r.pointerTop)("left",r.pointerLeft),o.Y8G("ngStyle",r.pointer),o.R7$(),o.Y8G("ngStyle",r.circle))},dependencies:[mc,Nz],styles:[".saturation-white[_ngcontent-%COMP%]{background:linear-gradient(to right,#fff,rgba(255,255,255,0));position:absolute;inset:0}.saturation-black[_ngcontent-%COMP%]{background:linear-gradient(to top,#000,rgba(0,0,0,0));position:absolute;inset:0}.color-saturation[_ngcontent-%COMP%]{position:absolute;inset:0}.saturation-pointer[_ngcontent-%COMP%]{position:absolute;cursor:default}.saturation-circle[_ngcontent-%COMP%]{width:4px;height:4px;box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px #0000004d,0 0 1px 2px #0006;border-radius:50%;cursor:hand;transform:translate(-2px,-4px)}"],changeDetection:0})}return i})(),Vue=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=o.$C({type:i});static \u0275inj=o.G2t({imports:[os,Bz]})}return i})();const jb=(i,t)=>({input:i,label:t});function zue(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",11)(1,"color-editable-input",12),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.handleChange(r))}),o.k0s()()}if(2&i){const e=o.XpG();o.R7$(),o.Aen(o.l_i(3,jb,e.input,e.label)),o.Y8G("value",e.hex)}}function Uue(i,t){if(1&i){const e=o.RV6();o.j41(0,"color-editable-input",17),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.handleChange(r))}),o.k0s()}if(2&i){const e=o.XpG(2);o.Aen(o.l_i(4,jb,e.input,e.label)),o.Y8G("value",e.rgb.a)("arrowOffset",.01)}}function jue(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",11)(1,"color-editable-input",13),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.handleChange(r))}),o.k0s()(),o.j41(2,"div",11)(3,"color-editable-input",14),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.handleChange(r))}),o.k0s()(),o.j41(4,"div",11)(5,"color-editable-input",15),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.handleChange(r))}),o.k0s()(),o.j41(6,"div",11),o.DNE(7,Uue,1,7,"color-editable-input",16),o.k0s()}if(2&i){const e=o.XpG();o.R7$(),o.Aen(o.l_i(10,jb,e.input,e.label)),o.Y8G("value",e.rgb.r),o.R7$(2),o.Aen(o.l_i(13,jb,e.input,e.label)),o.Y8G("value",e.rgb.g),o.R7$(2),o.Aen(o.l_i(16,jb,e.input,e.label)),o.Y8G("value",e.rgb.b),o.R7$(2),o.Y8G("ngIf",!e.disableAlpha)}}function Gue(i,t){if(1&i){const e=o.RV6();o.j41(0,"color-editable-input",17),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.handleChange(r))}),o.k0s()}if(2&i){const e=o.XpG(2);o.Aen(o.l_i(4,jb,e.input,e.label)),o.Y8G("value",e.hsl.a)("arrowOffset",.01)}}function Hue(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",11)(1,"color-editable-input",18),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.handleChange(r))}),o.k0s()(),o.j41(2,"div",11)(3,"color-editable-input",19),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.handleChange(r))}),o.k0s()(),o.j41(4,"div",11)(5,"color-editable-input",20),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.handleChange(r))}),o.k0s()(),o.j41(6,"div",11),o.DNE(7,Gue,1,7,"color-editable-input",16),o.k0s()}if(2&i){const e=o.XpG();o.R7$(),o.Aen(o.l_i(10,jb,e.input,e.label)),o.Y8G("value",e.round(e.hsl.h)),o.R7$(2),o.Aen(o.l_i(13,jb,e.input,e.label)),o.Y8G("value",e.round(100*e.hsl.s)+"%"),o.R7$(2),o.Aen(o.l_i(16,jb,e.input,e.label)),o.Y8G("value",e.round(100*e.hsl.l)+"%"),o.R7$(2),o.Y8G("ngIf",!e.disableAlpha)}}function $ue(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",12)(1,"color-alpha",13),o.bIt("onChange",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.handleValueChange(r))}),o.k0s()()}if(2&i){const e=o.XpG();o.R7$(),o.Y8G("radius",2)("rgb",e.rgb)("hsl",e.hsl)("pointer",e.pointer)}}let Wue=(()=>{class i{disableAlpha;hsl;rgb;hex;onChange=new o.bkB;view="";input={fontSize:"11px",color:"#333",width:"100%",borderRadius:"2px",border:"none",boxShadow:"inset 0 0 0 1px #dadada",height:"21px","text-align":"center"};label={"text-transform":"uppercase",fontSize:"11px","line-height":"11px",color:"#969696","text-align":"center",display:"block",marginTop:"12px"};ngOnInit(){1===this.hsl.a&&"hex"!==this.view?this.view="hex":"rgb"!==this.view&&"hsl"!==this.view&&(this.view="rgb")}toggleViews(){"hex"===this.view?this.view="rgb":"rgb"===this.view?this.view="hsl":"hsl"===this.view&&(this.view=1===this.hsl.a?"hex":"rgb")}round(e){return Math.round(e)}handleChange({data:e,$event:n}){if(e.hex){if(function Rue(i){return new Ub(i).isValid}(e.hex)){const r=new Ub(e.hex);this.onChange.emit({data:{hex:this.disableAlpha?r.toHex():r.toHex8(),source:"hex"},$event:n})}}else if(e.r||e.g||e.b)this.onChange.emit({data:{r:e.r||this.rgb.r,g:e.g||this.rgb.g,b:e.b||this.rgb.b,source:"rgb"},$event:n});else if(e.a)e.a<0?e.a=0:e.a>1&&(e.a=1),this.disableAlpha&&(e.a=1),this.onChange.emit({data:{h:this.hsl.h,s:this.hsl.s,l:this.hsl.l,a:Math.round(100*e.a)/100,source:"rgb"},$event:n});else if(e.h||e.s||e.l){const r=e.s&&e.s.replace("%",""),l=e.l&&e.l.replace("%","");this.onChange.emit({data:{h:e.h||this.hsl.h,s:Number(r||this.hsl.s),l:Number(l||this.hsl.l),source:"hsl"},$event:n})}}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=o.VBU({type:i,selectors:[["color-chrome-fields"]],inputs:{disableAlpha:"disableAlpha",hsl:"hsl",rgb:"rgb",hex:"hex"},outputs:{onChange:"onChange"},decls:13,vars:3,consts:[["icon",""],["iconUp",""],["iconDown",""],[1,"chrome-wrap"],[1,"chrome-fields"],[3,"ngIf"],[1,"chrome-toggle"],[1,"chrome-icon",3,"click"],["viewBox","0 0 24 24",1,"chrome-toggle-svg"],["fill","#333","d","M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z"],["fill","#333","d","M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15Z"],[1,"chrome-field"],["label","hex",3,"onChange","value"],["label","r",3,"onChange","value"],["label","g",3,"onChange","value"],["label","b",3,"onChange","value"],["label","a",3,"style","value","arrowOffset","onChange",4,"ngIf"],["label","a",3,"onChange","value","arrowOffset"],["label","h",3,"onChange","value"],["label","s",3,"onChange","value"],["label","l",3,"onChange","value"]],template:function(n,r){if(1&n){const l=o.RV6();o.j41(0,"div",3)(1,"div",4),o.DNE(2,zue,2,6,"ng-template",5)(3,jue,8,19,"ng-template",5)(4,Hue,8,19,"ng-template",5),o.k0s(),o.j41(5,"div",6)(6,"div",7,0),o.bIt("click",function(){return o.eBV(l),o.Njj(r.toggleViews())}),o.qSk(),o.j41(8,"svg",8),o.nrm(9,"path",9,1)(11,"path",10,2),o.k0s()()()()}2&n&&(o.R7$(2),o.Y8G("ngIf","hex"===r.view),o.R7$(),o.Y8G("ngIf","rgb"===r.view),o.R7$(),o.Y8G("ngIf","hsl"===r.view))},dependencies:[fc,Oue],styles:[".chrome-wrap[_ngcontent-%COMP%]{padding-top:16px;display:flex}.chrome-fields[_ngcontent-%COMP%]{flex:1;display:flex;margin-left:-6px}.chrome-field[_ngcontent-%COMP%]{padding-left:6px;width:100%}.chrome-toggle[_ngcontent-%COMP%]{width:32px;text-align:right;position:relative}.chrome-icon[_ngcontent-%COMP%]{margin-right:-4px;margin-top:12px;cursor:pointer;position:relative}.chrome-toggle-svg[_ngcontent-%COMP%]{width:24px;height:24px;border:1px transparent solid;border-radius:5px}.chrome-toggle-svg[_ngcontent-%COMP%]:hover{background:#eee}"],changeDetection:0})}return i})(),Xue=(()=>{class i extends D7{disableAlpha=!1;circle={width:"12px",height:"12px",borderRadius:"6px",boxShadow:"rgb(255, 255, 255) 0px 0px 0px 1px inset",transform:"translate(-6px, -8px)"};pointer={width:"12px",height:"12px",borderRadius:"6px",transform:"translate(-6px, -2px)",backgroundColor:"rgb(248, 248, 248)",boxShadow:"0 1px 4px 0 rgba(0, 0, 0, 0.37)"};activeBackground;constructor(){super()}afterValidChange(){this.activeBackground=`rgba(${this.rgb.r}, ${this.rgb.g}, ${this.rgb.b}, ${this.disableAlpha?1:this.rgb.a})`}handleValueChange({data:e,$event:n}){this.handleChange(e,n)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=o.VBU({type:i,selectors:[["color-chrome"]],inputs:{disableAlpha:"disableAlpha"},features:[o.Jv_([{provide:Ya,useExisting:(0,o.Rfq)(()=>i),multi:!0},{provide:D7,useExisting:(0,o.Rfq)(()=>i)}]),o.Vt3],decls:14,vars:16,consts:[[1,"saturation"],[3,"onChange","hsl","hsv","circle"],[1,"chrome-body"],[1,"chrome-controls"],[1,"chrome-color"],[1,"chrome-swatch"],[1,"chrome-active"],[1,"chrome-toggles"],[1,"chrome-hue"],[3,"onChange","radius","hsl","pointer"],["class","chrome-alpha",4,"ngIf"],[3,"onChange","rgb","hsl","hex","disableAlpha"],[1,"chrome-alpha"],[3,"onChange","radius","rgb","hsl","pointer"]],template:function(n,r){1&n&&(o.j41(0,"div")(1,"div",0)(2,"color-saturation",1),o.bIt("onChange",function(m){return r.handleValueChange(m)}),o.k0s()(),o.j41(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5),o.nrm(7,"div",6)(8,"color-checkboard"),o.k0s()(),o.j41(9,"div",7)(10,"div",8)(11,"color-hue",9),o.bIt("onChange",function(m){return r.handleValueChange(m)}),o.k0s()(),o.DNE(12,$ue,2,4,"div",10),o.k0s()(),o.j41(13,"color-chrome-fields",11),o.bIt("onChange",function(m){return r.handleValueChange(m)}),o.k0s()()()),2&n&&(o.ZvI("chrome-picker ",r.className,""),o.R7$(2),o.Y8G("hsl",r.hsl)("hsv",r.hsv)("circle",r.circle),o.R7$(5),o.xc7("background",r.activeBackground),o.R7$(4),o.Y8G("radius",2)("hsl",r.hsl)("pointer",r.pointer),o.R7$(),o.Y8G("ngIf",!r.disableAlpha),o.R7$(),o.Y8G("rgb",r.rgb)("hsl",r.hsl)("hex",r.hex)("disableAlpha",r.disableAlpha))},dependencies:()=>[fc,kue,S7,Fue,Bue,Wue],styles:[".chrome-picker[_ngcontent-%COMP%]{background:#fff;border-radius:2px;box-shadow:0 0 2px #0000004d,0 4px 8px #0000004d;box-sizing:initial;width:225px;font-family:Menlo}.chrome-controls[_ngcontent-%COMP%]{display:flex}.chrome-color[_ngcontent-%COMP%]{width:42px}.chrome-body[_ngcontent-%COMP%]{padding:14px 14px 12px}.chrome-active[_ngcontent-%COMP%]{position:absolute;inset:0;border-radius:20px;box-shadow:inset 0 0 0 1px #0000001a;z-index:2}.chrome-swatch[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:15px;position:relative;overflow:hidden}.saturation[_ngcontent-%COMP%]{width:100%;padding-bottom:55%;position:relative;border-radius:2px 2px 0 0;overflow:hidden}.chrome-toggles[_ngcontent-%COMP%]{flex:1}.chrome-hue[_ngcontent-%COMP%]{height:10px;position:relative;margin-bottom:8px}.chrome-alpha[_ngcontent-%COMP%]{height:10px;position:relative}"],changeDetection:0})}return i})(),k7=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=o.$C({type:i});static \u0275inj=o.G2t({imports:[os,Iue,M7,Lue,Nue,Vue]})}return i})();const hg=new o.nKC("");function Cx(i){return null==i||("string"==typeof i||Array.isArray(i))&&0===i.length}function P7(i){return null!=i&&"number"==typeof i.length}const td=new o.nKC(""),Que=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Jue{static min(t){return function O7(i){return t=>{if(Cx(t.value)||Cx(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<i?{min:{min:i,actual:t.value}}:null}}(t)}static max(t){return function L7(i){return t=>{if(Cx(t.value)||Cx(i))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>i?{max:{max:i,actual:t.value}}:null}}(t)}static required(t){return function F7(i){return Cx(i.value)?{required:!0}:null}(t)}static requiredTrue(t){return function N7(i){return!0===i.value?null:{required:!0}}(t)}static email(t){return function B7(i){return Cx(i.value)||Que.test(i.value)?null:{email:!0}}(t)}static minLength(t){return function V7(i){return t=>Cx(t.value)||!P7(t.value)?null:t.value.length<i?{minlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function z7(i){return t=>P7(t.value)&&t.value.length>i?{maxlength:{requiredLength:i,actualLength:t.value.length}}:null}(t)}static pattern(t){return function U7(i){if(!i)return YO;let t,e;return"string"==typeof i?(e="","^"!==i.charAt(0)&&(e+="^"),e+=i,"$"!==i.charAt(i.length-1)&&(e+="$"),t=new RegExp(e)):(e=i.toString(),t=i),n=>{if(Cx(n.value))return null;const r=n.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}(t)}static nullValidator(t){return null}static compose(t){return function X7(i){if(!i)return null;const t=i.filter(j7);return 0==t.length?null:function(e){return H7($7(e,t))}}(t)}static composeAsync(t){return function q7(i){if(!i)return null;const t=i.filter(j7);return 0==t.length?null:function(e){return uu($7(e,t).map(G7)).pipe((0,st.T)(H7))}}(t)}}function YO(i){return null}function j7(i){return null!=i}function G7(i){return(0,o.jNT)(i)?Pn(i):i}function H7(i){let t={};return i.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function $7(i,t){return t.map(e=>e(i))}function Whe(i,t){}function Xhe(i,t){if(1&i&&o.DNE(0,Whe,0,0,"ng-template",0),2&i){const e=o.XpG();o.Y8G("ngTemplateOutlet",e.picker.content)}}function qhe(i,t){if(1&i){const e=o.RV6();o.j41(0,"color-chrome",2),o.bIt("onChangeComplete",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.picker.select(l.getColorString(r)))}),o.k0s()}if(2&i){const e=o.XpG();o.Y8G("color",e.picker.selected)}}Promise.resolve(),Promise.resolve();const Yhe=["button"],Zhe=[[["","mtxColorpickerToggleIcon",""]]],Khe=["[mtxColorpickerToggleIcon]"];function Qhe(i,t){1&i&&(o.qSk(),o.j41(0,"svg",2),o.nrm(1,"path",3),o.k0s())}const Jhe={transformPanel:js("transformPanel",[oo("void => enter-dropdown",co("120ms cubic-bezier(0, 0, 0.2, 1)",pb([gn({opacity:0,transform:"scale(1, 0.8)"}),gn({opacity:1,transform:"scale(1, 1)"})]))),oo("* => void",co("100ms linear",gn({opacity:0})))])};let efe=0;const PW=new o.nKC("mtx-colorpicker-scroll-strategy",{providedIn:"root",factory:()=>{const i=(0,o.WQX)(_l);return()=>i.scrollStrategies.reposition()}}),ife={provide:PW,deps:[_l],useFactory:function tfe(i){return()=>i.scrollStrategies.reposition()}};let OW=(()=>{class i{constructor(e){this._changeDetectorRef=e,this._animationState="enter-dropdown",this._animationDone=new xi.B}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}ngOnDestroy(){this._animationDone.complete()}getColorString(e){return{hex:1===e.color.rgb.a?e.color.hex:new Ub(e.color.rgb).toHex8String(),rgb:new Ub(e.color.rgb).toRgbString(),hsl:new Ub(e.color.hsl).toHslString(),hsv:new Ub(e.color.hsv).toHsvString()}[this.picker.format]}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mtx-colorpicker-content"]],hostAttrs:[1,"mtx-colorpicker-content"],hostVars:3,hostBindings:function(n,r){1&n&&o.Kam("@transformPanel.done",function(){return r._animationDone.next()}),2&n&&(o.zvX("@transformPanel",r._animationState),o.HbH(r.color?"mat-"+r.color:""))},inputs:{color:"color"},exportAs:["mtxColorpickerContent"],standalone:!0,features:[o.aNF],decls:2,vars:1,consts:[[3,"ngTemplateOutlet"],[3,"color"],[3,"onChangeComplete","color"]],template:function(n,r){1&n&&o.DNE(0,Xhe,1,1,null,0)(1,qhe,1,1,"color-chrome",1),2&n&&o.vxM(r.picker.content?0:1)},dependencies:[k7,Xue,Nc],styles:[".mtx-colorpicker-content{display:block;border-radius:4px}\n"],encapsulation:2,data:{animation:[Jhe.transformPanel]},changeDetection:0})}}return i})(),nfe=(()=>{class i{get disabled(){return void 0===this._disabled&&this.pickerInput?this.pickerInput.disabled:!!this._disabled}set disabled(e){e!==this._disabled&&(this._disabled=e,this._disabledChange.next(e))}get opened(){return this._opened}set opened(e){e?this.open():this.close()}get color(){return this._color||(this.pickerInput?this.pickerInput.getThemePalette():void 0)}set color(e){this._color=e}get format(){return this._format||this.pickerInput.format}set format(e){this._format=e}get selected(){return this._validSelected}set selected(e){this._validSelected=e}constructor(e,n,r,l,m,C){this._overlay=e,this._ngZone=n,this._viewContainerRef=r,this._dir=m,this._document=C,this._inputStateChanges=On.yU.EMPTY,this.openedStream=new o.bkB,this.closedStream=new o.bkB,this.xPosition="start",this.yPosition="below",this.restoreFocus=!0,this._opened=!1,this.id="mtx-colorpicker-"+efe++,this._validSelected="",this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this._disabledChange=new xi.B,this._selectedChanged=new xi.B,this._scrollStrategy=l}ngOnChanges(){}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this._disabledChange.complete()}select(e){this.selected=e,this._selectedChanged.next(e)}registerInput(e){if(this.pickerInput)throw Error("A Colorpicker can only be associated with a single input.");this.pickerInput=e,this._inputStateChanges=e._valueChange.subscribe(n=>this.selected=n)}open(){if(!this._opened&&!this.disabled){if(!this.pickerInput)throw Error("Attempted to open an Colorpicker with no associated input.");this._document&&(this._focusedElementBeforeOpen=this._document.activeElement),this._openOverlay(),this._opened=!0,this.openedStream.emit()}}close(){if(!this._opened)return;if(this._componentRef){const n=this._componentRef.instance;n._startExitAnimation(),n._animationDone.pipe(gs(1)).subscribe(()=>this._destroyOverlay())}const e=()=>{this._opened&&(this._opened=!1,this.closedStream.emit(),this._focusedElementBeforeOpen=null)};this.restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus?(this._focusedElementBeforeOpen.focus(),setTimeout(e)):e()}_forwardContentValues(e){e.picker=this,e.color=this.color}_openOverlay(){this._destroyOverlay();const e=this.pickerInput.getOverlayLabelId(),n=new xS(OW,this._viewContainerRef),r=this._overlayRef=this._overlay.create(new CS({positionStrategy:this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:["mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:this._scrollStrategy(),panelClass:"mtx-colorpicker-popup"})),l=r.overlayElement;l.setAttribute("role","dialog"),e&&l.setAttribute("aria-labelledby",e),this._getCloseStream(r).subscribe(m=>{m&&m.preventDefault(),this.close()}),this._componentRef=r.attach(n),this._forwardContentValues(this._componentRef.instance),this._ngZone.onStable.pipe(gs(1)).subscribe(()=>r.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDropdownStrategy(){const e=this._overlay.position().flexibleConnectedTo(this.pickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mtx-colorpicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(e)}_setConnectedPositions(e){const n="end"===this.xPosition?"end":"start",r="start"===n?"end":"start",l="above"===this.yPosition?"bottom":"top",m="top"===l?"bottom":"top";return e.withPositions([{originX:n,originY:m,overlayX:n,overlayY:l},{originX:n,originY:l,overlayX:n,overlayY:m},{originX:r,originY:m,overlayX:r,overlayY:l},{originX:r,originY:l,overlayX:r,overlayY:m}])}_getCloseStream(e){return Io(e.backdropClick(),e.detachments(),e.keydownEvents().pipe(Ur(n=>27===n.keyCode&&!oa(n)||this.pickerInput&&oa(n,"altKey")&&38===n.keyCode)))}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(_l),o.rXU(o.SKi),o.rXU(o.c1b),o.rXU(PW),o.rXU(Us,8),o.rXU(Nn,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mtx-colorpicker"]],inputs:{content:"content",disabled:[2,"disabled","disabled",o.L39],xPosition:"xPosition",yPosition:"yPosition",restoreFocus:[2,"restoreFocus","restoreFocus",o.L39],opened:[2,"opened","opened",o.L39],color:"color",format:"format"},outputs:{openedStream:"opened",closedStream:"closed"},exportAs:["mtxColorpicker"],standalone:!0,features:[o.GFd,o.OA$,o.aNF],decls:0,vars:0,template:function(n,r){},encapsulation:2,changeDetection:0})}}return i})();class rL{constructor(t,e){this.target=t,this.targetElement=e,this.value=this.target.value}}const rfe={provide:hg,useExisting:(0,o.Rfq)(()=>l4),multi:!0},ofe={provide:td,useExisting:(0,o.Rfq)(()=>l4),multi:!0};let l4=(()=>{class i{set mtxColorpicker(e){e&&(this._picker=e,this._picker.registerInput(this),this._pickerSubscription.unsubscribe(),this._pickerSubscription=this._picker._selectedChanged.subscribe(n=>{this.value=n,this._cvaOnChange(n),this._onTouched(),this.colorInput.emit(new rL(this,this._elementRef.nativeElement)),this.colorChange.emit(new rL(this,this._elementRef.nativeElement))}))}get disabled(){return!!this._disabled}set disabled(e){const n=this._elementRef.nativeElement;this._disabled!==e&&(this._disabled=e,this._disabledChange.emit(e)),e&&this._isInitialized&&n.blur&&n.blur()}get value(){return this._value}set value(e){this._value=e,this._formatValue(e),this._valueChange.emit(e)}constructor(e,n){this._elementRef=e,this._formField=n,this.format="hex",this.colorChange=new o.bkB,this.colorInput=new o.bkB,this._disabledChange=new o.bkB,this._valueChange=new o.bkB,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._pickerSubscription=On.yU.EMPTY,this._validator=Jue.compose([]),this._lastValueValid=!1}ngAfterViewInit(){this._isInitialized=!0}ngOnDestroy(){this._pickerSubscription.unsubscribe(),this._valueChange.complete(),this._disabledChange.complete()}registerOnValidatorChange(e){this._validatorOnChange=e}validate(e){return this._validator?this._validator(e):null}getPopupConnectionElementRef(){return this.getConnectedOverlayOrigin()}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}writeValue(e){this.value=e}registerOnChange(e){this._cvaOnChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_onKeydown(e){this._picker&&e.altKey&&40===e.keyCode&&!this._elementRef.nativeElement.readOnly&&(this._picker.open(),e.preventDefault())}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_onInput(e){const n=e;this._value=n,this._cvaOnChange(n),this._valueChange.emit(n),this.colorInput.emit(new rL(this,this._elementRef.nativeElement))}_onChange(){this.colorChange.emit(new rL(this,this._elementRef.nativeElement))}getThemePalette(){return this._formField?this._formField.color:void 0}_formatValue(e){this._elementRef.nativeElement.value=e||""}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(Lk,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["input","mtxColorpicker",""]],hostAttrs:[1,"mtx-colorpicker-input"],hostVars:3,hostBindings:function(n,r){1&n&&o.bIt("input",function(m){return r._onInput(m.target.value)})("change",function(){return r._onChange()})("blur",function(){return r._onBlur()})("keydown",function(m){return r._onKeydown(m)}),2&n&&(o.Mr5("disabled",r.disabled),o.BMQ("aria-haspopup",r._picker?"dialog":null)("aria-owns",(null==r._picker?null:r._picker.opened)&&r._picker.id||null))},inputs:{mtxColorpicker:"mtxColorpicker",disabled:[2,"disabled","disabled",o.L39],value:"value",format:"format"},outputs:{colorChange:"colorChange",colorInput:"colorInput"},exportAs:["mtxColorpickerInput"],standalone:!0,features:[o.Jv_([rfe,ofe,{provide:uz,useExisting:i}]),o.GFd]})}}return i})(),sfe=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","mtxColorpickerToggleIcon",""]],standalone:!0})}}return i})(),LW=(()=>{class i{get disabled(){return null==this._disabled&&this.picker?this.picker.disabled:!!this._disabled}set disabled(e){this._disabled=e}constructor(e,n){this._changeDetectorRef=e,this._stateChanges=On.yU.EMPTY;const r=Number(n);this.tabIndex=r||0===r?r:null}ngOnChanges(e){e.picker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.picker&&!this.disabled&&(this.picker.open(),e.stopPropagation())}_watchStateChanges(){const e=this.picker?this.picker._disabledChange:di(),n=this.picker&&this.picker.pickerInput?this.picker.pickerInput._disabledChange:di(),r=this.picker?Io(this.picker.openedStream,this.picker.closedStream):di();this._stateChanges.unsubscribe(),this._stateChanges=Io(e,n,r).subscribe(()=>this._changeDetectorRef.markForCheck())}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.kS0("tabindex"))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mtx-colorpicker-toggle"]],contentQueries:function(n,r,l){if(1&n&&o.wni(l,sfe,5),2&n){let m;o.mGM(m=o.lsd())&&(r._customIcon=m.first)}},viewQuery:function(n,r){if(1&n&&o.GBs(Yhe,5),2&n){let l;o.mGM(l=o.lsd())&&(r._button=l.first)}},hostAttrs:[1,"mtx-colorpicker-toggle"],hostVars:7,hostBindings:function(n,r){1&n&&o.bIt("click",function(m){return r._open(m)}),2&n&&(o.BMQ("tabindex",null),o.AVh("mtx-colorpicker-toggle-active",r.picker&&r.picker.opened)("mat-accent",r.picker&&"accent"===r.picker.color)("mat-warn",r.picker&&"warn"===r.picker.color))},inputs:{picker:[0,"for","picker"],tabIndex:"tabIndex",ariaLabel:[0,"aria-label","ariaLabel"],disabled:[2,"disabled","disabled",o.L39],disableRipple:[2,"disableRipple","disableRipple",o.L39]},exportAs:["mtxColorpickerToggle"],standalone:!0,features:[o.GFd,o.OA$,o.aNF],ngContentSelectors:Khe,decls:4,vars:6,consts:[["button",""],["mat-icon-button","","type","button",3,"disabled","disableRipple"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false",1,"mtx-colorpicker-toggle-default-icon"],["d","M17.5,12A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 17.5,9A1.5,1.5 0 0,1 19,10.5A1.5,1.5 0 0,1 17.5,12M14.5,8A1.5,1.5 0 0,1 13,6.5A1.5,1.5 0 0,1 14.5,5A1.5,1.5 0 0,1 16,6.5A1.5,1.5 0 0,1 14.5,8M9.5,8A1.5,1.5 0 0,1 8,6.5A1.5,1.5 0 0,1 9.5,5A1.5,1.5 0 0,1 11,6.5A1.5,1.5 0 0,1 9.5,8M6.5,12A1.5,1.5 0 0,1 5,10.5A1.5,1.5 0 0,1 6.5,9A1.5,1.5 0 0,1 8,10.5A1.5,1.5 0 0,1 6.5,12M12,3A9,9 0 0,0 3,12A9,9 0 0,0 12,21A1.5,1.5 0 0,0 13.5,19.5C13.5,19.11 13.35,18.76 13.11,18.5C12.88,18.23 12.73,17.88 12.73,17.5A1.5,1.5 0 0,1 14.23,16H16A5,5 0 0,0 21,11C21,6.58 16.97,3 12,3Z"]],template:function(n,r){1&n&&(o.NAR(Zhe),o.j41(0,"button",1,0),o.DNE(2,Qhe,2,0,":svg:svg",2),o.SdG(3),o.k0s()),2&n&&(o.Y8G("disabled",r.disabled)("disableRipple",r.disableRipple),o.BMQ("aria-haspopup",r.picker?"dialog":null)("aria-label",r.ariaLabel)("tabindex",r.disabled?-1:r.tabIndex),o.R7$(2),o.vxM(r._customIcon?-1:2))},dependencies:[mu],styles:[".mtx-colorpicker-toggle{pointer-events:auto;color:var(--mtx-colorpicker-toggle-icon-color)}.mtx-colorpicker-toggle-active{color:var(--mtx-colorpicker-toggle-active-state-icon-color)}.cdk-high-contrast-active .mtx-colorpicker-toggle-default-icon{color:CanvasText}\n"],encapsulation:2,changeDetection:0})}}return i})(),afe=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[ife],imports:[os,ES,ec,JP,ea,k7,OW,LW]})}}return i})();const lfe=(i,t)=>t.value;function cfe(i,t){if(1&i&&(o.nrm(0,"mat-divider"),o.j41(1,"mat-option",20),o.EFF(2),o.k0s()),2&i){const e=t.$implicit;o.R7$(),o.Y8G("value",e),o.R7$(),o.JRh(e)}}function dfe(i,t){1&i&&(o.j41(0,"mat-option",20),o.EFF(1,"-"),o.k0s()),2&i&&o.Y8G("value",null)}function ufe(i,t){1&i&&(o.j41(0,"mat-error"),o.EFF(1,"No Sensor Selected."),o.k0s())}function hfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"th",35)(1,"mat-checkbox",36),o.bIt("change",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(r?l.toggleAllRows():null)}),o.k0s()()}if(2&i){const e=o.XpG(2);o.R7$(),o.Y8G("checked",e.hasValue()&&e.isAllSelected())("disabled","loaded"!==e.TableState())("indeterminate",e.hasValue()&&!e.isAllSelected())}}function ffe(i,t){if(1&i){const e=o.RV6();o.j41(0,"td",37)(1,"mat-checkbox",38),o.bIt("click",function(r){return o.eBV(e),o.Njj(r.stopPropagation())})("change",function(){const r=o.eBV(e).index,l=o.XpG(2);return o.Njj(l.toggleRow(r))}),o.k0s()()}if(2&i){const e=t.index;o.R7$(),o.Y8G("formControlName",e)("id",e)}}function mfe(i,t){if(1&i&&(o.j41(0,"td",39)(1,"button",40),o.EFF(2," Submit "),o.k0s()()),2&i){const e=o.XpG(2);o.R7$(),o.Y8G("disabled","loaded"!==e.TableState()||e.eventForm.invalid)}}function pfe(i,t){1&i&&(o.j41(0,"th",41)(1,"div",42)(2,"span"),o.EFF(3,"Animals"),o.k0s(),o.nrm(4,"mat-icon",43),o.k0s()())}function gfe(i,t){if(1&i&&(o.j41(0,"td",44)(1,"p"),o.EFF(2),o.k0s()()),2&i){let e;const n=t.index,r=o.XpG(2);o.R7$(2),o.JRh(null!==(e=null==(e=r.getIndividual(n)())?null:e.LocalIdentifier)&&void 0!==e?e:"N/A")}}function _fe(i,t){1&i&&o.nrm(0,"td",39)}function vfe(i,t){1&i&&o.nrm(0,"tr",45)}function bfe(i,t){1&i&&o.nrm(0,"tr",46)}function yfe(i,t){1&i&&o.nrm(0,"tr",47)}function xfe(i,t){1&i&&o.nrm(0,"mat-progress-bar",26)}function wfe(i,t){1&i&&o.EFF(0," Pixel(s) ")}function Cfe(i,t){1&i&&o.EFF(0," Meter(s) ")}function Efe(i,t){1&i&&o.EFF(0," 100% ")}function Tfe(i,t){if(1&i&&(o.j41(0,"span"),o.EFF(1),o.k0s()),2&i){let e;const n=o.XpG(3);o.R7$(),o.SpI("",100*(null!==(e=n.pathForms.value.opacity)&&void 0!==e?e:0),"%")}}function Sfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",48)(1,"mat-form-field",49)(2,"mat-label"),o.EFF(3,"Units"),o.k0s(),o.j41(4,"mat-select",50,1),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pathControlChange(r,"widthUnits"))}),o.j41(6,"mat-option",51),o.EFF(7,"meters"),o.k0s(),o.j41(8,"mat-option",52),o.EFF(9,"pixels"),o.k0s()()(),o.j41(10,"mat-form-field",53)(11,"mat-label"),o.EFF(12,"Tooltip Visibility"),o.k0s(),o.j41(13,"mat-select",54),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pathControlChange(r,"toggleTooltip"))}),o.j41(14,"mat-option",20),o.EFF(15,"off"),o.k0s(),o.j41(16,"mat-option",20),o.EFF(17,"on"),o.k0s()()()(),o.j41(18,"div",55)(19,"span"),o.EFF(20,"Width:"),o.k0s(),o.j41(21,"span"),o.EFF(22),o.DNE(23,wfe,1,0)(24,Cfe,1,0),o.k0s()(),o.j41(25,"mat-slider",56)(26,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pathControlChange(r,"widthScale"))}),o.k0s()(),o.j41(27,"div",55)(28,"span"),o.EFF(29,"Minimum Width:"),o.k0s(),o.j41(30,"span"),o.EFF(31),o.k0s()(),o.j41(32,"mat-slider",56)(33,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pathControlChange(r,"widthMinPixels"))}),o.k0s()(),o.j41(34,"div",55)(35,"span"),o.EFF(36,"Opacity:"),o.k0s(),o.DNE(37,Efe,1,0)(38,Tfe,2,1,"span"),o.k0s(),o.j41(39,"mat-slider",58)(40,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pathControlChange(r,"opacity"))}),o.k0s()()}if(2&i){const e=o.sdS(5),n=o.XpG(2);o.R7$(4),o.Y8G("disabled",void 0===n.currentEventData),o.R7$(9),o.Y8G("disabled",void 0===n.currentEventData),o.R7$(),o.Y8G("value",!1),o.R7$(2),o.Y8G("value",!0),o.R7$(6),o.SpI("",n.pathForms.value.widthScale," "),o.R7$(),o.vxM("pixels"===e.value?23:24),o.R7$(2),o.Y8G("disabled",void 0===n.currentEventData),o.R7$(6),o.SpI("",n.pathForms.value.widthMinPixels," Pixel(s)"),o.R7$(),o.Y8G("disabled",void 0===n.currentEventData),o.R7$(5),o.vxM(1===n.pathForms.value.opacity?37:38),o.R7$(2),o.Y8G("disabled",void 0===n.currentEventData)}}function Mfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"mat-form-field",59)(2,"mat-label"),o.EFF(3,"Units"),o.k0s(),o.j41(4,"mat-select",50,1),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pointControlChange(r,"radiusUnits"))}),o.j41(6,"mat-option",51),o.EFF(7,"meters"),o.k0s(),o.j41(8,"mat-option",52),o.EFF(9,"pixels"),o.k0s()()(),o.j41(10,"mat-form-field",60)(11,"mat-label"),o.EFF(12,"Color"),o.k0s(),o.j41(13,"input",61),o.bIt("colorChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pointControlChange(r.value,"getFillColor",!0))}),o.k0s(),o.nrm(14,"mtx-colorpicker-toggle",62)(15,"mtx-colorpicker",null,2),o.k0s()(),o.j41(17,"div",55)(18,"span"),o.EFF(19,"Radius:"),o.k0s(),o.j41(20,"span"),o.EFF(21),o.k0s()(),o.j41(22,"mat-slider",63)(23,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pointControlChange(r,"getRadius"))}),o.k0s()(),o.j41(24,"div",55)(25,"span"),o.EFF(26,"Opacity:"),o.k0s(),o.j41(27,"span"),o.EFF(28),o.k0s()(),o.j41(29,"mat-slider",64)(30,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pointControlChange(r,"opacity"))}),o.k0s()(),o.j41(31,"div",55)(32,"span"),o.EFF(33,"Minimum Radius Width:"),o.k0s(),o.j41(34,"span"),o.EFF(35),o.k0s()(),o.j41(36,"mat-slider",65)(37,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.pointControlChange(r,"radiusMinPixels"))}),o.k0s()()}if(2&i){let e;const n=o.sdS(16),r=o.XpG(2);o.R7$(4),o.Y8G("disabled",void 0===r.currentEventData),o.R7$(9),o.Y8G("mtxColorpicker",n)("disabled",void 0===r.currentEventData),o.R7$(),o.Y8G("for",n),o.R7$(7),o.JRh(r.pointForms.value.getRadius),o.R7$(),o.Y8G("disabled",void 0===r.currentEventData),o.R7$(6),o.SpI("",100*(null!==(e=r.pointForms.value.opacity)&&void 0!==e?e:0),"%"),o.R7$(),o.Y8G("disabled",void 0===r.currentEventData),o.R7$(6),o.SpI("",r.pointForms.value.radiusMinPixels," Pixel(s)"),o.R7$(),o.Y8G("disabled",void 0===r.currentEventData)}}function Afe(i,t){1&i&&(o.j41(0,"mat-option",72),o.EFF(1,"Min"),o.k0s(),o.j41(2,"mat-option",73),o.EFF(3,"Max"),o.k0s())}function Dfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"span"),o.EFF(2,"Radius:"),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()(),o.j41(5,"mat-slider",74)(6,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(3);return o.Njj(l.aggregationControlChange(r,"radiusPixels"))}),o.k0s()(),o.j41(7,"div",55)(8,"span"),o.EFF(9,"Intensity:"),o.k0s(),o.j41(10,"span"),o.EFF(11),o.k0s()(),o.j41(12,"mat-slider",75)(13,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(3);return o.Njj(l.aggregationControlChange(r,"intensity"))}),o.k0s()(),o.j41(14,"div",55)(15,"span"),o.EFF(16,"Threshold:"),o.k0s(),o.j41(17,"span"),o.EFF(18),o.k0s()(),o.j41(19,"mat-slider",76)(20,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(3);return o.Njj(l.aggregationControlChange(r,"threshold"))}),o.k0s()()}if(2&i){const e=o.XpG(3);o.R7$(4),o.SpI("",e.aggregationForms.controls.radiusPixels.value," pixel(s)"),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.intensity.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.threshold.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData)}}function kfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"span"),o.EFF(2,"Radius:"),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()(),o.j41(5,"mat-slider",77)(6,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(3);return o.Njj(l.aggregationControlChange(r,"radius"))}),o.k0s()(),o.j41(7,"div",55)(8,"span"),o.EFF(9,"Coverage:"),o.k0s(),o.j41(10,"span"),o.EFF(11),o.k0s()(),o.j41(12,"mat-slider",78)(13,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(3);return o.Njj(l.aggregationControlChange(r,"coverage"))}),o.k0s()(),o.j41(14,"div",55)(15,"span"),o.EFF(16,"Upper Percentile:"),o.k0s(),o.j41(17,"span"),o.EFF(18),o.k0s()(),o.j41(19,"mat-slider",79)(20,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(3);return o.Njj(l.aggregationControlChange(r,"upperPercentile"))}),o.k0s()(),o.j41(21,"div",55)(22,"span"),o.EFF(23,"Lower Percentile:"),o.k0s(),o.j41(24,"span"),o.EFF(25),o.k0s()(),o.j41(26,"mat-slider",80)(27,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(3);return o.Njj(l.aggregationControlChange(r,"lowerPercentile"))}),o.k0s()()}if(2&i){const e=o.XpG(3);o.R7$(4),o.JRh(e.aggregationForms.controls.radius.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.coverage.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.upperPercentile.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.lowerPercentile.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData)}}function Ife(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"span"),o.EFF(2,"Cell Size:"),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()(),o.j41(5,"mat-slider",81)(6,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(3);return o.Njj(l.aggregationControlChange(r,"cellSizePixels"))}),o.k0s()()}if(2&i){const e=o.XpG(3);o.R7$(4),o.SpI("",e.aggregationForms.controls.cellSizePixels.value," pixel(s)"),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData)}}function Rfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",66)(1,"mat-form-field",67)(2,"mat-label"),o.EFF(3,"Aggregation Type"),o.k0s(),o.j41(4,"mat-select",68,3)(6,"mat-option",69),o.EFF(7,"Sum"),o.k0s(),o.j41(8,"mat-option",70),o.EFF(9,"Mean"),o.k0s(),o.DNE(10,Afe,4,0),o.k0s()(),o.j41(11,"mat-form-field",71)(12,"mat-label"),o.EFF(13,"Theme"),o.k0s(),o.j41(14,"mat-select",54,4),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.aggregationControlChange(r,"colorRange"))}),o.j41(16,"mat-option",20),o.EFF(17,"theme 1"),o.k0s(),o.j41(18,"mat-option",20),o.EFF(19,"theme 2"),o.k0s(),o.j41(20,"mat-option",20),o.EFF(21,"theme 3"),o.k0s()()()(),o.DNE(22,Dfe,21,6)(23,kfe,28,8)(24,Ife,7,2)}if(2&i){const e=o.XpG(2);o.R7$(4),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.vxM(13===e.currentActiveLayer()?10:-1),o.R7$(4),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(2),o.Y8G("value",e.ColorRangeThemes[0]),o.R7$(2),o.Y8G("value",e.ColorRangeThemes[1]),o.R7$(2),o.Y8G("value",e.ColorRangeThemes[2]),o.R7$(2),o.vxM(5===e.currentActiveLayer()?22:-1),o.R7$(),o.vxM(6===e.currentActiveLayer()?23:-1),o.R7$(),o.vxM(13===e.currentActiveLayer()?24:-1)}}function Pfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-tab-group",5)(1,"mat-tab",7)(2,"button",8),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.closeRightNav())}),o.j41(3,"mat-icon"),o.EFF(4,"close"),o.k0s()(),o.j41(5,"form",9),o.bIt("ngSubmit",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.submitForm())}),o.j41(6,"div",10)(7,"div",11),o.nI1(8,"async"),o.j41(9,"mat-form-field",12)(10,"mat-select",13)(11,"mat-option",14),o.EFF(12,"24 hours between events."),o.k0s(),o.nrm(13,"mat-divider"),o.j41(14,"mat-option",15),o.EFF(15,"50 kilometers between events."),o.k0s(),o.nrm(16,"mat-divider"),o.j41(17,"mat-option",16),o.EFF(18,"Last 30 days."),o.k0s(),o.nrm(19,"mat-divider"),o.j41(20,"mat-option",17),o.EFF(21,"0.25 degrees movement."),o.k0s()()(),o.j41(22,"mat-form-field",18)(23,"mat-select",19),o.Z7z(24,cfe,3,2,null,null,o.fX1,!1,dfe,2,1,"mat-option",20),o.k0s(),o.DNE(27,ufe,2,0,"mat-error"),o.k0s()()(),o.j41(28,"table",21,0),o.EFF(30," Checkbox Column "),o.qex(31,22),o.DNE(32,hfe,2,3,"th",23)(33,ffe,2,2,"td",24)(34,mfe,3,1,"td",25),o.nrm(35,"mat-progress-bar",26),o.bVm(),o.qex(36,27),o.DNE(37,pfe,5,0,"th",28)(38,gfe,3,1,"td",29)(39,_fe,1,0,"td",25),o.bVm(),o.DNE(40,vfe,1,0,"tr",30)(41,bfe,1,0,"tr",31)(42,yfe,1,0,"tr",32),o.k0s()(),o.DNE(43,xfe,1,0,"mat-progress-bar",26),o.k0s(),o.j41(44,"mat-tab",33)(45,"button",8),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.closeRightNav())}),o.j41(46,"mat-icon"),o.EFF(47,"close"),o.k0s()(),o.j41(48,"div",34),o.DNE(49,Sfe,41,11)(50,Mfe,38,10)(51,Rfe,25,9),o.k0s()()()}if(2&i){let e;const n=o.XpG();o.R7$(5),o.Y8G("formGroup",n.eventForm),o.R7$(2),o.Y8G("ngStyle",o.bMT(8,13,n.screenChange)?n.fourthRowSmall:n.fourthRowDefault),o.R7$(17),o.Dyx(n.currentLocationSensors()),o.R7$(3),o.vxM(n.eventForm.dirty&&n.eventForm.hasError("noSensorSelected")?27:-1),o.R7$(),o.Y8G("dataSource",n.tableSource)("trackBy",n.trackById),o.R7$(12),o.Y8G("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),o.R7$(),o.Y8G("matRowDefColumns",n.displayedColumns),o.R7$(),o.Y8G("matFooterRowDef",n.displayedColumns)("matFooterRowDefSticky",!0),o.R7$(),o.vxM("loading"===n.TableState()?43:-1),o.R7$(6),o.vxM("path"===(e=n.currentActiveForms())?49:"point"===e?50:"aggregation"===e?51:-1)}}function Ofe(i,t){if(1&i&&(o.nrm(0,"mat-divider"),o.j41(1,"mat-option",20),o.EFF(2),o.k0s()),2&i){const e=t.$implicit;o.R7$(),o.Y8G("value",e.value),o.R7$(),o.JRh(e.name)}}function Lfe(i,t){if(1&i&&(o.nrm(0,"mat-divider"),o.j41(1,"mat-option",20),o.EFF(2),o.k0s()),2&i){const e=t.$implicit;o.R7$(),o.Y8G("value",e),o.R7$(),o.JRh(e)}}function Ffe(i,t){1&i&&(o.j41(0,"mat-option",20),o.EFF(1,"-"),o.k0s()),2&i&&o.Y8G("value",null)}function Nfe(i,t){1&i&&(o.j41(0,"mat-error"),o.EFF(1,"No Sensor Selected."),o.k0s())}function Bfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"th",35)(1,"mat-checkbox",36),o.bIt("change",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(r?l.toggleAllRows():null)}),o.k0s()()}if(2&i){const e=o.XpG(4);o.R7$(),o.Y8G("checked",e.hasValue()&&e.isAllSelected())("disabled","loaded"!==e.TableState())("indeterminate",e.hasValue()&&!e.isAllSelected())}}function Vfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"td",37)(1,"mat-checkbox",38),o.bIt("click",function(r){return o.eBV(e),o.Njj(r.stopPropagation())})("change",function(){const r=o.eBV(e).index,l=o.XpG(4);return o.Njj(l.toggleRow(r))}),o.k0s()()}if(2&i){const e=t.index;o.R7$(),o.Y8G("formControlName",e)("id",e)}}function zfe(i,t){if(1&i&&(o.j41(0,"td",39)(1,"button",40),o.EFF(2," Submit "),o.k0s()()),2&i){const e=o.XpG(4);o.R7$(),o.Y8G("disabled","loaded"!==e.TableState()||e.eventForm.invalid)}}function Ufe(i,t){1&i&&(o.j41(0,"th",41)(1,"div",42)(2,"span"),o.EFF(3,"Animals"),o.k0s(),o.nrm(4,"mat-icon",43),o.k0s()())}function jfe(i,t){if(1&i&&(o.j41(0,"td",44)(1,"p"),o.EFF(2),o.k0s()()),2&i){let e;const n=t.index,r=o.XpG(4);o.R7$(2),o.JRh(null!==(e=null==(e=r.getIndividual(n)())?null:e.LocalIdentifier)&&void 0!==e?e:"N/A")}}function Gfe(i,t){1&i&&o.nrm(0,"td",39)}function Hfe(i,t){1&i&&o.nrm(0,"tr",45)}function $fe(i,t){1&i&&o.nrm(0,"tr",46)}function Wfe(i,t){1&i&&o.nrm(0,"tr",47)}function Xfe(i,t){1&i&&o.nrm(0,"mat-progress-bar",26)}function qfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-card",83)(1,"form",85),o.bIt("ngSubmit",function(){o.eBV(e);const r=o.XpG(3);return o.Njj(r.submitForm())}),o.j41(2,"div",11),o.nI1(3,"async"),o.j41(4,"mat-form-field",12)(5,"mat-select",86),o.mxI("valueChange",function(r){o.eBV(e);const l=o.XpG(3);return o.DH7(l.selectedEventProfile,r)||(l.selectedEventProfile=r),o.Njj(r)}),o.Z7z(6,Ofe,3,2,null,null,lfe),o.k0s()(),o.j41(8,"mat-form-field",18)(9,"mat-select",19),o.Z7z(10,Lfe,3,2,null,null,o.fX1,!1,Ffe,2,1,"mat-option",20),o.k0s(),o.DNE(13,Nfe,2,0,"mat-error"),o.k0s()(),o.j41(14,"table",87,0),o.EFF(16," Checkbox Column "),o.qex(17,22),o.DNE(18,Bfe,2,3,"th",23)(19,Vfe,2,2,"td",24)(20,zfe,3,1,"td",25),o.nrm(21,"mat-progress-bar",26),o.bVm(),o.qex(22,27),o.DNE(23,Ufe,5,0,"th",28)(24,jfe,3,1,"td",29)(25,Gfe,1,0,"td",25),o.bVm(),o.DNE(26,Hfe,1,0,"tr",30)(27,$fe,1,0,"tr",31)(28,Wfe,1,0,"tr",32),o.k0s()(),o.DNE(29,Xfe,1,0,"mat-progress-bar",26),o.k0s()}if(2&i){const e=o.XpG(3);o.R7$(),o.Y8G("formGroup",e.eventForm),o.R7$(),o.Y8G("ngStyle",o.bMT(3,13,e.screenChange)?e.fourthRowSmall:e.fourthRowDefault),o.R7$(3),o.R50("value",e.selectedEventProfile),o.R7$(),o.Dyx(e.eventProfilesOptions),o.R7$(4),o.Dyx(e.currentLocationSensors()),o.R7$(3),o.vxM(e.eventForm.dirty&&e.eventForm.hasError("noSensorSelected")?13:-1),o.R7$(),o.Y8G("dataSource",e.tableSource)("trackBy",e.trackById),o.R7$(12),o.Y8G("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),o.R7$(),o.Y8G("matRowDefColumns",e.displayedColumns),o.R7$(),o.Y8G("matFooterRowDef",e.displayedColumns)("matFooterRowDefSticky",!0),o.R7$(),o.vxM("loading"===e.TableState()?29:-1)}}function Yfe(i,t){1&i&&o.EFF(0," Pixel(s) ")}function Zfe(i,t){1&i&&o.EFF(0," Meter(s) ")}function Kfe(i,t){1&i&&o.EFF(0," 100% ")}function Qfe(i,t){if(1&i&&(o.j41(0,"span"),o.EFF(1),o.k0s()),2&i){let e;const n=o.XpG(5);o.R7$(),o.SpI("",100*(null!==(e=n.pathForms.value.opacity)&&void 0!==e?e:0),"%")}}function Jfe(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"mat-form-field",88)(2,"mat-label"),o.EFF(3,"Units"),o.k0s(),o.j41(4,"mat-select",50,1),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pathControlChange(r,"widthUnits"))}),o.j41(6,"mat-option",51),o.EFF(7,"meters"),o.k0s(),o.j41(8,"mat-option",52),o.EFF(9,"pixels"),o.k0s()()(),o.j41(10,"mat-form-field",89)(11,"mat-label"),o.EFF(12,"Tooltip Visibility"),o.k0s(),o.j41(13,"mat-select",54),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pathControlChange(r,"toggleTooltip"))}),o.j41(14,"mat-option",20),o.EFF(15,"off"),o.k0s(),o.j41(16,"mat-option",20),o.EFF(17,"on"),o.k0s()()()(),o.j41(18,"div",55)(19,"span"),o.EFF(20,"Width:"),o.k0s(),o.j41(21,"span"),o.EFF(22),o.DNE(23,Yfe,1,0)(24,Zfe,1,0),o.k0s()(),o.j41(25,"mat-slider",56)(26,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pathControlChange(r,"widthScale"))}),o.k0s()(),o.j41(27,"div",55)(28,"span"),o.EFF(29,"Minimum Width:"),o.k0s(),o.j41(30,"span"),o.EFF(31),o.k0s()(),o.j41(32,"mat-slider",56)(33,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pathControlChange(r,"widthMinPixels"))}),o.k0s()(),o.j41(34,"div",55)(35,"span"),o.EFF(36,"Opacity:"),o.k0s(),o.DNE(37,Kfe,1,0)(38,Qfe,2,1,"span"),o.k0s(),o.j41(39,"mat-slider",64)(40,"input",90),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pathControlChange(r,"opacity"))}),o.k0s()()}if(2&i){const e=o.sdS(5),n=o.XpG(4);o.R7$(4),o.Y8G("disabled",void 0===n.currentEventData),o.R7$(9),o.Y8G("disabled",void 0===n.currentEventData),o.R7$(),o.Y8G("value",!1),o.R7$(2),o.Y8G("value",!0),o.R7$(6),o.SpI("",n.pathForms.value.widthScale," "),o.R7$(),o.vxM("pixels"===e.value?23:24),o.R7$(2),o.Y8G("disabled",void 0===n.currentEventData),o.R7$(6),o.SpI("",n.pathForms.value.widthMinPixels," Pixel(s)"),o.R7$(),o.Y8G("disabled",void 0===n.currentEventData),o.R7$(5),o.vxM(1===n.pathForms.value.opacity?37:38),o.R7$(2),o.Y8G("disabled",void 0===n.currentEventData)}}function eme(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"mat-form-field",59)(2,"mat-label"),o.EFF(3,"Units"),o.k0s(),o.j41(4,"mat-select",50,1),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pointControlChange(r,"radiusUnits"))}),o.j41(6,"mat-option",51),o.EFF(7,"meters"),o.k0s(),o.j41(8,"mat-option",52),o.EFF(9,"pixels"),o.k0s()()(),o.j41(10,"mat-form-field",60)(11,"mat-label"),o.EFF(12,"Color"),o.k0s(),o.j41(13,"input",61),o.bIt("colorChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pointControlChange(r.value,"getFillColor",!0))}),o.k0s(),o.nrm(14,"mtx-colorpicker-toggle",62)(15,"mtx-colorpicker",null,2),o.k0s()(),o.j41(17,"div",55)(18,"span"),o.EFF(19,"Radius:"),o.k0s(),o.j41(20,"span"),o.EFF(21),o.k0s()(),o.j41(22,"mat-slider",63)(23,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pointControlChange(r,"getRadius"))}),o.k0s()(),o.j41(24,"div",55)(25,"span"),o.EFF(26,"Opacity:"),o.k0s(),o.j41(27,"span"),o.EFF(28),o.k0s()(),o.j41(29,"mat-slider",64)(30,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pointControlChange(r,"opacity"))}),o.k0s()(),o.j41(31,"div",55)(32,"span"),o.EFF(33,"Minimum Radius Width:"),o.k0s(),o.j41(34,"span"),o.EFF(35),o.k0s()(),o.j41(36,"mat-slider",65)(37,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.pointControlChange(r,"radiusMinPixels"))}),o.k0s()()}if(2&i){let e;const n=o.sdS(16),r=o.XpG(4);o.R7$(4),o.Y8G("disabled",void 0===r.currentEventData),o.R7$(9),o.Y8G("mtxColorpicker",n)("disabled",void 0===r.currentEventData),o.R7$(),o.Y8G("for",n),o.R7$(7),o.JRh(r.pointForms.value.getRadius),o.R7$(),o.Y8G("disabled",void 0===r.currentEventData),o.R7$(6),o.SpI("",100*(null!==(e=r.pointForms.value.opacity)&&void 0!==e?e:0),"%"),o.R7$(),o.Y8G("disabled",void 0===r.currentEventData),o.R7$(6),o.SpI("",r.pointForms.value.radiusMinPixels," Pixel(s)"),o.R7$(),o.Y8G("disabled",void 0===r.currentEventData)}}function tme(i,t){1&i&&(o.j41(0,"mat-option",72),o.EFF(1,"Min"),o.k0s(),o.j41(2,"mat-option",73),o.EFF(3,"Max"),o.k0s())}function ime(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"span"),o.EFF(2,"Radius:"),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()(),o.j41(5,"mat-slider",74)(6,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(5);return o.Njj(l.aggregationControlChange(r,"radiusPixels"))}),o.k0s()(),o.j41(7,"div",55)(8,"span"),o.EFF(9,"Intensity:"),o.k0s(),o.j41(10,"span"),o.EFF(11),o.k0s()(),o.j41(12,"mat-slider",75)(13,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(5);return o.Njj(l.aggregationControlChange(r,"intensity"))}),o.k0s()(),o.j41(14,"div",55)(15,"span"),o.EFF(16,"Threshold:"),o.k0s(),o.j41(17,"span"),o.EFF(18),o.k0s()(),o.j41(19,"mat-slider",76)(20,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(5);return o.Njj(l.aggregationControlChange(r,"threshold"))}),o.k0s()()}if(2&i){const e=o.XpG(5);o.R7$(4),o.SpI("",e.aggregationForms.controls.radiusPixels.value," pixel(s)"),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.intensity.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.threshold.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData)}}function nme(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"span"),o.EFF(2,"Radius:"),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()(),o.j41(5,"mat-slider",77)(6,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(5);return o.Njj(l.aggregationControlChange(r,"radius"))}),o.k0s()(),o.j41(7,"div",55)(8,"span"),o.EFF(9,"Coverage:"),o.k0s(),o.j41(10,"span"),o.EFF(11),o.k0s()(),o.j41(12,"mat-slider",78)(13,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(5);return o.Njj(l.aggregationControlChange(r,"coverage"))}),o.k0s()(),o.j41(14,"div",55)(15,"span"),o.EFF(16,"Upper Percentile:"),o.k0s(),o.j41(17,"span"),o.EFF(18),o.k0s()(),o.j41(19,"mat-slider",79)(20,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(5);return o.Njj(l.aggregationControlChange(r,"upperPercentile"))}),o.k0s()(),o.j41(21,"div",55)(22,"span"),o.EFF(23,"Lower Percentile:"),o.k0s(),o.j41(24,"span"),o.EFF(25),o.k0s()(),o.j41(26,"mat-slider",80)(27,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(5);return o.Njj(l.aggregationControlChange(r,"lowerPercentile"))}),o.k0s()()}if(2&i){const e=o.XpG(5);o.R7$(4),o.JRh(e.aggregationForms.controls.radius.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.coverage.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.upperPercentile.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.JRh(e.aggregationForms.controls.lowerPercentile.value),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData)}}function rme(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"span"),o.EFF(2,"Cell Size:"),o.k0s(),o.j41(3,"span"),o.EFF(4),o.k0s()(),o.j41(5,"mat-slider",81)(6,"input",57),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(5);return o.Njj(l.aggregationControlChange(r,"cellSizePixels"))}),o.k0s()()}if(2&i){const e=o.XpG(5);o.R7$(4),o.SpI("",e.aggregationForms.controls.cellSizePixels.value," pixel(s)"),o.R7$(),o.Y8G("disabled",void 0===e.currentEventData)}}function ome(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",55)(1,"mat-form-field",67)(2,"mat-label"),o.EFF(3,"Aggregation Type"),o.k0s(),o.j41(4,"mat-select",68,3)(6,"mat-option",69),o.EFF(7,"Sum"),o.k0s(),o.j41(8,"mat-option",70),o.EFF(9,"Mean"),o.k0s(),o.DNE(10,tme,4,0),o.k0s()(),o.j41(11,"mat-form-field",71)(12,"mat-label"),o.EFF(13,"Theme"),o.k0s(),o.j41(14,"mat-select",54,4),o.bIt("valueChange",function(r){o.eBV(e);const l=o.XpG(4);return o.Njj(l.aggregationControlChange(r,"colorRange"))}),o.j41(16,"mat-option",20),o.EFF(17,"theme 1"),o.k0s(),o.j41(18,"mat-option",20),o.EFF(19,"theme 2"),o.k0s(),o.j41(20,"mat-option",20),o.EFF(21,"theme 3"),o.k0s()()()(),o.DNE(22,ime,21,6)(23,nme,28,8)(24,rme,7,2)}if(2&i){const e=o.XpG(4);o.R7$(4),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(6),o.vxM(13===e.currentActiveLayer()?10:-1),o.R7$(4),o.Y8G("disabled",void 0===e.currentEventData),o.R7$(2),o.Y8G("value",e.ColorRangeThemes[0]),o.R7$(2),o.Y8G("value",e.ColorRangeThemes[1]),o.R7$(2),o.Y8G("value",e.ColorRangeThemes[2]),o.R7$(2),o.vxM(5===e.currentActiveLayer()?22:-1),o.R7$(),o.vxM(6===e.currentActiveLayer()?23:-1),o.R7$(),o.vxM(13===e.currentActiveLayer()?24:-1)}}function sme(i,t){if(1&i&&(o.j41(0,"mat-card",84)(1,"mat-card-header")(2,"h4"),o.EFF(3,"Control Panel"),o.k0s()(),o.j41(4,"mat-card-content"),o.DNE(5,Jfe,41,11)(6,eme,38,10)(7,ome,25,9),o.k0s()()),2&i){let e;const n=o.XpG(3);o.R7$(5),o.vxM("path"===(e=n.currentActiveForms())?5:"point"===e?6:"aggregation"===e?7:-1)}}function ame(i,t){if(1&i&&(o.j41(0,"mat-grid-tile",82),o.DNE(1,qfe,30,15,"mat-card",83)(2,sme,8,1,"mat-card",84),o.k0s()),2&i){const e=t.$implicit,n=t.$index;o.Y8G("colspan",e.cols)("rowspan",e.rows),o.R7$(),o.vxM(0===n?1:1===n?2:-1)}}function lme(i,t){if(1&i&&(o.j41(0,"mat-grid-list",6),o.Z7z(1,ame,3,3,"mat-grid-tile",82,o.fX1),o.k0s()),2&i){const e=o.XpG();o.R7$(),o.Dyx(e.tiles)}}let cme=(()=>{class i{constructor(e,n,r){this.studyService=e,this.formBuilder=n,this.breakpointObserver=r,this.MAX_EVENTS_LIMIT=500,this.tiles=[{cols:2,rows:8,color:"lightblue"},{cols:3,rows:8,color:"lightgreen"}],this.eventProfilesOptions=[{value:"EURING_01",name:"24 hours between events"},{value:"EURING_02",name:"50 kilometers between events"},{value:"EURING_03",name:"Last 30 days"},{value:"EURING_04",name:"0.25 degrees movements"}],this.ColorRangeThemes=[[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]],[[1,152,189],[73,227,206],[216,254,181],[254,237,177],[254,173,84],[209,55,78]],[[0,25,0,25],[0,85,0,85],[0,127,0,127],[0,170,0,170],[0,190,0,190],[0,255,0,255]]],this.selectedEventProfile=this.eventProfilesOptions[0].value,this.displayedColumns=["select","name"],this.pathOverlayOptions=new o.bkB,this.pointOverlayOptions=new o.bkB,this.currentSortOrder="asc",this.currentLocationSensors=(0,o.vPA)([]),this.currentActiveForms=(0,o.vPA)("path"),this.currentActiveLayer=(0,o.vPA)(mn.ArcLayer),this.pointFormValid=(0,o.EWP)(()=>{const l=this.currentActiveLayer();return this.isPointLayer(l)&&void 0!==this.currentEventData}),this.pathFormValid=(0,o.EWP)(()=>{const l=this.currentActiveLayer();return this.isPathLayer(l)&&void 0!==this.currentEventData}),this.aggregationFormValid=(0,o.EWP)(()=>{const l=this.currentActiveLayer();return this.isAggregationLayer(l)&&void 0!==this.currentEventData}),this.closeRightNavEmitter=new o.bkB(!0),this.eventRequestEmitter=new o.bkB,this.maxEventsToggle=(0,o.vPA)(!0),this.overlayOptionsEmitter=new o.bkB,this.controlOptionsEmitter=new o.bkB,this.pathForms=this.formBuilder.nonNullable.group({widthScale:this.formBuilder.nonNullable.control(1),widthMinPixels:this.formBuilder.nonNullable.control(0),opacity:this.formBuilder.nonNullable.control(1)}),this.pointForms=this.formBuilder.nonNullable.group({getRadius:this.formBuilder.nonNullable.control(1),opacity:this.formBuilder.nonNullable.control(1),getFillColor:this.formBuilder.nonNullable.control(null),radiusMinPixels:this.formBuilder.nonNullable.control(0)}),this.aggregationForms=this.formBuilder.nonNullable.group({radiusPixels:this.formBuilder.nonNullable.control(30),radius:this.formBuilder.nonNullable.control(1e3),cellSizePixels:this.formBuilder.nonNullable.control(100),intensity:this.formBuilder.nonNullable.control(1),threshold:this.formBuilder.nonNullable.control(.5),coverage:this.formBuilder.nonNullable.control(1),upperPercentile:this.formBuilder.nonNullable.control(100),lowerPercentile:this.formBuilder.nonNullable.control(0)}),this.eventForm=this.formBuilder.nonNullable.group({eventProfiles:this.formBuilder.nonNullable.control("EURING_01"),sensorForm:this.formBuilder.control(null),checkboxes:new zV([])},{validators:[i=>i.get("checkboxes").value.some(n=>!0===n)?null:{noOptionSelected:!0},i=>null===i.get("sensorForm").value?{noSensorSelected:!0}:null],updateOn:"change"}),this.pointOverlayControls=this.formBuilder.nonNullable.group({individual:this.formBuilder.array([])}),this.pathOverlayControls=this.formBuilder.nonNullable.group({individual:this.formBuilder.array([])}),this.aggregationOverlayControls=this.formBuilder.nonNullable.group({individual:this.formBuilder.array([])}),this.tableSource=new Rce(this.studyService,this.CheckboxForm),this.smallTabSize={},this.largeTabSize={},this.fourthRowSmall={"justify-content":"left"},this.fourthRowDefault={"justify-content":"space-between","margin-left":"1em","margin-right":"1em"},this.screenChangeSignal=(0,o.vPA)(!1),this.currentIndividuals=(0,o.vPA)([]),this.badgeHidden=!0,this.formSubscriptions=[]}get CurrentIndividiuals(){switch(this.currentActiveForms()){case"path":return this.pathOverlayControls.controls.individual;case"point":return this.pointOverlayControls.controls.individual;case"aggregation":return this.aggregationOverlayControls.controls.individual}}get PointForms(){return this.pointOverlayControls.controls.individual}get PathForms(){return this.pathOverlayControls.controls.individual}get AggregationForms(){return this.aggregationOverlayControls.controls.individual}controlChangeHelper(e,n,r){this.emitControlChanges("string"==typeof e?{change:{type:"string",value:e},field:n,formType:r}:"number"==typeof e?{change:{type:"number",value:e},field:n,formType:r}:"boolean"==typeof e?{change:{type:"boolean",value:e},field:n,formType:r}:{change:{type:"color",value:e},field:n,formType:r})}pointControlChange(e,n,r=!1){if(null!==e){if(r){const m=this.hexToRgba(e);return this.pointForms.get(n)?.setValue(e),void this.controlChangeHelper(m,n,"point")}this.pointForms.get(n)?.setValue(e),this.controlChangeHelper(e,n,"point")}}pathControlChange(e,n){this.pathForms.get(n)?.setValue(e),this.controlChangeHelper(e,n,"path")}aggregationControlChange(e,n){this.aggregationForms.get(n)?.setValue(e),this.controlChangeHelper(e,n,"aggregation")}rgbaToHex(e){return"#"+e[0].toString(16)+e[1].toString(16)+e[2].toString(16)}layerToString(e){return FS.layerToString(e)}hexToRgba(e){const r=e[3]+e[4],l=e[5]+e[6];return[this.normalizeColorValue(parseInt(e[1]+e[2],16)),this.normalizeColorValue(parseInt(r,16)),this.normalizeColorValue(parseInt(l,16)),255]}normalizeColorValue(e){return Math.min(255,Math.max(0,e))}ngOnInit(){this.eventForm.disable(),this.tableState$=this.tableSource.DataStateAsObservable.pipe(su(),Oo(e=>{switch(e){case"loading":case"error":case"initial":this.eventForm.disable();break;case"loaded":this.eventForm.markAsPristine(),this.eventForm.enable(),this.sensorForm.setValue(this.currentLocationSensors().at(0)??null)}})),this.tableStateSubscription=this.tableState$.subscribe(),this.screenChange=this.breakpointObserver.observe([Cc_XSmall,Cc_Small]).pipe((0,st.T)(e=>e.matches)),this.extraSmallScreenChange=this.breakpointObserver.observe(Cc_XSmall).pipe((0,st.T)(e=>e.matches))}isSticky(){return!0}ngOnChanges(e){for(const n in e){const r=e[n].currentValue;if(void 0!==r&&r!==e[n].previousValue)switch(n){case"currentStudy":this.eventForm.disable(),this.currentStudy=r,this.currentLocationSensors.set(tle(this.currentStudy?.sensorTypeIds)),this.tableSource.getAnimalData(this.currentStudy.id,this.currentSortOrder);break;case"streamStatus":switch(this.streamStatus=r,this.streamStatus){case"standby":break;case"streaming":this.currentIndividuals.set([]);break;case"error":this.currentEventData=void 0,this.currentIndividuals.set([])}break;case"currentEventData":this.currentEventData=r,Array.from(this.currentEventData.currentIndividuals.values()).filter(m=>-1===this.currentIndividuals().indexOf(m)).forEach(m=>{this.addForms(m)}),this.currentIndividuals.set(Array.from(this.currentEventData.currentIndividuals.values()).sort()),this.badgeHidden=!0;break;case"currentFocusedIndividual":this.currentFocusedIndividual=r;break;case"currentSelectedLayer":this.currentSelectedLayer=r,this.currentActiveLayer.set(this.currentSelectedLayer),this.currentActiveForms.set(this.getActiveForm(this.currentSelectedLayer))}}}getActiveForm(e){return FS.isPathTypeLayer(e)?"path":FS.isPointTypeLayer(e)?"point":"aggregation"}ngOnDestroy(){this.breakpointSubscription?.unsubscribe(),this.tableStateSubscription?.unsubscribe()}closeRightNav(){this.closeRightNavEmitter.emit(!0)}ngAfterViewInit(){}stringToNumber(e){return Number(e)}get CurrentActiveLayer(){return this.currentActiveLayer.asReadonly()}isPathLayer(e){return FS.isPathTypeLayer(e)}isPointLayer(e){return FS.isPointTypeLayer(e)}isAggregationLayer(e){return FS.isAggregationLayer(e)}addForms(e){const n=this.formBuilder.group({currentIndividual:new df(e),getRadius:this.formBuilder.nonNullable.control(3),filled:this.formBuilder.nonNullable.control(!0),autoHighlight:this.formBuilder.nonNullable.control(!0),opacity:this.formBuilder.nonNullable.control(.8),focusLevel:this.formBuilder.nonNullable.control(1),radiusMinPixels:this.formBuilder.nonNullable.control(1),radiusMaxPixels:this.formBuilder.nonNullable.control(100),getFillColor:this.formBuilder.nonNullable.control("#ff0000"),getLineColor:this.formBuilder.nonNullable.control("#00ff00")}),r=this.formBuilder.group({currentIndividual:new df(e),widthScale:this.formBuilder.nonNullable.control(1),opacity:this.formBuilder.nonNullable.control(.8),widthMinPixels:this.formBuilder.nonNullable.control(1),widthMaxPixels:this.formBuilder.nonNullable.control(Number.MAX_SAFE_INTEGER),getSourceColor:this.formBuilder.nonNullable.control("#ff00ff"),getTargetColor:this.formBuilder.nonNullable.control(null),focusLevel:this.formBuilder.nonNullable.control(1),autoHighlight:this.formBuilder.nonNullable.control(!0)}),l=this.formBuilder.group({currentIndividual:new df(e),radius:this.formBuilder.nonNullable.control(1),elevationRange:this.formBuilder.nonNullable.control([0,1e3]),elevationScale:this.formBuilder.nonNullable.control(1),lowerPercentile:this.formBuilder.nonNullable.control(0),upperPercentile:this.formBuilder.nonNullable.control(100),elevationLowerPercentile:this.formBuilder.nonNullable.control(0),elevationUpperPercentile:this.formBuilder.nonNullable.control(100),elevationAggregation:this.formBuilder.nonNullable.control("SUM"),colorScaleType:this.formBuilder.nonNullable.control(null),colorAggregation:this.formBuilder.nonNullable.control("SUM"),getColorWeight:this.formBuilder.nonNullable.control(1),getElevationWeight:this.formBuilder.nonNullable.control(1)});this.pointOverlayControls.controls.individual.controls.push(n),this.pathOverlayControls.controls.individual.controls.push(r),this.aggregationOverlayControls.controls.individual.controls.push(l),this.pointOverlayControls.controls.individual.controls.sort(this.sortControlByIndividual),this.pathOverlayControls.controls.individual.controls.sort(this.sortControlByIndividual),this.aggregationOverlayControls.controls.individual.controls.sort(this.sortControlByIndividual)}sortControlByIndividual(e,n){return e.controls.currentIndividual<n.controls.currentIndividual?-1:e.controls.currentIndividual>n.controls.currentIndividual?1:0}emitControlChanges(e){this.controlOptionsEmitter.emit(e)}submitPointLayerForm(e){if(e<0||e>=this.pathOverlayControls.controls.individual.controls.length)return;const n=this.pointOverlayControls.controls.individual.controls[e];n.invalid||this.overlayOptionsEmitter.emit({type:"pointOverlayOptions",currentIndividual:n.controls.currentIndividual.value,opacity:n.controls.opacity.value,getRadius:n.controls.getRadius.value,radiusMinPixels:n.controls.radiusMinPixels.value,radiusMaxPixels:n.controls.radiusMaxPixels.value,getFillColor:this.hexToRgba(n.controls.getFillColor.value),getLineColor:this.hexToRgba(n.controls.getLineColor.value)})}submitPathLayer(e){if(e<0||e>=this.pathOverlayControls.controls.individual.controls.length)return;const n=this.pathOverlayControls.controls.individual.controls[e];if(n.invalid)return;let r;null!==n.controls.getTargetColor.value&&(r=this.hexToRgba(n.controls.getTargetColor.value)),this.overlayOptionsEmitter.emit({type:"pathOverlayOptions",currentIndividual:n.controls.currentIndividual.value,widthScale:n.controls.widthScale.value,opacity:n.controls.opacity.value,widthMinPixels:n.controls.widthMinPixels.value,widthMaxPixels:n.controls.widthMaxPixels.value,getSourceColor:this.hexToRgba(n.controls.getSourceColor.value),getTargetColor:r,focusLevel:n.controls.focusLevel.value,autoHighlight:n.controls.autoHighlight.value})}submitAggregationLayer(e){if(e<0||e>=this.aggregationOverlayControls.controls.individual.controls.length)return;const n=this.aggregationOverlayControls.controls.individual.controls[e];n.invalid||this.overlayOptionsEmitter.emit({type:"aggregationOverlayOptions",currentIndividual:n.controls.currentIndividual.value,radius:n.controls.radius.value,elevationRange:n.controls.elevationRange.value,elevationScale:n.controls.elevationScale.value,lowerPercentile:n.controls.lowerPercentile.value,upperPercentile:n.controls.upperPercentile.value,elevationLowerPercentile:n.controls.elevationLowerPercentile.value,elevationUpperPercentile:n.controls.elevationUpperPercentile.value,elevationAggregation:n.controls.elevationAggregation.value,colorScaleType:n.controls.colorScaleType.value,colorAggregation:n.controls.colorAggregation.value,getColorWeight:n.controls.getColorWeight.value,getElevationWeight:n.controls.getElevationWeight.value})}get formEnabled(){return(0,o.EWP)(()=>"loaded"===this.TableState())}get eventProfiles(){return this.eventForm.controls.eventProfiles}get CheckboxForm(){return this.eventForm.controls.checkboxes}get sensorForm(){return this.eventForm.controls.sensorForm}checkboxLabel(e){return null==e?(this.isAllSelected()?"deselect":"select")+" all":`${this.tableSource.isSelected(e)?"deselect":"select"} row ${e+1}`}get TableState(){return this.tableSource.TableState}get isAllSelected(){return this.tableSource.IsAllSelected}updateState(){}getIndividual(e){return this.tableSource.getIndividual(e)}toggleRow(e,n){n&&console.log(n),this.tableSource.toggleRow(e)}toggleAllRows(){this.tableSource.toggleAllRows(),this.eventForm.markAsDirty()}sortChange(){this.currentStudy&&(this.currentSortOrder="asc"===this.currentSortOrder?"desc":"asc",this.tableSource.getAnimalData(this.currentStudy.id,this.currentSortOrder))}isSelected(e){return this.tableSource.isSelected(e)}trackById(e){return e}trackByAnimalName(e,n){return n}mapToArray(e){return Array.from(e.values())}isTagged(e){return this.tableSource.isTagged(e)}get hasValue(){return(0,o.EWP)(()=>this.tableSource.HasValue()&&"loaded"===this.TableState())}get Individuals(){return this.tableSource.allIndividuals}get TaggedIndividuals(){return this.tableSource.allTaggedIndividuals}submitForm(){if(this.eventForm.invalid||!this.currentStudy||"loaded"!==this.TableState()||null==this.sensorForm.value)return;const e=this.currentStudy.id,n=this.tableSource.taggedAndSelectedIndividuals();this.sendFetchRequest({StudyId:e,LocalIdentifiers:n,SensorType:this.sensorForm.value,GeometryType:"linestring",Options:{MaxEventsPerIndividual:void 0,Attributes:void 0,EventProfile:this.eventProfiles.valid?this.eventProfiles.value:void 0}})}sendFetchRequest(e){this.eventRequestEmitter.emit(e)}timeStampHelper(e){if(null!==e)return BigInt(e.valueOf())}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(oO),o.rXU(Wre),o.rXU(sa))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-events"]],viewQuery:function(n,r){if(1&n&&o.GBs(bz,5),2&n){let l;o.mGM(l=o.lsd())&&(r.sort=l.first)}},inputs:{currentStudy:"currentStudy",currentFocusedIndividual:"currentFocusedIndividual",currentEventData:"currentEventData",currentSelectedLayer:"currentSelectedLayer",streamStatus:"streamStatus"},outputs:{pathOverlayOptions:"pathOverlayOptions",pointOverlayOptions:"pointOverlayOptions",closeRightNavEmitter:"closeRightNavEmitter",eventRequestEmitter:"eventRequestEmitter",overlayOptionsEmitter:"overlayOptionsEmitter",controlOptionsEmitter:"controlOptionsEmitter"},standalone:!0,features:[o.OA$,o.aNF],decls:3,vars:3,consts:[["Table",""],["PathDropdown",""],["PointColorpicker",""],["AggregationDropdown",""],["AggregationDropdown2",""],["animationDuration","0",1,"tab-group"],["cols","5","rowHeight","4em",1,"grid-list"],["label","animals",1,"animal-tab"],["mat-icon-button","",1,"close-button-small",3,"click"],["id","small-screen-table",1,"grid-table-form-small",3,"ngSubmit","formGroup"],[1,"input-container"],["id","input-container",1,"dense-3",3,"ngStyle"],[1,"reduction-profile-form"],["formControlName","eventProfiles","placeholder","Reduction Profiles","matTooltip","Limit the number of events to improve performance and reduce clutter."],["value","EURING_01"],["value","EURING_02"],["value","EURING_03"],["value","EURING_04"],[1,"sensor-form"],["formControlName","sensorForm","placeholder","Sensors","matTooltip","Select a sensor type."],[3,"value"],["mat-table","","formArrayName","checkboxes","matSort","","matSortDisableClear","","matSortActive","name","matSortDirection","asc","id","animal-table-small",1,"animal-table",3,"dataSource","trackBy"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","checkbox-header-cell",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["mode","indeterminate"],["matColumnDef","name",1,"ng-container"],["mat-header-cell","","class","animal-header-cell","mat-sort-header","","sortActionDescription","Sort by name",4,"matHeaderCellDef"],["mat-cell","","class","individual-header-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],["label","control panel",1,"control-panel-tab"],[1,"control-panel-container"],["mat-header-cell",""],[3,"change","checked","disabled","indeterminate"],["mat-cell","",1,"checkbox-header-cell"],[3,"click","change","formControlName","id"],["mat-footer-cell",""],["mat-raised-button","","color","primary","type","submit",1,"submit-button",3,"disabled"],["mat-header-cell","","mat-sort-header","","sortActionDescription","Sort by name",1,"animal-header-cell"],[1,"animal-header-content"],["matTooltip","Each animal is assigned a unique individual identifier provided by the owner of the study.","aria-label","false","fontIcon","info"],["mat-cell","",1,"individual-header-cell"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],[1,"label-container-normal"],["id","dropdown-path-1"],["id","unit-dropdown",3,"valueChange","disabled"],["value","meters"],["value","pixels"],[1,"tooltip-dropdown"],[3,"valueChange","disabled"],[1,"label-container"],["min","0","max","20",3,"disabled"],["matSliderThumb","",3,"valueChange"],["min","0","max","1","step","0.01","value","1",3,"disabled"],["id","dropdown-point-1"],["id","dropdown-point-2"],["matInput","",3,"colorChange","mtxColorpicker","disabled"],["matSuffix","",3,"for"],["min","0","max","1000",3,"disabled"],["min","0","max","1","step","0.01",3,"disabled"],["min","0","max","20","step","1",3,"disabled"],[1,"aggregation-first-row"],["id","aggregation-dropdown-1"],["matTooltip","Defines the operation used to aggregate events.",3,"disabled"],["value","SUM"],["value","MEAN"],["id","aggregation-dropdown-2"],["value","MIN"],["value","MAX"],["min","1","max","100","value","30",3,"disabled"],["min","0","max","5","value","1",3,"disabled"],["min","0","max","1","value","0.5","step","0.01",3,"disabled"],["min","10","max","1000","value","10000",3,"disabled"],["min","0","max","1","value","1","step","0.01",3,"disabled"],["min","0","max","100","value","100",3,"disabled"],["min","0","max","100","value","0",3,"disabled"],["min","10","max","1000","value","100",3,"disabled"],[3,"colspan","rowspan"],[1,"table-card"],[1,"card-controls"],[1,"grid-table-form",3,"ngSubmit","formGroup"],["formControlName","eventProfiles","placeholder","Reduction Profiles","matTooltip","Limit the number of events to improve performance and reduce clutter.",3,"valueChange","value"],["mat-table","","formArrayName","checkboxes","matSort","","matSortDisableClear","","matSortActive","name","matSortDirection","asc",1,"animal-table",3,"dataSource","trackBy"],["id","aggregation-dropdown1"],["id","aggregation-dropdown2",1,"tooltip-dropdown"],["matSliderThumb","","value","1",3,"valueChange"]],template:function(n,r){1&n&&(o.DNE(0,Pfe,52,15,"mat-tab-group",5),o.nI1(1,"async"),o.DNE(2,lme,3,0,"mat-grid-list",6)),2&n&&o.vxM(o.bMT(1,1,r.screenChange)?0:2)},dependencies:[d$,sz,PO,az,OO,RO,lz,s$,l$,LO,FO,a$,cz,dz,c$,os,mc,xf,Ile,M$,Ice,bz,kce,SE,fce,z$,uce,qH,wO,vO,Sk,lO,Fb,Rk,bO,fz,hz,Lk,Ok,EH,UV,Er,Mr,ea,Sc,mu,Pk,y$,TO,HV,jH,UH,Gp,BO,yde,rue,Dde,Wde,Ude,kz,e8,Qie,nue,f7,m7,p7,X$,UO,kS,mue,fue,v7,afe,nfe,l4,LW],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.grid-table-form-small[_ngcontent-%COMP%]{height:calc(100vh - 7em)}#aggregation-dropdown[_ngcontent-%COMP%]{display:flex}#unit-dropdown[_ngcontent-%COMP%]{margin-right:1em}.input-container[_ngcontent-%COMP%]{margin-left:1em}.control-panel-tab[_ngcontent-%COMP%]{width:100%}.close-button[_ngcontent-%COMP%]{position:absolute;left:1em;top:1em;z-index:4}.close-button-small[_ngcontent-%COMP%]{color:#000;background-color:#fff;box-shadow:none}.label-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-left:1em;margin-right:1em}.aggregation-first-row[_ngcontent-%COMP%], .label-container-normal[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-left:1em;margin-right:1em}#dropdown-point-1[_ngcontent-%COMP%], #dropdown-point-2[_ngcontent-%COMP%], #dropdown-path-1[_ngcontent-%COMP%], #dropdown-path-2[_ngcontent-%COMP%]{width:150px}.table-card[_ngcontent-%COMP%]{height:90%;width:100%;border-radius:5px}.card-controls[_ngcontent-%COMP%]{margin-top:1em;height:90%;width:100%;border-radius:5px}.grid-list[_ngcontent-%COMP%]{width:45em;margin-top:1em}.grid-table-form[_ngcontent-%COMP%]{margin-top:1em;width:100%;height:100%;overflow-y:scroll;word-break:break-all}.grid-table-form[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%], .grid-table-form[_ngcontent-%COMP%]   .animal-header-cell[_ngcontent-%COMP%]{word-break:normal}.control-panel-container[_ngcontent-%COMP%]{margin-left:1em;margin-right:1em}#table-container[_ngcontent-%COMP%]{position:relative}#input-container[_ngcontent-%COMP%]{margin-left:1em;margin-right:1em}.slider[_ngcontent-%COMP%]{flex:1 1 auto;margin-left:1em;margin-right:1em}.submit-button[_ngcontent-%COMP%]{margin-left:1em;margin-bottom:5px}mat-card[_ngcontent-%COMP%]{margin:10px 10px 30px 30px}.first-content-row[_ngcontent-%COMP%]{display:flex;align-items:normal}.second-content-row[_ngcontent-%COMP%], .third-content-row[_ngcontent-%COMP%]{display:flex}"],changeDetection:0})}}return i})();const ume=["button"],hme=["*"];function fme(i,t){if(1&i&&o.nrm(0,"mat-pseudo-checkbox",3),2&i){const e=o.XpG();o.Y8G("disabled",e.disabled)}}function mme(i,t){if(1&i&&o.nrm(0,"mat-pseudo-checkbox",3),2&i){const e=o.XpG();o.Y8G("disabled",e.disabled)}}const FW=new o.nKC("MAT_BUTTON_TOGGLE_DEFAULT_OPTIONS",{providedIn:"root",factory:function pme(){return{hideSingleSelectionIndicator:!1,hideMultipleSelectionIndicator:!1}}}),NW=new o.nKC("MatButtonToggleGroup"),gme={provide:Ya,useExisting:(0,o.Rfq)(()=>zW),multi:!0};let BW=0;class VW{constructor(t,e){this.source=t,this.value=e}}let zW=(()=>{class i{get name(){return this._name}set name(e){this._name=e,this._markButtonsForCheck()}get value(){const e=this._selectionModel?this._selectionModel.selected:[];return this.multiple?e.map(n=>n.value):e[0]?e[0].value:void 0}set value(e){this._setSelectionByValue(e),this.valueChange.emit(this.value)}get selected(){const e=this._selectionModel?this._selectionModel.selected:[];return this.multiple?e:e[0]||null}get multiple(){return this._multiple}set multiple(e){this._multiple=e,this._markButtonsForCheck()}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._markButtonsForCheck()}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._markButtonsForCheck()}get hideMultipleSelectionIndicator(){return this._hideMultipleSelectionIndicator}set hideMultipleSelectionIndicator(e){this._hideMultipleSelectionIndicator=e,this._markButtonsForCheck()}constructor(e,n,r){this._changeDetector=e,this._dir=r,this._multiple=!1,this._disabled=!1,this._controlValueAccessorChangeFn=()=>{},this._onTouched=()=>{},this._name="mat-button-toggle-group-"+BW++,this.valueChange=new o.bkB,this.change=new o.bkB,this.appearance=n&&n.appearance?n.appearance:"standard",this.hideSingleSelectionIndicator=n?.hideSingleSelectionIndicator??!1,this.hideMultipleSelectionIndicator=n?.hideMultipleSelectionIndicator??!1}ngOnInit(){this._selectionModel=new Nk(this.multiple,void 0,!1)}ngAfterContentInit(){this._selectionModel.select(...this._buttonToggles.filter(e=>e.checked)),this.multiple||this._initializeTabIndex()}writeValue(e){this.value=e,this._changeDetector.markForCheck()}registerOnChange(e){this._controlValueAccessorChangeFn=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_keydown(e){if(this.multiple||this.disabled)return;const r=e.target.id,l=this._buttonToggles.toArray().findIndex(C=>C.buttonId===r);let m=null;switch(e.keyCode){case 32:case 13:m=this._buttonToggles.get(l)||null;break;case 38:m=this._getNextButton(l,-1);break;case 37:m=this._getNextButton(l,"ltr"===this.dir?-1:1);break;case 40:m=this._getNextButton(l,1);break;case 39:m=this._getNextButton(l,"ltr"===this.dir?1:-1);break;default:return}m&&(e.preventDefault(),m._onButtonClick(),m.focus())}_emitChangeEvent(e){const n=new VW(e,this.value);this._rawValue=n.value,this._controlValueAccessorChangeFn(n.value),this.change.emit(n)}_syncButtonToggle(e,n,r=!1,l=!1){!this.multiple&&this.selected&&!e.checked&&(this.selected.checked=!1),this._selectionModel?n?this._selectionModel.select(e):this._selectionModel.deselect(e):l=!0,l?Promise.resolve().then(()=>this._updateModelValue(e,r)):this._updateModelValue(e,r)}_isSelected(e){return this._selectionModel&&this._selectionModel.isSelected(e)}_isPrechecked(e){return!(typeof this._rawValue>"u")&&(this.multiple&&Array.isArray(this._rawValue)?this._rawValue.some(n=>null!=e.value&&n===e.value):e.value===this._rawValue)}_initializeTabIndex(){if(this._buttonToggles.forEach(e=>{e.tabIndex=-1}),this.selected)this.selected.tabIndex=0;else for(let e=0;e<this._buttonToggles.length;e++){const n=this._buttonToggles.get(e);if(!n.disabled){n.tabIndex=0;break}}this._markButtonsForCheck()}_getNextButton(e,n){const r=this._buttonToggles;for(let l=1;l<=r.length;l++){const C=r.get((e+n*l+r.length)%r.length);if(C&&!C.disabled)return C}return null}_setSelectionByValue(e){this._rawValue=e,this._buttonToggles&&(this.multiple&&e?(Array.isArray(e),this._clearSelection(),e.forEach(n=>this._selectValue(n))):(this._clearSelection(),this._selectValue(e)))}_clearSelection(){this._selectionModel.clear(),this._buttonToggles.forEach(e=>{e.checked=!1,this.multiple||(e.tabIndex=-1)})}_selectValue(e){const n=this._buttonToggles.find(r=>null!=r.value&&r.value===e);n&&(n.checked=!0,this._selectionModel.select(n),this.multiple||(n.tabIndex=0))}_updateModelValue(e,n){n&&this._emitChangeEvent(e),this.valueChange.emit(this.value)}_markButtonsForCheck(){this._buttonToggles?.forEach(e=>e._markForCheck())}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.gRc),o.rXU(FW,8),o.rXU(Us,8))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["mat-button-toggle-group"]],contentQueries:function(n,r,l){if(1&n&&o.wni(l,c4,5),2&n){let m;o.mGM(m=o.lsd())&&(r._buttonToggles=m)}},hostAttrs:[1,"mat-button-toggle-group"],hostVars:6,hostBindings:function(n,r){1&n&&o.bIt("keydown",function(m){return r._keydown(m)}),2&n&&(o.BMQ("role",r.multiple?"group":"radiogroup")("aria-disabled",r.disabled),o.AVh("mat-button-toggle-vertical",r.vertical)("mat-button-toggle-group-appearance-standard","standard"===r.appearance))},inputs:{appearance:"appearance",name:"name",vertical:[2,"vertical","vertical",o.L39],value:"value",multiple:[2,"multiple","multiple",o.L39],disabled:[2,"disabled","disabled",o.L39],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",o.L39],hideMultipleSelectionIndicator:[2,"hideMultipleSelectionIndicator","hideMultipleSelectionIndicator",o.L39]},outputs:{valueChange:"valueChange",change:"change"},exportAs:["matButtonToggleGroup"],standalone:!0,features:[o.Jv_([gme,{provide:NW,useExisting:i}]),o.GFd]})}}return i})(),c4=(()=>{class i{get buttonId(){return`${this.id}-button`}get tabIndex(){return this._tabIndex}set tabIndex(e){this._tabIndex=e,this._markForCheck()}get appearance(){return this.buttonToggleGroup?this.buttonToggleGroup.appearance:this._appearance}set appearance(e){this._appearance=e}get checked(){return this.buttonToggleGroup?this.buttonToggleGroup._isSelected(this):this._checked}set checked(e){e!==this._checked&&(this._checked=e,this.buttonToggleGroup&&this.buttonToggleGroup._syncButtonToggle(this,this._checked),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled||this.buttonToggleGroup&&this.buttonToggleGroup.disabled}set disabled(e){this._disabled=e}constructor(e,n,r,l,m,C){this._changeDetectorRef=n,this._elementRef=r,this._focusMonitor=l,this._checked=!1,this.ariaLabelledby=null,this._disabled=!1,this.change=new o.bkB;const A=Number(m);this.tabIndex=A||0===A?A:null,this.buttonToggleGroup=e,this.appearance=C&&C.appearance?C.appearance:"standard"}ngOnInit(){const e=this.buttonToggleGroup;this.id=this.id||"mat-button-toggle-"+BW++,e&&(e._isPrechecked(this)?this.checked=!0:e._isSelected(this)!==this._checked&&e._syncButtonToggle(this,this._checked))}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){const e=this.buttonToggleGroup;this._focusMonitor.stopMonitoring(this._elementRef),e&&e._isSelected(this)&&e._syncButtonToggle(this,!1,!1,!0)}focus(e){this._buttonElement.nativeElement.focus(e)}_onButtonClick(){const e=!!this.isSingleSelector()||!this._checked;if(e!==this._checked&&(this._checked=e,this.buttonToggleGroup&&(this.buttonToggleGroup._syncButtonToggle(this,this._checked,!0),this.buttonToggleGroup._onTouched())),this.isSingleSelector()){const n=this.buttonToggleGroup._buttonToggles.find(r=>0===r.tabIndex);n&&(n.tabIndex=-1),this.tabIndex=0}this.change.emit(new VW(this,this.value))}_markForCheck(){this._changeDetectorRef.markForCheck()}_getButtonName(){return this.isSingleSelector()?this.buttonToggleGroup.name:this.name||null}isSingleSelector(){return this.buttonToggleGroup&&!this.buttonToggleGroup.multiple}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(NW,8),o.rXU(o.gRc),o.rXU(o.aKT),o.rXU(Kc),o.kS0("tabindex"),o.rXU(FW,8))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-button-toggle"]],viewQuery:function(n,r){if(1&n&&o.GBs(ume,5),2&n){let l;o.mGM(l=o.lsd())&&(r._buttonElement=l.first)}},hostAttrs:["role","presentation",1,"mat-button-toggle"],hostVars:12,hostBindings:function(n,r){1&n&&o.bIt("focus",function(){return r.focus()}),2&n&&(o.BMQ("aria-label",null)("aria-labelledby",null)("id",r.id)("name",null),o.AVh("mat-button-toggle-standalone",!r.buttonToggleGroup)("mat-button-toggle-checked",r.checked)("mat-button-toggle-disabled",r.disabled)("mat-button-toggle-appearance-standard","standard"===r.appearance))},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],id:"id",name:"name",value:"value",tabIndex:"tabIndex",disableRipple:[2,"disableRipple","disableRipple",o.L39],appearance:"appearance",checked:[2,"checked","checked",o.L39],disabled:[2,"disabled","disabled",o.L39]},outputs:{change:"change"},exportAs:["matButtonToggle"],standalone:!0,features:[o.GFd,o.aNF],ngContentSelectors:hme,decls:8,vars:13,consts:[["button",""],["type","button",1,"mat-button-toggle-button","mat-focus-indicator",3,"click","id","disabled"],[1,"mat-button-toggle-label-content"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"mat-button-toggle-focus-overlay"],["matRipple","",1,"mat-button-toggle-ripple",3,"matRippleTrigger","matRippleDisabled"]],template:function(n,r){if(1&n){const l=o.RV6();o.NAR(),o.j41(0,"button",1,0),o.bIt("click",function(){return o.eBV(l),o.Njj(r._onButtonClick())}),o.j41(2,"span",2),o.DNE(3,fme,1,1,"mat-pseudo-checkbox",3)(4,mme,1,1,"mat-pseudo-checkbox",3),o.SdG(5),o.k0s()(),o.nrm(6,"span",4)(7,"span",5)}if(2&n){const l=o.sdS(1);o.Y8G("id",r.buttonId)("disabled",r.disabled||null),o.BMQ("role",r.isSingleSelector()?"radio":"button")("tabindex",r.disabled?-1:r.tabIndex)("aria-pressed",r.isSingleSelector()?null:r.checked)("aria-checked",r.isSingleSelector()?r.checked:null)("name",r._getButtonName())("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby),o.R7$(3),o.vxM(r.buttonToggleGroup&&r.checked&&!r.buttonToggleGroup.multiple&&!r.buttonToggleGroup.hideSingleSelectionIndicator?3:-1),o.R7$(),o.vxM(r.buttonToggleGroup&&r.checked&&r.buttonToggleGroup.multiple&&!r.buttonToggleGroup.hideMultipleSelectionIndicator?4:-1),o.R7$(3),o.Y8G("matRippleTrigger",l)("matRippleDisabled",r.disableRipple||r.disabled)}},dependencies:[dl,ym],styles:[".mat-button-toggle-standalone,.mat-button-toggle-group{position:relative;display:inline-flex;flex-direction:row;white-space:nowrap;overflow:hidden;-webkit-tap-highlight-color:rgba(0,0,0,0);transform:translateZ(0);border-radius:var(--mat-legacy-button-toggle-shape)}.mat-button-toggle-standalone:not([class*=mat-elevation-z]),.mat-button-toggle-group:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.cdk-high-contrast-active .mat-button-toggle-standalone,.cdk-high-contrast-active .mat-button-toggle-group{outline:solid 1px}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.mat-button-toggle-group-appearance-standard{border-radius:var(--mat-standard-button-toggle-shape);border:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard .mat-pseudo-checkbox,.mat-button-toggle-group-appearance-standard .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var( --mat-standard-button-toggle-selected-state-text-color )}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard:not([class*=mat-elevation-z]),.mat-button-toggle-group-appearance-standard:not([class*=mat-elevation-z]){box-shadow:none}.cdk-high-contrast-active .mat-button-toggle-standalone.mat-button-toggle-appearance-standard,.cdk-high-contrast-active .mat-button-toggle-group-appearance-standard{outline:0}.mat-button-toggle-vertical{flex-direction:column}.mat-button-toggle-vertical .mat-button-toggle-label-content{display:block}.mat-button-toggle{white-space:nowrap;position:relative;color:var(--mat-legacy-button-toggle-text-color);font-family:var(--mat-legacy-button-toggle-label-text-font);font-size:var(--mat-legacy-button-toggle-label-text-size);line-height:var(--mat-legacy-button-toggle-label-text-line-height);font-weight:var(--mat-legacy-button-toggle-label-text-weight);letter-spacing:var(--mat-legacy-button-toggle-label-text-tracking);--mat-minimal-pseudo-checkbox-selected-checkmark-color: var( --mat-legacy-button-toggle-selected-state-text-color )}.mat-button-toggle.cdk-keyboard-focused .mat-button-toggle-focus-overlay{opacity:var(--mat-legacy-button-toggle-focus-state-layer-opacity)}.mat-button-toggle .mat-icon svg{vertical-align:top}.mat-button-toggle .mat-pseudo-checkbox{margin-right:12px}[dir=rtl] .mat-button-toggle .mat-pseudo-checkbox{margin-right:0;margin-left:12px}.mat-button-toggle-checked{color:var(--mat-legacy-button-toggle-selected-state-text-color);background-color:var(--mat-legacy-button-toggle-selected-state-background-color)}.mat-button-toggle-disabled{color:var(--mat-legacy-button-toggle-disabled-state-text-color);background-color:var(--mat-legacy-button-toggle-disabled-state-background-color);--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var( --mat-legacy-button-toggle-disabled-state-text-color )}.mat-button-toggle-disabled.mat-button-toggle-checked{background-color:var(--mat-legacy-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-appearance-standard{color:var(--mat-standard-button-toggle-text-color);background-color:var(--mat-standard-button-toggle-background-color);font-family:var(--mat-standard-button-toggle-label-text-font);font-size:var(--mat-standard-button-toggle-label-text-size);line-height:var(--mat-standard-button-toggle-label-text-line-height);font-weight:var(--mat-standard-button-toggle-label-text-weight);letter-spacing:var(--mat-standard-button-toggle-label-text-tracking)}.mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:solid 1px var(--mat-standard-button-toggle-divider-color)}[dir=rtl] .mat-button-toggle-group-appearance-standard .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-group-appearance-standard.mat-button-toggle-vertical .mat-button-toggle-appearance-standard+.mat-button-toggle-appearance-standard{border-left:none;border-right:none;border-top:solid 1px var(--mat-standard-button-toggle-divider-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-selected-state-text-color);background-color:var(--mat-standard-button-toggle-selected-state-background-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled{color:var(--mat-standard-button-toggle-disabled-state-text-color);background-color:var(--mat-standard-button-toggle-disabled-state-background-color)}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color: var( --mat-standard-button-toggle-disabled-selected-state-text-color )}.mat-button-toggle-appearance-standard.mat-button-toggle-disabled.mat-button-toggle-checked{color:var(--mat-standard-button-toggle-disabled-selected-state-text-color);background-color:var(--mat-standard-button-toggle-disabled-selected-state-background-color)}.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{background-color:var(--mat-standard-button-toggle-state-layer-color)}.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-hover-state-layer-opacity)}.mat-button-toggle-appearance-standard.cdk-keyboard-focused:not(.mat-button-toggle-disabled) .mat-button-toggle-focus-overlay{opacity:var(--mat-standard-button-toggle-focus-state-layer-opacity)}@media(hover: none){.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{display:none}}.mat-button-toggle-label-content{-webkit-user-select:none;user-select:none;display:inline-block;padding:0 16px;line-height:var(--mat-legacy-button-toggle-height);position:relative}.mat-button-toggle-appearance-standard .mat-button-toggle-label-content{padding:0 12px;line-height:var(--mat-standard-button-toggle-height)}.mat-button-toggle-label-content>*{vertical-align:middle}.mat-button-toggle-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit;pointer-events:none;opacity:0;background-color:var(--mat-legacy-button-toggle-state-layer-color)}.cdk-high-contrast-active .mat-button-toggle-checked .mat-button-toggle-focus-overlay{border-bottom:solid 500px;opacity:.5;height:0}.cdk-high-contrast-active .mat-button-toggle-checked:hover .mat-button-toggle-focus-overlay{opacity:.6}.cdk-high-contrast-active .mat-button-toggle-checked.mat-button-toggle-appearance-standard .mat-button-toggle-focus-overlay{border-bottom:solid 500px}.mat-button-toggle .mat-button-toggle-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-button-toggle-button{border:0;background:none;color:inherit;padding:0;margin:0;font:inherit;outline:none;width:100%;cursor:pointer}.mat-button-toggle-disabled .mat-button-toggle-button{cursor:default}.mat-button-toggle-button::-moz-focus-inner{border:0}.mat-button-toggle-standalone.mat-button-toggle-appearance-standard{--mat-focus-indicator-border-radius:var(--mat-standard-button-toggle-shape)}.mat-button-toggle-group-appearance-standard .mat-button-toggle:last-of-type .mat-button-toggle-button::before{border-top-right-radius:var(--mat-standard-button-toggle-shape);border-bottom-right-radius:var(--mat-standard-button-toggle-shape)}.mat-button-toggle-group-appearance-standard .mat-button-toggle:first-of-type .mat-button-toggle-button::before{border-top-left-radius:var(--mat-standard-button-toggle-shape);border-bottom-left-radius:var(--mat-standard-button-toggle-shape)}"],encapsulation:2,changeDetection:0})}}return i})(),_me=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[qn,ul,c4,qn]})}}return i})();const vme=["mat-menu-item",""],bme=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],yme=["mat-icon, [matMenuItemIcon]","*"];function xme(i,t){1&i&&(o.qSk(),o.j41(0,"svg",2),o.nrm(1,"polygon",3),o.k0s())}const wme=["*"];function Cme(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",0),o.bIt("keydown",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._handleKeydown(r))})("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.closed.emit("click"))})("@transformMenu.start",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._onAnimationStart(r))})("@transformMenu.done",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l._onAnimationDone(r))}),o.j41(1,"div",1),o.SdG(2),o.k0s()()}if(2&i){const e=o.XpG();o.HbH(e._classList),o.Y8G("id",e.panelId)("@transformMenu",e._panelAnimationState),o.BMQ("aria-label",e.ariaLabel||null)("aria-labelledby",e.ariaLabelledby||null)("aria-describedby",e.ariaDescribedby||null)}}const d4=new o.nKC("MAT_MENU_PANEL");let oL=(()=>{class i{constructor(e,n,r,l,m){this._elementRef=e,this._document=n,this._focusMonitor=r,this._parentMenu=l,this._changeDetectorRef=m,this.role="menuitem",this.disabled=!1,this.disableRipple=!1,this._hovered=new xi.B,this._focused=new xi.B,this._highlighted=!1,this._triggersSubmenu=!1,l?.addItem?.(this)}focus(e,n){this._focusMonitor&&e?this._focusMonitor.focusVia(this._getHostElement(),e,n):this._getHostElement().focus(n),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const e=this._elementRef.nativeElement.cloneNode(!0),n=e.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<n.length;r++)n[r].remove();return e.textContent?.trim()||""}_setHighlighted(e){this._highlighted=e,this._changeDetectorRef?.markForCheck()}_setTriggersSubmenu(e){this._triggersSubmenu=e,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(Nn),o.rXU(Kc),o.rXU(d4,8),o.rXU(o.gRc))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-mdc-focus-indicator"],hostVars:8,hostBindings:function(n,r){1&n&&o.bIt("click",function(m){return r._checkDisabled(m)})("mouseenter",function(){return r._handleMouseEnter()}),2&n&&(o.BMQ("role",r.role)("tabindex",r._getTabIndex())("aria-disabled",r.disabled)("disabled",r.disabled||null),o.AVh("mat-mdc-menu-item-highlighted",r._highlighted)("mat-mdc-menu-item-submenu-trigger",r._triggersSubmenu))},inputs:{role:"role",disabled:[2,"disabled","disabled",o.L39],disableRipple:[2,"disableRipple","disableRipple",o.L39]},exportAs:["matMenuItem"],standalone:!0,features:[o.GFd,o.aNF],attrs:vme,ngContentSelectors:yme,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(n,r){1&n&&(o.NAR(bme),o.SdG(0),o.j41(1,"span",0),o.SdG(2,1),o.k0s(),o.nrm(3,"div",1),o.DNE(4,xme,2,0,":svg:svg",2)),2&n&&(o.R7$(3),o.Y8G("matRippleDisabled",r.disableRipple||r.disabled)("matRippleTrigger",r._getHostElement()),o.R7$(),o.vxM(r._triggersSubmenu?4:-1))},dependencies:[dl],encapsulation:2,changeDetection:0})}}return i})();const Eme=new o.nKC("MatMenuContent"),sL={transformMenu:js("transformMenu",[Lo("void",gn({opacity:0,transform:"scale(0.8)"})),oo("void => enter",co("120ms cubic-bezier(0, 0, 0.2, 1)",gn({opacity:1,transform:"scale(1)"}))),oo("* => void",co("100ms 25ms linear",gn({opacity:0})))]),fadeInItems:js("fadeInItems",[Lo("showing",gn({opacity:1})),oo("void => *",[gn({opacity:0}),co("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let Tme=0;const Sme=new o.nKC("mat-menu-default-options",{providedIn:"root",factory:function Mme(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let qk=(()=>{class i{get xPosition(){return this._xPosition}set xPosition(e){this._xPosition=e,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(e){this._yPosition=e,this.setPositionClasses()}set panelClass(e){const n=this._previousPanelClass,r={...this._classList};n&&n.length&&n.split(" ").forEach(l=>{r[l]=!1}),this._previousPanelClass=e,e&&e.length&&(e.split(" ").forEach(l=>{r[l]=!0}),this._elementRef.nativeElement.className=""),this._classList=r}get classList(){return this.panelClass}set classList(e){this.panelClass=e}constructor(e,n,r,l){this._elementRef=e,this._changeDetectorRef=l,this._elevationPrefix="mat-elevation-z",this._baseElevation=null,this._directDescendantItems=new o.rOR,this._classList={},this._panelAnimationState="void",this._animationDone=new xi.B,this.closed=new o.bkB,this.close=this.closed,this.panelId="mat-menu-panel-"+Tme++,this._injector=(0,o.WQX)(o.zZn),this.overlayPanelClass=r.overlayPanelClass||"",this._xPosition=r.xPosition,this._yPosition=r.yPosition,this.backdropClass=r.backdropClass,this.overlapTrigger=r.overlapTrigger,this.hasBackdrop=r.hasBackdrop}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new jv(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(As(this._directDescendantItems),So(e=>Io(...e.map(n=>n._focused)))).subscribe(e=>this._keyManager.updateActiveItem(e)),this._directDescendantItems.changes.subscribe(e=>{const n=this._keyManager;if("enter"===this._panelAnimationState&&n.activeItem?._hasFocus()){const r=e.toArray(),l=Math.max(0,Math.min(r.length-1,n.activeItemIndex||0));r[l]&&!r[l].disabled?n.setActiveItem(l):n.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusRef?.destroy()}_hovered(){return this._directDescendantItems.changes.pipe(As(this._directDescendantItems),So(n=>Io(...n.map(r=>r._hovered))))}addItem(e){}removeItem(e){}_handleKeydown(e){const n=e.keyCode,r=this._keyManager;switch(n){case 27:oa(e)||(e.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===n||40===n)&&r.setFocusOrigin("keyboard"),void r.onKeydown(e)}e.stopPropagation()}focusFirstItem(e="program"){this._firstItemFocusRef?.destroy(),this._firstItemFocusRef=(0,o.mal)(()=>{let n=null;if(this._directDescendantItems.length&&(n=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!n||!n.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(e).setFirstItemActive(),!r.activeItem&&n&&n.focus()}},{injector:this._injector})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(e){if(null===this._baseElevation){const C=("function"==typeof getComputedStyle?getComputedStyle(this._elementRef.nativeElement):null)?.getPropertyValue("--mat-menu-base-elevation-level")||"8";this._baseElevation=parseInt(C)}const n=Math.min(this._baseElevation+e,24),r=`${this._elevationPrefix}${n}`,l=Object.keys(this._classList).find(m=>m.startsWith(this._elevationPrefix));if(!l||l===this._previousElevation){const m={...this._classList};this._previousElevation&&(m[this._previousElevation]=!1),m[r]=!0,this._previousElevation=r,this._classList=m}}setPositionClasses(e=this.xPosition,n=this.yPosition){this._classList={...this._classList,"mat-menu-before":"before"===e,"mat-menu-after":"after"===e,"mat-menu-above":"above"===n,"mat-menu-below":"below"===n},this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(e){this._animationDone.next(e),this._isAnimating=!1}_onAnimationStart(e){this._isAnimating=!0,"enter"===e.toState&&0===this._keyManager.activeItemIndex&&(e.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(As(this._allItems)).subscribe(e=>{this._directDescendantItems.reset(e.filter(n=>n._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(o.aKT),o.rXU(o.SKi),o.rXU(Sme),o.rXU(o.gRc))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["mat-menu"]],contentQueries:function(n,r,l){if(1&n&&(o.wni(l,Eme,5),o.wni(l,oL,5),o.wni(l,oL,4)),2&n){let m;o.mGM(m=o.lsd())&&(r.lazyContent=m.first),o.mGM(m=o.lsd())&&(r._allItems=m),o.mGM(m=o.lsd())&&(r.items=m)}},viewQuery:function(n,r){if(1&n&&o.GBs(o.C4Q,5),2&n){let l;o.mGM(l=o.lsd())&&(r.templateRef=l.first)}},hostVars:3,hostBindings:function(n,r){2&n&&o.BMQ("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},inputs:{backdropClass:"backdropClass",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:[2,"overlapTrigger","overlapTrigger",o.L39],hasBackdrop:[2,"hasBackdrop","hasBackdrop",e=>null==e?null:(0,o.L39)(e)],panelClass:[0,"class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"},exportAs:["matMenu"],standalone:!0,features:[o.Jv_([{provide:d4,useExisting:i}]),o.GFd,o.aNF],ngContentSelectors:wme,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel","mat-mdc-elevation-specific",3,"keydown","click","id"],[1,"mat-mdc-menu-content"]],template:function(n,r){1&n&&(o.NAR(),o.DNE(0,Cme,3,7,"ng-template"))},styles:['mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;outline:0}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;flex:1;white-space:normal;font-family:var(--mat-menu-item-label-text-font);line-height:var(--mat-menu-item-label-text-line-height);font-size:var(--mat-menu-item-label-text-size);letter-spacing:var(--mat-menu-item-label-text-tracking);font-weight:var(--mat-menu-item-label-text-weight)}.mat-mdc-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;box-sizing:border-box;outline:0;border-radius:var(--mat-menu-container-shape);background-color:var(--mat-menu-container-color);will-change:transform,opacity}.mat-mdc-menu-panel.ng-animating{pointer-events:none}.mat-mdc-menu-panel.ng-animating:has(.mat-mdc-menu-content:empty){display:none}.cdk-high-contrast-active .mat-mdc-menu-panel{outline:solid 1px}.mat-mdc-menu-panel .mat-divider{color:var(--mat-menu-divider-color);margin-bottom:var(--mat-menu-divider-bottom-spacing);margin-top:var(--mat-menu-divider-top-spacing)}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:var(--mat-menu-item-leading-spacing);padding-right:var(--mat-menu-item-trailing-spacing);-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;min-height:48px}[dir=rtl] .mat-mdc-menu-item{padding-right:var(--mat-menu-item-leading-spacing);padding-left:var(--mat-menu-item-trailing-spacing)}.mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-leading-spacing);padding-right:var(--mat-menu-item-with-icon-trailing-spacing)}[dir=rtl] .mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-right:var(--mat-menu-item-with-icon-leading-spacing);padding-left:var(--mat-menu-item-with-icon-trailing-spacing)}.mat-mdc-menu-item::-moz-focus-inner{border:0}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color)}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color)}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item:focus{outline:0}.mat-mdc-menu-item .mat-icon{flex-shrink:0;margin-right:var(--mat-menu-item-spacing);height:var(--mat-menu-item-icon-size);width:var(--mat-menu-item-icon-size)}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:var(--mat-menu-item-spacing)}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color)}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color)}.cdk-high-contrast-active .mat-mdc-menu-item{margin-top:1px}.mat-mdc-menu-submenu-icon{width:var(--mat-menu-item-icon-size);height:10px;fill:currentColor;padding-left:var(--mat-menu-item-spacing)}[dir=rtl] .mat-mdc-menu-submenu-icon{padding-right:var(--mat-menu-item-spacing);padding-left:0}[dir=rtl] .mat-mdc-menu-submenu-icon polygon{transform:scaleX(-1)}.cdk-high-contrast-active .mat-mdc-menu-submenu-icon{fill:CanvasText}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[sL.transformMenu,sL.fadeInItems]},changeDetection:0})}}return i})();const UW=new o.nKC("mat-menu-scroll-strategy",{providedIn:"root",factory:()=>{const i=(0,o.WQX)(_l);return()=>i.scrollStrategies.reposition()}}),Dme={provide:UW,deps:[_l],useFactory:function Ame(i){return()=>i.scrollStrategies.reposition()}},jW=Ql({passive:!0});let kme=(()=>{class i{get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(e){this.menu=e}get menu(){return this._menu}set menu(e){e!==this._menu&&(this._menu=e,this._menuCloseSubscription.unsubscribe(),e&&(this._menuCloseSubscription=e.close.subscribe(n=>{this._destroyMenu(n),("click"===n||"tab"===n)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(n)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}constructor(e,n,r,l,m,C,A,O,z){this._overlay=e,this._element=n,this._viewContainerRef=r,this._menuItemInstance=C,this._dir=A,this._focusMonitor=O,this._ngZone=z,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=On.yU.EMPTY,this._hoverSubscription=On.yU.EMPTY,this._menuCloseSubscription=On.yU.EMPTY,this._changeDetectorRef=(0,o.WQX)(o.gRc),this._handleTouchStart=$=>{_m($)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new o.bkB,this.onMenuOpen=this.menuOpened,this.menuClosed=new o.bkB,this.onMenuClose=this.menuClosed,this._scrollStrategy=l,this._parentMaterialMenu=m instanceof qk?m:void 0,n.nativeElement.addEventListener("touchstart",this._handleTouchStart,jW)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,jW),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const e=this.menu;if(this._menuOpen||!e)return;const n=this._createOverlay(e),r=n.getConfig(),l=r.positionStrategy;this._setPosition(e,l),r.hasBackdrop=null==e.hasBackdrop?!this.triggersSubmenu():e.hasBackdrop,n.attach(this._getPortal(e)),e.lazyContent&&e.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(e),e instanceof qk&&(e._startAnimation(),e._directDescendantItems.changes.pipe(dn(e.close)).subscribe(()=>{l.withLockedPosition(!1).reapplyLastPosition(),l.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(e,n){this._focusMonitor&&e?this._focusMonitor.focusVia(this._element,e,n):this._element.nativeElement.focus(n)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(e){if(!this._overlayRef||!this.menuOpen)return;const n=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===e||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,n instanceof qk?(n._resetAnimation(),n.lazyContent?n._animationDone.pipe(Ur(r=>"void"===r.toState),gs(1),dn(n.lazyContent._attached)).subscribe({next:()=>n.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),n?.lazyContent?.detach())}_initMenu(e){e.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,e.direction=this.dir,this._setMenuElevation(e),e.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(e){if(e.setElevation){let n=0,r=e.parentMenu;for(;r;)n++,r=r.parentMenu;e.setElevation(n)}}_setIsMenuOpen(e){e!==this._menuOpen&&(this._menuOpen=e,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(e),this._changeDetectorRef.markForCheck())}_createOverlay(e){if(!this._overlayRef){const n=this._getOverlayConfig(e);this._subscribeToPositions(e,n.positionStrategy),this._overlayRef=this._overlay.create(n),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(e){return new CS({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:e.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:e.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(e,n){e.setPositionClasses&&n.positionChanges.subscribe(r=>{const l="start"===r.connectionPair.overlayX?"after":"before",m="top"===r.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>e.setPositionClasses(l,m)):e.setPositionClasses(l,m)})}_setPosition(e,n){let[r,l]="before"===e.xPosition?["end","start"]:["start","end"],[m,C]="above"===e.yPosition?["bottom","top"]:["top","bottom"],[A,O]=[m,C],[z,$]=[r,l],Q=0;if(this.triggersSubmenu()){if($=r="before"===e.xPosition?"start":"end",l=z="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const te=this._parentMaterialMenu.items.first;this._parentInnerPadding=te?te._getHostElement().offsetTop:0}Q="bottom"===m?this._parentInnerPadding:-this._parentInnerPadding}}else e.overlapTrigger||(A="top"===m?"bottom":"top",O="top"===C?"bottom":"top");n.withPositions([{originX:r,originY:A,overlayX:z,overlayY:m,offsetY:Q},{originX:l,originY:A,overlayX:$,overlayY:m,offsetY:Q},{originX:r,originY:O,overlayX:z,overlayY:C,offsetY:-Q},{originX:l,originY:O,overlayX:$,overlayY:C,offsetY:-Q}])}_menuClosingActions(){const e=this._overlayRef.backdropClick(),n=this._overlayRef.detachments();return Io(e,this._parentMaterialMenu?this._parentMaterialMenu.closed:di(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(Ur(m=>m!==this._menuItemInstance),Ur(()=>this._menuOpen)):di(),n)}_handleMousedown(e){Pp(e)||(this._openedBy=0===e.button?"mouse":void 0,this.triggersSubmenu()&&e.preventDefault())}_handleKeydown(e){const n=e.keyCode;(13===n||32===n)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===n&&"ltr"===this.dir||37===n&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(e){this.triggersSubmenu()?(e.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(Ur(e=>e===this._menuItemInstance&&!e.disabled),NO(0,pV)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof qk&&this.menu._isAnimating?this.menu._animationDone.pipe(gs(1),NO(0,pV),dn(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(e){return(!this._portal||this._portal.templateRef!==e.templateRef)&&(this._portal=new px(e.templateRef,this._viewContainerRef)),this._portal}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(_l),o.rXU(o.aKT),o.rXU(o.c1b),o.rXU(UW),o.rXU(d4,8),o.rXU(oL,10),o.rXU(Us,8),o.rXU(Kc),o.rXU(o.SKi))}}static{this.\u0275dir=o.FsC({type:i,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],hostVars:3,hostBindings:function(n,r){1&n&&o.bIt("click",function(m){return r._handleClick(m)})("mousedown",function(m){return r._handleMousedown(m)})("keydown",function(m){return r._handleKeydown(m)}),2&n&&o.BMQ("aria-haspopup",r.menu?"menu":null)("aria-expanded",r.menuOpen)("aria-controls",r.menuOpen?r.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:[0,"mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:[0,"matMenuTriggerFor","menu"],menuData:[0,"matMenuTriggerData","menuData"],restoreFocus:[0,"matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"},exportAs:["matMenuTrigger"],standalone:!0})}}return i})(),Ime=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[Dme],imports:[os,ul,qn,ES,Lb,qn]})}}return i})();const aL=new o.nKC("mat-chips-default-options",{providedIn:"root",factory:()=>({separatorKeyCodes:[13]})});let epe=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({providers:[eh,{provide:aL,useValue:{separatorKeyCodes:[13]}}],imports:[qn,ul,qn]})}}return i})();var tpe=It(247),fg=It.n(tpe);function ipe(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",1)(1,"button",3),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.initializeMap())}),o.EFF(2,"Load Map"),o.k0s()()}}function npe(i,t){1&i&&(o.j41(0,"div",2),o.nrm(1,"mat-spinner",4),o.k0s())}function rpe(i,t){1&i&&(o.j41(0,"span"),o.EFF(1,"Error loading base map."),o.k0s())}let ope=(()=>{class i{constructor(e,n,r){this.studyService=e,this.snackbar=n,this.injector=r,this.mapboxToken="pk.eyJ1IjoiZmVsaXJpY2tpIiwiYSI6ImNsdGRkYjZnZjAyOXcycXA3anN0ZHZqbW8ifQ.XHxBIr35WPQYtd9BshOTdA",this.currentMapState=(0,o.vPA)("initial"),this.currentEventsState=(0,o.vPA)("initial"),this.movingToPoint=(0,o.vPA)(!1),this.selectedLayer=mn.ArcLayer,this.studiesEmitter=new o.bkB,this.mapStateEmitter=new o.bkB,this.chunkInfoEmitter=new o.bkB,this.studyEmitter=new o.bkB,this.streamStatusEmitter=new o.bkB}ngOnInit(){}initializeMap(){if(!this.map)try{if(!fg().supported())return this.currentMapState.set("error"),void alert("Your browser does not support Mapbox GL.");console.log(`Using Mapbox GL JS v${fg().version}`),this.currentMapState.set("loading"),fg().accessToken=this.mapboxToken,this.map=new(fg().Map)({container:"map",style:"mapbox://styles/feliricki/cltqf12yx00p301p5dq5hcmiv",center:[0,0]}),this.map.addControl(new(fg().NavigationControl)).addControl(new(fg().ScaleControl)).addControl(new(fg().GeolocateControl)).addControl(new(fg().FullscreenControl)),this.map.on("load",()=>{if(!this.map)return void this.currentMapState.set("error");this.currentMapState.set("loaded"),this.emitMapState();const e=this.studyService.getAllStudiesGeoJSON();this.mainSubscription=e.subscribe({next:n=>{if(!this.map)return void this.currentMapState.set("error");this.layerControl=new wL(n),this.map=this.map.addControl(this.layerControl,"bottom-left"),this.currentCollection=n,this.studies=new Map;const r=new Set;for(const l of this.currentCollection.features.values()){if(null==l.properties.mainLocationLon||void 0===l.properties.mainLocationLat)continue;let m=`${l.properties.mainLocationLon.toString()},${l.properties.mainLocationLat.toString()}`;for(;r.has(m);)l.properties.mainLocationLon+=.002,l.geometry.coordinates[0]+=.002,m=`${l.properties.mainLocationLon.toString()},${l.properties.mainLocationLat.toString()}`;r.add(m),this.studies.set(l.properties.id,l.properties)}this.emitStudies(this.studies),mb(this.map,n,"studies"),this.initializeDeckOverlay(this.map),this.map.on("click","clusters",l=>{if(!this.map)return;const m=this.map.queryRenderedFeatures(l.point,{layers:["clusters"]}),C=m[0].properties.cluster_id;this.map.getSource("studies").getClusterExpansionZoom(C,(O,z)=>{O||!this.map||this.map.easeTo({center:m[0].geometry.coordinates,zoom:z})})}),this.map.on("click","unclustered-point",l=>{if(!this.map)return;const m=l.features,C=m[0].geometry.coordinates,A=m[0].properties;(new(fg().Popup)).setLngLat(C).setDOMContent(this.createPopupContent(A)).addTo(this.map)}),this.map.on("moveend",()=>{!1===this.movingToPoint()||!this.map||this.movingToPoint.set(!1)}),this.map.on("mouseenter","clusters",()=>{this.map&&(this.map.getCanvas().style.cursor="pointer")}),this.map.on("mouseleave","clusters",()=>{this.map&&(this.map.getCanvas().style.cursor="")}),this.map.on("mouseenter","unclustered-point",()=>{this.map&&(this.map.getCanvas().style.cursor="pointer")}),this.map.on("mouseleave","unclustered-point",()=>{this.map&&(this.map.getCanvas().style.cursor="")})},error:n=>{console.error(n),this.currentMapState.set("error")}})})}catch(e){console.error(e),this.currentMapState.set("error")}}ngOnChanges(e){for(const n in e){const r=e[n].currentValue;if(void 0!==r)switch(n){case"focusedPoint":this.focusedPoint=r,this.panToPoint(r);break;case"eventRequest":this.eventRequest=r,this.handleEventRequest(r);break;case"pointsVisible":this.pointsVisible=r,this.layerControl?.setStudiesVisibility(this.pointsVisible),this.togglePointsVisibility(this.pointsVisible);break;case"selectedLayer":this.selectedLayer=r,this.deckOverlay?.changeActiveLayer(this.selectedLayer);break;case"deckOverlayControls":this.deckOverlayControls=r,this.deckOverlay?.setLayerAttributes(this.deckOverlayControls);break;default:return}}}initializeDeckOverlay(e){this.deckOverlay=new ZG(e,this.selectedLayer),this.streamStatus$=wk(this.deckOverlay.StreamStatus,{injector:this.injector}),wk(this.deckOverlay.currentMetaData,{injector:this.injector}).pipe(ou(1)).subscribe({next:r=>this.emitChunkData(r),error:r=>console.error(r)}),this.streamStatusSubscription=this.streamStatus$.pipe(ou(1),su()).subscribe({next:r=>{const l=this.deckOverlay?.CurrentIndividuals().size??0;switch(r){case"standby":if(this.emitStreamStatus("standby"),0===l){this.openSnackBar("No Events Found.");break}this.openSnackBar(`Events found for ${l} animal(s).`);break;case"error":this.emitStreamStatus("error");break;case"streaming":this.emitStreamStatus("streaming")}},error:r=>console.error(r)})}togglePointsVisibility(e){if(!this.map||!this.currentCollection)return;let n=this.map.getSource("studies");n||(mb(this.map,this.currentCollection,"studies"),n=this.map.getSource("studies")),n.setData(e?this.currentCollection:{type:"FeatureCollection",features:[]})}handleEventRequest(e){this.map?this.deckOverlay?this.deckOverlay.loadData(e,{type:"mapbox",map:this.map}):console.error("DeckOverlay not set before receiving event request."):console.error("Map not set before receiving event request")}openSnackBar(e,n=2){this.snackbar.openFromComponent(b8,{duration:1e3*n,data:e})}panToPoint(e){if(!this.map||!this.studies)return;const n=this.studies.get(e);n&&(this.movingToPoint.set(!0),this.map.easeTo({center:[n.mainLocationLon??0,n.mainLocationLat??0],zoom:14}))}addMarker(e,n,r){let l=(new(fg().Marker)).setLngLat([n,e]);return void 0!==r&&(l=l.setPopup(r)),l}createPopupContent(e){const n=document.createElement("info-window-el");return n.currentStudy=e,n.eventRequest=this.studyEmitter,n}createPopUp(e){const n=new(fg().Popup),r=this.createPopupContent(e);return n.setDOMContent(r),n}emitMapState(){this.mapStateEmitter.emit(!0)}emitStudy(e){this.studyEmitter.emit(e)}emitStudies(e){this.studiesEmitter.emit(e)}emitChunkData(e){this.chunkInfoEmitter.emit(e)}emitStreamStatus(e){this.streamStatusEmitter.emit(e)}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(oO),o.rXU(v8),o.rXU(o.zZn))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-mapbox"]],inputs:{selectedLayer:"selectedLayer",focusedPoint:"focusedPoint",eventRequest:"eventRequest",pointsVisible:"pointsVisible",deckOverlayControls:"deckOverlayControls"},outputs:{studiesEmitter:"studiesEmitter",mapStateEmitter:"mapStateEmitter",chunkInfoEmitter:"chunkInfoEmitter",studyEmitter:"studyEmitter",streamStatusEmitter:"streamStatusEmitter"},standalone:!0,features:[o.OA$,o.aNF],decls:4,vars:1,consts:[["id","map"],[1,"button-container"],[1,"spinner-container"],["mat-raised-button","",3,"click"],["id","spinner"]],template:function(n,r){if(1&n&&(o.nrm(0,"div",0),o.DNE(1,ipe,3,0,"div",1)(2,npe,2,0,"div",2)(3,rpe,2,0,"span")),2&n){let l;o.R7$(),o.vxM("initial"===(l=r.currentMapState())?1:"loading"===l?2:"error"===l?3:-1)}},dependencies:[uV,dV,ea,Sc],styles:["#map[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;width:100%;height:100%;padding:0}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;z-index:54;margin-top:50vh}.spinner-container[_ngcontent-%COMP%]{display:flex;justify-content:center}#spinner[_ngcontent-%COMP%]{top:47vh}"],changeDetection:0})}}return i})();const spe=["sidenav"],ape=["rightSidenav"],lpe=["eventComponent"],cpe=(i,t)=>t[0],dpe=()=>({});function upe(i,t){1&i&&(o.j41(0,"mat-icon"),o.EFF(1,"chevron_left"),o.k0s())}function hpe(i,t){1&i&&(o.j41(0,"mat-icon"),o.EFF(1,"chevron_right"),o.k0s())}function fpe(i,t){if(1&i){const e=o.RV6();o.j41(0,"button",26),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.toggleSearchNav())}),o.DNE(1,upe,2,0,"mat-icon")(2,hpe,2,0,"mat-icon"),o.k0s()}if(2&i){const e=o.XpG();o.Y8G("hidden",!e.mapLoaded())("@leftPanelOpened",e.leftPanelOpened()),o.R7$(),o.vxM(e.leftPanelOpened()?1:2)}}function mpe(i,t){1&i&&(o.j41(0,"mat-icon"),o.EFF(1,"chevron_right"),o.k0s())}function ppe(i,t){1&i&&(o.j41(0,"mat-icon"),o.EFF(1,"chevron_left"),o.k0s())}function gpe(i,t){if(1&i){const e=o.RV6();o.j41(0,"button",27),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.toggleEventNav())}),o.DNE(1,mpe,2,0,"mat-icon")(2,ppe,2,0,"mat-icon"),o.k0s()}if(2&i){const e=o.XpG();o.Y8G("hidden",!e.mapLoaded())("@rightPanelOpened",e.rightPanelOpened()),o.R7$(),o.vxM(e.rightPanelOpened()?1:2)}}function _pe(i,t){if(1&i){const e=o.RV6();o.j41(0,"button",29),o.bIt("click",function(){o.eBV(e);const r=o.XpG(2);return o.Njj(r.openRightNav())}),o.j41(1,"mat-icon"),o.EFF(2,"chevron_left"),o.k0s()()}if(2&i){const e=o.XpG(2);o.Y8G("hidden",!e.mapLoaded())("@rightToggleClick",void 0)}}function vpe(i,t){if(1&i&&o.DNE(0,_pe,3,2,"button",28),2&i){const e=o.XpG(),n=o.sdS(7);o.vxM(e.rightNav.opened||n.opened?-1:0)}}function bpe(i,t){if(1&i){const e=o.RV6();o.j41(0,"app-simple-search",30),o.bIt("closeComponent",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.closeSearchNav())})("componentInitialized",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.initializeSearchNav())})("panToMarkerEvent",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateCurrentMarkers(r))}),o.k0s()}if(2&i){const e=o.XpG();o.Y8G("hidden",!e.searchOpened)("allStudies",e.currentStudies)}}function ype(i,t){if(1&i&&(o.j41(0,"button",31)(1,"mat-icon"),o.EFF(2,"menu"),o.k0s()()),2&i){o.XpG();const e=o.sdS(8),n=o.XpG();o.Y8G("ngStyle",n.menuXSmallStyle)("matMenuTriggerFor",e)}}function xpe(i,t){if(1&i&&(o.j41(0,"button",32)(1,"mat-icon"),o.EFF(2,"menu"),o.k0s()()),2&i){o.XpG();const e=o.sdS(8),n=o.XpG();o.Y8G("ngStyle",n.menuNormalStyle)("matMenuTriggerFor",e)}}function wpe(i,t){if(1&i&&(o.j41(0,"button",39)(1,"mat-icon"),o.EFF(2,"layers"),o.k0s()()),2&i){o.XpG();const e=o.sdS(27);o.Y8G("matMenuTriggerFor",e)}}function Cpe(i,t){if(1&i&&(o.j41(0,"button",40)(1,"mat-icon"),o.EFF(2,"layers"),o.k0s(),o.EFF(3," Layers "),o.k0s()),2&i){o.XpG();const e=o.sdS(27);o.Y8G("matMenuTriggerFor",e)}}function Epe(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-radio-button",45),o.bIt("change",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.layerOptionSelected(r))}),o.EFF(1),o.k0s()}if(2&i){const e=t.$implicit;o.Y8G("value",e[1]),o.R7$(),o.SpI("",e[0]," ")}}function Tpe(i,t){1&i&&(o.j41(0,"mat-icon"),o.EFF(1,"map"),o.k0s())}function Spe(i,t){1&i&&(o.j41(0,"mat-icon"),o.EFF(1,"satellite"),o.k0s())}function Mpe(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-button-toggle-group",43)(1,"mat-button-toggle",46),o.bIt("click",function(){o.eBV(e);const r=o.sdS(13),l=o.XpG(2);return o.Njj(l.setMapTypeGoogle(r.checked?"terrain":"roadmap"))}),o.DNE(2,Tpe,2,0,"mat-icon"),o.nI1(3,"async"),o.EFF(4," Map "),o.k0s(),o.j41(5,"mat-button-toggle",46),o.bIt("click",function(){o.eBV(e);const r=o.sdS(19),l=o.XpG(2);return o.Njj(l.setMapTypeGoogle(r.checked?"hybrid":"satellite"))}),o.DNE(6,Spe,2,0,"mat-icon"),o.nI1(7,"async"),o.EFF(8," Satellite "),o.k0s(),o.j41(9,"mat-menu",35,7)(11,"button",47)(12,"mat-checkbox",48,8),o.bIt("change",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.setMapTypeCheckbox(r))}),o.EFF(14," Terrain "),o.k0s()()(),o.j41(15,"mat-menu",35,9)(17,"button",47)(18,"mat-checkbox",49,10),o.bIt("change",function(r){o.eBV(e);const l=o.XpG(2);return o.Njj(l.setMapTypeCheckbox(r))}),o.EFF(20," Label "),o.k0s()()()()}if(2&i){const e=o.sdS(10),n=o.sdS(16),r=o.XpG(2);o.R7$(),o.Y8G("matMenuTriggerFor",e),o.R7$(),o.vxM(o.bMT(3,4,r.XSmallScreen$)?-1:2),o.R7$(3),o.Y8G("matMenuTriggerFor",n),o.R7$(),o.vxM(o.bMT(7,6,r.XSmallScreen$)?-1:6)}}function Ape(i,t){1&i&&(o.j41(0,"mat-icon"),o.EFF(1,"location_on"),o.k0s())}function Dpe(i,t){1&i&&(o.j41(0,"mat-icon"),o.EFF(1,"location_off"),o.k0s())}function kpe(i,t){if(1&i){const e=o.RV6();o.j41(0,"div",21)(1,"mat-toolbar",22),o.DNE(2,ype,3,2,"button",31),o.nI1(3,"async"),o.DNE(4,xpe,3,2,"button",32),o.nrm(5,"span",33),o.j41(6,"div",34)(7,"mat-menu",35,3)(9,"button",36),o.EFF(10,"Settings"),o.k0s(),o.j41(11,"button",37),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.gotoReferences())}),o.EFF(12,"Acknowledgements"),o.k0s()(),o.j41(13,"mat-menu",null,4)(15,"button",36),o.EFF(16,"Change Base Map"),o.k0s()(),o.j41(17,"mat-menu",38,5)(19,"button",37),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.setBaseMap("google"))}),o.EFF(20," Google Maps "),o.k0s(),o.j41(21,"button",37),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.setBaseMap("mapbox"))}),o.EFF(22," Mapbox "),o.k0s()(),o.DNE(23,wpe,3,1,"button",39),o.nI1(24,"async"),o.DNE(25,Cpe,4,1,"button",40),o.j41(26,"mat-menu",35,6)(28,"mat-radio-group",41),o.mxI("ngModelChange",function(r){o.eBV(e);const l=o.XpG();return o.DH7(l.radioGroupValue,r)||(l.radioGroupValue=r),o.Njj(r)}),o.Z7z(29,Epe,2,2,"mat-radio-button",42,cpe),o.k0s()(),o.DNE(31,Mpe,21,8,"mat-button-toggle-group",43),o.j41(32,"button",44),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.toggleMarkerVisibility())}),o.DNE(33,Ape,2,0,"mat-icon")(34,Dpe,2,0,"mat-icon"),o.k0s()(),o.nrm(35,"span",33),o.k0s()()}if(2&i){const e=o.sdS(14),n=o.sdS(18),r=o.XpG();o.R7$(2),o.vxM(o.bMT(3,7,r.XSmallScreen$)?2:4),o.R7$(7),o.Y8G("matMenuTriggerFor",e),o.R7$(6),o.Y8G("matMenuTriggerFor",n),o.R7$(8),o.vxM(o.bMT(24,9,r.XSmallScreen$)?23:25),o.R7$(5),o.R50("ngModel",r.radioGroupValue),o.R7$(),o.Dyx(r.layerMenuOptions),o.R7$(2),o.vxM("google"===r.activeMap()?31:-1),o.R7$(2),o.vxM(r.markersVisible()?34:33)}}function Ipe(i,t){if(1&i&&(o.j41(0,"button",31)(1,"mat-icon"),o.EFF(2,"menu"),o.k0s()()),2&i){o.XpG();const e=o.sdS(5),n=o.XpG();o.Y8G("ngStyle",n.menuXSmallStyle)("matMenuTriggerFor",e)}}function Rpe(i,t){if(1&i&&(o.j41(0,"button",32)(1,"mat-icon"),o.EFF(2,"menu"),o.k0s()()),2&i){o.XpG();const e=o.sdS(5),n=o.XpG();o.Y8G("ngStyle",n.menuNormalStyle)("matMenuTriggerFor",e)}}function Ppe(i,t){if(1&i){const e=o.RV6();o.j41(0,"mat-toolbar",22),o.DNE(1,Ipe,3,2,"button",31),o.nI1(2,"async"),o.DNE(3,Rpe,3,2,"button",32),o.j41(4,"mat-menu",35,3)(6,"button",36),o.EFF(7,"Settings"),o.k0s(),o.j41(8,"button",37),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.gotoReferences())}),o.EFF(9,"References"),o.k0s()(),o.j41(10,"mat-menu",null,4)(12,"button",36),o.EFF(13,"Change Base Map"),o.k0s()(),o.j41(14,"mat-menu",38,5)(16,"button",37),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.setBaseMap("google"))}),o.EFF(17," Google Maps "),o.k0s(),o.j41(18,"button",37),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.setBaseMap("mapbox"))}),o.EFF(19," Mapbox "),o.k0s()()()}if(2&i){const e=o.sdS(11),n=o.sdS(15),r=o.XpG();o.R7$(),o.vxM(o.bMT(2,3,r.XSmallScreen$)?1:3),o.R7$(5),o.Y8G("matMenuTriggerFor",e),o.R7$(6),o.Y8G("matMenuTriggerFor",n)}}function Ope(i,t){if(1&i){const e=o.RV6();o.j41(0,"button",50),o.bIt("click",function(){o.eBV(e);const r=o.XpG();return o.Njj(r.openSearchNav())}),o.j41(1,"mat-icon"),o.EFF(2,"chevron_right"),o.k0s()()}if(2&i){const e=o.XpG();o.Y8G("hidden",!e.leftButtonFlag())("@leftToggleClick",void 0)}}function Lpe(i,t){if(1&i){const e=o.RV6();o.j41(0,"app-google-map",51),o.bIt("mapStateEmitter",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateMapState(r))})("studiesEmitter",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateCurrentStudies(r))})("studyEmitter",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateCurrentStudy(r))})("chunkInfoEmitter",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateChunkMetadata(r))})("streamStatusEmitter",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateStreamState(r))}),o.k0s()}if(2&i){const e=o.XpG();o.Y8G("pathEventData$",e.currentEventLineData$)("focusedMarker",e.currentMarker)("eventRequest",e.currentEventRequest)("mapType",e.currentMapType)("selectedLayer",e.currentLayer())("markersVisible",e.markersVisible())("deckOverlayControls",e.currentControlOptions)}}function Fpe(i,t){if(1&i){const e=o.RV6();o.j41(0,"app-mapbox",52),o.bIt("mapStateEmitter",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateMapState(r))})("studyEmitter",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateCurrentStudy(r))})("studiesEmitter",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateCurrentStudies(r))})("chunkInfoEmitter",function(r){o.eBV(e);const l=o.XpG();return o.Njj(l.updateChunkMetadata(r))}),o.k0s()}if(2&i){const e=o.XpG();o.Y8G("focusedPoint",e.currentMarker)("eventRequest",e.currentEventRequest)("selectedLayer",e.currentLayer())("pointsVisible",e.markersVisible())("deckOverlayControls",e.currentControlOptions)}}function Npe(i,t){1&i&&(o.j41(0,"span"),o.EFF(1,"Default case for basemap switch case."),o.k0s())}let Bpe=(()=>{class i{constructor(e,n){this.breakpointObserver=e,this.router=n,this.options={fixed:!0,bottom:0,top:0},this.activeMap=(0,o.vPA)("mapbox"),this.mapLoaded=(0,o.vPA)(!1),this.searchOpened=(0,o.vPA)(!1),this.currentMapType="roadmap",this.currentLayer=(0,o.vPA)(mn.LineLayer),this.leftButtonFlag=(0,o.vPA)(!1),this.rightButtonFlag=(0,o.vPA)(!0),this.leftPanelOpened=(0,o.vPA)(!0),this.rightPanelOpened=(0,o.vPA)(!1),this.radioGroupInitialized=(0,o.vPA)(!1),this.markersVisible=(0,o.vPA)(!0),this.leftNavSmallStyle={"min-width":"100px","max-width":"400px",width:"100%"},this.leftNavLargeStyle={width:"400px"},this.menuXSmallStyle={"margin-top":"1.5em","margin-right":"0.5em"},this.menuNormalStyle={position:"fixed",left:"1em","margin-top":"0.5em"},this.rightNavStyle={"max-width":"700px","margin-top":"12em",height:"40em","background-color":"rgba(0,0,0,0)"},this.XSmallScreenActive=(0,o.vPA)(!1),this.radioGroupValue=mn.LineLayer,this.layerMenuOptions=[["Arc Layer",mn.ArcLayer],["Line Layer",mn.LineLayer],["Hexagon Layer",mn.HexagonLayer],["Scatterplot Layer",mn.ScatterplotLayer],["Screen Grid Layer",mn.ScreenGridLayer],["Heatmap Layer",mn.HeatmapLayer]]}ngOnInit(){(function dme(i,t){const e="object"==typeof t;return new Promise((n,r)=>{const l=new Hh.Ms({next:m=>{n(m),l.unsubscribe()},error:r,complete:()=>{e?n(t.defaultValue):r(new zi)}});i.subscribe(l)})})(this.breakpointObserver.observe([Cc_XSmall,Cc_Small]).pipe((0,st.T)(n=>n.matches))).then(n=>{n&&(this.closeSearchNav(),this.leftPanelOpened.set(!1))}),this.smallScreen$=this.breakpointObserver.observe([Cc_XSmall,Cc_Small]).pipe((0,st.T)(n=>n.matches)),this.XSmallScreen$=this.breakpointObserver.observe([Cc_XSmall]).pipe((0,st.T)(n=>n.matches))}ngOnDestroy(){}gotoReferences(){this.router.navigate(["/references"])}gotoSuggestionsPage(){this.router.navigate(["/suggestions"])}loadMap(){this.mapLoaded()||this.activeMap()}layerOptionSelected(e){this.selectedLayer(e.value)}selectedLayer(e){this.currentLayer.set(e)}updateMapState(e){this.mapLoaded.set(e)}initializeSearchNav(){this.searchOpened.set(!0)}updateLineStringData(e){this.currentEventLineData$=e}updateCurrentEventRequest(e){this.currentEventRequest=e}updateCurrentStudy(e){void 0!==e&&(this.openRightNav(),this.currentStudy=e)}updateCurrentStudies(e){this.currentStudies=e}updateCurrentMarkers(e){this.mapLoaded()&&(this.currentMarker=e)}updateChunkMetadata(e){this.currentChunkInfo=e}updateStreamState(e){this.currentStreamStatus=e}setMapTypeGoogle(e){("roadmap"===e||"terrain"==e)&&("terrain"==this.currentMapType||"roadmap"==this.currentMapType)||("satellite"===e||"hybrid"===e)&&("hybrid"===this.currentMapType||"satellite"===this.currentMapType)||(this.currentMapType=e)}setMapTypeCheckbox(e){this.currentMapType="roadmap"!==e.source.value?e.checked?"hybrid":"satellite":e.checked?"terrain":"roadmap"}setBaseMap(e){this.activeMap()!==e&&(this.resetGoogleMap(),this.activeMap.set(e),this.markersVisible.set(!0),this.mapLoaded.set(!1))}resetGoogleMap(){this.currentMapType="roadmap"}closeRightNav(){this.rightNav.close(),this.rightButtonFlag.set(!0),this.rightPanelOpened.set(!1)}openRightNav(){this.rightNav.opened||(this.rightPanelOpened.set(!0),this.rightNav.open().then(()=>{this.rightButtonFlag.set(!1)}))}closeSearchNav(){this.sidenav.close(),this.leftButtonFlag.set(!0),this.leftPanelOpened.set(!1)}openSearchNav(){this.leftPanelOpened.set(!0),this.sidenav.open().then(()=>{this.leftButtonFlag.set(!1)})}toggleSearchNav(){this.leftPanelOpened()?this.closeSearchNav():this.openSearchNav()}toggleEventNav(){this.rightPanelOpened()?this.closeRightNav():this.openRightNav()}toggleMarkerVisibility(){return this.markersVisible.update(e=>!e),this.markersVisible()}markerToggleLabel(){return this.markersVisible()?"Remove markers":"Add markers"}updateControlChanges(e){this.currentControlOptions=e}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(sa),o.rXU(Cd))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-tracker-view"]],viewQuery:function(n,r){if(1&n&&(o.GBs(spe,7),o.GBs(ape,7),o.GBs(lpe,5)),2&n){let l;o.mGM(l=o.lsd())&&(r.sidenav=l.first),o.mGM(l=o.lsd())&&(r.rightNav=l.first),o.mGM(l=o.lsd())&&(r.event=l.first)}},standalone:!0,features:[o.aNF],decls:25,vars:30,consts:[["sidenav",""],["rightSidenav",""],["eventComponent",""],["mainMenu","matMenu"],["settingsMenu","matMenu"],["basemaps","matMenu"],["layerMenu","matMenu"],["roadMap","matMenu"],["checkboxMap",""],["Satellitemenu","matMenu"],["checkboxSatellite",""],["mat-mini-fab","",1,"left-toggle-button",3,"hidden"],["mat-mini-fab","",1,"right-toggle-button",3,"hidden"],[1,"sidenav-container",3,"hasBackdrop"],["mode","over",1,"sidenav",3,"opened","fixedInViewport","disableClose","ngStyle"],[1,"search-container"],[3,"hidden","allStudies"],[1,"sidenav-content"],["position","end","mode","over",1,"right-sidenav",3,"ngStyle","opened","disableClose","fixedInViewport"],[3,"eventRequestEmitter","closeRightNavEmitter","controlOptionsEmitter","currentStudy","currentEventData","streamStatus","currentSelectedLayer"],[1,"sidenav-content-right"],[1,"toolbar-container"],["id","toolbar",1,"dense-3"],["mat-fab","",1,"toggle-button",3,"hidden"],[3,"pathEventData$","focusedMarker","eventRequest","mapType","selectedLayer","markersVisible","deckOverlayControls"],[3,"focusedPoint","eventRequest","selectedLayer","pointsVisible","deckOverlayControls"],["mat-mini-fab","",1,"left-toggle-button",3,"click","hidden"],["mat-mini-fab","",1,"right-toggle-button",3,"click","hidden"],["mat-fab","",1,"right-toggle-button-small",3,"hidden"],["mat-fab","",1,"right-toggle-button-small",3,"click","hidden"],[3,"closeComponent","componentInitialized","panToMarkerEvent","hidden","allStudies"],["mat-mini-fab","",1,"menu-button",3,"ngStyle","matMenuTriggerFor"],["mat-fab","",1,"menu-button",3,"ngStyle","matMenuTriggerFor"],[1,"spacer"],[1,"toolbar-elements"],["xPosition","after","yPosition","below"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["XPosition","before","yPosition","below"],["mat-mini-fab","","id","mini-fab-layer",1,"extended-fab",3,"matMenuTriggerFor"],["mat-fab","","extended","","matRipple","",1,"extended-fab",3,"matMenuTriggerFor"],[1,"layer-radio-group",3,"ngModelChange","ngModel"],[1,"layer-radio-button",3,"value"],[1,"toggle-group"],["mat-mini-fab","","matRipple","","color","primary",1,"marker-toggle",3,"click"],[1,"layer-radio-button",3,"change","value"],[3,"click","matMenuTriggerFor"],["mat-menu-item",""],["color","primary","value","roadmap",3,"change"],["color","primary","value","satellite",3,"change"],["mat-fab","",1,"toggle-button",3,"click","hidden"],[3,"mapStateEmitter","studiesEmitter","studyEmitter","chunkInfoEmitter","streamStatusEmitter","pathEventData$","focusedMarker","eventRequest","mapType","selectedLayer","markersVisible","deckOverlayControls"],[3,"mapStateEmitter","studyEmitter","studiesEmitter","chunkInfoEmitter","focusedPoint","eventRequest","selectedLayer","pointsVisible","deckOverlayControls"]],template:function(n,r){if(1&n){const l=o.RV6();o.DNE(0,fpe,3,3,"button",11),o.nI1(1,"async"),o.DNE(2,gpe,3,3,"button",12),o.nI1(3,"async"),o.DNE(4,vpe,1,1),o.j41(5,"mat-sidenav-container",13)(6,"mat-sidenav",14,0),o.nI1(8,"async"),o.j41(9,"div",15),o.DNE(10,bpe,1,2,"app-simple-search",16),o.k0s()(),o.j41(11,"mat-sidenav-content",17)(12,"mat-sidenav",18,1),o.nI1(14,"async"),o.j41(15,"app-events",19,2),o.bIt("eventRequestEmitter",function(C){return o.eBV(l),o.Njj(r.updateCurrentEventRequest(C))})("closeRightNavEmitter",function(){return o.eBV(l),o.Njj(r.closeRightNav())})("controlOptionsEmitter",function(C){return o.eBV(l),o.Njj(r.updateControlChanges(C))}),o.k0s()(),o.j41(17,"mat-sidenav-content",20),o.DNE(18,kpe,36,11,"div",21)(19,Ppe,20,5,"mat-toolbar",22)(20,Ope,3,2,"button",23),o.nI1(21,"async"),o.DNE(22,Lpe,1,7,"app-google-map",24)(23,Fpe,1,5,"app-mapbox",25)(24,Npe,2,0,"span"),o.k0s()()()}if(2&n){let l;const m=o.sdS(7);o.vxM(o.bMT(1,19,r.smallScreen$)?-1:0),o.R7$(2),o.vxM(!o.bMT(3,21,r.smallScreen$)&&r.mapLoaded()?2:4),o.R7$(3),o.Y8G("hasBackdrop",!1),o.R7$(),o.Y8G("opened",!0)("fixedInViewport",!0)("disableClose",!0)("ngStyle",o.bMT(8,23,r.XSmallScreen$)?r.leftNavSmallStyle:r.leftNavLargeStyle),o.R7$(4),o.vxM(m.opened||r.searchOpened()?10:-1),o.R7$(2),o.Y8G("ngStyle",o.bMT(14,25,r.smallScreen$)?o.lJ4(29,dpe):r.rightNavStyle)("opened",!1)("disableClose",!0)("fixedInViewport",!0),o.R7$(3),o.Y8G("currentStudy",r.currentStudy)("currentEventData",r.currentChunkInfo)("streamStatus",r.currentStreamStatus)("currentSelectedLayer",r.currentLayer()),o.R7$(3),o.vxM(r.mapLoaded()?18:19),o.R7$(2),o.vxM(!0===r.leftButtonFlag()&&o.bMT(21,27,r.smallScreen$)?20:-1),o.R7$(2),o.vxM("google"===(l=r.activeMap())?22:"mapbox"===l?23:24)}},dependencies:[cme,ope,Qae,I$,R$,pz,ea,jE,iA,Vae,Zne,Er,Mr,mc,xf,$w,Hw,_me,zW,c4,Ime,qk,oL,kme,BO,epe,X$,UO,ul,dl,TO,JH,QH,WV,Pk,Sk,LV],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.sidenav-container[_ngcontent-%COMP%]{position:fixed;height:100%;width:100%}.search-container[_ngcontent-%COMP%]{position:relative}.sidenav-content[_ngcontent-%COMP%]{position:relative;background-color:#fff;width:100%;height:100%;border:1px solid rgba(0,0,0,.5)}.toolbar-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.expansion-panel-header[_ngcontent-%COMP%]{font-size:10px;background-color:green}.toggle-button[_ngcontent-%COMP%]{position:absolute;color:#000;background-color:#fff;margin-top:50vh;z-index:3}.left-toggle-button[_ngcontent-%COMP%]{position:absolute;z-index:3;top:33vh;background-color:#fff;color:#000}.left-toggle-button.is-flipped[_ngcontent-%COMP%]{transform:rotate(-180deg)}.right-toggle-button[_ngcontent-%COMP%]{position:absolute;color:#000;background-color:#fff;top:33vh;z-index:2}.right-toggle-button-small[_ngcontent-%COMP%]{position:absolute;color:#000;background-color:#fff;top:50vh;right:.1em;z-index:3}.right-sidenav[_ngcontent-%COMP%]{z-index:4;box-shadow:none}.toolbar-elements[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap}.toolbar-elements[_ngcontent-%COMP%]   #mini-fab-layer[_ngcontent-%COMP%]{margin-top:1.75em;background-color:#fff;color:#000}.toolbar-elements[_ngcontent-%COMP%]   .extended-fab[_ngcontent-%COMP%]{margin-top:1.5em;margin-left:0;background-color:#fff;color:#000}.toolbar-elements[_ngcontent-%COMP%]   .toggle-group[_ngcontent-%COMP%]{margin-left:.25em;margin-top:1em;z-index:3;border-radius:15px}.toolbar-elements[_ngcontent-%COMP%]   .toggle-group[_ngcontent-%COMP%]   mat-button-toggle[_ngcontent-%COMP%]{font-style:normal}.toolbar-elements[_ngcontent-%COMP%]   .marker-toggle[_ngcontent-%COMP%]{margin-top:1.5em;margin-left:.5em;background-color:#fff;color:#000}#slide-toggle[_ngcontent-%COMP%]{margin-right:1em}.menu-button[_ngcontent-%COMP%]{position:absolute;margin-top:.5em;z-index:3;background-color:#fff;color:#000}.settings-button[_ngcontent-%COMP%]{position:fixed;right:1em;margin-top:.5em}#toolbar[_ngcontent-%COMP%]{position:absolute;z-index:1;background-color:#0000;width:100%}#toolbar[_ngcontent-%COMP%]   .chip-listbox[_ngcontent-%COMP%]{position:relative;left:400px;margin-left:1em;margin-right:1em;margin-top:1em}#toolbar[_ngcontent-%COMP%]   .home-button[_ngcontent-%COMP%]{background-color:#fff;color:#000}#toolbar[_ngcontent-%COMP%]   .extended-fab[_ngcontent-%COMP%]{height:2.5em}.layer-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-content:flex-start}.layer-radio-group[_ngcontent-%COMP%]   .layer-radio-button[_ngcontent-%COMP%]{margin-right:1em}"],data:{animation:[js("leftToggleClick",[oo("void => *",[gn({transform:"translateX(-100%)"}),co(".3s ease-in")])]),js("rightToggleClick",[oo("void => *",[gn({transform:"translateX(100%)"}),co(".3s ease-in")])]),js("leftPanelOpened",[Lo("true",gn({left:"calc(400px - 1.5em)"})),Lo("false",gn({left:".3em"})),oo("true => false",[co("300ms cubic-bezier(0, 0, 0, 1)",gn({transform:"translate(calc(-400px + 1.5em + .3em))"}))]),oo("false => true",[co("325ms cubic-bezier(0, 0, 0, 1)",gn({transform:"translate(calc(400px - 1.5em - .3em))"}))])]),js("rightPanelOpened",[Lo("true",gn({left:"calc(100vw - 47.75em)"})),Lo("false",gn({right:".3265em"})),oo("true => false",[co("300ms cubic-bezier(0, 0, 0, 1)",gn({transform:"translate(calc(44.485em))"}))]),oo("false => true",[co("325ms cubic-bezier(0, 0, 0, 1)",gn({transform:"translate(calc(-44.485em))"}))])])]},changeDetection:0})}}return i})(),Vpe=(()=>{class i{constructor(){}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-home"]],standalone:!0,features:[o.aNF],decls:1,vars:0,template:function(n,r){1&n&&o.nrm(0,"app-tracker-view")},dependencies:[Bpe]})}}return i})(),zpe=(()=>{class i{getErrors(e,n,r=null){const l=[];return Object.keys(e.errors||{}).forEach(m=>{switch(m){case"required":l.push(`${n} ${r?.[m]??"is required."} `);break;case"pattern":l.push(`${n} ${r?.[m]??" contains invalid characters."}`);break;case"isDupeField":l.push(`${n} ${r?.[m]??"already exists: choose another."}`);break;default:l.push(`${n} is invalid.`)}}),l}constructor(){}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-base-form"]],decls:0,vars:0,template:function(n,r){},encapsulation:2})}}return i})(),Upe=(()=>{class i{constructor(e){this.httpClient=e,this._authStatus=new xi.B,this.authStatus=this._authStatus.asObservable(),this.tokenKey="tokenKey"}isAuthenticated(){return null!==this.getToken()}getToken(){return localStorage.getItem(this.tokenKey)}init(){this.isAuthenticated()&&this.setAuthStatus(!0)}login(e){return this.httpClient.post(U__baseUrl+"api/Account/Login",e).pipe(Oo(r=>{r.success&&r.token&&(localStorage.setItem(this.tokenKey,r.token),this.setAuthStatus(!0))}))}logout(){localStorage.removeItem(this.tokenKey),this.setAuthStatus(!1)}setAuthStatus(e){this._authStatus.next(e)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(Em))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const jpe=()=>["/"];function Gpe(i,t){if(1&i&&(o.j41(0,"mat-error")(1,"strong"),o.EFF(2,"ERROR"),o.k0s(),o.EFF(3),o.k0s()),2&i){const e=o.XpG();o.R7$(3),o.SpI(": ",e.loginResult.message," ")}}function Hpe(i,t){if(1&i&&(o.j41(0,"mat-error"),o.EFF(1),o.k0s()),2&i){const e=t.$implicit;o.R7$(),o.SpI(" ",e," ")}}function $pe(i,t){if(1&i&&(o.j41(0,"mat-error"),o.EFF(1),o.k0s()),2&i){const e=t.$implicit;o.R7$(),o.SpI(" ",e," ")}}const Wpe=[{path:"",component:Vpe,pathMatch:"full"},{path:"references",component:(()=>{class i{constructor(){}currentYear(){return(new Date).getFullYear()}currentDate(){return new Date}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-reference"]],standalone:!0,features:[o.aNF],decls:28,vars:5,consts:[[1,"text-container"],["href","https://movebank.org"],["href","https://www.icarus.mpg.de/29143/animal-tracker-app"],["href","https://www.flaticon.com/free-icons/location","title","location icons"],["href","https://doi.org/10.1111/2041-210X.13767"]],template:function(n,r){1&n&&(o.nrm(0,"br")(1,"br")(2,"br"),o.j41(3,"div",0)(4,"h4"),o.EFF(5,"Acknowledgements"),o.k0s(),o.j41(6,"p"),o.EFF(7," This project would not be possible without "),o.j41(8,"a",1),o.EFF(9,"Movebank.org"),o.k0s(),o.EFF(10,", and its many contributors. Consider supporting the official "),o.j41(11,"a",2),o.EFF(12,"Animal Tracker App"),o.k0s(),o.EFF(13," if you're on a mobile device. "),o.k0s(),o.j41(14,"h4"),o.EFF(15,"Credits"),o.k0s(),o.j41(16,"p")(17,"a",3),o.EFF(18,"Location icons created by IconMarketPK - Flaticon"),o.k0s()(),o.j41(19,"p")(20,"em"),o.EFF(21),o.nI1(22,"date"),o.k0s()(),o.j41(23,"p")(24,"em"),o.EFF(25," Kays R, Davidson SC, Berger M, Bohrer G, Fiedler W, Flack A, Hirt J, Hahn C, Gauggel D, Russell B, et al. 2022. The Movebank system for studying global animal movement and demography. Methods Ecol Evol. 13(2):419-431. "),o.j41(26,"a",4),o.EFF(27,"https://doi.org/10.1111/2041-210X.13767"),o.k0s()()()()),2&n&&(o.R7$(21),o.Lme(" Wikelski M, Davidson SC, Kays R. ",r.currentYear(),". Movebank: archive, analysis and sharing of animal movement data. Hosted by the Max Planck Institute of Animal Behavior. www.movebank.org, accessed on ",o.i5U(22,2,r.currentDate(),"full"),". "))},dependencies:[Z_],styles:[".text-container[_ngcontent-%COMP%]{margin-left:2em;margin-right:2em;text-align:center}"]})}}return i})()},{path:"login",component:(()=>{class i extends zpe{constructor(e,n){super(),this.router=e,this.authService=n,this.hide=!0}ngOnInit(){console.log("loading login form"),this.form=new nC({username:new df("",TS.required),password:new df("",TS.required)})}onSubmit(){const e={};e.username=this.form.controls.username.value,e.password=this.form.controls.password.value,this.authService.login(e).subscribe({next:n=>{console.log(n),this.loginResult=n,n.success&&this.router.navigate(["/"])},error:n=>{console.log(n),401==n.status&&(this.loginResult=n.error)},complete:()=>console.log("Completed get request for Login Component.")})}static{this.\u0275fac=function(n){return new(n||i)(o.rXU(Cd),o.rXU(Upe))}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-login"]],standalone:!0,features:[o.Vt3,o.aNF],decls:29,vars:8,consts:[[1,"login"],[3,"ngSubmit","formGroup"],[4,"ngIf"],[1,"username-container"],["matInput","","formControlName","username","required","","placeholder","Insert email or username."],[4,"ngFor","ngForOf"],[1,"password-container"],["matInput","","formControlName","password","required","","placeholder","Insert Password",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],["mat-flat-button","","color","primary","type","submit",1,"submit-button"],["mat-flat-button","","color","secondary",1,"cancel-button",3,"routerLink"]],template:function(n,r){1&n&&(o.nrm(0,"br")(1,"br")(2,"br"),o.j41(3,"div",0)(4,"h1"),o.EFF(5,"Login"),o.k0s(),o.j41(6,"form",1),o.bIt("ngSubmit",function(){return r.onSubmit()}),o.j41(7,"p"),o.DNE(8,Gpe,4,1,"mat-error",2),o.k0s(),o.j41(9,"div",3)(10,"mat-form-field")(11,"mat-label"),o.EFF(12,"Username/Email:"),o.k0s(),o.nrm(13,"input",4),o.DNE(14,Hpe,2,1,"mat-error",5),o.k0s()(),o.j41(15,"div",6)(16,"mat-form-field")(17,"mat-label"),o.EFF(18,"Password:"),o.k0s(),o.nrm(19,"input",7),o.j41(20,"button",8),o.bIt("click",function(){return r.hide=!r.hide}),o.j41(21,"mat-icon"),o.EFF(22),o.k0s()(),o.DNE(23,$pe,2,1,"mat-error",5),o.k0s()(),o.j41(24,"div")(25,"button",9),o.EFF(26," Login "),o.k0s(),o.j41(27,"button",10),o.EFF(28," Cancel "),o.k0s()()()()),2&n&&(o.R7$(6),o.Y8G("formGroup",r.form),o.R7$(2),o.Y8G("ngIf",r.loginResult&&!r.loginResult.success),o.R7$(6),o.Y8G("ngForOf",r.getErrors(r.form.get("username"),"Email")),o.R7$(5),o.Y8G("type",r.hide?"password":"text"),o.R7$(3),o.JRh(r.hide?"visibility_off":"visibility"),o.R7$(),o.Y8G("ngForOf",r.getErrors(r.form.get("password"),"Password")),o.R7$(4),o.Y8G("routerLink",o.lJ4(7,jpe)))},dependencies:[Pk,vO,Tk,Sk,lO,yO,wO,Fb,Rk,fc,kS,Lk,Ok,EH,UV,fz,hz,Eu,ea,Sc,mu,Er,Mr,Tv],styles:[".username-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-left:1em;margin-right:1em}.username-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:500px;min-width:100px}.password-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-left:1em;margin-right:1em}.password-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:500px;min-width:100px}.submit-button[_ngcontent-%COMP%]{background:#045c41}.login[_ngcontent-%COMP%]{text-align:center}.login[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{position:relative;text-align:center}"]})}}return i})()},{path:"**",component:(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=o.VBU({type:i,selectors:[["app-page-not-found"]],standalone:!0,features:[o.aNF],decls:2,vars:0,template:function(n,r){1&n&&(o.j41(0,"h2"),o.EFF(1,"Page Not Found"),o.k0s())},dependencies:[os]})}}return i})()}];let Xpe=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=o.$C({type:i})}static{this.\u0275inj=o.G2t({imports:[Ed.forRoot(Wpe),Ed]})}}return i})(),qpe=(()=>{class i{constructor(){}intercept(e,n){const r=e.clone();return n.handle(r)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const US=new Ai.c(Gc.l),Zpe={connector:()=>new xi.B};function ZW(i,t=Zpe){const{connector:e}=t;return(0,ut.N)((n,r)=>{const l=e();pn(i(function Ype(i){return new Ai.c(t=>i.subscribe(t))}(l))).subscribe(r),r.add(n.subscribe(l))})}const Yk="Service workers are disabled or not supported by this browser";class dL{constructor(t){if(this.serviceWorker=t,t){const n=bu(t,"controllerchange").pipe((0,st.T)(()=>t.controller)),l=bo(ir(()=>di(t.controller)),n);this.worker=l.pipe(Ur(z=>!!z)),this.registration=this.worker.pipe(So(()=>t.getRegistration()));const O=bu(t,"message").pipe((0,st.T)(z=>z.data)).pipe(Ur(z=>z&&z.type)).pipe(function Qpe(i){return i?t=>ZW(i)(t):t=>function Kpe(i,t){const e=(0,_.T)(i)?i:()=>i;return(0,_.T)(t)?ZW(t,{connector:e}):n=>new Ps(n,e)}(new xi.B)(t)}());O.connect(),this.events=O}else this.worker=this.events=this.registration=function Jpe(i){return ir(()=>$s(new Error(i)))}(Yk)}postMessage(t,e){return this.worker.pipe(gs(1),Oo(n=>{n.postMessage({action:t,...e})})).toPromise().then(()=>{})}postMessageWithOperation(t,e,n){const r=this.waitForOperationCompleted(n),l=this.postMessage(t,e);return Promise.all([l,r]).then(([,m])=>m)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(t){let e;return e="string"==typeof t?n=>n.type===t:n=>t.includes(n.type),this.events.pipe(Ur(e))}nextEventOfType(t){return this.eventsOfType(t).pipe(gs(1))}waitForOperationCompleted(t){return this.eventsOfType("OPERATION_COMPLETED").pipe(Ur(e=>e.nonce===t),gs(1),(0,st.T)(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let ege=(()=>{class i{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,this.pushManager=null,this.subscriptionChanges=new xi.B,!e.isEnabled)return this.messages=US,this.notificationClicks=US,void(this.subscription=US);this.messages=this.sw.eventsOfType("PUSH").pipe((0,st.T)(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe((0,st.T)(r=>r.data)),this.pushManager=this.sw.registration.pipe((0,st.T)(r=>r.pushManager));const n=this.pushManager.pipe(So(r=>r.getSubscription()));this.subscription=Io(n,this.subscriptionChanges)}requestSubscription(e){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(Yk));const n={userVisibleOnly:!0};let r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),l=new Uint8Array(new ArrayBuffer(r.length));for(let m=0;m<r.length;m++)l[m]=r.charCodeAt(m);return n.applicationServerKey=l,this.pushManager.pipe(So(m=>m.subscribe(n)),gs(1)).toPromise().then(m=>(this.subscriptionChanges.next(m),m))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(gs(1),So(n=>{if(null===n)throw new Error("Not subscribed to push notifications.");return n.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(Yk))}decodeBase64(e){return atob(e)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(dL))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})(),tge=(()=>{class i{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=US,void(this.unrecoverable=US);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Yk));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Yk));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static{this.\u0275fac=function(n){return new(n||i)(o.KVO(dL))}}static{this.\u0275prov=o.jDH({token:i,factory:i.\u0275fac})}}return i})();const KW=new o.nKC("");function ige(i,t,e,n){return()=>{if(!Km(n)||!("serviceWorker"in navigator)||!1===e.enabled)return;const r=i.get(o.SKi),l=i.get(o.o8S);let m;if(r.runOutsideAngular(()=>{const C=navigator.serviceWorker,A=()=>C.controller?.postMessage({action:"INITIALIZE"});C.addEventListener("controllerchange",A),l.onDestroy(()=>{C.removeEventListener("controllerchange",A)})}),"function"==typeof e.registrationStrategy)m=e.registrationStrategy();else{const[C,...A]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(C){case"registerImmediately":m=di(null);break;case"registerWithDelay":m=QW(+A[0]||0);break;case"registerWhenStable":m=A[0]?Io(JW(i),QW(+A[0])):JW(i);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}r.runOutsideAngular(()=>m.pipe(gs(1)).subscribe(()=>navigator.serviceWorker.register(t,{scope:e.scope}).catch(C=>console.error("Service worker registration failed with:",C))))}}function QW(i){return di(null).pipe(NO(i))}function JW(i){return i.get(o.o8S).isStable.pipe(Ur(e=>e))}function nge(i,t){return new dL(Km(t)&&!1!==i.enabled?navigator.serviceWorker:void 0)}class g4{}(function tu(i,t){return(0,o.TL3)({rootComponent:i,...Ml(t)})})(SL,{providers:[(0,o.oKB)(ha,Pk,wO,Xpe),{provide:Yw,useClass:qpe,multi:!0},function a(...i){const t=[Em,Qw,ab,{provide:g_,useExisting:ab},{provide:l0,useFactory:()=>(0,o.WQX)(tc,{optional:!0})??(0,o.WQX)(Qw)},{provide:Wp,useValue:p0,multi:!0},{provide:hl,useValue:!0},{provide:fs,useClass:n1}];for(const e of i)t.push(...e.\u0275providers);return(0,o.EmA)(t)}(function f(){return function rh(i,t){return{\u0275kind:i,\u0275providers:t}}(nh.LegacyInterceptors,[{provide:d,useFactory:Wh},{provide:Wp,useExisting:d,multi:!0}])}()),function fF(){return(0,o.ngT)("NgEagerAnimations"),[...uF]}(),function rge(i,t={}){return(0,o.EmA)([ege,tge,{provide:KW,useValue:i},{provide:g4,useValue:t},{provide:dL,useFactory:nge,deps:[g4,o.Agw]},{provide:o.hnV,useFactory:ige,deps:[o.zZn,KW,g4,o.Agw],multi:!0}])}("ngsw-worker.js",{enabled:!(0,o.naY)(),registrationStrategy:"registerWhenStable:30000"})]}).catch(i=>console.error(i))},362:Go=>{"use strict";Go.exports=function Gn(It,o){if(It===o)return!0;if(It&&o&&"object"==typeof It&&"object"==typeof o){if(It.constructor!==o.constructor)return!1;var Yt,Ai,_;if(Array.isArray(It)){if((Yt=It.length)!=o.length)return!1;for(Ai=Yt;0!=Ai--;)if(!Gn(It[Ai],o[Ai]))return!1;return!0}if(It.constructor===RegExp)return It.source===o.source&&It.flags===o.flags;if(It.valueOf!==Object.prototype.valueOf)return It.valueOf()===o.valueOf();if(It.toString!==Object.prototype.toString)return It.toString()===o.toString();if((Yt=(_=Object.keys(It)).length)!==Object.keys(o).length)return!1;for(Ai=Yt;0!=Ai--;)if(!Object.prototype.hasOwnProperty.call(o,_[Ai]))return!1;for(Ai=Yt;0!=Ai--;){var Tt=_[Ai];if(!Gn(It[Tt],o[Tt]))return!1}return!0}return It!=It&&o!=o}},511:(Go,Gn,It)=>{var o;!function(Yt,Ai,_,Tt){"use strict";var tr,Si=["","webkit","Moz","MS","ms","o"],Ri=Ai.createElement("div"),Ar="function",Kt=Math.round,ui=Math.abs,Ft=Date.now;function Li(Ae,Oe,Ve){return setTimeout(Ki(Ae,Ve),Oe)}function er(Ae,Oe,Ve){return!!Array.isArray(Ae)&&(ji(Ae,Ve[Oe],Ve),!0)}function ji(Ae,Oe,Ve){var Et;if(Ae)if(Ae.forEach)Ae.forEach(Oe,Ve);else if(Ae.length!==Tt)for(Et=0;Et<Ae.length;)Oe.call(Ve,Ae[Et],Et,Ae),Et++;else for(Et in Ae)Ae.hasOwnProperty(Et)&&Oe.call(Ve,Ae[Et],Et,Ae)}function un(Ae,Oe,Ve){var Et="DEPRECATED METHOD: "+Oe+"\n"+Ve+" AT \n";return function(){var Qt=new Error("get-stack-trace"),Ei=Qt&&Qt.stack?Qt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",fn=Yt.console&&(Yt.console.warn||Yt.console.log);return fn&&fn.call(Yt.console,Et,Ei),Ae.apply(this,arguments)}}tr="function"!=typeof Object.assign?function(Oe){if(Oe===Tt||null===Oe)throw new TypeError("Cannot convert undefined or null to object");for(var Ve=Object(Oe),Et=1;Et<arguments.length;Et++){var Qt=arguments[Et];if(Qt!==Tt&&null!==Qt)for(var Ei in Qt)Qt.hasOwnProperty(Ei)&&(Ve[Ei]=Qt[Ei])}return Ve}:Object.assign;var bi=un(function(Oe,Ve,Et){for(var Qt=Object.keys(Ve),Ei=0;Ei<Qt.length;)(!Et||Et&&Oe[Qt[Ei]]===Tt)&&(Oe[Qt[Ei]]=Ve[Qt[Ei]]),Ei++;return Oe},"extend","Use `assign`."),Di=un(function(Oe,Ve){return bi(Oe,Ve,!0)},"merge","Use `assign`.");function ki(Ae,Oe,Ve){var Qt,Et=Oe.prototype;(Qt=Ae.prototype=Object.create(Et)).constructor=Ae,Qt._super=Et,Ve&&tr(Qt,Ve)}function Ki(Ae,Oe){return function(){return Ae.apply(Oe,arguments)}}function mt(Ae,Oe){return typeof Ae==Ar?Ae.apply(Oe&&Oe[0]||Tt,Oe):Ae}function yi(Ae,Oe){return Ae===Tt?Oe:Ae}function en(Ae,Oe,Ve){ji(St(Oe),function(Et){Ae.addEventListener(Et,Ve,!1)})}function mi(Ae,Oe,Ve){ji(St(Oe),function(Et){Ae.removeEventListener(Et,Ve,!1)})}function Mn(Ae,Oe){for(;Ae;){if(Ae==Oe)return!0;Ae=Ae.parentNode}return!1}function vn(Ae,Oe){return Ae.indexOf(Oe)>-1}function St(Ae){return Ae.trim().split(/\s+/g)}function Vn(Ae,Oe,Ve){if(Ae.indexOf&&!Ve)return Ae.indexOf(Oe);for(var Et=0;Et<Ae.length;){if(Ve&&Ae[Et][Ve]==Oe||!Ve&&Ae[Et]===Oe)return Et;Et++}return-1}function yn(Ae){return Array.prototype.slice.call(Ae,0)}function Ii(Ae,Oe,Ve){for(var Et=[],Qt=[],Ei=0;Ei<Ae.length;){var fn=Oe?Ae[Ei][Oe]:Ae[Ei];Vn(Qt,fn)<0&&Et.push(Ae[Ei]),Qt[Ei]=fn,Ei++}return Ve&&(Et=Oe?Et.sort(function(Pi,Zo){return Pi[Oe]>Zo[Oe]}):Et.sort()),Et}function an(Ae,Oe){for(var Ve,Et,Qt=Oe[0].toUpperCase()+Oe.slice(1),Ei=0;Ei<Si.length;){if((Et=(Ve=Si[Ei])?Ve+Qt:Oe)in Ae)return Et;Ei++}return Tt}var Vr=1;function Hr(Ae){var Oe=Ae.ownerDocument||Ae;return Oe.defaultView||Oe.parentWindow||Yt}var va="ontouchstart"in Yt,jt=an(Yt,"PointerEvent")!==Tt,ta=va&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Za="touch",zr="mouse",la=25,io=1,Qe=4,nt=8,Xt=1,kt=2,qt=4,Bt=8,pi=16,pn=kt|qt,Pr=Bt|pi,br=pn|Pr,Ho=["x","y"],qo=["clientX","clientY"];function lt(Ae,Oe){var Ve=this;this.manager=Ae,this.callback=Oe,this.element=Ae.element,this.target=Ae.options.inputTarget,this.domHandler=function(Et){mt(Ae.options.enable,[Ae])&&Ve.handler(Et)},this.init()}function Ce(Ae,Oe,Ve){var Et=Ve.pointers.length,Qt=Ve.changedPointers.length,Ei=Oe&io&&Et-Qt==0,fn=Oe&(Qe|nt)&&Et-Qt==0;Ve.isFirst=!!Ei,Ve.isFinal=!!fn,Ei&&(Ae.session={}),Ve.eventType=Oe,function He(Ae,Oe){var Ve=Ae.session,Et=Oe.pointers,Qt=Et.length;Ve.firstInput||(Ve.firstInput=Ht(Oe)),Qt>1&&!Ve.firstMultiple?Ve.firstMultiple=Ht(Oe):1===Qt&&(Ve.firstMultiple=!1);var Ei=Ve.firstInput,fn=Ve.firstMultiple,An=fn?fn.center:Ei.center,Pi=Oe.center=hi(Et);Oe.timeStamp=Ft(),Oe.deltaTime=Oe.timeStamp-Ei.timeStamp,Oe.angle=$i(An,Pi),Oe.distance=wi(An,Pi),function ut(Ae,Oe){var Ve=Oe.center,Et=Ae.offsetDelta||{},Qt=Ae.prevDelta||{},Ei=Ae.prevInput||{};(Oe.eventType===io||Ei.eventType===Qe)&&(Qt=Ae.prevDelta={x:Ei.deltaX||0,y:Ei.deltaY||0},Et=Ae.offsetDelta={x:Ve.x,y:Ve.y}),Oe.deltaX=Qt.x+(Ve.x-Et.x),Oe.deltaY=Qt.y+(Ve.y-Et.y)}(Ve,Oe),Oe.offsetDirection=Ni(Oe.deltaX,Oe.deltaY);var Zo=gt(Oe.deltaTime,Oe.deltaX,Oe.deltaY);Oe.overallVelocityX=Zo.x,Oe.overallVelocityY=Zo.y,Oe.overallVelocity=ui(Zo.x)>ui(Zo.y)?Zo.x:Zo.y,Oe.scale=fn?function eo(Ae,Oe){return wi(Oe[0],Oe[1],qo)/wi(Ae[0],Ae[1],qo)}(fn.pointers,Et):1,Oe.rotation=fn?function jn(Ae,Oe){return $i(Oe[1],Oe[0],qo)+$i(Ae[1],Ae[0],qo)}(fn.pointers,Et):0,Oe.maxPointers=Ve.prevInput?Oe.pointers.length>Ve.prevInput.maxPointers?Oe.pointers.length:Ve.prevInput.maxPointers:Oe.pointers.length,function bt(Ae,Oe){var Qt,Ei,fn,An,Ve=Ae.lastInterval||Oe,Et=Oe.timeStamp-Ve.timeStamp;if(Oe.eventType!=nt&&(Et>la||Ve.velocity===Tt)){var Pi=Oe.deltaX-Ve.deltaX,Zo=Oe.deltaY-Ve.deltaY,nn=gt(Et,Pi,Zo);Ei=nn.x,fn=nn.y,Qt=ui(nn.x)>ui(nn.y)?nn.x:nn.y,An=Ni(Pi,Zo),Ae.lastInterval=Oe}else Qt=Ve.velocity,Ei=Ve.velocityX,fn=Ve.velocityY,An=Ve.direction;Oe.velocity=Qt,Oe.velocityX=Ei,Oe.velocityY=fn,Oe.direction=An}(Ve,Oe);var nn=Ae.element;Mn(Oe.srcEvent.target,nn)&&(nn=Oe.srcEvent.target),Oe.target=nn}(Ae,Ve),Ae.emit("hammer.input",Ve),Ae.recognize(Ve),Ae.session.prevInput=Ve}function Ht(Ae){for(var Oe=[],Ve=0;Ve<Ae.pointers.length;)Oe[Ve]={clientX:Kt(Ae.pointers[Ve].clientX),clientY:Kt(Ae.pointers[Ve].clientY)},Ve++;return{timeStamp:Ft(),pointers:Oe,center:hi(Oe),deltaX:Ae.deltaX,deltaY:Ae.deltaY}}function hi(Ae){var Oe=Ae.length;if(1===Oe)return{x:Kt(Ae[0].clientX),y:Kt(Ae[0].clientY)};for(var Ve=0,Et=0,Qt=0;Qt<Oe;)Ve+=Ae[Qt].clientX,Et+=Ae[Qt].clientY,Qt++;return{x:Kt(Ve/Oe),y:Kt(Et/Oe)}}function gt(Ae,Oe,Ve){return{x:Oe/Ae||0,y:Ve/Ae||0}}function Ni(Ae,Oe){return Ae===Oe?Xt:ui(Ae)>=ui(Oe)?Ae<0?kt:qt:Oe<0?Bt:pi}function wi(Ae,Oe,Ve){Ve||(Ve=Ho);var Et=Oe[Ve[0]]-Ae[Ve[0]],Qt=Oe[Ve[1]]-Ae[Ve[1]];return Math.sqrt(Et*Et+Qt*Qt)}function $i(Ae,Oe,Ve){return Ve||(Ve=Ho),180*Math.atan2(Oe[Ve[1]]-Ae[Ve[1]],Oe[Ve[0]]-Ae[Ve[0]])/Math.PI}lt.prototype={handler:function(){},init:function(){this.evEl&&en(this.element,this.evEl,this.domHandler),this.evTarget&&en(this.target,this.evTarget,this.domHandler),this.evWin&&en(Hr(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&mi(this.element,this.evEl,this.domHandler),this.evTarget&&mi(this.target,this.evTarget,this.domHandler),this.evWin&&mi(Hr(this.element),this.evWin,this.domHandler)}};var _o={mousedown:io,mousemove:2,mouseup:Qe},Pn="mousedown",Tr="mousemove mouseup";function cr(){this.evEl=Pn,this.evWin=Tr,this.pressed=!1,lt.apply(this,arguments)}ki(cr,lt,{handler:function(Oe){var Ve=_o[Oe.type];Ve&io&&0===Oe.button&&(this.pressed=!0),2&Ve&&1!==Oe.which&&(Ve=Qe),this.pressed&&(Ve&Qe&&(this.pressed=!1),this.callback(this.manager,Ve,{pointers:[Oe],changedPointers:[Oe],pointerType:zr,srcEvent:Oe}))}});var kn={pointerdown:io,pointermove:2,pointerup:Qe,pointercancel:nt,pointerout:nt},Xr={2:Za,3:"pen",4:zr,5:"kinect"},gi="pointerdown",di="pointermove pointerup pointercancel";function ro(){this.evEl=gi,this.evWin=di,lt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Yt.MSPointerEvent&&!Yt.PointerEvent&&(gi="MSPointerDown",di="MSPointerMove MSPointerUp MSPointerCancel"),ki(ro,lt,{handler:function(Oe){var Ve=this.store,Et=!1,Qt=Oe.type.toLowerCase().replace("ms",""),Ei=kn[Qt],fn=Xr[Oe.pointerType]||Oe.pointerType,An=fn==Za,Pi=Vn(Ve,Oe.pointerId,"pointerId");Ei&io&&(0===Oe.button||An)?Pi<0&&(Ve.push(Oe),Pi=Ve.length-1):Ei&(Qe|nt)&&(Et=!0),!(Pi<0)&&(Ve[Pi]=Oe,this.callback(this.manager,Ei,{pointers:Ve,changedPointers:[Oe],pointerType:fn,srcEvent:Oe}),Et&&Ve.splice(Pi,1))}});var Hs={touchstart:io,touchmove:2,touchend:Qe,touchcancel:nt};function Yo(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,lt.apply(this,arguments)}function dt(Ae,Oe){var Ve=yn(Ae.touches),Et=yn(Ae.changedTouches);return Oe&(Qe|nt)&&(Ve=Ii(Ve.concat(Et),"identifier",!0)),[Ve,Et]}ki(Yo,lt,{handler:function(Oe){var Ve=Hs[Oe.type];if(Ve===io&&(this.started=!0),this.started){var Et=dt.call(this,Oe,Ve);Ve&(Qe|nt)&&Et[0].length-Et[1].length==0&&(this.started=!1),this.callback(this.manager,Ve,{pointers:Et[0],changedPointers:Et[1],pointerType:Za,srcEvent:Oe})}}});var wt={touchstart:io,touchmove:2,touchend:Qe,touchcancel:nt},Vt="touchstart touchmove touchend touchcancel";function st(){this.evTarget=Vt,this.targetIds={},lt.apply(this,arguments)}function ei(Ae,Oe){var Ve=yn(Ae.touches),Et=this.targetIds;if(Oe&(2|io)&&1===Ve.length)return Et[Ve[0].identifier]=!0,[Ve,Ve];var Qt,Ei,fn=yn(Ae.changedTouches),An=[],Pi=this.target;if(Ei=Ve.filter(function(Zo){return Mn(Zo.target,Pi)}),Oe===io)for(Qt=0;Qt<Ei.length;)Et[Ei[Qt].identifier]=!0,Qt++;for(Qt=0;Qt<fn.length;)Et[fn[Qt].identifier]&&An.push(fn[Qt]),Oe&(Qe|nt)&&delete Et[fn[Qt].identifier],Qt++;return An.length?[Ii(Ei.concat(An),"identifier",!0),An]:void 0}ki(st,lt,{handler:function(Oe){var Ve=wt[Oe.type],Et=ei.call(this,Oe,Ve);Et&&this.callback(this.manager,Ve,{pointers:Et[0],changedPointers:Et[1],pointerType:Za,srcEvent:Oe})}});var si=2500;function Zt(){lt.apply(this,arguments);var Ae=Ki(this.handler,this);this.touch=new st(this.manager,Ae),this.mouse=new cr(this.manager,Ae),this.primaryTouch=null,this.lastTouches=[]}function ri(Ae,Oe){Ae&io?(this.primaryTouch=Oe.changedPointers[0].identifier,oi.call(this,Oe)):Ae&(Qe|nt)&&oi.call(this,Oe)}function oi(Ae){var Oe=Ae.changedPointers[0];if(Oe.identifier===this.primaryTouch){var Ve={x:Oe.clientX,y:Oe.clientY};this.lastTouches.push(Ve);var Et=this.lastTouches;setTimeout(function(){var Ei=Et.indexOf(Ve);Ei>-1&&Et.splice(Ei,1)},si)}}function sn(Ae){for(var Oe=Ae.srcEvent.clientX,Ve=Ae.srcEvent.clientY,Et=0;Et<this.lastTouches.length;Et++){var Qt=this.lastTouches[Et],Ei=Math.abs(Oe-Qt.x),fn=Math.abs(Ve-Qt.y);if(Ei<=25&&fn<=25)return!0}return!1}ki(Zt,lt,{handler:function(Oe,Ve,Et){var Ei=Et.pointerType==zr;if(!(Ei&&Et.sourceCapabilities&&Et.sourceCapabilities.firesTouchEvents)){if(Et.pointerType==Za)ri.call(this,Ve,Et);else if(Ei&&sn.call(this,Et))return;this.callback(Oe,Ve,Et)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Zn=an(Ri.style,"touchAction"),zi=Zn!==Tt,Kr="compute",Qr="manipulation",ho="none",bo="pan-x",ir="pan-y",Ss=function gh(){if(!zi)return!1;var Ae={},Oe=Yt.CSS&&Yt.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ve){Ae[Ve]=!Oe||Yt.CSS.supports("touch-action",Ve)}),Ae}();function $s(Ae,Oe){this.manager=Ae,this.set(Oe)}$s.prototype={set:function(Ae){Ae==Kr&&(Ae=this.compute()),zi&&this.manager.element.style&&Ss[Ae]&&(this.manager.element.style[Zn]=Ae),this.actions=Ae.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ae=[];return ji(this.manager.recognizers,function(Oe){mt(Oe.options.enable,[Oe])&&(Ae=Ae.concat(Oe.getTouchAction()))}),function nr(Ae){if(vn(Ae,ho))return ho;var Oe=vn(Ae,bo),Ve=vn(Ae,ir);return Oe&&Ve?ho:Oe||Ve?Oe?bo:ir:vn(Ae,Qr)?Qr:"auto"}(Ae.join(" "))},preventDefaults:function(Ae){var Oe=Ae.srcEvent,Ve=Ae.offsetDirection;if(!this.manager.session.prevented){var Et=this.actions,Qt=vn(Et,ho)&&!Ss[ho],Ei=vn(Et,ir)&&!Ss[ir],fn=vn(Et,bo)&&!Ss[bo];if(Qt&&1===Ae.pointers.length&&Ae.distance<2&&Ae.deltaTime<250)return;return fn&&Ei||!(Qt||Ei&&Ve&pn||fn&&Ve&Pr)?void 0:this.preventSrc(Oe)}Oe.preventDefault()},preventSrc:function(Ae){this.manager.session.prevented=!0,Ae.preventDefault()}};var Ka=1;function Ua(Ae){this.options=tr({},this.defaults,Ae||{}),this.id=function uo(){return Vr++}(),this.manager=null,this.options.enable=yi(this.options.enable,!0),this.state=Ka,this.simultaneous={},this.requireFail=[]}function Ta(Ae){return 16&Ae?"cancel":8&Ae?"end":4&Ae?"move":2&Ae?"start":""}function _h(Ae){return Ae==pi?"down":Ae==Bt?"up":Ae==kt?"left":Ae==qt?"right":""}function Nn(Ae,Oe){var Ve=Oe.manager;return Ve?Ve.get(Ae):Ae}function Bo(){Ua.apply(this,arguments)}function Vo(){Bo.apply(this,arguments),this.pX=null,this.pY=null}function rr(){Bo.apply(this,arguments)}function id(){Ua.apply(this,arguments),this._timer=null,this._input=null}function Ic(){Bo.apply(this,arguments)}function Sa(){Bo.apply(this,arguments)}function yl(){Ua.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Os(Ae,Oe){return(Oe=Oe||{}).recognizers=yi(Oe.recognizers,Os.defaults.preset),new Ma(Ae,Oe)}function Ma(Ae,Oe){this.options=tr({},Os.defaults,Oe||{}),this.options.inputTarget=this.options.inputTarget||Ae,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ae,this.input=function ve(Ae){return new(Ae.options.inputClass||(jt?ro:ta?st:va?Zt:cr))(Ae,Ce)}(this),this.touchAction=new $s(this,this.options.touchAction),Ci(this,!0),ji(this.options.recognizers,function(Ve){var Et=this.add(new Ve[0](Ve[1]));Ve[2]&&Et.recognizeWith(Ve[2]),Ve[3]&&Et.requireFailure(Ve[3])},this)}function Ci(Ae,Oe){var Et,Ve=Ae.element;Ve.style&&(ji(Ae.options.cssProps,function(Qt,Ei){Et=an(Ve.style,Ei),Oe?(Ae.oldCssProps[Et]=Ve.style[Et],Ve.style[Et]=Qt):Ve.style[Et]=Ae.oldCssProps[Et]||""}),Oe||(Ae.oldCssProps={}))}Ua.prototype={defaults:{},set:function(Ae){return tr(this.options,Ae),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ae){if(er(Ae,"recognizeWith",this))return this;var Oe=this.simultaneous;return Oe[(Ae=Nn(Ae,this)).id]||(Oe[Ae.id]=Ae,Ae.recognizeWith(this)),this},dropRecognizeWith:function(Ae){return er(Ae,"dropRecognizeWith",this)||(Ae=Nn(Ae,this),delete this.simultaneous[Ae.id]),this},requireFailure:function(Ae){if(er(Ae,"requireFailure",this))return this;var Oe=this.requireFail;return-1===Vn(Oe,Ae=Nn(Ae,this))&&(Oe.push(Ae),Ae.requireFailure(this)),this},dropRequireFailure:function(Ae){if(er(Ae,"dropRequireFailure",this))return this;Ae=Nn(Ae,this);var Oe=Vn(this.requireFail,Ae);return Oe>-1&&this.requireFail.splice(Oe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ae){return!!this.simultaneous[Ae.id]},emit:function(Ae){var Oe=this,Ve=this.state;function Et(Qt){Oe.manager.emit(Qt,Ae)}Ve<8&&Et(Oe.options.event+Ta(Ve)),Et(Oe.options.event),Ae.additionalEvent&&Et(Ae.additionalEvent),Ve>=8&&Et(Oe.options.event+Ta(Ve))},tryEmit:function(Ae){if(this.canEmit())return this.emit(Ae);this.state=32},canEmit:function(){for(var Ae=0;Ae<this.requireFail.length;){if(!(this.requireFail[Ae].state&(32|Ka)))return!1;Ae++}return!0},recognize:function(Ae){var Oe=tr({},Ae);if(!mt(this.options.enable,[this,Oe]))return this.reset(),void(this.state=32);56&this.state&&(this.state=Ka),this.state=this.process(Oe),30&this.state&&this.tryEmit(Oe)},process:function(Ae){},getTouchAction:function(){},reset:function(){}},ki(Bo,Ua,{defaults:{pointers:1},attrTest:function(Ae){var Oe=this.options.pointers;return 0===Oe||Ae.pointers.length===Oe},process:function(Ae){var Oe=this.state,Ve=Ae.eventType,Et=6&Oe,Qt=this.attrTest(Ae);return Et&&(Ve&nt||!Qt)?16|Oe:Et||Qt?Ve&Qe?8|Oe:2&Oe?4|Oe:2:32}}),ki(Vo,Bo,{defaults:{event:"pan",threshold:10,pointers:1,direction:br},getTouchAction:function(){var Ae=this.options.direction,Oe=[];return Ae&pn&&Oe.push(ir),Ae&Pr&&Oe.push(bo),Oe},directionTest:function(Ae){var Oe=this.options,Ve=!0,Et=Ae.distance,Qt=Ae.direction,Ei=Ae.deltaX,fn=Ae.deltaY;return Qt&Oe.direction||(Oe.direction&pn?(Qt=0===Ei?Xt:Ei<0?kt:qt,Ve=Ei!=this.pX,Et=Math.abs(Ae.deltaX)):(Qt=0===fn?Xt:fn<0?Bt:pi,Ve=fn!=this.pY,Et=Math.abs(Ae.deltaY))),Ae.direction=Qt,Ve&&Et>Oe.threshold&&Qt&Oe.direction},attrTest:function(Ae){return Bo.prototype.attrTest.call(this,Ae)&&(2&this.state||!(2&this.state)&&this.directionTest(Ae))},emit:function(Ae){this.pX=Ae.deltaX,this.pY=Ae.deltaY;var Oe=_h(Ae.direction);Oe&&(Ae.additionalEvent=this.options.event+Oe),this._super.emit.call(this,Ae)}}),ki(rr,Bo,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ho]},attrTest:function(Ae){return this._super.attrTest.call(this,Ae)&&(Math.abs(Ae.scale-1)>this.options.threshold||2&this.state)},emit:function(Ae){1!==Ae.scale&&(Ae.additionalEvent=this.options.event+(Ae.scale<1?"in":"out")),this._super.emit.call(this,Ae)}}),ki(id,Ua,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Ae){var Oe=this.options,Ve=Ae.pointers.length===Oe.pointers,Et=Ae.distance<Oe.threshold,Qt=Ae.deltaTime>Oe.time;if(this._input=Ae,!Et||!Ve||Ae.eventType&(Qe|nt)&&!Qt)this.reset();else if(Ae.eventType&io)this.reset(),this._timer=Li(function(){this.state=8,this.tryEmit()},Oe.time,this);else if(Ae.eventType&Qe)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Ae){8===this.state&&(Ae&&Ae.eventType&Qe?this.manager.emit(this.options.event+"up",Ae):(this._input.timeStamp=Ft(),this.manager.emit(this.options.event,this._input)))}}),ki(Ic,Bo,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ho]},attrTest:function(Ae){return this._super.attrTest.call(this,Ae)&&(Math.abs(Ae.rotation)>this.options.threshold||2&this.state)}}),ki(Sa,Bo,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:pn|Pr,pointers:1},getTouchAction:function(){return Vo.prototype.getTouchAction.call(this)},attrTest:function(Ae){var Ve,Oe=this.options.direction;return Oe&(pn|Pr)?Ve=Ae.overallVelocity:Oe&pn?Ve=Ae.overallVelocityX:Oe&Pr&&(Ve=Ae.overallVelocityY),this._super.attrTest.call(this,Ae)&&Oe&Ae.offsetDirection&&Ae.distance>this.options.threshold&&Ae.maxPointers==this.options.pointers&&ui(Ve)>this.options.velocity&&Ae.eventType&Qe},emit:function(Ae){var Oe=_h(Ae.offsetDirection);Oe&&this.manager.emit(this.options.event+Oe,Ae),this.manager.emit(this.options.event,Ae)}}),ki(yl,Ua,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Qr]},process:function(Ae){var Oe=this.options,Ve=Ae.pointers.length===Oe.pointers,Et=Ae.distance<Oe.threshold,Qt=Ae.deltaTime<Oe.time;if(this.reset(),Ae.eventType&io&&0===this.count)return this.failTimeout();if(Et&&Qt&&Ve){if(Ae.eventType!=Qe)return this.failTimeout();var Ei=!this.pTime||Ae.timeStamp-this.pTime<Oe.interval,fn=!this.pCenter||wi(this.pCenter,Ae.center)<Oe.posThreshold;if(this.pTime=Ae.timeStamp,this.pCenter=Ae.center,fn&&Ei?this.count+=1:this.count=1,this._input=Ae,0==this.count%Oe.taps)return this.hasRequireFailures()?(this._timer=Li(function(){this.state=8,this.tryEmit()},Oe.interval,this),2):8}return 32},failTimeout:function(){return this._timer=Li(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Os.VERSION="2.0.7",Os.defaults={domEvents:!1,touchAction:Kr,enable:!0,inputTarget:null,inputClass:null,preset:[[Ic,{enable:!1}],[rr,{enable:!1},["rotate"]],[Sa,{direction:pn}],[Vo,{direction:pn},["swipe"]],[yl],[yl,{event:"doubletap",taps:2},["tap"]],[id]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ma.prototype={set:function(Ae){return tr(this.options,Ae),Ae.touchAction&&this.touchAction.update(),Ae.inputTarget&&(this.input.destroy(),this.input.target=Ae.inputTarget,this.input.init()),this},stop:function(Ae){this.session.stopped=Ae?2:1},recognize:function(Ae){var Oe=this.session;if(!Oe.stopped){this.touchAction.preventDefaults(Ae);var Ve,Et=this.recognizers,Qt=Oe.curRecognizer;(!Qt||Qt&&8&Qt.state)&&(Qt=Oe.curRecognizer=null);for(var Ei=0;Ei<Et.length;)Ve=Et[Ei],2===Oe.stopped||Qt&&Ve!=Qt&&!Ve.canRecognizeWith(Qt)?Ve.reset():Ve.recognize(Ae),!Qt&&14&Ve.state&&(Qt=Oe.curRecognizer=Ve),Ei++}},get:function(Ae){if(Ae instanceof Ua)return Ae;for(var Oe=this.recognizers,Ve=0;Ve<Oe.length;Ve++)if(Oe[Ve].options.event==Ae)return Oe[Ve];return null},add:function(Ae){if(er(Ae,"add",this))return this;var Oe=this.get(Ae.options.event);return Oe&&this.remove(Oe),this.recognizers.push(Ae),Ae.manager=this,this.touchAction.update(),Ae},remove:function(Ae){if(er(Ae,"remove",this))return this;if(Ae=this.get(Ae)){var Oe=this.recognizers,Ve=Vn(Oe,Ae);-1!==Ve&&(Oe.splice(Ve,1),this.touchAction.update())}return this},on:function(Ae,Oe){if(Ae!==Tt&&Oe!==Tt){var Ve=this.handlers;return ji(St(Ae),function(Et){Ve[Et]=Ve[Et]||[],Ve[Et].push(Oe)}),this}},off:function(Ae,Oe){if(Ae!==Tt){var Ve=this.handlers;return ji(St(Ae),function(Et){Oe?Ve[Et]&&Ve[Et].splice(Vn(Ve[Et],Oe),1):delete Ve[Et]}),this}},emit:function(Ae,Oe){this.options.domEvents&&function Or(Ae,Oe){var Ve=Ai.createEvent("Event");Ve.initEvent(Ae,!0,!0),Ve.gesture=Oe,Oe.target.dispatchEvent(Ve)}(Ae,Oe);var Ve=this.handlers[Ae]&&this.handlers[Ae].slice();if(Ve&&Ve.length){Oe.type=Ae,Oe.preventDefault=function(){Oe.srcEvent.preventDefault()};for(var Et=0;Et<Ve.length;)Ve[Et](Oe),Et++}},destroy:function(){this.element&&Ci(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},tr(Os,{INPUT_START:io,INPUT_MOVE:2,INPUT_END:Qe,INPUT_CANCEL:nt,STATE_POSSIBLE:Ka,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:Xt,DIRECTION_LEFT:kt,DIRECTION_RIGHT:qt,DIRECTION_UP:Bt,DIRECTION_DOWN:pi,DIRECTION_HORIZONTAL:pn,DIRECTION_VERTICAL:Pr,DIRECTION_ALL:br,Manager:Ma,Input:lt,TouchAction:$s,TouchInput:st,MouseInput:cr,PointerEventInput:ro,TouchMouseInput:Zt,SingleTouchInput:Yo,Recognizer:Ua,AttrRecognizer:Bo,Tap:yl,Pan:Vo,Swipe:Sa,Pinch:rr,Rotate:Ic,Press:id,on:en,off:mi,each:ji,merge:Di,extend:bi,assign:tr,inherit:ki,bindFn:Ki,prefixed:an}),(typeof Yt<"u"?Yt:typeof self<"u"?self:{}).Hammer=Os,(o=function(){return Os}.call(Gn,It,Gn,Go))!==Tt&&(Go.exports=o)}(window,document)},247:function(Go){Go.exports=function(){"use strict";var Gn,It,o;function Yt(_,Tt){if(Gn)if(It){var Si="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Gn+")(sharedChunk); ("+It+")(sharedChunk); self.onerror = null;",Ri={};Gn(Ri),o=Tt(Ri),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(o.workerUrl=window.URL.createObjectURL(new Blob([Si],{type:"text/javascript"})))}else It=Tt;else Gn=Tt}return Yt(0,function(_){var Tt="3.3.0";let Si;const Ri={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Si){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Si=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):a}catch{Si=a}}return Si},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ri.API_URL)return null;try{const a=new URL(Ri.API_URL);return"api.mapbox.cn"===a.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===a.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"};function Ar(a){return Ri.API_URL_REGEX.test(a)}function Kt(a){return 0===a.indexOf("mapbox:")}function ui(a){return Ri.API_CDN_URL_REGEX.test(a)}function Ft(a){return Ri.API_SPRITE_REGEX.test(a)}function Li(a){return Ri.API_STYLE_REGEX.test(a)&&!Ft(a)}const er={create:"create",load:"load",fullLoad:"fullLoad"};function ji(a){const s=a.name.split("?")[0];return ui(s)&&s.includes("mapbox-gl.js")?"javascript":ui(s)&&s.includes("mapbox-gl.css")?"css":Ri.API_FONTS_REGEX.test(s)?"fontRange":Ft(s)?"sprite":Li(s)?"style":Ri.API_TILEJSON_REGEX.test(s)?"tilejson":"other"}function un(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var tr=bi;function bi(a,s,d,f){this.cx=3*a,this.bx=3*(d-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(f-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=s,this.p2x=d,this.p2y=f}bi.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,s){if(void 0===s&&(s=1e-6),a<0)return 0;if(a>1)return 1;for(var d=a,f=0;f<8;f++){var v=this.sampleCurveX(d)-a;if(Math.abs(v)<s)return d;var y=this.sampleCurveDerivativeX(d);if(Math.abs(y)<1e-6)break;d-=v/y}var E=0,M=1;for(d=a,f=0;f<20&&(v=this.sampleCurveX(d),!(Math.abs(v-a)<s));f++)a>v?E=d:M=d,d=.5*(M-E)+E;return d},solve:function(a,s){return this.sampleCurveY(this.solveCurveX(a,s))}};var Di=un(tr),ki=Ki;function Ki(a,s){this.x=a,this.y=s}Ki.prototype={clone:function(){return new Ki(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,s){return this.clone()._rotateAround(a,s)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var s=a.x-this.x,d=a.y-this.y;return s*s+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,s){return Math.atan2(this.x*s-this.y*a,this.x*a+this.y*s)},_matMult:function(a){var s=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=s,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var s=Math.cos(a),d=Math.sin(a),f=d*this.x+s*this.y;return this.x=s*this.x-d*this.y,this.y=f,this},_rotateAround:function(a,s){var d=Math.cos(a),f=Math.sin(a),v=s.y+f*(this.x-s.x)+d*(this.y-s.y);return this.x=s.x+d*(this.x-s.x)-f*(this.y-s.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ki.convert=function(a){return a instanceof Ki?a:Array.isArray(a)?new Ki(a[0],a[1]):a};var mt=un(ki);const yi=Math.PI/180,en=180/Math.PI;function mi(a){return a*yi}function Mn(a){return a*en}const vn=[[0,0],[1,0],[1,1],[0,1]];function St(a){if(a<=0)return 0;if(a>=1)return 1;const s=a*a,d=s*a;return 4*(a<.5?d:3*(a-s)+d-.75)}function Vn(a,s,d,f){const v=new Di(a,s,d,f);return function(y){return v.solve(y)}}const yn=Vn(.25,.1,.25,1);function Ii(a,s,d){return Math.min(d,Math.max(s,a))}function an(a,s,d){return(d=Ii((d-a)/(s-a),0,1))*d*(3-2*d)}function Vr(a,s,d){const f=d-s,v=((a-s)%f+f)%f+s;return v===s?d:v}function uo(a,s,d){if(!a.length)return d(null,[]);let f=a.length;const v=new Array(a.length);let y=null;a.forEach((E,M)=>{s(E,(k,R)=>{k&&(y=k),v[M]=R,0==--f&&d(y,v)})})}function Hr(a,...s){for(const d of s)for(const f in d)a[f]=d[f];return a}let as=1;function va(){return as++}function jt(){return function a(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function ta(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function Za(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function Eo(a,s){a.forEach(d=>{s[d]&&(s[d]=s[d].bind(s))})}function zr(a,s){return-1!==a.indexOf(s,a.length-s.length)}function No(a,s,d){const f={};for(const v in a)f[v]=s.call(d||this,a[v],v,a);return f}function la(a,s,d){const f={};for(const v in a)s.call(d||this,a[v],v,a)&&(f[v]=a[v]);return f}function io(a){return Array.isArray(a)?a.map(io):"object"==typeof a&&a?No(a,io):a}const Ge={};function Qe(a){Ge[a]||(typeof console<"u"&&console.warn(a),Ge[a]=!0)}function nt(a,s,d){return(d.y-a.y)*(s.x-a.x)>(s.y-a.y)*(d.x-a.x)}function Xt(a){let s=0;for(let d,f,v=0,y=a.length,E=y-1;v<y;E=v++)d=a[v],f=a[E],s+=(f.x-d.x)*(d.y+f.y);return s}function kt([a,s,d]){const f=mi(s+90),v=mi(d);return{x:a*Math.cos(f)*Math.sin(v),y:a*Math.sin(f)*Math.sin(v),z:a*Math.cos(v),azimuthal:s,polar:d}}function qt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Bt(a){const s={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(d,f,v,y)=>{const E=v||y;return s[f]=!E||E.toLowerCase(),""}),s["max-age"]){const d=parseInt(s["max-age"],10);isNaN(d)?delete s["max-age"]:s["max-age"]=d}return s}let pi,pn,Pr,br,Ho,qo,lt=null;function ve(a){try{const s=self[a];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ce(a,s){return[a[4*s],a[4*s+1],a[4*s+2],a[4*s+3]]}function He(a,s,d,f){for(;s<d;){const v=s+d>>1;a[v]<f?s=v+1:d=v}return s}function ut(a,s,d,f){for(;s<d;){const v=s+d>>1;a[v]<=f?s=v+1:d=v}return s}function bt(){return null==pi&&(pi=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),pi}const Ht={now:()=>void 0!==br?br:performance.now(),setNow(a){br=a},restoreNow(){br=void 0},frame(a){const s=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(a,s=0){const{width:d,height:f}=a;Ho||(Ho=document.createElement("canvas"));const v=Ho.getContext("2d",{willReadFrequently:!0});if(!v)throw new Error("failed to create canvas 2d context");return(d>Ho.width||f>Ho.height)&&(Ho.width=d,Ho.height=f),v.clearRect(-s,-s,d+2*s,f+2*s),v.drawImage(a,0,0,d,f),v.getImageData(-s,-s,d+2*s,f+2*s)},resolveURL:a=>(pn||(pn=document.createElement("a")),pn.href=a,pn.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(null==Pr&&(Pr=window.matchMedia("(prefers-reduced-motion: reduce)")),Pr.matches)},hasCanvasFingerprintNoise(){if(void 0!==qo)return qo;if(!bt())return qo=!1,!1;const a=new OffscreenCanvas(85,1),s=a.getContext("2d",{willReadFrequently:!0});let d=0;for(let v=0;v<a.width;++v)s.fillStyle=`rgba(${d++},${d++},${d++}, 255)`,s.fillRect(v,0,1,1);const f=s.getImageData(0,0,a.width,a.height);d=0;for(let v=0;v<f.data.length;++v)if(v%4!=3&&d++!==f.data[v])return qo=!0,!0;return qo=!1,!1}},hi="mapbox-tiles";let wi,$i,gt=500,Ni=50;function jn(){try{return caches}catch{}}function eo(){const a=jn();a&&!wi&&(wi=a.open(hi))}function _o(a){const s=a.indexOf("?");if(s<0)return a;const d=["language","worldview"],f=new URLSearchParams,v=new URLSearchParams(a.slice(s));for(const y of d){const E=v.get(y);E&&f.set(y,E)}return`${a.slice(0,s)}?${f.toString()}`}function Pn(a,s){const d=a.indexOf("?");if(d<0)return`${a}?${new URLSearchParams(s).toString()}`;const f=new URLSearchParams(a.slice(d));for(const v in s)f.set(v,s[v]);return`${a.slice(0,d)}?${f.toString()}`}let Tr=1/0;const cr={supported:!1,testSupport:function(a){!gi&&Xr&&(di?Hs(a):kn=a)}};let kn,Xr,gi=!1,di=!1;const ro=typeof self<"u"?self:{};function Hs(a){const s=a.createTexture();a.bindTexture(a.TEXTURE_2D,s);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,Xr),a.isContextLost())return;cr.supported=!0}catch{}a.deleteTexture(s),gi=!0}ro.document&&(Xr=ro.document.createElement("img"),Xr.onload=function(){kn&&Hs(kn),kn=null,di=!0},Xr.onerror=function(){gi=!0,kn=null},Xr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ca={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(ca);class ls extends Error{constructor(s,d,f){401===d&&Ar(f)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=d,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Yo=qt()?()=>self.worker&&self.worker.referrer:()=>("blob:"===location.protocol?parent:self).location.href,dt=function(a,s){if(!(/^file:/.test(d=a.url)||/^file:/.test(Yo())&&!/^\w+:/.test(d))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(f,v){const y=new AbortController,E=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Yo(),referrerPolicy:f.referrerPolicy,signal:y.signal});let M=!1,k=!1;const R=(L=E.url).indexOf("sku=")>0&&Ar(L);var L;"json"===f.type&&E.headers.set("Accept","application/json");const V=(q,Z,J)=>{if(k)return;if(q&&"SecurityError"!==q.message&&Qe(q.toString()),Z&&J)return j(Z);const ne=Date.now();fetch(E).then(le=>{if(le.ok){const xe=R?le.clone():null;return j(le,xe,ne)}return v(new ls(le.statusText,le.status,f.url))}).catch(le=>{"AbortError"!==le.name&&v(new Error(`${le.message} ${f.url}`))})},j=(q,Z,J)=>{("arrayBuffer"===f.type?q.arrayBuffer():"json"===f.type?q.json():q.text()).then(ne=>{k||(Z&&J&&function(le,xe,Ee){if(eo(),!wi)return;const Te=Bt(xe.headers.get("Cache-Control")||"");if(Te["no-store"])return;const Le={status:xe.status,statusText:xe.statusText,headers:new Headers};xe.headers.forEach((We,tt)=>Le.headers.set(tt,We)),Te["max-age"]&&Le.headers.set("Expires",new Date(Ee+1e3*Te["max-age"]).toUTCString());const ke=Le.headers.get("Expires");if(!ke||new Date(ke).getTime()-Ee<42e4)return;let Be=_o(le.url);if(206===xe.status){const We=le.headers.get("Range");if(!We)return;Le.status=200,Be=Pn(Be,{range:We})}!function(We,tt){if(void 0===$i)try{new Response(new ReadableStream),$i=!0}catch{$i=!1}$i?tt(We.body):We.blob().then(tt)}(xe,We=>{const tt=new Response(We,Le);eo(),wi&&wi.then(ct=>ct.put(Be,tt)).catch(ct=>Qe(ct.message))})}(E,Z,J),M=!0,v(null,ne,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(ne=>{k||v(new Error(ne.message))})};return R?function(q,Z){if(eo(),!wi)return Z(null);wi.then(J=>{let ne=_o(q.url);const le=q.headers.get("Range");le&&(ne=Pn(ne,{range:le})),J.match(ne).then(xe=>{const Ee=function(Te){if(!Te)return!1;const Le=new Date(Te.headers.get("Expires")||0),ke=Bt(Te.headers.get("Cache-Control")||"");return Le>Date.now()&&!ke["no-cache"]}(xe);J.delete(ne),Ee&&J.put(ne,xe.clone()),Z(null,xe,Ee)}).catch(Z)}).catch(Z)}(E,V):V(null,null),{cancel:()=>{k=!0,M||y.abort()}}}(a,s);if(qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,s,void 0,!0)}var d;return function(f,v){const y=new XMLHttpRequest;y.open(f.method||"GET",f.url,!0),"arrayBuffer"===f.type&&(y.responseType="arraybuffer");for(const E in f.headers)y.setRequestHeader(E,f.headers[E]);return"json"===f.type&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials="include"===f.credentials,y.onerror=()=>{v(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||0===y.status)&&null!==y.response){let E=y.response;if("json"===f.type)try{E=JSON.parse(y.response)}catch(M){return v(M)}v(null,E,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else v(new ls(y.statusText,y.status,f.url))},y.send(f.body),{cancel:()=>y.abort()}}(a,s)},wt=function(a,s){return dt(Hr(a,{type:"arrayBuffer"}),s)};function Vt(a){const s=document.createElement("a");return s.href=a,s.protocol===location.protocol&&s.host===location.host}const st="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ei,si;ei=[],si=0;const ai=function(a,s){if(cr.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),si>=Ri.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:a,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return ei.push(y),y}si++;let d=!1;const f=()=>{if(!d)for(d=!0,si--;ei.length&&si<Ri.MAX_PARALLEL_IMAGE_REQUESTS;){const y=ei.shift(),{requestParameters:E,callback:M,cancelled:k}=y;k||(y.cancel=ai(E,M).cancel)}},v=wt(a,(y,E,M,k)=>{f(),y?s(y):E&&(self.createImageBitmap?function(R,L){const V=new Blob([new Uint8Array(R)],{type:"image/png"});createImageBitmap(V).then(j=>{L(null,j)}).catch(j=>{L(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(E,(R,L)=>s(R,L,M,k)):function(R,L){const V=new Image;V.onload=()=>{L(null,V),URL.revokeObjectURL(V.src),V.onload=null,requestAnimationFrame(()=>{V.src=st})},V.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const j=new Blob([new Uint8Array(R)],{type:"image/png"});V.src=R.byteLength?URL.createObjectURL(j):st}(E,(R,L)=>s(R,L,M,k)))});return{cancel:()=>{v.cancel(),f()}}},Zt="01",ri="NO_ACCESS_TOKEN",oi=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function sn(a){const s=a.match(oi);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function Zn(a){const s=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${s}`}const zi="mapbox.eventData";function Kr(a){if(!a)return null;const s=a.split(".");if(!s||3!==s.length)return null;try{return JSON.parse(decodeURIComponent(atob(s[1]).split("").map(d=>"%"+("00"+d.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class hr{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const d=Kr(Ri.ACCESS_TOKEN);let f="";return f=d&&d.u?btoa(encodeURIComponent(d.u).replace(/%([0-9A-F]{2})/g,(v,y)=>String.fromCharCode(+("0x"+y)))):Ri.ACCESS_TOKEN||"",s?`${zi}.${s}:${f}`:`${zi}:${f}`}fetchEventData(){const s=ve("localStorage"),d=this.getStorageKey(),f=this.getStorageKey("uuid");if(s)try{const v=localStorage.getItem(d);v&&(this.eventData=JSON.parse(v));const y=localStorage.getItem(f);y&&(this.anonId=y)}catch{Qe("Unable to read from LocalStorage")}}saveEventData(){const s=ve("localStorage"),d=this.getStorageKey(),f=this.getStorageKey("uuid"),v=this.anonId;if(s&&v)try{localStorage.setItem(f,v),Object.keys(this.eventData).length>=1&&localStorage.setItem(d,JSON.stringify(this.eventData))}catch{Qe("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,d,f,v){if(!Ri.EVENTS_URL)return;const y=sn(Ri.EVENTS_URL);y.params.push(`access_token=${v||Ri.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(s).toISOString()},M=d?Hr(E,d):E,k={url:Zn(y),headers:{"Content-Type":"text/plain"},body:JSON.stringify([M])};var L;this.pendingRequest=(L=R=>{this.pendingRequest=null,f(R),this.saveEventData(),this.processRequests(v)},dt(Hr(k,{method:"POST"}),L))}queueRequest(s,d){this.queue.push(s),this.processRequests(d)}}const Qr=new class extends hr{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,s){Ri.EVENTS_URL&&Ri.ACCESS_TOKEN&&Array.isArray(a)&&a.some(d=>Kt(d)||Ar(d))&&this.queueRequest(Date.now(),s)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Kr(Ri.ACCESS_TOKEN),d=s?s.u:Ri.ACCESS_TOKEN;let f=d!==this.eventData.tokenU;Za(this.anonId)||(this.anonId=jt(),f=!0);const v=this.queue.shift();if(this.eventData.lastSuccess){const y=new Date(this.eventData.lastSuccess),E=new Date(v),M=(v-this.eventData.lastSuccess)/864e5;f=f||M>=1||M<-1||y.getDate()!==E.getDate()}else f=!0;f?this.postEvent(v,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Tt,skuId:Zt,"enabled.telemetry":!1,userId:this.anonId},y=>{y||(this.eventData.lastSuccess=v,this.eventData.tokenU=d)},a):this.processRequests()}},ho=Qr.postTurnstileEvent.bind(Qr),bo=new class extends hr{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,s,d,f){this.skuToken=s,this.errorCb=f,Ri.EVENTS_URL&&(d||Ri.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},d):this.errorCb(new Error(ri)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:d}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),Za(this.anonId)||(this.anonId=jt()),this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Tt,skuId:Zt,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):s&&(this.success[s]=!0)},a))}remove(){this.errorCb=null}},ir=bo.postMapLoadEvent.bind(bo),Ss=new class extends hr{constructor(){super("gljs.performance")}postPerformanceEvent(a,s){Ri.EVENTS_URL&&(a||Ri.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},a)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:s,performanceData:d}=this.queue.shift(),f=function(v){const y=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),M=function(q){const Z={};if(q)for(const J in q)if("other"!==J)for(const ne of q[J]){const le=`${J}ResolveRangeMin`,xe=`${J}ResolveRangeMax`,Ee=`${J}RequestCount`,Te=`${J}RequestCachedCount`;Z[le]=Math.min(Z[le]||1/0,ne.startTime),Z[xe]=Math.max(Z[xe]||-1/0,ne.responseEnd);const Le=ke=>{void 0===Z[ke]&&(Z[ke]=0),++Z[ke]};void 0!==ne.transferSize&&0===ne.transferSize&&Le(Te),Le(Ee)}return Z}(function(q,Z){const J={};if(q)for(const ne of q){const le=Z(ne);void 0===J[le]&&(J[le]=[]),J[le].push(ne)}return J}(y,ji)),k=window.devicePixelRatio,R=navigator.connection||navigator.mozConnection||navigator.webkitConnection,L=R?R.effectiveType:void 0,V={counters:[],metadata:[],attributes:[]},j=(q,Z,J)=>{null!=J&&q.push({name:Z,value:J.toString()})};for(const q in M)j(V.counters,q,M[q]);if(v.interactionRange[0]!==1/0&&v.interactionRange[1]!==-1/0&&(j(V.counters,"interactionRangeMin",v.interactionRange[0]),j(V.counters,"interactionRangeMax",v.interactionRange[1])),E)for(const q of Object.keys(er)){const Z=er[q],J=E.find(ne=>ne.name===Z);J&&j(V.counters,Z,J.startTime)}return j(V.counters,"visibilityHidden",v.visibilityHidden),j(V.attributes,"style",function(q){if(q)for(const Z of q){const J=Z.name.split("?")[0];if(Li(J)){const ne=J.split("/").slice(-2);if(2===ne.length)return`mapbox://styles/${ne[0]}/${ne[1]}`}}}(y)),j(V.attributes,"terrainEnabled",v.terrainEnabled?"true":"false"),j(V.attributes,"fogEnabled",v.fogEnabled?"true":"false"),j(V.attributes,"projection",v.projection),j(V.attributes,"zoom",v.zoom),j(V.metadata,"devicePixelRatio",k),j(V.metadata,"connectionEffectiveType",L),j(V.metadata,"navigatorUserAgent",navigator.userAgent),j(V.metadata,"screenWidth",window.screen.width),j(V.metadata,"screenHeight",window.screen.height),j(V.metadata,"windowWidth",window.innerWidth),j(V.metadata,"windowHeight",window.innerHeight),j(V.metadata,"mapWidth",v.width/k),j(V.metadata,"mapHeight",v.height/k),j(V.metadata,"webglRenderer",v.renderer),j(V.metadata,"webglVendor",v.vendor),j(V.metadata,"sdkVersion",Tt),j(V.metadata,"sdkIdentifier","mapbox-gl-js"),V}(d);for(const v of f.metadata);for(const v of f.counters);for(const v of f.attributes);this.postEvent(s,f,()=>{},a)}},$s=Ss.postPerformanceEvent.bind(Ss),nr=new class extends hr{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,s,d,f){if(!Ri.API_URL||!Ri.SESSION_PATH)return;const v=sn(Ri.API_URL+Ri.SESSION_PATH);v.params.push(`sku=${s||""}`),v.params.push(`access_token=${f||Ri.ACCESS_TOKEN||""}`);const y={url:Zn(v),headers:{"Content-Type":"text/plain"}};var M;this.pendingRequest=(M=E=>{this.pendingRequest=null,d(E),this.saveEventData(),this.processRequests(f)},dt(Hr(y,{method:"GET"}),M))}getSessionAPI(a,s,d,f){this.skuToken=s,this.errorCb=f,Ri.SESSION_PATH&&Ri.API_URL&&(d||Ri.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},d):this.errorCb(new Error(ri)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:d}=this.queue.shift();s&&this.success[s]||this.getSession(d,this.skuToken,f=>{f?this.errorCb(f):s&&(this.success[s]=!0)},a)}remove(){this.errorCb=null}},gh=nr.getSessionAPI.bind(nr),Ka=new Set;function On(a,s,d){d[a]&&-1!==d[a].indexOf(s)||(d[a]=d[a]||[],d[a].push(s))}function bl(a,s,d){if(d&&d[a]){const f=d[a].indexOf(s);-1!==f&&d[a].splice(f,1)}}class Ps{constructor(s,d={}){Hr(this,d),this.type=s}}class xi extends Ps{constructor(s,d={}){super("error",Hr({error:s},d))}}class Ea{on(s,d){return this._listeners=this._listeners||{},On(s,d,this._listeners),this}off(s,d){return bl(s,d,this._listeners),bl(s,d,this._oneTimeListeners),this}once(s,d){return d?(this._oneTimeListeners=this._oneTimeListeners||{},On(s,d,this._oneTimeListeners),this):new Promise(f=>this.once(s,f))}fire(s,d){"string"==typeof s&&(s=new Ps(s,d||{}));const f=s.type;if(this.listens(f)){s.target=this;const v=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const M of v)M.call(this,s);const y=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const M of y)bl(f,M,this._oneTimeListeners),M.call(this,s);const E=this._eventedParent;E&&(Hr(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),E.fire(s))}else s instanceof xi&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,d){return this._eventedParent=s,this._eventedParentData=d,this}}_.y=void 0;var rs={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ua(a){return(a=Math.round(a))<0?0:a>255?255:a}function Ta(a){return Ua("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function _h(a){return(s="%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))<0?0:s>1?1:s;var s}function Nn(a,s,d){return d<0?d+=1:d>1&&(d-=1),6*d<1?a+(s-a)*d*6:2*d<1?s:3*d<2?a+(s-a)*(2/3-d)*6:a}try{_.y={}.parseCSSColor=function(a){var s,d=a.replace(/ /g,"").toLowerCase();if(d in rs)return rs[d].slice();if("#"===d[0])return 4===d.length?(s=parseInt(d.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:7===d.length&&(s=parseInt(d.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var f=d.indexOf("("),v=d.indexOf(")");if(-1!==f&&v+1===d.length){var y=d.substr(0,f),E=d.substr(f+1,v-(f+1)).split(","),M=1;switch(y){case"rgba":if(4!==E.length)return null;M=_h(E.pop());case"rgb":return 3!==E.length?null:[Ta(E[0]),Ta(E[1]),Ta(E[2]),M];case"hsla":if(4!==E.length)return null;M=_h(E.pop());case"hsl":if(3!==E.length)return null;var k=(parseFloat(E[0])%360+360)%360/360,R=_h(E[1]),L=_h(E[2]),V=L<=.5?L*(R+1):L+R-L*R,j=2*L-V;return[Ua(255*Nn(j,V,k+1/3)),Ua(255*Nn(j,V,k)),Ua(255*Nn(j,V,k-1/3)),M];default:return null}}return null}}catch{}class Bo{constructor(s,d,f,v=1){this.r=s,this.g=d,this.b=f,this.a=v}static parse(s){if(!s)return;if(s instanceof Bo)return s;if("string"!=typeof s)return;const d=_.y(s);return d?new Bo(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3]):void 0}toString(){const[s,d,f,v]=this.toArray();return`rgba(${Math.round(s)},${Math.round(d)},${Math.round(f)},${v})`}toArray(){const{r:s,g:d,b:f,a:v}=this;return 0===v?[0,0,0,0]:[255*s/v,255*d/v,255*f/v,v]}toArray01(){const{r:s,g:d,b:f,a:v}=this;return 0===v?[0,0,0,0]:[s/v,d/v,f/v,v]}toArray01Scaled(s){const{r:d,g:f,b:v,a:y}=this;return 0===y?[0,0,0]:[d/y*s,f/y*s,v/y*s]}toArray01PremultipliedAlpha(){const{r:s,g:d,b:f,a:v}=this;return[s,d,f,v]}toArray01Linear(){const{r:s,g:d,b:f,a:v}=this;return 0===v?[0,0,0,0]:[Math.pow(s/v,2.2),Math.pow(d/v,2.2),Math.pow(f/v,2.2),v]}}Bo.black=new Bo(0,0,0,1),Bo.white=new Bo(1,1,1,1),Bo.transparent=new Bo(0,0,0,0),Bo.red=new Bo(1,0,0,1),Bo.blue=new Bo(0,0,1,1);var Vo=Bo;function rr(a,s,d){return a*(1-d)+s*d}function id(a,s,d){return a.map((f,v)=>rr(f,s[v],d))}var Ic=Object.freeze({__proto__:null,array:id,color:function(a,s,d){return new Vo(rr(a.r,s.r,d),rr(a.g,s.g,d),rr(a.b,s.b,d),rr(a.a,s.a,d))},number:rr});function Sa(a,...s){for(const d of s)for(const f in d)a[f]=d[f];return a}class yl extends Error{constructor(s,d){super(d),this.message=d,this.key=s}}var Os=yl;class Rc{constructor(s,d=[]){this.parent=s,this.bindings={};for(const[f,v]of d)this.bindings[f]=v}concat(s){return new Rc(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}var mf=Rc;const Ma={kind:"null"},Ci={kind:"number"},Or={kind:"string"},wr={kind:"boolean"},Ae={kind:"color"},Oe={kind:"object"},Ve={kind:"value"},Et={kind:"collator"},Qt={kind:"formatted"},Ei={kind:"resolvedImage"};function fn(a,s){return{kind:"array",itemType:a,N:s}}function An(a){if("array"===a.kind){const s=An(a.itemType);return"number"==typeof a.N?`array<${s}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${s}>`}return a.kind}const Pi=[Ma,Ci,Or,wr,Ae,Qt,Oe,fn(Ve),Ei];function Zo(a,s){if("error"===s.kind)return null;if("array"===a.kind){if("array"===s.kind&&(0===s.N&&"value"===s.itemType.kind||!Zo(a.itemType,s.itemType))&&("number"!=typeof a.N||a.N===s.N))return null}else{if(a.kind===s.kind)return null;if("value"===a.kind)for(const d of Pi)if(!Zo(d,s))return null}return`Expected ${An(a)} but found ${An(s)} instead.`}function nn(a,s){return s.some(d=>d.kind===a.kind)}function nd(a,s){return s.some(d=>"null"===d?null===a:"array"===d?Array.isArray(a):"object"===d?a&&!Array.isArray(a)&&"object"==typeof a:d===typeof a)}class $n{constructor(s,d,f){this.sensitivity=s?d?"variant":"case":d?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,d){return this.collator.compare(s,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class jd{constructor(s,d,f,v,y){this.text=s.normalize?s.normalize():s,this.image=d,this.scale=f,this.fontStack=v,this.textColor=y}}class Ws{constructor(s){this.sections=s}static fromString(s){return new Ws([new jd(s,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(s=>0!==s.text.length||s.image&&0!==s.image.namePrimary.length)}static factory(s){return s instanceof Ws?s:Ws.fromString(s)}toString(){return 0===this.sections.length?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const d of this.sections){if(d.image){s.push(["image",d.image.namePrimary]);continue}s.push(d.text);const f={};d.fontStack&&(f["text-font"]=["literal",d.fontStack.split(",")]),d.scale&&(f["font-scale"]=d.scale),d.textColor&&(f["text-color"]=["rgba"].concat(d.textColor.toArray())),s.push(f)}return s}}class rn{constructor(s){this.namePrimary=s.namePrimary,s.nameSecondary&&(this.nameSecondary=s.nameSecondary),this.available=s.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(s,d){return s?new rn({namePrimary:s,nameSecondary:d,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Qa(a,s,d,f){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof s&&s>=0&&s<=255&&"number"==typeof d&&d>=0&&d<=255?void 0===f||"number"==typeof f&&f>=0&&f<=1?null:`Invalid rgba value [${[a,s,d,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof f?[a,s,d,f]:[a,s,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function lc(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof Vo||a instanceof $n||a instanceof Ws||a instanceof rn)return!0;if(Array.isArray(a)){for(const s of a)if(!lc(s))return!1;return!0}if("object"==typeof a){for(const s in a)if(!lc(a[s]))return!1;return!0}return!1}function cs(a){if(null===a)return Ma;if("string"==typeof a)return Or;if("boolean"==typeof a)return wr;if("number"==typeof a)return Ci;if(a instanceof Vo)return Ae;if(a instanceof $n)return Et;if(a instanceof Ws)return Qt;if(a instanceof rn)return Ei;if(Array.isArray(a)){const s=a.length;let d;for(const f of a){const v=cs(f);if(d){if(d===v)continue;d=Ve;break}d=v}return fn(d||Ve,s)}return Oe}function ds(a){const s=typeof a;return null===a?"":"string"===s||"number"===s||"boolean"===s?String(a):a instanceof Vo||a instanceof Ws||a instanceof rn?a.toString():JSON.stringify(a)}class Ul{constructor(s,d){this.type=s,this.value=d}static parse(s,d){if(2!==s.length)return d.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!lc(s[1]))return d.error("invalid value");const f=s[1];let v=cs(f);const y=d.expectedType;return"array"!==v.kind||0!==v.N||!y||"array"!==y.kind||"number"==typeof y.N&&0!==y.N||(v=y),new Ul(v,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Vo?["rgba"].concat(this.value.toArray()):this.value instanceof Ws?this.value.serialize():this.value}}var Gd=Ul,Ls=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const H_={string:Or,number:Ci,boolean:wr,object:Oe};class pf{constructor(s,d){this.type=s,this.args=d}static parse(s,d){if(s.length<2)return d.error("Expected at least one argument.");let f,v=1;const y=s[0];if("array"===y){let M,k;if(s.length>2){const R=s[1];if("string"!=typeof R||!(R in H_)||"object"===R)return d.error('The item type argument of "array" must be one of string, number, boolean',1);M=H_[R],v++}else M=Ve;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return d.error('The length argument to "array" must be a positive integer literal',2);k=s[2],v++}f=fn(M,k)}else f=H_[y];const E=[];for(;v<s.length;v++){const M=d.parse(s[v],v,Ve);if(!M)return null;E.push(M)}return new pf(f,E)}evaluate(s){for(let d=0;d<this.args.length;d++){const f=this.args[d].evaluate(s);if(!Zo(this.type,cs(f)))return f;if(d===this.args.length-1)throw new Ls(`Expected value to be of type ${An(this.type)}, but found ${An(cs(f))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,d=[s.kind];if("array"===s.kind){const f=s.itemType;if("string"===f.kind||"number"===f.kind||"boolean"===f.kind){d.push(f.kind);const v=s.N;("number"==typeof v||this.args.length>1)&&d.push(v)}}return d.concat(this.args.map(f=>f.serialize()))}}var rd=pf;class Pc{constructor(s){this.type=Qt,this.sections=s}static parse(s,d){if(s.length<2)return d.error("Expected at least one argument.");const f=s[1];if(!Array.isArray(f)&&"object"==typeof f)return d.error("First argument must be an image or text section.");const v=[];let y=!1;for(let E=1;E<=s.length-1;++E){const M=s[E];if(y&&"object"==typeof M&&!Array.isArray(M)){y=!1;let k=null;if(M["font-scale"]&&(k=d.parse(M["font-scale"],1,Ci),!k))return null;let R=null;if(M["text-font"]&&(R=d.parse(M["text-font"],1,fn(Or)),!R))return null;let L=null;if(M["text-color"]&&(L=d.parse(M["text-color"],1,Ae),!L))return null;const V=v[v.length-1];V.scale=k,V.font=R,V.textColor=L}else{const k=d.parse(s[E],1,Ve);if(!k)return null;const R=k.type.kind;if("string"!==R&&"value"!==R&&"null"!==R&&"resolvedImage"!==R)return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,v.push({content:k,scale:null,font:null,textColor:null})}}return new Pc(v)}evaluate(s){return new Ws(this.sections.map(d=>{const f=d.content.evaluate(s);return cs(f)===Ei?new jd("",f,null,null,null):new jd(ds(f),null,d.scale?d.scale.evaluate(s):null,d.font?d.font.evaluate(s).join(","):null,d.textColor?d.textColor.evaluate(s):null)}))}eachChild(s){for(const d of this.sections)s(d.content),d.scale&&s(d.scale),d.font&&s(d.font),d.textColor&&s(d.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const d of this.sections){s.push(d.content.serialize());const f={};d.scale&&(f["font-scale"]=d.scale.serialize()),d.font&&(f["text-font"]=d.font.serialize()),d.textColor&&(f["text-color"]=d.textColor.serialize()),s.push(f)}return s}}class od{constructor(s,d){this.type=Ei,this.inputPrimary=s,this.inputSecondary=d}static parse(s,d){if(s.length<2)return d.error("Expected two or more arguments.");const f=d.parse(s[1],1,Or);if(!f)return d.error("No image name provided.");if(2===s.length)return new od(f);const v=d.parse(s[2],1,Or);return v?new od(f,v):d.error("Secondary image variant is not a string.")}evaluate(s){const d=rn.fromString(this.inputPrimary.evaluate(s),this.inputSecondary?this.inputSecondary.evaluate(s):void 0);return d&&s.availableImages&&(d.available=s.availableImages.indexOf(d.namePrimary)>-1,d.nameSecondary&&d.available&&s.availableImages&&(d.available=s.availableImages.indexOf(d.nameSecondary)>-1)),d}eachChild(s){s(this.inputPrimary),this.inputSecondary&&s(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function sd(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}const cc={"to-boolean":wr,"to-color":Ae,"to-number":Ci,"to-string":Or};class Ms{constructor(s,d){this.type=s,this.args=d}static parse(s,d){if(s.length<2)return d.error("Expected at least one argument.");const f=s[0],v=[];let y=Ma;if("to-array"===f){if(!Array.isArray(s[1]))return null;const E=s[1].length;if(d.expectedType){if("array"!==d.expectedType.kind)return d.error(`Expected ${d.expectedType.kind} but found array.`);y=fn(d.expectedType.itemType,E)}else{if(!(E>0&&lc(s[1][0])))return null;y=fn(cs(s[1][0]),E)}for(let M=0;M<E;M++){const k=s[1][M];let R;if("array"===sd(k))R=d.parse(k,void 0,y.itemType);else{const L=sd(k);if(L!==y.itemType.kind)return d.error(`Expected ${y.itemType.kind} but found ${L}.`);R=d.registry.literal.parse(["literal",void 0===k?null:k],d)}if(!R)return null;v.push(R)}}else{if(("to-boolean"===f||"to-string"===f)&&2!==s.length)return d.error("Expected one argument.");y=cc[f];for(let E=1;E<s.length;E++){const M=d.parse(s[E],E,Ve);if(!M)return null;v.push(M)}}return new Ms(y,v)}evaluate(s){if("boolean"===this.type.kind)return!!this.args[0].evaluate(s);if("color"===this.type.kind){let d,f;for(const v of this.args){if(d=v.evaluate(s),f=null,d instanceof Vo)return d;if("string"==typeof d){const y=s.parseColor(d);if(y)return y}else if(Array.isArray(d)&&(f=d.length<3||d.length>4?`Invalid rbga value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:Qa(d[0],d[1],d[2],d[3]),!f))return new Vo(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Ls(f||`Could not parse color from value '${"string"==typeof d?d:String(JSON.stringify(d))}'`)}if("number"===this.type.kind){let d=null;for(const f of this.args){if(d=f.evaluate(s),null===d)return 0;const v=Number(d);if(!isNaN(v))return v}throw new Ls(`Could not convert ${JSON.stringify(d)} to number.`)}return"formatted"===this.type.kind?Ws.fromString(ds(this.args[0].evaluate(s))):"resolvedImage"===this.type.kind?rn.fromString(ds(this.args[0].evaluate(s))):"array"===this.type.kind?this.args.map(d=>d.evaluate(s)):ds(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Pc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new od(this.args[0]).serialize();const s="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild(d=>{s.push(d.serialize())}),s}}var dc=Ms;const vh=["Unknown","Point","LineString","Polygon"];var $_=class{constructor(a,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=a,this.options=s}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?vh[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(a){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:d,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(d*s-a[0])+this.featureDistanceData.bearing[1]*(f*s-a[1])}return 0}parseColor(a){let s=this._parseColorCache[a];return s||(s=this._parseColorCache[a]=Vo.parse(a)),s}getConfig(a){return this.options?this.options.get(a):null}};class Hd{constructor(s,d,f,v,y){this.name=s,this.type=d,this._evaluate=f,this.args=v,this._overloadIndex=y}evaluate(s){if(!this._evaluate){const d=Hd.definitions[this.name];this._evaluate=Array.isArray(d)?d[2]:d.overloads[this._overloadIndex][1]}return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,d){const f=s[0],v=Hd.definitions[f];if(!v)return d.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(v)?v[0]:v.type,E=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,M=[];let k=null,R=-1;for(const[L,V]of E){if(Array.isArray(L)&&L.length!==s.length-1)continue;M.push(L),R++,k=new Y_(d.registry,d.path,null,d.scope,void 0,d._scope,d.options);const j=[];let q=!1;for(let Z=1;Z<s.length;Z++){const J=s[Z],ne=Array.isArray(L)?L[Z-1]:L.type,le=k.parse(J,1+j.length,ne);if(!le){q=!0;break}j.push(le)}if(!q)if(Array.isArray(L)&&L.length!==j.length)k.error(`Expected ${L.length} arguments, but found ${j.length} instead.`);else{for(let Z=0;Z<j.length;Z++){const J=Array.isArray(L)?L[Z]:L.type,ne=j[Z];k.concat(Z+1).checkSubtype(J,ne.type)}if(0===k.errors.length)return new Hd(f,y,V,j,R)}}if(1===M.length)d.errors.push(...k.errors);else{const L=(M.length?M:E.map(([j])=>j)).map(gf).join(" | "),V=[];for(let j=1;j<s.length;j++){const q=d.parse(s[j],1+V.length);if(!q)return null;V.push(An(q.type))}d.error(`Expected arguments of type ${L}, but found (${V.join(", ")}) instead.`)}return null}static register(s,d){Hd.definitions=d;for(const f in d)s[f]=Hd}}function gf(a){return Array.isArray(a)?`(${a.map(An).join(", ")})`:`(${An(a.type)}...)`}var Kn=Hd;class zm{constructor(s,d,f){this.type=Et,this.locale=f,this.caseSensitive=s,this.diacriticSensitive=d}static parse(s,d){if(2!==s.length)return d.error("Expected one argument.");const f=s[1];if("object"!=typeof f||Array.isArray(f))return d.error("Collator options argument must be an object.");const v=d.parse(void 0!==f["case-sensitive"]&&f["case-sensitive"],1,wr);if(!v)return null;const y=d.parse(void 0!==f["diacritic-sensitive"]&&f["diacritic-sensitive"],1,wr);if(!y)return null;let E=null;return f.locale&&(E=d.parse(f.locale,1,Or),!E)?null:new zm(v,y,E)}evaluate(s){return new $n(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}var Oc={exports:{}};Oc.exports=function(){function a(f,v,y,E,M){for(;E>y;){if(E-y>600){var k=E-y+1,R=v-y+1,L=Math.log(k),V=.5*Math.exp(2*L/3),j=.5*Math.sqrt(L*V*(k-V)/k)*(R-k/2<0?-1:1);a(f,v,Math.max(y,Math.floor(v-R*V/k+j)),Math.min(E,Math.floor(v+(k-R)*V/k+j)),M)}var q=f[v],Z=y,J=E;for(s(f,y,v),M(f[E],q)>0&&s(f,y,E);Z<J;){for(s(f,Z,J),Z++,J--;M(f[Z],q)<0;)Z++;for(;M(f[J],q)>0;)J--}0===M(f[y],q)?s(f,y,J):s(f,++J,E),J<=v&&(y=J+1),v<=J&&(E=J-1)}}function s(f,v,y){var E=f[v];f[v]=f[y],f[y]=E}function d(f,v){return f<v?-1:f>v?1:0}return function(f,v,y,E,M){a(f,v,y||0,E||f.length-1,M||d)}}();var he=un(Oc.exports);function N(a){let s=0;for(let d,f,v=0,y=a.length,E=y-1;v<y;E=v++)d=a[v],f=a[E],s+=(f.x-d.x)*(d.y+f.y);return s}function W(a,s){a[0]=Math.min(a[0],s[0]),a[1]=Math.min(a[1],s[1]),a[2]=Math.max(a[2],s[0]),a[3]=Math.max(a[3],s[1])}function re(a,s){return!(a[0]<=s[0]||a[2]>=s[2]||a[1]<=s[1]||a[3]>=s[3])}function _e(a,s,d){const f=a[0]-s[0],v=a[1]-s[1],y=a[0]-d[0],E=a[1]-d[1];return f*E-y*v==0&&f*y<=0&&v*E<=0}function Ie(a,s,d=!1){let f=!1;for(let M=0,k=s.length;M<k;M++){const R=s[M];for(let L=0,V=R.length,j=V-1;L<V;j=L++){const q=R[j],Z=R[L];if(_e(a,q,Z))return d;(y=q)[1]>(v=a)[1]!=(E=Z)[1]>v[1]&&v[0]<(E[0]-y[0])*(v[1]-y[1])/(E[1]-y[1])+y[0]&&(f=!f)}}var v,y,E;return f}function $e(a,s,d,f){const v=f[0]-d[0],y=f[1]-d[1],E=(a[0]-d[0])*y-v*(a[1]-d[1]),M=(s[0]-d[0])*y-v*(s[1]-d[1]);return E>0&&M<0||E<0&&M>0}function Ue(a,s,d,f){return(v=[f[0]-d[0],f[1]-d[1]])[0]*(y=[s[0]-a[0],s[1]-a[1]])[1]-v[1]*y[0]!=0&&!(!$e(a,s,d,f)||!$e(d,f,a,s));var v,y}const Ct=8192;function zt(a,s){const d=(180+a[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,v=Math.pow(2,s.z);return[Math.round(d*v*Ct),Math.round(f*v*Ct)]}function li(a,s){for(let d=0;d<s.length;d++)if(Ie(a,s[d]))return!0;return!1}function Ln(a,s,d){for(const f of d)for(let v=0,y=f.length,E=y-1;v<y;E=v++)if(Ue(a,s,f[E],f[v]))return!0;return!1}function En(a,s){for(let d=0;d<a.length;++d)if(!Ie(a[d],s))return!1;for(let d=0;d<a.length-1;++d)if(Ln(a[d],a[d+1],s))return!1;return!0}function Wn(a,s){for(let d=0;d<s.length;d++)if(En(a,s[d]))return!0;return!1}function pr(a,s,d){const f=[];for(let v=0;v<a.length;v++){const y=[];for(let E=0;E<a[v].length;E++){const M=zt(a[v][E],d);W(s,M),y.push(M)}f.push(y)}return f}function ys(a,s,d){const f=[];for(let v=0;v<a.length;v++){const y=pr(a[v],s,d);f.push(y)}return f}function Ja(a,s,d,f){if(a[0]<d[0]||a[0]>d[2]){const v=.5*f;let y=a[0]-d[0]>v?-f:d[0]-a[0]>v?f:0;0===y&&(y=a[0]-d[2]>v?-f:d[2]-a[0]>v?f:0),a[0]+=y}W(s,a)}function xl(a,s,d,f){const v=Math.pow(2,f.z)*Ct,y=[f.x*Ct,f.y*Ct],E=[];if(!a)return E;for(const M of a)for(const k of M){const R=[k.x+y[0],k.y+y[1]];Ja(R,s,d,v),E.push(R)}return E}function Lc(a,s,d,f){const v=Math.pow(2,f.z)*Ct,y=[f.x*Ct,f.y*Ct],E=[];if(!a)return E;for(const k of a){const R=[];for(const L of k){const V=[L.x+y[0],L.y+y[1]];W(s,V),R.push(V)}E.push(R)}if(s[2]-s[0]<=v/2){(M=s)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const k of E)for(const R of k)Ja(R,s,d,v)}var M;return E}class ja{constructor(s,d){this.type=wr,this.geojson=s,this.geometries=d}static parse(s,d){if(2!==s.length)return d.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(lc(s[1])){const f=s[1];if("FeatureCollection"===f.type)for(let v=0;v<f.features.length;++v){const y=f.features[v].geometry.type;if("Polygon"===y||"MultiPolygon"===y)return new ja(f,f.features[v].geometry)}else if("Feature"===f.type){const v=f.geometry.type;if("Polygon"===v||"MultiPolygon"===v)return new ja(f,f.geometry)}else if("Polygon"===f.type||"MultiPolygon"===f.type)return new ja(f,f)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(d,f){const v=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],E=d.canonicalID();if(!E)return!1;if("Polygon"===f.type){const M=pr(f.coordinates,y,E),k=xl(d.geometry(),v,y,E);if(!re(v,y))return!1;for(const R of k)if(!Ie(R,M))return!1}if("MultiPolygon"===f.type){const M=ys(f.coordinates,y,E),k=xl(d.geometry(),v,y,E);if(!re(v,y))return!1;for(const R of k)if(!li(R,M))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(d,f){const v=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],E=d.canonicalID();if(!E)return!1;if("Polygon"===f.type){const M=pr(f.coordinates,y,E),k=Lc(d.geometry(),v,y,E);if(!re(v,y))return!1;for(const R of k)if(!En(R,M))return!1}if("MultiPolygon"===f.type){const M=ys(f.coordinates,y,E),k=Lc(d.geometry(),v,y,E);if(!re(v,y))return!1;for(const R of k)if(!Wn(R,M))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ga=ja,wl={exports:{}};wl.exports=function(){var a={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},s=1/298.257223563,d=s*(2-s),f=Math.PI/180,v=function(R,L){if(void 0===R)throw new Error("No latitude given.");if(L&&!a[L])throw new Error("Unknown unit "+L+". Use one of: "+Object.keys(a).join(", "));var V=6378.137*f*(L?a[L]:1),j=Math.cos(R*f),q=1/(1-d*(1-j*j)),Z=Math.sqrt(q);this.kx=V*Z*j,this.ky=V*Z*q*(1-d)},y={units:{configurable:!0}};function E(R,L){return R[0]===L[0]&&R[1]===L[1]}function M(R,L,V){var j=k(L[0]-R[0]);return[R[0]+j*V,R[1]+(L[1]-R[1])*V]}function k(R){for(;R<-180;)R+=360;for(;R>180;)R-=360;return R}return v.fromTile=function(R,L,V){var j=Math.PI*(1-2*(R+.5)/Math.pow(2,L)),q=Math.atan(.5*(Math.exp(j)-Math.exp(-j)))/f;return new v(q,V)},y.units.get=function(){return a},v.prototype.distance=function(R,L){var V=k(R[0]-L[0])*this.kx,j=(R[1]-L[1])*this.ky;return Math.sqrt(V*V+j*j)},v.prototype.bearing=function(R,L){var V=k(L[0]-R[0])*this.kx;return Math.atan2(V,(L[1]-R[1])*this.ky)/f},v.prototype.destination=function(R,L,V){var j=V*f;return this.offset(R,Math.sin(j)*L,Math.cos(j)*L)},v.prototype.offset=function(R,L,V){return[R[0]+L/this.kx,R[1]+V/this.ky]},v.prototype.lineDistance=function(R){for(var L=0,V=0;V<R.length-1;V++)L+=this.distance(R[V],R[V+1]);return L},v.prototype.area=function(R){for(var L=0,V=0;V<R.length;V++)for(var j=R[V],q=0,Z=j.length,J=Z-1;q<Z;J=q++)L+=k(j[q][0]-j[J][0])*(j[q][1]+j[J][1])*(V?-1:1);return Math.abs(L)/2*this.kx*this.ky},v.prototype.along=function(R,L){var V=0;if(L<=0)return R[0];for(var j=0;j<R.length-1;j++){var q=R[j],Z=R[j+1],J=this.distance(q,Z);if((V+=J)>L)return M(q,Z,(L-(V-J))/J)}return R[R.length-1]},v.prototype.pointToSegmentDistance=function(R,L,V){var j=L[0],q=L[1],Z=k(V[0]-j)*this.kx,J=(V[1]-q)*this.ky,ne=0;return 0===Z&&0===J||((ne=(k(R[0]-j)*this.kx*Z+(R[1]-q)*this.ky*J)/(Z*Z+J*J))>1?(j=V[0],q=V[1]):ne>0&&(j+=Z/this.kx*ne,q+=J/this.ky*ne)),Z=k(R[0]-j)*this.kx,J=(R[1]-q)*this.ky,Math.sqrt(Z*Z+J*J)},v.prototype.pointOnLine=function(R,L){for(var V,j,q,Z,J=1/0,ne=0;ne<R.length-1;ne++){var le=R[ne][0],xe=R[ne][1],Ee=k(R[ne+1][0]-le)*this.kx,Te=(R[ne+1][1]-xe)*this.ky,Le=0;0===Ee&&0===Te||((Le=(k(L[0]-le)*this.kx*Ee+(L[1]-xe)*this.ky*Te)/(Ee*Ee+Te*Te))>1?(le=R[ne+1][0],xe=R[ne+1][1]):Le>0&&(le+=Ee/this.kx*Le,xe+=Te/this.ky*Le));var ke=(Ee=k(L[0]-le)*this.kx)*Ee+(Te=(L[1]-xe)*this.ky)*Te;ke<J&&(J=ke,V=le,j=xe,q=ne,Z=Le)}return{point:[V,j],index:q,t:Math.max(0,Math.min(1,Z))}},v.prototype.lineSlice=function(R,L,V){var j=this.pointOnLine(V,R),q=this.pointOnLine(V,L);if(j.index>q.index||j.index===q.index&&j.t>q.t){var Z=j;j=q,q=Z}var J=[j.point],ne=j.index+1,le=q.index;!E(V[ne],J[0])&&ne<=le&&J.push(V[ne]);for(var xe=ne+1;xe<=le;xe++)J.push(V[xe]);return E(V[le],q.point)||J.push(q.point),J},v.prototype.lineSliceAlong=function(R,L,V){for(var j=0,q=[],Z=0;Z<V.length-1;Z++){var J=V[Z],ne=V[Z+1],le=this.distance(J,ne);if((j+=le)>R&&0===q.length&&q.push(M(J,ne,(R-(j-le))/le)),j>=L)return q.push(M(J,ne,(L-(j-le))/le)),q;j>R&&q.push(ne)}return q},v.prototype.bufferPoint=function(R,L){var V=L/this.ky,j=L/this.kx;return[R[0]-j,R[1]-V,R[0]+j,R[1]+V]},v.prototype.bufferBBox=function(R,L){var V=L/this.ky,j=L/this.kx;return[R[0]-j,R[1]-V,R[2]+j,R[3]+V]},v.prototype.insideBBox=function(R,L){return k(R[0]-L[0])>=0&&k(R[0]-L[2])<=0&&R[1]>=L[1]&&R[1]<=L[3]},Object.defineProperties(v,y),v}();var fo=un(wl.exports),Fc={exports:{}};Fc.exports=function(){var a=function(d,f){if(void 0===d&&(d=[]),void 0===f&&(f=s),this.data=d,this.length=this.data.length,this.compare=f,this.length>0)for(var v=(this.length>>1)-1;v>=0;v--)this._down(v)};function s(d,f){return d<f?-1:d>f?1:0}return a.prototype.push=function(d){this.data.push(d),this.length++,this._up(this.length-1)},a.prototype.pop=function(){if(0!==this.length){var d=this.data[0],f=this.data.pop();return this.length--,this.length>0&&(this.data[0]=f,this._down(0)),d}},a.prototype.peek=function(){return this.data[0]},a.prototype._up=function(d){for(var f=this.data,v=this.compare,y=f[d];d>0;){var E=d-1>>1,M=f[E];if(v(y,M)>=0)break;f[d]=M,d=E}f[d]=y},a.prototype._down=function(d){for(var f=this.data,v=this.compare,y=this.length>>1,E=f[d];d<y;){var M=1+(d<<1),k=f[M],R=M+1;if(R<this.length&&v(f[R],k)<0&&(M=R,k=f[R]),v(k,E)>=0)break;f[d]=k,d=M}f[d]=E},a}();var da=un(Fc.exports),Nt=8192;function Um(a,s){return s.dist-a.dist}const Xs=100,Cu=50;function jm(a){const s=[1/0,1/0,-1/0,-1/0];if(s.length!==a.length)return!1;for(let d=0;d<s.length;d++)if(s[d]!==a[d])return!1;return!0}function uc(a){return a[1]-a[0]+1}function Cl(a,s){const d=a[1]>=a[0]&&a[1]<s;return d||console.warn("Distance Expression: Index is out of range"),d}function gr(a,s){if(a[0]>a[1])return[null,null];const d=uc(a);if(s){if(2===d)return[a,null];const f=Math.floor(d/2);return[[a[0],a[0]+f],[a[0]+f,a[1]]]}{if(1===d)return[a,null];const f=Math.floor(d/2)-1;return[[a[0],a[0]+f],[a[0]+f+1,a[1]]]}}function hc(a,s){const d=[1/0,1/0,-1/0,-1/0];if(!Cl(s,a.length))return d;for(let f=s[0];f<=s[1];++f)W(d,a[f]);return d}function Aa(a){const s=[1/0,1/0,-1/0,-1/0];for(let d=0;d<a.length;++d)for(let f=0;f<a[d].length;++f)W(s,a[d][f]);return s}function _f(a,s,d){if(jm(a)||jm(s))return NaN;let f=0,v=0;return a[2]<s[0]&&(f=s[0]-a[2]),a[0]>s[2]&&(f=a[0]-s[2]),a[1]>s[3]&&(v=a[1]-s[3]),a[3]<s[1]&&(v=s[1]-a[3]),d.distance([0,0],[f,v])}function Gm(a){return 360*a-180}function hC(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function jl(a,s){const d=Math.pow(2,s.z),f=(a.y/Nt+s.y)/d;return[Gm((a.x/Nt+s.x)/d),hC(f)]}function fC(a,s){const d=[];for(let f=0;f<a.length;++f)d.push(jl(a[f],s));return d}function W_(a,s,d){const f=d.pointOnLine(s,a).point;return d.distance(a,f)}function Mx(a,s,d,f,v){const y=d.slice(f[0],f[1]+1);let E=1/0;for(let M=s[0];M<=s[1];++M)if(0===(E=Math.min(E,W_(a[M],y,v))))return 0;return E}function Gb(a,s,d,f,v){const y=Math.min(v.pointToSegmentDistance(a,d,f),v.pointToSegmentDistance(s,d,f)),E=Math.min(v.pointToSegmentDistance(d,a,s),v.pointToSegmentDistance(f,a,s));return Math.min(y,E)}function Ax(a,s,d,f,v){if(!Cl(s,a.length)||!Cl(f,d.length))return NaN;let y=1/0;for(let E=s[0];E<s[1];++E)for(let M=f[0];M<f[1];++M){if(Ue(a[E],a[E+1],d[M],d[M+1]))return 0;y=Math.min(y,Gb(a[E],a[E+1],d[M],d[M+1],v))}return y}function Hb(a,s,d,f,v){if(!Cl(s,a.length)||!Cl(f,d.length))return NaN;let y=1/0;for(let E=s[0];E<=s[1];++E)for(let M=f[0];M<=f[1];++M)if(0===(y=Math.min(y,v.distance(a[E],d[M]))))return y;return y}function X_(a,s,d){if(Ie(a,s,!0))return 0;let f=1/0;for(const v of s){const y=v.length;if(y<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(v[0]!==v[y-1]&&0===(f=Math.min(f,d.pointToSegmentDistance(a,v[y-1],v[0])))||0===(f=Math.min(f,W_(a,v,d))))return f}return f}function $b(a,s,d,f){if(!Cl(s,a.length))return NaN;for(let y=s[0];y<=s[1];++y)if(Ie(a[y],d,!0))return 0;let v=1/0;for(let y=s[0];y<s[1];++y)for(const E of d)for(let M=0,k=E.length,R=k-1;M<k;R=M++){if(Ue(a[y],a[y+1],E[R],E[M]))return 0;v=Math.min(v,Gb(a[y],a[y+1],E[R],E[M],f))}return v}function Da(a,s){for(const d of a)for(let f=0;f<=d.length-1;++f)if(Ie(d[f],s,!0))return!0;return!1}function yr(a,s,d,f=1/0){const v=Aa(a),y=Aa(s);if(f!==1/0&&_f(v,y,d)>=f)return f;if(re(v,y)){if(Da(a,s))return 0}else if(Da(s,a))return 0;let E=f;for(const M of a)for(let k=0,R=M.length,L=R-1;k<R;L=k++)for(const V of s)for(let j=0,q=V.length,Z=q-1;j<q;Z=j++){if(Ue(M[L],M[k],V[Z],V[j]))return 0;E=Math.min(E,Gb(M[L],M[k],V[Z],V[j],d))}return E}function mg(a,s,d,f,v,y,E){if(null===y||null===E)return;const M=_f(hc(f,y),hc(v,E),d);M<s&&a.push({dist:M,range1:y,range2:E})}function pg(a,s,d,f,v=1/0){let y=Math.min(f.distance(a[0],d[0][0]),v);if(0===y)return y;const E=new da([{dist:0,range1:[0,a.length-1],range2:[0,0]}],Um),M=s?Cu:Xs,k=Aa(d);for(;E.length;){const R=E.pop();if(R.dist>=y)continue;const L=R.range1;if(uc(L)<=M){if(!Cl(L,a.length))return NaN;if(s){const V=$b(a,L,d,f);if(0===(y=Math.min(y,V)))return y}else for(let V=L[0];V<=L[1];++V){const j=X_(a[V],d,f);if(0===(y=Math.min(y,j)))return y}}else{const V=gr(L,s);if(null!==V[0]){const j=_f(hc(a,V[0]),k,f);j<y&&E.push({dist:j,range1:V[0],range2:[0,0]})}if(null!==V[1]){const j=_f(hc(a,V[1]),k,f);j<y&&E.push({dist:j,range1:V[1],range2:[0,0]})}}}return y}function Wb(a,s,d,f,v,y=1/0){let E=Math.min(y,v.distance(a[0],d[0]));if(0===E)return E;const M=new da([{dist:0,range1:[0,a.length-1],range2:[0,d.length-1]}],Um),k=s?Cu:Xs,R=f?Cu:Xs;for(;M.length;){const L=M.pop();if(L.dist>=E)continue;const V=L.range1,j=L.range2;if(uc(V)<=k&&uc(j)<=R){if(!Cl(V,a.length)||!Cl(j,d.length))return NaN;if(s&&f?E=Math.min(E,Ax(a,V,d,j,v)):s||f?s&&!f?E=Math.min(E,Mx(d,j,a,V,v)):!s&&f&&(E=Math.min(E,Mx(a,V,d,j,v))):E=Math.min(E,Hb(a,V,d,j,v)),0===E)return E}else{const q=gr(V,s),Z=gr(j,f);mg(M,E,v,a,d,q[0],Z[0]),mg(M,E,v,a,d,q[0],Z[1]),mg(M,E,v,a,d,q[1],Z[0]),mg(M,E,v,a,d,q[1],Z[1])}}return E}function Hm(a,s,d,f,v=1/0){let y=v;const E=hc(a,[0,a.length-1]);for(const M of d)if(!(y!==1/0&&_f(E,hc(M,[0,M.length-1]),f)>=y)&&(y=Math.min(y,Wb(a,s,M,!0,f,y)),0===y))return y;return y}function q_(a,s,d,f,v=1/0){let y=v;const E=hc(a,[0,a.length-1]);for(const M of d){if(y!==1/0&&_f(E,Aa(M),f)>=y)continue;const k=pg(a,s,M,f,y);if(isNaN(k))return k;if(0===(y=Math.min(y,k)))return y}return y}function zo(a){return"Point"===a||"MultiPoint"===a||"LineString"===a||"MultiLineString"===a||"Polygon"===a||"MultiPolygon"===a}class vf{constructor(s,d){this.type=Ci,this.geojson=s,this.geometries=d}static parse(s,d){if(2!==s.length)return d.error(`'distance' expression requires either one argument, but found ' ${s.length-1} instead.`);if(lc(s[1])){const f=s[1];if("FeatureCollection"===f.type){for(let v=0;v<f.features.length;++v)if(zo(f.features[v].geometry.type))return new vf(f,f.features[v].geometry)}else if("Feature"===f.type){if(zo(f.geometry.type))return new vf(f,f.geometry)}else if(zo(f.type))return new vf(f,f)}return d.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(s){const d=s.geometry(),f=s.canonicalID();if(null!=d&&null!=f){if("Point"===s.geometryType())return function(v,y,E){const M=[];for(const R of v)for(const L of R)M.push(jl(L,y));const k=new fo(M[0][1],"meters");return"Point"===E.type||"MultiPoint"===E.type||"LineString"===E.type?Wb(M,!1,"Point"===E.type?[E.coordinates]:E.coordinates,"LineString"===E.type,k):"MultiLineString"===E.type?Hm(M,!1,E.coordinates,k):"Polygon"===E.type||"MultiPolygon"===E.type?q_(M,!1,"Polygon"===E.type?[E.coordinates]:E.coordinates,k):null}(d,f,this.geometries);if("LineString"===s.geometryType())return function(v,y,E){const M=[];for(const R of v){const L=[];for(const V of R)L.push(jl(V,y));M.push(L)}const k=new fo(M[0][0][1],"meters");if("Point"===E.type||"MultiPoint"===E.type||"LineString"===E.type)return Hm("Point"===E.type?[E.coordinates]:E.coordinates,"LineString"===E.type,M,k);if("MultiLineString"===E.type){let R=1/0;for(let L=0;L<E.coordinates.length;L++){const V=Hm(E.coordinates[L],!0,M,k,R);if(isNaN(V))return V;if(0===(R=Math.min(R,V)))return R}return R}if("Polygon"===E.type||"MultiPolygon"===E.type){let R=1/0;for(let L=0;L<M.length;L++){const V=q_(M[L],!0,"Polygon"===E.type?[E.coordinates]:E.coordinates,k,R);if(isNaN(V))return V;if(0===(R=Math.min(R,V)))return R}return R}return null}(d,f,this.geometries);if("Polygon"===s.geometryType())return function(v,y,E){const M=[];for(const R of function(L){const j=L.length;if(j<=1)return[L];const q=[];let Z,J;for(let ne=0;ne<j;ne++){const le=N(L[ne]);0!==le&&(L[ne].area=Math.abs(le),void 0===J&&(J=le<0),J===le<0?(Z&&q.push(Z),Z=[L[ne]]):Z.push(L[ne]))}return Z&&q.push(Z),q}(v)){const L=[];for(let V=0;V<R.length;++V)L.push(fC(R[V],y));M.push(L)}const k=new fo(M[0][0][0][1],"meters");if("Point"===E.type||"MultiPoint"===E.type||"LineString"===E.type)return q_("Point"===E.type?[E.coordinates]:E.coordinates,"LineString"===E.type,M,k);if("MultiLineString"===E.type){let R=1/0;for(let L=0;L<E.coordinates.length;L++){const V=q_(E.coordinates[L],!0,M,k,R);if(isNaN(V))return V;if(0===(R=Math.min(R,V)))return R}return R}return"Polygon"===E.type||"MultiPolygon"===E.type?function(R,L,V){let j=1/0;for(const q of R)for(const Z of L){const J=yr(q,Z,V,j);if(isNaN(J))return J;if(0===(j=Math.min(j,J)))return j}return j}("Polygon"===E.type?[E.coordinates]:E.coordinates,M,k):null}(d,f,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var Eu=vf;function $d(a,s){switch(a){case"string":return ds(s);case"number":return+s;case"boolean":return!!s;case"color":return Vo.parse(s);case"formatted":return Ws.fromString(ds(s));case"resolvedImage":return rn.fromString(ds(s))}return s}function Xb(a,s,d,f){return void 0!==f&&(a=f*Math.round(a/f)),void 0!==s&&a<s&&(a=s),void 0!==d&&a>d&&(a=d),a}class fc{constructor(s,d,f){this.type=s,this.key=d,this.scope=f}static parse(s,d){let f=d.expectedType;if(null==f&&(f=Ve),s.length<2||s.length>3)return d.error("Invalid number of arguments for 'config' expression.");const v=d.parse(s[1],1);if(!(v instanceof Gd))return d.error("Key name of 'config' expression must be a string literal.");if(s.length>=3){const y=d.parse(s[2],2);return y instanceof Gd?new fc(f,ds(v.value),ds(y.value)):d.error("Scope of 'config' expression must be a string literal.")}return new fc(f,ds(v.value))}evaluate(s){const d=[this.key,this.scope,s.scope].filter(Boolean).join("\x1f"),f=s.getConfig(d);if(!f)return null;const{type:v,value:y,values:E,minValue:M,maxValue:k,stepValue:R}=f,L=f.default.evaluate(s);let V=L;if(y){const j=s.scope;s.scope=(j||"").split("\x1f").slice(1).join("\x1f"),V=y.evaluate(s),s.scope=j}return v&&(V=$d(v,V)),void 0===V||void 0===M&&void 0===k&&void 0===R||("number"==typeof V?V=Xb(V,M,k,R):Array.isArray(V)&&(V=V.map(j=>"number"==typeof j?Xb(j,M,k,R):j))),void 0!==y&&void 0!==V&&E&&!E.includes(V)&&(V=L,v&&(V=$d(v,V))),(v&&v!==this.type||void 0!==V&&cs(V)!==this.type)&&(V=$d(this.type.kind,V)),V}eachChild(){}outputDefined(){return!1}serialize(){const s=["config",this.key];return this.scope&&s.concat(this.key),s}}var bf=fc;function ad(a){if(a instanceof Kn&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Ga||a instanceof Eu)return!1;let s=!0;return a.eachChild(d=>{s&&!ad(d)&&(s=!1)}),s}function Tu(a){if(a instanceof Kn&&"feature-state"===a.name)return!1;let s=!0;return a.eachChild(d=>{s&&!Tu(d)&&(s=!1)}),s}function Wd(a){if(a instanceof bf)return!1;let s=!0;return a.eachChild(d=>{s&&!Wd(d)&&(s=!1)}),s}function qs(a,s){if(a instanceof Kn&&s.indexOf(a.name)>=0)return!1;let d=!0;return a.eachChild(f=>{d&&!qs(f,s)&&(d=!1)}),d}class Su{constructor(s,d){this.type=d.type,this.name=s,this.boundExpression=d}static parse(s,d){if(2!==s.length||"string"!=typeof s[1])return d.error("'var' expression requires exactly one string literal argument.");const f=s[1];return d.scope.has(f)?new Su(f,d.scope.get(f)):d.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Qn=Su;class gg{constructor(s,d=[],f,v=new mf,y=[],E,M){this.registry=s,this.path=d,this.key=d.map(k=>`[${k}]`).join(""),this.scope=v,this.errors=y,this.expectedType=f,this._scope=E,this.options=M}parse(s,d,f,v,y={}){return d||f?this.concat(d,f,v)._parse(s,y):this._parse(s,y)}_parse(s,d){function f(v,y,E){return"assert"===E?new rd(y,[v]):"coerce"===E?new dc(y,[v]):v}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v="string"==typeof s[0]?this.registry[s[0]]:void 0;if(v){let y=v.parse(s,this);if(!y)return null;if(this.expectedType){const E=this.expectedType,M=y.type;if("string"!==E.kind&&"number"!==E.kind&&"boolean"!==E.kind&&"object"!==E.kind&&"array"!==E.kind||"value"!==M.kind)if("color"!==E.kind&&"formatted"!==E.kind&&"resolvedImage"!==E.kind||"value"!==M.kind&&"string"!==M.kind){if(this.checkSubtype(E,M))return null}else y=f(y,E,d.typeAnnotation||"coerce");else y=f(y,E,d.typeAnnotation||"assert")}if(!(y instanceof Gd)&&"resolvedImage"!==y.type.kind&&$m(y)){const E=new $_(this._scope,this.options);try{y=new Gd(y.type,y.evaluate(E))}catch(M){return this.error(M.message),null}}return y}return dc.parse(["to-array",s],this)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,d,f){const v="number"==typeof s?this.path.concat(s):this.path,y=f?this.scope.concat(f):this.scope;return new gg(this.registry,v,d||null,y,this.errors,this._scope,this.options)}error(s,...d){const f=`${this.key}${d.map(v=>`[${v}]`).join("")}`;this.errors.push(new Os(f,s))}checkSubtype(s,d){const f=Zo(s,d);return f&&this.error(f),f}}var Y_=gg;function $m(a){if(a instanceof Qn)return $m(a.boundExpression);if(a instanceof Kn&&"error"===a.name||a instanceof zm||a instanceof Ga||a instanceof Eu||a instanceof bf)return!1;const s=a instanceof dc||a instanceof rd;let d=!0;return a.eachChild(f=>{d=s?d&&$m(f):d&&f instanceof Gd}),!!d&&ad(a)&&qs(a,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Xd(a,s){const d=a.length-1;let f,v,y=0,E=d,M=0;for(;y<=E;)if(M=Math.floor((y+E)/2),f=a[M],v=a[M+1],f<=s){if(M===d||s<v)return M;y=M+1}else{if(!(f>s))throw new Ls("Input is not a number.");E=M-1}return 0}class mc{constructor(s,d,f){this.type=s,this.input=d,this.labels=[],this.outputs=[];for(const[v,y]of f)this.labels.push(v),this.outputs.push(y)}static parse(s,d){if(s.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return d.error("Expected an even number of arguments.");const f=d.parse(s[1],1,Ci);if(!f)return null;const v=[];let y=null;d.expectedType&&"value"!==d.expectedType.kind&&(y=d.expectedType);for(let E=1;E<s.length;E+=2){const M=1===E?-1/0:s[E],k=s[E+1],R=E,L=E+1;if("number"!=typeof M)return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(v.length&&v[v.length-1][0]>=M)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const V=d.parse(k,L,y);if(!V)return null;y=y||V.type,v.push([M,V])}return new mc(y,f,v)}evaluate(s){const d=this.labels,f=this.outputs;if(1===d.length)return f[0].evaluate(s);const v=this.input.evaluate(s);if(v<=d[0])return f[0].evaluate(s);const y=d.length;return v>=d[y-1]?f[y-1].evaluate(s):f[Xd(d,v)].evaluate(s)}eachChild(s){s(this.input);for(const d of this.outputs)s(d)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let d=0;d<this.labels.length;d++)d>0&&s.push(this.labels[d]),s.push(this.outputs[d].serialize());return s}}var Nc=mc;const Dx=4/29,Wm=6/29,Xm=3*Wm*Wm,yf=Wm*Wm*Wm,xf=Math.PI/180,Gl=180/Math.PI;function qm(a){return a>yf?Math.pow(a,1/3):a/Xm+Dx}function pc(a){return a>Wm?a*a*a:Xm*(a-Dx)}function Mu(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Ym(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Dr(a){const s=Ym(a.r),d=Ym(a.g),f=Ym(a.b),v=qm((.4124564*s+.3575761*d+.1804375*f)/.95047),y=qm((.2126729*s+.7151522*d+.072175*f)/1);return{l:116*y-16,a:500*(v-y),b:200*(y-qm((.0193339*s+.119192*d+.9503041*f)/1.08883)),alpha:a.a}}function To(a){let s=(a.l+16)/116,d=isNaN(a.a)?s:s+a.a/500,f=isNaN(a.b)?s:s-a.b/200;return s=1*pc(s),d=.95047*pc(d),f=1.08883*pc(f),new Vo(Mu(3.2404542*d-1.5371385*s-.4985314*f),Mu(-.969266*d+1.8760108*s+.041556*f),Mu(.0556434*d-.2040259*s+1.0572252*f),a.alpha)}function Z_(a,s,d){const f=s-a;return a+d*(f>180||f<-180?f-360*Math.round(f/360):f)}const wf={forward:Dr,reverse:To,interpolate:function(a,s,d){return{l:rr(a.l,s.l,d),a:rr(a.a,s.a,d),b:rr(a.b,s.b,d),alpha:rr(a.alpha,s.alpha,d)}}},Cf={forward:function(a){const{l:s,a:d,b:f}=Dr(a),v=Math.atan2(f,d)*Gl;return{h:v<0?v+360:v,c:Math.sqrt(d*d+f*f),l:s,alpha:a.a}},reverse:function(a){const s=a.h*xf,d=a.c;return To({l:a.l,a:Math.cos(s)*d,b:Math.sin(s)*d,alpha:a.alpha})},interpolate:function(a,s,d){return{h:Z_(a.h,s.h,d),c:rr(a.c,s.c,d),l:rr(a.l,s.l,d),alpha:rr(a.alpha,s.alpha,d)}}};var qb=Object.freeze({__proto__:null,hcl:Cf,lab:wf});class Zm{constructor(s,d,f,v,y){this.type=s,this.operator=d,this.interpolation=f,this.input=v,this.labels=[],this.outputs=[];for(const[E,M]of y)this.labels.push(E),this.outputs.push(M)}static interpolationFactor(s,d,f,v){let y=0;if("exponential"===s.name)y=Au(d,s.base,f,v);else if("linear"===s.name)y=Au(d,1,f,v);else if("cubic-bezier"===s.name){const E=s.controlPoints;y=new Di(E[0],E[1],E[2],E[3]).solve(Au(d,1,f,v))}return y}static parse(s,d){let[f,v,y,...E]=s;if(!Array.isArray(v)||0===v.length)return d.error("Expected an interpolation type expression.",1);if("linear"===v[0])v={name:"linear"};else if("exponential"===v[0]){const R=v[1];if("number"!=typeof R)return d.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:R}}else{if("cubic-bezier"!==v[0])return d.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const R=v.slice(1);if(4!==R.length||R.some(L=>"number"!=typeof L||L<0||L>1))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:R}}}if(s.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(y=d.parse(y,2,Ci),!y)return null;const M=[];let k=null;"interpolate-hcl"===f||"interpolate-lab"===f?k=Ae:d.expectedType&&"value"!==d.expectedType.kind&&(k=d.expectedType);for(let R=0;R<E.length;R+=2){const L=E[R],V=E[R+1],j=R+3,q=R+4;if("number"!=typeof L)return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(M.length&&M[M.length-1][0]>=L)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const Z=d.parse(V,q,k);if(!Z)return null;k=k||Z.type,M.push([L,Z])}return"number"===k.kind||"color"===k.kind||"array"===k.kind&&"number"===k.itemType.kind&&"number"==typeof k.N?new Zm(k,f,v,y,M):d.error(`Type ${An(k)} is not interpolatable.`)}evaluate(s){const d=this.labels,f=this.outputs;if(1===d.length)return f[0].evaluate(s);const v=this.input.evaluate(s);if(v<=d[0])return f[0].evaluate(s);const y=d.length;if(v>=d[y-1])return f[y-1].evaluate(s);const E=Xd(d,v),M=Zm.interpolationFactor(this.interpolation,v,d[E],d[E+1]),k=f[E].evaluate(s),R=f[E+1].evaluate(s);return"interpolate"===this.operator?Ic[this.type.kind.toLowerCase()](k,R,M):"interpolate-hcl"===this.operator?Cf.reverse(Cf.interpolate(Cf.forward(k),Cf.forward(R),M)):wf.reverse(wf.interpolate(wf.forward(k),wf.forward(R),M))}eachChild(s){s(this.input);for(const d of this.outputs)s(d)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const d=[this.operator,s,this.input.serialize()];for(let f=0;f<this.labels.length;f++)d.push(this.labels[f],this.outputs[f].serialize());return d}}function Au(a,s,d,f){const v=f-d,y=a-d;return 0===v?0:1===s?y/v:(Math.pow(s,y)-1)/(Math.pow(s,v)-1)}var Cr=Zm;class qd{constructor(s,d){this.type=s,this.args=d}static parse(s,d){if(s.length<2)return d.error("Expectected at least one argument.");let f=null;const v=d.expectedType;v&&"value"!==v.kind&&(f=v);const y=[];for(const M of s.slice(1)){const k=d.parse(M,1+y.length,f,void 0,{typeAnnotation:"omit"});if(!k)return null;f=f||k.type,y.push(k)}const E=v&&y.some(M=>Zo(v,M.type));return new qd(E?Ve:f,y)}evaluate(s){let d,f=null,v=0;for(const y of this.args){if(v++,f=y.evaluate(s),f&&f instanceof rn&&!f.available&&(d||(d=f),f=null,v===this.args.length))return d;if(null!==f)break}return f}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(d=>{s.push(d.serialize())}),s}}var _g=qd;class Ia{constructor(s,d){this.type=d.type,this.bindings=[].concat(s),this.result=d}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const d of this.bindings)s(d[1]);s(this.result)}static parse(s,d){if(s.length<4)return d.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const f=[];for(let y=1;y<s.length-1;y+=2){const E=s[y];if("string"!=typeof E)return d.error(`Expected string, but found ${typeof E} instead.`,y);if(/[^a-zA-Z0-9_]/.test(E))return d.error("Variable names must contain only alphanumeric characters or '_'.",y);const M=d.parse(s[y+1],y+1);if(!M)return null;f.push([E,M])}const v=d.parse(s[s.length-1],s.length-1,d.expectedType,f);return v?new Ia(f,v):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[d,f]of this.bindings)s.push(d,f.serialize());return s.push(this.result.serialize()),s}}var vg=Ia;class Yd{constructor(s,d,f){this.type=s,this.index=d,this.input=f}static parse(s,d){if(3!==s.length)return d.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=d.parse(s[1],1,Ci),v=d.parse(s[2],2,fn(d.expectedType||Ve));return f&&v?new Yd(v.type.itemType,f,v):null}evaluate(s){const d=this.index.evaluate(s),f=this.input.evaluate(s);if(d<0)throw new Ls(`Array index out of bounds: ${d} < 0.`);if(d>=f.length)throw new Ls(`Array index out of bounds: ${d} > ${f.length-1}.`);if(d!==Math.floor(d))throw new Ls(`Array index must be an integer, but found ${d} instead.`);return f[d]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var kr=Yd;class Ef{constructor(s,d){this.type=wr,this.needle=s,this.haystack=d}static parse(s,d){if(3!==s.length)return d.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=d.parse(s[1],1,Ve),v=d.parse(s[2],2,Ve);return f&&v?nn(f.type,[wr,Or,Ci,Ma,Ve])?new Ef(f,v):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${An(f.type)} instead`):null}evaluate(s){const d=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(null==f)return!1;if(!nd(d,["boolean","string","number","null"]))throw new Ls(`Expected first argument to be of type boolean, string, number or null, but found ${An(cs(d))} instead.`);if(!nd(f,["string","array"]))throw new Ls(`Expected second argument to be of type array or string, but found ${An(cs(f))} instead.`);return f.indexOf(d)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Yb=Ef;class os{constructor(s,d,f){this.type=Ci,this.needle=s,this.haystack=d,this.fromIndex=f}static parse(s,d){if(s.length<=2||s.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=d.parse(s[1],1,Ve),v=d.parse(s[2],2,Ve);if(!f||!v)return null;if(!nn(f.type,[wr,Or,Ci,Ma,Ve]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${An(f.type)} instead`);if(4===s.length){const y=d.parse(s[3],3,Ci);return y?new os(f,v,y):null}return new os(f,v)}evaluate(s){const d=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!nd(d,["boolean","string","number","null"]))throw new Ls(`Expected first argument to be of type boolean, string, number or null, but found ${An(cs(d))} instead.`);if(!nd(f,["string","array"]))throw new Ls(`Expected second argument to be of type array or string, but found ${An(cs(f))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(s);return f.indexOf(d,v)}return f.indexOf(d)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var K_=os;class Q_{constructor(s,d,f,v,y,E){this.inputType=s,this.type=d,this.input=f,this.cases=v,this.outputs=y,this.otherwise=E}static parse(s,d){if(s.length<5)return d.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return d.error("Expected an even number of arguments.");let f,v;d.expectedType&&"value"!==d.expectedType.kind&&(v=d.expectedType);const y={},E=[];for(let R=2;R<s.length-1;R+=2){let L=s[R];const V=s[R+1];Array.isArray(L)||(L=[L]);const j=d.concat(R);if(0===L.length)return j.error("Expected at least one branch label.");for(const Z of L){if("number"!=typeof Z&&"string"!=typeof Z)return j.error("Branch labels must be numbers or strings.");if("number"==typeof Z&&Math.abs(Z)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Z&&Math.floor(Z)!==Z)return j.error("Numeric branch labels must be integer values.");if(f){if(j.checkSubtype(f,cs(Z)))return null}else f=cs(Z);if(void 0!==y[String(Z)])return j.error("Branch labels must be unique.");y[String(Z)]=E.length}const q=d.parse(V,R,v);if(!q)return null;v=v||q.type,E.push(q)}const M=d.parse(s[1],1,Ve);if(!M)return null;const k=d.parse(s[s.length-1],s.length-1,v);return k?"value"!==M.type.kind&&d.concat(1).checkSubtype(f,M.type)?null:new Q_(f,v,M,y,E,k):null}evaluate(s){const d=this.input.evaluate(s);return(cs(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],d=Object.keys(this.cases).sort(),f=[],v={};for(const E of d){const M=v[this.cases[E]];void 0===M?(v[this.cases[E]]=f.length,f.push([this.cases[E],[E]])):f[M][1].push(E)}const y=E=>"number"===this.inputType.kind?Number(E):E;for(const[E,M]of f)s.push(1===M.length?y(M[0]):M.map(y)),s.push(this.outputs[E].serialize());return s.push(this.otherwise.serialize()),s}}var Km=Q_;class Tf{constructor(s,d,f){this.type=s,this.branches=d,this.otherwise=f}static parse(s,d){if(s.length<4)return d.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return d.error("Expected an odd number of arguments.");let f;d.expectedType&&"value"!==d.expectedType.kind&&(f=d.expectedType);const v=[];for(let E=1;E<s.length-1;E+=2){const M=d.parse(s[E],E,wr);if(!M)return null;const k=d.parse(s[E+1],E+1,f);if(!k)return null;v.push([M,k]),f=f||k.type}const y=d.parse(s[s.length-1],s.length-1,f);return y?new Tf(f,v,y):null}evaluate(s){for(const[d,f]of this.branches)if(d.evaluate(s))return f.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[d,f]of this.branches)s(d),s(f);s(this.otherwise)}outputDefined(){return this.branches.every(([s,d])=>d.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(d=>{s.push(d.serialize())}),s}}var Sf=Tf;class Qm{constructor(s,d,f,v){this.type=s,this.input=d,this.beginIndex=f,this.endIndex=v}static parse(s,d){if(s.length<=2||s.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=d.parse(s[1],1,Ve),v=d.parse(s[2],2,Ci);if(!f||!v)return null;if(!nn(f.type,[fn(Ve),Or,Ve]))return d.error(`Expected first argument to be of type array or string, but found ${An(f.type)} instead`);if(4===s.length){const y=d.parse(s[3],3,Ci);return y?new Qm(f.type,f,v,y):null}return new Qm(f.type,f,v)}evaluate(s){const d=this.input.evaluate(s),f=this.beginIndex.evaluate(s);if(!nd(d,["string","array"]))throw new Ls(`Expected first argument to be of type array or string, but found ${An(cs(d))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(s);return d.slice(f,v)}return d.slice(f)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Hl=Qm;function J_(a,s){return"=="===a||"!="===a?"boolean"===s.kind||"string"===s.kind||"number"===s.kind||"null"===s.kind||"value"===s.kind:"string"===s.kind||"number"===s.kind||"value"===s.kind}function ba(a,s,d,f){return 0===f.compare(s,d)}function Du(a,s,d){const f="=="!==a&&"!="!==a;return class tX{constructor(y,E,M){this.type=wr,this.lhs=y,this.rhs=E,this.collator=M,this.hasUntypedArgument="value"===y.type.kind||"value"===E.type.kind}static parse(y,E){if(3!==y.length&&4!==y.length)return E.error("Expected two or three arguments.");const M=y[0];let k=E.parse(y[1],1,Ve);if(!k)return null;if(!J_(M,k.type))return E.concat(1).error(`"${M}" comparisons are not supported for type '${An(k.type)}'.`);let R=E.parse(y[2],2,Ve);if(!R)return null;if(!J_(M,R.type))return E.concat(2).error(`"${M}" comparisons are not supported for type '${An(R.type)}'.`);if(k.type.kind!==R.type.kind&&"value"!==k.type.kind&&"value"!==R.type.kind)return E.error(`Cannot compare types '${An(k.type)}' and '${An(R.type)}'.`);f&&("value"===k.type.kind&&"value"!==R.type.kind?k=new rd(R.type,[k]):"value"!==k.type.kind&&"value"===R.type.kind&&(R=new rd(k.type,[R])));let L=null;if(4===y.length){if("string"!==k.type.kind&&"string"!==R.type.kind&&"value"!==k.type.kind&&"value"!==R.type.kind)return E.error("Cannot use collator to compare non-string types.");if(L=E.parse(y[3],3,Et),!L)return null}return new tX(k,R,L)}evaluate(y){const E=this.lhs.evaluate(y),M=this.rhs.evaluate(y);if(f&&this.hasUntypedArgument){const k=cs(E),R=cs(M);if(k.kind!==R.kind||"string"!==k.kind&&"number"!==k.kind)throw new Ls(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${k.kind}, ${R.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const k=cs(E),R=cs(M);if("string"!==k.kind||"string"!==R.kind)return s(y,E,M)}return this.collator?d(y,E,M,this.collator.evaluate(y)):s(y,E,M)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[a];return this.eachChild(E=>{y.push(E.serialize())}),y}}}const Tn=Du("==",function(a,s,d){return s===d},ba),Jm=Du("!=",function(a,s,d){return s!==d},function(a,s,d,f){return!ba(0,s,d,f)}),Mf=Du("<",function(a,s,d){return s<d},function(a,s,d,f){return f.compare(s,d)<0}),bg=Du(">",function(a,s,d){return s>d},function(a,s,d,f){return f.compare(s,d)>0}),ev=Du("<=",function(a,s,d){return s<=d},function(a,s,d,f){return f.compare(s,d)<=0}),kx=Du(">=",function(a,s,d){return s>=d},function(a,s,d,f){return f.compare(s,d)>=0});class tv{constructor(s,d,f,v,y,E){this.type=Or,this.number=s,this.locale=d,this.currency=f,this.unit=v,this.minFractionDigits=y,this.maxFractionDigits=E}static parse(s,d){if(3!==s.length)return d.error("Expected two arguments.");const f=d.parse(s[1],1,Ci);if(!f)return null;const v=s[2];if("object"!=typeof v||Array.isArray(v))return d.error("NumberFormat options argument must be an object.");let y=null;if(v.locale&&(y=d.parse(v.locale,1,Or),!y))return null;let E=null;if(v.currency&&(E=d.parse(v.currency,1,Or),!E))return null;let M=null;if(v.unit&&(M=d.parse(v.unit,1,Or),!M))return null;let k=null;if(v["min-fraction-digits"]&&(k=d.parse(v["min-fraction-digits"],1,Ci),!k))return null;let R=null;return v["max-fraction-digits"]&&(R=d.parse(v["max-fraction-digits"],1,Ci),!R)?null:new tv(f,y,E,M,k,R)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class bh{constructor(s){this.type=Ci,this.input=s}static parse(s,d){if(2!==s.length)return d.error(`Expected 1 argument, but found ${s.length-1} instead.`);const f=d.parse(s[1],1);return f?"array"!==f.type.kind&&"string"!==f.type.kind&&"value"!==f.type.kind?d.error(`Expected argument of type string or array, but found ${An(f.type)} instead.`):new bh(f):null}evaluate(s){const d=this.input.evaluate(s);if("string"==typeof d||Array.isArray(d))return d.length;throw new Ls(`Expected value to be of type string or array, but found ${An(cs(d))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(d=>{s.push(d.serialize())}),s}}function Af(a){return function(){a=1831565813+(a|=0)|0;let s=Math.imul(a^a>>>15,1|a);return s=s+Math.imul(s^s>>>7,61|s)^s,((s^s>>>14)>>>0)/4294967296}}const Zb={"==":Tn,"!=":Jm,">":bg,"<":Mf,">=":kx,"<=":ev,array:rd,at:kr,boolean:rd,case:Sf,coalesce:_g,collator:zm,format:Pc,image:od,in:Yb,"index-of":K_,interpolate:Cr,"interpolate-hcl":Cr,"interpolate-lab":Cr,length:bh,let:vg,literal:Gd,match:Km,number:rd,"number-format":tv,object:rd,slice:Hl,step:Nc,string:rd,"to-boolean":dc,"to-color":dc,"to-number":dc,"to-string":dc,var:Qn,within:Ga,distance:Eu,config:bf};function Df(a,[s,d,f,v]){s=s.evaluate(a),d=d.evaluate(a),f=f.evaluate(a);const y=v?v.evaluate(a):1,E=Qa(s,d,f,y);if(E)throw new Ls(E);return new Vo(s/255*y,d/255*y,f/255*y,y)}function Kb(a,[s,d,f,v]){s=s.evaluate(a),d=d.evaluate(a),f=f.evaluate(a);const y=v?v.evaluate(a):1,E=(L=d,V=f,j=y,"number"==typeof(R=s)&&R>=0&&R<=360?"number"==typeof L&&L>=0&&L<=100&&"number"==typeof V&&V>=0&&V<=100?void 0===j||"number"==typeof j&&j>=0&&j<=1?null:`Invalid hsla value [${[R,L,V,j].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof j?[R,L,V,j]:[R,L,V]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof j?[R,L,V,j]:[R,L,V]).join(", ")}]: 'h' must be between 0 and 360.`);var R,L,V,j;if(E)throw new Ls(E);const M=`hsla(${s}, ${d}%, ${f}%, ${y})`,k=Vo.parse(M);if(!k)throw new Ls(`Failed to parse HSLA color: ${M}`);return k}function ku(a,s){return a in s}function Qb(a,s){const d=s[a];return void 0===d?null:d}function ia(a){return{type:a}}Kn.register(Zb,{error:[{kind:"error"},[Or],(a,[s])=>{throw new Ls(s.evaluate(a))}],typeof:[Or,[Ve],(a,[s])=>An(cs(s.evaluate(a)))],"to-rgba":[fn(Ci,4),[Ae],(a,[s])=>s.evaluate(a).toArray()],rgb:[Ae,[Ci,Ci,Ci],Df],rgba:[Ae,[Ci,Ci,Ci,Ci],Df],hsl:[Ae,[Ci,Ci,Ci],Kb],hsla:[Ae,[Ci,Ci,Ci,Ci],Kb],has:{type:wr,overloads:[[[Or],(a,[s])=>ku(s.evaluate(a),a.properties())],[[Or,Oe],(a,[s,d])=>ku(s.evaluate(a),d.evaluate(a))]]},get:{type:Ve,overloads:[[[Or],(a,[s])=>Qb(s.evaluate(a),a.properties())],[[Or,Oe],(a,[s,d])=>Qb(s.evaluate(a),d.evaluate(a))]]},"feature-state":[Ve,[Or],(a,[s])=>Qb(s.evaluate(a),a.featureState||{})],properties:[Oe,[],a=>a.properties()],"geometry-type":[Or,[],a=>a.geometryType()],id:[Ve,[],a=>a.id()],zoom:[Ci,[],a=>a.globals.zoom],pitch:[Ci,[],a=>a.globals.pitch||0],"distance-from-center":[Ci,[],a=>a.distanceFromCenter()],"measure-light":[Ci,[Or],(a,[s])=>a.measureLight(s.evaluate(a))],"heatmap-density":[Ci,[],a=>a.globals.heatmapDensity||0],"line-progress":[Ci,[],a=>a.globals.lineProgress||0],"raster-value":[Ci,[],a=>a.globals.rasterValue||0],"raster-particle-speed":[Ci,[],a=>a.globals.rasterParticleSpeed||0],"sky-radial-progress":[Ci,[],a=>a.globals.skyRadialProgress||0],accumulated:[Ve,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[Ci,ia(Ci),(a,s)=>{let d=0;for(const f of s)d+=f.evaluate(a);return d}],"*":[Ci,ia(Ci),(a,s)=>{let d=1;for(const f of s)d*=f.evaluate(a);return d}],"-":{type:Ci,overloads:[[[Ci,Ci],(a,[s,d])=>s.evaluate(a)-d.evaluate(a)],[[Ci],(a,[s])=>-s.evaluate(a)]]},"/":[Ci,[Ci,Ci],(a,[s,d])=>s.evaluate(a)/d.evaluate(a)],"%":[Ci,[Ci,Ci],(a,[s,d])=>s.evaluate(a)%d.evaluate(a)],ln2:[Ci,[],()=>Math.LN2],pi:[Ci,[],()=>Math.PI],e:[Ci,[],()=>Math.E],"^":[Ci,[Ci,Ci],(a,[s,d])=>Math.pow(s.evaluate(a),d.evaluate(a))],sqrt:[Ci,[Ci],(a,[s])=>Math.sqrt(s.evaluate(a))],log10:[Ci,[Ci],(a,[s])=>Math.log(s.evaluate(a))/Math.LN10],ln:[Ci,[Ci],(a,[s])=>Math.log(s.evaluate(a))],log2:[Ci,[Ci],(a,[s])=>Math.log(s.evaluate(a))/Math.LN2],sin:[Ci,[Ci],(a,[s])=>Math.sin(s.evaluate(a))],cos:[Ci,[Ci],(a,[s])=>Math.cos(s.evaluate(a))],tan:[Ci,[Ci],(a,[s])=>Math.tan(s.evaluate(a))],asin:[Ci,[Ci],(a,[s])=>Math.asin(s.evaluate(a))],acos:[Ci,[Ci],(a,[s])=>Math.acos(s.evaluate(a))],atan:[Ci,[Ci],(a,[s])=>Math.atan(s.evaluate(a))],min:[Ci,ia(Ci),(a,s)=>Math.min(...s.map(d=>d.evaluate(a)))],max:[Ci,ia(Ci),(a,s)=>Math.max(...s.map(d=>d.evaluate(a)))],abs:[Ci,[Ci],(a,[s])=>Math.abs(s.evaluate(a))],round:[Ci,[Ci],(a,[s])=>{const d=s.evaluate(a);return d<0?-Math.round(-d):Math.round(d)}],floor:[Ci,[Ci],(a,[s])=>Math.floor(s.evaluate(a))],ceil:[Ci,[Ci],(a,[s])=>Math.ceil(s.evaluate(a))],"filter-==":[wr,[Or,Ve],(a,[s,d])=>a.properties()[s.value]===d.value],"filter-id-==":[wr,[Ve],(a,[s])=>a.id()===s.value],"filter-type-==":[wr,[Or],(a,[s])=>a.geometryType()===s.value],"filter-<":[wr,[Or,Ve],(a,[s,d])=>{const f=a.properties()[s.value],v=d.value;return typeof f==typeof v&&f<v}],"filter-id-<":[wr,[Ve],(a,[s])=>{const d=a.id(),f=s.value;return typeof d==typeof f&&d<f}],"filter->":[wr,[Or,Ve],(a,[s,d])=>{const f=a.properties()[s.value],v=d.value;return typeof f==typeof v&&f>v}],"filter-id->":[wr,[Ve],(a,[s])=>{const d=a.id(),f=s.value;return typeof d==typeof f&&d>f}],"filter-<=":[wr,[Or,Ve],(a,[s,d])=>{const f=a.properties()[s.value],v=d.value;return typeof f==typeof v&&f<=v}],"filter-id-<=":[wr,[Ve],(a,[s])=>{const d=a.id(),f=s.value;return typeof d==typeof f&&d<=f}],"filter->=":[wr,[Or,Ve],(a,[s,d])=>{const f=a.properties()[s.value],v=d.value;return typeof f==typeof v&&f>=v}],"filter-id->=":[wr,[Ve],(a,[s])=>{const d=a.id(),f=s.value;return typeof d==typeof f&&d>=f}],"filter-has":[wr,[Ve],(a,[s])=>s.value in a.properties()],"filter-has-id":[wr,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[wr,[fn(Or)],(a,[s])=>s.value.indexOf(a.geometryType())>=0],"filter-id-in":[wr,[fn(Ve)],(a,[s])=>s.value.indexOf(a.id())>=0],"filter-in-small":[wr,[Or,fn(Ve)],(a,[s,d])=>d.value.indexOf(a.properties()[s.value])>=0],"filter-in-large":[wr,[Or,fn(Ve)],(a,[s,d])=>function(f,v,y,E){for(;y<=E;){const M=y+E>>1;if(v[M]===f)return!0;v[M]>f?E=M-1:y=M+1}return!1}(a.properties()[s.value],d.value,0,d.value.length-1)],all:{type:wr,overloads:[[[wr,wr],(a,[s,d])=>s.evaluate(a)&&d.evaluate(a)],[ia(wr),(a,s)=>{for(const d of s)if(!d.evaluate(a))return!1;return!0}]]},any:{type:wr,overloads:[[[wr,wr],(a,[s,d])=>s.evaluate(a)||d.evaluate(a)],[ia(wr),(a,s)=>{for(const d of s)if(d.evaluate(a))return!0;return!1}]]},"!":[wr,[wr],(a,[s])=>!s.evaluate(a)],"is-supported-script":[wr,[Or],(a,[s])=>{const d=a.globals&&a.globals.isSupportedScript;return!d||d(s.evaluate(a))}],upcase:[Or,[Or],(a,[s])=>s.evaluate(a).toUpperCase()],downcase:[Or,[Or],(a,[s])=>s.evaluate(a).toLowerCase()],concat:[Or,ia(Ve),(a,s)=>s.map(d=>ds(d.evaluate(a))).join("")],"resolved-locale":[Or,[Et],(a,[s])=>s.evaluate(a).resolvedLocale()],random:[Ci,[Ci,Ci,Ve],(a,s)=>{const[d,f,v]=s.map(E=>E.evaluate(a));if(d>f||d===f)return d;let y;if("string"==typeof v)y=function(E){let M=0;if(0===E.length)return M;for(let k=0;k<E.length;k++)M=(M<<5)-M+E.charCodeAt(k),M|=0;return M}(v);else{if("number"!=typeof v)throw new Ls(`Invalid seed input: ${v}`);y=v}return d+Af(y)()*(f-d)}]});var Bc=Zb;function yg(a){return{result:"success",value:a}}function Zd(a){return{result:"error",value:a}}function xg(a,s){return!!a&&!!a.parameters&&a.parameters.indexOf(s)>-1}function kf(a){return"data-driven"===a["property-type"]}function Jb(a){return xg(a.expression,"measure-light")}function iv(a){return xg(a.expression,"zoom")}function Ix(a){return!!a.expression&&a.expression.interpolated}function el(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function wg(a){return a}function Iu(a,s){const d="color"===s.type,f=a.stops&&"object"==typeof a.stops[0][0],v=f||!(f||void 0!==a.property),y=a.type||(Ix(s)?"exponential":"interval");if(d&&((a=Sa({},a)).stops&&(a.stops=a.stops.map(R=>[R[0],Vo.parse(R[1])])),a.default=Vo.parse(a.default?a.default:s.default)),a.colorSpace&&"rgb"!==a.colorSpace&&!qb[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let E,M,k;if("exponential"===y)E=yo;else if("interval"===y)E=Kd;else if("categorical"===y){E=Rx,M=Object.create(null);for(const R of a.stops)M[R[0]]=R[1];k=typeof a.stops[0][0]}else{if("identity"!==y)throw new Error(`Unknown function type "${y}"`);E=Vc}if(f){const R={},L=[];for(let q=0;q<a.stops.length;q++){const Z=a.stops[q],J=Z[0].zoom;void 0===R[J]&&(R[J]={zoom:J,type:a.type,property:a.property,default:a.default,stops:[]},L.push(J)),R[J].stops.push([Z[0].value,Z[1]])}const V=[];for(const q of L)V.push([R[q].zoom,Iu(R[q],s)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:Cr.interpolationFactor.bind(void 0,j),zoomStops:V.map(q=>q[0]),evaluate:({zoom:q},Z)=>yo({stops:V,base:a.base},s,q).evaluate(q,Z)}}if(v){const R="exponential"===y?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:Cr.interpolationFactor.bind(void 0,R),zoomStops:a.stops.map(L=>L[0]),evaluate:({zoom:L})=>E(a,s,L,M,k)}}return{kind:"source",evaluate(R,L){const V=L&&L.properties?L.properties[a.property]:void 0;return void 0===V?Cg(a.default,s.default):E(a,s,V,M,k)}}}function Cg(a,s,d){return void 0!==a?a:void 0!==s?s:void 0!==d?d:void 0}function Rx(a,s,d,f,v){return Cg(typeof d===v?f[d]:void 0,a.default,s.default)}function Kd(a,s,d){if("number"!==sd(d))return Cg(a.default,s.default);const f=a.stops.length;if(1===f||d<=a.stops[0][0])return a.stops[0][1];if(d>=a.stops[f-1][0])return a.stops[f-1][1];const v=Xd(a.stops.map(y=>y[0]),d);return a.stops[v][1]}function yo(a,s,d){const f=void 0!==a.base?a.base:1;if("number"!==sd(d))return Cg(a.default,s.default);const v=a.stops.length;if(1===v||d<=a.stops[0][0])return a.stops[0][1];if(d>=a.stops[v-1][0])return a.stops[v-1][1];const y=Xd(a.stops.map(L=>L[0]),d),E=function(L,V,j,q){const Z=q-j,J=L-j;return 0===Z?0:1===V?J/Z:(Math.pow(V,J)-1)/(Math.pow(V,Z)-1)}(d,f,a.stops[y][0],a.stops[y+1][0]),M=a.stops[y][1],k=a.stops[y+1][1];let R=Ic[s.type]||wg;if(a.colorSpace&&"rgb"!==a.colorSpace){const L=qb[a.colorSpace];R=(V,j)=>L.reverse(L.interpolate(L.forward(V),L.forward(j),E))}return"function"==typeof M.evaluate?{evaluate(...L){const V=M.evaluate.apply(void 0,L),j=k.evaluate.apply(void 0,L);if(void 0!==V&&void 0!==j)return R(V,j,E)}}:R(M,k,E)}function Vc(a,s,d){return"color"===s.type?d=Vo.parse(d):"formatted"===s.type?d=Ws.fromString(d.toString()):"resolvedImage"===s.type?d=rn.fromString(d.toString()):sd(d)===s.type||"enum"===s.type&&s.values[d]||(d=void 0),Cg(d,a.default,s.default)}class ep{constructor(s,d,f,v){var y;this.expression=s,this._warningHistory={},this._evaluator=new $_(f,v),this._defaultValue=d?"color"===(y=d).type&&(el(y.default)||Array.isArray(y.default))?new Vo(0,0,0,0):"color"===y.type?Vo.parse(y.default)||null:void 0===y.default?null:y.default:null,this._enumValues=d&&"enum"===d.type?d.values:null}evaluateWithoutErrorHandling(s,d,f,v,y,E,M,k){return this._evaluator.globals=s,this._evaluator.feature=d,this._evaluator.featureState=f,this._evaluator.canonical=v||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=E,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=k||null,this.expression.evaluate(this._evaluator)}evaluate(s,d,f,v,y,E,M,k){this._evaluator.globals=s,this._evaluator.feature=d||null,this._evaluator.featureState=f||null,this._evaluator.canonical=v||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=E||null,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=k||null;try{const R=this.expression.evaluate(this._evaluator);if(null==R||"number"==typeof R&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new Ls(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(R.message)),this._defaultValue}}}function If(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in Bc}function Ru(a,s,d,f){const v=new Y_(Bc,[],s?function(E){const M={color:Ae,string:Or,number:Ci,enum:Or,boolean:wr,formatted:Qt,resolvedImage:Ei};return"array"===E.type?fn(M[E.value]||Ve,E.length):M[E.type]}(s):void 0,void 0,void 0,d,f),y=v.parse(a,void 0,void 0,void 0,s&&"string"===s.type?{typeAnnotation:"coerce"}:void 0);return y?yg(new ep(y,s,d,f)):Zd(v.errors)}class Rf{constructor(s,d,f){this.kind=s,this._styleExpression=d,this.isLightConstant=f,this.isStateDependent="constant"!==s&&!Tu(d.expression),this.isConfigDependent=!Wd(d.expression)}evaluateWithoutErrorHandling(s,d,f,v,y,E){return this._styleExpression.evaluateWithoutErrorHandling(s,d,f,v,y,E)}evaluate(s,d,f,v,y,E){return this._styleExpression.evaluate(s,d,f,v,y,E)}}class ao{constructor(s,d,f,v,y){this.kind=s,this.zoomStops=f,this._styleExpression=d,this.isStateDependent="camera"!==s&&!Tu(d.expression),this.isLightConstant=y,this.isConfigDependent=!Wd(d.expression),this.interpolationType=v}evaluateWithoutErrorHandling(s,d,f,v,y,E){return this._styleExpression.evaluateWithoutErrorHandling(s,d,f,v,y,E)}evaluate(s,d,f,v,y,E){return this._styleExpression.evaluate(s,d,f,v,y,E)}interpolationFactor(s,d,f){return this.interpolationType?Cr.interpolationFactor(this.interpolationType,s,d,f):0}}function Pu(a,s,d,f){if("error"===(a=Ru(a,s,d,f)).result)return a;const v=a.value.expression,y=ad(v);if(!y&&!kf(s))return Zd([new Os("","data expressions not supported")]);const E=qs(v,["zoom","pitch","distance-from-center"]);if(!E&&!iv(s))return Zd([new Os("","zoom expressions not supported")]);const M=qs(v,["measure-light"]);if(!M&&!Jb(s))return Zd([new Os("","measure-light expression not supported")]);const k=s.expression&&s.expression.relaxZoomRestriction,R=Pf(v);return R||E||k?R instanceof Os?Zd([R]):R instanceof Cr&&!Ix(s)?Zd([new Os("",'"interpolate" expressions cannot be used with this property')]):yg(R?new ao(y?"camera":"composite",a.value,R.labels,R instanceof Cr?R.interpolation:void 0,M):new Rf(y?"constant":"source",a.value,M)):Zd([new Os("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Eg{constructor(s,d){this._parameters=s,this._specification=d,Sa(this,Iu(this._parameters,this._specification))}static deserialize(s){return new Eg(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Pf(a){let s=null;if(a instanceof vg)s=Pf(a.result);else if(a instanceof _g){for(const d of a.args)if(s=Pf(d),s)break}else(a instanceof Nc||a instanceof Cr)&&a.input instanceof Kn&&"zoom"===a.input.name&&(s=a);return s instanceof Os||a.eachChild(d=>{const f=Pf(d);f instanceof Os?s=f:s&&f&&s!==f&&(s=new Os("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}var Px=El,zc=3;function El(a,s,d){var f=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var v=new Int32Array(this.arrayBuffer);a=v[0],this.d=(s=v[1])+2*(d=v[2]);for(var y=0;y<this.d*this.d;y++){var E=v[zc+y],M=v[zc+y+1];f.push(E===M?null:v.subarray(E,M))}var k=v[zc+f.length+1];this.keys=v.subarray(v[zc+f.length],k),this.bboxes=v.subarray(k),this.insert=this._insertReadonly}else{this.d=s+2*d;for(var R=0;R<this.d*this.d;R++)f.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=a,this.padding=d,this.scale=s/a,this.uid=0;var L=d/s*a;this.min=-L,this.max=a+L}El.prototype.insert=function(a,s,d,f,v){this._forEachCell(s,d,f,v,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(s),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(v)},El.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},El.prototype._insertCell=function(a,s,d,f,v,y){this.cells[v].push(y)},El.prototype.query=function(a,s,d,f,v){var y=this.min,E=this.max;if(a<=y&&s<=y&&E<=d&&E<=f&&!v)return Array.prototype.slice.call(this.keys);var M=[];return this._forEachCell(a,s,d,f,this._queryCell,M,{},v),M},El.prototype._queryCell=function(a,s,d,f,v,y,E,M){var k=this.cells[v];if(null!==k)for(var R=this.keys,L=this.bboxes,V=0;V<k.length;V++){var j=k[V];if(void 0===E[j]){var q=4*j;(M?M(L[q+0],L[q+1],L[q+2],L[q+3]):a<=L[q+2]&&s<=L[q+3]&&d>=L[q+0]&&f>=L[q+1])?(E[j]=!0,y.push(R[j])):E[j]=!1}}},El.prototype._forEachCell=function(a,s,d,f,v,y,E,M){for(var k=this._convertToCellCoord(a),R=this._convertToCellCoord(s),L=this._convertToCellCoord(d),V=this._convertToCellCoord(f),j=k;j<=L;j++)for(var q=R;q<=V;q++){var Z=this.d*q+j;if((!M||M(this._convertFromCellCoord(j),this._convertFromCellCoord(q),this._convertFromCellCoord(j+1),this._convertFromCellCoord(q+1)))&&v.call(this,a,s,d,f,Z,y,E,M))return}},El.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},El.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},El.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,s=zc+this.cells.length+1+1,d=0,f=0;f<this.cells.length;f++)d+=this.cells[f].length;var v=new Int32Array(s+d+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var y=s,E=0;E<a.length;E++){var M=a[E];v[zc+E]=y,v.set(M,y),y+=M.length}return v[zc+a.length]=y,v.set(this.keys,y),v[zc+a.length+1]=y+=this.keys.length,v.set(this.bboxes,y),y+=this.bboxes.length,v.buffer};var Qd=un(Px);const Of={};function Oi(a,s,d={}){Object.defineProperty(a,"_classRegistryKey",{value:s,writeable:!1}),Of[s]={klass:a,omit:d.omit||[]}}Oi(Object,"Object"),Qd.serialize=function(a,s){const d=a.toArrayBuffer();return s&&s.add(d),{buffer:d}},Qd.deserialize=function(a){return new Qd(a.buffer)},Object.defineProperty(Qd,"name",{value:"Grid"}),Oi(Qd,"Grid"),Oi(Vo,"Color"),Oi(Error,"Error"),Oi(Ws,"Formatted"),Oi(jd,"FormattedSection"),Oi(ls,"AJAXError"),Oi(rn,"ResolvedImage"),Oi(Eg,"StylePropertyFunction"),Oi(ep,"StyleExpression",{omit:["_evaluator"]}),Oi(ao,"ZoomDependentExpression"),Oi(Rf,"ZoomConstantExpression"),Oi(Kn,"CompoundExpression",{omit:["_evaluate"]});for(const a in Bc)Of[Bc[a]._classRegistryKey]||Oi(Bc[a],`Expression${a}`);function nv(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function rv(a){return self.ImageBitmap&&a instanceof ImageBitmap}function Jd(a,s){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(nv(a)||rv(a))return s&&s.add(a),a;if(ArrayBuffer.isView(a)){const d=a;return s&&s.add(d.buffer),d}if(a instanceof ImageData)return s&&s.add(a.data.buffer),a;if(Array.isArray(a)){const d=[];for(const f of a)d.push(Jd(f,s));return d}if(a instanceof Map){const d={$name:"Map"};for(const[f,v]of a.entries())d[f]=Jd(v);return d}if("object"==typeof a){const d=a.constructor,f=d._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const v=d.serialize?d.serialize(a,s):{};if(!d.serialize){for(const y in a)a.hasOwnProperty(y)&&(Of[f].omit.indexOf(y)>=0||(v[y]=Jd(a[y],s)));a instanceof Error&&(v.message=a.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==f&&(v.$name=f),v}throw new Error("can't serialize object of type "+typeof a)}function Ra(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||nv(a)||rv(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Ra);if("object"==typeof a){const s=a.$name||"Object";if("Map"===s){const v=new Map;for(const y of Object.keys(a))"$name"!==y&&v.set(y,Ra(a[y]));return v}const{klass:d}=Of[s];if(!d)throw new Error(`can't deserialize unregistered class ${s}`);if(d.deserialize)return d.deserialize(a);const f=Object.create(d.prototype);for(const v of Object.keys(a))"$name"!==v&&(f[v]=Ra(a[v]));return f}throw new Error("can't deserialize object of type "+typeof a)}const Wi={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519,"CJK Unified Ideographs Extension B":a=>a>=131072&&a<=173791};function Uc(a){for(const s of a)if(ey(s.charCodeAt(0)))return!0;return!1}function tp(a){for(const s of a)if(!pC(s.charCodeAt(0)))return!1;return!0}function pC(a){return!(Wi.Arabic(a)||Wi["Arabic Supplement"](a)||Wi["Arabic Extended-A"](a)||Wi["Arabic Presentation Forms-A"](a)||Wi["Arabic Presentation Forms-B"](a))}function ey(a){return!(746!==a&&747!==a&&(a<4352||!(Wi["Bopomofo Extended"](a)||Wi.Bopomofo(a)||Wi["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Wi["CJK Compatibility Ideographs"](a)||Wi["CJK Compatibility"](a)||Wi["CJK Radicals Supplement"](a)||Wi["CJK Strokes"](a)||!(!Wi["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Wi["CJK Unified Ideographs Extension A"](a)||Wi["CJK Unified Ideographs"](a)||Wi["Enclosed CJK Letters and Months"](a)||Wi["Hangul Compatibility Jamo"](a)||Wi["Hangul Jamo Extended-A"](a)||Wi["Hangul Jamo Extended-B"](a)||Wi["Hangul Jamo"](a)||Wi["Hangul Syllables"](a)||Wi.Hiragana(a)||Wi["Ideographic Description Characters"](a)||Wi.Kanbun(a)||Wi["Kangxi Radicals"](a)||Wi["Katakana Phonetic Extensions"](a)||Wi.Katakana(a)&&12540!==a||!(!Wi["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!Wi["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Wi["Unified Canadian Aboriginal Syllabics"](a)||Wi["Unified Canadian Aboriginal Syllabics Extended"](a)||Wi["Vertical Forms"](a)||Wi["Yijing Hexagram Symbols"](a)||Wi["Yi Syllables"](a)||Wi["Yi Radicals"](a))))}function ov(a){return!(ey(a)||(s=a,Wi["Latin-1 Supplement"](s)&&(167===s||169===s||174===s||177===s||188===s||189===s||190===s||215===s||247===s)||Wi["General Punctuation"](s)&&(8214===s||8224===s||8225===s||8240===s||8241===s||8251===s||8252===s||8258===s||8263===s||8264===s||8265===s||8273===s)||Wi["Letterlike Symbols"](s)||Wi["Number Forms"](s)||Wi["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||9003===s||s>=9085&&s<=9114||s>=9150&&s<=9165||9167===s||s>=9169&&s<=9179||s>=9186&&s<=9215)||Wi["Control Pictures"](s)&&9251!==s||Wi["Optical Character Recognition"](s)||Wi["Enclosed Alphanumerics"](s)||Wi["Geometric Shapes"](s)||Wi["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Wi["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Wi["CJK Symbols and Punctuation"](s)||Wi.Katakana(s)||Wi["Private Use Area"](s)||Wi["CJK Compatibility Forms"](s)||Wi["Small Form Variants"](s)||Wi["Halfwidth and Fullwidth Forms"](s)||8734===s||8756===s||8757===s||s>=9984&&s<=10087||s>=10102&&s<=10131||65532===s||65533===s));var s}function Tg(a){return a>=1424&&a<=2303||Wi["Arabic Presentation Forms-A"](a)||Wi["Arabic Presentation Forms-B"](a)}function Ox(a,s){return!(!s&&Tg(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Wi.Khmer(a))}function ty(a){for(const s of a)if(Tg(s.charCodeAt(0)))return!0;return!1}const iy="deferred",ip="loading",Sg="loaded";let sv=null,tl="unavailable",Ou=null;const ny=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(tl="error"),sv&&sv(a)};function av(){no.fire(new Ps("pluginStateChange",{pluginStatus:tl,pluginURL:Ou}))}const no=new Ea,ps=function(){return tl},ya=function(){if(tl!==iy||!Ou)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");tl=ip,av(),Ou&&wt({url:Ou},a=>{a?ny(a):(tl=Sg,av())})},na={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>tl===Sg||null!=na.applyArabicShaping,isLoading:()=>tl===ip,setState(a){tl=a.pluginStatus,Ou=a.pluginURL},isParsed:()=>null!=na.applyArabicShaping&&null!=na.processBidirectionalText&&null!=na.processStyledBidirectionalText,getPluginURL:()=>Ou};class qr{constructor(s,d){this.zoom=s,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.transition=d.transition,this.pitch=d.pitch,this.brightness=d.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(s){return function(d,f){for(const v of d)if(!Ox(v.charCodeAt(0),f))return!1;return!0}(s,na.isLoaded())}}class np{constructor(s,d,f,v){this.property=s,this.value=d,this.expression=function(y,E,M,k){if(el(y))return new Eg(y,E);if(If(y)||Array.isArray(y)&&y.length>0){const R=Pu(y,E,M,k);if("error"===R.result)throw new Error(R.value.map(L=>`${L.key}: ${L.message}`).join(", "));return R.value}{let R=y;return"string"==typeof y&&"color"===E.type&&(R=Vo.parse(y)),{kind:"constant",isConfigDependent:!1,evaluate:()=>R}}}(void 0===d?s.specification.default:d,s.specification,f,v)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(s,d,f){return this.property.possiblyEvaluate(this,s,d,f)}}class lv{constructor(s,d,f){this.property=s,this.value=new np(s,void 0,d,f)}transitioned(s,d){return new ry(this.property,this.value,d,Hr({},s.transition,this.transition),s.now)}untransitioned(){return new ry(this.property,this.value,null,{},0)}}class gc{constructor(s,d,f){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues),this._scope=d,this._options=f,this.isConfigDependent=!1}getValue(s){return io(this._values[s].value.value)}setValue(s,d){this._values.hasOwnProperty(s)||(this._values[s]=new lv(this._values[s].property,this._scope,this._options)),this._values[s].value=new np(this._values[s].property,null===d?void 0:io(d),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[s].value.expression.isConfigDependent}setTransitionOrValue(s,d){d&&(this._options=d);const f=this._properties.properties;if(s)for(const v in s){const y=s[v];if(zr(v,"-transition")){const E=v.slice(0,-11);f[E]&&this.setTransition(E,y)}else f[v]&&this.setValue(v,y)}}getTransition(s){return io(this._values[s].transition)}setTransition(s,d){this._values.hasOwnProperty(s)||(this._values[s]=new lv(this._values[s].property)),this._values[s].transition=io(d)||void 0}serialize(){const s={};for(const d of Object.keys(this._values)){const f=this.getValue(d);void 0!==f&&(s[d]=f);const v=this.getTransition(d);void 0!==v&&(s[`${d}-transition`]=v)}return s}transitioned(s,d){const f=new yh(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].transitioned(s,d._values[v]);return f}untransitioned(){const s=new yh(this._properties);for(const d of Object.keys(this._values))s._values[d]=this._values[d].untransitioned();return s}}class ry{constructor(s,d,f,v,y){const E=v.delay||0,M=v.duration||0;y=y||0,this.property=s,this.value=d,this.begin=y+E,this.end=this.begin+M,s.specification.transition&&(v.delay||v.duration)&&(this.prior=f)}possiblyEvaluate(s,d,f){const v=s.now||0,y=this.value.possiblyEvaluate(s,d,f),E=this.prior;if(E){if(v>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(v<this.begin)return E.possiblyEvaluate(s,d,f);{const M=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(s,d,f),y,St(M))}}return y}}class yh{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,d,f){const v=new Ff(this._properties);for(const y of Object.keys(this._values))v._values[y]=this._values[y].possiblyEvaluate(s,d,f);return v}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class rp{constructor(s,d,f){this._properties=s,this._values=Object.create(s.defaultPropertyValues),this._scope=d,this._options=f,this.isConfigDependent=!1}getValue(s){return io(this._values[s].value)}setValue(s,d){this._values[s]=new np(this._values[s].property,null===d?void 0:io(d),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[s].expression.isConfigDependent}serialize(){const s={};for(const d of Object.keys(this._values)){const f=this.getValue(d);void 0!==f&&(s[d]=f)}return s}possiblyEvaluate(s,d,f){const v=new Ff(this._properties);for(const y of Object.keys(this._values))v._values[y]=this._values[y].possiblyEvaluate(s,d,f);return v}}class Lf{constructor(s,d,f){this.property=s,this.value=d,this.parameters=f}isConstant(){return"constant"===this.value.kind}constantOr(s){return"constant"===this.value.kind?this.value.value:s}evaluate(s,d,f,v){return this.property.evaluate(this.value,this.parameters,s,d,f,v)}}class Ff{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class ni{constructor(s){this.specification=s}possiblyEvaluate(s,d){return s.expression.evaluate(d)}interpolate(s,d,f){const v=Ic[this.specification.type];return v?v(s,d,f):s}}class Ji{constructor(s,d){this.specification=s,this.overrides=d}possiblyEvaluate(s,d,f,v){return new Lf(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(d,null,{},f,v)}:s.expression,d)}interpolate(s,d,f){if("constant"!==s.value.kind||"constant"!==d.value.kind)return s;if(void 0===s.value.value||void 0===d.value.value)return new Lf(this,{kind:"constant",value:void 0},s.parameters);const v=Ic[this.specification.type];return v?new Lf(this,{kind:"constant",value:v(s.value.value,d.value.value,f)},s.parameters):s}evaluate(s,d,f,v,y,E){return"constant"===s.kind?s.value:s.evaluate(d,f,v,y,E)}}class op{constructor(s){this.specification=s}possiblyEvaluate(s,d,f,v){return!!s.expression.evaluate(d,null,{},f,v)}interpolate(){return!1}}class $o{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const d=new qr(0,{});for(const f in s){const v=s[f];v.specification.overridable&&this.overridableProperties.push(f);const y=this.defaultPropertyValues[f]=new np(v,void 0),E=this.defaultTransitionablePropertyValues[f]=new lv(v);this.defaultTransitioningPropertyValues[f]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=y.possiblyEvaluate(d)}}}function Mg(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Nf(a){if(Array.isArray(a))return a.map(Nf);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const s={};for(const d in a)s[d]=Nf(a[d]);return s}return Mg(a)}Oi(Ji,"DataDrivenProperty"),Oi(ni,"DataConstantProperty"),Oi(op,"ColorRampProperty");var ot=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function cv(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const s of a.slice(1))if(!cv(s)&&"boolean"!=typeof s)return!1;return!0;default:return!0}}function Fs(a,s="fill"){if(null==a)return{filter:()=>!0,needGeometry:!1,needFeature:!1};cv(a)||(a=ua(a));const d=a;let f=!0;try{f=function(R){if(!So(R))return R;let L=Nf(R);return Ag(L),L=Lx(L),L}(d)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(d,null,2)}\n        `)}const v=ot[`filter_${s}`],y=Ru(f,v);let E=null;if("error"===y.result)throw new Error(y.value.map(R=>`${R.key}: ${R.message}`).join(", "));E=(R,L,V)=>y.value.evaluate(R,L,{},V);let M=null,k=null;if(f!==d){const R=Ru(d,v);if("error"===R.result)throw new Error(R.value.map(L=>`${L.key}: ${L.message}`).join(", "));M=(L,V,j,q,Z)=>R.value.evaluate(L,V,{},j,void 0,void 0,q,Z),k=!ad(R.value.expression)}return{filter:E,dynamicFilter:M||void 0,needGeometry:Ur(f),needFeature:!!k}}function Lx(a){if(!Array.isArray(a))return a;const s=function(d){if(gs.has(d[0]))for(let f=1;f<d.length;f++)if(So(d[f]))return!0;return d}(a);return!0===s?s:s.map(d=>Lx(d))}function Ag(a){let s=!1;const d=[];if("case"===a[0]){for(let f=1;f<a.length-1;f+=2)s=s||So(a[f]),d.push(a[f+1]);d.push(a[a.length-1])}else if("match"===a[0]){s=s||So(a[1]);for(let f=2;f<a.length-1;f+=2)d.push(a[f+1]);d.push(a[a.length-1])}else if("step"===a[0]){s=s||So(a[1]);for(let f=1;f<a.length-1;f+=2)d.push(a[f+1])}s&&(a.length=0,a.push("any",...d));for(let f=1;f<a.length;f++)Ag(a[f])}function So(a){if(!Array.isArray(a))return!1;if("pitch"===(s=a[0])||"distance-from-center"===s)return!0;var s;for(let d=1;d<a.length;d++)if(So(a[d]))return!0;return!1}const gs=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function As(a,s){return a<s?-1:a>s?1:0}function Ur(a){if(!Array.isArray(a))return!1;if("within"===a[0]||"distance"===a[0])return!0;for(let s=1;s<a.length;s++)if(Ur(a[s]))return!0;return!1}function ua(a){if(!a)return!0;const s=a[0];return a.length<=1?"any"!==s:"=="===s?jc(a[1],a[2],"=="):"!="===s?ld(jc(a[1],a[2],"==")):"<"===s||">"===s||"<="===s||">="===s?jc(a[1],a[2],s):"any"===s?(d=a.slice(1),["any"].concat(d.map(ua))):"all"===s?["all"].concat(a.slice(1).map(ua)):"none"===s?["all"].concat(a.slice(1).map(ua).map(ld)):"in"===s?sp(a[1],a.slice(2)):"!in"===s?ld(sp(a[1],a.slice(2))):"has"===s?Lu(a[1]):"!has"!==s||ld(Lu(a[1]));var d}function jc(a,s,d){switch(a){case"$type":return[`filter-type-${d}`,s];case"$id":return[`filter-id-${d}`,s];default:return[`filter-${d}`,a,s]}}function sp(a,s){if(0===s.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(d=>typeof d!=typeof s[0])?["filter-in-large",a,["literal",s.sort(As)]]:["filter-in-small",a,["literal",s]]}}function Lu(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function ld(a){return["!",a]}function xa(a,s){return s?`${a}\x1f${s}`:a}const Bf="-transition";class Tl extends Ea{constructor(s,d,f,v){if(super(),this.id=s.id,this.fqid=xa(this.id,f),this.type=s.type,this.scope=f,this.options=v,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,"custom"!==s.type&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,"background"!==s.type&&"sky"!==s.type&&"slot"!==s.type&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),s.slot&&(this.slot=s.slot),d.layout&&(this._unevaluatedLayout=new rp(d.layout,this.scope,v),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),d.paint)){this._transitionablePaint=new gc(d.paint,this.scope,v);for(const y in s.paint)this.setPaintProperty(y,s.paint[y]);for(const y in s.layout)this.setLayoutProperty(y,s.layout[y]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ff(d.paint)}}getLayoutProperty(s){return"visibility"===s?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,d){if("custom"===this.type&&"visibility"===s)return void(this.visibility=d);const f=this._unevaluatedLayout;f._properties.properties[s]&&(f.setValue(s,d),this.isConfigDependent=this.isConfigDependent||f.isConfigDependent,"visibility"===s&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(s){return zr(s,Bf)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,d){const f=this._transitionablePaint,v=f._properties.properties;if(zr(s,Bf)){const V=s.slice(0,-11);return v[V]&&f.setTransition(V,d||void 0),!1}if(!v[s])return!1;const y=f._values[s],E=y.value.isDataDriven(),M=y.value;f.setValue(s,d),this.isConfigDependent=this.isConfigDependent||f.isConfigDependent,this._handleSpecialPaintPropertyUpdate(s);const k=f._values[s].value,R=k.isDataDriven(),L=zr(s,"pattern")||"line-dasharray"===s;return R||E||L||this._handleOverridablePaintPropertyUpdate(s,M,k)}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getDefaultProgramParams(s,d){return null}_handleOverridablePaintPropertyUpdate(s,d,f){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||"none"===this.visibility}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,d){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,d)}serialize(){return la({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(s,d)=>!(void 0===s||"layout"===d&&!Object.keys(s).length||"paint"===d&&!Object.keys(s).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const s in this.paint._values){const d=this.paint.get(s);if(d instanceof Lf&&kf(d.property.specification)&&("source"===d.value.kind||"composite"===d.value.kind)&&d.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Fs(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(s){this._stats&&("shadow"===s.renderPass?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}}const dv={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Vf{constructor(s,d){this._structArray=s,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class vo{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,d){return s._trim(),d&&(s.isTransferred=!0,d.add(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const d=Object.create(this.prototype);return d.arrayBuffer=s.arrayBuffer,d.length=s.length,d.capacity=s.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...s){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...s){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ir(a,s=1){let d=0,f=0;return{members:a.map(v=>{const y=dv[v.type].BYTES_PER_ELEMENT,E=d=Gc(d,Math.max(s,y)),M=v.components||1;return f=Math.max(f,y),d+=y*M,{name:v.name,type:v.type,components:M,offset:E}}),size:Gc(d,Math.max(f,s)),alignment:s}}function Gc(a,s){return Math.ceil(a/s)*s}class dn extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,d)}emplace(s,d,f){const v=2*s;return this.int16[v+0]=d,this.int16[v+1]=f,s}}dn.prototype.bytesPerElement=4,Oi(dn,"StructArrayLayout2i4");class il extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f){const v=this.length;return this.resize(v+1),this.emplace(v,s,d,f)}emplace(s,d,f,v){const y=3*s;return this.int16[y+0]=d,this.int16[y+1]=f,this.int16[y+2]=v,s}}il.prototype.bytesPerElement=6,Oi(il,"StructArrayLayout3i6");class Hc extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f,v){const y=this.length;return this.resize(y+1),this.emplace(y,s,d,f,v)}emplace(s,d,f,v,y){const E=4*s;return this.int16[E+0]=d,this.int16[E+1]=f,this.int16[E+2]=v,this.int16[E+3]=y,s}}Hc.prototype.bytesPerElement=8,Oi(Hc,"StructArrayLayout4i8");class _s extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y){const E=this.length;return this.resize(E+1),this.emplace(E,s,d,f,v,y)}emplace(s,d,f,v,y,E){const M=5*s;return this.int16[M+0]=d,this.int16[M+1]=f,this.int16[M+2]=v,this.int16[M+3]=y,this.int16[M+4]=E,s}}_s.prototype.bytesPerElement=10,Oi(_s,"StructArrayLayout5i10");class Dg extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E,M){const k=this.length;return this.resize(k+1),this.emplace(k,s,d,f,v,y,E,M)}emplace(s,d,f,v,y,E,M,k){const R=6*s,L=12*s,V=3*s;return this.int16[R+0]=d,this.int16[R+1]=f,this.uint8[L+4]=v,this.uint8[L+5]=y,this.uint8[L+6]=E,this.uint8[L+7]=M,this.float32[V+2]=k,s}}Dg.prototype.bytesPerElement=12,Oi(Dg,"StructArrayLayout2i4ub1f12");class Fu extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,v){const y=this.length;return this.resize(y+1),this.emplace(y,s,d,f,v)}emplace(s,d,f,v,y){const E=4*s;return this.float32[E+0]=d,this.float32[E+1]=f,this.float32[E+2]=v,this.float32[E+3]=y,s}}Fu.prototype.bytesPerElement=16,Oi(Fu,"StructArrayLayout4f16");class _c extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y){const E=this.length;return this.resize(E+1),this.emplace(E,s,d,f,v,y)}emplace(s,d,f,v,y,E){const M=6*s,k=3*s;return this.uint16[M+0]=d,this.uint16[M+1]=f,this.uint16[M+2]=v,this.uint16[M+3]=y,this.float32[k+2]=E,s}}_c.prototype.bytesPerElement=12,Oi(_c,"StructArrayLayout4ui1f12");class zf extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f,v){const y=this.length;return this.resize(y+1),this.emplace(y,s,d,f,v)}emplace(s,d,f,v,y){const E=4*s;return this.uint16[E+0]=d,this.uint16[E+1]=f,this.uint16[E+2]=v,this.uint16[E+3]=y,s}}zf.prototype.bytesPerElement=8,Oi(zf,"StructArrayLayout4ui8");class Uf extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E){const M=this.length;return this.resize(M+1),this.emplace(M,s,d,f,v,y,E)}emplace(s,d,f,v,y,E,M){const k=6*s;return this.int16[k+0]=d,this.int16[k+1]=f,this.int16[k+2]=v,this.int16[k+3]=y,this.int16[k+4]=E,this.int16[k+5]=M,s}}Uf.prototype.bytesPerElement=12,Oi(Uf,"StructArrayLayout6i12");class jf extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E,M,k,R,L,V,j){const q=this.length;return this.resize(q+1),this.emplace(q,s,d,f,v,y,E,M,k,R,L,V,j)}emplace(s,d,f,v,y,E,M,k,R,L,V,j,q){const Z=12*s;return this.int16[Z+0]=d,this.int16[Z+1]=f,this.int16[Z+2]=v,this.int16[Z+3]=y,this.uint16[Z+4]=E,this.uint16[Z+5]=M,this.uint16[Z+6]=k,this.uint16[Z+7]=R,this.int16[Z+8]=L,this.int16[Z+9]=V,this.int16[Z+10]=j,this.int16[Z+11]=q,s}}jf.prototype.bytesPerElement=24,Oi(jf,"StructArrayLayout4i4ui4i24");class kg extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E){const M=this.length;return this.resize(M+1),this.emplace(M,s,d,f,v,y,E)}emplace(s,d,f,v,y,E,M){const k=10*s,R=5*s;return this.int16[k+0]=d,this.int16[k+1]=f,this.int16[k+2]=v,this.float32[R+2]=y,this.float32[R+3]=E,this.float32[R+4]=M,s}}kg.prototype.bytesPerElement=20,Oi(kg,"StructArrayLayout3i3f20");class ap extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.uint32[1*s+0]=d,s}}ap.prototype.bytesPerElement=4,Oi(ap,"StructArrayLayout1ul4");class $c extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,d)}emplace(s,d,f){const v=2*s;return this.uint16[v+0]=d,this.uint16[v+1]=f,s}}$c.prototype.bytesPerElement=4,Oi($c,"StructArrayLayout2ui4");class xh extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E,M,k,R,L,V,j,q){const Z=this.length;return this.resize(Z+1),this.emplace(Z,s,d,f,v,y,E,M,k,R,L,V,j,q)}emplace(s,d,f,v,y,E,M,k,R,L,V,j,q,Z){const J=20*s,ne=10*s;return this.int16[J+0]=d,this.int16[J+1]=f,this.int16[J+2]=v,this.int16[J+3]=y,this.int16[J+4]=E,this.float32[ne+3]=M,this.float32[ne+4]=k,this.float32[ne+5]=R,this.float32[ne+6]=L,this.int16[J+14]=V,this.uint32[ne+8]=j,this.uint16[J+18]=q,this.uint16[J+19]=Z,s}}xh.prototype.bytesPerElement=40,Oi(xh,"StructArrayLayout5i4f1i1ul2ui40");class cd extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E,M){const k=this.length;return this.resize(k+1),this.emplace(k,s,d,f,v,y,E,M)}emplace(s,d,f,v,y,E,M,k){const R=8*s;return this.int16[R+0]=d,this.int16[R+1]=f,this.int16[R+2]=v,this.int16[R+4]=y,this.int16[R+5]=E,this.int16[R+6]=M,this.int16[R+7]=k,s}}cd.prototype.bytesPerElement=16,Oi(cd,"StructArrayLayout3i2i2i16");class Ko extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y){const E=this.length;return this.resize(E+1),this.emplace(E,s,d,f,v,y)}emplace(s,d,f,v,y,E){const M=4*s,k=8*s;return this.float32[M+0]=d,this.float32[M+1]=f,this.float32[M+2]=v,this.int16[k+6]=y,this.int16[k+7]=E,s}}Ko.prototype.bytesPerElement=16,Oi(Ko,"StructArrayLayout2f1f2i16");class Fi extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,v){const y=this.length;return this.resize(y+1),this.emplace(y,s,d,f,v)}emplace(s,d,f,v,y){const E=12*s,M=3*s;return this.uint8[E+0]=d,this.uint8[E+1]=f,this.float32[M+1]=v,this.float32[M+2]=y,s}}Fi.prototype.bytesPerElement=12,Oi(Fi,"StructArrayLayout2ub2f12");class ln extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f){const v=this.length;return this.resize(v+1),this.emplace(v,s,d,f)}emplace(s,d,f,v){const y=3*s;return this.uint16[y+0]=d,this.uint16[y+1]=f,this.uint16[y+2]=v,s}}ln.prototype.bytesPerElement=6,Oi(ln,"StructArrayLayout3ui6");class vs extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne,le,xe,Ee,Te,Le){const ke=this.length;return this.resize(ke+1),this.emplace(ke,s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne,le,xe,Ee,Te,Le)}emplace(s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne,le,xe,Ee,Te,Le,ke){const Be=30*s,We=15*s,tt=60*s;return this.int16[Be+0]=d,this.int16[Be+1]=f,this.int16[Be+2]=v,this.float32[We+2]=y,this.float32[We+3]=E,this.uint16[Be+8]=M,this.uint16[Be+9]=k,this.uint32[We+5]=R,this.uint32[We+6]=L,this.uint32[We+7]=V,this.uint16[Be+16]=j,this.uint16[Be+17]=q,this.uint16[Be+18]=Z,this.float32[We+10]=J,this.float32[We+11]=ne,this.uint8[tt+48]=le,this.uint8[tt+49]=xe,this.uint8[tt+50]=Ee,this.uint32[We+13]=Te,this.int16[Be+28]=Le,this.uint8[tt+58]=ke,s}}vs.prototype.bytesPerElement=60,Oi(vs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Sl extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne,le,xe,Ee,Te,Le,ke,Be,We,tt,ct,it,xt,Rt,_t,At,ft){const Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne,le,xe,Ee,Te,Le,ke,Be,We,tt,ct,it,xt,Rt,_t,At,ft)}emplace(s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne,le,xe,Ee,Te,Le,ke,Be,We,tt,ct,it,xt,Rt,_t,At,ft,Dt){const ii=20*s,Lt=40*s,Ui=80*s;return this.float32[ii+0]=d,this.float32[ii+1]=f,this.int16[Lt+4]=v,this.int16[Lt+5]=y,this.int16[Lt+6]=E,this.int16[Lt+7]=M,this.int16[Lt+8]=k,this.int16[Lt+9]=R,this.int16[Lt+10]=L,this.int16[Lt+11]=V,this.int16[Lt+12]=j,this.uint16[Lt+13]=q,this.uint16[Lt+14]=Z,this.uint16[Lt+15]=J,this.uint16[Lt+16]=ne,this.uint16[Lt+17]=le,this.uint16[Lt+18]=xe,this.uint16[Lt+19]=Ee,this.uint16[Lt+20]=Te,this.uint16[Lt+21]=Le,this.uint16[Lt+22]=ke,this.uint16[Lt+23]=Be,this.uint16[Lt+24]=We,this.uint16[Lt+25]=tt,this.uint16[Lt+26]=ct,this.uint16[Lt+27]=it,this.uint32[ii+14]=xt,this.float32[ii+15]=Rt,this.float32[ii+16]=_t,this.float32[ii+17]=At,this.float32[ii+18]=ft,this.uint8[Ui+76]=Dt,s}}Sl.prototype.bytesPerElement=80,Oi(Sl,"StructArrayLayout2f9i15ui1ul4f1ub80");class Ys extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.float32[1*s+0]=d,s}}Ys.prototype.bytesPerElement=4,Oi(Ys,"StructArrayLayout1f4");class Ns extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y){const E=this.length;return this.resize(E+1),this.emplace(E,s,d,f,v,y)}emplace(s,d,f,v,y,E){const M=5*s;return this.float32[M+0]=d,this.float32[M+1]=f,this.float32[M+2]=v,this.float32[M+3]=y,this.float32[M+4]=E,s}}Ns.prototype.bytesPerElement=20,Oi(Ns,"StructArrayLayout5f20");class eu extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E,M){const k=this.length;return this.resize(k+1),this.emplace(k,s,d,f,v,y,E,M)}emplace(s,d,f,v,y,E,M,k){const R=7*s;return this.float32[R+0]=d,this.float32[R+1]=f,this.float32[R+2]=v,this.float32[R+3]=y,this.float32[R+4]=E,this.float32[R+5]=M,this.float32[R+6]=k,s}}eu.prototype.bytesPerElement=28,Oi(eu,"StructArrayLayout7f28");class Ao extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,d,f,v){const y=this.length;return this.resize(y+1),this.emplace(y,s,d,f,v)}emplace(s,d,f,v,y){const E=6*s;return this.uint32[3*s+0]=d,this.uint16[E+2]=f,this.uint16[E+3]=v,this.uint16[E+4]=y,s}}Ao.prototype.bytesPerElement=12,Oi(Ao,"StructArrayLayout1ul3ui12");class xs extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.uint16[1*s+0]=d,s}}xs.prototype.bytesPerElement=2,Oi(xs,"StructArrayLayout1ui2");class Ha extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f){const v=this.length;return this.resize(v+1),this.emplace(v,s,d,f)}emplace(s,d,f,v){const y=3*s;return this.float32[y+0]=d,this.float32[y+1]=f,this.float32[y+2]=v,s}}Ha.prototype.bytesPerElement=12,Oi(Ha,"StructArrayLayout3f12");class _r extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d){const f=this.length;return this.resize(f+1),this.emplace(f,s,d)}emplace(s,d,f){const v=2*s;return this.float32[v+0]=d,this.float32[v+1]=f,s}}_r.prototype.bytesPerElement=8,Oi(_r,"StructArrayLayout2f8");class Nu extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne){const le=this.length;return this.resize(le+1),this.emplace(le,s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne)}emplace(s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne,le){const xe=16*s;return this.float32[xe+0]=d,this.float32[xe+1]=f,this.float32[xe+2]=v,this.float32[xe+3]=y,this.float32[xe+4]=E,this.float32[xe+5]=M,this.float32[xe+6]=k,this.float32[xe+7]=R,this.float32[xe+8]=L,this.float32[xe+9]=V,this.float32[xe+10]=j,this.float32[xe+11]=q,this.float32[xe+12]=Z,this.float32[xe+13]=J,this.float32[xe+14]=ne,this.float32[xe+15]=le,s}}Nu.prototype.bytesPerElement=64,Oi(Nu,"StructArrayLayout16f64");class Gf extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,d,f,v,y,E,M){const k=this.length;return this.resize(k+1),this.emplace(k,s,d,f,v,y,E,M)}emplace(s,d,f,v,y,E,M,k){const R=10*s,L=5*s;return this.uint16[R+0]=d,this.uint16[R+1]=f,this.uint16[R+2]=v,this.uint16[R+3]=y,this.float32[L+2]=E,this.float32[L+3]=M,this.float32[L+4]=k,s}}Gf.prototype.bytesPerElement=20,Oi(Gf,"StructArrayLayout4ui3f20");class dd extends vo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(s){const d=this.length;return this.resize(d+1),this.emplace(d,s)}emplace(s,d){return this.uint8[1*s+0]=d,s}}dd.prototype.bytesPerElement=1,Oi(dd,"StructArrayLayout1ub1");class us extends Vf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}us.prototype.size=40;class Bu extends xh{get(s){return new us(this,s)}}Oi(Bu,"CollisionBoxArray");class Vu extends Vf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}Vu.prototype.size=60;class ud extends vs{get(s){return new Vu(this,s)}}Oi(ud,"PlacedSymbolArray");class wh extends Vf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(s){this._structArray.uint32[this._pos4+14]=s}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(s){this._structArray.float32[this._pos4+18]=s}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}wh.prototype.size=80;class uv extends Sl{get(s){return new wh(this,s)}}Oi(uv,"SymbolInstanceArray");class tu extends Ys{getoffsetX(s){return this.float32[1*s+0]}}Oi(tu,"GlyphOffsetArray");class Ch extends dn{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}Oi(Ch,"SymbolLineVertexArray");class Ml extends Vf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ml.prototype.size=12;class sr extends Ao{get(s){return new Ml(this,s)}}Oi(sr,"FeatureIndexArray");class Eh extends $c{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}Oi(Eh,"FillExtrusionCentroidArray");const lp=Ir([{name:"a_pos",components:2,type:"Int16"}],4),Wc=Ir([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Wo{constructor(s=[]){this.segments=s}_prepareSegment(s,d,f,v){let y=this.segments[this.segments.length-1];return s>Wo.MAX_VERTEX_ARRAY_LENGTH&&Qe(`Max vertices per segment is ${Wo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!y||y.vertexLength+s>Wo.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==v)&&(y={vertexOffset:d,primitiveOffset:f,vertexLength:0,primitiveLength:0},void 0!==v&&(y.sortKey=v),this.segments.push(y)),y}prepareSegment(s,d,f,v){return this._prepareSegment(s,d.length,f.length,v)}get(){return this.segments}destroy(){for(const s of this.segments)for(const d in s.vaos)s.vaos[d].destroy()}static simpleSegment(s,d,f,v){return new Wo([{vertexOffset:s,primitiveOffset:d,vertexLength:f,primitiveLength:v,vaos:{},sortKey:0}])}}function Th(a,s){return 256*(a=Ii(Math.floor(a),0,255))+Ii(Math.floor(s),0,255)}Wo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Oi(Wo,"SegmentVector");const Bs=Ir([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Hf=Ir([{name:"a_dash",components:4,type:"Uint16"}]);var Ds={exports:{}},Ig={exports:function(s,d){var f,v,y,E,M,k,R,L;for(v=s.length-(f=3&s.length),y=d,M=3432918353,k=461845907,L=0;L<v;)R=255&s.charCodeAt(L)|(255&s.charCodeAt(++L))<<8|(255&s.charCodeAt(++L))<<16|(255&s.charCodeAt(++L))<<24,++L,y=27492+(65535&(E=5*(65535&(y=(y^=R=(65535&(R=(R=(65535&R)*M+(((R>>>16)*M&65535)<<16)&4294967295)<<15|R>>>17))*k+(((R>>>16)*k&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(R=0,f){case 3:R^=(255&s.charCodeAt(L+2))<<16;case 2:R^=(255&s.charCodeAt(L+1))<<8;case 1:y^=R=(65535&(R=(R=(65535&(R^=255&s.charCodeAt(L)))*M+(((R>>>16)*M&65535)<<16)&4294967295)<<15|R>>>17))*k+(((R>>>16)*k&65535)<<16)&4294967295}return y^=s.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}}.exports,Sh={exports:{}};Sh.exports=function(s,d){for(var f,v=s.length,y=d^v,E=0;v>=4;)f=1540483477*(65535&(f=255&s.charCodeAt(E)|(255&s.charCodeAt(++E))<<8|(255&s.charCodeAt(++E))<<16|(255&s.charCodeAt(++E))<<24))+((1540483477*(f>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),v-=4,++E;switch(v){case 3:y^=(255&s.charCodeAt(E+2))<<16;case 2:y^=(255&s.charCodeAt(E+1))<<8;case 1:y=1540483477*(65535&(y^=255&s.charCodeAt(E)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0};var cp=Ig,$l=Sh.exports;Ds.exports=cp,Ds.exports.murmur3=cp,Ds.exports.murmur2=$l;var Mh=un(Ds.exports);class dp{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(s,d,f,v){this.ids.push(hv(s)),this.positions.push(d,f,v)}eachPosition(s,d){const f=hv(s);let v=0,y=this.ids.length-1;for(;v<y;){const E=v+y>>1;this.ids[E]>=f?y=E:v=E+1}for(;this.ids[v]===f;)d(this.positions[3*v],this.positions[3*v+1],this.positions[3*v+2]),v++}static serialize(s,d){const f=new Float64Array(s.ids),v=new Uint32Array(s.positions);return Rg(f,v,0,f.length-1),d&&(d.add(f.buffer),d.add(v.buffer)),{ids:f,positions:v}}static deserialize(s){const d=new dp;let f;d.ids=s.ids,d.positions=s.positions;for(const v of d.ids)v!==f&&d.uniqueIds.push(v),f=v;return d.indexed=!0,d}}function hv(a){const s=+a;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:Mh(String(a))}function Rg(a,s,d,f){for(;d<f;){const v=a[d+f>>1];let y=d-1,E=f+1;for(;;){do{y++}while(a[y]<v);do{E--}while(a[E]>v);if(y>=E)break;Pg(a,y,E),Pg(s,3*y,3*E),Pg(s,3*y+1,3*E+1),Pg(s,3*y+2,3*E+2)}E-d<f-E?(Rg(a,s,d,E),d=E+1):(Rg(a,s,E+1,f),f=E)}}function Pg(a,s,d){const f=a[s];a[s]=a[d],a[d]=f}Oi(dp,"FeaturePositionMap");class zu{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,d){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,d),this.initialized=!0),!!this.location}}class $f extends zu{constructor(s){super(s),this.current=0}set(s,d,f){this.fetchUniformLocation(s,d)&&this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}}class Al extends zu{constructor(s){super(s),this.current=0}set(s,d,f){this.fetchUniformLocation(s,d)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class Wf extends zu{constructor(s){super(s),this.current=[0,0]}set(s,d,f){this.fetchUniformLocation(s,d)&&(f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1])))}}class gC extends zu{constructor(s){super(s),this.current=[0,0,0]}set(s,d,f){this.fetchUniformLocation(s,d)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2])))}}class x extends zu{constructor(s){super(s),this.current=[0,0,0,0]}set(s,d,f){this.fetchUniformLocation(s,d)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class u extends zu{constructor(s){super(s),this.current=Vo.transparent}set(s,d,f){this.fetchUniformLocation(s,d)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const g=new Float32Array(16);class w extends zu{constructor(s){super(s),this.current=g}set(s,d,f){if(this.fetchUniformLocation(s,d)){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let v=1;v<16;v++)if(f[v]!==this.current[v]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}}}const S=new Float32Array(9),D=new Float32Array(4);class P extends zu{constructor(s){super(s),this.current=D}set(s,d,f){if(this.fetchUniformLocation(s,d))for(let v=0;v<4;v++)if(f[v]!==this.current[v]){this.current=f,this.gl.uniformMatrix2fv(this.location,!1,f);break}}}function F(a){return[Th(255*a.r,255*a.g),Th(255*a.b,255*a.a)]}class U{constructor(s,d,f){this.value=s,this.uniformNames=d.map(v=>`u_${v}`),this.type=f}setUniform(s,d,f,v,y){d.set(s,y,v.constantOr(this.value))}getBinding(s,d){return"color"===this.type?new u(s):new Al(s)}}class H{constructor(s,d){this.uniformNames=d.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,d,f,v,y){const E="u_pattern"===y||"u_dash"===y?this.pattern:"u_pixel_ratio"===y?this.pixelRatio:null;E&&d.set(s,y,E)}getBinding(s,d){return"u_pattern"===d||"u_dash"===d?new x(s):new Al(s)}}class X{constructor(s,d,f,v){this.expression=s,this.type=f,this.maxValue=0,this.paintVertexAttributes=d.map(y=>({name:`a_${y}`,type:"Float32",components:"color"===f?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(s,d,f,v,y,E,M){const k=this.paintVertexArray.length,R=this.expression.evaluate(new qr(0,{brightness:E}),d,{},y,v,M);this.paintVertexArray.resize(s),this._setPaintValue(k,s,R)}updatePaintArray(s,d,f,v,y,E,M){const k=this.expression.evaluate({zoom:0,brightness:M},f,v,void 0,y);this._setPaintValue(s,d,k)}_setPaintValue(s,d,f){if("color"===this.type){const v=F(f);for(let y=s;y<d;y++)this.paintVertexArray.emplace(y,v[0],v[1])}else{for(let v=s;v<d;v++)this.paintVertexArray.emplace(v,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class K{constructor(s,d,f,v,y,E){this.expression=s,this.uniformNames=d.map(M=>`u_${M}_t`),this.type=f,this.useIntegerZoom=v,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=d.map(M=>({name:`a_${M}`,type:"Float32",components:"color"===f?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(s,d,f,v,y,E,M){const k=this.expression.evaluate(new qr(this.zoom,{brightness:E}),d,{},y,v,M),R=this.expression.evaluate(new qr(this.zoom+1,{brightness:E}),d,{},y,v,M),L=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(L,s,k,R)}updatePaintArray(s,d,f,v,y,E,M){const k=this.expression.evaluate({zoom:this.zoom,brightness:M},f,v,void 0,y),R=this.expression.evaluate({zoom:this.zoom+1,brightness:M},f,v,void 0,y);this._setPaintValue(s,d,k,R)}_setPaintValue(s,d,f,v){if("color"===this.type){const y=F(f),E=F(v);for(let M=s;M<d;M++)this.paintVertexArray.emplace(M,y[0],y[1],E[0],E[1])}else{for(let y=s;y<d;y++)this.paintVertexArray.emplace(y,f,v);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(v))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,d,f,v,y){const E=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,M=Ii(this.expression.interpolationFactor(E,this.zoom,this.zoom+1),0,1);d.set(s,y,M)}getBinding(s,d){return new Al(s)}}class ee{constructor(s,d,f,v,y){this.expression=s,this.layerId=y,this.paintVertexAttributes=("array"===f?Hf:Bs).members;for(let E=0;E<d.length;++E);this.paintVertexArray=new v}populatePaintArray(s,d,f){const v=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(v,s,d.patterns&&d.patterns[this.layerId],f)}updatePaintArray(s,d,f,v,y,E,M){this._setPaintValues(s,d,f.patterns&&f.patterns[this.layerId],E)}_setPaintValues(s,d,f,v){if(!v||!f)return;const y=v[f];if(!y)return;const{tl:E,br:M,pixelRatio:k}=y;for(let R=s;R<d;R++)this.paintVertexArray.emplace(R,E[0],E[1],M[0],M[1],k)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ie{constructor(s,d,f=()=>!0){this.binders={},this._buffers=[];const v=[];for(const y in s.paint._values){const E=s.paint.get(y);if(!f(y)||!(E instanceof Lf&&kf(E.property.specification)))continue;const M=me(y,s.type),k=E.value,R=E.property.specification.type,L=!!E.property.useIntegerZoom,V="line-dasharray"===y||y.endsWith("pattern"),j="line-dasharray"===y&&"constant"!==s.layout.get("line-cap").value.kind;if("constant"!==k.kind||j)if("source"===k.kind||j||V){const q=Me(y,R,"source");this.binders[y]=V?new ee(k,M,R,q,s.id):new X(k,M,R,q),v.push(`/a_${y}`)}else{const q=Me(y,R,"composite");this.binders[y]=new K(k,M,R,L,d,q),v.push(`/z_${y}`)}else this.binders[y]=V?new H(k.value,M):new U(k.value,M,R),v.push(`/u_${y}`)}this.cacheKey=v.sort().join("")}getMaxValue(s){const d=this.binders[s];return d instanceof X||d instanceof K?d.maxValue:0}populatePaintArrays(s,d,f,v,y,E,M){for(const k in this.binders){const R=this.binders[k];(R instanceof X||R instanceof K||R instanceof ee)&&R.populatePaintArray(s,d,f,v,y,E,M)}}setConstantPatternPositions(s){for(const d in this.binders){const f=this.binders[d];f instanceof H&&f.setConstantPatternPositions(s)}}updatePaintArrays(s,d,f,v,y,E,M,k){let R=!1;const L=Object.keys(s),V=0!==L.length,j=V?L:d.uniqueIds;for(const q in this.binders){const Z=this.binders[q];if((Z instanceof X||Z instanceof K||Z instanceof ee)&&(!0===Z.expression.isStateDependent||!1===Z.expression.isLightConstant)){const J=y.paint.get(q);Z.expression=J.value;for(const ne of j){const le=s[ne.toString()];d.eachPosition(ne,(xe,Ee,Te)=>{const Le=v.feature(xe);Z.updatePaintArray(Ee,Te,Le,le,E,M,k)})}if(!V)for(const ne of f.uniqueIds){const le=s[ne.toString()];f.eachPosition(ne,(xe,Ee,Te)=>{const Le=v.feature(xe);Z.updatePaintArray(Ee,Te,Le,le,E,M,k)})}R=!0}}return R}defines(){const s=[];for(const d in this.binders){const f=this.binders[d];(f instanceof U||f instanceof H)&&s.push(...f.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return s}getBinderAttributes(){const s=[];for(const d in this.binders){const f=this.binders[d];if(f instanceof X||f instanceof K||f instanceof ee)for(let v=0;v<f.paintVertexAttributes.length;v++)s.push(f.paintVertexAttributes[v].name)}return s}getBinderUniforms(){const s=[];for(const d in this.binders){const f=this.binders[d];if(f instanceof U||f instanceof H||f instanceof K)for(const v of f.uniformNames)s.push(v)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const d=[];for(const f in this.binders){const v=this.binders[f];if(v instanceof U||v instanceof H||v instanceof K)for(const y of v.uniformNames)d.push({name:y,property:f,binding:v.getBinding(s,y)})}return d}setUniforms(s,d,f,v,y){for(const{name:E,property:M,binding:k}of f)this.binders[M].setUniform(s,k,y,v.get(M),E)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const d=this.binders[s];(d instanceof X||d instanceof K||d instanceof ee)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(s){for(const d in this.binders){const f=this.binders[d];(f instanceof X||f instanceof K||f instanceof ee)&&f.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const d=this.binders[s];(d instanceof X||d instanceof K||d instanceof ee)&&d.destroy()}}}class ae{constructor(s,d,f=()=>!0){this.programConfigurations={};for(const v of s)this.programConfigurations[v.id]=new ie(v,d,f);this.needsUpload=!1,this._featureMap=new dp,this._featureMapWithoutIds=new dp,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(s,d,f,v,y,E,M,k){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(s,d,v,y,E,M,k);void 0!==d.id?this._featureMap.add(d.id,f,this._bufferOffset,s):(this._featureMapWithoutIds.add(this._idlessCounter,f,this._bufferOffset,s),this._idlessCounter+=1),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,d,f,v,y,E){for(const M of f)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(s,this._featureMap,this._featureMapWithoutIds,d,M,v,y,E||0)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const ce={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function me(a,s){return ce[a]||[a.replace(`${s}-`,"").replace(/-/g,"_")]}const se={"line-pattern":{source:_c,composite:_c},"fill-pattern":{source:_c,composite:_c},"fill-extrusion-pattern":{source:_c,composite:_c},"line-dasharray":{source:zf,composite:zf}},be={color:{source:_r,composite:Fu},number:{source:Ys,composite:_r}};function Me(a,s,d){const f=se[a];return f&&f[d]||be[s][d]}Oi(U,"ConstantBinder"),Oi(H,"PatternConstantBinder"),Oi(X,"SourceExpressionBinder"),Oi(ee,"PatternCompositeBinder"),Oi(K,"CompositeExpressionBinder"),Oi(ie,"ProgramConfiguration",{omit:["_buffers"]}),Oi(ae,"ProgramConfigurationSet");const we=Nt/Math.PI/2,Se=5,pe=6,De=16383,Ne=[64,32,16],je=-we,at=we;function Ke(a,s,d,f=we){return d=mi(d),[a*Math.sin(d)*f,-s*f,a*Math.cos(d)*f]}function rt(a,s,d){return Ke(Math.cos(mi(a)),Math.sin(mi(a)),s,d)}const pt=6371008.8,Pt=2*Math.PI*pt;class Ze{constructor(s,d){if(isNaN(s)||isNaN(d))throw new Error(`Invalid LngLat object: (${s}, ${d})`);if(this.lng=+s,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ze(Vr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const d=Math.PI/180,f=this.lat*d,v=s.lat*d,y=Math.sin(f)*Math.sin(v)+Math.cos(f)*Math.cos(v)*Math.cos((s.lng-this.lng)*d);return pt*Math.acos(Math.min(y,1))}toBounds(s=0){const d=360*s/40075017,f=d/Math.cos(Math.PI/180*this.lat);return new ht({lng:this.lng-f,lat:this.lat-d},{lng:this.lng+f,lat:this.lat+d})}toEcef(s){return rt(this.lat,this.lng,we+s*we/pt)}static convert(s){if(s instanceof Ze)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new Ze(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new Ze(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ht{constructor(s,d){s&&(d?this.setSouthWest(s).setNorthEast(d):4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof Ze?new Ze(s.lng,s.lat):Ze.convert(s),this}setSouthWest(s){return this._sw=s instanceof Ze?new Ze(s.lng,s.lat):Ze.convert(s),this}extend(s){const d=this._sw,f=this._ne;let v,y;if(s instanceof Ze)v=s,y=s;else{if(!(s instanceof ht))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(ht.convert(s)):this.extend(Ze.convert(s)):"object"==typeof s&&null!==s&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(Ze.convert(s)):this;if(v=s._sw,y=s._ne,!v||!y)return this}return d||f?(d.lng=Math.min(v.lng,d.lng),d.lat=Math.min(v.lat,d.lat),f.lng=Math.max(y.lng,f.lng),f.lat=Math.max(y.lat,f.lat)):(this._sw=new Ze(v.lng,v.lat),this._ne=new Ze(y.lng,y.lat)),this}getCenter(){return new Ze((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ze(this.getWest(),this.getNorth())}getSouthEast(){return new Ze(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:d,lat:f}=Ze.convert(s);let v=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&v}static convert(s){return!s||s instanceof ht?s:new ht(s)}}var ze={};!function(d){function f(y,E,M){var k=v(256*y,256*(E=Math.pow(2,M)-E-1),M),R=v(256*(y+1),256*(E+1),M);return k[0]+","+k[1]+","+R[0]+","+R[1]}function v(y,E,M){var k=2*Math.PI*6378137/256/Math.pow(2,M);return[y*k-2*Math.PI*6378137/2,E*k-2*Math.PI*6378137/2]}d.getURL=function(y,E,M,k,R,L){return L=L||{},y+"?"+["bbox="+f(M,k,R),"format="+(L.format||"image/png"),"service="+(L.service||"WMS"),"version="+(L.version||"1.1.1"),"request="+(L.request||"GetMap"),"srs="+(L.srs||"EPSG:3857"),"width="+(L.width||256),"height="+(L.height||256),"layers="+E].join("&")},d.getTileBBox=f,d.getMercCoords=v,Object.defineProperty(d,"__esModule",{value:!0})}(ze);var Ye=ze;class Mt{constructor(s,d,f){this.z=s,this.x=d,this.y=f,this.key=_i(0,s,s,d,f)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,d){const f=Ye.getTileBBox(this.x,this.y,this.z),v=function(y,E,M){let k,R="";for(let L=y;L>0;L--)k=1<<L-1,R+=(E&k?1:0)+(M&k?2:0);return R}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===d?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",v).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ti{constructor(s,d){this.wrap=s,this.canonical=d,this.key=_i(s,d.z,d.z,d.x,d.y)}}class Wt{constructor(s,d,f,v,y){this.overscaledZ=s,this.wrap=d,this.canonical=new Mt(f,+v,+y),this.key=0===d&&s===f?this.canonical.key:_i(d,s,f,v,y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const d=this.canonical.z-s;return s>this.canonical.z?new Wt(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Wt(s,this.wrap,s,this.canonical.x>>d,this.canonical.y>>d)}calculateScaledKey(s,d=!0){if(this.overscaledZ===s&&d)return this.key;if(s>this.canonical.z)return _i(this.wrap*+d,s,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-s;return _i(this.wrap*+d,s,s,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const d=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.z<this.canonical.z&&s.canonical.x===this.canonical.x>>d&&s.canonical.y===this.canonical.y>>d}children(s){if(this.overscaledZ>=s)return[new Wt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,f=2*this.canonical.x,v=2*this.canonical.y;return[new Wt(d,this.wrap,d,f,v),new Wt(d,this.wrap,d,f+1,v),new Wt(d,this.wrap,d,f,v+1),new Wt(d,this.wrap,d,f+1,v+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Wt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Wt(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ti(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function _i(a,s,d,f,v){const y=1<<Math.min(d,22);let E=y*(v%y)+f%y;return a&&d<22&&(E+=y*y*((a<0?-2*a-1:2*a)%(1<<2*(22-d)))),16*(32*E+d)+(s-d)}const vi=[a=>{let s=a.canonical.x-1,d=a.wrap;return s<0&&(s=(1<<a.canonical.z)-1,d--),new Wt(a.overscaledZ,d,a.canonical.z,s,a.canonical.y)},a=>{let s=a.canonical.x+1,d=a.wrap;return s===1<<a.canonical.z&&(s=0,d++),new Wt(a.overscaledZ,d,a.canonical.z,s,a.canonical.y)},a=>new Wt(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,(0===a.canonical.y?1<<a.canonical.z:a.canonical.y)-1),a=>new Wt(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y===(1<<a.canonical.z)-1?0:a.canonical.y+1)];Oi(Mt,"CanonicalTileID"),Oi(Wt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Yi=0,qi=25.5;function Xi(a){return Pt*Math.cos(a*Math.PI/180)}function Sn(a){return(180+a)/360}function bn(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function xn(a,s){return a/Xi(s)}function Dn(a){return 360*a-180}function fr(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function jr(a,s){return a*Xi(fr(s))}const Mi=85.051129;function Do(a){return Math.cos(mi(Ii(a,-Mi,Mi)))}function ar(a,s){const d=Ii(s,Yi,qi),f=Math.pow(2,d);return Do(a)*Pt/(512*f)}function Lr(a){return 1/Math.cos(a*Math.PI/180)}function vr(a,s=0){const d=Math.exp(Math.PI*(1-(a.y+s/Nt)/(1<<a.z)*2));return 80150034*d/(d*d+1)/Nt/(1<<a.z)}class Sr{constructor(s,d,f=0){this.x=+s,this.y=+d,this.z=+f}static fromLngLat(s,d=0){const f=Ze.convert(s);return new Sr(Sn(f.lng),bn(f.lat),xn(d,f.lat))}toLngLat(){return new Ze(Dn(this.x),fr(this.y))}toAltitude(){return jr(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Pt*Lr(fr(this.y))}}function ko(a,s,d,f,v,y,E,M,k){const R=(s+f)/2,L=(d+v)/2,V=new mt(R,L);M(V),function(j,q,Z,J,ne,le){const xe=Z-ne,Ee=J-le;return Math.abs((J-q)*xe-(Z-j)*Ee)/Math.hypot(xe,Ee)}(V.x,V.y,y.x,y.y,E.x,E.y)>=k?(ko(a,s,d,R,L,y,V,M,k),ko(a,R,L,f,v,V,E,M,k)):a.push(E)}function Yr(a,s,d){let f=a[0],v=f.x,y=f.y;s(f);const E=[f];for(let M=1;M<a.length;M++){const k=a[M],{x:R,y:L}=k;s(k),ko(E,v,y,R,L,f,k,s,d),v=R,y=L,f=k}return E}function Zs(a,s,d,f){if(f(s,d)){const v=s.add(d)._mult(.5);Zs(a,s,v,f),Zs(a,v,d,f)}else a.push(d)}function ws(a,s){let d=a[0];const f=[d];for(let v=1;v<a.length;v++){const y=a[v];Zs(f,d,y,s),d=y}return f}const Dl=Math.pow(2,14)-1,hd=-Dl-1;function kl(a,s){const d=Math.round(a.x*s),f=Math.round(a.y*s);return a.x=Ii(d,hd,Dl),a.y=Ii(f,hd,Dl),(d<a.x||d>a.x+1||f<a.y||f>a.y+1)&&Qe("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function Ks(a,s,d){const f=a.loadGeometry(),v=a.extent,y=Nt/v;if(s&&d&&d.projection.isReprojectedInTileSpace){const E=1<<s.z,{scale:M,x:k,y:R,projection:L}=d,V=j=>{const q=Dn((s.x+j.x/v)/E),Z=fr((s.y+j.y/v)/E),J=L.project(q,Z);j.x=(J.x*M-k)*v,j.y=(J.y*M-R)*v};for(let j=0;j<f.length;j++)if(1!==a.type)f[j]=Yr(f[j],V,1);else{const q=[];for(const Z of f[j])Z.x<0||Z.x>=v||Z.y<0||Z.y>=v||(V(Z),q.push(Z));f[j]=q}}for(const E of f)for(const M of E)kl(M,y);return f}function ks(a,s){return{type:a.type,id:a.id,properties:a.properties,geometry:s?Ks(a):[]}}function Ot(a,s,d,f,v){a.emplaceBack(2*s+(f+1)/2,2*d+(v+1)/2)}function Jn(a,s,d){a.emplaceBack(s.x,s.y,s.z,16384*d[0],16384*d[1],16384*d[2])}class nl{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new dn,this.indexArray=new ln,this.segments=new Wo,this.programConfigurations=new ae(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(s,d,f,v){const y=this.layers[0],E=[];let M=null;"circle"===y.type&&(M=y.layout.get("circle-sort-key"));for(const{feature:R,id:L,index:V,sourceLayerIndex:j}of s){const q=this.layers[0]._featureFilter.needGeometry,Z=ks(R,q);if(!this.layers[0]._featureFilter.filter(new qr(this.zoom),Z,f))continue;const J=M?M.evaluate(Z,{},f):void 0,ne={id:L,properties:R.properties,type:R.type,sourceLayerIndex:j,index:V,geometry:q?Z.geometry:Ks(R,f,v),patterns:{},sortKey:J};E.push(ne)}M&&E.sort((R,L)=>R.sortKey-L.sortKey);let k=null;"globe"===v.projection.name&&(this.globeExtVertexArray=new Uf,k=v.projection);for(const R of E){const{geometry:L,index:V,sourceLayerIndex:j}=R,q=s[V].feature;this.addFeature(R,L,V,d.availableImages,f,k,d.brightness),d.featureIndex.insert(q,L,V,j,this.index)}}update(s,d,f,v,y){const E=0!==Object.keys(s).length;E&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(s,d,E?this.stateDependentLayers:this.layers,f,v,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,lp.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,Wc.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,d,f,v,y,E,M){for(const k of d)for(const R of k){const L=R.x,V=R.y;if(L<0||L>=Nt||V<0||V>=Nt)continue;if(E){const Z=E.projectTilePoint(L,V,y),J=E.upVector(y,L,V),ne=this.globeExtVertexArray;Jn(ne,Z,J),Jn(ne,Z,J),Jn(ne,Z,J),Jn(ne,Z,J)}const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),q=j.vertexLength;Ot(this.layoutVertexArray,L,V,-1,-1),Ot(this.layoutVertexArray,L,V,1,-1),Ot(this.layoutVertexArray,L,V,1,1),Ot(this.layoutVertexArray,L,V,-1,1),this.indexArray.emplaceBack(q,q+1,q+2),this.indexArray.emplaceBack(q,q+2,q+3),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,{},v,y,M)}}function vc(a,s){for(let d=0;d<a.length;d++)if(ju(s,a[d]))return!0;for(let d=0;d<s.length;d++)if(ju(a,s[d]))return!0;return!!$a(a,s)}function lo(a,s,d){return!!ju(a,s)||!!Uu(s,a,d)}function Xc(a,s){if(1===a.length)return Yf(s,a[0]);for(let d=0;d<s.length;d++){const f=s[d];for(let v=0;v<f.length;v++)if(ju(a,f[v]))return!0}for(let d=0;d<a.length;d++)if(Yf(s,a[d]))return!0;for(let d=0;d<s.length;d++)if($a(a,s[d]))return!0;return!1}function Wl(a,s,d){if(a.length>1){if($a(a,s))return!0;for(let f=0;f<s.length;f++)if(Uu(s[f],a,d))return!0}for(let f=0;f<a.length;f++)if(Uu(a[f],s,d))return!0;return!1}function $a(a,s){if(0===a.length||0===s.length)return!1;for(let d=0;d<a.length-1;d++){const f=a[d],v=a[d+1];for(let y=0;y<s.length-1;y++)if(Xf(f,v,s[y],s[y+1]))return!0}return!1}function Xf(a,s,d,f){return nt(a,d,f)!==nt(s,d,f)&&nt(a,s,d)!==nt(a,s,f)}function Uu(a,s,d){const f=d*d;if(1===s.length)return a.distSqr(s[0])<f;for(let v=1;v<s.length;v++)if(qf(a,s[v-1],s[v])<f)return!0;return!1}function qf(a,s,d){const f=s.distSqr(d);if(0===f)return a.distSqr(s);const v=((a.x-s.x)*(d.x-s.x)+(a.y-s.y)*(d.y-s.y))/f;return a.distSqr(v<0?s:v>1?d:d.sub(s)._mult(v)._add(s))}function Yf(a,s){let d,f,v,y=!1;for(let E=0;E<a.length;E++){d=a[E];for(let M=0,k=d.length-1;M<d.length;k=M++)f=d[M],v=d[k],f.y>s.y!=v.y>s.y&&s.x<(v.x-f.x)*(s.y-f.y)/(v.y-f.y)+f.x&&(y=!y)}return y}function ju(a,s){let d=!1;for(let f=0,v=a.length-1;f<a.length;v=f++){const y=a[f],E=a[v];y.y>s.y!=E.y>s.y&&s.x<(E.x-y.x)*(s.y-y.y)/(E.y-y.y)+y.x&&(d=!d)}return d}function Fx(a,s,d,f,v){for(const E of a)if(s<=E.x&&d<=E.y&&f>=E.x&&v>=E.y)return!0;const y=[new mt(s,d),new mt(s,v),new mt(f,v),new mt(f,d)];if(a.length>2)for(const E of y)if(ju(a,E))return!0;for(let E=0;E<a.length-1;E++)if(_C(a[E],a[E+1],y))return!0;return!1}function _C(a,s,d){const f=d[0],v=d[2];if(a.x<f.x&&s.x<f.x||a.x>v.x&&s.x>v.x||a.y<f.y&&s.y<f.y||a.y>v.y&&s.y>v.y)return!1;const y=nt(a,s,d[0]);return y!==nt(a,s,d[1])||y!==nt(a,s,d[2])||y!==nt(a,s,d[3])}function Zf(a,s,d,f,v,y){let E=s.y-a.y,M=a.x-s.x;if(y=y||0){const k=E*E+M*M;if(0===k)return!0;const R=Math.sqrt(k);E/=R,M/=R}return!((d.x-a.x)*E+(d.y-a.y)*M-y<0||(f.x-a.x)*E+(f.y-a.y)*M-y<0||(v.x-a.x)*E+(v.y-a.y)*M-y<0)}function fa(a,s,d,f,v,y,E){return!(Zf(a,s,f,v,y,E)||Zf(s,d,f,v,y,E)||Zf(d,a,f,v,y,E)||Zf(f,v,a,s,d,E)||Zf(v,y,a,s,d,E)||Zf(y,f,a,s,d,E))}function bc(a,s,d){const f=s.paint.get(a).value;return"constant"===f.kind?f.value:d.programConfigurations.get(s.id).getMaxValue(a)}function up(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function fd(a,s,d,f,v){if(!s[0]&&!s[1])return a;const y=mt.convert(s)._mult(v);"viewport"===d&&y._rotate(-f);const E=[];for(let M=0;M<a.length;M++)E.push(a[M].sub(y));return E}function iu(a,s,d,f){const v=mt.convert(a)._mult(f);return"viewport"===s&&v._rotate(-d),v}Oi(nl,"CircleBucket",{omit:["layers"]});const vC=new $o({"circle-sort-key":new Ji(ot.layout_circle["circle-sort-key"]),visibility:new ni(ot.layout_circle.visibility)});var Og={paint:new $o({"circle-radius":new Ji(ot.paint_circle["circle-radius"]),"circle-color":new Ji(ot.paint_circle["circle-color"]),"circle-blur":new Ji(ot.paint_circle["circle-blur"]),"circle-opacity":new Ji(ot.paint_circle["circle-opacity"]),"circle-translate":new ni(ot.paint_circle["circle-translate"]),"circle-translate-anchor":new ni(ot.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ni(ot.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ni(ot.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ji(ot.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ji(ot.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ji(ot.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new ni(ot.paint_circle["circle-emissive-strength"])}),layout:vC},dr={},Qo={};Object.defineProperty(Qo,"__esModule",{value:!0}),Qo.setMatrixArrayType=function(a){Qo.ARRAY_TYPE=md=a},Qo.toRadian=function(a){return a*fp},Qo.equals=function(a,s){return Math.abs(a-s)<=hp*Math.max(1,Math.abs(a),Math.abs(s))},Qo.RANDOM=Qo.ARRAY_TYPE=Qo.EPSILON=void 0;var hp=1e-6;Qo.EPSILON=hp;var md=typeof Float32Array<"u"?Float32Array:Array;Qo.ARRAY_TYPE=md;var Xl=Math.random;Qo.RANDOM=Xl;var fp=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var a=0,s=arguments.length;s--;)a+=arguments[s]*arguments[s];return Math.sqrt(a)});var xo={};function Ah(a){return(Ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}Object.defineProperty(xo,"__esModule",{value:!0}),xo.create=function(){var a=new pd.ARRAY_TYPE(4);return pd.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},xo.clone=function(a){var s=new pd.ARRAY_TYPE(4);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s},xo.copy=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a},xo.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},xo.fromValues=function(a,s,d,f){var v=new pd.ARRAY_TYPE(4);return v[0]=a,v[1]=s,v[2]=d,v[3]=f,v},xo.set=function(a,s,d,f,v){return a[0]=s,a[1]=d,a[2]=f,a[3]=v,a},xo.transpose=function(a,s){if(a===s){var d=s[1];a[1]=s[2],a[2]=d}else a[0]=s[0],a[1]=s[2],a[2]=s[1],a[3]=s[3];return a},xo.invert=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=d*y-v*f;return E?(a[0]=y*(E=1/E),a[1]=-f*E,a[2]=-v*E,a[3]=d*E,a):null},xo.adjoint=function(a,s){var d=s[0];return a[0]=s[3],a[1]=-s[1],a[2]=-s[2],a[3]=d,a},xo.determinant=function(a){return a[0]*a[3]-a[2]*a[1]},xo.multiply=Nx,xo.rotate=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=Math.sin(d),k=Math.cos(d);return a[0]=f*k+y*M,a[1]=v*k+E*M,a[2]=f*-M+y*k,a[3]=v*-M+E*k,a},xo.scale=function(a,s,d){var f=s[1],v=s[2],y=s[3],E=d[0],M=d[1];return a[0]=s[0]*E,a[1]=f*E,a[2]=v*M,a[3]=y*M,a},xo.fromRotation=function(a,s){var d=Math.sin(s),f=Math.cos(s);return a[0]=f,a[1]=d,a[2]=-d,a[3]=f,a},xo.fromScaling=function(a,s){return a[0]=s[0],a[1]=0,a[2]=0,a[3]=s[1],a},xo.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},xo.frob=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},xo.LDU=function(a,s,d,f){return a[2]=f[2]/f[0],d[0]=f[0],d[1]=f[1],d[3]=f[3]-a[2]*d[1],[a,s,d]},xo.add=function(a,s,d){return a[0]=s[0]+d[0],a[1]=s[1]+d[1],a[2]=s[2]+d[2],a[3]=s[3]+d[3],a},xo.subtract=Bx,xo.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3]},xo.equals=function(a,s){var d=a[0],f=a[1],v=a[2],y=a[3],E=s[0],M=s[1],k=s[2],R=s[3];return Math.abs(d-E)<=pd.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(f-M)<=pd.EPSILON*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(v-k)<=pd.EPSILON*Math.max(1,Math.abs(v),Math.abs(k))&&Math.abs(y-R)<=pd.EPSILON*Math.max(1,Math.abs(y),Math.abs(R))},xo.multiplyScalar=function(a,s,d){return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a},xo.multiplyScalarAndAdd=function(a,s,d,f){return a[0]=s[0]+d[0]*f,a[1]=s[1]+d[1]*f,a[2]=s[2]+d[2]*f,a[3]=s[3]+d[3]*f,a},xo.sub=xo.mul=void 0;var pd=function(a){if(a&&a.__esModule)return a;if(null===a||"object"!==Ah(a)&&"function"!=typeof a)return{default:a};var d=oy(void 0);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}(Qo);function oy(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(oy=function(f){return f?d:s})(a)}function Nx(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=d[0],k=d[1],R=d[2],L=d[3];return a[0]=f*M+y*k,a[1]=v*M+E*k,a[2]=f*R+y*L,a[3]=v*R+E*L,a}function Bx(a,s,d){return a[0]=s[0]-d[0],a[1]=s[1]-d[1],a[2]=s[2]-d[2],a[3]=s[3]-d[3],a}xo.mul=Nx,xo.sub=Bx;var Jo={};function fv(a){return(fv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}Object.defineProperty(Jo,"__esModule",{value:!0}),Jo.create=function(){var a=new Gu.ARRAY_TYPE(6);return Gu.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[4]=0,a[5]=0),a[0]=1,a[3]=1,a},Jo.clone=function(a){var s=new Gu.ARRAY_TYPE(6);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s},Jo.copy=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[4]=s[4],a[5]=s[5],a},Jo.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},Jo.fromValues=function(a,s,d,f,v,y){var E=new Gu.ARRAY_TYPE(6);return E[0]=a,E[1]=s,E[2]=d,E[3]=f,E[4]=v,E[5]=y,E},Jo.set=function(a,s,d,f,v,y,E){return a[0]=s,a[1]=d,a[2]=f,a[3]=v,a[4]=y,a[5]=E,a},Jo.invert=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=s[4],M=s[5],k=d*y-f*v;return k?(a[0]=y*(k=1/k),a[1]=-f*k,a[2]=-v*k,a[3]=d*k,a[4]=(v*M-y*E)*k,a[5]=(f*E-d*M)*k,a):null},Jo.determinant=function(a){return a[0]*a[3]-a[1]*a[2]},Jo.multiply=Kf,Jo.rotate=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=s[4],k=s[5],R=Math.sin(d),L=Math.cos(d);return a[0]=f*L+y*R,a[1]=v*L+E*R,a[2]=f*-R+y*L,a[3]=v*-R+E*L,a[4]=M,a[5]=k,a},Jo.scale=function(a,s,d){var f=s[1],v=s[2],y=s[3],E=s[4],M=s[5],k=d[0],R=d[1];return a[0]=s[0]*k,a[1]=f*k,a[2]=v*R,a[3]=y*R,a[4]=E,a[5]=M,a},Jo.translate=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=s[4],k=s[5],R=d[0],L=d[1];return a[0]=f,a[1]=v,a[2]=y,a[3]=E,a[4]=f*R+y*L+M,a[5]=v*R+E*L+k,a},Jo.fromRotation=function(a,s){var d=Math.sin(s),f=Math.cos(s);return a[0]=f,a[1]=d,a[2]=-d,a[3]=f,a[4]=0,a[5]=0,a},Jo.fromScaling=function(a,s){return a[0]=s[0],a[1]=0,a[2]=0,a[3]=s[1],a[4]=0,a[5]=0,a},Jo.fromTranslation=function(a,s){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=s[0],a[5]=s[1],a},Jo.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"},Jo.frob=function(a){return Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],1)},Jo.add=function(a,s,d){return a[0]=s[0]+d[0],a[1]=s[1]+d[1],a[2]=s[2]+d[2],a[3]=s[3]+d[3],a[4]=s[4]+d[4],a[5]=s[5]+d[5],a},Jo.subtract=bs,Jo.multiplyScalar=function(a,s,d){return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a[4]=s[4]*d,a[5]=s[5]*d,a},Jo.multiplyScalarAndAdd=function(a,s,d,f){return a[0]=s[0]+d[0]*f,a[1]=s[1]+d[1]*f,a[2]=s[2]+d[2]*f,a[3]=s[3]+d[3]*f,a[4]=s[4]+d[4]*f,a[5]=s[5]+d[5]*f,a},Jo.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3]&&a[4]===s[4]&&a[5]===s[5]},Jo.equals=function(a,s){var d=a[0],f=a[1],v=a[2],y=a[3],E=a[4],M=a[5],k=s[0],R=s[1],L=s[2],V=s[3],j=s[4],q=s[5];return Math.abs(d-k)<=Gu.EPSILON*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(f-R)<=Gu.EPSILON*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(v-L)<=Gu.EPSILON*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(y-V)<=Gu.EPSILON*Math.max(1,Math.abs(y),Math.abs(V))&&Math.abs(E-j)<=Gu.EPSILON*Math.max(1,Math.abs(E),Math.abs(j))&&Math.abs(M-q)<=Gu.EPSILON*Math.max(1,Math.abs(M),Math.abs(q))},Jo.sub=Jo.mul=void 0;var Gu=function(a){if(a&&a.__esModule)return a;if(null===a||"object"!==fv(a)&&"function"!=typeof a)return{default:a};var d=rl(void 0);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}(Qo);function rl(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(rl=function(f){return f?d:s})(a)}function Kf(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=s[4],k=s[5],R=d[0],L=d[1],V=d[2],j=d[3],q=d[4],Z=d[5];return a[0]=f*R+y*L,a[1]=v*R+E*L,a[2]=f*V+y*j,a[3]=v*V+E*j,a[4]=f*q+y*Z+M,a[5]=v*q+E*Z+k,a}function bs(a,s,d){return a[0]=s[0]-d[0],a[1]=s[1]-d[1],a[2]=s[2]-d[2],a[3]=s[3]-d[3],a[4]=s[4]-d[4],a[5]=s[5]-d[5],a}Jo.mul=Kf,Jo.sub=bs;var mo={};function Vx(a){return(Vx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}Object.defineProperty(mo,"__esModule",{value:!0}),mo.create=function(){var a=new ql.ARRAY_TYPE(9);return ql.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a},mo.fromMat4=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[4],a[4]=s[5],a[5]=s[6],a[6]=s[8],a[7]=s[9],a[8]=s[10],a},mo.clone=function(a){var s=new ql.ARRAY_TYPE(9);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],s},mo.copy=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[4]=s[4],a[5]=s[5],a[6]=s[6],a[7]=s[7],a[8]=s[8],a},mo.fromValues=function(a,s,d,f,v,y,E,M,k){var R=new ql.ARRAY_TYPE(9);return R[0]=a,R[1]=s,R[2]=d,R[3]=f,R[4]=v,R[5]=y,R[6]=E,R[7]=M,R[8]=k,R},mo.set=function(a,s,d,f,v,y,E,M,k,R){return a[0]=s,a[1]=d,a[2]=f,a[3]=v,a[4]=y,a[5]=E,a[6]=M,a[7]=k,a[8]=R,a},mo.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},mo.transpose=function(a,s){if(a===s){var d=s[1],f=s[2],v=s[5];a[1]=s[3],a[2]=s[6],a[3]=d,a[5]=s[7],a[6]=f,a[7]=v}else a[0]=s[0],a[1]=s[3],a[2]=s[6],a[3]=s[1],a[4]=s[4],a[5]=s[7],a[6]=s[2],a[7]=s[5],a[8]=s[8];return a},mo.invert=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=s[4],M=s[5],k=s[6],R=s[7],L=s[8],V=L*E-M*R,j=-L*y+M*k,q=R*y-E*k,Z=d*V+f*j+v*q;return Z?(a[0]=V*(Z=1/Z),a[1]=(-L*f+v*R)*Z,a[2]=(M*f-v*E)*Z,a[3]=j*Z,a[4]=(L*d-v*k)*Z,a[5]=(-M*d+v*y)*Z,a[6]=q*Z,a[7]=(-R*d+f*k)*Z,a[8]=(E*d-f*y)*Z,a):null},mo.adjoint=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=s[4],M=s[5],k=s[6],R=s[7],L=s[8];return a[0]=E*L-M*R,a[1]=v*R-f*L,a[2]=f*M-v*E,a[3]=M*k-y*L,a[4]=d*L-v*k,a[5]=v*y-d*M,a[6]=y*R-E*k,a[7]=f*k-d*R,a[8]=d*E-f*y,a},mo.determinant=function(a){var s=a[3],d=a[4],f=a[5],v=a[6],y=a[7],E=a[8];return a[0]*(E*d-f*y)+a[1]*(-E*s+f*v)+a[2]*(y*s-d*v)},mo.multiply=Lg,mo.translate=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=s[4],k=s[5],R=s[6],L=s[7],V=s[8],j=d[0],q=d[1];return a[0]=f,a[1]=v,a[2]=y,a[3]=E,a[4]=M,a[5]=k,a[6]=j*f+q*E+R,a[7]=j*v+q*M+L,a[8]=j*y+q*k+V,a},mo.rotate=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=s[4],k=s[5],R=s[6],L=s[7],V=s[8],j=Math.sin(d),q=Math.cos(d);return a[0]=q*f+j*E,a[1]=q*v+j*M,a[2]=q*y+j*k,a[3]=q*E-j*f,a[4]=q*M-j*v,a[5]=q*k-j*y,a[6]=R,a[7]=L,a[8]=V,a},mo.scale=function(a,s,d){var f=d[0],v=d[1];return a[0]=f*s[0],a[1]=f*s[1],a[2]=f*s[2],a[3]=v*s[3],a[4]=v*s[4],a[5]=v*s[5],a[6]=s[6],a[7]=s[7],a[8]=s[8],a},mo.fromTranslation=function(a,s){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=s[0],a[7]=s[1],a[8]=1,a},mo.fromRotation=function(a,s){var d=Math.sin(s),f=Math.cos(s);return a[0]=f,a[1]=d,a[2]=0,a[3]=-d,a[4]=f,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},mo.fromScaling=function(a,s){return a[0]=s[0],a[1]=0,a[2]=0,a[3]=0,a[4]=s[1],a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},mo.fromMat2d=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=0,a[3]=s[2],a[4]=s[3],a[5]=0,a[6]=s[4],a[7]=s[5],a[8]=1,a},mo.fromQuat=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=d+d,M=f+f,k=v+v,R=d*E,L=f*E,V=f*M,j=v*E,q=v*M,Z=v*k,J=y*E,ne=y*M,le=y*k;return a[0]=1-V-Z,a[3]=L-le,a[6]=j+ne,a[1]=L+le,a[4]=1-R-Z,a[7]=q-J,a[2]=j-ne,a[5]=q+J,a[8]=1-R-V,a},mo.normalFromMat4=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=s[4],M=s[5],k=s[6],R=s[7],L=s[8],V=s[9],j=s[10],q=s[11],Z=s[12],J=s[13],ne=s[14],le=s[15],xe=d*M-f*E,Ee=d*k-v*E,Te=d*R-y*E,Le=f*k-v*M,ke=f*R-y*M,Be=v*R-y*k,We=L*J-V*Z,tt=L*ne-j*Z,ct=L*le-q*Z,it=V*ne-j*J,xt=V*le-q*J,Rt=j*le-q*ne,_t=xe*Rt-Ee*xt+Te*it+Le*ct-ke*tt+Be*We;return _t?(a[0]=(M*Rt-k*xt+R*it)*(_t=1/_t),a[1]=(k*ct-E*Rt-R*tt)*_t,a[2]=(E*xt-M*ct+R*We)*_t,a[3]=(v*xt-f*Rt-y*it)*_t,a[4]=(d*Rt-v*ct+y*tt)*_t,a[5]=(f*ct-d*xt-y*We)*_t,a[6]=(J*Be-ne*ke+le*Le)*_t,a[7]=(ne*Te-Z*Be-le*Ee)*_t,a[8]=(Z*ke-J*Te+le*xe)*_t,a):null},mo.projection=function(a,s,d){return a[0]=2/s,a[1]=0,a[2]=0,a[3]=0,a[4]=-2/d,a[5]=0,a[6]=-1,a[7]=1,a[8]=1,a},mo.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"},mo.frob=function(a){return Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8])},mo.add=function(a,s,d){return a[0]=s[0]+d[0],a[1]=s[1]+d[1],a[2]=s[2]+d[2],a[3]=s[3]+d[3],a[4]=s[4]+d[4],a[5]=s[5]+d[5],a[6]=s[6]+d[6],a[7]=s[7]+d[7],a[8]=s[8]+d[8],a},mo.subtract=bC,mo.multiplyScalar=function(a,s,d){return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a[4]=s[4]*d,a[5]=s[5]*d,a[6]=s[6]*d,a[7]=s[7]*d,a[8]=s[8]*d,a},mo.multiplyScalarAndAdd=function(a,s,d,f){return a[0]=s[0]+d[0]*f,a[1]=s[1]+d[1]*f,a[2]=s[2]+d[2]*f,a[3]=s[3]+d[3]*f,a[4]=s[4]+d[4]*f,a[5]=s[5]+d[5]*f,a[6]=s[6]+d[6]*f,a[7]=s[7]+d[7]*f,a[8]=s[8]+d[8]*f,a},mo.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3]&&a[4]===s[4]&&a[5]===s[5]&&a[6]===s[6]&&a[7]===s[7]&&a[8]===s[8]},mo.equals=function(a,s){var d=a[0],f=a[1],v=a[2],y=a[3],E=a[4],M=a[5],k=a[6],R=a[7],L=a[8],V=s[0],j=s[1],q=s[2],Z=s[3],J=s[4],ne=s[5],le=s[6],xe=s[7],Ee=s[8];return Math.abs(d-V)<=ql.EPSILON*Math.max(1,Math.abs(d),Math.abs(V))&&Math.abs(f-j)<=ql.EPSILON*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(v-q)<=ql.EPSILON*Math.max(1,Math.abs(v),Math.abs(q))&&Math.abs(y-Z)<=ql.EPSILON*Math.max(1,Math.abs(y),Math.abs(Z))&&Math.abs(E-J)<=ql.EPSILON*Math.max(1,Math.abs(E),Math.abs(J))&&Math.abs(M-ne)<=ql.EPSILON*Math.max(1,Math.abs(M),Math.abs(ne))&&Math.abs(k-le)<=ql.EPSILON*Math.max(1,Math.abs(k),Math.abs(le))&&Math.abs(R-xe)<=ql.EPSILON*Math.max(1,Math.abs(R),Math.abs(xe))&&Math.abs(L-Ee)<=ql.EPSILON*Math.max(1,Math.abs(L),Math.abs(Ee))},mo.sub=mo.mul=void 0;var ql=function(a){if(a&&a.__esModule)return a;if(null===a||"object"!==Vx(a)&&"function"!=typeof a)return{default:a};var d=sy(void 0);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}(Qo);function sy(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(sy=function(f){return f?d:s})(a)}function Lg(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=s[4],k=s[5],R=s[6],L=s[7],V=s[8],j=d[0],q=d[1],Z=d[2],J=d[3],ne=d[4],le=d[5],xe=d[6],Ee=d[7],Te=d[8];return a[0]=j*f+q*E+Z*R,a[1]=j*v+q*M+Z*L,a[2]=j*y+q*k+Z*V,a[3]=J*f+ne*E+le*R,a[4]=J*v+ne*M+le*L,a[5]=J*y+ne*k+le*V,a[6]=xe*f+Ee*E+Te*R,a[7]=xe*v+Ee*M+Te*L,a[8]=xe*y+Ee*k+Te*V,a}function bC(a,s,d){return a[0]=s[0]-d[0],a[1]=s[1]-d[1],a[2]=s[2]-d[2],a[3]=s[3]-d[3],a[4]=s[4]-d[4],a[5]=s[5]-d[5],a[6]=s[6]-d[6],a[7]=s[7]-d[7],a[8]=s[8]-d[8],a}mo.mul=Lg,mo.sub=bC;var zn={};function Il(a){return(Il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}Object.defineProperty(zn,"__esModule",{value:!0}),zn.create=function(){var a=new hs.ARRAY_TYPE(16);return hs.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},zn.clone=function(a){var s=new hs.ARRAY_TYPE(16);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],s[9]=a[9],s[10]=a[10],s[11]=a[11],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15],s},zn.copy=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[4]=s[4],a[5]=s[5],a[6]=s[6],a[7]=s[7],a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a},zn.fromValues=function(a,s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J){var ne=new hs.ARRAY_TYPE(16);return ne[0]=a,ne[1]=s,ne[2]=d,ne[3]=f,ne[4]=v,ne[5]=y,ne[6]=E,ne[7]=M,ne[8]=k,ne[9]=R,ne[10]=L,ne[11]=V,ne[12]=j,ne[13]=q,ne[14]=Z,ne[15]=J,ne},zn.set=function(a,s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne){return a[0]=s,a[1]=d,a[2]=f,a[3]=v,a[4]=y,a[5]=E,a[6]=M,a[7]=k,a[8]=R,a[9]=L,a[10]=V,a[11]=j,a[12]=q,a[13]=Z,a[14]=J,a[15]=ne,a},zn.identity=pp,zn.transpose=function(a,s){if(a===s){var d=s[1],f=s[2],v=s[3],y=s[6],E=s[7],M=s[11];a[1]=s[4],a[2]=s[8],a[3]=s[12],a[4]=d,a[6]=s[9],a[7]=s[13],a[8]=f,a[9]=y,a[11]=s[14],a[12]=v,a[13]=E,a[14]=M}else a[0]=s[0],a[1]=s[4],a[2]=s[8],a[3]=s[12],a[4]=s[1],a[5]=s[5],a[6]=s[9],a[7]=s[13],a[8]=s[2],a[9]=s[6],a[10]=s[10],a[11]=s[14],a[12]=s[3],a[13]=s[7],a[14]=s[11],a[15]=s[15];return a},zn.invert=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=s[4],M=s[5],k=s[6],R=s[7],L=s[8],V=s[9],j=s[10],q=s[11],Z=s[12],J=s[13],ne=s[14],le=s[15],xe=d*M-f*E,Ee=d*k-v*E,Te=d*R-y*E,Le=f*k-v*M,ke=f*R-y*M,Be=v*R-y*k,We=L*J-V*Z,tt=L*ne-j*Z,ct=L*le-q*Z,it=V*ne-j*J,xt=V*le-q*J,Rt=j*le-q*ne,_t=xe*Rt-Ee*xt+Te*it+Le*ct-ke*tt+Be*We;return _t?(a[0]=(M*Rt-k*xt+R*it)*(_t=1/_t),a[1]=(v*xt-f*Rt-y*it)*_t,a[2]=(J*Be-ne*ke+le*Le)*_t,a[3]=(j*ke-V*Be-q*Le)*_t,a[4]=(k*ct-E*Rt-R*tt)*_t,a[5]=(d*Rt-v*ct+y*tt)*_t,a[6]=(ne*Te-Z*Be-le*Ee)*_t,a[7]=(L*Be-j*Te+q*Ee)*_t,a[8]=(E*xt-M*ct+R*We)*_t,a[9]=(f*ct-d*xt-y*We)*_t,a[10]=(Z*ke-J*Te+le*xe)*_t,a[11]=(V*Te-L*ke-q*xe)*_t,a[12]=(M*tt-E*it-k*We)*_t,a[13]=(d*it-f*tt+v*We)*_t,a[14]=(J*Ee-Z*Le-ne*xe)*_t,a[15]=(L*Le-V*Ee+j*xe)*_t,a):null},zn.adjoint=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=s[4],M=s[5],k=s[6],R=s[7],L=s[8],V=s[9],j=s[10],q=s[11],Z=s[12],J=s[13],ne=s[14],le=s[15];return a[0]=M*(j*le-q*ne)-V*(k*le-R*ne)+J*(k*q-R*j),a[1]=-(f*(j*le-q*ne)-V*(v*le-y*ne)+J*(v*q-y*j)),a[2]=f*(k*le-R*ne)-M*(v*le-y*ne)+J*(v*R-y*k),a[3]=-(f*(k*q-R*j)-M*(v*q-y*j)+V*(v*R-y*k)),a[4]=-(E*(j*le-q*ne)-L*(k*le-R*ne)+Z*(k*q-R*j)),a[5]=d*(j*le-q*ne)-L*(v*le-y*ne)+Z*(v*q-y*j),a[6]=-(d*(k*le-R*ne)-E*(v*le-y*ne)+Z*(v*R-y*k)),a[7]=d*(k*q-R*j)-E*(v*q-y*j)+L*(v*R-y*k),a[8]=E*(V*le-q*J)-L*(M*le-R*J)+Z*(M*q-R*V),a[9]=-(d*(V*le-q*J)-L*(f*le-y*J)+Z*(f*q-y*V)),a[10]=d*(M*le-R*J)-E*(f*le-y*J)+Z*(f*R-y*M),a[11]=-(d*(M*q-R*V)-E*(f*q-y*V)+L*(f*R-y*M)),a[12]=-(E*(V*ne-j*J)-L*(M*ne-k*J)+Z*(M*j-k*V)),a[13]=d*(V*ne-j*J)-L*(f*ne-v*J)+Z*(f*j-v*V),a[14]=-(d*(M*ne-k*J)-E*(f*ne-v*J)+Z*(f*k-v*M)),a[15]=d*(M*j-k*V)-E*(f*j-v*V)+L*(f*k-v*M),a},zn.determinant=function(a){var s=a[0],d=a[1],f=a[2],v=a[3],y=a[4],E=a[5],M=a[6],k=a[7],R=a[8],L=a[9],V=a[10],j=a[11],q=a[12],Z=a[13],J=a[14],ne=a[15];return(s*E-d*y)*(V*ne-j*J)-(s*M-f*y)*(L*ne-j*Z)+(s*k-v*y)*(L*J-V*Z)+(d*M-f*E)*(R*ne-j*q)-(d*k-v*E)*(R*J-V*q)+(f*k-v*M)*(R*Z-L*q)},zn.multiply=Yl,zn.translate=function(a,s,d){var f,v,y,E,M,k,R,L,V,j,q,Z,J=d[0],ne=d[1],le=d[2];return s===a?(a[12]=s[0]*J+s[4]*ne+s[8]*le+s[12],a[13]=s[1]*J+s[5]*ne+s[9]*le+s[13],a[14]=s[2]*J+s[6]*ne+s[10]*le+s[14],a[15]=s[3]*J+s[7]*ne+s[11]*le+s[15]):(v=s[1],y=s[2],E=s[3],M=s[4],k=s[5],R=s[6],L=s[7],V=s[8],j=s[9],q=s[10],Z=s[11],a[0]=f=s[0],a[1]=v,a[2]=y,a[3]=E,a[4]=M,a[5]=k,a[6]=R,a[7]=L,a[8]=V,a[9]=j,a[10]=q,a[11]=Z,a[12]=f*J+M*ne+V*le+s[12],a[13]=v*J+k*ne+j*le+s[13],a[14]=y*J+R*ne+q*le+s[14],a[15]=E*J+L*ne+Z*le+s[15]),a},zn.scale=function(a,s,d){var f=d[0],v=d[1],y=d[2];return a[0]=s[0]*f,a[1]=s[1]*f,a[2]=s[2]*f,a[3]=s[3]*f,a[4]=s[4]*v,a[5]=s[5]*v,a[6]=s[6]*v,a[7]=s[7]*v,a[8]=s[8]*y,a[9]=s[9]*y,a[10]=s[10]*y,a[11]=s[11]*y,a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a},zn.rotate=function(a,s,d,f){var v,y,E,M,k,R,L,V,j,q,Z,J,ne,le,xe,Ee,Te,Le,ke,Be,We,tt,ct,it,xt=f[0],Rt=f[1],_t=f[2],At=Math.hypot(xt,Rt,_t);return At<hs.EPSILON?null:(xt*=At=1/At,Rt*=At,_t*=At,v=Math.sin(d),y=Math.cos(d),k=s[1],R=s[2],L=s[3],j=s[5],q=s[6],Z=s[7],ne=s[9],le=s[10],xe=s[11],Ee=xt*xt*(E=1-y)+y,ke=xt*Rt*E-_t*v,Be=Rt*Rt*E+y,We=_t*Rt*E+xt*v,tt=xt*_t*E+Rt*v,ct=Rt*_t*E-xt*v,it=_t*_t*E+y,a[0]=(M=s[0])*Ee+(V=s[4])*(Te=Rt*xt*E+_t*v)+(J=s[8])*(Le=_t*xt*E-Rt*v),a[1]=k*Ee+j*Te+ne*Le,a[2]=R*Ee+q*Te+le*Le,a[3]=L*Ee+Z*Te+xe*Le,a[4]=M*ke+V*Be+J*We,a[5]=k*ke+j*Be+ne*We,a[6]=R*ke+q*Be+le*We,a[7]=L*ke+Z*Be+xe*We,a[8]=M*tt+V*ct+J*it,a[9]=k*tt+j*ct+ne*it,a[10]=R*tt+q*ct+le*it,a[11]=L*tt+Z*ct+xe*it,s!==a&&(a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a)},zn.rotateX=function(a,s,d){var f=Math.sin(d),v=Math.cos(d),y=s[4],E=s[5],M=s[6],k=s[7],R=s[8],L=s[9],V=s[10],j=s[11];return s!==a&&(a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[4]=y*v+R*f,a[5]=E*v+L*f,a[6]=M*v+V*f,a[7]=k*v+j*f,a[8]=R*v-y*f,a[9]=L*v-E*f,a[10]=V*v-M*f,a[11]=j*v-k*f,a},zn.rotateY=function(a,s,d){var f=Math.sin(d),v=Math.cos(d),y=s[0],E=s[1],M=s[2],k=s[3],R=s[8],L=s[9],V=s[10],j=s[11];return s!==a&&(a[4]=s[4],a[5]=s[5],a[6]=s[6],a[7]=s[7],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[0]=y*v-R*f,a[1]=E*v-L*f,a[2]=M*v-V*f,a[3]=k*v-j*f,a[8]=y*f+R*v,a[9]=E*f+L*v,a[10]=M*f+V*v,a[11]=k*f+j*v,a},zn.rotateZ=function(a,s,d){var f=Math.sin(d),v=Math.cos(d),y=s[0],E=s[1],M=s[2],k=s[3],R=s[4],L=s[5],V=s[6],j=s[7];return s!==a&&(a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[0]=y*v+R*f,a[1]=E*v+L*f,a[2]=M*v+V*f,a[3]=k*v+j*f,a[4]=R*v-y*f,a[5]=L*v-E*f,a[6]=V*v-M*f,a[7]=j*v-k*f,a},zn.fromTranslation=function(a,s){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=s[0],a[13]=s[1],a[14]=s[2],a[15]=1,a},zn.fromScaling=function(a,s){return a[0]=s[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=s[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},zn.fromRotation=function(a,s,d){var f,v,y,E=d[0],M=d[1],k=d[2],R=Math.hypot(E,M,k);return R<hs.EPSILON?null:(E*=R=1/R,M*=R,k*=R,f=Math.sin(s),v=Math.cos(s),a[0]=E*E*(y=1-v)+v,a[1]=M*E*y+k*f,a[2]=k*E*y-M*f,a[3]=0,a[4]=E*M*y-k*f,a[5]=M*M*y+v,a[6]=k*M*y+E*f,a[7]=0,a[8]=E*k*y+M*f,a[9]=M*k*y-E*f,a[10]=k*k*y+v,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)},zn.fromXRotation=function(a,s){var d=Math.sin(s),f=Math.cos(s);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=d,a[7]=0,a[8]=0,a[9]=-d,a[10]=f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},zn.fromYRotation=function(a,s){var d=Math.sin(s),f=Math.cos(s);return a[0]=f,a[1]=0,a[2]=-d,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=d,a[9]=0,a[10]=f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},zn.fromZRotation=function(a,s){var d=Math.sin(s),f=Math.cos(s);return a[0]=f,a[1]=d,a[2]=0,a[3]=0,a[4]=-d,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},zn.fromRotationTranslation=Dh,zn.fromQuat2=function(a,s){var d=new hs.ARRAY_TYPE(3),f=-s[0],v=-s[1],y=-s[2],E=s[3],M=s[4],k=s[5],R=s[6],L=s[7],V=f*f+v*v+y*y+E*E;return V>0?(d[0]=2*(M*E+L*f+k*y-R*v)/V,d[1]=2*(k*E+L*v+R*f-M*y)/V,d[2]=2*(R*E+L*y+M*v-k*f)/V):(d[0]=2*(M*E+L*f+k*y-R*v),d[1]=2*(k*E+L*v+R*f-M*y),d[2]=2*(R*E+L*y+M*v-k*f)),Dh(a,s,d),a},zn.getTranslation=function(a,s){return a[0]=s[12],a[1]=s[13],a[2]=s[14],a},zn.getScaling=ay,zn.getRotation=function(a,s){var d=new hs.ARRAY_TYPE(3);ay(d,s);var f=1/d[0],v=1/d[1],y=1/d[2],E=s[0]*f,M=s[1]*v,k=s[2]*y,R=s[4]*f,L=s[5]*v,V=s[6]*y,j=s[8]*f,q=s[9]*v,Z=s[10]*y,J=E+L+Z,ne=0;return J>0?(ne=2*Math.sqrt(J+1),a[3]=.25*ne,a[0]=(V-q)/ne,a[1]=(j-k)/ne,a[2]=(M-R)/ne):E>L&&E>Z?(ne=2*Math.sqrt(1+E-L-Z),a[3]=(V-q)/ne,a[0]=.25*ne,a[1]=(M+R)/ne,a[2]=(j+k)/ne):L>Z?(ne=2*Math.sqrt(1+L-E-Z),a[3]=(j-k)/ne,a[0]=(M+R)/ne,a[1]=.25*ne,a[2]=(V+q)/ne):(ne=2*Math.sqrt(1+Z-E-L),a[3]=(M-R)/ne,a[0]=(j+k)/ne,a[1]=(V+q)/ne,a[2]=.25*ne),a},zn.fromRotationTranslationScale=function(a,s,d,f){var v=s[0],y=s[1],E=s[2],M=s[3],k=v+v,R=y+y,L=E+E,V=v*k,j=v*R,q=v*L,Z=y*R,J=y*L,ne=E*L,le=M*k,xe=M*R,Ee=M*L,Te=f[0],Le=f[1],ke=f[2];return a[0]=(1-(Z+ne))*Te,a[1]=(j+Ee)*Te,a[2]=(q-xe)*Te,a[3]=0,a[4]=(j-Ee)*Le,a[5]=(1-(V+ne))*Le,a[6]=(J+le)*Le,a[7]=0,a[8]=(q+xe)*ke,a[9]=(J-le)*ke,a[10]=(1-(V+Z))*ke,a[11]=0,a[12]=d[0],a[13]=d[1],a[14]=d[2],a[15]=1,a},zn.fromRotationTranslationScaleOrigin=function(a,s,d,f,v){var y=s[0],E=s[1],M=s[2],k=s[3],R=y+y,L=E+E,V=M+M,j=y*R,q=y*L,Z=y*V,J=E*L,ne=E*V,le=M*V,xe=k*R,Ee=k*L,Te=k*V,Le=f[0],ke=f[1],Be=f[2],We=v[0],tt=v[1],ct=v[2],it=(1-(J+le))*Le,xt=(q+Te)*Le,Rt=(Z-Ee)*Le,_t=(q-Te)*ke,At=(1-(j+le))*ke,ft=(ne+xe)*ke,Dt=(Z+Ee)*Be,ii=(ne-xe)*Be,Lt=(1-(j+J))*Be;return a[0]=it,a[1]=xt,a[2]=Rt,a[3]=0,a[4]=_t,a[5]=At,a[6]=ft,a[7]=0,a[8]=Dt,a[9]=ii,a[10]=Lt,a[11]=0,a[12]=d[0]+We-(it*We+_t*tt+Dt*ct),a[13]=d[1]+tt-(xt*We+At*tt+ii*ct),a[14]=d[2]+ct-(Rt*We+ft*tt+Lt*ct),a[15]=1,a},zn.fromQuat=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=d+d,M=f+f,k=v+v,R=d*E,L=f*E,V=f*M,j=v*E,q=v*M,Z=v*k,J=y*E,ne=y*M,le=y*k;return a[0]=1-V-Z,a[1]=L+le,a[2]=j-ne,a[3]=0,a[4]=L-le,a[5]=1-R-Z,a[6]=q+J,a[7]=0,a[8]=j+ne,a[9]=q-J,a[10]=1-R-V,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},zn.frustum=function(a,s,d,f,v,y,E){var M=1/(d-s),k=1/(v-f),R=1/(y-E);return a[0]=2*y*M,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*y*k,a[6]=0,a[7]=0,a[8]=(d+s)*M,a[9]=(v+f)*k,a[10]=(E+y)*R,a[11]=-1,a[12]=0,a[13]=0,a[14]=E*y*2*R,a[15]=0,a},zn.perspectiveNO=ly,zn.perspectiveZO=function(a,s,d,f,v){var y,E=1/Math.tan(s/2);return a[0]=E/d,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=E,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=v&&v!==1/0?(a[10]=v*(y=1/(f-v)),a[14]=v*f*y):(a[10]=-1,a[14]=-f),a},zn.perspectiveFromFieldOfView=function(a,s,d,f){var v=Math.tan(s.upDegrees*Math.PI/180),y=Math.tan(s.downDegrees*Math.PI/180),E=Math.tan(s.leftDegrees*Math.PI/180),M=Math.tan(s.rightDegrees*Math.PI/180),k=2/(E+M),R=2/(v+y);return a[0]=k,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=R,a[6]=0,a[7]=0,a[8]=-(E-M)*k*.5,a[9]=(v-y)*R*.5,a[10]=f/(d-f),a[11]=-1,a[12]=0,a[13]=0,a[14]=f*d/(d-f),a[15]=0,a},zn.orthoNO=yC,zn.orthoZO=function(a,s,d,f,v,y,E){var M=1/(s-d),k=1/(f-v),R=1/(y-E);return a[0]=-2*M,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*k,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=R,a[11]=0,a[12]=(s+d)*M,a[13]=(v+f)*k,a[14]=y*R,a[15]=1,a},zn.lookAt=function(a,s,d,f){var v,y,E,M,k,R,L,V,j,q,Z=s[0],J=s[1],ne=s[2],le=f[0],xe=f[1],Ee=f[2],Te=d[0],Le=d[1],ke=d[2];return Math.abs(Z-Te)<hs.EPSILON&&Math.abs(J-Le)<hs.EPSILON&&Math.abs(ne-ke)<hs.EPSILON?pp(a):(L=Z-Te,V=J-Le,j=ne-ke,v=xe*(j*=q=1/Math.hypot(L,V,j))-Ee*(V*=q),y=Ee*(L*=q)-le*j,E=le*V-xe*L,(q=Math.hypot(v,y,E))?(v*=q=1/q,y*=q,E*=q):(v=0,y=0,E=0),M=V*E-j*y,k=j*v-L*E,R=L*y-V*v,(q=Math.hypot(M,k,R))?(M*=q=1/q,k*=q,R*=q):(M=0,k=0,R=0),a[0]=v,a[1]=M,a[2]=L,a[3]=0,a[4]=y,a[5]=k,a[6]=V,a[7]=0,a[8]=E,a[9]=R,a[10]=j,a[11]=0,a[12]=-(v*Z+y*J+E*ne),a[13]=-(M*Z+k*J+R*ne),a[14]=-(L*Z+V*J+j*ne),a[15]=1,a)},zn.targetTo=function(a,s,d,f){var v=s[0],y=s[1],E=s[2],M=f[0],k=f[1],R=f[2],L=v-d[0],V=y-d[1],j=E-d[2],q=L*L+V*V+j*j;q>0&&(L*=q=1/Math.sqrt(q),V*=q,j*=q);var Z=k*j-R*V,J=R*L-M*j,ne=M*V-k*L;return(q=Z*Z+J*J+ne*ne)>0&&(Z*=q=1/Math.sqrt(q),J*=q,ne*=q),a[0]=Z,a[1]=J,a[2]=ne,a[3]=0,a[4]=V*ne-j*J,a[5]=j*Z-L*ne,a[6]=L*J-V*Z,a[7]=0,a[8]=L,a[9]=V,a[10]=j,a[11]=0,a[12]=v,a[13]=y,a[14]=E,a[15]=1,a},zn.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"},zn.frob=function(a){return Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])},zn.add=function(a,s,d){return a[0]=s[0]+d[0],a[1]=s[1]+d[1],a[2]=s[2]+d[2],a[3]=s[3]+d[3],a[4]=s[4]+d[4],a[5]=s[5]+d[5],a[6]=s[6]+d[6],a[7]=s[7]+d[7],a[8]=s[8]+d[8],a[9]=s[9]+d[9],a[10]=s[10]+d[10],a[11]=s[11]+d[11],a[12]=s[12]+d[12],a[13]=s[13]+d[13],a[14]=s[14]+d[14],a[15]=s[15]+d[15],a},zn.subtract=qc,zn.multiplyScalar=function(a,s,d){return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a[4]=s[4]*d,a[5]=s[5]*d,a[6]=s[6]*d,a[7]=s[7]*d,a[8]=s[8]*d,a[9]=s[9]*d,a[10]=s[10]*d,a[11]=s[11]*d,a[12]=s[12]*d,a[13]=s[13]*d,a[14]=s[14]*d,a[15]=s[15]*d,a},zn.multiplyScalarAndAdd=function(a,s,d,f){return a[0]=s[0]+d[0]*f,a[1]=s[1]+d[1]*f,a[2]=s[2]+d[2]*f,a[3]=s[3]+d[3]*f,a[4]=s[4]+d[4]*f,a[5]=s[5]+d[5]*f,a[6]=s[6]+d[6]*f,a[7]=s[7]+d[7]*f,a[8]=s[8]+d[8]*f,a[9]=s[9]+d[9]*f,a[10]=s[10]+d[10]*f,a[11]=s[11]+d[11]*f,a[12]=s[12]+d[12]*f,a[13]=s[13]+d[13]*f,a[14]=s[14]+d[14]*f,a[15]=s[15]+d[15]*f,a},zn.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3]&&a[4]===s[4]&&a[5]===s[5]&&a[6]===s[6]&&a[7]===s[7]&&a[8]===s[8]&&a[9]===s[9]&&a[10]===s[10]&&a[11]===s[11]&&a[12]===s[12]&&a[13]===s[13]&&a[14]===s[14]&&a[15]===s[15]},zn.equals=function(a,s){var d=a[0],f=a[1],v=a[2],y=a[3],E=a[4],M=a[5],k=a[6],R=a[7],L=a[8],V=a[9],j=a[10],q=a[11],Z=a[12],J=a[13],ne=a[14],le=a[15],xe=s[0],Ee=s[1],Te=s[2],Le=s[3],ke=s[4],Be=s[5],We=s[6],tt=s[7],ct=s[8],it=s[9],xt=s[10],Rt=s[11],_t=s[12],At=s[13],ft=s[14],Dt=s[15];return Math.abs(d-xe)<=hs.EPSILON*Math.max(1,Math.abs(d),Math.abs(xe))&&Math.abs(f-Ee)<=hs.EPSILON*Math.max(1,Math.abs(f),Math.abs(Ee))&&Math.abs(v-Te)<=hs.EPSILON*Math.max(1,Math.abs(v),Math.abs(Te))&&Math.abs(y-Le)<=hs.EPSILON*Math.max(1,Math.abs(y),Math.abs(Le))&&Math.abs(E-ke)<=hs.EPSILON*Math.max(1,Math.abs(E),Math.abs(ke))&&Math.abs(M-Be)<=hs.EPSILON*Math.max(1,Math.abs(M),Math.abs(Be))&&Math.abs(k-We)<=hs.EPSILON*Math.max(1,Math.abs(k),Math.abs(We))&&Math.abs(R-tt)<=hs.EPSILON*Math.max(1,Math.abs(R),Math.abs(tt))&&Math.abs(L-ct)<=hs.EPSILON*Math.max(1,Math.abs(L),Math.abs(ct))&&Math.abs(V-it)<=hs.EPSILON*Math.max(1,Math.abs(V),Math.abs(it))&&Math.abs(j-xt)<=hs.EPSILON*Math.max(1,Math.abs(j),Math.abs(xt))&&Math.abs(q-Rt)<=hs.EPSILON*Math.max(1,Math.abs(q),Math.abs(Rt))&&Math.abs(Z-_t)<=hs.EPSILON*Math.max(1,Math.abs(Z),Math.abs(_t))&&Math.abs(J-At)<=hs.EPSILON*Math.max(1,Math.abs(J),Math.abs(At))&&Math.abs(ne-ft)<=hs.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ft))&&Math.abs(le-Dt)<=hs.EPSILON*Math.max(1,Math.abs(le),Math.abs(Dt))},zn.sub=zn.mul=zn.ortho=zn.perspective=void 0;var hs=function(a){if(a&&a.__esModule)return a;if(null===a||"object"!==Il(a)&&"function"!=typeof a)return{default:a};var d=mp(void 0);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}(Qo);function mp(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(mp=function(f){return f?d:s})(a)}function pp(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Yl(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=s[4],k=s[5],R=s[6],L=s[7],V=s[8],j=s[9],q=s[10],Z=s[11],J=s[12],ne=s[13],le=s[14],xe=s[15],Ee=d[0],Te=d[1],Le=d[2],ke=d[3];return a[0]=Ee*f+Te*M+Le*V+ke*J,a[1]=Ee*v+Te*k+Le*j+ke*ne,a[2]=Ee*y+Te*R+Le*q+ke*le,a[3]=Ee*E+Te*L+Le*Z+ke*xe,a[4]=(Ee=d[4])*f+(Te=d[5])*M+(Le=d[6])*V+(ke=d[7])*J,a[5]=Ee*v+Te*k+Le*j+ke*ne,a[6]=Ee*y+Te*R+Le*q+ke*le,a[7]=Ee*E+Te*L+Le*Z+ke*xe,a[8]=(Ee=d[8])*f+(Te=d[9])*M+(Le=d[10])*V+(ke=d[11])*J,a[9]=Ee*v+Te*k+Le*j+ke*ne,a[10]=Ee*y+Te*R+Le*q+ke*le,a[11]=Ee*E+Te*L+Le*Z+ke*xe,a[12]=(Ee=d[12])*f+(Te=d[13])*M+(Le=d[14])*V+(ke=d[15])*J,a[13]=Ee*v+Te*k+Le*j+ke*ne,a[14]=Ee*y+Te*R+Le*q+ke*le,a[15]=Ee*E+Te*L+Le*Z+ke*xe,a}function Dh(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=f+f,k=v+v,R=y+y,L=f*M,V=f*k,j=f*R,q=v*k,Z=v*R,J=y*R,ne=E*M,le=E*k,xe=E*R;return a[0]=1-(q+J),a[1]=V+xe,a[2]=j-le,a[3]=0,a[4]=V-xe,a[5]=1-(L+J),a[6]=Z+ne,a[7]=0,a[8]=j+le,a[9]=Z-ne,a[10]=1-(L+q),a[11]=0,a[12]=d[0],a[13]=d[1],a[14]=d[2],a[15]=1,a}function ay(a,s){var d=s[4],f=s[5],v=s[6],y=s[8],E=s[9],M=s[10];return a[0]=Math.hypot(s[0],s[1],s[2]),a[1]=Math.hypot(d,f,v),a[2]=Math.hypot(y,E,M),a}function ly(a,s,d,f,v){var y,E=1/Math.tan(s/2);return a[0]=E/d,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=E,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=v&&v!==1/0?(a[10]=(v+f)*(y=1/(f-v)),a[14]=2*v*f*y):(a[10]=-1,a[14]=-2*f),a}function yC(a,s,d,f,v,y,E){var M=1/(s-d),k=1/(f-v),R=1/(y-E);return a[0]=-2*M,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*k,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*R,a[11]=0,a[12]=(s+d)*M,a[13]=(v+f)*k,a[14]=(E+y)*R,a[15]=1,a}function qc(a,s,d){return a[0]=s[0]-d[0],a[1]=s[1]-d[1],a[2]=s[2]-d[2],a[3]=s[3]-d[3],a[4]=s[4]-d[4],a[5]=s[5]-d[5],a[6]=s[6]-d[6],a[7]=s[7]-d[7],a[8]=s[8]-d[8],a[9]=s[9]-d[9],a[10]=s[10]-d[10],a[11]=s[11]-d[11],a[12]=s[12]-d[12],a[13]=s[13]-d[13],a[14]=s[14]-d[14],a[15]=s[15]-d[15],a}zn.perspective=ly,zn.ortho=yC,zn.mul=Yl,zn.sub=qc;var wn={},Un={};function Fg(a){return(Fg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}Object.defineProperty(Un,"__esModule",{value:!0}),Un.create=cy,Un.clone=function(a){var s=new nu.ARRAY_TYPE(3);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s},Un.length=Ux,Un.fromValues=function(a,s,d){var f=new nu.ARRAY_TYPE(3);return f[0]=a,f[1]=s,f[2]=d,f},Un.copy=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a},Un.set=function(a,s,d,f){return a[0]=s,a[1]=d,a[2]=f,a},Un.add=function(a,s,d){return a[0]=s[0]+d[0],a[1]=s[1]+d[1],a[2]=s[2]+d[2],a},Un.subtract=xC,Un.multiply=Ng,Un.divide=gp,Un.ceil=function(a,s){return a[0]=Math.ceil(s[0]),a[1]=Math.ceil(s[1]),a[2]=Math.ceil(s[2]),a},Un.floor=function(a,s){return a[0]=Math.floor(s[0]),a[1]=Math.floor(s[1]),a[2]=Math.floor(s[2]),a},Un.min=function(a,s,d){return a[0]=Math.min(s[0],d[0]),a[1]=Math.min(s[1],d[1]),a[2]=Math.min(s[2],d[2]),a},Un.max=function(a,s,d){return a[0]=Math.max(s[0],d[0]),a[1]=Math.max(s[1],d[1]),a[2]=Math.max(s[2],d[2]),a},Un.round=function(a,s){return a[0]=Math.round(s[0]),a[1]=Math.round(s[1]),a[2]=Math.round(s[2]),a},Un.scale=function(a,s,d){return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a},Un.scaleAndAdd=function(a,s,d,f){return a[0]=s[0]+d[0]*f,a[1]=s[1]+d[1]*f,a[2]=s[2]+d[2]*f,a},Un.distance=_p,Un.squaredDistance=vp,Un.squaredLength=wC,Un.negate=function(a,s){return a[0]=-s[0],a[1]=-s[1],a[2]=-s[2],a},Un.inverse=function(a,s){return a[0]=1/s[0],a[1]=1/s[1],a[2]=1/s[2],a},Un.normalize=function(a,s){var d=s[0],f=s[1],v=s[2],y=d*d+f*f+v*v;return y>0&&(y=1/Math.sqrt(y)),a[0]=s[0]*y,a[1]=s[1]*y,a[2]=s[2]*y,a},Un.dot=Hu,Un.cross=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=d[0],M=d[1],k=d[2];return a[0]=v*k-y*M,a[1]=y*E-f*k,a[2]=f*M-v*E,a},Un.lerp=function(a,s,d,f){var v=s[0],y=s[1],E=s[2];return a[0]=v+f*(d[0]-v),a[1]=y+f*(d[1]-y),a[2]=E+f*(d[2]-E),a},Un.hermite=function(a,s,d,f,v,y){var E=y*y,M=E*(2*y-3)+1,k=E*(y-2)+y,R=E*(y-1),L=E*(3-2*y);return a[0]=s[0]*M+d[0]*k+f[0]*R+v[0]*L,a[1]=s[1]*M+d[1]*k+f[1]*R+v[1]*L,a[2]=s[2]*M+d[2]*k+f[2]*R+v[2]*L,a},Un.bezier=function(a,s,d,f,v,y){var E=1-y,M=E*E,k=y*y,R=M*E,L=3*y*M,V=3*k*E,j=k*y;return a[0]=s[0]*R+d[0]*L+f[0]*V+v[0]*j,a[1]=s[1]*R+d[1]*L+f[1]*V+v[1]*j,a[2]=s[2]*R+d[2]*L+f[2]*V+v[2]*j,a},Un.random=function(a,s){s=s||1;var d=2*nu.RANDOM()*Math.PI,f=2*nu.RANDOM()-1,v=Math.sqrt(1-f*f)*s;return a[0]=Math.cos(d)*v,a[1]=Math.sin(d)*v,a[2]=f*s,a},Un.transformMat4=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=d[3]*f+d[7]*v+d[11]*y+d[15];return a[0]=(d[0]*f+d[4]*v+d[8]*y+d[12])/(E=E||1),a[1]=(d[1]*f+d[5]*v+d[9]*y+d[13])/E,a[2]=(d[2]*f+d[6]*v+d[10]*y+d[14])/E,a},Un.transformMat3=function(a,s,d){var f=s[0],v=s[1],y=s[2];return a[0]=f*d[0]+v*d[3]+y*d[6],a[1]=f*d[1]+v*d[4]+y*d[7],a[2]=f*d[2]+v*d[5]+y*d[8],a},Un.transformQuat=function(a,s,d){var f=d[0],v=d[1],y=d[2],E=s[0],M=s[1],k=s[2],R=v*k-y*M,L=y*E-f*k,V=f*M-v*E,j=v*V-y*L,q=y*R-f*V,Z=f*L-v*R,J=2*d[3];return L*=J,V*=J,q*=2,Z*=2,a[0]=E+(R*=J)+(j*=2),a[1]=M+L+q,a[2]=k+V+Z,a},Un.rotateX=function(a,s,d,f){var v=[],y=[];return v[0]=s[0]-d[0],v[1]=s[1]-d[1],v[2]=s[2]-d[2],y[0]=v[0],y[1]=v[1]*Math.cos(f)-v[2]*Math.sin(f),y[2]=v[1]*Math.sin(f)+v[2]*Math.cos(f),a[0]=y[0]+d[0],a[1]=y[1]+d[1],a[2]=y[2]+d[2],a},Un.rotateY=function(a,s,d,f){var v=[],y=[];return v[0]=s[0]-d[0],v[1]=s[1]-d[1],v[2]=s[2]-d[2],y[0]=v[2]*Math.sin(f)+v[0]*Math.cos(f),y[1]=v[1],y[2]=v[2]*Math.cos(f)-v[0]*Math.sin(f),a[0]=y[0]+d[0],a[1]=y[1]+d[1],a[2]=y[2]+d[2],a},Un.rotateZ=function(a,s,d,f){var v=[],y=[];return v[0]=s[0]-d[0],v[1]=s[1]-d[1],v[2]=s[2]-d[2],y[0]=v[0]*Math.cos(f)-v[1]*Math.sin(f),y[1]=v[0]*Math.sin(f)+v[1]*Math.cos(f),y[2]=v[2],a[0]=y[0]+d[0],a[1]=y[1]+d[1],a[2]=y[2]+d[2],a},Un.angle=function(a,s){var d=a[0],f=a[1],v=a[2],y=s[0],E=s[1],M=s[2],k=Math.sqrt(d*d+f*f+v*v)*Math.sqrt(y*y+E*E+M*M),R=k&&Hu(a,s)/k;return Math.acos(Math.min(Math.max(R,-1),1))},Un.zero=function(a){return a[0]=0,a[1]=0,a[2]=0,a},Un.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"},Un.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]},Un.equals=function(a,s){var d=a[0],f=a[1],v=a[2],y=s[0],E=s[1],M=s[2];return Math.abs(d-y)<=nu.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))&&Math.abs(f-E)<=nu.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(v-M)<=nu.EPSILON*Math.max(1,Math.abs(v),Math.abs(M))},Un.forEach=Un.sqrLen=Un.len=Un.sqrDist=Un.dist=Un.div=Un.mul=Un.sub=void 0;var nu=function(a){if(a&&a.__esModule)return a;if(null===a||"object"!==Fg(a)&&"function"!=typeof a)return{default:a};var d=zx(void 0);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}(Qo);function zx(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(zx=function(f){return f?d:s})(a)}function cy(){var a=new nu.ARRAY_TYPE(3);return nu.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Ux(a){return Math.hypot(a[0],a[1],a[2])}function xC(a,s,d){return a[0]=s[0]-d[0],a[1]=s[1]-d[1],a[2]=s[2]-d[2],a}function Ng(a,s,d){return a[0]=s[0]*d[0],a[1]=s[1]*d[1],a[2]=s[2]*d[2],a}function gp(a,s,d){return a[0]=s[0]/d[0],a[1]=s[1]/d[1],a[2]=s[2]/d[2],a}function _p(a,s){return Math.hypot(s[0]-a[0],s[1]-a[1],s[2]-a[2])}function vp(a,s){var d=s[0]-a[0],f=s[1]-a[1],v=s[2]-a[2];return d*d+f*f+v*v}function wC(a){var s=a[0],d=a[1],f=a[2];return s*s+d*d+f*f}function Hu(a,s){return a[0]*s[0]+a[1]*s[1]+a[2]*s[2]}Un.sub=xC,Un.mul=Ng,Un.div=gp,Un.dist=_p,Un.sqrDist=vp,Un.len=Ux,Un.sqrLen=wC;var $u,jx=($u=cy(),function(a,s,d,f,v,y){var E,M;for(s||(s=3),d||(d=0),M=f?Math.min(f*s+d,a.length):a.length,E=d;E<M;E+=s)$u[0]=a[E],$u[1]=a[E+1],$u[2]=a[E+2],v($u,$u,y),a[E]=$u[0],a[E+1]=$u[1],a[E+2]=$u[2];return a});Un.forEach=jx;var or={};function Gx(a){return(Gx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}Object.defineProperty(or,"__esModule",{value:!0}),or.create=CC,or.clone=function(a){var s=new Rl.ARRAY_TYPE(4);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s},or.fromValues=function(a,s,d,f){var v=new Rl.ARRAY_TYPE(4);return v[0]=a,v[1]=s,v[2]=d,v[3]=f,v},or.copy=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a},or.set=function(a,s,d,f,v){return a[0]=s,a[1]=d,a[2]=f,a[3]=v,a},or.add=function(a,s,d){return a[0]=s[0]+d[0],a[1]=s[1]+d[1],a[2]=s[2]+d[2],a[3]=s[3]+d[3],a},or.subtract=gd,or.multiply=Hx,or.divide=mv,or.ceil=function(a,s){return a[0]=Math.ceil(s[0]),a[1]=Math.ceil(s[1]),a[2]=Math.ceil(s[2]),a[3]=Math.ceil(s[3]),a},or.floor=function(a,s){return a[0]=Math.floor(s[0]),a[1]=Math.floor(s[1]),a[2]=Math.floor(s[2]),a[3]=Math.floor(s[3]),a},or.min=function(a,s,d){return a[0]=Math.min(s[0],d[0]),a[1]=Math.min(s[1],d[1]),a[2]=Math.min(s[2],d[2]),a[3]=Math.min(s[3],d[3]),a},or.max=function(a,s,d){return a[0]=Math.max(s[0],d[0]),a[1]=Math.max(s[1],d[1]),a[2]=Math.max(s[2],d[2]),a[3]=Math.max(s[3],d[3]),a},or.round=function(a,s){return a[0]=Math.round(s[0]),a[1]=Math.round(s[1]),a[2]=Math.round(s[2]),a[3]=Math.round(s[3]),a},or.scale=function(a,s,d){return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a},or.scaleAndAdd=function(a,s,d,f){return a[0]=s[0]+d[0]*f,a[1]=s[1]+d[1]*f,a[2]=s[2]+d[2]*f,a[3]=s[3]+d[3]*f,a},or.distance=$x,or.squaredDistance=EC,or.length=uy,or.squaredLength=Wx,or.negate=function(a,s){return a[0]=-s[0],a[1]=-s[1],a[2]=-s[2],a[3]=-s[3],a},or.inverse=function(a,s){return a[0]=1/s[0],a[1]=1/s[1],a[2]=1/s[2],a[3]=1/s[3],a},or.normalize=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=d*d+f*f+v*v+y*y;return E>0&&(E=1/Math.sqrt(E)),a[0]=d*E,a[1]=f*E,a[2]=v*E,a[3]=y*E,a},or.dot=function(a,s){return a[0]*s[0]+a[1]*s[1]+a[2]*s[2]+a[3]*s[3]},or.cross=function(a,s,d,f){var v=d[0]*f[1]-d[1]*f[0],y=d[0]*f[2]-d[2]*f[0],E=d[0]*f[3]-d[3]*f[0],M=d[1]*f[2]-d[2]*f[1],k=d[1]*f[3]-d[3]*f[1],R=d[2]*f[3]-d[3]*f[2],L=s[0],V=s[1],j=s[2],q=s[3];return a[0]=V*R-j*k+q*M,a[1]=-L*R+j*E-q*y,a[2]=L*k-V*E+q*v,a[3]=-L*M+V*y-j*v,a},or.lerp=function(a,s,d,f){var v=s[0],y=s[1],E=s[2],M=s[3];return a[0]=v+f*(d[0]-v),a[1]=y+f*(d[1]-y),a[2]=E+f*(d[2]-E),a[3]=M+f*(d[3]-M),a},or.random=function(a,s){var d,f,v,y,E,M;s=s||1;do{E=(d=2*Rl.RANDOM()-1)*d+(f=2*Rl.RANDOM()-1)*f}while(E>=1);do{M=(v=2*Rl.RANDOM()-1)*v+(y=2*Rl.RANDOM()-1)*y}while(M>=1);var k=Math.sqrt((1-E)/M);return a[0]=s*d,a[1]=s*f,a[2]=s*v*k,a[3]=s*y*k,a},or.transformMat4=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3];return a[0]=d[0]*f+d[4]*v+d[8]*y+d[12]*E,a[1]=d[1]*f+d[5]*v+d[9]*y+d[13]*E,a[2]=d[2]*f+d[6]*v+d[10]*y+d[14]*E,a[3]=d[3]*f+d[7]*v+d[11]*y+d[15]*E,a},or.transformQuat=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=d[0],M=d[1],k=d[2],R=d[3],L=R*f+M*y-k*v,V=R*v+k*f-E*y,j=R*y+E*v-M*f,q=-E*f-M*v-k*y;return a[0]=L*R+q*-E+V*-k-j*-M,a[1]=V*R+q*-M+j*-E-L*-k,a[2]=j*R+q*-k+L*-M-V*-E,a[3]=s[3],a},or.zero=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a},or.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},or.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3]},or.equals=function(a,s){var d=a[0],f=a[1],v=a[2],y=a[3],E=s[0],M=s[1],k=s[2],R=s[3];return Math.abs(d-E)<=Rl.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(f-M)<=Rl.EPSILON*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(v-k)<=Rl.EPSILON*Math.max(1,Math.abs(v),Math.abs(k))&&Math.abs(y-R)<=Rl.EPSILON*Math.max(1,Math.abs(y),Math.abs(R))},or.forEach=or.sqrLen=or.len=or.sqrDist=or.dist=or.div=or.mul=or.sub=void 0;var Rl=function(a){if(a&&a.__esModule)return a;if(null===a||"object"!==Gx(a)&&"function"!=typeof a)return{default:a};var d=dy(void 0);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}(Qo);function dy(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(dy=function(f){return f?d:s})(a)}function CC(){var a=new Rl.ARRAY_TYPE(4);return Rl.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0),a}function gd(a,s,d){return a[0]=s[0]-d[0],a[1]=s[1]-d[1],a[2]=s[2]-d[2],a[3]=s[3]-d[3],a}function Hx(a,s,d){return a[0]=s[0]*d[0],a[1]=s[1]*d[1],a[2]=s[2]*d[2],a[3]=s[3]*d[3],a}function mv(a,s,d){return a[0]=s[0]/d[0],a[1]=s[1]/d[1],a[2]=s[2]/d[2],a[3]=s[3]/d[3],a}function $x(a,s){return Math.hypot(s[0]-a[0],s[1]-a[1],s[2]-a[2],s[3]-a[3])}function EC(a,s){var d=s[0]-a[0],f=s[1]-a[1],v=s[2]-a[2],y=s[3]-a[3];return d*d+f*f+v*v+y*y}function uy(a){return Math.hypot(a[0],a[1],a[2],a[3])}function Wx(a){var s=a[0],d=a[1],f=a[2],v=a[3];return s*s+d*d+f*f+v*v}or.sub=gd,or.mul=Hx,or.div=mv,or.dist=$x,or.sqrDist=EC,or.len=uy,or.sqrLen=Wx;var jS=function(){var a=CC();return function(s,d,f,v,y,E){var M,k;for(d||(d=4),f||(f=0),k=v?Math.min(v*d+f,s.length):s.length,M=f;M<k;M+=d)a[0]=s[M],a[1]=s[M+1],a[2]=s[M+2],a[3]=s[M+3],y(a,a,E),s[M]=a[0],s[M+1]=a[1],s[M+2]=a[2],s[M+3]=a[3];return s}}();function Xx(a){return(Xx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}or.forEach=jS,Object.defineProperty(wn,"__esModule",{value:!0}),wn.create=SC,wn.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},wn.setAxisAngle=qx,wn.getAxisAngle=function(a,s){var d=2*Math.acos(s[3]),f=Math.sin(d/2);return f>Qf.EPSILON?(a[0]=s[0]/f,a[1]=s[1]/f,a[2]=s[2]/f):(a[0]=1,a[1]=0,a[2]=0),d},wn.getAngle=function(a,s){var d=tm(a,s);return Math.acos(2*d*d-1)},wn.multiply=Yx,wn.rotateX=function(a,s,d){d*=.5;var f=s[0],v=s[1],y=s[2],E=s[3],M=Math.sin(d),k=Math.cos(d);return a[0]=f*k+E*M,a[1]=v*k+y*M,a[2]=y*k-v*M,a[3]=E*k-f*M,a},wn.rotateY=function(a,s,d){d*=.5;var f=s[0],v=s[1],y=s[2],E=s[3],M=Math.sin(d),k=Math.cos(d);return a[0]=f*k-y*M,a[1]=v*k+E*M,a[2]=y*k+f*M,a[3]=E*k-v*M,a},wn.rotateZ=function(a,s,d){d*=.5;var f=s[0],v=s[1],y=s[2],E=s[3],M=Math.sin(d),k=Math.cos(d);return a[0]=f*k+v*M,a[1]=v*k-f*M,a[2]=y*k+E*M,a[3]=E*k-y*M,a},wn.calculateW=function(a,s){var d=s[0],f=s[1],v=s[2];return a[0]=d,a[1]=f,a[2]=v,a[3]=Math.sqrt(Math.abs(1-d*d-f*f-v*v)),a},wn.exp=Jf,wn.ln=Wu,wn.pow=function(a,s,d){return Wu(a,s),em(a,a,d),Jf(a,a),a},wn.slerp=ra,wn.random=function(a){var s=Qf.RANDOM(),d=Qf.RANDOM(),f=Qf.RANDOM(),v=Math.sqrt(1-s),y=Math.sqrt(s);return a[0]=v*Math.sin(2*Math.PI*d),a[1]=v*Math.cos(2*Math.PI*d),a[2]=y*Math.sin(2*Math.PI*f),a[3]=y*Math.cos(2*Math.PI*f),a},wn.invert=function(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=d*d+f*f+v*v+y*y,M=E?1/E:0;return a[0]=-d*M,a[1]=-f*M,a[2]=-v*M,a[3]=y*M,a},wn.conjugate=function(a,s){return a[0]=-s[0],a[1]=-s[1],a[2]=-s[2],a[3]=s[3],a},wn.fromMat3=MC,wn.fromEuler=function(a,s,d,f){var v=.5*Math.PI/180;s*=v,d*=v,f*=v;var y=Math.sin(s),E=Math.cos(s),M=Math.sin(d),k=Math.cos(d),R=Math.sin(f),L=Math.cos(f);return a[0]=y*k*L-E*M*R,a[1]=E*M*L+y*k*R,a[2]=E*k*R-y*M*L,a[3]=E*k*L+y*M*R,a},wn.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},wn.setAxes=wn.sqlerp=wn.rotationTo=wn.equals=wn.exactEquals=wn.normalize=wn.sqrLen=wn.squaredLength=wn.len=wn.length=wn.lerp=wn.dot=wn.scale=wn.mul=wn.add=wn.set=wn.copy=wn.fromValues=wn.clone=void 0;var Qf=yc(Qo),TC=yc(mo),_d=yc(Un),Qs=yc(or);function pv(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(pv=function(f){return f?d:s})(a)}function yc(a,s){if(!s&&a&&a.__esModule)return a;if(null===a||"object"!==Xx(a)&&"function"!=typeof a)return{default:a};var d=pv(s);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}function SC(){var a=new Qf.ARRAY_TYPE(4);return Qf.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function qx(a,s,d){d*=.5;var f=Math.sin(d);return a[0]=f*s[0],a[1]=f*s[1],a[2]=f*s[2],a[3]=Math.cos(d),a}function Yx(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=d[0],k=d[1],R=d[2],L=d[3];return a[0]=f*L+E*M+v*R-y*k,a[1]=v*L+E*k+y*M-f*R,a[2]=y*L+E*R+f*k-v*M,a[3]=E*L-f*M-v*k-y*R,a}function Jf(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=Math.sqrt(d*d+f*f+v*v),M=Math.exp(y),k=E>0?M*Math.sin(E)/E:0;return a[0]=d*k,a[1]=f*k,a[2]=v*k,a[3]=M*Math.cos(E),a}function Wu(a,s){var d=s[0],f=s[1],v=s[2],y=s[3],E=Math.sqrt(d*d+f*f+v*v),M=E>0?Math.atan2(E,y)/E:0;return a[0]=d*M,a[1]=f*M,a[2]=v*M,a[3]=.5*Math.log(d*d+f*f+v*v+y*y),a}function ra(a,s,d,f){var v,y,E,M,k,R=s[0],L=s[1],V=s[2],j=s[3],q=d[0],Z=d[1],J=d[2],ne=d[3];return(y=R*q+L*Z+V*J+j*ne)<0&&(y=-y,q=-q,Z=-Z,J=-J,ne=-ne),1-y>Qf.EPSILON?(v=Math.acos(y),E=Math.sin(v),M=Math.sin((1-f)*v)/E,k=Math.sin(f*v)/E):(M=1-f,k=f),a[0]=M*R+k*q,a[1]=M*L+k*Z,a[2]=M*V+k*J,a[3]=M*j+k*ne,a}function MC(a,s){var d,f=s[0]+s[4]+s[8];if(f>0)d=Math.sqrt(f+1),a[3]=.5*d,a[0]=(s[5]-s[7])*(d=.5/d),a[1]=(s[6]-s[2])*d,a[2]=(s[1]-s[3])*d;else{var v=0;s[4]>s[0]&&(v=1),s[8]>s[3*v+v]&&(v=2);var y=(v+1)%3,E=(v+2)%3;d=Math.sqrt(s[3*v+v]-s[3*y+y]-s[3*E+E]+1),a[v]=.5*d,a[3]=(s[3*y+E]-s[3*E+y])*(d=.5/d),a[y]=(s[3*y+v]+s[3*v+y])*d,a[E]=(s[3*E+v]+s[3*v+E])*d}return a}wn.clone=Qs.clone,wn.fromValues=Qs.fromValues,wn.copy=Qs.copy,wn.set=Qs.set,wn.add=Qs.add,wn.mul=Yx;var em=Qs.scale;wn.scale=em;var tm=Qs.dot;wn.dot=tm,wn.lerp=Qs.lerp;var AC=Qs.length;wn.length=AC,wn.len=AC;var Zx=Qs.squaredLength;wn.squaredLength=Zx,wn.sqrLen=Zx;var Xu=Qs.normalize;wn.normalize=Xu,wn.exactEquals=Qs.exactEquals,wn.equals=Qs.equals;var Zl,Kx,hy,fy=(Zl=_d.create(),Kx=_d.fromValues(1,0,0),hy=_d.fromValues(0,1,0),function(a,s,d){var f=_d.dot(s,d);return f<-.999999?(_d.cross(Zl,Kx,s),_d.len(Zl)<1e-6&&_d.cross(Zl,hy,s),_d.normalize(Zl,Zl),qx(a,Zl,Math.PI),a):f>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(_d.cross(Zl,s,d),a[0]=Zl[0],a[1]=Zl[1],a[2]=Zl[2],a[3]=1+f,Xu(a,a))});wn.rotationTo=fy;var my,Qx,GS=(my=SC(),Qx=SC(),function(a,s,d,f,v,y){return ra(my,s,v,y),ra(Qx,d,f,y),ra(a,my,Qx,2*y*(1-y)),a});wn.sqlerp=GS;var vd,gv=(vd=TC.create(),function(a,s,d,f){return vd[0]=d[0],vd[3]=d[1],vd[6]=d[2],vd[1]=f[0],vd[4]=f[1],vd[7]=f[2],vd[2]=-s[0],vd[5]=-s[1],vd[8]=-s[2],Xu(a,MC(a,vd))});wn.setAxes=gv;var mr={};function py(a){return(py="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}Object.defineProperty(mr,"__esModule",{value:!0}),mr.create=function(){var a=new Kl.ARRAY_TYPE(8);return Kl.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[4]=0,a[5]=0,a[6]=0,a[7]=0),a[3]=1,a},mr.clone=function(a){var s=new Kl.ARRAY_TYPE(8);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s},mr.fromValues=function(a,s,d,f,v,y,E,M){var k=new Kl.ARRAY_TYPE(8);return k[0]=a,k[1]=s,k[2]=d,k[3]=f,k[4]=v,k[5]=y,k[6]=E,k[7]=M,k},mr.fromRotationTranslationValues=function(a,s,d,f,v,y,E){var M=new Kl.ARRAY_TYPE(8);M[0]=a,M[1]=s,M[2]=d,M[3]=f;var k=.5*v,R=.5*y,L=.5*E;return M[4]=k*f+R*d-L*s,M[5]=R*f+L*a-k*d,M[6]=L*f+k*s-R*a,M[7]=-k*a-R*s-L*d,M},mr.fromRotationTranslation=Pa,mr.fromTranslation=function(a,s){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a[4]=.5*s[0],a[5]=.5*s[1],a[6]=.5*s[2],a[7]=0,a},mr.fromRotation=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[4]=0,a[5]=0,a[6]=0,a[7]=0,a},mr.fromMat4=function(a,s){var d=kh.create();HS.getRotation(d,s);var f=new Kl.ARRAY_TYPE(3);return HS.getTranslation(f,s),Pa(a,d,f),a},mr.copy=$S,mr.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a[6]=0,a[7]=0,a},mr.set=function(a,s,d,f,v,y,E,M,k){return a[0]=s,a[1]=d,a[2]=f,a[3]=v,a[4]=y,a[5]=E,a[6]=M,a[7]=k,a},mr.getDual=function(a,s){return a[0]=s[4],a[1]=s[5],a[2]=s[6],a[3]=s[7],a},mr.setDual=function(a,s){return a[4]=s[0],a[5]=s[1],a[6]=s[2],a[7]=s[3],a},mr.getTranslation=function(a,s){var d=s[4],f=s[5],v=s[6],y=s[7],E=-s[0],M=-s[1],k=-s[2],R=s[3];return a[0]=2*(d*R+y*E+f*k-v*M),a[1]=2*(f*R+y*M+v*E-d*k),a[2]=2*(v*R+y*k+d*M-f*E),a},mr.translate=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=.5*d[0],k=.5*d[1],R=.5*d[2],L=s[4],V=s[5],j=s[6],q=s[7];return a[0]=f,a[1]=v,a[2]=y,a[3]=E,a[4]=E*M+v*R-y*k+L,a[5]=E*k+y*M-f*R+V,a[6]=E*R+f*k-v*M+j,a[7]=-f*M-v*k-y*R+q,a},mr.rotateX=function(a,s,d){var f=-s[0],v=-s[1],y=-s[2],E=s[3],M=s[4],k=s[5],R=s[6],L=s[7],V=M*E+L*f+k*y-R*v,j=k*E+L*v+R*f-M*y,q=R*E+L*y+M*v-k*f,Z=L*E-M*f-k*v-R*y;return kh.rotateX(a,s,d),a[4]=V*(E=a[3])+Z*(f=a[0])+j*(y=a[2])-q*(v=a[1]),a[5]=j*E+Z*v+q*f-V*y,a[6]=q*E+Z*y+V*v-j*f,a[7]=Z*E-V*f-j*v-q*y,a},mr.rotateY=function(a,s,d){var f=-s[0],v=-s[1],y=-s[2],E=s[3],M=s[4],k=s[5],R=s[6],L=s[7],V=M*E+L*f+k*y-R*v,j=k*E+L*v+R*f-M*y,q=R*E+L*y+M*v-k*f,Z=L*E-M*f-k*v-R*y;return kh.rotateY(a,s,d),a[4]=V*(E=a[3])+Z*(f=a[0])+j*(y=a[2])-q*(v=a[1]),a[5]=j*E+Z*v+q*f-V*y,a[6]=q*E+Z*y+V*v-j*f,a[7]=Z*E-V*f-j*v-q*y,a},mr.rotateZ=function(a,s,d){var f=-s[0],v=-s[1],y=-s[2],E=s[3],M=s[4],k=s[5],R=s[6],L=s[7],V=M*E+L*f+k*y-R*v,j=k*E+L*v+R*f-M*y,q=R*E+L*y+M*v-k*f,Z=L*E-M*f-k*v-R*y;return kh.rotateZ(a,s,d),a[4]=V*(E=a[3])+Z*(f=a[0])+j*(y=a[2])-q*(v=a[1]),a[5]=j*E+Z*v+q*f-V*y,a[6]=q*E+Z*y+V*v-j*f,a[7]=Z*E-V*f-j*v-q*y,a},mr.rotateByQuatAppend=function(a,s,d){var f=d[0],v=d[1],y=d[2],E=d[3],M=s[0],k=s[1],R=s[2],L=s[3];return a[0]=M*E+L*f+k*y-R*v,a[1]=k*E+L*v+R*f-M*y,a[2]=R*E+L*y+M*v-k*f,a[3]=L*E-M*f-k*v-R*y,a[4]=(M=s[4])*E+(L=s[7])*f+(k=s[5])*y-(R=s[6])*v,a[5]=k*E+L*v+R*f-M*y,a[6]=R*E+L*y+M*v-k*f,a[7]=L*E-M*f-k*v-R*y,a},mr.rotateByQuatPrepend=function(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=d[0],k=d[1],R=d[2],L=d[3];return a[0]=f*L+E*M+v*R-y*k,a[1]=v*L+E*k+y*M-f*R,a[2]=y*L+E*R+f*k-v*M,a[3]=E*L-f*M-v*k-y*R,a[4]=f*(L=d[7])+E*(M=d[4])+v*(R=d[6])-y*(k=d[5]),a[5]=v*L+E*k+y*M-f*R,a[6]=y*L+E*R+f*k-v*M,a[7]=E*L-f*M-v*k-y*R,a},mr.rotateAroundAxis=function(a,s,d,f){if(Math.abs(f)<Kl.EPSILON)return $S(a,s);var v=Math.hypot(d[0],d[1],d[2]);f*=.5;var y=Math.sin(f),E=y*d[0]/v,M=y*d[1]/v,k=y*d[2]/v,R=Math.cos(f),L=s[0],V=s[1],j=s[2],q=s[3];a[0]=L*R+q*E+V*k-j*M,a[1]=V*R+q*M+j*E-L*k,a[2]=j*R+q*k+L*M-V*E,a[3]=q*R-L*E-V*M-j*k;var Z=s[4],J=s[5],ne=s[6],le=s[7];return a[4]=Z*R+le*E+J*k-ne*M,a[5]=J*R+le*M+ne*E-Z*k,a[6]=ne*R+le*k+Z*M-J*E,a[7]=le*R-Z*E-J*M-ne*k,a},mr.add=function(a,s,d){return a[0]=s[0]+d[0],a[1]=s[1]+d[1],a[2]=s[2]+d[2],a[3]=s[3]+d[3],a[4]=s[4]+d[4],a[5]=s[5]+d[5],a[6]=s[6]+d[6],a[7]=s[7]+d[7],a},mr.multiply=DC,mr.scale=function(a,s,d){return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a[4]=s[4]*d,a[5]=s[5]*d,a[6]=s[6]*d,a[7]=s[7]*d,a},mr.lerp=function(a,s,d,f){var v=1-f;return WS(s,d)<0&&(f=-f),a[0]=s[0]*v+d[0]*f,a[1]=s[1]*v+d[1]*f,a[2]=s[2]*v+d[2]*f,a[3]=s[3]*v+d[3]*f,a[4]=s[4]*v+d[4]*f,a[5]=s[5]*v+d[5]*f,a[6]=s[6]*v+d[6]*f,a[7]=s[7]*v+d[7]*f,a},mr.invert=function(a,s){var d=ew(s);return a[0]=-s[0]/d,a[1]=-s[1]/d,a[2]=-s[2]/d,a[3]=s[3]/d,a[4]=-s[4]/d,a[5]=-s[5]/d,a[6]=-s[6]/d,a[7]=s[7]/d,a},mr.conjugate=function(a,s){return a[0]=-s[0],a[1]=-s[1],a[2]=-s[2],a[3]=s[3],a[4]=-s[4],a[5]=-s[5],a[6]=-s[6],a[7]=s[7],a},mr.normalize=function(a,s){var d=ew(s);if(d>0){d=Math.sqrt(d);var f=s[0]/d,v=s[1]/d,y=s[2]/d,E=s[3]/d,M=s[4],k=s[5],R=s[6],L=s[7],V=f*M+v*k+y*R+E*L;a[0]=f,a[1]=v,a[2]=y,a[3]=E,a[4]=(M-f*V)/d,a[5]=(k-v*V)/d,a[6]=(R-y*V)/d,a[7]=(L-E*V)/d}return a},mr.str=function(a){return"quat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+")"},mr.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3]&&a[4]===s[4]&&a[5]===s[5]&&a[6]===s[6]&&a[7]===s[7]},mr.equals=function(a,s){var d=a[0],f=a[1],v=a[2],y=a[3],E=a[4],M=a[5],k=a[6],R=a[7],L=s[0],V=s[1],j=s[2],q=s[3],Z=s[4],J=s[5],ne=s[6],le=s[7];return Math.abs(d-L)<=Kl.EPSILON*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(f-V)<=Kl.EPSILON*Math.max(1,Math.abs(f),Math.abs(V))&&Math.abs(v-j)<=Kl.EPSILON*Math.max(1,Math.abs(v),Math.abs(j))&&Math.abs(y-q)<=Kl.EPSILON*Math.max(1,Math.abs(y),Math.abs(q))&&Math.abs(E-Z)<=Kl.EPSILON*Math.max(1,Math.abs(E),Math.abs(Z))&&Math.abs(M-J)<=Kl.EPSILON*Math.max(1,Math.abs(M),Math.abs(J))&&Math.abs(k-ne)<=Kl.EPSILON*Math.max(1,Math.abs(k),Math.abs(ne))&&Math.abs(R-le)<=Kl.EPSILON*Math.max(1,Math.abs(R),Math.abs(le))},mr.sqrLen=mr.squaredLength=mr.len=mr.length=mr.dot=mr.mul=mr.setReal=mr.getReal=void 0;var Kl=gy(Qo),kh=gy(wn),HS=gy(zn);function Jx(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(Jx=function(f){return f?d:s})(a)}function gy(a,s){if(!s&&a&&a.__esModule)return a;if(null===a||"object"!==py(a)&&"function"!=typeof a)return{default:a};var d=Jx(s);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}function Pa(a,s,d){var f=.5*d[0],v=.5*d[1],y=.5*d[2],E=s[0],M=s[1],k=s[2],R=s[3];return a[0]=E,a[1]=M,a[2]=k,a[3]=R,a[4]=f*R+v*k-y*M,a[5]=v*R+y*E-f*k,a[6]=y*R+f*M-v*E,a[7]=-f*E-v*M-y*k,a}function $S(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[4]=s[4],a[5]=s[5],a[6]=s[6],a[7]=s[7],a}function DC(a,s,d){var f=s[0],v=s[1],y=s[2],E=s[3],M=d[4],k=d[5],R=d[6],L=d[7],V=s[4],j=s[5],q=s[6],Z=s[7],J=d[0],ne=d[1],le=d[2],xe=d[3];return a[0]=f*xe+E*J+v*le-y*ne,a[1]=v*xe+E*ne+y*J-f*le,a[2]=y*xe+E*le+f*ne-v*J,a[3]=E*xe-f*J-v*ne-y*le,a[4]=f*L+E*M+v*R-y*k+V*xe+Z*J+j*le-q*ne,a[5]=v*L+E*k+y*M-f*R+j*xe+Z*ne+q*J-V*le,a[6]=y*L+E*R+f*k-v*M+q*xe+Z*le+V*ne-j*J,a[7]=E*L-f*M-v*k-y*R+Z*xe-V*J-j*ne-q*le,a}mr.getReal=kh.copy,mr.setReal=kh.copy,mr.mul=DC;var WS=kh.dot;mr.dot=WS;var _y=kh.length;mr.length=_y,mr.len=_y;var ew=kh.squaredLength;mr.squaredLength=ew,mr.sqrLen=ew;var Xn={};function Pl(a){return(Pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.create=kC,Xn.clone=function(a){var s=new Yc.ARRAY_TYPE(2);return s[0]=a[0],s[1]=a[1],s},Xn.fromValues=function(a,s){var d=new Yc.ARRAY_TYPE(2);return d[0]=a,d[1]=s,d},Xn.copy=function(a,s){return a[0]=s[0],a[1]=s[1],a},Xn.set=function(a,s,d){return a[0]=s,a[1]=d,a},Xn.add=function(a,s,d){return a[0]=s[0]+d[0],a[1]=s[1]+d[1],a},Xn.subtract=IC,Xn.multiply=tw,Xn.divide=iw,Xn.ceil=function(a,s){return a[0]=Math.ceil(s[0]),a[1]=Math.ceil(s[1]),a},Xn.floor=function(a,s){return a[0]=Math.floor(s[0]),a[1]=Math.floor(s[1]),a},Xn.min=function(a,s,d){return a[0]=Math.min(s[0],d[0]),a[1]=Math.min(s[1],d[1]),a},Xn.max=function(a,s,d){return a[0]=Math.max(s[0],d[0]),a[1]=Math.max(s[1],d[1]),a},Xn.round=function(a,s){return a[0]=Math.round(s[0]),a[1]=Math.round(s[1]),a},Xn.scale=function(a,s,d){return a[0]=s[0]*d,a[1]=s[1]*d,a},Xn.scaleAndAdd=function(a,s,d,f){return a[0]=s[0]+d[0]*f,a[1]=s[1]+d[1]*f,a},Xn.distance=XS,Xn.squaredDistance=nw,Xn.length=qS,Xn.squaredLength=RC,Xn.negate=function(a,s){return a[0]=-s[0],a[1]=-s[1],a},Xn.inverse=function(a,s){return a[0]=1/s[0],a[1]=1/s[1],a},Xn.normalize=function(a,s){var d=s[0],f=s[1],v=d*d+f*f;return v>0&&(v=1/Math.sqrt(v)),a[0]=s[0]*v,a[1]=s[1]*v,a},Xn.dot=function(a,s){return a[0]*s[0]+a[1]*s[1]},Xn.cross=function(a,s,d){var f=s[0]*d[1]-s[1]*d[0];return a[0]=a[1]=0,a[2]=f,a},Xn.lerp=function(a,s,d,f){var v=s[0],y=s[1];return a[0]=v+f*(d[0]-v),a[1]=y+f*(d[1]-y),a},Xn.random=function(a,s){s=s||1;var d=2*Yc.RANDOM()*Math.PI;return a[0]=Math.cos(d)*s,a[1]=Math.sin(d)*s,a},Xn.transformMat2=function(a,s,d){var f=s[0],v=s[1];return a[0]=d[0]*f+d[2]*v,a[1]=d[1]*f+d[3]*v,a},Xn.transformMat2d=function(a,s,d){var f=s[0],v=s[1];return a[0]=d[0]*f+d[2]*v+d[4],a[1]=d[1]*f+d[3]*v+d[5],a},Xn.transformMat3=function(a,s,d){var f=s[0],v=s[1];return a[0]=d[0]*f+d[3]*v+d[6],a[1]=d[1]*f+d[4]*v+d[7],a},Xn.transformMat4=function(a,s,d){var f=s[0],v=s[1];return a[0]=d[0]*f+d[4]*v+d[12],a[1]=d[1]*f+d[5]*v+d[13],a},Xn.rotate=function(a,s,d,f){var v=s[0]-d[0],y=s[1]-d[1],E=Math.sin(f),M=Math.cos(f);return a[0]=v*M-y*E+d[0],a[1]=v*E+y*M+d[1],a},Xn.angle=function(a,s){var d=a[0],f=a[1],v=s[0],y=s[1],E=Math.sqrt(d*d+f*f)*Math.sqrt(v*v+y*y);return Math.acos(Math.min(Math.max(E&&(d*v+f*y)/E,-1),1))},Xn.zero=function(a){return a[0]=0,a[1]=0,a},Xn.str=function(a){return"vec2("+a[0]+", "+a[1]+")"},Xn.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]},Xn.equals=function(a,s){var d=a[0],f=a[1],v=s[0],y=s[1];return Math.abs(d-v)<=Yc.EPSILON*Math.max(1,Math.abs(d),Math.abs(v))&&Math.abs(f-y)<=Yc.EPSILON*Math.max(1,Math.abs(f),Math.abs(y))},Xn.forEach=Xn.sqrLen=Xn.sqrDist=Xn.dist=Xn.div=Xn.mul=Xn.sub=Xn.len=void 0;var Yc=function(a){if(a&&a.__esModule)return a;if(null===a||"object"!==Pl(a)&&"function"!=typeof a)return{default:a};var d=bp(void 0);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}(Qo);function bp(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(bp=function(f){return f?d:s})(a)}function kC(){var a=new Yc.ARRAY_TYPE(2);return Yc.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0),a}function IC(a,s,d){return a[0]=s[0]-d[0],a[1]=s[1]-d[1],a}function tw(a,s,d){return a[0]=s[0]*d[0],a[1]=s[1]*d[1],a}function iw(a,s,d){return a[0]=s[0]/d[0],a[1]=s[1]/d[1],a}function XS(a,s){return Math.hypot(s[0]-a[0],s[1]-a[1])}function nw(a,s){var d=s[0]-a[0],f=s[1]-a[1];return d*d+f*f}function qS(a){return Math.hypot(a[0],a[1])}function RC(a){var s=a[0],d=a[1];return s*s+d*d}Xn.len=qS,Xn.sub=IC,Xn.mul=tw,Xn.div=iw,Xn.dist=XS,Xn.sqrDist=nw,Xn.sqrLen=RC;var YS=function(){var a=kC();return function(s,d,f,v,y,E){var M,k;for(d||(d=2),f||(f=0),k=v?Math.min(v*d+f,s.length):s.length,M=f;M<k;M+=d)a[0]=s[M],a[1]=s[M+1],y(a,a,E),s[M]=a[0],s[M+1]=a[1];return s}}();function im(a){return(im="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(s){return typeof s}:function(s){return s&&"function"==typeof Symbol&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}Xn.forEach=YS,Object.defineProperty(dr,"__esModule",{value:!0}),_.a7=dr.vec4=_.N=dr.vec3=dr.vec2=dr.quat2=_.bi=dr.quat=_.a6=dr.mat4=_.co=dr.mat3=dr.mat2d=_.b4=dr.mat2=dr.glMatrix=void 0;var _v=bd(Qo);dr.glMatrix=_v;var PC=bd(xo);_.b4=dr.mat2=PC;var qu=bd(Jo);dr.mat2d=qu;var Zk=bd(mo);_.co=dr.mat3=Zk;var ZS=bd(zn);_.a6=dr.mat4=ZS;var Yu=bd(wn);_.bi=dr.quat=Yu;var KS=bd(mr);dr.quat2=KS;var vy=bd(Xn);dr.vec2=vy;var vv=bd(Un);_.N=dr.vec3=vv;var QS=bd(or);function rw(a){if("function"!=typeof WeakMap)return null;var s=new WeakMap,d=new WeakMap;return(rw=function(f){return f?d:s})(a)}function bd(a,s){if(!s&&a&&a.__esModule)return a;if(null===a||"object"!==im(a)&&"function"!=typeof a)return{default:a};var d=rw(s);if(d&&d.has(a))return d.get(a);var f={},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in a)if("default"!==y&&Object.prototype.hasOwnProperty.call(a,y)){var E=v?Object.getOwnPropertyDescriptor(a,y):null;E&&(E.get||E.set)?Object.defineProperty(f,y,E):f[y]=a[y]}return f.default=a,d&&d.set(a,f),f}_.a7=dr.vec4=QS;class bv{constructor(s,d){this.pos=s,this.dir=d}intersectsPlane(s,d,f){const v=_.N.dot(d,this.dir);if(Math.abs(v)<1e-6)return!1;const y=((s[0]-this.pos[0])*d[0]+(s[1]-this.pos[1])*d[1]+(s[2]-this.pos[2])*d[2])/v;return f[0]=this.pos[0]+this.dir[0]*y,f[1]=this.pos[1]+this.dir[1]*y,f[2]=this.pos[2]+this.dir[2]*y,!0}closestPointOnSphere(s,d,f){if(_.N.equals(this.pos,s)||0===d)return f[0]=f[1]=f[2]=0,!1;const[v,y,E]=this.dir,M=this.pos[0]-s[0],k=this.pos[1]-s[1],R=this.pos[2]-s[2],L=v*v+y*y+E*E,V=2*(M*v+k*y+R*E),j=V*V-4*L*(M*M+k*k+R*R-d*d);if(j<0){const q=Math.max(-V/2,0),Z=M+v*q,J=k+y*q,ne=R+E*q,le=Math.hypot(Z,J,ne);return f[0]=Z*d/le,f[1]=J*d/le,f[2]=ne*d/le,!1}{const q=(-V-Math.sqrt(j))/(2*L);if(q<0){const Z=Math.hypot(M,k,R);return f[0]=M*d/Z,f[1]=k*d/Z,f[2]=R*d/Z,!1}return f[0]=M+v*q,f[1]=k+y*q,f[2]=R+E*q,!0}}}class yp{constructor(s,d,f,v,y){this.TL=s,this.TR=d,this.BR=f,this.BL=v,this.horizon=y}static fromInvProjectionMatrix(s,d,f){const v=[-1,1,1],y=[1,1,1],E=[1,-1,1],M=[-1,-1,1],k=_.N.transformMat4(v,v,s),R=_.N.transformMat4(y,y,s),L=_.N.transformMat4(E,E,s),V=_.N.transformMat4(M,M,s);return new yp(k,R,L,V,d/f)}}function nm(a,s,d){let f=1/0,v=-1/0;const y=[];for(const E of a){_.N.sub(y,E,s);const M=_.N.dot(y,d);f=Math.min(f,M),v=Math.max(v,M)}return[f,v]}function OC(a,s){let d=!0;for(let f=0;f<a.planes.length;f++){const v=a.planes[f];let y=0;for(let E=0;E<s.length;E++)y+=_.N.dot(v,s[E])+v[3]>=0;if(0===y)return 0;y!==s.length&&(d=!1)}return d?2:1}function LC(a,s){for(const d of a.projections){const f=nm(s,a.points[0],d.axis);if(d.projection[1]<f[0]||d.projection[0]>f[1])return 0}return 1}function ow(a,s){let d=0;const f=[0,0,0,0];for(let v=0;v<a.length;v++)f[0]=a[v][0],f[1]=a[v][1],f[2]=a[v][2],f[3]=1,_.a7.dot(f,s)>=0&&d++;return d}class by{constructor(s,d){this.points=s||new Array(8).fill([0,0,0]),this.planes=d||new Array(6).fill([0,0,0,0]),this.bounds=ss.fromPoints(this.points),this.projections=[],this.frustumEdges=[_.N.sub([],this.points[2],this.points[3]),_.N.sub([],this.points[0],this.points[3]),_.N.sub([],this.points[4],this.points[0]),_.N.sub([],this.points[5],this.points[1]),_.N.sub([],this.points[6],this.points[2]),_.N.sub([],this.points[7],this.points[3])];for(const f of this.frustumEdges){const v=[0,-f[2],f[1]],y=[f[2],0,-f[0]];this.projections.push({axis:v,projection:nm(this.points,this.points[0],v)}),this.projections.push({axis:y,projection:nm(this.points,this.points[0],y)})}}static fromInvProjectionMatrix(s,d,f,v){const y=Math.pow(2,f),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{const L=_.a7.transformMat4([],R,s),V=1/L[3]/d*y;return _.a7.mul(L,L,[V,V,v?1/L[3]:V,V])}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(R=>{const L=_.N.sub([],E[R[0]],E[R[1]]),V=_.N.sub([],E[R[2]],E[R[1]]),j=_.N.normalize([],_.N.cross([],L,V)),q=-_.N.dot(j,E[R[1]]);return j.concat(q)}),k=[];for(let R=0;R<E.length;R++)k.push([E[R][0],E[R][1],E[R][2]]);return new by(k,M)}intersectsPrecise(s,d,f){for(let v=0;v<d.length;v++)if(!ow(s,d[v]))return 0;for(let v=0;v<this.planes.length;v++)if(!ow(s,this.planes[v]))return 0;for(const v of f)for(const y of this.frustumEdges){const E=_.N.cross([],v,y),M=_.N.length(E);if(0===M)continue;_.N.scale(E,E,1/M);const k=nm(this.points,this.points[0],E),R=nm(s,this.points[0],E);if(k[0]>R[1]||R[0]>k[1])return 0}return 1}}class ss{static fromPoints(s){const d=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const v of s)_.N.min(d,d,v),_.N.max(f,f,v);return new ss(d,f)}static fromTileIdAndHeight(s,d,f){const v=1<<s.canonical.z,y=s.canonical.x,E=s.canonical.y;return new ss([y/v,E/v,d],[(y+1)/v,(E+1)/v,f])}static applyTransform(s,d){const f=s.getCorners();for(let v=0;v<f.length;++v)_.N.transformMat4(f[v],f[v],d);return ss.fromPoints(f)}static projectAabbCorners(s,d){const f=s.getCorners();for(let v=0;v<f.length;++v)_.N.transformMat4(f[v],f[v],d);return f}constructor(s,d){this.min=s,this.max=d,this.center=_.N.scale([],_.N.add([],this.min,this.max),.5)}quadrant(s){const d=[s%2==0,s<2],f=_.N.clone(this.min),v=_.N.clone(this.max);for(let y=0;y<d.length;y++)f[y]=d[y]?this.min[y]:this.center[y],v[y]=d[y]?this.center[y]:this.max[y];return v[2]=this.max[2],new ss(f,v)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,d=this.max;return[[s[0],s[1],s[2]],[d[0],s[1],s[2]],[d[0],d[1],s[2]],[s[0],d[1],s[2]],[s[0],s[1],d[2]],[d[0],s[1],d[2]],[d[0],d[1],d[2]],[s[0],d[1],d[2]]]}intersects(s){return this.intersectsAabb(s.bounds)?OC(s,this.getCorners()):0}intersectsFlat(s){return this.intersectsAabb(s.bounds)?OC(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(s,d){return d||this.intersects(s)?LC(s,this.getCorners()):0}intersectsPreciseFlat(s,d){return d||this.intersectsFlat(s)?LC(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(s){for(let d=0;d<3;++d)if(this.min[d]>s.max[d]||s.min[d]>this.max[d])return!1;return!0}intersectsAabbXY(s){return!(this.min[0]>s.max[0]||s.min[0]>this.max[0]||this.min[1]>s.max[1]||s.min[1]>this.max[1])}encapsulate(s){for(let d=0;d<3;d++)this.min[d]=Math.min(this.min[d],s.min[d]),this.max[d]=Math.max(this.max[d],s.max[d])}encapsulatePoint(s){for(let d=0;d<3;d++)this.min[d]=Math.min(this.min[d],s[d]),this.max[d]=Math.max(this.max[d],s[d])}closestPoint(s){return[Math.max(Math.min(this.max[0],s[0]),this.min[0]),Math.max(Math.min(this.max[1],s[1]),this.min[1]),Math.max(Math.min(this.max[2],s[2]),this.min[2])]}}Oi(ss,"Aabb");const JS=Ir([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Oa}=JS,yy=Ir([{name:"a_pos_3",components:3,type:"Int16"}]);var sw=Ir([{name:"a_pos",type:"Int16",components:2}]);function yd(a){return a*we/pt}const yv=[new ss([je,je,je],[at,at,at]),new ss([je,je,je],[0,0,at]),new ss([0,je,je],[at,0,at]),new ss([je,0,je],[0,at,at]),new ss([0,0,je],[at,at,at])];function aw(a,s,d,f=!0){const v=_.N.scale([],a._camera.position,a.worldSize),y=[s,d,1,1];_.a7.transformMat4(y,y,a.pixelMatrixInverse),_.a7.scale(y,y,1/y[3]);const E=_.N.sub([],y,v),M=_.N.normalize([],E),k=a.globeMatrix,R=[k[12],k[13],k[14]],L=_.N.sub([],R,v),V=_.N.length(L),j=_.N.normalize([],L),q=a.worldSize/(2*Math.PI),Z=_.N.dot(j,M),J=Math.asin(q/V);if(J<Math.acos(Z)){if(!f)return null;const it=[],xt=[];_.N.scale(it,M,V/Z),_.N.normalize(xt,_.N.sub(xt,it,L)),_.N.normalize(M,_.N.add(M,L,_.N.scale(M,xt,Math.tan(J)*V)))}const ne=[];new bv(v,M).closestPointOnSphere(R,q,ne);const le=_.N.normalize([],Ce(k,0)),xe=_.N.normalize([],Ce(k,1)),Ee=_.N.normalize([],Ce(k,2)),Te=_.N.dot(le,ne),Le=_.N.dot(xe,ne),ke=_.N.dot(Ee,ne),Be=Mn(Math.asin(-Le/q));let We=Mn(Math.atan2(Te,ke));We=a.center.lng+function(it,xt){const Rt=(xt-it+180)%360-180;return Rt<-180?Rt+360:Rt}(a.center.lng,We);const tt=Sn(We),ct=Ii(bn(Be),0,1);return new Sr(tt,ct)}class Ol{constructor(s,d,f){this.a=_.N.sub([],s,f),this.b=_.N.sub([],d,f),this.center=f;const v=_.N.normalize([],this.a),y=_.N.normalize([],this.b);this.angle=Math.acos(_.N.dot(v,y))}}function rm(a,s){if(0===a.angle)return null;let d;return d=0===a.a[s]?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[s]/a.a[s]/Math.sin(a.angle)-1/Math.tan(a.angle)),d<0||d>1?null:function(f,v,y,E){const M=Math.sin(y);return f*(Math.sin((1-E)*y)/M)+v*(Math.sin(E*y)/M)}(a.a[s],a.b[s],a.angle,Ii(d,0,1))+a.center[s]}function xd(a){if(a.z<=1)return yv[a.z+2*a.y+a.x];const s=wy(xv(a));return ss.fromPoints(s)}function wd(a,s,d){return _.N.scale(a,a,1-d),_.N.scaleAndAdd(a,a,s,d)}function FC(a,s,d){for(const f of a)_.N.transformMat4(f,f,s),_.N.scale(f,f,d)}function xy(a,s,d,f){const v=s/a.worldSize,y=a.globeMatrix;if(d.z<=1){const tt=xd(d).getCorners();return FC(tt,y,v),ss.fromPoints(tt)}const E=xv(d,f),M=wy(E,we+yd(a._tileCoverLift));FC(M,y,v);const k=Number.MAX_VALUE,R=[-k,-k,-k],L=[k,k,k];if(E.contains(a.center)){for(const it of M)_.N.min(L,L,it),_.N.max(R,R,it);R[2]=0;const tt=a.point,ct=[tt.x*v,tt.y*v,0];return _.N.min(L,L,ct),_.N.max(R,R,ct),new ss(L,R)}if(a._tileCoverLift>0){for(const tt of M)_.N.min(L,L,tt),_.N.max(R,R,tt);return new ss(L,R)}const V=[y[12]*v,y[13]*v,y[14]*v],j=E.getCenter(),q=Ii(a.center.lat,-Mi,Mi),Z=Ii(j.lat,-Mi,Mi),J=Sn(a.center.lng),ne=bn(q);let le=J-Sn(j.lng);const xe=ne-bn(Z);le>.5?le-=1:le<-.5&&(le+=1);let Ee=0;if(Math.abs(le)>Math.abs(xe))Ee=le>=0?1:3;else{Ee=xe>=0?0:2;const tt=[y[4]*v,y[5]*v,y[6]*v],ct=-Math.sin(mi(xe>=0?E.getSouth():E.getNorth()))*we;_.N.scaleAndAdd(V,V,tt,ct)}const Te=M[Ee],Le=M[(Ee+1)%4],ke=new Ol(Te,Le,V),Be=[rm(ke,0)||Te[0],rm(ke,1)||Te[1],rm(ke,2)||Te[2]],We=Ih(a.zoom);if(We>0){const tt=function({x:it,y:xt,z:Rt},_t,At,ft,Dt){const ii=1/(1<<Rt);let Lt=it*ii,Ui=Lt+ii,Ti=xt*ii,Ut=Ti+ii,on=0;const Gi=(Lt+Ui)/2-ft;return Gi>.5?on=-1:Gi<-.5&&(on=1),Lt=((Lt+on)*_t-(ft*=_t))*At+ft,Ui=((Ui+on)*_t-ft)*At+ft,Ti=(Ti*_t-(Dt*=_t))*At+Dt,Ut=(Ut*_t-Dt)*At+Dt,[[Lt,Ut,0],[Ui,Ut,0],[Ui,Ti,0],[Lt,Ti,0]]}(d,s,a._pixelsPerMercatorPixel,J,ne);for(let it=0;it<M.length;it++)wd(M[it],tt[it],We);const ct=_.N.add([],tt[Ee],tt[(Ee+1)%4]);_.N.scale(ct,ct,.5),wd(Be,ct,We)}for(const tt of M)_.N.min(L,L,tt),_.N.max(R,R,tt);return L[2]=Math.min(Te[2],Le[2]),_.N.min(L,L,Be),_.N.max(R,R,Be),new ss(L,R)}function xv({x:a,y:s,z:d},f=!1){const v=1/(1<<d),y=new Ze(Dn(a*v),s===(1<<d)-1&&f?-90:fr((s+1)*v)),E=new Ze(Dn((a+1)*v),0===s&&f?90:fr(s*v));return new ht(y,E)}function wy(a,s=we){const d=mi(a.getNorth()),f=mi(a.getSouth()),v=Math.cos(d),y=Math.cos(f),E=Math.sin(d),M=Math.sin(f),k=a.getWest(),R=a.getEast();return[Ke(y,M,k,s),Ke(y,M,R,s),Ke(v,E,R,s),Ke(v,E,k,s)]}function wv(a,s,d,f){const v=1<<d.z,y=(a/Nt+d.x)/v;return rt(fr((s/Nt+d.y)/v),Dn(y),f)}function Bg({min:a,max:s}){return De/Math.max(s[0]-a[0],s[1]-a[1],s[2]-a[2])}const Cv=new Float64Array(16);function Cy(a){const s=Bg(a),d=_.a6.fromScaling(Cv,[s,s,s]);return _.a6.translate(d,d,_.N.negate([],a.min))}function lw(a){const s=_.a6.fromTranslation(Cv,a.min),d=1/Bg(a);return _.a6.scale(s,s,[d,d,d])}function cw(a){const s=Nt/(2*Math.PI);return a/(2*Math.PI)/s}function dw(a,s){return Nt/(512*Math.pow(2,a))*Bg(xd(s))}function Ey(a,s,d,f,v){const y=cw(d),E=[a,s,-d/(2*Math.PI)],M=_.a6.identity(new Float64Array(16));return _.a6.translate(M,M,E),_.a6.scale(M,M,[y,y,y]),_.a6.rotateX(M,M,mi(-v)),_.a6.rotateY(M,M,mi(-f)),M}function Ih(a){return an(Se,pe,a)}function Rh(a,s){const d=rt(s.lat,s.lng),f=function(y){const E=rt(y._center.lat,y._center.lng),M=_.N.fromValues(0,1,0);let k=_.N.cross([],M,E);const R=_.a6.fromRotation([],-y.angle,E);k=_.N.transformMat4(k,k,R),_.a6.fromRotation(R,-y._pitch,k);const L=_.N.normalize([],E);return _.N.scale(L,L,yd(y.cameraToCenterDistance/y.pixelsPerMeter)),_.N.transformMat4(L,L,R),_.N.add([],E,L)}(a),v=_.N.subtract([],f,d);return _.N.angle(v,d)}function Ev(a,s){return Rh(a,s)>Math.PI/2*1.01}const uw=mi(85),NC=Math.cos(uw),BC=Math.sin(uw),Cd=_.a6.create(),VC=a=>{const s=[];return"map"===a.paint.get("circle-pitch-alignment")&&s.push("PITCH_WITH_MAP"),"map"===a.paint.get("circle-pitch-scale")&&s.push("SCALE_WITH_MAP"),s};function zC(a,s,d,f,v,y,E,M,k){if(y&&a.queryGeometry.isAboveHorizon)return!1;y&&(k*=a.pixelToTileUnitsFactor);const R=a.tileID.canonical,L=d.projection.upVectorScale(R,d.center.lat,d.worldSize).metersToTile;for(const V of s)for(const j of V){const q=j.add(M),Z=v&&d.elevation?d.elevation.exaggeration()*v.getElevationAt(q.x,q.y,!0):0,J=d.projection.projectTilePoint(q.x,q.y,R);if(Z>0){const Ee=d.projection.upVector(R,q.x,q.y);J.x+=Ee[0]*L*Z,J.y+=Ee[1]*L*Z,J.z+=Ee[2]*L*Z}const ne=y?q:Tv(J.x,J.y,J.z,f),le=y?a.tilespaceRays.map(Ee=>fw(Ee,Z)):a.queryGeometry.screenGeometry,xe=_.a7.transformMat4([],[J.x,J.y,J.z,1],f);if(!E&&y?k*=xe[3]/d.cameraToCenterDistance:E&&!y&&(k*=d.cameraToCenterDistance/xe[3]),y){const Ee=fr((j.y/Nt+R.y)/(1<<R.z));k/=d.projection.pixelsPerMeter(Ee,1)/xn(1,Ee)}if(lo(le,ne,k))return!0}return!1}function Tv(a,s,d,f){const v=_.a7.transformMat4([],[a,s,d,1],f);return new mt(v[0]/v[3],v[1]/v[3])}const hw=_.N.fromValues(0,0,0),Kk=_.N.fromValues(0,0,1);function fw(a,s){const d=_.N.create();return hw[2]=s,a.intersectsPlane(hw,Kk,d),new mt(d[0],d[1])}class eM extends nl{}function tM(a,{width:s,height:d},f,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==s*d*f)throw new RangeError("mismatched image size")}else v=new Uint8Array(s*d*f);return a.width=s,a.height=d,a.data=v,a}function iM(a,s,d){const{width:f,height:v}=s;f===a.width&&v===a.height||(Sv(a,s,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,f),height:Math.min(a.height,v)},d),a.width=f,a.height=v,a.data=s.data)}function Sv(a,s,d,f,v,y,E){if(0===v.width||0===v.height)return s;if(v.width>a.width||v.height>a.height||d.x>a.width-v.width||d.y>a.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>s.width||v.height>s.height||f.x>s.width-v.width||f.y>s.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const M=a.data,k=s.data,R=4===y&&E;for(let L=0;L<v.height;L++){const V=((d.y+L)*a.width+d.x)*y,j=((f.y+L)*s.width+f.x)*y;if(R)for(let q=0;q<v.width;q++){const Z=V+q*y+3,J=j+q*y;k[J+0]=255,k[J+1]=255,k[J+2]=255,k[J+3]=M[Z]}else for(let q=0;q<v.width*y;q++)k[j+q]=M[V+q]}return s}Oi(eM,"HeatmapBucket",{omit:["layers"]});class Zu{constructor(s,d){tM(this,s,1,d)}resize(s){iM(this,new Zu(s),1)}clone(){return new Zu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,d,f,v,y){Sv(s,d,f,v,y,1)}}class xc{constructor(s,d){tM(this,s,4,d)}resize(s){iM(this,new xc(s),4)}replace(s,d){d?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new xc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,d,f,v,y,E){Sv(s,d,f,v,y,4,E)}}class mw{constructor(s,d){this.width=s.width,this.height=s.height,this.data=d instanceof Uint8Array?new Float32Array(d.buffer):d}}Oi(Zu,"AlphaImage"),Oi(xc,"RGBAImage");const ol=new $o({visibility:new ni(ot.layout_heatmap.visibility)});var Ty={paint:new $o({"heatmap-radius":new Ji(ot.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ji(ot.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ni(ot.paint_heatmap["heatmap-intensity"]),"heatmap-color":new op(ot.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ni(ot.paint_heatmap["heatmap-opacity"])}),layout:ol};function Sy(a){const s={},d=a.resolution||256,f=a.clips?a.clips.length:1,v=a.image||new xc({width:d,height:f}),y=(E,M,k)=>{s[a.evaluationKey]=k;const R=a.expression.evaluate(s);R&&(v.data[E+M+0]=Math.floor(255*R.r/R.a),v.data[E+M+1]=Math.floor(255*R.g/R.a),v.data[E+M+2]=Math.floor(255*R.b/R.a),v.data[E+M+3]=Math.floor(255*R.a))};if(a.clips)for(let E=0,M=0;E<f;++E,M+=4*d)for(let k=0,R=0;k<d;k++,R+=4){const L=k/(d-1),{start:V,end:j}=a.clips[E];y(M,R,V*(1-L)+j*L)}else for(let E=0,M=0;E<d;E++,M+=4)y(0,M,E/(d-1));return v}const nM=new $o({visibility:new ni(ot.layout_hillshade.visibility)});var UC={paint:new $o({"hillshade-illumination-direction":new ni(ot.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ni(ot.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ni(ot.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ni(ot.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ni(ot.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ni(ot.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new ni(ot.paint_hillshade["hillshade-emissive-strength"])}),layout:nM};const rM=Ir([{name:"a_pos",components:2,type:"Int16"}],4),{members:jC}=rM;var Mv={exports:{}};function My(a,s,d){d=d||2;var f,v,y,E,M,k,R,L=s&&s.length,V=L?s[0]*d:a.length,j=GC(a,0,V,d,!0),q=[];if(!j||j.next===j.prev)return q;if(L&&(j=function(J,ne,le,xe){var Ee,Te,Le,ke=[];for(Ee=0,Te=ne.length;Ee<Te;Ee++)(Le=GC(J,ne[Ee]*xe,Ee<Te-1?ne[Ee+1]*xe:J.length,xe,!1))===Le.next&&(Le.steiner=!0),ke.push(ky(Le));for(ke.sort(Vg),Ee=0;Ee<ke.length;Ee++)le=Dy(ke[Ee],le);return le}(a,s,j,d)),a.length>80*d){f=y=a[0],v=E=a[1];for(var Z=d;Z<V;Z+=d)(M=a[Z])<f&&(f=M),(k=a[Z+1])<v&&(v=k),M>y&&(y=M),k>E&&(E=k);R=0!==(R=Math.max(y-f,E-v))?32767/R:0}return Dv(j,q,d,f,v,R,0),q}function GC(a,s,d,f,v){var y,E;if(v===Py(a,s,d,f)>0)for(y=s;y<d;y+=f)E=XC(y,a[y],a[y+1],E);else for(y=d-f;y>=s;y-=f)E=XC(y,a[y],a[y+1],E);return E&&sm(E,E.next)&&(Ry(E),E=E.next),E}function Av(a,s){if(!a)return a;s||(s=a);var d,f=a;do{if(d=!1,f.steiner||!sm(f,f.next)&&0!==Cs(f.prev,f,f.next))f=f.next;else{if(Ry(f),(f=s=f.prev)===f.next)break;d=!0}}while(d||f!==s);return s}function Dv(a,s,d,f,v,y,E){if(a){!E&&y&&function(L,V,j,q){var Z=L;do{0===Z.z&&(Z.z=om(Z.x,Z.y,V,j,q)),Z.prevZ=Z.prev,Z.nextZ=Z.next,Z=Z.next}while(Z!==L);Z.prevZ.nextZ=null,Z.prevZ=null,function(J){var ne,le,xe,Ee,Te,Le,ke,Be,We=1;do{for(le=J,J=null,Te=null,Le=0;le;){for(Le++,xe=le,ke=0,ne=0;ne<We&&(ke++,xe=xe.nextZ);ne++);for(Be=We;ke>0||Be>0&&xe;)0!==ke&&(0===Be||!xe||le.z<=xe.z)?(Ee=le,le=le.nextZ,ke--):(Ee=xe,xe=xe.nextZ,Be--),Te?Te.nextZ=Ee:J=Ee,Ee.prevZ=Te,Te=Ee;le=xe}Te.nextZ=null,We*=2}while(Le>1)}(Z)}(a,f,v,y);for(var M,k,R=a;a.prev!==a.next;)if(M=a.prev,k=a.next,y?Qk(a,f,v,y):Ay(a))s.push(M.i/d|0),s.push(a.i/d|0),s.push(k.i/d|0),Ry(a),a=k.next,R=k.next;else if((a=k)===R){E?1===E?Dv(a=HC(Av(a),s,d),s,d,f,v,y,2):2===E&&$C(a,s,d,f,v,y):Dv(Av(a),s,d,f,v,y,1);break}}}function Ay(a){var s=a.prev,d=a,f=a.next;if(Cs(s,d,f)>=0)return!1;for(var v=s.x,y=d.x,E=f.x,M=s.y,k=d.y,R=f.y,L=v<y?v<E?v:E:y<E?y:E,V=M<k?M<R?M:R:k<R?k:R,j=v>y?v>E?v:E:y>E?y:E,q=M>k?M>R?M:R:k>R?k:R,Z=f.next;Z!==s;){if(Z.x>=L&&Z.x<=j&&Z.y>=V&&Z.y<=q&&Ed(v,M,y,k,E,R,Z.x,Z.y)&&Cs(Z.prev,Z,Z.next)>=0)return!1;Z=Z.next}return!0}function Qk(a,s,d,f){var v=a.prev,y=a,E=a.next;if(Cs(v,y,E)>=0)return!1;for(var M=v.x,k=y.x,R=E.x,L=v.y,V=y.y,j=E.y,q=M<k?M<R?M:R:k<R?k:R,Z=L<V?L<j?L:j:V<j?V:j,J=M>k?M>R?M:R:k>R?k:R,ne=L>V?L>j?L:j:V>j?V:j,le=om(q,Z,s,d,f),xe=om(J,ne,s,d,f),Ee=a.prevZ,Te=a.nextZ;Ee&&Ee.z>=le&&Te&&Te.z<=xe;){if(Ee.x>=q&&Ee.x<=J&&Ee.y>=Z&&Ee.y<=ne&&Ee!==v&&Ee!==E&&Ed(M,L,k,V,R,j,Ee.x,Ee.y)&&Cs(Ee.prev,Ee,Ee.next)>=0||(Ee=Ee.prevZ,Te.x>=q&&Te.x<=J&&Te.y>=Z&&Te.y<=ne&&Te!==v&&Te!==E&&Ed(M,L,k,V,R,j,Te.x,Te.y)&&Cs(Te.prev,Te,Te.next)>=0))return!1;Te=Te.nextZ}for(;Ee&&Ee.z>=le;){if(Ee.x>=q&&Ee.x<=J&&Ee.y>=Z&&Ee.y<=ne&&Ee!==v&&Ee!==E&&Ed(M,L,k,V,R,j,Ee.x,Ee.y)&&Cs(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.prevZ}for(;Te&&Te.z<=xe;){if(Te.x>=q&&Te.x<=J&&Te.y>=Z&&Te.y<=ne&&Te!==v&&Te!==E&&Ed(M,L,k,V,R,j,Te.x,Te.y)&&Cs(Te.prev,Te,Te.next)>=0)return!1;Te=Te.nextZ}return!0}function HC(a,s,d){var f=a;do{var v=f.prev,y=f.next.next;!sm(v,y)&&Iy(v,f,f.next,y)&&Ph(v,y)&&Ph(y,v)&&(s.push(v.i/d|0),s.push(f.i/d|0),s.push(y.i/d|0),Ry(f),Ry(f.next),f=a=y),f=f.next}while(f!==a);return Av(f)}function $C(a,s,d,f,v,y){var E=a;do{for(var M=E.next.next;M!==E.prev;){if(E.i!==M.i&&pw(E,M)){var k=oM(E,M);return E=Av(E,E.next),k=Av(k,k.next),Dv(E,s,d,f,v,y,0),void Dv(k,s,d,f,v,y,0)}M=M.next}E=E.next}while(E!==a)}function Vg(a,s){return a.x-s.x}function Dy(a,s){var d=function(v,y){var E,M=y,k=v.x,R=v.y,L=-1/0;do{if(R<=M.y&&R>=M.next.y&&M.next.y!==M.y){var V=M.x+(R-M.y)*(M.next.x-M.x)/(M.next.y-M.y);if(V<=k&&V>L&&(L=V,E=M.x<M.next.x?M:M.next,V===k))return E}M=M.next}while(M!==y);if(!E)return null;var j,q=E,Z=E.x,J=E.y,ne=1/0;M=E;do{k>=M.x&&M.x>=Z&&k!==M.x&&Ed(R<J?k:L,R,Z,J,R<J?L:k,R,M.x,M.y)&&(j=Math.abs(R-M.y)/(k-M.x),Ph(M,v)&&(j<ne||j===ne&&(M.x>E.x||M.x===E.x&&WC(E,M)))&&(E=M,ne=j)),M=M.next}while(M!==q);return E}(a,s);if(!d)return s;var f=oM(d,a);return Av(f,f.next),Av(d,d.next)}function WC(a,s){return Cs(a.prev,a,s.prev)<0&&Cs(s.next,a,a.next)<0}function om(a,s,d,f,v){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-d)*v|0)|a<<8))|a<<4))|a<<2))|a<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-f)*v|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function ky(a){var s=a,d=a;do{(s.x<d.x||s.x===d.x&&s.y<d.y)&&(d=s),s=s.next}while(s!==a);return d}function Ed(a,s,d,f,v,y,E,M){return(v-E)*(s-M)>=(a-E)*(y-M)&&(a-E)*(f-M)>=(d-E)*(s-M)&&(d-E)*(y-M)>=(v-E)*(f-M)}function pw(a,s){return a.next.i!==s.i&&a.prev.i!==s.i&&!function(d,f){var v=d;do{if(v.i!==d.i&&v.next.i!==d.i&&v.i!==f.i&&v.next.i!==f.i&&Iy(v,v.next,d,f))return!0;v=v.next}while(v!==d);return!1}(a,s)&&(Ph(a,s)&&Ph(s,a)&&function(d,f){var v=d,y=!1,E=(d.x+f.x)/2,M=(d.y+f.y)/2;do{v.y>M!=v.next.y>M&&v.next.y!==v.y&&E<(v.next.x-v.x)*(M-v.y)/(v.next.y-v.y)+v.x&&(y=!y),v=v.next}while(v!==d);return y}(a,s)&&(Cs(a.prev,a,s.prev)||Cs(a,s.prev,s))||sm(a,s)&&Cs(a.prev,a,a.next)>0&&Cs(s.prev,s,s.next)>0)}function Cs(a,s,d){return(s.y-a.y)*(d.x-s.x)-(s.x-a.x)*(d.y-s.y)}function sm(a,s){return a.x===s.x&&a.y===s.y}function Iy(a,s,d,f){var v=xp(Cs(a,s,d)),y=xp(Cs(a,s,f)),E=xp(Cs(d,f,a)),M=xp(Cs(d,f,s));return v!==y&&E!==M||!(0!==v||!gw(a,d,s))||!(0!==y||!gw(a,f,s))||!(0!==E||!gw(d,a,f))||!(0!==M||!gw(d,s,f))}function gw(a,s,d){return s.x<=Math.max(a.x,d.x)&&s.x>=Math.min(a.x,d.x)&&s.y<=Math.max(a.y,d.y)&&s.y>=Math.min(a.y,d.y)}function xp(a){return a>0?1:a<0?-1:0}function Ph(a,s){return Cs(a.prev,a,a.next)<0?Cs(a,s,a.next)>=0&&Cs(a,a.prev,s)>=0:Cs(a,s,a.prev)<0||Cs(a,a.next,s)<0}function oM(a,s){var d=new qC(a.i,a.x,a.y),f=new qC(s.i,s.x,s.y),v=a.next,y=s.prev;return a.next=s,s.prev=a,d.next=v,v.prev=d,f.next=d,d.prev=f,y.next=f,f.prev=y,f}function XC(a,s,d,f){var v=new qC(a,s,d);return f?(v.next=f.next,v.prev=f,f.next.prev=v,f.next=v):(v.prev=v,v.next=v),v}function Ry(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function qC(a,s,d){this.i=a,this.x=s,this.y=d,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Py(a,s,d,f){for(var v=0,y=s,E=d-f;y<d;y+=f)v+=(a[E]-a[y])*(a[y+1]+a[E+1]),E=y;return v}Mv.exports=My,Mv.exports.default=My,My.deviation=function(a,s,d,f){var v=s&&s.length,y=Math.abs(Py(a,0,v?s[0]*d:a.length,d));if(v)for(var E=0,M=s.length;E<M;E++)y-=Math.abs(Py(a,s[E]*d,E<M-1?s[E+1]*d:a.length,d));var k=0;for(E=0;E<f.length;E+=3){var R=f[E]*d,L=f[E+1]*d,V=f[E+2]*d;k+=Math.abs((a[R]-a[V])*(a[L+1]-a[R+1])-(a[R]-a[L])*(a[V+1]-a[R+1]))}return 0===y&&0===k?0:Math.abs((k-y)/y)},My.flatten=function(a){for(var s=a[0][0].length,d={vertices:[],holes:[],dimensions:s},f=0,v=0;v<a.length;v++){for(var y=0;y<a[v].length;y++)for(var E=0;E<s;E++)d.vertices.push(a[v][y][E]);v>0&&d.holes.push(f+=a[v-1].length)}return d};var Oy=un(Mv.exports);function kv(a,s){const d=a.length;if(d<=1)return[a];const f=[];let v,y;for(let E=0;E<d;E++){const M=Xt(a[E]);0!==M&&(a[E].area=Math.abs(M),void 0===y&&(y=M<0),y===M<0?(v&&f.push(v),v=[a[E]]):v.push(a[E]))}if(v&&f.push(v),s>1)for(let E=0;E<f.length;E++)f[E].length<=s||(he(f[E],s,1,f[E].length-1,wo),f[E]=f[E].slice(0,s));return f}function wo(a,s){return s.area-a.area}function zg(a,s,d){const f=d.patternDependencies;let v=!1;for(const y of s){const E=y.paint.get(`${a}-pattern`);E.isConstant()||(v=!0);const M=E.constantOr(null);M&&(v=!0,f[M]=!0)}return v}function Oh(a,s,d,f,v){const y=v.patternDependencies;for(const E of s){const M=E.paint.get(`${a}-pattern`).value;if("constant"!==M.kind){let k=M.evaluate({zoom:f},d,{},v.availableImages);k=k&&k.name?k.name:k,y[k]=!0,d.patterns[E.id]=k}}return d}class Ug{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new dn,this.indexArray=new ln,this.indexArray2=new $c,this.programConfigurations=new ae(s.layers,s.zoom),this.segments=new Wo,this.segments2=new Wo,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.projection=s.projection}populate(s,d,f,v){this.hasPattern=zg("fill",this.layers,d);const y=this.layers[0].layout.get("fill-sort-key"),E=[];for(const{feature:M,id:k,index:R,sourceLayerIndex:L}of s){const V=this.layers[0]._featureFilter.needGeometry,j=ks(M,V);if(!this.layers[0]._featureFilter.filter(new qr(this.zoom),j,f))continue;const q=y?y.evaluate(j,{},f,d.availableImages):void 0,Z={id:k,properties:M.properties,type:M.type,sourceLayerIndex:L,index:R,geometry:V?j.geometry:Ks(M,f,v),patterns:{},sortKey:q};E.push(Z)}y&&E.sort((M,k)=>M.sortKey-k.sortKey);for(const M of E){const{geometry:k,index:R,sourceLayerIndex:L}=M;if(this.hasPattern){const V=Oh("fill",this.layers,M,this.zoom,d);this.patternFeatures.push(V)}else this.addFeature(M,k,R,f,{},d.availableImages,d.brightness);d.featureIndex.insert(s[R].feature,k,R,L,this.index)}}update(s,d,f,v,y){const E=0!==Object.keys(s).length;E&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(s,d,E?this.stateDependentLayers:this.layers,f,v,y)}addFeatures(s,d,f,v,y,E){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,d,f,v,E)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,jC),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,d,f,v,y,E=[],M){for(const k of kv(d,500)){let R=0;for(const J of k)R+=J.length;const L=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray),V=L.vertexLength,j=[],q=[];for(const J of k){if(0===J.length)continue;J!==k[0]&&q.push(j.length/2);const ne=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),le=ne.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(le+J.length-1,le),j.push(J[0].x),j.push(J[0].y);for(let xe=1;xe<J.length;xe++)this.layoutVertexArray.emplaceBack(J[xe].x,J[xe].y),this.indexArray2.emplaceBack(le+xe-1,le+xe),j.push(J[xe].x),j.push(J[xe].y);ne.vertexLength+=J.length,ne.primitiveLength+=J.length}const Z=Oy(j,q);for(let J=0;J<Z.length;J+=3)this.indexArray.emplaceBack(V+Z[J],V+Z[J+1],V+Z[J+2]);L.vertexLength+=R,L.primitiveLength+=Z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,y,E,v,M)}}Oi(Ug,"FillBucket",{omit:["layers","patternFeatures"]});const YC=new $o({"fill-sort-key":new Ji(ot.layout_fill["fill-sort-key"]),visibility:new ni(ot.layout_fill.visibility)});var Ly={paint:new $o({"fill-antialias":new ni(ot.paint_fill["fill-antialias"]),"fill-opacity":new Ji(ot.paint_fill["fill-opacity"]),"fill-color":new Ji(ot.paint_fill["fill-color"]),"fill-outline-color":new Ji(ot.paint_fill["fill-outline-color"]),"fill-translate":new ni(ot.paint_fill["fill-translate"]),"fill-translate-anchor":new ni(ot.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ji(ot.paint_fill["fill-pattern"]),"fill-emissive-strength":new ni(ot.paint_fill["fill-emissive-strength"])}),layout:YC};const Jk=Ir([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Ql=Ir([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Ku=Ir([{name:"a_centroid_pos",components:2,type:"Uint16"}]),wp=Ir([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Lh=Ir([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:_w}=Jk;var am={},Fy=ki,Ny=Cp;function Cp(a,s,d,f,v){this.properties={},this.extent=d,this.type=0,this._pbf=a,this._geometry=-1,this._keys=f,this._values=v,a.readFields(jg,this,s)}function jg(a,s,d){1==a?s.id=d.readVarint():2==a?function(f,v){for(var y=f.readVarint()+f.pos;f.pos<y;){var E=v._keys[f.readVarint()],M=v._values[f.readVarint()];v.properties[E]=M}}(d,s):3==a?s.type=d.readVarint():4==a&&(s._geometry=d.pos)}function Td(a){for(var s,d,f=0,v=0,y=a.length,E=y-1;v<y;E=v++)f+=((d=a[E]).x-(s=a[v]).x)*(s.y+d.y);return f}Cp.types=["Unknown","Point","LineString","Polygon"],Cp.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var s,d=a.readVarint()+a.pos,f=1,v=0,y=0,E=0,M=[];a.pos<d;){if(v<=0){var k=a.readVarint();f=7&k,v=k>>3}if(v--,1===f||2===f)y+=a.readSVarint(),E+=a.readSVarint(),1===f&&(s&&M.push(s),s=[]),s.push(new Fy(y,E));else{if(7!==f)throw new Error("unknown command "+f);s&&s.push(s[0].clone())}}return s&&M.push(s),M},Cp.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var s=a.readVarint()+a.pos,d=1,f=0,v=0,y=0,E=1/0,M=-1/0,k=1/0,R=-1/0;a.pos<s;){if(f<=0){var L=a.readVarint();d=7&L,f=L>>3}if(f--,1===d||2===d)(v+=a.readSVarint())<E&&(E=v),v>M&&(M=v),(y+=a.readSVarint())<k&&(k=y),y>R&&(R=y);else if(7!==d)throw new Error("unknown command "+d)}return[E,k,M,R]},Cp.prototype.toGeoJSON=function(a,s,d){var f,v,y=this.extent*Math.pow(2,d),E=this.extent*a,M=this.extent*s,k=this.loadGeometry(),R=Cp.types[this.type];function L(q){for(var Z=0;Z<q.length;Z++){var J=q[Z];q[Z]=[360*(J.x+E)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(J.y+M)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(f=0;f<k.length;f++)V[f]=k[f][0];L(k=V);break;case 2:for(f=0;f<k.length;f++)L(k[f]);break;case 3:for(k=function(q){var Z=q.length;if(Z<=1)return[q];for(var J,ne,le=[],xe=0;xe<Z;xe++){var Ee=Td(q[xe]);0!==Ee&&(void 0===ne&&(ne=Ee<0),ne===Ee<0?(J&&le.push(J),J=[q[xe]]):J.push(q[xe]))}return J&&le.push(J),le}(k),f=0;f<k.length;f++)for(v=0;v<k[f].length;v++)L(k[f][v])}1===k.length?k=k[0]:R="Multi"+R;var j={type:"Feature",geometry:{type:R,coordinates:k},properties:this.properties};return"id"in this&&(j.id=this.id),j};var Gg=Ny,ZC=By;function By(a,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Iv,this,s),this.length=this._features.length}function Iv(a,s,d){15===a?s.version=d.readVarint():1===a?s.name=d.readString():5===a?s.extent=d.readVarint():2===a?s._features.push(d.pos):3===a?s._keys.push(d.readString()):4===a&&s._values.push(function(f){for(var v=null,y=f.readVarint()+f.pos;f.pos<y;){var E=f.readVarint()>>3;v=1===E?f.readString():2===E?f.readFloat():3===E?f.readDouble():4===E?f.readVarint64():5===E?f.readVarint():6===E?f.readSVarint():7===E?f.readBoolean():null}return v}(d))}By.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var s=this._pbf.readVarint()+this._pbf.pos;return new Gg(this._pbf,s,this.extent,this._keys,this._values)};var vw=ZC;function Js(a,s,d){if(3===a){var f=new vw(d,d.readVarint()+d.pos);f.length&&(s[f.name]=f)}}var bw=am.VectorTile=function(a,s){this.layers=a.readFields(Js,{},s)},Ep=am.VectorTileFeature=Ny;function Hg(a,s,d,f){const v=[],y=0===f?(E,M,k,R,L,V)=>{E.push(new mt(V,k+(V-M)/(R-M)*(L-k)))}:(E,M,k,R,L,V)=>{E.push(new mt(M+(V-k)/(L-k)*(R-M),V))};for(const E of a){const M=[];for(const k of E){if(k.length<=2)continue;const R=[];for(let j=0;j<k.length-1;j++){const q=k[j].x,Z=k[j].y,J=k[j+1].x,ne=k[j+1].y,le=0===f?q:Z,xe=0===f?J:ne;le<s?xe>s&&y(R,q,Z,J,ne,s):le>d?xe<d&&y(R,q,Z,J,ne,d):R.push(k[j]),xe<s&&le>=s&&y(R,q,Z,J,ne,s),xe>d&&le<=d&&y(R,q,Z,J,ne,d)}let L=k[k.length-1];const V=0===f?L.x:L.y;V>=s&&V<=d&&R.push(L),R.length&&(L=R[R.length-1],R[0].x===L.x&&R[0].y===L.y||R.push(R[0]),M.push(R))}M.length&&v.push(M)}return v}function lm(a,s){return a.x-s.x||a.y-s.y}function sM(a,s){return 0===lm(a.min,s.min)&&0===lm(a.max,s.max)}function Fh(a,s){return!(a.min.x>s.max.x||a.max.x<s.min.x||a.min.y>s.max.y||a.max.y<s.min.y)}function sl(a,s,d){const f=1/Nt,v=1/(1<<d.canonical.z),y=(s.x*f+d.canonical.x)*v+d.wrap,E=(s.y*f+d.canonical.y)*v;return{min:new mt((a.x*f+d.canonical.x)*v+d.wrap,(a.y*f+d.canonical.y)*v),max:new mt(y,E)}}function Tp(a,s,d){const f=1<<d.canonical.z,v=((s.x-d.wrap)*f-d.canonical.x)*Nt,y=(s.y*f-d.canonical.y)*Nt;return{min:new mt(((a.x-d.wrap)*f-d.canonical.x)*Nt,(a.y*f-d.canonical.y)*Nt),max:new mt(v,y)}}function Sp(a,s,d,f,v,y,E){const M=a.indices,k=a.vertices,R=[];for(let L=f;L<f+v;L+=3){const V=s[d[L+0]+y],j=s[d[L+1]+y],q=s[d[L+2]+y],Z=Math.min(V.x,j.x,q.x),J=Math.max(V.x,j.x,q.x),ne=Math.min(V.y,j.y,q.y),le=Math.max(V.y,j.y,q.y);R.length=0,a.grid.query(new mt(Z,ne),new mt(J,le),R);for(let xe=0;xe<R.length;xe++){const Ee=R[xe];if(fa(k[M[3*Ee+0]],k[M[3*Ee+1]],k[M[3*Ee+2]],V,j,q,E))return!0}}return!1}function $g(a,s,d,f){if(!a||!d)return!1;let v=a.vertices;if(!s.canonical.equals(f.canonical)||s.wrap!==f.wrap){if(d.vertices.length<a.vertices.length)return $g(d,f,a,s);const y=s.canonical,E=f.canonical,M=Math.pow(2,E.z-y.z);v=a.vertices.map(k=>new mt(k.x*y.x*Nt*M-E.x*Nt,k.y*y.y*Nt*M-E.y*Nt))}return Sp(d,v,a.indices,0,a.indices.length,0,0)}am.VectorTileLayer=ZC;class Wg{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,d){const f=this.toIdx(s,d);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(s,d){return this.leaves[this.toIdx(s,d)]}toIdx(s,d){return d*this.size+s}}function Qu(a,s,d,f){let v=0,y=Number.MAX_VALUE;for(let E=0;E<3;E++)if(Math.abs(f[E])<1e-15){if(d[E]<a[E]||d[E]>s[E])return null}else{const M=1/f[E];let k=(a[E]-d[E])*M,R=(s[E]-d[E])*M;if(k>R){const L=k;k=R,R=L}if(k>v&&(v=k),R<y&&(y=R),v>y)return null}return v}function Wa(a,s,d,f,v,y,E,M,k,R,L){const V=f-a,j=v-s,q=y-d,Z=E-a,J=M-s,ne=k-d,le=L[1]*ne-L[2]*J,xe=L[2]*Z-L[0]*ne,Ee=L[0]*J-L[1]*Z,Te=V*le+j*xe+q*Ee;if(Math.abs(Te)<1e-15)return null;const Le=1/Te,ke=R[0]-a,Be=R[1]-s,We=R[2]-d,tt=(ke*le+Be*xe+We*Ee)*Le;if(tt<0||tt>1)return null;const ct=Be*q-We*j,it=We*V-ke*q,xt=ke*j-Be*V,Rt=(L[0]*ct+L[1]*it+L[2]*xt)*Le;return Rt<0||tt+Rt>1?null:(Z*ct+J*it+ne*xt)*Le}function Nh(a,s,d){return(a-s)/(d-s)}function Sd(a,s,d,f,v,y,E,M,k){const R=1<<d,L=y-f,V=E-v,j=(a+1)/R*L+f,q=(s+0)/R*V+v,Z=(s+1)/R*V+v;M[0]=(a+0)/R*L+f,M[1]=q,k[0]=j,k[1]=Z}class aM{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const d=function(y){const E=Math.ceil(Math.log2(y.dim/8)),M=[];let k=Math.ceil(Math.pow(2,E));const R=1/k,L=(q,Z,J,ne,le)=>{const xe=ne?1:0,Ee=(q+1)*J-xe,Te=Z*J,Le=(Z+1)*J-xe;le[0]=q*J,le[1]=Te,le[2]=Ee,le[3]=Le};let V=new Wg(k);const j=[];for(let q=0;q<k*k;q++){L(q%k,Math.floor(q/k),R,!1,j);const Z=Mp(j[0],j[1],y),J=Mp(j[2],j[1],y),ne=Mp(j[2],j[3],y),le=Mp(j[0],j[3],y);V.minimums.push(Math.min(Z,J,ne,le)),V.maximums.push(Math.max(Z,J,ne,le)),V.leaves.push(1)}for(M.push(V),k/=2;k>=1;k/=2){const q=M[M.length-1];V=new Wg(k);for(let Z=0;Z<k*k;Z++){L(Z%k,Math.floor(Z/k),2,!0,j);const J=q.getElevation(j[0],j[1]),ne=q.getElevation(j[2],j[1]),le=q.getElevation(j[2],j[3]),xe=q.getElevation(j[0],j[3]),Ee=q.isLeaf(j[0],j[1]),Te=q.isLeaf(j[2],j[1]),Le=q.isLeaf(j[2],j[3]),ke=q.isLeaf(j[0],j[3]),Be=Math.min(J.min,ne.min,le.min,xe.min),We=Math.max(J.max,ne.max,le.max,xe.max),tt=Ee&&Te&&Le&&ke;V.maximums.push(We),V.minimums.push(Be),V.leaves.push(We-Be<=5&&tt?1:0)}M.push(V)}return M}(this.dem),f=d.length-1,v=d[f];this._addNode(v.minimums[0],v.maximums[0],v.leaves[0]),this._construct(d,0,0,f,0)}raycastRoot(s,d,f,v,y,E,M=1){return Qu([s,d,-100],[f,v,this.maximums[0]*M],y,E)}raycast(s,d,f,v,y,E,M=1){if(!this.nodeCount)return null;const k=this.raycastRoot(s,d,f,v,y,E,M);if(null==k)return null;const R=[],L=[],V=[],j=[],q=[{idx:0,t:k,nodex:0,nodey:0,depth:0}];for(;q.length>0;){const{idx:Z,t:J,nodex:ne,nodey:le,depth:xe}=q.pop();if(this.leaves[Z]){Sd(ne,le,xe,s,d,f,v,V,j);const Te=1<<xe,Le=(ne+0)/Te,ke=(ne+1)/Te,Be=(le+0)/Te,We=(le+1)/Te,tt=Mp(Le,Be,this.dem)*M,ct=Mp(ke,Be,this.dem)*M,it=Mp(ke,We,this.dem)*M,xt=Mp(Le,We,this.dem)*M,Rt=Wa(V[0],V[1],tt,j[0],V[1],ct,j[0],j[1],it,y,E),_t=Wa(j[0],j[1],it,V[0],j[1],xt,V[0],V[1],tt,y,E),At=Math.min(null!==Rt?Rt:Number.MAX_VALUE,null!==_t?_t:Number.MAX_VALUE);if(At!==Number.MAX_VALUE)return At;{const ft=_.N.scaleAndAdd([],y,E,J);if(lM(tt,ct,xt,it,Nh(ft[0],V[0],j[0]),Nh(ft[1],V[1],j[1]))>=ft[2])return J}continue}let Ee=0;for(let Te=0;Te<this._siblingOffset.length;Te++){Sd((ne<<1)+this._siblingOffset[Te][0],(le<<1)+this._siblingOffset[Te][1],xe+1,s,d,f,v,V,j),V[2]=-100,j[2]=this.maximums[this.childOffsets[Z]+Te]*M;const Le=Qu(V,j,y,E);if(null!=Le){const ke=Le;R[Te]=ke;let Be=!1;for(let We=0;We<Ee&&!Be;We++)ke>=R[L[We]]&&(L.splice(We,0,Te),Be=!0);Be||(L[Ee]=Te),Ee++}}for(let Te=0;Te<Ee;Te++){const Le=L[Te];q.push({idx:this.childOffsets[Z]+Le,t:R[Le],nodex:(ne<<1)+this._siblingOffset[Le][0],nodey:(le<<1)+this._siblingOffset[Le][1],depth:xe+1})}}return null}_addNode(s,d,f){return this.minimums.push(s),this.maximums.push(d),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(s,d,f,v,y){if(1===s[v].isLeaf(d,f))return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const E=v-1,M=s[E];let k=0,R=0;for(let L=0;L<this._siblingOffset.length;L++){const V=2*d+this._siblingOffset[L][0],j=2*f+this._siblingOffset[L][1],q=M.getElevation(V,j),Z=M.isLeaf(V,j),J=this._addNode(q.min,q.max,Z);Z&&(k|=1<<L),R||(R=J)}for(let L=0;L<this._siblingOffset.length;L++)k&1<<L||this._construct(s,2*d+this._siblingOffset[L][0],2*f+this._siblingOffset[L][1],E,R+L)}}function lM(a,s,d,f,v,y){return rr(rr(a,d,y),rr(s,f,y),v)}function Mp(a,s,d){const f=d.dim,v=Ii(a*f-.5,0,f-1),y=Ii(s*f-.5,0,f-1),E=Math.floor(v),M=Math.floor(y),k=Math.min(E+1,f-1),R=Math.min(M+1,f-1);return lM(d.get(E,M),d.get(k,M),d.get(E,R),d.get(k,R),v-E,y-M)}const Bh={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Xg(a,s,d){return(256*a*256+256*s+d)/10-1e4}function eI(a,s,d){return 256*a+s+d/256-32768}class yw{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,d,f,v=!1){if(this.uid=s,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(f&&"mapbox"!==f&&"terrarium"!==f)return Qe(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=d.height;const y=this.dim=d.height-2,E=new Uint32Array(d.data.buffer);if(this.pixels=new Uint8Array(d.data.buffer),this.floatView=new Float32Array(d.data.buffer),this.borderReady=v,this._modifiedForSources={},!v){for(let k=0;k<y;k++)E[this._idx(-1,k)]=E[this._idx(0,k)],E[this._idx(y,k)]=E[this._idx(y-1,k)],E[this._idx(k,-1)]=E[this._idx(k,0)],E[this._idx(k,y)]=E[this._idx(k,y-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(y,-1)]=E[this._idx(y-1,0)],E[this._idx(-1,y)]=E[this._idx(0,y-1)],E[this._idx(y,y)]=E[this._idx(y-1,y-1)]}const M="terrarium"===f?eI:Xg;for(let k=0;k<E.length;++k){const R=4*k;this.floatView[k]=M(this.pixels[R],this.pixels[R+1],this.pixels[R+2])}this._timestamp=Ht.now()}_buildQuadTree(){this._tree=new aM(this)}get(s,d,f=!1){f&&(s=Ii(s,-1,this.dim),d=Ii(d,-1,this.dim));const v=this._idx(s,d);return this.floatView[v]}set(s,d,f){const v=this._idx(s,d),y=this.floatView[v];return this.floatView[v]=f,f-y}static getUnpackVector(s){return Bh[s]}_idx(s,d){if(s<-1||s>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(s+1)}static pack(s,d){const f=[0,0,0,0],v=yw.getUnpackVector(d);let y=Math.floor((s+v[3])/v[2]);return f[2]=y%256,y=Math.floor(y/256),f[1]=y%256,y=Math.floor(y/256),f[0]=y,f}getPixels(){return new mw({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,d,f){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let v=d*this.dim,y=d*this.dim+this.dim,E=f*this.dim,M=f*this.dim+this.dim;switch(d){case-1:v=y-1;break;case 1:y=v+1}switch(f){case-1:E=M-1;break;case 1:M=E+1}const k=-d*this.dim,R=-f*this.dim;for(let L=E;L<M;L++)for(let V=v;V<y;V++){const j=4*this._idx(V,L),q=4*this._idx(V+k,L+R);this.pixels[j+0]=s.pixels[q+0],this.pixels[j+1]=s.pixels[q+1],this.pixels[j+2]=s.pixels[q+2],this.pixels[j+3]=s.pixels[q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Oi(yw,"DEMData"),Oi(aM,"DemMinMaxQuadTree",{omit:["dem"]});class Rv{constructor(s,d,f){this._demTile=s,this._dem=this._demTile.dem,this._scale=d,this._offset=f}static create(s,d,f){const v=f||s.findDEMTileFor(d);if(!v||!v.dem)return;const y=v.dem,E=v.tileID,M=1<<d.canonical.z-E.canonical.z;return new Rv(v,y.dim/Nt/M,[(d.canonical.x/M-E.canonical.x)*y.dim,(d.canonical.y/M-E.canonical.y)*y.dim])}tileCoordToPixel(s,d){const f=d*this._scale+this._offset[1],v=Math.floor(s*this._scale+this._offset[0]),y=Math.floor(f);return new mt(v,y)}getElevationAt(s,d,f,v){const y=s*this._scale+this._offset[0],E=d*this._scale+this._offset[1],M=Math.floor(y),k=Math.floor(E),R=this._dem;return v=!!v,f?rr(rr(R.get(M,k,v),R.get(M,k+1,v),E-k),rr(R.get(M+1,k,v),R.get(M+1,k+1,v),E-k),y-M):R.get(M,k,v)}getElevationAtPixel(s,d,f){return this._dem.get(s,d,!!f)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*xn(1,s)*this._dem.stride}}const tI=Ep.types,iI=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],nI=["fill-extrusion-flood-light-ground-radius"],cM=Math.pow(2,13),rI=Math.pow(2,15)-1,KC=new mt(0,1),Ap=2147483648;function Vy(a,s,d,f,v,y,E,M){a.emplaceBack((s<<1)+E,(d<<1)+y,(Math.floor(f*cM)<<1)+v,Math.round(M))}function qg(a,s,d,f,v,y){a.emplaceBack(s.x,s.y,(d.x<<1)+f,(d.y<<1)+v,y)}function Md(a,s,d){a.emplaceBack(s.x,s.y,s.z,16384*d[0],16384*d[1],16384*d[2])}class cm{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class QC{constructor(){this.centroidXY=new mt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new mt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new mt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new mt(this.max.x-this.min.x,this.max.y-this.min.y)}}class JC{constructor(){this.acc=new mt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(s,d){s.min.x===Number.MAX_VALUE&&(s.min.x=s.max.x=d.x,s.min.y=s.max.y=d.y)}appendEdge(s,d,f){this.accCount++,this.acc._add(d);let v=!!this.borders;d.x<s.min.x?(s.min.x=d.x,v=!0):d.x>s.max.x&&(s.max.x=d.x,v=!0),d.y<s.min.y?(s.min.y=d.y,v=!0):d.y>s.max.y&&(s.max.y=d.y,v=!0),((0===d.x||d.x===Nt)&&d.x===f.x)!=((0===d.y||d.y===Nt)&&d.y===f.y)&&this.processBorderOverlap(d,f),v&&this.checkBorderIntersection(d,f)}checkBorderIntersection(s,d){d.x<0!=s.x<0&&this.addBorderIntersection(0,rr(d.y,s.y,(0-d.x)/(s.x-d.x))),d.x>Nt!=s.x>Nt&&this.addBorderIntersection(1,rr(d.y,s.y,(Nt-d.x)/(s.x-d.x))),d.y<0!=s.y<0&&this.addBorderIntersection(2,rr(d.x,s.x,(0-d.y)/(s.y-d.y))),d.y>Nt!=s.y>Nt&&this.addBorderIntersection(3,rr(d.x,s.x,(Nt-d.y)/(s.y-d.y)))}addBorderIntersection(s,d){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[s];d<f[0]&&(f[0]=d),d>f[1]&&(f[1]=d)}processBorderOverlap(s,d){if(s.x===d.x){if(s.y===d.y)return;const f=0===s.x?0:1;this.addBorderIntersection(f,d.y),this.addBorderIntersection(f,s.y)}else{const f=0===s.y?2:3;this.addBorderIntersection(f,d.x),this.addBorderIntersection(f,s.x)}}centroid(){return 0===this.accCount?new mt(0,0):new mt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((s,d)=>s+ +(d[0]!==Number.MAX_VALUE),0):0}}function eE(a,s){const d=a.add(s)._unit(),f=Ii(a.x*d.x+a.y*d.y,-1,1);var v,y,E;return v=Math.acos(f),Math.min(4,Math.max(-4,Math.tan(v)))/4*rI*((y=a).x*(E=s).y-y.y*E.x<0?-1:1)}const hL=[a=>a.x<0,a=>a.x>Nt,a=>a.y<0,a=>a.y>Nt];function fL(a,s,d,f){const v=[4];if(0===f)return v;d._mult(f);const y=a.sub(d),E=s.sub(d),M=[a,s,y,E];for(let k=0;k<4;k++)for(const R of M)if(hL[k](R)){v.push(k);break}return v}class oI{constructor(s){this.vertexArray=new _s,this.indexArray=new ln,this.programConfigurations=new ae(s.layers,s.zoom,d=>nI.includes(d)),this._segments=new Wo,this.hiddenByLandmarkVertexArray=new dd,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Wo}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(s,d,f,v=!1){const y=s.length;if(y>2){let E=Math.max(0,this._segments.get().length-1);const M=this._segments._prepareSegment(4*y,this.vertexArray.length,2*this._segmentToGroundQuads[E].length);let k;E!==this._segments.get().length-1&&(E++,this._segmentToGroundQuads[E]=[],this._segmentToRegionTriCounts[E]=[0,0,0,0,0]);{const R=s[0],L=s[1];k=eE(R.sub(s[y-1])._perp()._unit(),L.sub(R)._perp()._unit())}for(let R=0;R<y;R++){const L=R===y-1?0:R+1,V=s[R],j=s[L],q=s[L===y-1?0:L+1],Z=j.sub(V)._perp()._unit(),J=eE(Z,q.sub(j)._perp()._unit()),ne=k,le=J;if(ww(V,j,d)||v&&dM(V,d)&&dM(j,d)){k=J;continue}const xe=M.vertexLength;qg(this.vertexArray,V,j,1,1,ne),qg(this.vertexArray,V,j,1,0,ne),qg(this.vertexArray,V,j,0,1,le),qg(this.vertexArray,V,j,0,0,le),M.vertexLength+=4;const Ee=fL(V,j,Z,f);for(const Te of Ee)this._segmentToGroundQuads[E].push({id:xe,region:Te}),this._segmentToRegionTriCounts[E][Te]+=2,M.primitiveLength+=2;k=J}}}prepareBorderSegments(){if(!this.hasData())return;const s=this._segments.get(),d=s.length;for(let f=0;f<d;f++)this._segmentToGroundQuads[f].sort((v,y)=>v.region-y.region);for(let f=0;f<d;f++){const v=this._segmentToGroundQuads[f],y=s[f],E=this._segmentToRegionTriCounts[f];E.reduce((k,R)=>k+R,0);let M=0;for(let k=0;k<=4;k++){const R=E[k];if(0!==R){let L=this.regionSegments[k];L||(L=this.regionSegments[k]=new Wo);const V={vertexOffset:y.vertexOffset,primitiveOffset:y.primitiveOffset+M,vertexLength:y.vertexLength,primitiveLength:R};L.get().push(V)}M+=R}for(let k=0;k<v.length;k++){const R=v[k].id;this.indexArray.emplaceBack(R,R+1,R+3),this.indexArray.emplaceBack(R,R+3,R+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(s,d,f,v,y,E){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,s,d,f,v,y,E)}upload(s){this.hasData()&&(this.vertexBuffer=s.createVertexBuffer(this.vertexArray,Ql.members),this.indexBuffer=s.createIndexBuffer(this.indexArray))}uploadPaintProperties(s){this.hasData()&&this.programConfigurations.upload(s)}update(s,d,f,v,y,E){this.hasData()&&this.programConfigurations.updatePaintArrays(s,d,f,v,y,E)}updateHiddenByLandmark(s){if(!this.hasData())return;const d=s.groundVertexCount+s.groundVertexArrayOffset;if(0===s.groundVertexCount)return;const f=s.flags&Ap?1:0;for(let v=s.groundVertexArrayOffset;v<d;++v)this.hiddenByLandmarkVertexArray.emplace(v,f);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(s){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=s.createVertexBuffer(this.hiddenByLandmarkVertexArray,wp.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let s=0;s<=4;s++){const d=this.regionSegments[s];d&&d.destroy()}}}}class Pv{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ln,this.footprintVertices=new dn,this.footprintSegments=[],this.layoutVertexArray=new Hc,this.centroidVertexArray=new Eh,this.indexArray=new ln,this.programConfigurations=new ae(s.layers,s.zoom,d=>iI.includes(d)),this.segments=new Wo,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.groundEffect=new oI(s),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(s,d,f,v){this.features=[],this.hasPattern=zg("fill-extrusion",this.layers,d),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=vr(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:y,id:E,index:M,sourceLayerIndex:k}of s){const R=this.layers[0]._featureFilter.needGeometry,L=ks(y,R);if(!this.layers[0]._featureFilter.filter(new qr(this.zoom),L,f))continue;const V={id:E,sourceLayerIndex:k,index:M,geometry:R?L.geometry:Ks(y,f,v),properties:y.properties,type:y.type,patterns:{}},j=this.layoutVertexArray.length;this.hasPattern?this.features.push(Oh("fill-extrusion",this.layers,V,this.zoom,d)):this.addFeature(V,V.geometry,M,f,{},d.availableImages,v,d.brightness),d.featureIndex.insert(y,V.geometry,M,k,this.index,j)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(s,d,f,v,y,E){for(const M of this.features){const{geometry:k}=M;this.addFeature(M,k,M.index,d,f,v,y,E)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(s,d,f,v,y){const E=0!==Object.keys(s).length;if(E&&!this.stateDependentLayers.length)return;const M=E?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(s,d,M,f,v,y),this.groundEffect.update(s,d,M,f,v,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,_w),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,Lh.members,!0)),this.groundEffect.upload(s)),this.groundEffect.uploadPaintProperties(s),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.groundEffect.uploadHiddenByLandmark(s),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,Ku.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,d,f,v,y,E,M,k){const R=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(s,{})/this.tileToMeter,L=[new mt(0,0),new mt(Nt,Nt)],V=M.projection,j="globe"===V.name,q="Polygon"===tI[s.type],Z=new JC;Z.centroidDataIndex=this.centroidData.length;const J=new QC,ne=this.layers[0].paint.get("fill-extrusion-base").evaluate(s,{},v)<=0,le=this.layers[0].paint.get("fill-extrusion-height").evaluate(s,{},v);J.height=le,J.vertexArrayOffset=this.layoutVertexArray.length,J.groundVertexArrayOffset=this.groundEffect.vertexArray.length,j&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Uf);const xe=kv(d,500);for(let We=xe.length-1;We>=0;We--){const tt=xe[We];(0===tt.length||(Ee=tt[0]).every(ct=>ct.x<=0)||Ee.every(ct=>ct.x>=Nt)||Ee.every(ct=>ct.y<=0)||Ee.every(ct=>ct.y>=Nt))&&xe.splice(We,1)}var Ee;let Te;if(j)Te=mM(xe,L,v);else{Te=[];for(const We of xe)Te.push({polygon:We,bounds:L})}const Le=q?this.edgeRadius:0,ke=Le>0&&this.zoom<17,Be=(We,tt)=>{if(0===We.length)return!1;const ct=We[We.length-1];return tt.x===ct.x&&tt.y===ct.y};for(const{polygon:We,bounds:tt}of Te){let ct=0,it=0;for(const At of We)q&&!At[0].equals(At[At.length-1])&&At.push(At[0]),it+=q?At.length-1:At.length;const xt=this.segments.prepareSegment((q?5:4)*it,this.layoutVertexArray,this.indexArray);J.footprintSegIdx<0&&(J.footprintSegIdx=this.footprintSegments.length),J.polygonSegIdx<0&&(J.polygonSegIdx=this.polygonSegments.length);const Rt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},_t=new cm;if(_t.vertexOffset=this.footprintVertices.length,_t.indexOffset=3*this.footprintIndices.length,_t.ringIndices=[],q){const At=[],ft=[];ct=xt.vertexLength;for(let ii=0;ii<We.length;ii++){const Lt=We[ii];Lt.length&&0!==ii&&ft.push(At.length/2);const Ui=[];let Ti,Ut;Ti=Lt[1].sub(Lt[0])._perp()._unit(),_t.ringIndices.push(Lt.length-1);for(let on=1;on<Lt.length;on++){const Gi=Lt[on],Bi=Lt[on===Lt.length-1?1:on+1],Gt=Gi.clone();if(Le){Ut=Bi.sub(Gi)._perp()._unit();const Qi=Ti.add(Ut)._unit(),Hn=Le*Math.min(4,1/(Ti.x*Qi.x+Ti.y*Qi.y));Gt.x+=Hn*Qi.x,Gt.y+=Hn*Qi.y,Gt.x=Math.round(Gt.x),Gt.y=Math.round(Gt.y),Ti=Ut}!ne||0!==Le&&!ke||Be(Ui,Gt)||Ui.push(Gt),Vy(this.layoutVertexArray,Gt.x,Gt.y,0,0,1,1,0),xt.vertexLength++,this.footprintVertices.emplaceBack(Gi.x,Gi.y),At.push(Gi.x,Gi.y),j&&Md(this.layoutVertexExtArray,V.projectTilePoint(Gt.x,Gt.y,v),V.upVector(v,Gt.x,Gt.y))}ne&&(0===Le||ke)&&(0!==Ui.length&&Be(Ui,Ui[0])&&Ui.pop(),this.groundEffect.addData(Ui,tt,R))}const Dt=Oy(At,ft);for(let ii=0;ii<Dt.length;ii+=3)this.footprintIndices.emplaceBack(_t.vertexOffset+Dt[ii+0],_t.vertexOffset+Dt[ii+1],_t.vertexOffset+Dt[ii+2]),this.indexArray.emplaceBack(ct+Dt[ii],ct+Dt[ii+2],ct+Dt[ii+1]),xt.primitiveLength++;_t.indexCount+=Dt.length,_t.vertexCount+=this.footprintVertices.length-_t.vertexOffset}for(let At=0;At<We.length;At++){const ft=We[At];Z.startRing(J,ft[0]);let Dt=ft.length>4&&uM(ft[ft.length-2],ft[0],ft[1]),ii=Le?mL(ft[ft.length-2],ft[0],ft[1],Le):0;const Lt=[];let Ui,Ti,Ut;Ti=ft[1].sub(ft[0])._perp()._unit();let on=!0;for(let Gi=1,Bi=0;Gi<ft.length;Gi++){let Gt=ft[Gi-1],Qi=ft[Gi];const Hn=ft[Gi===ft.length-1?1:Gi+1];if(Z.appendEdge(J,Qi,Gt),ww(Qi,Gt,tt)){Le&&(Ti=Hn.sub(Qi)._perp()._unit(),on=!on);continue}const hn=Qi.sub(Gt)._perp(),Yn=hn.x/(Math.abs(hn.x)+Math.abs(hn.y)),In=hn.y>0?1:0,xr=Gt.dist(Qi);if(Bi+xr>32768&&(Bi=0),Le){Ut=Hn.sub(Qi)._perp()._unit();let Mr=sI(Gt,Qi,Hn,xw(Ti,Ut),Le);isNaN(Mr)&&(Mr=0);const Er=Qi.sub(Gt)._unit();Gt=Gt.add(Er.mult(ii))._round(),Qi=Qi.add(Er.mult(-Mr))._round(),ii=Mr,Ti=Ut,ne&&this.zoom>=17&&(Be(Lt,Gt)||Lt.push(Gt),Be(Lt,Qi)||Lt.push(Qi))}const Rn=xt.vertexLength,po=ft.length>4&&uM(Gt,Qi,Hn);let Fr=hM(Bi,Dt,on);if(Vy(this.layoutVertexArray,Gt.x,Gt.y,Yn,In,0,0,Fr),Vy(this.layoutVertexArray,Gt.x,Gt.y,Yn,In,0,1,Fr),Bi+=xr,Fr=hM(Bi,po,!on),Dt=po,Vy(this.layoutVertexArray,Qi.x,Qi.y,Yn,In,0,0,Fr),Vy(this.layoutVertexArray,Qi.x,Qi.y,Yn,In,0,1,Fr),xt.vertexLength+=4,this.indexArray.emplaceBack(Rn+0,Rn+1,Rn+2),this.indexArray.emplaceBack(Rn+1,Rn+3,Rn+2),xt.primitiveLength+=2,Le){const Mr=ct+(1===Gi?ft.length-2:Gi-2),Er=1===Gi?ct:Mr+1;if(this.indexArray.emplaceBack(Rn+1,Mr,Rn+3),this.indexArray.emplaceBack(Mr,Er,Rn+3),xt.primitiveLength+=2,void 0===Ui&&(Ui=Rn),!ww(Hn,ft[Gi],tt)){const Gr=Gi===ft.length-1?Ui:xt.vertexLength;this.indexArray.emplaceBack(Rn+2,Rn+3,Gr),this.indexArray.emplaceBack(Rn+3,Gr+1,Gr),this.indexArray.emplaceBack(Rn+3,Er,Gr+1),xt.primitiveLength+=3}on=!on}if(j){const Mr=this.layoutVertexExtArray,Er=V.projectTilePoint(Gt.x,Gt.y,v),Gr=V.projectTilePoint(Qi.x,Qi.y,v),Mo=V.upVector(v,Gt.x,Gt.y),Jr=V.upVector(v,Qi.x,Qi.y);Md(Mr,Er,Mo),Md(Mr,Er,Mo),Md(Mr,Gr,Jr),Md(Mr,Gr,Jr)}}q&&(ct+=ft.length-1),ne&&Le&&this.zoom>=17&&(0!==Lt.length&&Be(Lt,Lt[0])&&Lt.pop(),this.groundEffect.addData(Lt,tt,R,Le>0))}this.footprintSegments.push(_t),Rt.triangleCount=this.indexArray.length-Rt.triangleArrayOffset,this.polygonSegments.push(Rt),++J.footprintSegLen,++J.polygonSegLen}if(J.vertexCount=this.layoutVertexArray.length-J.vertexArrayOffset,J.groundVertexCount=this.groundEffect.vertexArray.length-J.groundVertexArrayOffset,0!==J.vertexCount){if(J.centroidXY=Z.borders?KC:this.encodeCentroid(Z,J),this.centroidData.push(J),Z.borders){this.featuresOnBorder.push(Z);const We=this.featuresOnBorder.length-1;for(let tt=0;tt<Z.borders.length;tt++)Z.borders[tt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[tt].push(We)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,y,E,v,k),this.groundEffect.addPaintPropertiesData(s,f,y,E,v,k),this.maxHeight=Math.max(this.maxHeight,le)}}sortBorders(){for(let s=0;s<this.borderFeatureIndices.length;s++)this.borderFeatureIndices[s].sort((d,f)=>this.featuresOnBorder[d].borders[s][0]-this.featuresOnBorder[f].borders[s][0])}splitToSubtiles(){const s=[];for(let M=0;M<this.centroidData.length;M++){const k=this.centroidData[M],R=+(k.min.y+k.max.y>Nt),L=2*R+(+(k.min.x+k.max.x>Nt)^R);for(let V=0;V<k.polygonSegLen;V++){const j=k.polygonSegIdx+V;s.push({centroidIdx:M,subtile:L,polygonSegmentIdx:j,triangleSegmentIdx:this.polygonSegments[j].triangleSegIdx})}}const d=new ln;s.sort((M,k)=>M.triangleSegmentIdx===k.triangleSegmentIdx?M.subtile-k.subtile:M.triangleSegmentIdx-k.triangleSegmentIdx);let f=0,v=0,y=0;for(const M of s){if(M.triangleSegmentIdx!==f)break;y++}const E=s.length;for(;v!==s.length;){f=s[v].triangleSegmentIdx;let M=0,k=v,R=v;for(let L=k;L<y&&s[L].subtile===M;L++)R++;for(;k!==y;){const L=s[k];M=L.subtile;const V=this.centroidData[L.centroidIdx].min.clone(),j=this.centroidData[L.centroidIdx].max.clone(),q={vertexOffset:this.segments.segments[f].vertexOffset,primitiveOffset:d.length,vertexLength:this.segments.segments[f].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let Z=k;Z<R;Z++){const J=s[Z],ne=this.polygonSegments[J.polygonSegmentIdx],le=this.centroidData[J.centroidIdx].min,xe=this.centroidData[J.centroidIdx].max,Ee=this.indexArray.uint16;for(let Te=ne.triangleArrayOffset;Te<ne.triangleArrayOffset+ne.triangleCount;Te++)d.emplaceBack(Ee[3*Te],Ee[3*Te+1],Ee[3*Te+2]);q.primitiveLength+=ne.triangleCount,V.x=Math.min(V.x,le.x),V.y=Math.min(V.y,le.y),j.x=Math.max(j.x,xe.x),j.y=Math.max(j.y,xe.y)}q.primitiveLength>0&&this.triangleSubSegments.push({segment:q,min:V,max:j}),k=R;for(let Z=k;Z<y&&s[Z].subtile===s[k].subtile;Z++)R++}v=y;for(let L=v;L<E&&s[L].triangleSegmentIdx===s[v].triangleSegmentIdx;L++)y++}d._trim(),this.indexArray=d}getVisibleSegments(s,d,f){let v=0,y=0;const E=1<<s.canonical.z;if(d){const J=d.getMinMaxForTile(s);J&&(v=J.min,y=J.max)}y+=this.maxHeight;const M=s.toUnwrapped();let k;const R=[M.canonical.x/E+M.wrap,M.canonical.y/E],L=[(M.canonical.x+1)/E+M.wrap,(M.canonical.y+1)/E],V=new Wo,j=(J,ne,le)=>[J[0]*(1-le[0])+ne[0]*le[0],J[1]*(1-le[1])+ne[1]*le[1]],q=[],Z=[];for(const J of this.triangleSubSegments){q[0]=J.min.x/Nt,q[1]=J.min.y/Nt,Z[0]=J.max.x/Nt,Z[1]=J.max.y/Nt;const ne=j(R,L,q),le=j(R,L,Z);if(0===new ss([ne[0],ne[1],v],[le[0],le[1],y]).intersectsPrecise(f)){k&&(V.segments.push(k),k=void 0);continue}const xe=J.segment;k&&k.vertexOffset!==xe.vertexOffset&&(V.segments.push(k),k=void 0),k?(k.vertexLength+=xe.vertexLength,k.primitiveLength+=xe.primitiveLength):k={vertexOffset:xe.vertexOffset,primitiveLength:xe.primitiveLength,vertexLength:xe.vertexLength,primitiveOffset:xe.primitiveOffset,sortKey:void 0,vaos:{}}}return k&&V.segments.push(k),V}encodeCentroid(s,d){const f=s.centroid(),v=d.span(),y=Math.min(7,Math.round(v.x*this.tileToMeter/10)),E=Math.min(7,Math.round(v.y*this.tileToMeter/10));return new mt(Ii(f.x,1,Nt-1)<<3|y,Ii(f.y,1,Nt-1)<<3|E)}encodeBorderCentroid(s){if(!s.borders)return new mt(0,0);const d=s.borders,f=Number.MAX_VALUE;if(d[0][0]!==f||d[1][0]!==f){const v=d[0][0]!==f?0:1;return new mt(6|(d[0][0]!==f?0:65528),(d[v][0]+d[v][1])/2<<3|6)}{const v=d[2][0]!==f?2:3;return new mt((d[v][0]+d[v][1])/2<<3|6,6|(d[2][0]!==f?0:65528))}}showCentroid(s){const d=this.centroidData[s.centroidDataIndex];d.flags&=Ap,d.centroidXY.x=0,d.centroidXY.y=0,this.writeCentroidToBuffer(d)}writeCentroidToBuffer(s){this.groundEffect.updateHiddenByLandmark(s);const d=s.vertexArrayOffset,f=s.vertexCount+s.vertexArrayOffset,v=s.flags&Ap?KC:s.centroidXY,y=this.centroidVertexArray.geta_centroid_pos0(d);if(this.centroidVertexArray.geta_centroid_pos1(d)!==v.y||y!==v.x){for(let E=d;E<f;++E)this.centroidVertexArray.emplace(E,v.x,v.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const s of this.centroidData)this.writeCentroidToBuffer(s)}updateReplacement(s,d){if(d.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=d.updateTime;const f=d.getReplacementRegionsForTile(s.toUnwrapped());if(function(y,E){if(y.length!==E.length)return!1;for(let M=0;M<y.length;M++)if(y[M].sourceId!==E[M].sourceId||!sM(y[M],E[M]))return!1;return!0}(this.activeReplacements,f))return;if(this.activeReplacements=f,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const y of this.centroidData)y.flags&=2147483647;const v=[];for(const y of this.activeReplacements){const E=Math.pow(2,y.footprintTileId.canonical.z-s.canonical.z);for(const M of this.centroidData)if(!(M.flags&Ap||y.min.x>M.max.x||M.min.x>y.max.x||y.min.y>M.max.y||M.min.y>y.max.y))for(let k=0;k<M.footprintSegLen;k++){const R=this.footprintSegments[M.footprintSegIdx+k];if(v.length=0,pM(this.footprintVertices,R.vertexOffset,R.vertexCount,y.footprintTileId.canonical,s.canonical,v),Sp(y.footprint,v,this.footprintIndices.uint16,R.indexOffset,R.indexCount,-R.vertexOffset,-E)){M.flags|=Ap;break}}}for(const y of this.centroidData)this.writeCentroidToBuffer(y);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(s,d,f){let v=!1;for(let y=0;y<f.footprintSegLen;y++){const E=this.footprintSegments[f.footprintSegIdx+y];let M=0;for(const k of E.ringIndices){for(let R=M,L=k+M-1;R<k+M;L=R++){const V=this.footprintVertices.int16[2*(R+E.vertexOffset)+0],j=this.footprintVertices.int16[2*(R+E.vertexOffset)+1],q=this.footprintVertices.int16[2*(L+E.vertexOffset)+1];j>d!=q>d&&s<(this.footprintVertices.int16[2*(L+E.vertexOffset)+0]-V)*(d-j)/(q-j)+V&&(v=!v)}M=k}}return v}getHeightAtTileCoord(s,d){let f=Number.NEGATIVE_INFINITY,v=!0;const y=4*(s+Nt)*Nt+(d+Nt);if(this.partLookup.hasOwnProperty(y)){const E=this.partLookup[y];return E?{height:E.height,hidden:!!(E.flags&Ap)}:void 0}for(const E of this.centroidData)s>E.max.x||E.min.x>s||d>E.max.y||E.min.y>d||this.footprintContainsPoint(s,d,E)&&E&&E.height>f&&(f=E.height,this.partLookup[y]=E,v=!!(E.flags&Ap));if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:v};this.partLookup[y]=void 0}}function xw(a,s){const d=a.add(s)._unit();return a.x*d.x+a.y*d.y}function mL(a,s,d,f){const v=s.sub(a)._perp()._unit(),y=d.sub(s)._perp()._unit();return sI(a,s,d,xw(v,y),f)}function sI(a,s,d,f,v){const y=Math.sqrt(1-f*f);return Math.min(a.dist(s)/3,s.dist(d)/3,v*y/f)}function ww(a,s,d){return a.x<d[0].x&&s.x<d[0].x||a.x>d[1].x&&s.x>d[1].x||a.y<d[0].y&&s.y<d[0].y||a.y>d[1].y&&s.y>d[1].y}function dM(a,s){return a.x<s[0].x||a.x>s[1].x||a.y<s[0].y||a.y>s[1].y}function uM(a,s,d){if(a.x<0||a.x>=Nt||s.x<0||s.x>=Nt||d.x<0||d.x>=Nt)return!1;const f=d.sub(s),v=f.perp(),y=a.sub(s);return(f.x*y.x+f.y*y.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(y.x*y.x+y.y*y.y))>-.866&&v.x*y.x+v.y*y.y<0}function hM(a,s,d){const f=s?2|a:-3&a;return d?1|f:-2&f}function fM(){const a=Math.PI/32,s=Math.tan(a),d=pt;return d*Math.sqrt(1+2*s*s)-d}function mM(a,s,d){const f=1<<d.z,v=Dn(d.x/f),y=Dn((d.x+1)/f),E=fr(d.y/f),M=fr((d.y+1)/f);return function(k,R,L,V,j=0,q){const Z=[];if(!k.length||!L||!V)return Z;const J=(ke,Be)=>{for(const We of ke)Z.push({polygon:We,bounds:Be})},ne=Math.ceil(Math.log2(L)),le=Math.ceil(Math.log2(V)),xe=ne-le,Ee=[];for(let ke=0;ke<Math.abs(xe);ke++)Ee.push(xe>0?0:1);for(let ke=0;ke<Math.min(ne,le);ke++)Ee.push(0),Ee.push(1);let Te=k;if(Te=Hg(Te,R[0].y-j,R[1].y+j,1),Te=Hg(Te,R[0].x-j,R[1].x+j,0),!Te.length)return Z;const Le=[];for(Ee.length?Le.push({polygons:Te,bounds:R,depth:0}):J(Te,R);Le.length;){const ke=Le.pop(),Be=ke.depth,We=Ee[Be],tt=ke.bounds[0],ct=ke.bounds[1],it=0===We?tt.x:tt.y,xt=0===We?ct.x:ct.y,Rt=q?q(We,it,xt):.5*(it+xt),_t=Hg(ke.polygons,it-j,Rt+j,We),At=Hg(ke.polygons,Rt-j,xt+j,We);if(_t.length){const ft=[tt,new mt(0===We?Rt:ct.x,1===We?Rt:ct.y)];Ee.length>Be+1?Le.push({polygons:_t,bounds:ft,depth:Be+1}):J(_t,ft)}if(At.length){const ft=[new mt(0===We?Rt:tt.x,1===We?Rt:tt.y),ct];Ee.length>Be+1?Le.push({polygons:At,bounds:ft,depth:Be+1}):J(At,ft)}}return Z}(a,s,Math.ceil((y-v)/11.25),Math.ceil((E-M)/11.25),1,(k,R,L)=>{if(0===k)return.5*(R+L);{const V=fr((d.y+R/Nt)/f);return(bn(.5*(fr((d.y+L/Nt)/f)+V))*f-d.y)*Nt}})}function pM(a,s,d,f,v,y){const E=Math.pow(2,f.z-v.z);for(let M=0;M<d;M++){let k=a.int16[2*(M+s)+0],R=a.int16[2*(M+s)+1];k=(k+v.x*Nt)*E-f.x*Nt,R=(R+v.y*Nt)*E-f.y*Nt,y.push(new mt(k,R))}}Oi(Pv,"FillExtrusionBucket",{omit:["layers","features"]}),Oi(QC,"PartData"),Oi(cm,"FootprintSegment"),Oi(JC,"BorderCentroidData"),Oi(oI,"GroundEffect");const gM=new $o({visibility:new ni(ot["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new ni(ot["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var aI={paint:new $o({"fill-extrusion-opacity":new ni(ot["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ji(ot["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ni(ot["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ni(ot["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ji(ot["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ji(ot["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ji(ot["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ni(ot["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ni(ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ni(ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new ni(ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new ni(ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new ni(ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new ni(ot["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new ni(ot["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Ji(ot["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Ji(ot["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new ni(ot["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new ni(ot["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new ni(ot["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new ni(ot["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new ni(ot["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:gM};class Ov extends mt{constructor(s,d,f){super(s,d),this.z=f}}function Lv(a,s){return a.x*s.x+a.y*s.y}function zy(a,s){if(1===a.length){let d=0;const f=s[d++];let v;for(;!v||f.equals(v);)if(v=s[d++],!v)return 1/0;for(;d<s.length;d++){const y=s[d],E=a[0],M=v.sub(f),k=y.sub(f),R=E.sub(f),L=Lv(M,M),V=Lv(M,k),j=Lv(k,k),q=Lv(R,M),Z=Lv(R,k),J=L*j-V*V,ne=(j*q-V*Z)/J,le=(L*Z-V*q)/J,xe=f.z*(1-ne-le)+v.z*ne+y.z*le;if(isFinite(xe))return xe}return 1/0}{let d=1/0;for(const f of s)d=Math.min(d,f.z);return d}}function tE(a,s,d,f,v,y,E,M){const k=E*v.getElevationAt(a,s,!0,!0),R=0!==y[0],L=R?0===y[1]?E*(y[0]/7-450):E*function(V,j,q){const Z=Math.floor(j[0]/8),J=Math.floor(j[1]/8),ne=10*(j[0]-8*Z),le=10*(j[1]-8*J),xe=V.getElevationAt(Z,J,!0,!0),Ee=V.getMeterToDEM(q),Te=Math.floor(.5*(ne*Ee-1)),Le=Math.floor(.5*(le*Ee-1)),ke=V.tileCoordToPixel(Z,J),Be=2*Te+1,We=2*Le+1,tt=(ii=Be,Lt=We,[(At=V).getElevationAtPixel(ft=ke.x-Te,Dt=ke.y-Le,!0),At.getElevationAtPixel(ft+Lt,Dt,!0),At.getElevationAtPixel(ft,Dt+Lt,!0),At.getElevationAtPixel(ft+ii,Dt+Lt,!0)]),ct=Math.abs(tt[0]-tt[1]),it=Math.abs(tt[2]-tt[3]),xt=Math.abs(tt[0]-tt[2])+Math.abs(tt[1]-tt[3]),Rt=Math.min(.25,.5*Ee*(ct+it)/Be),_t=Math.min(.25,.5*Ee*xt/We);var At,ft,Dt,ii,Lt;return xe+Math.max(Rt*ne,_t*le)}(v,y,M):k;return{base:k+(0===d)?-1:d,top:R?Math.max(L+f,k+d+2):k+f}}const iE=Ir([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:_M}=iE,Dp=Ir([{name:"a_packed",components:4,type:"Float32"}]),{members:lI}=Dp;class vM{constructor(s,d){this.width=s,this.height=d,this.nextRow=0,this.image=new Zu({width:s,height:d}),this.positions={},this.uploaded=!1}getDash(s,d){const f=this.getKey(s,d);return this.positions[f]}trim(){const s=this.width,d=this.height=ta(this.nextRow);this.image.resize({width:s,height:d})}getKey(s,d){return s.join(",")+d}getDashRanges(s,d,f){const v=[];let y=s.length%2==1?-s[s.length-1]*f:0,E=s[0]*f,M=!0;v.push({left:y,right:E,isDash:M,zeroLength:0===s[0]});let k=s[0];for(let R=1;R<s.length;R++){M=!M;const L=s[R];y=k*f,k+=L,E=k*f,v.push({left:y,right:E,isDash:M,zeroLength:0===L})}return v}addRoundDash(s,d,f){const v=d/2;for(let y=-f;y<=f;y++){const E=this.width*(this.nextRow+f+y);let M=0,k=s[M];for(let R=0;R<this.width;R++){R/k.right>1&&(k=s[++M]);const L=Math.abs(R-k.left),V=Math.abs(R-k.right),j=Math.min(L,V);let q;const Z=y/f*(v+1);if(k.isDash){const J=v-Math.abs(Z);q=Math.sqrt(j*j+J*J)}else q=v-Math.sqrt(j*j+Z*Z);this.image.data[E+R]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(s,d){for(let k=s.length-1;k>=0;--k){const R=s[k],L=s[k+1];R.zeroLength?s.splice(k,1):L&&L.isDash===R.isDash&&(L.left=R.left,s.splice(k,1))}const f=s[0],v=s[s.length-1];f.isDash===v.isDash&&(f.left=v.left-this.width,v.right=f.right+this.width);const y=this.width*this.nextRow;let E=0,M=s[E];for(let k=0;k<this.width;k++){k/M.right>1&&(M=s[++E]);const R=Math.abs(k-M.left),L=Math.abs(k-M.right),V=Math.min(R,L);this.image.data[y+k]=Math.max(0,Math.min(255,(M.isDash?V:-V)+d+128))}}addDash(s,d){const f=this.getKey(s,d);if(this.positions[f])return this.positions[f];const v="round"===d,y=v?7:0,E=2*y+1;if(this.nextRow+E>this.height)return Qe("LineAtlas out of space"),null;0===s.length&&s.push(1);let M=0;for(let L=0;L<s.length;L++)s[L]<0&&(Qe("Negative value is found in line dasharray, replacing values with 0"),s[L]=0),M+=s[L];if(0!==M){const L=this.width/M,V=this.getDashRanges(s,this.width,L);v?this.addRoundDash(V,L,y):this.addRegularDash(V,"square"===d?.5*L:0)}const k=this.nextRow+y;this.nextRow+=E;const R={tl:[k,y],br:[M,0]};return this.positions[f]=R,R}}Oi(vM,"LineAtlas");const nE=Ep.types,bM=Math.cos(Math.PI/180*37.5);class rE{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(d=>{this.gradients[d.id]={}}),this.layoutVertexArray=new Dg,this.layoutVertexArray2=new Fu,this.indexArray=new ln,this.programConfigurations=new ae(s.layers,s.zoom),this.segments=new Wo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(s,d,f,v){this.hasPattern=zg("line",this.layers,d);const y=this.layers[0].layout.get("line-sort-key"),E=[];for(const{feature:L,id:V,index:j,sourceLayerIndex:q}of s){const Z=this.layers[0]._featureFilter.needGeometry,J=ks(L,Z);if(!this.layers[0]._featureFilter.filter(new qr(this.zoom),J,f))continue;const ne=y?y.evaluate(J,{},f):void 0,le={id:V,properties:L.properties,type:L.type,sourceLayerIndex:q,index:j,geometry:Z?J.geometry:Ks(L,f,v),patterns:{},sortKey:ne};E.push(le)}y&&E.sort((L,V)=>L.sortKey-V.sortKey);const{lineAtlas:M,featureIndex:k}=d,R=this.addConstantDashes(M);for(const L of E){const{geometry:V,index:j,sourceLayerIndex:q}=L;if(R&&this.addFeatureDashes(L,M),this.hasPattern){const Z=Oh("line",this.layers,L,this.zoom,d);this.patternFeatures.push(Z)}else this.addFeature(L,V,j,f,M.positions,d.availableImages,d.brightness);k.insert(s[j].feature,V,j,q,this.index)}}addConstantDashes(s){let d=!1;for(const f of this.layers){const v=f.paint.get("line-dasharray").value,y=f.layout.get("line-cap").value;if("constant"!==v.kind||"constant"!==y.kind)d=!0;else{const E=y.value,M=v.value;if(!M)continue;s.addDash(M,E)}}return d}addFeatureDashes(s,d){const f=this.zoom;for(const v of this.layers){const y=v.paint.get("line-dasharray").value,E=v.layout.get("line-cap").value;if("constant"===y.kind&&"constant"===E.kind)continue;let M,k;if("constant"===y.kind){if(M=y.value,!M)continue}else M=y.evaluate({zoom:f},s);k="constant"===E.kind?E.value:E.evaluate({zoom:f},s),d.addDash(M,k),s.patterns[v.id]=d.getKey(M,k)}}update(s,d,f,v,y){const E=0!==Object.keys(s).length;E&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(s,d,E?this.stateDependentLayers:this.layers,f,v,y)}addFeatures(s,d,f,v,y,E){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,d,f,v,E)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,lI)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,_M),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,d,f,v,y,E,M){const k=this.layers[0].layout,R=k.get("line-join").evaluate(s,{}),L=k.get("line-cap").evaluate(s,{}),V=k.get("line-miter-limit"),j=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const q of d)this.addLine(q,s,R,L,V,j);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,y,E,v,M)}addLine(s,d,f,v,y,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<s.length-1;le++)this.totalDistance+=s[le].dist(s[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M="Polygon"===nE[d.type];let k=s.length;for(;k>=2&&s[k-1].equals(s[k-2]);)k--;let R=0;for(;R<k-1&&s[R].equals(s[R+1]);)R++;if(k<(M?3:2))return;"bevel"===f&&(y=1.05);const L=this.overscaling<=16?15*Nt/(512*this.overscaling):0,V=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let j,q,Z,J,ne;this.e1=this.e2=-1,M&&(j=s[k-2],ne=s[R].sub(j)._unit()._perp());for(let le=R;le<k;le++){if(Z=le===k-1?M?s[R+1]:void 0:s[le+1],Z&&s[le].equals(Z))continue;ne&&(J=ne),j&&(q=j),j=s[le],ne=Z?Z.sub(j)._unit()._perp():J,J=J||ne;let xe=J.add(ne);0===xe.x&&0===xe.y||xe._unit();const Ee=J.x*ne.x+J.y*ne.y,Te=xe.x*ne.x+xe.y*ne.y,Le=0!==Te?1/Te:1/0,ke=2*Math.sqrt(2-2*Te),Be=Te<bM&&q&&Z,We=J.x*ne.y-J.y*ne.x>0;if(Be&&le>R){const it=j.dist(q);if(it>2*L){const xt=j.sub(j.sub(q)._mult(L/it)._round());this.updateDistance(q,xt),this.addCurrentVertex(xt,J,0,0,V),q=xt}}const tt=q&&Z;let ct=tt?f:M?"butt":v;if(tt&&"round"===ct&&(Le<E?ct="miter":Le<=2&&(ct="fakeround")),"miter"===ct&&Le>y&&(ct="bevel"),"bevel"===ct&&(Le>2&&(ct="flipbevel"),Le<y&&(ct="miter")),q&&this.updateDistance(q,j),"miter"===ct)xe._mult(Le),this.addCurrentVertex(j,xe,0,0,V);else if("flipbevel"===ct){if(Le>100)xe=ne.mult(-1);else{const it=Le*J.add(ne).mag()/J.sub(ne).mag();xe._perp()._mult(it*(We?-1:1))}this.addCurrentVertex(j,xe,0,0,V),this.addCurrentVertex(j,xe.mult(-1),0,0,V)}else if("bevel"===ct||"fakeround"===ct){const it=-Math.sqrt(Le*Le-1),xt=We?it:0,Rt=We?0:it;if(q&&this.addCurrentVertex(j,J,xt,Rt,V),"fakeround"===ct){const _t=Math.round(180*ke/Math.PI/20);for(let At=1;At<_t;At++){let ft=At/_t;if(.5!==ft){const ii=ft-.5;ft+=ft*ii*(ft-1)*((1.0904+Ee*(Ee*(3.55645-1.43519*Ee)-3.2452))*ii*ii+(.848013+Ee*(.215638*Ee-1.06021)))}const Dt=ne.sub(J)._mult(ft)._add(J)._unit()._mult(We?-1:1);this.addHalfVertex(j,Dt.x,Dt.y,!1,We,0,V)}}Z&&this.addCurrentVertex(j,ne,-xt,-Rt,V)}else if("butt"===ct)this.addCurrentVertex(j,xe,0,0,V);else if("square"===ct){const it=q?1:-1;q||this.addCurrentVertex(j,xe,it,it,V),this.addCurrentVertex(j,xe,0,0,V),q&&this.addCurrentVertex(j,xe,it,it,V)}else"round"===ct&&(q&&(this.addCurrentVertex(j,J,0,0,V),this.addCurrentVertex(j,J,1,1,V,!0)),Z&&(this.addCurrentVertex(j,ne,-1,-1,V,!0),this.addCurrentVertex(j,ne,0,0,V)));if(Be&&le<k-1){const it=j.dist(Z);if(it>2*L){const xt=j.add(Z.sub(j)._mult(L/it)._round());this.updateDistance(j,xt),this.addCurrentVertex(xt,ne,0,0,V),j=xt}}}}addCurrentVertex(s,d,f,v,y,E=!1){const M=d.y*v-d.x,k=-d.y-d.x*v;this.addHalfVertex(s,d.x+d.y*f,d.y-d.x*f,E,!1,f,y),this.addHalfVertex(s,M,k,E,!0,-v,y)}addHalfVertex({x:s,y:d},f,v,y,E,M,k){this.layoutVertexArray.emplaceBack((s<<1)+(y?1:0),(d<<1)+(E?1:0),Math.round(63*f)+128,Math.round(63*v)+128,1+(0===M?0:M<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const R=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),k.primitiveLength++),E?this.e2=R:this.e1=R}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,d){this.distance+=s.dist(d),this.updateScaledDistance()}}Oi(rE,"LineBucket",{omit:["layers","patternFeatures"]});const cI=new $o({"line-cap":new Ji(ot.layout_line["line-cap"]),"line-join":new Ji(ot.layout_line["line-join"]),"line-miter-limit":new ni(ot.layout_line["line-miter-limit"]),"line-round-limit":new ni(ot.layout_line["line-round-limit"]),"line-sort-key":new Ji(ot.layout_line["line-sort-key"]),visibility:new ni(ot.layout_line.visibility)});var yM={paint:new $o({"line-opacity":new Ji(ot.paint_line["line-opacity"]),"line-color":new Ji(ot.paint_line["line-color"]),"line-translate":new ni(ot.paint_line["line-translate"]),"line-translate-anchor":new ni(ot.paint_line["line-translate-anchor"]),"line-width":new Ji(ot.paint_line["line-width"]),"line-gap-width":new Ji(ot.paint_line["line-gap-width"]),"line-offset":new Ji(ot.paint_line["line-offset"]),"line-blur":new Ji(ot.paint_line["line-blur"]),"line-dasharray":new Ji(ot.paint_line["line-dasharray"]),"line-pattern":new Ji(ot.paint_line["line-pattern"]),"line-gradient":new op(ot.paint_line["line-gradient"]),"line-trim-offset":new ni(ot.paint_line["line-trim-offset"]),"line-emissive-strength":new ni(ot.paint_line["line-emissive-strength"]),"line-border-width":new Ji(ot.paint_line["line-border-width"]),"line-border-color":new Ji(ot.paint_line["line-border-color"])}),layout:cI};function xM(a,s,d){return s*(Nt/(a.tileSize*Math.pow(2,d-a.tileID.overscaledZ)))}function oE(a,s){return 1/xM(a,1,s.tileZoom)}function dI(a,s,d,f){return a.translatePosMatrix(f||s.tileID.projMatrix,s,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const uI=a=>{const s=[];Fv(a)&&s.push("RENDER_LINE_DASH"),a.paint.get("line-gradient")&&s.push("RENDER_LINE_GRADIENT");const d=a.paint.get("line-trim-offset");return 0===d[0]&&0===d[1]||s.push("RENDER_LINE_TRIM_OFFSET"),0!==a.paint.get("line-border-width").constantOr(1)&&s.push("RENDER_LINE_BORDER"),s};function Fv(a){const s=a.paint.get("line-dasharray").value;return s.value||"constant"!==s.kind}const wM=new class extends Ji{possiblyEvaluate(a,s){return s=new qr(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(a,s)}evaluate(a,s,d,f){return s=Hr({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(a,s,d,f)}}(yM.paint.properties["line-width"].specification);function CM(a,s){return s>0?s+2*a:a}wM.useIntegerZoom=!0;const hI=Ir([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),EM=Ir([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),fI=Ir([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ir([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const mI=Ir([{name:"a_z_offset",components:1,type:"Float32"}],4),pI=Ir([{name:"a_texb",components:2,type:"Uint16"}]),gI=Ir([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),_I=Ir([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Ir([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const TM=Ir([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),sE=Ir([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ir([{name:"triangle",components:3,type:"Uint16"}]),Ir([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ir([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Ir([{type:"Float32",name:"offsetX"}]),Ir([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var al=24;const Vh=128;function Uy(a,s){const{expression:d}=s;if("constant"===d.kind)return{kind:"constant",layoutSize:d.evaluate(new qr(a+1))};if("source"===d.kind)return{kind:"source"};{const{zoomStops:f,interpolationType:v}=d;let y=0;for(;y<f.length&&f[y]<=a;)y++;y=Math.max(0,y-1);let E=y;for(;E<f.length&&f[E]<a+1;)E++;E=Math.min(f.length-1,E);const M=f[y],k=f[E];return"composite"===d.kind?{kind:"composite",minZoom:M,maxZoom:k,interpolationType:v}:{kind:"camera",minZoom:M,maxZoom:k,minSize:d.evaluate(new qr(M)),maxSize:d.evaluate(new qr(k)),interpolationType:v}}}function aE(a,{uSize:s,uSizeT:d},{lowerSize:f,upperSize:v}){return"source"===a.kind?f/Vh:"composite"===a.kind?rr(f/Vh,v/Vh,d):s}function jy(a,s){let d=0,f=0;if("constant"===a.kind)f=a.layoutSize;else if("source"!==a.kind){const{interpolationType:v,minZoom:y,maxZoom:E}=a,M=v?Ii(Cr.interpolationFactor(v,s,y,E),0,1):0;"camera"===a.kind?f=rr(a.minSize,a.maxSize,M):d=M}return{uSizeT:d,uSize:f}}var pL=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Vh,evaluateSizeForFeature:aE,evaluateSizeForZoom:jy,getSizeData:Uy});function gL(a,s,d){return a.sections.forEach(f=>{f.text=function(v,y,E){const M=y.layout.get("text-transform").evaluate(E,{});return"uppercase"===M?v=v.toLocaleUpperCase():"lowercase"===M&&(v=v.toLocaleLowerCase()),na.applyArabicShaping&&(v=na.applyArabicShaping(v)),v}(f.text,s,d)}),a}const Cw={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function vI(a){return"\ufe36"===a||"\ufe48"===a||"\ufe38"===a||"\ufe44"===a||"\ufe42"===a||"\ufe3e"===a||"\ufe3c"===a||"\ufe3a"===a||"\ufe18"===a||"\ufe40"===a||"\ufe10"===a||"\ufe13"===a||"\ufe14"===a||"\uff40"===a||"\uffe3"===a||"\ufe11"===a||"\ufe12"===a}function Ew(a){return"\ufe35"===a||"\ufe47"===a||"\ufe37"===a||"\ufe43"===a||"\ufe41"===a||"\ufe3d"===a||"\ufe3b"===a||"\ufe39"===a||"\ufe17"===a||"\ufe3f"===a}var Tw={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(a,s,d,f,v){var y,E,M=8*v-f-1,k=(1<<M)-1,R=k>>1,L=-7,V=d?v-1:0,j=d?-1:1,q=a[s+V];for(V+=j,y=q&(1<<-L)-1,q>>=-L,L+=M;L>0;y=256*y+a[s+V],V+=j,L-=8);for(E=y&(1<<-L)-1,y>>=-L,L+=f;L>0;E=256*E+a[s+V],V+=j,L-=8);if(0===y)y=1-R;else{if(y===k)return E?NaN:1/0*(q?-1:1);E+=Math.pow(2,f),y-=R}return(q?-1:1)*E*Math.pow(2,y-f)},write:function(a,s,d,f,v,y){var E,M,k,R=8*y-v-1,L=(1<<R)-1,V=L>>1,j=23===v?Math.pow(2,-24)-Math.pow(2,-77):0,q=f?0:y-1,Z=f?1:-1,J=s<0||0===s&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(M=isNaN(s)?1:0,E=L):(E=Math.floor(Math.log(s)/Math.LN2),s*(k=Math.pow(2,-E))<1&&(E--,k*=2),(s+=E+V>=1?j/k:j*Math.pow(2,1-V))*k>=2&&(E++,k/=2),E+V>=L?(M=0,E=L):E+V>=1?(M=(s*k-1)*Math.pow(2,v),E+=V):(M=s*Math.pow(2,V-1)*Math.pow(2,v),E=0));v>=8;a[d+q]=255&M,q+=Z,M/=256,v-=8);for(E=E<<v|M,R+=v;R>0;a[d+q]=255&E,q+=Z,E/=256,R-=8);a[d+q-Z]|=128*J}},Sw=Xo,Gy=Tw;function Xo(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Xo.Varint=0,Xo.Fixed64=1,Xo.Bytes=2,Xo.Fixed32=5;var Mw=4294967296,SM=1/Mw,lE=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Zc(a){return a.type===Xo.Bytes?a.readVarint()+a.pos:a.pos+1}function wc(a,s,d){var f=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));d.realloc(f);for(var v=d.pos-1;v>=a;v--)d.buf[v+f]=d.buf[v]}function MM(a,s){for(var d=0;d<a.length;d++)s.writeVarint(a[d])}function _L(a,s){for(var d=0;d<a.length;d++)s.writeSVarint(a[d])}function bI(a,s){for(var d=0;d<a.length;d++)s.writeFloat(a[d])}function vL(a,s){for(var d=0;d<a.length;d++)s.writeDouble(a[d])}function bL(a,s){for(var d=0;d<a.length;d++)s.writeBoolean(a[d])}function AM(a,s){for(var d=0;d<a.length;d++)s.writeFixed32(a[d])}function DM(a,s){for(var d=0;d<a.length;d++)s.writeSFixed32(a[d])}function yL(a,s){for(var d=0;d<a.length;d++)s.writeFixed64(a[d])}function Aw(a,s){for(var d=0;d<a.length;d++)s.writeSFixed64(a[d])}function Nv(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+16777216*a[s+3]}function dm(a,s,d){a[d]=s,a[d+1]=s>>>8,a[d+2]=s>>>16,a[d+3]=s>>>24}function oa(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+(a[s+3]<<24)}Xo.prototype={destroy:function(){this.buf=null},readFields:function(a,s,d){for(d=d||this.length;this.pos<d;){var f=this.readVarint(),v=f>>3,y=this.pos;this.type=7&f,a(v,s,this),this.pos===y&&this.skip(f)}return s},readMessage:function(a,s){return this.readFields(a,s,this.readVarint()+this.pos)},readFixed32:function(){var a=Nv(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=oa(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=Nv(this.buf,this.pos)+Nv(this.buf,this.pos+4)*Mw;return this.pos+=8,a},readSFixed64:function(){var a=Nv(this.buf,this.pos)+oa(this.buf,this.pos+4)*Mw;return this.pos+=8,a},readFloat:function(){var a=Gy.read(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Gy.read(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var s,d,f=this.buf;return s=127&(d=f[this.pos++]),d<128?s:(s|=(127&(d=f[this.pos++]))<<7,d<128?s:(s|=(127&(d=f[this.pos++]))<<14,d<128?s:(s|=(127&(d=f[this.pos++]))<<21,d<128?s:function(v,y,E){var M,k,R=E.buf;if(M=(112&(k=R[E.pos++]))>>4,k<128||(M|=(127&(k=R[E.pos++]))<<3,k<128)||(M|=(127&(k=R[E.pos++]))<<10,k<128)||(M|=(127&(k=R[E.pos++]))<<17,k<128)||(M|=(127&(k=R[E.pos++]))<<24,k<128)||(M|=(1&(k=R[E.pos++]))<<31,k<128))return function ll(a,s,d){return d?4294967296*s+(a>>>0):4294967296*(s>>>0)+(a>>>0)}(v,M,y);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(d=f[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,s=this.pos;return this.pos=a,a-s>=12&&lE?lE.decode(this.buf.subarray(s,a)):function(d,f,v){for(var y="",E=f;E<v;){var M,k,R,L=d[E],V=null,j=L>239?4:L>223?3:L>191?2:1;if(E+j>v)break;1===j?L<128&&(V=L):2===j?128==(192&(M=d[E+1]))&&(V=(31&L)<<6|63&M)<=127&&(V=null):3===j?(k=d[E+2],128==(192&(M=d[E+1]))&&128==(192&k)&&((V=(15&L)<<12|(63&M)<<6|63&k)<=2047||V>=55296&&V<=57343)&&(V=null)):4===j&&(k=d[E+2],R=d[E+3],128==(192&(M=d[E+1]))&&128==(192&k)&&128==(192&R)&&((V=(15&L)<<18|(63&M)<<12|(63&k)<<6|63&R)<=65535||V>=1114112)&&(V=null)),null===V?(V=65533,j=1):V>65535&&(V-=65536,y+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),y+=String.fromCharCode(V),E+=j}return y}(this.buf,s,a)},readBytes:function(){var a=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,a);return this.pos=a,s},readPackedVarint:function(a,s){if(this.type!==Xo.Bytes)return a.push(this.readVarint(s));var d=Zc(this);for(a=a||[];this.pos<d;)a.push(this.readVarint(s));return a},readPackedSVarint:function(a){if(this.type!==Xo.Bytes)return a.push(this.readSVarint());var s=Zc(this);for(a=a||[];this.pos<s;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Xo.Bytes)return a.push(this.readBoolean());var s=Zc(this);for(a=a||[];this.pos<s;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Xo.Bytes)return a.push(this.readFloat());var s=Zc(this);for(a=a||[];this.pos<s;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Xo.Bytes)return a.push(this.readDouble());var s=Zc(this);for(a=a||[];this.pos<s;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Xo.Bytes)return a.push(this.readFixed32());var s=Zc(this);for(a=a||[];this.pos<s;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Xo.Bytes)return a.push(this.readSFixed32());var s=Zc(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Xo.Bytes)return a.push(this.readFixed64());var s=Zc(this);for(a=a||[];this.pos<s;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Xo.Bytes)return a.push(this.readSFixed64());var s=Zc(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed64());return a},skip:function(a){var s=7&a;if(s===Xo.Varint)for(;this.buf[this.pos++]>127;);else if(s===Xo.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Xo.Fixed32)this.pos+=4;else{if(s!==Xo.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(a,s){this.writeVarint(a<<3|s)},realloc:function(a){for(var s=this.length||16;s<this.pos+a;)s*=2;if(s!==this.length){var d=new Uint8Array(s);d.set(this.buf),this.buf=d,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),dm(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),dm(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),dm(this.buf,-1&a,this.pos),dm(this.buf,Math.floor(a*SM),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),dm(this.buf,-1&a,this.pos),dm(this.buf,Math.floor(a*SM),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(s,d){var f,v,y,M;if(s>=0?(f=s%4294967296|0,v=s/4294967296|0):(v=~(-s/4294967296),4294967295^(f=~(-s%4294967296))?f=f+1|0:(f=0,v=v+1|0)),s>=0x10000000000000000||s<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");d.realloc(10),y=f,(M=d).buf[M.pos++]=127&y|128,y>>>=7,M.buf[M.pos++]=127&y|128,y>>>=7,M.buf[M.pos++]=127&y|128,y>>>=7,M.buf[M.pos++]=127&y|128,M.buf[M.pos]=127&(y>>>=7),function(y,E){var M=(7&y)<<4;E.buf[E.pos++]|=M|((y>>>=3)?128:0),y&&(E.buf[E.pos++]=127&y|((y>>>=7)?128:0),y&&(E.buf[E.pos++]=127&y|((y>>>=7)?128:0),y&&(E.buf[E.pos++]=127&y|((y>>>=7)?128:0),y&&(E.buf[E.pos++]=127&y|((y>>>=7)?128:0),y&&(E.buf[E.pos++]=127&y)))))}(v,d)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var s=this.pos;this.pos=function(f,v,y){for(var E,M,k=0;k<v.length;k++){if((E=v.charCodeAt(k))>55295&&E<57344){if(!M){E>56319||k+1===v.length?(f[y++]=239,f[y++]=191,f[y++]=189):M=E;continue}if(E<56320){f[y++]=239,f[y++]=191,f[y++]=189,M=E;continue}E=M-55296<<10|E-56320|65536,M=null}else M&&(f[y++]=239,f[y++]=191,f[y++]=189,M=null);E<128?f[y++]=E:(E<2048?f[y++]=E>>6|192:(E<65536?f[y++]=E>>12|224:(f[y++]=E>>18|240,f[y++]=E>>12&63|128),f[y++]=E>>6&63|128),f[y++]=63&E|128)}return y}(this.buf,a,this.pos);var d=this.pos-s;d>=128&&wc(s,d,this),this.pos=s-1,this.writeVarint(d),this.pos+=d},writeFloat:function(a){this.realloc(4),Gy.write(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Gy.write(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var s=a.length;this.writeVarint(s),this.realloc(s);for(var d=0;d<s;d++)this.buf[this.pos++]=a[d]},writeRawMessage:function(a,s){this.pos++;var d=this.pos;a(s,this);var f=this.pos-d;f>=128&&wc(d,f,this),this.pos=d-1,this.writeVarint(f),this.pos+=f},writeMessage:function(a,s,d){this.writeTag(a,Xo.Bytes),this.writeRawMessage(s,d)},writePackedVarint:function(a,s){s.length&&this.writeMessage(a,MM,s)},writePackedSVarint:function(a,s){s.length&&this.writeMessage(a,_L,s)},writePackedBoolean:function(a,s){s.length&&this.writeMessage(a,bL,s)},writePackedFloat:function(a,s){s.length&&this.writeMessage(a,bI,s)},writePackedDouble:function(a,s){s.length&&this.writeMessage(a,vL,s)},writePackedFixed32:function(a,s){s.length&&this.writeMessage(a,AM,s)},writePackedSFixed32:function(a,s){s.length&&this.writeMessage(a,DM,s)},writePackedFixed64:function(a,s){s.length&&this.writeMessage(a,yL,s)},writePackedSFixed64:function(a,s){s.length&&this.writeMessage(a,Aw,s)},writeBytesField:function(a,s){this.writeTag(a,Xo.Bytes),this.writeBytes(s)},writeFixed32Field:function(a,s){this.writeTag(a,Xo.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(a,s){this.writeTag(a,Xo.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(a,s){this.writeTag(a,Xo.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(a,s){this.writeTag(a,Xo.Fixed64),this.writeSFixed64(s)},writeVarintField:function(a,s){this.writeTag(a,Xo.Varint),this.writeVarint(s)},writeSVarintField:function(a,s){this.writeTag(a,Xo.Varint),this.writeSVarint(s)},writeStringField:function(a,s){this.writeTag(a,Xo.Bytes),this.writeString(s)},writeFloatField:function(a,s){this.writeTag(a,Xo.Fixed32),this.writeFloat(s)},writeDoubleField:function(a,s){this.writeTag(a,Xo.Fixed64),this.writeDouble(s)},writeBooleanField:function(a,s){this.writeVarintField(a,!!s)}};var ru=un(Sw);const um=3;function cE(a,s,d){s.glyphs=[],1===a&&d.readMessage(Bv,s)}function Bv(a,s,d){if(3===a){const{id:f,bitmap:v,width:y,height:E,left:M,top:k,advance:R}=d.readMessage(Yg,{});s.glyphs.push({id:f,bitmap:new Zu({width:y+2*um,height:E+2*um},v),metrics:{width:y,height:E,left:M,top:k,advance:R}})}else 4===a?s.ascender=d.readSVarint():5===a&&(s.descender=d.readSVarint())}function Yg(a,s,d){1===a?s.id=d.readVarint():2===a?s.bitmap=d.readBytes():3===a?s.width=d.readVarint():4===a?s.height=d.readVarint():5===a?s.left=d.readSVarint():6===a?s.top=d.readSVarint():7===a&&(s.advance=d.readVarint())}const Zg=um,Jl={horizontal:1,vertical:2,horizontalOnly:3};class zh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,d){const f=new zh;return f.scale=s||1,f.fontStack=d,f}static forImage(s){const d=new zh;return d.imageName=s,d}}class Kg{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,d){const f=new Kg;for(let v=0;v<s.sections.length;v++){const y=s.sections[v];y.image?f.addImageSection(y):f.addTextSection(y,d)}return f}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCodePoint(s){return this.text.codePointAt(s)}verticalizePunctuation(s){this.text=function(d,f){let v="";for(let y=0;y<d.length;y++){const E=d.charCodeAt(y+1)||null,M=d.charCodeAt(y-1)||null;v+=!f&&(E&&ov(E)&&!Cw[d[y+1]]||M&&ov(M)&&!Cw[d[y-1]])||!Cw[d[y]]?d[y]:Cw[d[y]]}return v}(this.text,s)}trim(){let s=0;for(let f=0;f<this.text.length&&ou[this.text.charCodeAt(f)];f++)s++;let d=this.text.length;for(let f=this.text.length-1;f>=0&&f>=s&&ou[this.text.charCodeAt(f)];f--)d--;this.text=this.text.substring(s,d),this.sectionIndex=this.sectionIndex.slice(s,d)}substring(s,d){const f=new Kg;return f.text=this.text.substring(s,d),f.sectionIndex=this.sectionIndex.slice(s,d),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,d)=>Math.max(s,this.sections[d].scale),0)}addTextSection(s,d){this.text+=s.text,this.sections.push(zh.forText(s.scale,s.fontStack||d));const f=this.sections.length-1;for(let v=0;v<s.text.length;++v)this.sectionIndex.push(f)}addImageSection(s){const d=s.image?s.image.namePrimary:"";if(0===d.length)return void Qe("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCodePoint(f),this.sections.push(zh.forImage(d)),this.sectionIndex.push(this.sections.length-1)):Qe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Uh(a,s,d,f,v,y,E,M,k,R,L,V,j,q,Z){const J=Kg.fromFeature(a,v);V===Jl.vertical&&J.verticalizePunctuation(j);let ne=[];const le=function(ke,Be,We,tt,ct,it){if(!ke)return[];const xt=[],Rt=function(Dt,ii,Lt,Ui,Ti,Ut){let on=0;for(let Gi=0;Gi<Dt.length();Gi++){const Bi=Dt.getSection(Gi);on+=Qg(Dt.getCodePoint(Gi),Bi,Ui,Ti,ii,Ut)}return on/Math.max(1,Math.ceil(on/Lt))}(ke,Be,We,tt,ct,it),_t=ke.text.indexOf("\u200b")>=0;let At=0;for(let Dt=0;Dt<ke.length();Dt++){const ii=ke.getSection(Dt),Lt=ke.getCodePoint(Dt);if(ou[Lt]||(At+=Qg(Lt,ii,tt,ct,Be,it)),Dt<ke.length()-1){const Ui=!((ft=Lt)<11904||!(Wi["Bopomofo Extended"](ft)||Wi.Bopomofo(ft)||Wi["CJK Compatibility Forms"](ft)||Wi["CJK Compatibility Ideographs"](ft)||Wi["CJK Compatibility"](ft)||Wi["CJK Radicals Supplement"](ft)||Wi["CJK Strokes"](ft)||Wi["CJK Symbols and Punctuation"](ft)||Wi["CJK Unified Ideographs Extension A"](ft)||Wi["CJK Unified Ideographs"](ft)||Wi["Enclosed CJK Letters and Months"](ft)||Wi["Halfwidth and Fullwidth Forms"](ft)||Wi.Hiragana(ft)||Wi["Ideographic Description Characters"](ft)||Wi["Kangxi Radicals"](ft)||Wi["Katakana Phonetic Extensions"](ft)||Wi.Katakana(ft)||Wi["Vertical Forms"](ft)||Wi["Yi Radicals"](ft)||Wi["Yi Syllables"](ft)));(su[Lt]||Ui||ii.imageName)&&xt.push(Dw(Dt+1,At,Rt,xt,au(Lt,ke.getCodePoint(Dt+1),Ui&&_t),!1))}}var ft;return Vv(Dw(ke.length(),At,Rt,xt,0,!0))}(J,R,y,s,f,q),{processBidirectionalText:xe,processStyledBidirectionalText:Ee}=na;if(xe&&1===J.sections.length){const ke=xe(J.toString(),le);for(const Be of ke){const We=new Kg;We.text=Be,We.sections=J.sections;for(let tt=0;tt<Be.length;tt++)We.sectionIndex.push(0);ne.push(We)}}else if(Ee){const ke=Ee(J.text,J.sectionIndex,le);for(const Be of ke){const We=new Kg;We.text=Be[0],We.sectionIndex=Be[1],We.sections=J.sections,ne.push(We)}}else ne=function(ke,Be){const We=[],tt=ke.text;let ct=0;for(const it of Be)We.push(ke.substring(ct,it)),ct=it;return ct<tt.length&&We.push(ke.substring(ct,tt.length)),We}(J,le);const Te=[],Le={positionedLines:Te,text:J.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ke,Be,We,tt,ct,it,xt,Rt,_t,At,ft,Dt){let ii=0,Lt=0,Ui=0;const Ti="right"===Rt?1:"left"===Rt?0:.5;let Ut=!1;for(const Hn of ct){const hn=Hn.getSections();for(const Yn of hn){if(Yn.imageName)continue;const In=Be[Yn.fontStack];if(In&&(Ut=void 0!==In.ascender&&void 0!==In.descender,!Ut))break}if(!Ut)break}let on=0;for(const Hn of ct){Hn.trim();const hn=Hn.getMaxScale(),Yn=(hn-1)*al,In={positionedGlyphs:[],lineOffset:0};ke.positionedLines[on]=In;const xr=In.positionedGlyphs;let Rn=0;if(!Hn.length()){Lt+=it,++on;continue}let po=0,Fr=0;for(let Er=0;Er<Hn.length();Er++){const Gr=Hn.getSection(Er),Mo=Hn.getSectionIndex(Er),Jr=Hn.getCodePoint(Er);let ms=Gr.scale,Is=null,aa=null,Uo=null,ts=al,ma=0;const pa=!(_t===Jl.horizontal||!ft&&!ey(Jr)||ft&&(ou[Jr]||(Gi=Jr,Wi.Arabic(Gi)||Wi["Arabic Supplement"](Gi)||Wi["Arabic Extended-A"](Gi)||Wi["Arabic Presentation Forms-A"](Gi)||Wi["Arabic Presentation Forms-B"](Gi))));if(Gr.imageName){const ga=tt[Gr.imageName];if(!ga)continue;Uo=Gr.imageName,ke.iconsInText=ke.iconsInText||!0,aa=ga.paddedRect;const Co=ga.displaySize;ms=ms*al/Dt,Is={width:Co[0],height:Co[1],left:0,top:-Zg,advance:pa?Co[1]:Co[0],localGlyph:!1},ma=Ut?-Is.height*ms:hn*al-17-Co[1]*ms,ts=Is.advance;const ic=(pa?Co[0]:Co[1])*ms-al*hn;ic>0&&ic>Rn&&(Rn=ic)}else{const ga=We[Gr.fontStack];if(!ga)continue;ga[Jr]&&(aa=ga[Jr]);const Co=Be[Gr.fontStack];if(!Co)continue;const ic=Co.glyphs[Jr];if(!ic)continue;if(Is=ic.metrics,ts=8203!==Jr?al:0,Ut){const Yh=void 0!==Co.ascender?Math.abs(Co.ascender):0,wa=void 0!==Co.descender?Math.abs(Co.descender):0,fl=(Yh+wa)*ms;po<fl&&(po=fl,Fr=(Yh-wa)/2*ms),ma=-Yh*ms}else ma=(hn-ms)*al-17}pa?(ke.verticalizable=!0,xr.push({glyph:Jr,imageName:Uo,x:ii,y:Lt+ma,vertical:pa,scale:ms,localGlyph:Is.localGlyph,fontStack:Gr.fontStack,sectionIndex:Mo,metrics:Is,rect:aa}),ii+=ts*ms+At):(xr.push({glyph:Jr,imageName:Uo,x:ii,y:Lt+ma,vertical:pa,scale:ms,localGlyph:Is.localGlyph,fontStack:Gr.fontStack,sectionIndex:Mo,metrics:Is,rect:aa}),ii+=Is.advance*ms+At)}0!==xr.length&&(Ui=Math.max(ii-At,Ui),Ut?lu(xr,Ti,Rn,Fr,it*hn/2):lu(xr,Ti,Rn,0,it/2)),ii=0;const Mr=it*hn+Rn;In.lineOffset=Math.max(Rn,Yn),Lt+=Mr,++on}var Gi;const Bi=Lt,{horizontalAlign:Gt,verticalAlign:Qi}=Vs(xt);(function(Hn,hn,Yn,In,xr,Rn){const po=(hn-Yn)*xr,Fr=-Rn*In;for(const Mr of Hn)for(const Er of Mr.positionedGlyphs)Er.x+=po,Er.y+=Fr})(ke.positionedLines,Ti,Gt,Qi,Ui,Bi),ke.top+=-Qi*Bi,ke.bottom=ke.top+Bi,ke.left+=-Gt*Ui,ke.right=ke.left+Ui,ke.hasBaseline=Ut}(Le,s,d,f,ne,E,M,k,V,R,j,Z),!function(ke){for(const Be of ke)if(0!==Be.positionedGlyphs.length)return!1;return!0}(Te)&&Le}const ou={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},su={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Qg(a,s,d,f,v,y){if(s.imageName){const E=f[s.imageName];return E?E.displaySize[0]*s.scale*al/y+v:0}{const E=d[s.fontStack],M=E&&E.glyphs[a];return M?M.metrics.advance*s.scale+v:0}}function Es(a,s,d,f){const v=Math.pow(a-s,2);return f?a<s?v/2:2*v:v+Math.abs(d)*d}function au(a,s,d){let f=0;return 10===a&&(f-=1e4),d&&(f+=150),40!==a&&65288!==a||(f+=50),41!==s&&65289!==s||(f+=50),f}function Dw(a,s,d,f,v,y){let E=null,M=Es(s,d,v,y);for(const k of f){const R=Es(s-k.x,d,v,y)+k.badness;R<=M&&(E=k,M=R)}return{index:a,x:s,priorBreak:E,badness:M}}function Vv(a){return a?Vv(a.priorBreak).concat(a.index):[]}function Vs(a){let s=.5,d=.5;switch(a){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:s,verticalAlign:d}}function lu(a,s,d,f,v){if(!(s||d||f||v))return;const y=a.length-1,E=a[y],M=(E.x+E.metrics.advance*E.scale)*s;for(let k=0;k<=y;k++)a[k].x-=M,a[k].y+=d+f+v}function Jg(a,s,d,f){const{horizontalAlign:v,verticalAlign:y}=Vs(f),E=d[0]-a.displaySize[0]*v,M=d[1]-a.displaySize[1]*y;return{imagePrimary:a,imageSecondary:s,top:M,bottom:M+a.displaySize[1],left:E,right:E+a.displaySize[0]}}function kw(a,s,d,f,v,y){const E=a.imagePrimary;let M;if(E.content){const ne=E.content,le=E.pixelRatio||1;M=[ne[0]/le,ne[1]/le,E.displaySize[0]-ne[2]/le,E.displaySize[1]-ne[3]/le]}const k=s.left*y,R=s.right*y;let L,V,j,q;"width"===d||"both"===d?(q=v[0]+k-f[3],V=v[0]+R+f[1]):(q=v[0]+(k+R-E.displaySize[0])/2,V=q+E.displaySize[0]);const Z=s.top*y,J=s.bottom*y;return"height"===d||"both"===d?(L=v[1]+Z-f[0],j=v[1]+J+f[2]):(L=v[1]+(Z+J-E.displaySize[1])/2,j=L+E.displaySize[1]),{imagePrimary:E,imageSecondary:void 0,top:L,right:V,bottom:j,left:q,collisionPadding:M}}class cu extends mt{constructor(s,d,f,v,y){super(s,d),this.angle=v,this.z=f,void 0!==y&&(this.segment=y)}clone(){return new cu(this.x,this.y,this.z,this.angle,this.segment)}}function dE(a,s,d,f,v){if(void 0===s.segment)return!0;let y=s,E=s.segment+1,M=0;for(;M>-d/2;){if(E--,E<0)return!1;M-=a[E].dist(y),y=a[E]}M+=a[E].dist(a[E+1]),E++;const k=[];let R=0;for(;M<d/2;){const L=a[E],V=a[E+1];if(!V)return!1;let j=a[E-1].angleTo(L)-L.angleTo(V);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:M,angleDelta:j}),R+=j;M-k[0].distance>f;)R-=k.shift().angleDelta;if(R>v)return!1;E++,M+=L.dist(V)}return!0}function uE(a){let s=0;for(let d=0;d<a.length-1;d++)s+=a[d].dist(a[d+1]);return s}function kp(a,s,d){return a?.6*s*d:0}function kM(a,s){return Math.max(a?a.right-a.left:0,s?s.right-s.left:0)}function Iw(a,s,d,f,v,y){const E=kp(d,v,y),M=kM(d,f)*y;let k=0;const R=uE(a)/2;for(let L=0;L<a.length-1;L++){const V=a[L],j=a[L+1],q=V.dist(j);if(k+q>R){const Z=(R-k)/q,J=rr(V.x,j.x,Z),ne=rr(V.y,j.y,Z),le=new cu(J,ne,0,j.angleTo(V),L);return!E||dE(a,le,M,E,s)?le:void 0}k+=q}}function hm(a,s,d,f,v,y,E,M,k){const R=kp(f,y,E),L=kM(f,v),V=L*E,j=0===a[0].x||a[0].x===k||0===a[0].y||a[0].y===k;return s-V<s/4&&(s=V+s/4),Rw(a,j?s/2*M%s:(L/2+2*y)*E*M%s,s,R,d,V,j,!1,k)}function Rw(a,s,d,f,v,y,E,M,k){const R=y/2,L=uE(a);let V=0,j=s-d,q=[];for(let Z=0;Z<a.length-1;Z++){const J=a[Z],ne=a[Z+1],le=J.dist(ne),xe=ne.angleTo(J);for(;j+d<V+le;){j+=d;const Ee=(j-V)/le,Te=rr(J.x,ne.x,Ee),Le=rr(J.y,ne.y,Ee);if(Te>=0&&Te<k&&Le>=0&&Le<k&&j-R>=0&&j+R<=L){const ke=new cu(Te,Le,0,xe,Z);f&&!dE(a,ke,y,f,v)||q.push(ke)}}V+=le}return M||q.length||E||(q=Rw(a,V/2,d,f,v,y,E,!0,k)),q}function Hy(a,s,d,f,v){const y=[];for(let E=0;E<a.length;E++){const M=a[E];let k;for(let R=0;R<M.length-1;R++){let L=M[R],V=M[R+1];L.x<s&&V.x<s||(L.x<s?L=new mt(s,L.y+(s-L.x)/(V.x-L.x)*(V.y-L.y))._round():V.x<s&&(V=new mt(s,L.y+(s-L.x)/(V.x-L.x)*(V.y-L.y))._round()),L.y<d&&V.y<d||(L.y<d?L=new mt(L.x+(d-L.y)/(V.y-L.y)*(V.x-L.x),d)._round():V.y<d&&(V=new mt(L.x+(d-L.y)/(V.y-L.y)*(V.x-L.x),d)._round()),L.x>=f&&V.x>=f||(L.x>=f?L=new mt(f,L.y+(f-L.x)/(V.x-L.x)*(V.y-L.y))._round():V.x>=f&&(V=new mt(f,L.y+(f-L.x)/(V.x-L.x)*(V.y-L.y))._round()),L.y>=v&&V.y>=v||(L.y>=v?L=new mt(L.x+(v-L.y)/(V.y-L.y)*(V.x-L.x),v)._round():V.y>=v&&(V=new mt(L.x+(v-L.y)/(V.y-L.y)*(V.x-L.x),v)._round()),k&&L.equals(k[k.length-1])||(k=[L],y.push(k)),k.push(V)))))}}return y}function Pw(a){let s=0,d=0;for(const E of a)s+=E.w*E.h,d=Math.max(d,E.w);a.sort((E,M)=>M.h-E.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),d),h:1/0}];let v=0,y=0;for(const E of a)for(let M=f.length-1;M>=0;M--){const k=f[M];if(!(E.w>k.w||E.h>k.h)){if(E.x=k.x,E.y=k.y,y=Math.max(y,E.y+E.h),v=Math.max(v,E.x+E.w),E.w===k.w&&E.h===k.h){const R=f.pop();M<f.length&&(f[M]=R)}else E.h===k.h?(k.x+=E.w,k.w-=E.w):E.w===k.w?(k.y+=E.h,k.h-=E.h):(f.push({x:k.x+E.w,y:k.y,w:k.w-E.w,h:E.h}),k.y+=E.h,k.h-=E.h);break}}return{w:v,h:y,fill:s/(v*y)||0}}Oi(cu,"Anchor");const sa=1;class fm{constructor(s,{pixelRatio:d,version:f,stretchX:v,stretchY:y,content:E}){this.paddedRect=s,this.pixelRatio=d,this.stretchX=v,this.stretchY=y,this.content=E,this.version=f}get tl(){return[this.paddedRect.x+sa,this.paddedRect.y+sa]}get br(){return[this.paddedRect.x+this.paddedRect.w-sa,this.paddedRect.y+this.paddedRect.h-sa]}get displaySize(){return[(this.paddedRect.w-2*sa)/this.pixelRatio,(this.paddedRect.h-2*sa)/this.pixelRatio]}}class Cc{constructor(s,d){const f={},v={};this.haveRenderCallbacks=[];const y=[];this.addImages(s,f,y),this.addImages(d,v,y);const{w:E,h:M}=Pw(y),k=new xc({width:E||1,height:M||1});for(const R in s){const L=s[R],V=f[R].paddedRect;xc.copy(L.data,k,{x:0,y:0},{x:V.x+sa,y:V.y+sa},L.data,L.sdf)}for(const R in d){const L=d[R],V=v[R].paddedRect,j=V.x+sa,q=V.y+sa,Z=L.data.width,J=L.data.height;xc.copy(L.data,k,{x:0,y:0},{x:j,y:q},L.data),xc.copy(L.data,k,{x:0,y:J-1},{x:j,y:q-1},{width:Z,height:1}),xc.copy(L.data,k,{x:0,y:0},{x:j,y:q+J},{width:Z,height:1}),xc.copy(L.data,k,{x:Z-1,y:0},{x:j-1,y:q},{width:1,height:J}),xc.copy(L.data,k,{x:0,y:0},{x:j+Z,y:q},{width:1,height:J})}this.image=k,this.iconPositions=f,this.patternPositions=v}addImages(s,d,f){for(const v in s){const y=s[v],E={x:0,y:0,w:y.data.width+2*sa,h:y.data.height+2*sa};f.push(E),d[v]=new fm(E,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(s,d,f){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(v=>s.hasImage(v,f)),s.dispatchRenderCallbacks(this.haveRenderCallbacks,f);for(const v in s.getUpdatedImages(f))this.patchUpdatedImage(this.iconPositions[v],s.getImage(v,f),d),this.patchUpdatedImage(this.patternPositions[v],s.getImage(v,f),d)}patchUpdatedImage(s,d,f){if(!s||!d||s.version===d.version)return;s.version=d.version;const[v,y]=s.tl,E=!!Object.keys(this.patternPositions).length;f.update(d.data,{useMipmap:E},{x:v,y})}}Oi(fm,"ImagePosition"),Oi(Cc,"ImageAtlas");const mm=1e20;function jh(a,s,d,f,v,y,E,M,k){for(let R=s;R<s+f;R++)pm(a,d*y+R,y,v,E,M,k);for(let R=d;R<d+v;R++)pm(a,R*y+s,1,f,E,M,k)}function pm(a,s,d,f,v,y,E){y[0]=0,E[0]=-mm,E[1]=mm,v[0]=a[s];for(let M=1,k=0,R=0;M<f;M++){v[M]=a[s+M*d];const L=M*M;do{const V=y[k];R=(v[M]-v[V]+L-V*V)/(M-V)/2}while(R<=E[k]&&--k>-1);k++,y[k]=M,E[k]=R,E[k+1]=mm}for(let M=0,k=0;M<f;M++){for(;E[k+1]<M;)k++;const R=y[k],L=M-R;a[s+M*d]=v[R]+L*L}}const Ll=2,zv={none:0,ideographs:1,all:2};class Ip{constructor(s,d,f){this.requestManager=s,this.localGlyphMode=d,this.localFontFamily=f,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s,d){this.urls[d]=s}getGlyphs(s,d,f){const v=[],y=this.urls[d]||Ri.GLYPHS_URL;for(const E in s)for(const M of s[E])v.push({stack:E,id:M});uo(v,({stack:E,id:M},k)=>{let R=this.entries[E];R||(R=this.entries[E]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let L=R.glyphs[M];if(void 0!==L)return void k(null,{stack:E,id:M,glyph:L});if(L=this._tinySDF(R,E,M),L)return R.glyphs[M]=L,void k(null,{stack:E,id:M,glyph:L});const V=Math.floor(M/256);if(256*V>65535)return void k(new Error("glyphs > 65535 not supported"));if(R.ranges[V])return void k(null,{stack:E,id:M,glyph:L});let j=R.requests[V];j||(j=R.requests[V]=[],Ip.loadGlyphRange(E,V,y,this.requestManager,(q,Z)=>{if(Z){R.ascender=Z.ascender,R.descender=Z.descender;for(const J in Z.glyphs)this._doesCharSupportLocalGlyph(+J)||(R.glyphs[+J]=Z.glyphs[+J]);R.ranges[V]=!0}for(const J of j)J(q,Z);delete R.requests[V]})),j.push((q,Z)=>{q?k(q):Z&&k(null,{stack:E,id:M,glyph:Z.glyphs[M]||null})})},(E,M)=>{if(E)f(E);else if(M){const k={};for(const{stack:R,id:L,glyph:V}of M)void 0===k[R]&&(k[R]={}),void 0===k[R].glyphs&&(k[R].glyphs={}),k[R].glyphs[L]=V&&{id:V.id,bitmap:V.bitmap.clone(),metrics:V.metrics},k[R].ascender=this.entries[R].ascender,k[R].descender=this.entries[R].descender;f(null,k)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==zv.none&&(this.localGlyphMode===zv.all?!!this.localFontFamily:!!this.localFontFamily&&(Wi["CJK Unified Ideographs"](s)||Wi["Hangul Syllables"](s)||Wi.Hiragana(s)||Wi.Katakana(s)||Wi["CJK Symbols and Punctuation"](s)||Wi["CJK Unified Ideographs Extension A"](s)||Wi["CJK Unified Ideographs Extension B"](s)))}_tinySDF(s,d,f){const v=this.localFontFamily;if(!v||!this._doesCharSupportLocalGlyph(f))return;let y=s.tinySDF;if(!y){let J="400";/bold/i.test(d)?J="900":/medium/i.test(d)?J="500":/light/i.test(d)&&(J="200"),y=s.tinySDF=new Ip.TinySDF({fontFamily:v,fontWeight:J,fontSize:24*Ll,buffer:3*Ll,radius:8*Ll}),y.fontWeight=J}if(this.localGlyphs[y.fontWeight][f])return this.localGlyphs[y.fontWeight][f];const E=String.fromCodePoint(f),{data:M,width:k,height:R,glyphWidth:L,glyphHeight:V,glyphLeft:j,glyphTop:q,glyphAdvance:Z}=y.draw(E);return this.localGlyphs[y.fontWeight][f]={id:f,bitmap:new Zu({width:k,height:R},M),metrics:{width:L/Ll,height:V/Ll,left:j/Ll,top:q/Ll-27,advance:Z/Ll,localGlyph:!0}}}}Ip.loadGlyphRange=function(a,s,d,f,v){const y=256*s,E=y+255,M=f.transformRequest(f.normalizeGlyphsURL(d).replace("{fontstack}",a).replace("{range}",`${y}-${E}`),ca.Glyphs);wt(M,(k,R)=>{if(k)v(k);else if(R){const L={},V=new ru(R).readFields(cE,{});for(const j of V.glyphs)L[j.id]=j;v(null,{glyphs:L,ascender:V.ascender,descender:V.descender})}})},Ip.TinySDF=class{constructor({fontSize:a=24,buffer:s=3,radius:d=8,cutoff:f=.25,fontFamily:v="sans-serif",fontWeight:y="normal",fontStyle:E="normal"}={}){this.buffer=s,this.cutoff=f,this.radius=d;const M=this.size=a+4*s,k=this._createCanvas(M),R=this.ctx=k.getContext("2d",{willReadFrequently:!0});R.font=`${E} ${y} ${a}px ${v}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(a){const s=document.createElement("canvas");return s.width=s.height=a,s}draw(a){const{width:s,actualBoundingBoxAscent:d,actualBoundingBoxDescent:f,actualBoundingBoxLeft:v,actualBoundingBoxRight:y}=this.ctx.measureText(a),E=Math.ceil(d),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-v))),k=Math.min(this.size-this.buffer,E+Math.ceil(f)),R=M+2*this.buffer,L=k+2*this.buffer,V=Math.max(R*L,0),j=new Uint8ClampedArray(V),q={data:j,width:R,height:L,glyphWidth:M,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:s};if(0===M||0===k)return q;const{ctx:Z,buffer:J,gridInner:ne,gridOuter:le}=this;Z.clearRect(J,J,M,k),Z.fillText(a,J,J+E);const xe=Z.getImageData(J,J,M,k);le.fill(mm,0,V),ne.fill(0,0,V);for(let Ee=0;Ee<k;Ee++)for(let Te=0;Te<M;Te++){const Le=xe.data[4*(Ee*M+Te)+3]/255;if(0===Le)continue;const ke=(Ee+J)*R+Te+J;if(1===Le)le[ke]=0,ne[ke]=mm;else{const Be=.5-Le;le[ke]=Be>0?Be*Be:0,ne[ke]=Be<0?Be*Be:0}}jh(le,0,0,R,L,R,this.f,this.v,this.z),jh(ne,J,J,M,k,R,this.f,this.v,this.z);for(let Ee=0;Ee<V;Ee++){const Te=Math.sqrt(le[Ee])-Math.sqrt(ne[Ee]);j[Ee]=Math.round(255-255*(Te/this.radius+this.cutoff))}return q}};const Ad=sa;function $y(a,s,d,f){const v=[],y=a.imagePrimary,E=y.pixelRatio,M=y.paddedRect.w-2*Ad,k=y.paddedRect.h-2*Ad,R=a.right-a.left,L=a.bottom-a.top,V=y.stretchX||[[0,M]],j=y.stretchY||[[0,k]],q=(it,xt)=>it+xt[1]-xt[0],Z=V.reduce(q,0),J=j.reduce(q,0),ne=M-Z,le=k-J;let xe=0,Ee=Z,Te=0,Le=J,ke=0,Be=ne,We=0,tt=le;if(y.content&&f){const it=y.content;xe=Uv(V,0,it[0]),Te=Uv(j,0,it[1]),Ee=Uv(V,it[0],it[2]),Le=Uv(j,it[1],it[3]),ke=it[0]-xe,We=it[1]-Te,Be=it[2]-it[0]-Ee,tt=it[3]-it[1]-Le}const ct=(it,xt,Rt,_t)=>{const At=e_(it.stretch-xe,Ee,R,a.left),ft=t_(it.fixed-ke,Be,it.stretch,Z),Dt=e_(xt.stretch-Te,Le,L,a.top),ii=t_(xt.fixed-We,tt,xt.stretch,J),Lt=e_(Rt.stretch-xe,Ee,R,a.left),Ui=t_(Rt.fixed-ke,Be,Rt.stretch,Z),Ti=e_(_t.stretch-Te,Le,L,a.top),Ut=t_(_t.fixed-We,tt,_t.stretch,J),on=new mt(At,Dt),Gi=new mt(Lt,Dt),Bi=new mt(Lt,Ti),Gt=new mt(At,Ti),Qi=new mt(ft/E,ii/E),Hn=new mt(Ui/E,Ut/E),hn=s*Math.PI/180;if(hn){const Fr=Math.sin(hn),Mr=Math.cos(hn),Er=[Mr,-Fr,Fr,Mr];on._matMult(Er),Gi._matMult(Er),Gt._matMult(Er),Bi._matMult(Er)}const Yn=it.stretch+it.fixed,In=Rt.stretch+Rt.fixed,xr=xt.stretch+xt.fixed,Rn=_t.stretch+_t.fixed,po=a.imageSecondary;return{tl:on,tr:Gi,bl:Gt,br:Bi,texPrimary:{x:y.paddedRect.x+Ad+Yn,y:y.paddedRect.y+Ad+xr,w:In-Yn,h:Rn-xr},texSecondary:po?{x:po.paddedRect.x+Ad+Yn,y:po.paddedRect.y+Ad+xr,w:In-Yn,h:Rn-xr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Qi,pixelOffsetBR:Hn,minFontScaleX:Be/E/R,minFontScaleY:tt/E/L,isSDF:d}};if(f&&(y.stretchX||y.stretchY)){const it=Wy(V,ne,Z),xt=Wy(j,le,J);for(let Rt=0;Rt<it.length-1;Rt++){const _t=it[Rt],At=it[Rt+1];for(let ft=0;ft<xt.length-1;ft++)v.push(ct(_t,xt[ft],At,xt[ft+1]))}}else v.push(ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:k+1}));return v}function Uv(a,s,d){let f=0;for(const v of a)f+=Math.max(s,Math.min(d,v[1]))-Math.max(s,Math.min(d,v[0]));return f}function Wy(a,s,d){const f=[{fixed:-Ad,stretch:0}];for(const[v,y]of a){const E=f[f.length-1];f.push({fixed:v-E.stretch,stretch:E.stretch}),f.push({fixed:v-E.stretch,stretch:E.stretch+(y-v)})}return f.push({fixed:s+Ad,stretch:d}),f}function e_(a,s,d,f){return a/s*d+f}function t_(a,s,d,f){return a-s*d/f}function $r(a,s,d,f){const v=s+a.positionedLines[f].lineOffset;return 0===f?d+v/2:d+(v+(s+a.positionedLines[f-1].lineOffset))/2}function jv(a,s=1,d=!1){let f=1/0,v=1/0,y=-1/0,E=-1/0;const M=a[0];for(let q=0;q<M.length;q++){const Z=M[q];(!q||Z.x<f)&&(f=Z.x),(!q||Z.y<v)&&(v=Z.y),(!q||Z.x>y)&&(y=Z.x),(!q||Z.y>E)&&(E=Z.y)}const k=Math.min(y-f,E-v);let R=k/2;const L=new da([],IM);if(0===k)return new mt(f,v);for(let q=f;q<y;q+=k)for(let Z=v;Z<E;Z+=k)L.push(new Dd(q+R,Z+R,R,a));let V=function(q){let Z=0,J=0,ne=0;const le=q[0];for(let xe=0,Ee=le.length,Te=Ee-1;xe<Ee;Te=xe++){const Le=le[xe],ke=le[Te],Be=Le.x*ke.y-ke.x*Le.y;J+=(Le.x+ke.x)*Be,ne+=(Le.y+ke.y)*Be,Z+=3*Be}return new Dd(J/Z,ne/Z,0,q)}(a),j=L.length;for(;L.length;){const q=L.pop();(q.d>V.d||!V.d)&&(V=q,d&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,j)),q.max-V.d<=s||(R=q.h/2,L.push(new Dd(q.p.x-R,q.p.y-R,R,a)),L.push(new Dd(q.p.x+R,q.p.y-R,R,a)),L.push(new Dd(q.p.x-R,q.p.y+R,R,a)),L.push(new Dd(q.p.x+R,q.p.y+R,R,a)),j+=4)}return d&&(console.log(`num probes: ${j}`),console.log(`best distance: ${V.d}`)),V.p}function IM(a,s){return s.max-a.max}class Dd{constructor(s,d,f,v){this.p=new mt(s,d),this.h=f,this.d=function(y,E){let M=!1,k=1/0;for(let R=0;R<E.length;R++){const L=E[R];for(let V=0,j=L.length,q=j-1;V<j;q=V++){const Z=L[V],J=L[q];Z.y>y.y!=J.y>y.y&&y.x<(J.x-Z.x)*(y.y-Z.y)/(J.y-Z.y)+Z.x&&(M=!M),k=Math.min(k,qf(y,Z,J))}}return(M?1:-1)*Math.sqrt(k)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}}const Xy=Number.POSITIVE_INFINITY,hE=Math.sqrt(2);function fE(a,[s,d]){let f=0,v=0;if(d===Xy){s<0&&(s=0);const y=s/hE;switch(a){case"top-right":case"top-left":v=y-7;break;case"bottom-right":case"bottom-left":v=7-y;break;case"bottom":v=7-s;break;case"top":v=s-7}switch(a){case"top-right":case"bottom-right":f=-y;break;case"top-left":case"bottom-left":f=y;break;case"left":f=s;break;case"right":f=-s}}else{switch(s=Math.abs(s),d=Math.abs(d),a){case"top-right":case"top-left":case"top":v=d-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-d}switch(a){case"top-right":case"bottom-right":case"right":f=-s;break;case"top-left":case"bottom-left":case"left":f=s}}return[f,v]}function i_(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function n_(a,s,d,f,v,y,E,M,k,R,L,V,j,q,Z){let J=y.textMaxSize.evaluate(s,{},V);void 0===J&&(J=E);const ne=a.layers[0].layout,le=ne.get("icon-offset").evaluate(s,{},V),xe=Gv(d.horizontal)||d.vertical,Ee="globe"===j.name,Te=al,Le=E/Te,ke=a.tilePixelRatio*J/Te,Be=(At=a.overscaling,a.zoom>18&&At>2&&(At>>=1),Math.max(Nt/(512*At),1)*ne.get("symbol-spacing")),We=ne.get("text-padding")*a.tilePixelRatio,tt=ne.get("icon-padding")*a.tilePixelRatio,ct=mi(ne.get("text-max-angle")),it="map"===ne.get("text-rotation-alignment")&&"point"!==ne.get("symbol-placement"),xt="map"===ne.get("icon-rotation-alignment")&&"point"!==ne.get("symbol-placement"),Rt=ne.get("symbol-placement"),_t=Be/2;var At;const ft=ne.get("icon-text-fit").evaluate(s,{},V),Dt=ne.get("icon-text-fit-padding").evaluate(s,{},V),ii="none"!==ft;let Lt;!1===a.hasAnyIconTextFit&&ii&&(a.hasAnyIconTextFit=!0),f&&ii&&(a.allowVerticalPlacement&&d.vertical&&(Lt=kw(f,d.vertical,ft,Dt,le,Le)),xe&&(f=kw(f,xe,ft,Dt,le,Le)));const Ui=(Ti,Ut,on)=>{if(Ut.x<0||Ut.x>=Nt||Ut.y<0||Ut.y>=Nt)return;let Gi=null;if(Ee){const{x:Bi,y:Gt,z:Qi}=j.projectTilePoint(Ut.x,Ut.y,on);Gi={anchor:new cu(Bi,Gt,Qi,0,void 0),up:j.upVector(on,Ut.x,Ut.y)}}!function(Bi,Gt,Qi,Hn,hn,Yn,In,xr,Rn,po,Fr,Mr,Er,Gr,Mo,Jr,ms,Is,aa,Uo,ts,ma,pa,ga,Co,ic,Yh){const wa=Bi.addToLineVertexArray(Gt,Hn);let fl,Pd,Sc,r1,db,_0,Xp,iA=0,jE=0,GE=0,HE=0,mu=-1,v0=-1;const ea={};let o1=Mh("");const Tm=Qi?Qi.anchor:Gt,Sm="none"!==Rn.layout.get("icon-text-fit").evaluate(ts,{},Co);let Io=0,ub=0;if(void 0===Rn._unevaluatedLayout.getValue("text-radial-offset")?[Io,ub]=Rn.layout.get("text-offset").evaluate(ts,{},Co).map(Od=>Od*al):(Io=Rn.layout.get("text-radial-offset").evaluate(ts,{},Co)*al,ub=Xy),Bi.allowVerticalPlacement&&hn.vertical){const Od=hn.vertical;if(Mo)_0=Hv(Od),xr&&(Xp=Hv(xr));else{const nc=Rn.layout.get("text-rotate").evaluate(ts,{},Co)+90;Sc=r_(po,Tm,Gt,Fr,Mr,Er,Od,Gr,nc,Jr),xr&&(r1=r_(po,Tm,Gt,Fr,Mr,Er,xr,Is,nc))}}if(Yn){const Od=Rn.layout.get("icon-rotate").evaluate(ts,{},Co),nc=$y(Yn,Od,pa,Sm),hb=xr?$y(xr,Od,pa,Sm):void 0;Pd=r_(po,Tm,Gt,Fr,Mr,Er,Yn,Is,Od),iA=4*nc.length;const nA=Bi.iconSizeData;let Mm=null;"source"===nA.kind?(Mm=[Vh*Rn.layout.get("icon-size").evaluate(ts,{},Co)],Mm[0]>kd&&Qe(`${Bi.layerIds[0]}: Value for "icon-size" is >= ${Rp}. Reduce your "icon-size".`)):"composite"===nA.kind&&(Mm=[Vh*ma.compositeIconSizes[0].evaluate(ts,{},Co),Vh*ma.compositeIconSizes[1].evaluate(ts,{},Co)],(Mm[0]>kd||Mm[1]>kd)&&Qe(`${Bi.layerIds[0]}: Value for "icon-size" is >= ${Rp}. Reduce your "icon-size".`)),Bi.addSymbols(Bi.icon,nc,Mm,Uo,aa,ts,!1,Qi,Gt,wa.lineStartIndex,wa.lineLength,-1,ga,Co,ic,Yh),mu=Bi.icon.placedSymbolArray.length-1,hb&&(jE=4*hb.length,Bi.addSymbols(Bi.icon,hb,Mm,Uo,aa,ts,Jl.vertical,Qi,Gt,wa.lineStartIndex,wa.lineLength,-1,ga,Co,ic,Yh),v0=Bi.icon.placedSymbolArray.length-1)}for(const Od in hn.horizontal){const nc=hn.horizontal[Od];fl||(o1=Mh(nc.text),Mo?db=Hv(nc):fl=r_(po,Tm,Gt,Fr,Mr,Er,nc,Gr,Rn.layout.get("text-rotate").evaluate(ts,{},Co),Jr));const hb=1===nc.positionedLines.length;if(GE+=qy(Bi,Qi,Gt,nc,In,Rn,Mo,ts,Jr,wa,hn.vertical?Jl.horizontal:Jl.horizontalOnly,hb?Object.keys(hn.horizontal):[Od],ea,mu,ma,ga,Co,ic),hb)break}hn.vertical&&(HE+=qy(Bi,Qi,Gt,hn.vertical,In,Rn,Mo,ts,Jr,wa,Jl.vertical,["vertical"],ea,v0,ma,ga,Co,ic));let qp=-1;const $E=(Od,nc)=>Od?Math.max(Od,nc):nc;qp=$E(db,qp),qp=$E(_0,qp),qp=$E(Xp,qp);const DI=qp>-1?1:0;Bi.glyphOffsetArray.length>=65535&&Qe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==ts.sortKey&&Bi.addToSortKeyRanges(Bi.symbolInstances.length,ts.sortKey),Bi.symbolInstances.emplaceBack(Gt.x,Gt.y,Tm.x,Tm.y,Tm.z,ea.right>=0?ea.right:-1,ea.center>=0?ea.center:-1,ea.left>=0?ea.left:-1,ea.vertical>=0?ea.vertical:-1,mu,v0,o1,void 0!==fl?fl:Bi.collisionBoxArray.length,void 0!==fl?fl+1:Bi.collisionBoxArray.length,void 0!==Sc?Sc:Bi.collisionBoxArray.length,void 0!==Sc?Sc+1:Bi.collisionBoxArray.length,void 0!==Pd?Pd:Bi.collisionBoxArray.length,void 0!==Pd?Pd+1:Bi.collisionBoxArray.length,r1||Bi.collisionBoxArray.length,r1?r1+1:Bi.collisionBoxArray.length,Fr,GE,HE,iA,jE,DI,0,Io,ub,qp,0,Sm?1:0)}(a,Ut,Gi,Ti,d,f,v,Lt,a.layers[0],a.collisionBoxArray,s.index,s.sourceLayerIndex,a.index,We,it,k,0,tt,xt,le,s,y,R,L,V,q,Z)};if("line"===Rt)for(const Ti of Hy(s.geometry,0,0,Nt,Nt)){const Ut=hm(Ti,Be,ct,d.vertical||xe,f,Te,ke,a.overscaling,Nt);for(const on of Ut)xe&&mE(a,xe.text,_t,on)||Ui(Ti,on,V)}else if("line-center"===Rt){for(const Ti of s.geometry)if(Ti.length>1){const Ut=Iw(Ti,ct,d.vertical||xe,f,Te,ke);Ut&&Ui(Ti,Ut,V)}}else if("Polygon"===s.type)for(const Ti of kv(s.geometry,0)){const Ut=jv(Ti,16);Ui(Ti[0],new cu(Ut.x,Ut.y,0,0,void 0),V)}else if("LineString"===s.type)for(const Ti of s.geometry)Ui(Ti,new cu(Ti[0].x,Ti[0].y,0,0,void 0),V);else if("Point"===s.type)for(const Ti of s.geometry)for(const Ut of Ti)Ui([Ut],new cu(Ut.x,Ut.y,0,0,void 0),V)}const Rp=255,kd=Rp*Vh;function qy(a,s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne,le){const xe=function(Le,ke,Be,We,tt,ct,it,xt){const Rt=[];if(0===ke.positionedLines.length)return Rt;const _t=We.layout.get("text-rotate").evaluate(ct,{})*Math.PI/180,At=function(Ui){const Ti=Ui[0],Ut=Ui[1],on=Ti*Ut;return on>0?[Ti,-Ut]:on<0?[-Ti,Ut]:0===Ti?[Ut,Ti]:[Ut,-Ti]}(Be);let ft=Math.abs(ke.top-ke.bottom);for(const Ui of ke.positionedLines)ft-=Ui.lineOffset;const Dt=ke.positionedLines.length,ii=ft/Dt;let Lt=ke.top-Be[1];for(let Ui=0;Ui<Dt;++Ui){const Ti=ke.positionedLines[Ui];Lt=$r(ke,ii,Lt,Ui);for(const Ut of Ti.positionedGlyphs){if(!Ut.rect)continue;const on=Ut.rect||{};let Gi=Zg+1,Bi=!0,Gt=1,Qi=0;if(Ut.imageName){const Uo=it[Ut.imageName];if(!Uo)continue;if(Uo.sdf){Qe("SDF images are not supported in formatted text and will be ignored.");continue}Bi=!1,Gt=Uo.pixelRatio,Gi=sa/Gt}const Hn=(tt||xt)&&Ut.vertical,hn=Ut.metrics.advance*Ut.scale/2,Yn=Ut.metrics,In=Ut.rect;if(null===In)continue;xt&&ke.verticalizable&&(Qi=Ut.imageName?hn-Ut.metrics.width*Ut.scale/2:0);const xr=tt?[Ut.x+hn,Ut.y]:[0,0];let Rn=[0,0],po=[0,0],Fr=!1;tt||(Hn?(po=[Ut.x+hn+At[0],Ut.y+At[1]-Qi],Fr=!0):Rn=[Ut.x+hn+Be[0],Ut.y+Be[1]-Qi]);const Mr=In.w*Ut.scale/(Gt*(Ut.localGlyph?Ll:1)),Er=In.h*Ut.scale/(Gt*(Ut.localGlyph?Ll:1));let Gr,Mo,Jr,ms;if(Hn){const Uo=Ut.y-Lt,ts=new mt(-hn,hn-Uo),ma=-Math.PI/2,pa=new mt(...po);Gr=new mt(-hn+Rn[0],Rn[1]),Gr._rotateAround(ma,ts)._add(pa),Gr.x+=-Uo+hn,Gr.y-=(Yn.left-Gi)*Ut.scale;const ga=Ut.imageName?Yn.advance*Ut.scale:al*Ut.scale,Co=String.fromCodePoint(Ut.glyph);vI(Co)?Gr.x+=(1-Gi)*Ut.scale:Ew(Co)?Gr.x+=ga-Yn.height*Ut.scale+(-Gi-1)*Ut.scale:Gr.x+=Ut.imageName||Yn.width+2*Gi===In.w&&Yn.height+2*Gi===In.h?(ga-Er)/2:(ga-(Yn.height+2*Gi)*Ut.scale)/2,Mo=new mt(Gr.x,Gr.y-Mr),Jr=new mt(Gr.x+Er,Gr.y),ms=new mt(Gr.x+Er,Gr.y-Mr)}else{const Uo=(Yn.left-Gi)*Ut.scale-hn+Rn[0],ts=(-Yn.top-Gi)*Ut.scale+Rn[1],ma=Uo+Mr,pa=ts+Er;Gr=new mt(Uo,ts),Mo=new mt(ma,ts),Jr=new mt(Uo,pa),ms=new mt(ma,pa)}if(_t){let Uo;Uo=tt?new mt(0,0):Fr?new mt(At[0],At[1]):new mt(Be[0],Be[1]),Gr._rotateAround(_t,Uo),Mo._rotateAround(_t,Uo),Jr._rotateAround(_t,Uo),ms._rotateAround(_t,Uo)}const Is=new mt(0,0),aa=new mt(0,0);Rt.push({tl:Gr,tr:Mo,bl:Jr,br:ms,texPrimary:on,texSecondary:void 0,writingMode:ke.writingMode,glyphOffset:xr,sectionIndex:Ut.sectionIndex,isSDF:Bi,pixelOffsetTL:Is,pixelOffsetBR:aa,minFontScaleX:0,minFontScaleY:0})}}return Rt}(0,f,k,y,E,M,v,a.allowVerticalPlacement),Ee=a.textSizeData;let Te=null;"source"===Ee.kind?(Te=[Vh*y.layout.get("text-size").evaluate(M,{},ne)],Te[0]>kd&&Qe(`${a.layerIds[0]}: Value for "text-size" is >= ${Rp}. Reduce your "text-size".`)):"composite"===Ee.kind&&(Te=[Vh*Z.compositeTextSizes[0].evaluate(M,{},ne),Vh*Z.compositeTextSizes[1].evaluate(M,{},ne)],(Te[0]>kd||Te[1]>kd)&&Qe(`${a.layerIds[0]}: Value for "text-size" is >= ${Rp}. Reduce your "text-size".`)),a.addSymbols(a.text,xe,Te,k,E,M,L,s,d,R.lineStartIndex,R.lineLength,q,J,ne,le,!1);for(const Le of V)j[Le]=a.text.placedSymbolArray.length-1;return 4*xe.length}function Gv(a){for(const s in a)return a[s];return null}function r_(a,s,d,f,v,y,E,M,k,R){let L=E.top,V=E.bottom,j=E.left,q=E.right;const Z=E.collisionPadding;if(Z&&(j-=Z[0],L-=Z[1],q+=Z[2],V+=Z[3]),k){const J=new mt(j,L),ne=new mt(q,L),le=new mt(j,V),xe=new mt(q,V),Ee=mi(k);let Te=new mt(0,0);R&&(Te=new mt(R[0],R[1])),J._rotateAround(Ee,Te),ne._rotateAround(Ee,Te),le._rotateAround(Ee,Te),xe._rotateAround(Ee,Te),j=Math.min(J.x,ne.x,le.x,xe.x),q=Math.max(J.x,ne.x,le.x,xe.x),L=Math.min(J.y,ne.y,le.y,xe.y),V=Math.max(J.y,ne.y,le.y,xe.y)}return a.emplaceBack(s.x,s.y,s.z,d.x,d.y,j,L,q,V,M,f,v,y),a.length-1}function Hv(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const s=a.bottom-a.top;return s>0?Math.max(10,s):null}function mE(a,s,d,f){const v=a.compareText;if(s in v){const y=v[s];for(let E=y.length-1;E>=0;E--)if(f.dist(y[E])<d)return!0}else v[s]=[];return v[s].push(f),!1}function $v(a,s){const d=a.fovAboveCenter,f=a.elevation?a.elevation.getMinElevationBelowMSL()*s:0,v=(a._camera.position[2]*a.worldSize-f)/Math.cos(a._pitch),y=Math.sin(d)*v/Math.sin(Math.max(Math.PI/2-a._pitch-d,.01)),E=Math.sin(a._pitch)*y+v;return Math.min(1.01*E,v*(1/a._horizonShift))}function o_(a,s){if(!s.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:s};const d=Math.pow(2,-a.z),f=a.x*d,v=(a.x+1)*d,y=a.y*d,E=(a.y+1)*d,M=Dn(f),k=Dn(v),R=fr(y),L=fr(E),V=s.project(M,R),j=s.project(k,R),q=s.project(k,L),Z=s.project(M,L);let J=Math.min(V.x,j.x,q.x,Z.x),ne=Math.min(V.y,j.y,q.y,Z.y),le=Math.max(V.x,j.x,q.x,Z.x),xe=Math.max(V.y,j.y,q.y,Z.y);const Ee=d/16;function Te(ke,Be,We,tt,ct,it){const xt=(We+ct)/2,Rt=(tt+it)/2,_t=s.project(Dn(xt),fr(Rt)),At=Math.max(0,J-_t.x,ne-_t.y,_t.x-le,_t.y-xe);J=Math.min(J,_t.x),le=Math.max(le,_t.x),ne=Math.min(ne,_t.y),xe=Math.max(xe,_t.y),At>Ee&&(Te(ke,_t,We,tt,xt,Rt),Te(_t,Be,xt,Rt,ct,it))}Te(V,j,f,y,v,y),Te(j,q,v,y,v,E),Te(q,Z,v,E,f,E),Te(Z,V,f,E,f,y),J-=Ee,ne-=Ee,le+=Ee,xe+=Ee;const Le=1/Math.max(le-J,xe-ne);return{scale:Le,x:J*Le,y:ne*Le,x2:le*Le,y2:xe*Le,projection:s}}function pE(a,{x:s,y:d},f=0){return new mt(((s-f)*a.scale-a.x)*Nt,(d*a.scale-a.y)*Nt)}const yI=_.a6.identity(new Float32Array(16));class gm{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,d){return{x:0,y:0,z:0}}unproject(s,d){return new Ze(0,0)}projectTilePoint(s,d,f){return{x:s,y:d,z:0}}locationPoint(s,d,f=!0){return s._coordinatePoint(s.locationCoordinate(d),f)}pixelsPerMeter(s,d){return xn(1,s)*d}pixelSpaceConversion(s,d,f){return 1}farthestPixelDistance(s){return $v(s,s.pixelsPerMeter)}pointCoordinate(s,d,f,v){const y=s.horizonLineFromTop(!1),E=new mt(d,Math.max(y,f));return s.rayIntersectionCoordinate(s.pointRayIntersection(E,v))}pointCoordinate3D(s,d,f){const v=new mt(d,f);if(s.elevation)return s.elevation.pointCoordinate(v);{const y=this.pointCoordinate(s,v.x,v.y,0);return[y.x,y.y,y.z]}}isPointAboveHorizon(s,d){if(s.elevation)return!this.pointCoordinate3D(s,d.x,d.y);const f=s.horizonLineFromTop();return d.y<f}createInversionMatrix(s,d){return yI}createTileMatrix(s,d,f){let v,y,E;const M=f.canonical,k=_.a6.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const R=o_(M,this);v=1,y=R.x+f.wrap*R.scale,E=R.y,_.a6.scale(k,k,[v/R.scale,v/R.scale,s.pixelsPerMeter/d])}else v=d/s.zoomScale(M.z),y=(M.x+Math.pow(2,M.z)*f.wrap)*v,E=M.y*v;return _.a6.translate(k,k,[y,E,0]),_.a6.scale(k,k,[v/Nt,v/Nt,1]),k}upVector(s,d,f){return[0,0,1]}upVectorScale(s,d,f){return{metersToTile:1}}}class xI extends gm{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[d,f]=this.parallels=s.parallels||[29.5,45.5],v=Math.sin(mi(d));this.n=(v+Math.sin(mi(f)))/2,this.c=1+v*(2*this.n-v),this.r0=Math.sqrt(this.c)/this.n}project(s,d){const{n:f,c:v,r0:y}=this,E=mi(s-this.center[0]),M=mi(d),k=Math.sqrt(v-2*f*Math.sin(M))/f;return{x:k*Math.sin(E*f),y:k*Math.cos(E*f)-y,z:0}}unproject(s,d){const{n:f,c:v,r0:y}=this,E=y+d;let M=Math.atan2(s,Math.abs(E))*Math.sign(E);E*f<0&&(M-=Math.PI*Math.sign(s)*Math.sign(E));const k=mi(this.center[0])*f;M=Vr(M,-Math.PI-k,Math.PI-k);const R=Ii(Mn(M/f)+this.center[0],-180,180),L=Math.asin(Ii((v-(s*s+E*E)*f*f)/(2*f),-1,1)),V=Ii(Mn(L),-Mi,Mi);return new Ze(R,V)}}const Yy=1.340264,Zy=-.081106,Pp=893e-6,_m=.003796,Wv=Math.sqrt(3)/2;class RM extends gm{project(s,d){d=d/180*Math.PI,s=s/180*Math.PI;const f=Math.asin(Wv*Math.sin(d)),v=f*f,y=v*v*v;return{x:.5*(s*Math.cos(f)/(Wv*(Yy+3*Zy*v+y*(7*Pp+9*_m*v)))/Math.PI+.5),y:1-.5*(f*(Yy+Zy*v+y*(Pp+_m*v))/Math.PI+1),z:0}}unproject(s,d){s=(2*s-.5)*Math.PI;let f=d=(2*(1-d)-1)*Math.PI,v=f*f,y=v*v*v;for(let L,V,j,q=0;q<12&&(V=f*(Yy+Zy*v+y*(Pp+_m*v))-d,j=Yy+3*Zy*v+y*(7*Pp+9*_m*v),L=V/j,f=Ii(f-L,-Math.PI/3,Math.PI/3),v=f*f,y=v*v*v,!(Math.abs(L)<1e-12));++q);const E=Wv*s*(Yy+3*Zy*v+y*(7*Pp+9*_m*v))/Math.cos(f),M=Math.asin(Math.sin(f)/Wv),k=Ii(180*E/Math.PI,-180,180),R=Ii(180*M/Math.PI,-Mi,Mi);return new Ze(k,R)}}class gE extends gm{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,d){return{x:.5+s/360,y:.5-d/360,z:0}}unproject(s,d){const f=360*(s-.5),v=Ii(360*(.5-d),-Mi,Mi);return new Ze(f,v)}}const zs=Math.PI/2;function Ky(a){return Math.tan((zs+a)/2)}class PM extends gm{constructor(s){super(s),this.center=s.center||[0,30];const[d,f]=this.parallels=s.parallels||[30,30];let v=mi(d),y=mi(f);this.southernCenter=v+y<0,this.southernCenter&&(v=-v,y=-y);const E=Math.cos(v),M=Ky(v);this.n=v===y?Math.sin(v):Math.log(E/Math.cos(y))/Math.log(Ky(y)/M),this.f=E*Math.pow(Ky(v),this.n)/this.n}project(s,d){d=mi(d),this.southernCenter&&(d=-d),s=mi(s-this.center[0]);const f=1e-6,{n:v,f:y}=this;y>0?d<-zs+f&&(d=-zs+f):d>zs-f&&(d=zs-f);const E=y/Math.pow(Ky(d),v);let M=E*Math.sin(v*s),k=y-E*Math.cos(v*s);return M=.5*(M/Math.PI+.5),k=.5*(k/Math.PI+.5),{x:M,y:this.southernCenter?k:1-k,z:0}}unproject(s,d){s=(2*s-.5)*Math.PI,this.southernCenter&&(d=1-d),d=(2*(1-d)-.5)*Math.PI;const{n:f,f:v}=this,y=v-d,E=Math.sign(y),M=Math.sign(f)*Math.sqrt(s*s+y*y);let k=Math.atan2(s,Math.abs(y))*E;y*f<0&&(k-=Math.PI*Math.sign(s)*E);const R=Ii(Mn(k/f)+this.center[0],-180,180),L=Ii(Mn(2*Math.atan(Math.pow(v/M,1/f))-zs),-Mi,Mi);return new Ze(R,this.southernCenter?-L:L)}}class OM extends gm{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,d){return{x:Sn(s),y:bn(d),z:0}}unproject(s,d){const f=Dn(s),v=fr(d);return new Ze(f,v)}}const Qy=mi(Mi);class _E extends gm{project(s,d){const f=(d=mi(d))*d,v=f*f;return{x:.5*((s=mi(s))*(.8707-.131979*f+v*(v*(.003971*f-.001529*v)-.013791))/Math.PI+.5),y:1-.5*(d*(1.007226+f*(.015085+v*(.028874*f-.044475-.005916*v)))/Math.PI+1),z:0}}unproject(s,d){s=(2*s-.5)*Math.PI;let f=d=(2*(1-d)-1)*Math.PI,v=25,y=0,E=f*f;do{E=f*f;const R=E*E;y=(f*(1.007226+E*(.015085+R*(.028874*E-.044475-.005916*R)))-d)/(1.007226+E*(.045255+R*(.259866*E-.311325-.005916*11*R))),f=Ii(f-y,-Qy,Qy)}while(Math.abs(y)>1e-6&&--v>0);E=f*f;const M=Ii(Mn(s/(.8707+E*(E*(E*E*E*(.003971-.001529*E)-.013791)-.131979))),-180,180),k=Mn(f);return new Ze(M,k)}}const Ow=mi(Mi);class wI extends gm{project(s,d){d=mi(d),s=mi(s);const f=Math.cos(d),v=2/Math.PI,y=Math.acos(f*Math.cos(s/2)),E=Math.sin(y)/y,M=.5*(s*v+2*f*Math.sin(s/2)/E)||0,k=.5*(d+Math.sin(d)/E)||0;return{x:.5*(M/Math.PI+.5),y:1-.5*(k/Math.PI+1),z:0}}unproject(s,d){let f=s=(2*s-.5)*Math.PI,v=d=(2*(1-d)-1)*Math.PI,y=25;const E=1e-6;let M=0,k=0;do{const R=Math.cos(v),L=Math.sin(v),V=2*L*R,j=L*L,q=R*R,Z=Math.cos(f/2),J=Math.sin(f/2),ne=2*Z*J,le=J*J,xe=1-q*Z*Z,Ee=xe?1/xe:0,Te=xe?Math.acos(R*Z)*Math.sqrt(1/xe):0,Le=.5*(2*Te*R*J+2*f/Math.PI)-s,ke=.5*(Te*L+v)-d,Be=.5*Ee*(q*le+Te*R*Z*j)+1/Math.PI,We=Ee*(ne*V/4-Te*L*J),tt=.125*Ee*(V*J-Te*L*q*ne),ct=.5*Ee*(j*Z+Te*le*R)+.5,it=We*tt-ct*Be;M=(ke*We-Le*ct)/it,k=(Le*tt-ke*Be)/it,f=Ii(f-M,-Math.PI,Math.PI),v=Ii(v-k,-Ow,Ow)}while((Math.abs(M)>E||Math.abs(k)>E)&&--y>0);return new Ze(Mn(f),Mn(v))}}class Xv extends gm{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(mi(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,d){const{scale:f,cosPhi:v}=this;return{x:mi(s)*v*f+.5,y:-Math.sin(mi(d))/v*f+.5,z:0}}unproject(s,d){const{scale:f,cosPhi:v}=this,y=-(d-.5)/f,E=Ii(Mn((s-.5)/f)/v,-180,180),M=Math.asin(Ii(y*v,-1,1)),k=Ii(Mn(M),-Mi,Mi);return new Ze(E,k)}}class vE extends OM{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,d,f){const v=wv(s,d,f),y=Cy(xd(f));return _.N.transformMat4(v,v,y),{x:v[0],y:v[1],z:v[2]}}locationPoint(s,d){const f=rt(d.lat,d.lng),v=_.N.normalize([],f),y=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(d),s._centerAltitude):s._centerAltitude,E=xn(1,0)*Nt*y;_.N.scaleAndAdd(f,f,v,E);const M=_.a6.identity(new Float64Array(16));return _.a6.multiply(M,s.pixelMatrix,s.globeMatrix),_.N.transformMat4(f,f,M),new mt(f[0],f[1])}pixelsPerMeter(s,d){return xn(1,0)*d}pixelSpaceConversion(s,d,f){const v=xn(1,s)*d,y=rr(xn(1,45)*d,v,f);return this.pixelsPerMeter(s,d)/y}createTileMatrix(s,d,f){const v=lw(xd(f.canonical));return _.a6.multiply(new Float64Array(16),s.globeMatrix,v)}createInversionMatrix(s,d){const{center:f}=s,v=Cy(xd(d));return _.a6.rotateY(v,v,mi(f.lng)),_.a6.rotateX(v,v,mi(f.lat)),_.a6.scale(v,v,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(v)}pointCoordinate(s,d,f,v){return aw(s,d,f,!0)||new Sr(0,0)}pointCoordinate3D(s,d,f){const v=this.pointCoordinate(s,d,f,0);return[v.x,v.y,v.z]}isPointAboveHorizon(s,d){return!aw(s,d.x,d.y,!1)}farthestPixelDistance(s){const d=function(v,y){const E=v.cameraToCenterDistance,M=v._centerAltitude*y,k=v._camera,R=v._camera.forward(),L=_.N.add([],_.N.scale([],R,-E),[0,0,M]),V=v.worldSize/(2*Math.PI),j=[0,0,-V],q=v.width/v.height,Z=Math.tan(v.fovAboveCenter),J=_.N.scale([],k.up(),Z),ne=_.N.scale([],k.right(),Z*q),le=_.N.normalize([],_.N.add([],_.N.add([],R,J),ne)),xe=[];let Ee;if(new bv(L,le).closestPointOnSphere(j,V,xe)){const Te=_.N.add([],xe,j),Le=_.N.sub([],Te,L);Ee=Math.cos(v.fovAboveCenter)*_.N.length(Le)}else{const Te=_.N.sub([],L,j),Le=_.N.sub([],j,L);_.N.normalize(Le,Le);const ke=_.N.length(Te)-V;Ee=Math.sqrt(ke*(ke+2*V));const Be=Math.acos(Ee/(V+ke))-Math.acos(_.N.dot(R,Le));Ee*=Math.cos(Be)}return 1.01*Ee}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),f=Ih(s.zoom);if(f>0){const v=$v(s,xn(1,s.center.lat)*s.worldSize),y=s.worldSize/(2*Math.PI),E=Math.max(s.width,s.height)/s.worldSize*Math.PI;return rr(d,v+y*(1-Math.cos(E)),Math.pow(f,10))}return d}upVector(s,d,f){return wv(d,f,s,1)}upVectorScale(s){return{metersToTile:yd(Bg(xd(s)))}}}function qv(a){const s=a.parallels,d=!!s&&Math.abs(s[0]+s[1])<.01;switch(a.name){case"mercator":return new OM(a);case"equirectangular":return new gE(a);case"naturalEarth":return new _E(a);case"equalEarth":return new RM(a);case"winkelTripel":return new wI(a);case"albers":return d?new Xv(a):new xI(a);case"lambertConformalConic":return d?new Xv(a):new PM(a);case"globe":return new vE(a)}throw new Error(`Invalid projection name: ${a.name}`)}const Kc=Ep.types,Jy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ju(a,s,d,f,v,y,E,M,k,R,L,V,j){const q=M?Math.min(kd,Math.round(M[0])):0,Z=M?Math.min(kd,Math.round(M[1])):0;a.emplaceBack(s,d,Math.round(32*f),Math.round(32*v),y,E,(q<<1)+(k?1:0),Z,16*R,16*L,256*V,256*j)}function Yv(a,s,d){a.emplaceBack(s,d)}function Zv(a,s,d,f,v,y,E){a.emplaceBack(s,d,f,v,y,E)}function s_(a,s,d,f,v){a.emplaceBack(s,d,f,v),a.emplaceBack(s,d,f,v),a.emplaceBack(s,d,f,v),a.emplaceBack(s,d,f,v)}function bE(a){for(const s of a.sections)if(ty(s.text))return!0;return!1}class ec{constructor(s){this.layoutVertexArray=new jf,this.indexArray=new ln,this.programConfigurations=s,this.segments=new Wo,this.dynamicLayoutVertexArray=new Fu,this.opacityVertexArray=new ap,this.placedSymbolArray=new ud,this.iconTransitioningVertexArray=new $c,this.globeExtVertexArray=new kg,this.zOffsetVertexArray=new Ys}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(s,d,f,v,y){this.isEmpty()||(f&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,hI.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,fI.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,Jy,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=s.createVertexBuffer(this.iconTransitioningVertexArray,pI.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,EM.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||y)&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,mI.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||v)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Oi(ec,"SymbolBuffers");class Kv{constructor(s,d,f){this.layoutVertexArray=new s,this.layoutAttributes=d,this.indexArray=new f,this.segments=new Wo,this.collisionVertexArray=new Fi,this.collisionVertexArrayExt=new Fu}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,gI.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,_I.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Oi(Kv,"CollisionBuffers");class e0{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(E=>E.fqid),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=_.a6.identity([]),this.placementViewportMatrix=_.a6.identity([]);const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Uy(this.zoom,d["text-size"]),this.iconSizeData=Uy(this.zoom,d["icon-size"]);const f=this.layers[0].layout,v=f.get("symbol-sort-key"),y=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==y&&void 0!==v.constantOr(1),this.sortFeaturesByY=("viewport-y"===y||"auto"===y&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(E=>Jl[E]),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=s.sourceID,this.projection=s.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=f.get("symbol-z-elevate")}createArrays(){this.text=new ec(new ae(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new ec(new ae(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new tu,this.lineVertexArray=new Ch,this.symbolInstances=new uv}calculateGlyphDependencies(s,d,f,v,y){for(let E=0;E<s.length;E++){const M=s.codePointAt(E);if(void 0===M)break;if(d[M]=!0,v&&y&&M<=65535){const k=Cw[s.charAt(E)];k&&(d[k.charCodeAt(0)]=!0)}}}populate(s,d,f,v){const y=this.layers[0],E=y.layout,M="globe"===this.projection.name,k=E.get("text-font"),R=E.get("text-field"),L=E.get("icon-image"),V=("constant"!==R.value.kind||R.value.value instanceof Ws&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&("constant"!==k.value.kind||k.value.value.length>0),j="constant"!==L.value.kind||!!L.value.value||Object.keys(L.parameters).length>0,q=E.get("symbol-sort-key");if(this.features=[],!V&&!j)return;const Z=d.iconDependencies,J=d.glyphDependencies,ne=d.availableImages,le=new qr(this.zoom);for(const{feature:xe,id:Ee,index:Te,sourceLayerIndex:Le}of s){const ke=y._featureFilter.needGeometry,Be=ks(xe,ke);if(!y._featureFilter.filter(le,Be,f))continue;if(ke||(Be.geometry=Ks(xe,f,v)),M&&1!==xe.type&&f.z<=5){const it=Be.geometry,xt=.98078528056,Rt=(_t,At)=>{const ft=wv(_t.x,_t.y,f,1),Dt=wv(At.x,At.y,f,1);return _.N.dot(ft,Dt)<xt};for(let _t=0;_t<it.length;_t++)it[_t]=ws(it[_t],Rt)}let We,tt;if(V){const it=y.getValueAndResolveTokens("text-field",Be,f,ne),xt=Ws.factory(it);bE(xt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ps()||this.hasRTLText&&na.isParsed())&&(We=gL(xt,y,Be))}if(j){const it=y.getValueAndResolveTokens("icon-image",Be,f,ne);tt=it instanceof rn?it:rn.fromString(it)}if(!We&&!tt)continue;const ct=this.sortFeaturesByKey?q.evaluate(Be,{},f):void 0;if(this.features.push({id:Ee,text:We,icon:tt,index:Te,sourceLayerIndex:Le,geometry:Be.geometry,properties:xe.properties,type:Kc[xe.type],sortKey:ct}),tt&&(Z[tt.namePrimary]=!0,tt.nameSecondary&&(Z[tt.nameSecondary]=!0)),We){const it=k.evaluate(Be,{},f).join(","),xt="map"===E.get("text-rotation-alignment")&&"point"!==E.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Jl.vertical)>=0;for(const Rt of We.sections)if(Rt.image)Z[Rt.image.namePrimary]=!0;else{const _t=Uc(We.toString()),At=Rt.fontStack||it,ft=J[At]=J[At]||{};this.calculateGlyphDependencies(Rt.text,ft,xt,this.allowVerticalPlacement,_t)}}}"line"===E.get("symbol-placement")&&(this.features=function(xe){const Ee={},Te={},Le=[];let ke=0;function Be(it){Le.push(xe[it]),ke++}function We(it,xt,Rt){const _t=Te[it];return delete Te[it],Te[xt]=_t,Le[_t].geometry[0].pop(),Le[_t].geometry[0]=Le[_t].geometry[0].concat(Rt[0]),_t}function tt(it,xt,Rt){const _t=Ee[xt];return delete Ee[xt],Ee[it]=_t,Le[_t].geometry[0].shift(),Le[_t].geometry[0]=Rt[0].concat(Le[_t].geometry[0]),_t}function ct(it,xt,Rt){const _t=Rt?xt[0][xt[0].length-1]:xt[0][0];return`${it}:${_t.x}:${_t.y}`}for(let it=0;it<xe.length;it++){const xt=xe[it],Rt=xt.geometry,_t=xt.text?xt.text.toString():null;if(!_t){Be(it);continue}const At=ct(_t,Rt),ft=ct(_t,Rt,!0);if(At in Te&&ft in Ee&&Te[At]!==Ee[ft]){const Dt=tt(At,ft,Rt),ii=We(At,ft,Le[Dt].geometry);delete Ee[At],delete Te[ft],Te[ct(_t,Le[ii].geometry,!0)]=ii,Le[Dt].geometry=null}else At in Te?We(At,ft,Rt):ft in Ee?tt(At,ft,Rt):(Be(it),Ee[At]=ke-1,Te[ft]=ke-1)}return Le.filter(it=>it.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((xe,Ee)=>xe.sortKey-Ee.sortKey)}update(s,d,f,v,y){const E=0!==Object.keys(s).length;if(E&&!this.stateDependentLayers.length)return;const M=E?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(s,d,M,f,v,y),this.icon.programConfigurations.updatePaintArrays(s,d,M,f,v,y)}updateZOffset(){const s=(y,E,M)=>{f+=E,f>y.length&&y.resize(f);for(let k=-E;k<0;k++)y.emplace(k+f,M)},d=(y,E,M)=>{v+=E,v>y.length&&y.resize(v);for(let k=-E;k<0;k++)y.emplace(k+v,M)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let f=0,v=0;for(let y=0;y<this.symbolInstances.length;y++){const E=this.symbolInstances.get(y),{numHorizontalGlyphVertices:M,numVerticalGlyphVertices:k,numIconVertices:R}=E,L=E.zOffset,V=R>0;if((M>0||k>0)&&(s(this.text.zOffsetVertexArray,M,L),s(this.text.zOffsetVertexArray,k,L)),V){const{placedIconSymbolIndex:j,verticalPlacedIconSymbolIndex:q}=E;j>=0&&d(this.icon.zOffsetVertexArray,R,L),q>=0&&d(this.icon.zOffsetVertexArray,E.numVerticalIconVertices,L)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=qv(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,d){const f=this.lineVertexArray.length;if(void 0!==s.segment)for(const{x:v,y}of d)this.lineVertexArray.emplaceBack(v,y);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(s,d,f,v,y,E,M,k,R,L,V,j,q,Z,J,ne){const le=s.indexArray,xe=s.layoutVertexArray,Ee=s.globeExtVertexArray,Te=s.segments.prepareSegment(4*d.length,xe,le,this.canOverlap?E.sortKey:void 0),Le=this.glyphOffsetArray.length,ke=Te.vertexLength,Be=this.allowVerticalPlacement&&M===Jl.vertical?Math.PI/2:0,We=E.text&&E.text.sections;for(let ct=0;ct<d.length;ct++){const{tl:it,tr:xt,bl:Rt,br:_t,texPrimary:At,texSecondary:ft,pixelOffsetTL:Dt,pixelOffsetBR:ii,minFontScaleX:Lt,minFontScaleY:Ui,glyphOffset:Ti,isSDF:Ut,sectionIndex:on}=d[ct],Gi=Te.vertexLength,Bi=Ti[1];if(Ju(xe,R.x,R.y,it.x,Bi+it.y,At.x,At.y,f,Ut,Dt.x,Dt.y,Lt,Ui),Ju(xe,R.x,R.y,xt.x,Bi+xt.y,At.x+At.w,At.y,f,Ut,ii.x,Dt.y,Lt,Ui),Ju(xe,R.x,R.y,Rt.x,Bi+Rt.y,At.x,At.y+At.h,f,Ut,Dt.x,ii.y,Lt,Ui),Ju(xe,R.x,R.y,_t.x,Bi+_t.y,At.x+At.w,At.y+At.h,f,Ut,ii.x,ii.y,Lt,Ui),k){const{x:Gt,y:Qi,z:Hn}=k.anchor,[hn,Yn,In]=k.up;Zv(Ee,Gt,Qi,Hn,hn,Yn,In),Zv(Ee,Gt,Qi,Hn,hn,Yn,In),Zv(Ee,Gt,Qi,Hn,hn,Yn,In),Zv(Ee,Gt,Qi,Hn,hn,Yn,In),s_(s.dynamicLayoutVertexArray,Gt,Qi,Hn,Be)}else s_(s.dynamicLayoutVertexArray,R.x,R.y,R.z,Be);if(ne){const Gt=ft||At;Yv(s.iconTransitioningVertexArray,Gt.x,Gt.y),Yv(s.iconTransitioningVertexArray,Gt.x+Gt.w,Gt.y),Yv(s.iconTransitioningVertexArray,Gt.x,Gt.y+Gt.h),Yv(s.iconTransitioningVertexArray,Gt.x+Gt.w,Gt.y+Gt.h)}le.emplaceBack(Gi,Gi+1,Gi+2),le.emplaceBack(Gi+1,Gi+2,Gi+3),Te.vertexLength+=4,Te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ti[0]),ct!==d.length-1&&on===d[ct+1].sectionIndex||s.programConfigurations.populatePaintArrays(xe.length,E,E.index,{},q,Z,J,We&&We[on])}const tt=k?k.anchor:R;s.placedSymbolArray.emplaceBack(tt.x,tt.y,tt.z,R.x,R.y,Le,this.glyphOffsetArray.length-Le,ke,L,V,R.segment,f?f[0]:0,f?f[1]:0,v[0],v[1],M,0,!1,0,j,0)}_commitLayoutVertex(s,d,f,v,y,E,M){s.emplaceBack(d,f,v,y,E,Math.round(M.x),Math.round(M.y))}_addCollisionDebugVertices(s,d,f,v,y,E,M){const k=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),R=k.vertexLength,L=M.tileAnchorX,V=M.tileAnchorY;for(let q=0;q<4;q++)f.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(f.collisionVertexArrayExt,d,s.padding,M.zOffset),this._commitLayoutVertex(f.layoutVertexArray,v,y,E,L,V,new mt(s.x1,s.y1)),this._commitLayoutVertex(f.layoutVertexArray,v,y,E,L,V,new mt(s.x2,s.y1)),this._commitLayoutVertex(f.layoutVertexArray,v,y,E,L,V,new mt(s.x2,s.y2)),this._commitLayoutVertex(f.layoutVertexArray,v,y,E,L,V,new mt(s.x1,s.y2)),k.vertexLength+=4;const j=f.indexArray;j.emplaceBack(R,R+1),j.emplaceBack(R+1,R+2),j.emplaceBack(R+2,R+3),j.emplaceBack(R+3,R),k.primitiveLength+=4}_addTextDebugCollisionBoxes(s,d,f,v,y,E){for(let M=v;M<y;M++){const k=f.get(M),R=this.getSymbolInstanceTextSize(s,E,d,M);this._addCollisionDebugVertices(k,R,this.textCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,E)}}_addIconDebugCollisionBoxes(s,d,f,v,y,E){for(let M=v;M<y;M++){const k=f.get(M),R=this.getSymbolInstanceIconSize(s,d,E.placedIconSymbolIndex);this._addCollisionDebugVertices(k,R,this.iconCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,E)}}generateCollisionDebugBuffers(s,d){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Kv(cd,TM.members,$c),this.iconCollisionBox=new Kv(cd,TM.members,$c);const f=jy(this.iconSizeData,s),v=jy(this.textSizeData,s);for(let y=0;y<this.symbolInstances.length;y++){const E=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(v,s,d,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(v,s,d,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(f,s,d,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(f,s,d,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(s,d,f,v){const y=this.text.placedSymbolArray.get(d.rightJustifiedTextSymbolIndex>=0?d.rightJustifiedTextSymbolIndex:d.centerJustifiedTextSymbolIndex>=0?d.centerJustifiedTextSymbolIndex:d.leftJustifiedTextSymbolIndex>=0?d.leftJustifiedTextSymbolIndex:d.verticalPlacedTextSymbolIndex>=0?d.verticalPlacedTextSymbolIndex:v),E=aE(this.textSizeData,s,y)/al;return this.tilePixelRatio*E}getSymbolInstanceIconSize(s,d,f){const v=this.icon.placedSymbolArray.get(f),y=aE(this.iconSizeData,s,v);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(s,d,f,v){s.emplaceBack(d,-f,-f,v),s.emplaceBack(d,f,-f,v),s.emplaceBack(d,f,f,v),s.emplaceBack(d,-f,f,v)}_updateTextDebugCollisionBoxes(s,d,f,v,y,E){for(let M=v;M<y;M++){const k=f.get(M),R=this.getSymbolInstanceTextSize(s,E,d,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,R,k.padding,E.zOffset)}}_updateIconDebugCollisionBoxes(s,d,f,v,y,E){for(let M=v;M<y;M++){const k=f.get(M),R=this.getSymbolInstanceIconSize(s,d,E.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,R,k.padding,E.zOffset)}}updateCollisionDebugBuffers(s,d){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=jy(this.iconSizeData,s),v=jy(this.textSizeData,s);for(let y=0;y<this.symbolInstances.length;y++){const E=this.symbolInstances.get(y);this._updateTextDebugCollisionBoxes(v,s,d,E.textBoxStartIndex,E.textBoxEndIndex,E),this._updateTextDebugCollisionBoxes(v,s,d,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._updateIconDebugCollisionBoxes(f,s,d,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._updateIconDebugCollisionBoxes(f,s,d,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,d,f,v,y,E,M,k,R){const L={};if(d<f){const{x1:V,y1:j,x2:q,y2:Z,padding:J,projectedAnchorX:ne,projectedAnchorY:le,projectedAnchorZ:xe,tileAnchorX:Ee,tileAnchorY:Te,featureIndex:Le}=s.get(d);L.textBox={x1:V,y1:j,x2:q,y2:Z,padding:J,projectedAnchorX:ne,projectedAnchorY:le,projectedAnchorZ:xe,tileAnchorX:Ee,tileAnchorY:Te},L.textFeatureIndex=Le}if(v<y){const{x1:V,y1:j,x2:q,y2:Z,padding:J,projectedAnchorX:ne,projectedAnchorY:le,projectedAnchorZ:xe,tileAnchorX:Ee,tileAnchorY:Te,featureIndex:Le}=s.get(v);L.verticalTextBox={x1:V,y1:j,x2:q,y2:Z,padding:J,projectedAnchorX:ne,projectedAnchorY:le,projectedAnchorZ:xe,tileAnchorX:Ee,tileAnchorY:Te},L.verticalTextFeatureIndex=Le}if(E<M){const{x1:V,y1:j,x2:q,y2:Z,padding:J,projectedAnchorX:ne,projectedAnchorY:le,projectedAnchorZ:xe,tileAnchorX:Ee,tileAnchorY:Te,featureIndex:Le}=s.get(E);L.iconBox={x1:V,y1:j,x2:q,y2:Z,padding:J,projectedAnchorX:ne,projectedAnchorY:le,projectedAnchorZ:xe,tileAnchorX:Ee,tileAnchorY:Te},L.iconFeatureIndex=Le}if(k<R){const{x1:V,y1:j,x2:q,y2:Z,padding:J,projectedAnchorX:ne,projectedAnchorY:le,projectedAnchorZ:xe,tileAnchorX:Ee,tileAnchorY:Te,featureIndex:Le}=s.get(k);L.verticalIconBox={x1:V,y1:j,x2:q,y2:Z,padding:J,projectedAnchorX:ne,projectedAnchorY:le,projectedAnchorZ:xe,tileAnchorX:Ee,tileAnchorY:Te},L.verticalIconFeatureIndex=Le}return L}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(s,d){const f=s.placedSymbolArray.get(d),v=f.vertexStartIndex+4*f.numGlyphs;for(let y=f.vertexStartIndex;y<v;y+=4)s.indexArray.emplaceBack(y,y+1,y+2),s.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const d=Math.sin(s),f=Math.cos(s),v=[],y=[],E=[];for(let M=0;M<this.symbolInstances.length;++M){E.push(M);const k=this.symbolInstances.get(M);v.push(0|Math.round(d*k.tileAnchorX+f*k.tileAnchorY)),y.push(k.featureIndex)}return E.sort((M,k)=>v[M]-v[k]||y[k]-y[M]),E}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let s=0;s<this.symbolInstances.length;++s)this.symbolInstanceIndexesSortedZOffset.push(s)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((s,d)=>this.symbolInstances.get(d).zOffset-this.symbolInstances.get(s).zOffset)}addToSortKeyRanges(s,d){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===d?f.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const f=this.symbolInstances.get(d);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:y,leftJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:M,placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:R}=f;v>=0&&this.addIndicesForPlacedSymbol(this.text,v),y>=0&&y!==v&&this.addIndicesForPlacedSymbol(this.text,y),E>=0&&E!==y&&E!==v&&this.addIndicesForPlacedSymbol(this.text,E),M>=0&&this.addIndicesForPlacedSymbol(this.text,M),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k),R>=0&&this.addIndicesForPlacedSymbol(this.icon,R)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Oi(e0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),e0.addDynamicAttributes=s_;const LM=new $o({"symbol-placement":new ni(ot.layout_symbol["symbol-placement"]),"symbol-spacing":new ni(ot.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ni(ot.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ji(ot.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ni(ot.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new ni(ot.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new ni(ot.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ni(ot.layout_symbol["icon-ignore-placement"]),"icon-optional":new ni(ot.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ni(ot.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ji(ot.layout_symbol["icon-size"]),"icon-text-fit":new Ji(ot.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ji(ot.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ji(ot.layout_symbol["icon-image"]),"icon-rotate":new Ji(ot.layout_symbol["icon-rotate"]),"icon-padding":new ni(ot.layout_symbol["icon-padding"]),"icon-keep-upright":new ni(ot.layout_symbol["icon-keep-upright"]),"icon-offset":new Ji(ot.layout_symbol["icon-offset"]),"icon-anchor":new Ji(ot.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ni(ot.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ni(ot.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ni(ot.layout_symbol["text-rotation-alignment"]),"text-field":new Ji(ot.layout_symbol["text-field"]),"text-font":new Ji(ot.layout_symbol["text-font"]),"text-size":new Ji(ot.layout_symbol["text-size"]),"text-max-width":new Ji(ot.layout_symbol["text-max-width"]),"text-line-height":new Ji(ot.layout_symbol["text-line-height"]),"text-letter-spacing":new Ji(ot.layout_symbol["text-letter-spacing"]),"text-justify":new Ji(ot.layout_symbol["text-justify"]),"text-radial-offset":new Ji(ot.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ni(ot.layout_symbol["text-variable-anchor"]),"text-anchor":new Ji(ot.layout_symbol["text-anchor"]),"text-max-angle":new ni(ot.layout_symbol["text-max-angle"]),"text-writing-mode":new ni(ot.layout_symbol["text-writing-mode"]),"text-rotate":new Ji(ot.layout_symbol["text-rotate"]),"text-padding":new ni(ot.layout_symbol["text-padding"]),"text-keep-upright":new ni(ot.layout_symbol["text-keep-upright"]),"text-transform":new Ji(ot.layout_symbol["text-transform"]),"text-offset":new Ji(ot.layout_symbol["text-offset"]),"text-allow-overlap":new ni(ot.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ni(ot.layout_symbol["text-ignore-placement"]),"text-optional":new ni(ot.layout_symbol["text-optional"]),visibility:new ni(ot.layout_symbol.visibility)});var t0={paint:new $o({"icon-opacity":new Ji(ot.paint_symbol["icon-opacity"]),"icon-emissive-strength":new Ji(ot.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Ji(ot.paint_symbol["text-emissive-strength"]),"icon-color":new Ji(ot.paint_symbol["icon-color"]),"icon-halo-color":new Ji(ot.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ji(ot.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ji(ot.paint_symbol["icon-halo-blur"]),"icon-translate":new ni(ot.paint_symbol["icon-translate"]),"icon-translate-anchor":new ni(ot.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ji(ot.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Ji(ot.paint_symbol["text-opacity"]),"text-color":new Ji(ot.paint_symbol["text-color"],{runtimeType:Ae,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Ji(ot.paint_symbol["text-halo-color"]),"text-halo-width":new Ji(ot.paint_symbol["text-halo-width"]),"text-halo-blur":new Ji(ot.paint_symbol["text-halo-blur"]),"text-translate":new ni(ot.paint_symbol["text-translate"]),"text-translate-anchor":new ni(ot.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new ni(ot.paint_symbol["icon-color-saturation"])}),layout:LM};class Us{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:Ma,this.defaultValue=s}evaluate(s){if(s.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(s.formattedSection))return d.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Oi(Us,"FormatSectionOverride",{omit:["defaultValue"]});class a_ extends Tl{constructor(s,d,f){super(s,t0,d,f)}recalculate(s,d){super.recalculate(s,d),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const v=[];for(const y of f)v.indexOf(y)<0&&v.push(y);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(s,d,f,v){const y=this.layout.get(s).evaluate(d,{},f,v),E=this._unevaluatedLayout._values[s];return E.isDataDriven()||If(E.value)||!y?y:(M=d.properties,y.replace(/{([^{}]+)}/g,(R,L)=>L in M?String(M[L]):""));var M}createBucket(s){return new e0(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of t0.paint.overridableProperties){if(!a_.hasPaintOverride(this.layout,s))continue;const d=this.paint.get(s),f=new Us(d),v=new ep(f,d.property.specification,this.scope,this.options);let y=null;y="constant"===d.value.kind||"source"===d.value.kind?new Rf("source",v):new ao("composite",v,d.value.zoomStops,d.value._interpolationType),this.paint._values[s]=new Lf(d.property,y,d.parameters)}}_handleOverridablePaintPropertyUpdate(s,d,f){return!(!this.layout||d.isDataDriven()||f.isDataDriven())&&a_.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,d){const f=s.get("text-field"),v=t0.paint.properties[d];let y=!1;const E=M=>{for(const k of M)if(v.overrides&&v.overrides.hasOverride(k))return void(y=!0)};if("constant"===f.value.kind&&f.value.value instanceof Ws)E(f.value.value.sections);else if("source"===f.value.kind){const M=R=>{y||(R instanceof Gd&&cs(R.value)===Qt?E(R.value.sections):R instanceof Pc?E(R.sections):R.eachChild(M))},k=f.value;k._styleExpression&&M(k._styleExpression.expression)}return y}getProgramIds(){const s=0!==this.paint.get("icon-opacity").constantOr(1),d=0!==this.paint.get("text-opacity").constantOr(1),f=[];return s&&f.push("symbolIcon"),d&&f.push("symbolSDF"),f}getDefaultProgramParams(s,d){return{config:new ie(this,d),overrideFog:!1}}}const Op=new $o({visibility:new ni(ot.layout_background.visibility)});var FM={paint:new $o({"background-color":new ni(ot.paint_background["background-color"]),"background-pattern":new ni(ot.paint_background["background-pattern"]),"background-opacity":new ni(ot.paint_background["background-opacity"]),"background-emissive-strength":new ni(ot.paint_background["background-emissive-strength"])}),layout:Op};const NM=new $o({visibility:new ni(ot.layout_raster.visibility)});var BM={paint:new $o({"raster-opacity":new ni(ot.paint_raster["raster-opacity"]),"raster-color":new op(ot.paint_raster["raster-color"]),"raster-color-mix":new ni(ot.paint_raster["raster-color-mix"]),"raster-color-range":new ni(ot.paint_raster["raster-color-range"]),"raster-hue-rotate":new ni(ot.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ni(ot.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ni(ot.paint_raster["raster-brightness-max"]),"raster-saturation":new ni(ot.paint_raster["raster-saturation"]),"raster-contrast":new ni(ot.paint_raster["raster-contrast"]),"raster-resampling":new ni(ot.paint_raster["raster-resampling"]),"raster-fade-duration":new ni(ot.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new ni(ot.paint_raster["raster-emissive-strength"]),"raster-array-band":new ni(ot.paint_raster["raster-array-band"]),"raster-elevation":new ni(ot.paint_raster["raster-elevation"])}),layout:NM},n0=Ir([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class l_{constructor(s,d,f,v){this.context=s,this.format=f,this.texture=s.gl.createTexture(),this.update(d,v)}update(s,d,f){const{width:v,height:y}=s,{context:E}=this,{gl:M}=E;if(M.bindTexture(M.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!d||!1!==d.premultiply)),f||this.size&&this.size[0]===v&&this.size[1]===y){const{x:k,y:R}=f||{x:0,y:0};if(s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||ImageBitmap&&s instanceof ImageBitmap)M.texSubImage2D(M.TEXTURE_2D,0,k,R,M.RGBA,M.UNSIGNED_BYTE,s);else{let L=this.format,V=M.UNSIGNED_BYTE;this.format===M.R32F&&(L=M.RED,V=M.FLOAT),M.texSubImage2D(M.TEXTURE_2D,0,k,R,v,y,L,V,s.data)}}else if(this.size=[v,y],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||ImageBitmap&&s instanceof ImageBitmap){let k=this.format;this.format===M.R8&&(k=M.RED),M.texImage2D(M.TEXTURE_2D,0,this.format,k,M.UNSIGNED_BYTE,s)}else{let k=this.format,R=this.format,L=M.UNSIGNED_BYTE;this.format===M.DEPTH_COMPONENT&&(k=M.DEPTH_COMPONENT16,L=M.UNSIGNED_SHORT),this.format===M.R8&&(R=M.RED),this.format===M.R32F&&(L=M.FLOAT,R=M.RED),M.texImage2D(M.TEXTURE_2D,0,k,v,y,0,R,L,s.data)}this.useMipmap=!(!d||!d.useMipmap),this.useMipmap&&M.generateMipmap(M.TEXTURE_2D)}bind(s,d,f=!1){const{context:v}=this,{gl:y}=v;y.bindTexture(y.TEXTURE_2D,this.texture),s!==this.minFilter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,s),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap&&!f?s===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),d!==this.wrapS&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,d),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,d),this.wrapS=d)}bindExtraParam(s,d,f,v){const{context:y}=this,{gl:E}=y;E.bindTexture(E.TEXTURE_2D,this.texture),d!==this.magFilter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,d),this.magFilter=d),s!==this.minFilter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,this.useMipmap?s===E.NEAREST?E.NEAREST_MIPMAP_NEAREST:E.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),f!==this.wrapS&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,f),this.wrapS=f),v!==this.wrapT&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,v),this.wrapT=v)}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class c_{constructor(s,d){this.context=s,this.texture=d}bind(s,d){const{context:f}=this,{gl:v}=f;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,s),this.minFilter=s),d!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,d),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,d),this.wrapS=d)}}function Id(a,s,d,f,v,y,E,M){const k=[a,s,1,d,f,1,v,y,1],R=[E,M,1],L=_.co.adjoint([],k),[V,j,q]=_.N.transformMat3(R,R,L);return _.co.multiply(k,k,[V,0,0,0,j,0,0,0,q])}function yE(a,s,d,f,v,y,E,M){const k=function(R,L,V,j,q,Z,J,ne){const le=Id(0,0,1,0,1,1,0,1),xe=Id(R,L,V,j,q,Z,J,ne),Ee=_.co.adjoint([],le);return _.co.multiply(xe,xe,Ee)}(a,s,d,f,v,y,E,M);return[k[2]/k[8]/Nt,k[5]/k[8]/Nt]}function r0(a){return[a[0],Math.min(Math.max(a[1],-Mi),Mi)]}class o0 extends Ea{constructor(s,d,f,v){super(),this.id=s,this.dispatcher=f,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(v),this.options=d,this._dirty=!1}load(s,d){if(this._loaded=d||!1,this.fire(new Ps("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return s&&(this.coordinates=s),this._loaded=!0,void this._finishLoading();this._imageRequest=ai(this.map._requestManager.transformRequest(this.url,ca.Image),(f,v)=>{this._imageRequest=null,this._loaded=!0,f?this.fire(new xi(f)):v&&(this.image=v instanceof HTMLImageElement?Ht.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,s&&(this.coordinates=s),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return s.url?(this._imageRequest&&s.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=s.url,this.load(s.coordinates,this._loaded),this):this}setTexture(s){if(!(s.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new c_(this.map.painter.context,s.handle),this.width=s.dimensions[0],this.height=s.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ps("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof c_||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(s){if(this.coordinates=s,this._boundsArray=void 0,this._unsupportedCoords=!1,!s.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let d=s[0][1],f=s[0][1];for(const y of s)y[1]>f&&(f=y[1]),y[1]<d&&(d=y[1]);const v=(f+d)/2;if(v>Mi?this.onNorthPole=!0:v<-Mi&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const y=s.map(Sr.fromLngLat);this.tileID=function(E){let M=1/0,k=1/0,R=-1/0,L=-1/0;for(const J of E)M=Math.min(M,J.x),k=Math.min(k,J.y),R=Math.max(R,J.x),L=Math.max(L,J.y);const V=Math.max(R-M,L-k),j=Math.max(0,Math.floor(-Math.log(V)/Math.LN2)),q=Math.pow(2,j);let Z=Math.floor((M+R)/2*q);return Z>1&&(Z-=1),new Mt(j,Z,Math.floor((k+L)/2*q))}(y),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ps("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(s){for(const le in this.tiles){const xe=this.tiles[le];"loaded"!==xe.state&&(xe.state="loaded",xe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const d=o_(new Mt(0,0,0),this.map.transform.projection),f=[d.projection.project(this.coordinates[0][0],this.coordinates[0][1]),d.projection.project(this.coordinates[1][0],this.coordinates[1][1]),d.projection.project(this.coordinates[2][0],this.coordinates[2][1]),d.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(le){const xe=le[1].x-le[0].x,Ee=le[1].y-le[0].y,Te=le[2].x-le[1].x,Le=le[2].y-le[1].y,ke=le[3].x-le[2].x,Be=le[3].y-le[2].y,We=le[0].x-le[3].x,tt=le[0].y-le[3].y,ct=xe*Le-Te*Ee,it=Te*Be-ke*Le,xt=ke*tt-We*Be,Rt=We*Ee-xe*tt;return ct>0&&it>0&&xt>0&&Rt>0||ct<0&&it<0&&xt<0&&Rt<0}(f))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const v=o_(this.tileID,this.map.transform.projection),[y,E,M,k]=this.coordinates.map(le=>{const xe=v.projection.project(le[0],le[1]);return pE(v,xe)._round()});this.perspectiveTransform=yE(y.x,y.y,E.x,E.y,M.x,M.y,k.x,k.y);const R=this._boundsArray=new Hc;R.emplaceBack(y.x,y.y,0,0),R.emplaceBack(E.x,E.y,Nt,0),R.emplaceBack(k.x,k.y,0,Nt),R.emplaceBack(M.x,M.y,Nt,Nt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=s.createVertexBuffer(R,n0.members),this.boundsSegments=Wo.simpleSegment(0,0,4,2);const L=[],V=[r0((j=this.coordinates)[0]),r0(j[1]),r0(j[2]),r0(j[3])];var j;const[q,Z,J,ne]=function(le){let xe=le[0][0],Ee=xe,Te=le[0][1],Le=Te;for(let ke=1;ke<le.length;ke++)le[ke][0]<xe?xe=le[ke][0]:le[ke][0]>Ee&&(Ee=le[ke][0]),le[ke][1]<Te?Te=le[ke][1]:le[ke][1]>Le&&(Le=le[ke][1]);return[xe,Te,Ee-xe,Le-Te]}(V);{const le=new Hc,[xe,Ee,Te,Le]=function(Dt){let ii=Dt[0].x,Lt=ii,Ui=Dt[0].y,Ti=Ui;for(let Ut=1;Ut<Dt.length;Ut++)Dt[Ut].x<ii?ii=Dt[Ut].x:Dt[Ut].x>Lt&&(Lt=Dt[Ut].x),Dt[Ut].y<Ui?Ui=Dt[Ut].y:Dt[Ut].y>Ti&&(Ti=Dt[Ut].y);return[ii,Ui,Lt-ii,Ti-Ui]}(f),ke=Dt=>[(Dt.x-xe)/Te,(Dt.y-Ee)/Le],[Be,We,tt,ct]=f.map(ke),it=function(Dt,ii,Lt,Ui,Ti,Ut,on,Gi){const Bi=Id(0,0,1,0,1,1,0,1),Gt=Id(Dt,ii,Lt,Ui,Ti,Ut,on,Gi),Qi=_.co.adjoint([],Gt);return _.co.multiply(Bi,Bi,Qi)}(Be[0],Be[1],We[0],We[1],tt[0],tt[1],ct[0],ct[1]);this.elevatedGlobePerspectiveTransform=yE(Be[0],Be[1],We[0],We[1],tt[0],tt[1],ct[0],ct[1]);const xt=(Dt,ii)=>{L.push(Dt.lng);const Lt=Math.round((Dt.lng-q)/J*Nt),Ui=Math.round((Dt.lat-Z)/ne*Nt),Ti=ke(ii),Ut=_.N.transformMat3([],[Ti[0],Ti[1],1],it),on=Math.round(Ut[0]/Ut[2]*Nt),Gi=Math.round(Ut[1]/Ut[2]*Nt);le.emplaceBack(Lt,Ui,on,Gi)},Rt=f[3].x-f[0].x,_t=f[3].y-f[0].y,At=f[2].x-f[1].x,ft=f[2].y-f[1].y;for(let Dt=0;Dt<65;Dt++){const ii=Dt/64,Lt=[f[0].x+ii*Rt,f[0].y+ii*_t],Ui=[f[1].x+ii*At,f[1].y+ii*ft],Ti=Ui[0]-Lt[0],Ut=Ui[1]-Lt[1];for(let on=0;on<65;on++){const Gi=on/64,Bi={x:Lt[0]+Ti*Gi,y:Lt[1]+Ut*Gi,z:0};xt(d.projection.unproject(Bi.x,Bi.y),Bi)}}this.elevatedGlobeVertexBuffer=s.createVertexBuffer(le,n0.members)}{this.maxLongitudeTriangleSize=0;let le=[],xe=new ln;const Ee=(Te,Le,ke)=>{xe.emplaceBack(Te,Le,ke);const Be=L[Te],We=L[Le],tt=L[ke],ct=Math.min(Math.min(Be,We),tt),it=Math.max(Math.max(Be,We),tt)-ct;it>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=it),le.push(ct+it/2)};for(let Te=0;Te<64;Te++)for(let Le=0;Le<64;Le++){const ke=65*Te+Le,Be=ke+1,We=ke+65,tt=We+1;Ee(ke,We,Be),Ee(Be,We,tt)}[le,xe]=function(Te,Le){const ke=Array.from({length:Te.length},(tt,ct)=>ct);ke.sort((tt,ct)=>Te[tt]-Te[ct]);const Be=[],We=new ln;for(let tt=0;tt<ke.length;tt++){const ct=ke[tt];Be.push(Te[ct]);const it=3*ct,xt=it+1;We.emplaceBack(Le.uint16[it],Le.uint16[xt],Le.uint16[xt+1])}return[Be,We]}(le,xe),this.elevatedGlobeTrianglesCenterLongitudes=le,this.elevatedGlobeIndexBuffer=s.createIndexBuffer(xe)}this.elevatedGlobeSegments=Wo.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,J/Nt,0,ne/Nt,0,0,Z,q,0])}prepare(){const s=0!==Object.keys(this.tiles).length;if(this.tileID&&!s)return;const d=this.map.painter.context,f=d.gl;!this._dirty||this.texture instanceof c_||(this.texture?this.texture.update(this.image):(this.texture=new l_(d,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),s&&this._prepareData(d)}loadTile(s,d){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},d(null)):(s.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(s){const d=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!d)return null;const f=this.elevatedGlobeTrianglesCenterLongitudes;let v=(L=s+180)+360*Math.round((f[0]-L)/360);var L;const y=new Wo,E=(L,V)=>{y.segments.push({vertexOffset:0,primitiveOffset:L,vertexLength:d.segments[0].vertexLength,primitiveLength:V,sortKey:void 0,vaos:{}})},M=.51*this.maxLongitudeTriangleSize;if(Math.abs(f[0]-v)<=M){const L=ut(f,0,f.length,v+M);return L===f.length||E(L,He(f,L+1,f.length,v+360-M)-L),y}v<f[0]&&(v+=360);const k=He(f,0,f.length,v-M);if(k===f.length)return E(0,f.length),y;E(0,k-0);const R=ut(f,k+1,f.length,v+M);return R!==f.length&&E(R,f.length-R),y}}const VM=(Math.pow(256,2)-1)/16907520;class vm extends Tl{constructor(s,d,f){super(s,BM,d,f),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isLayerDraped(s){return!(s&&s._source instanceof o0&&(s._source.onNorthPole||s._source.onSouthPole))&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(s){"raster-color"!==s&&"raster-color-range"!==s||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(s){if(!this.hasColorMap()||!this._curRampRange)return;const d=this._transitionablePaint._values["raster-color"].value.expression,[f,v]=s||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(f)&&isNaN(v)||f===this._curRampRange[0]&&v===this._curRampRange[1]||(this.colorRamp=Sy({expression:d,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:f,end:v}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[f,v])}}const xE=new $o({visibility:new ni(ot["layout_raster-particle"].visibility)});var Lp={paint:new $o({"raster-particle-array-band":new ni(ot["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new ni(ot["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new op(ot["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new ni(ot["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new ni(ot["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new ni(ot["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new ni(ot["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:xE};class Fp extends Tl{constructor(s,d,f){super(s,Lp,d,f),this._updateColorRamp(),this.onRemove=v=>{this.colorRampTexture&&this.colorRampTexture.destroy(),this.transformFeedbackObject&&v.painter.context.gl.deleteTransformFeedback(this.transformFeedbackObject),this.tileFramebuffer&&this.tileFramebuffer.destroy()},this.lastInvalidatedAt=Ht.now()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return"none"!==this.visibility}isLayerDraped(s){return!1}_handleSpecialPaintPropertyUpdate(s){"raster-particle-color"!==s&&"raster-particle-max-speed"!==s||(this._updateColorRamp(),this._invalidateAnimationState()),"raster-particle-count"===s&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const s=this._transitionablePaint._values["raster-particle-color"].value.expression,d=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Sy({expression:s,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:d}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ht.now()}}class Lw extends Tl{constructor(s,d){super(s,{},d),this.implementation=s,s.slot&&(this.slot=s.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(s){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}const qn=new $o({visibility:new ni(ot.layout_sky.visibility)});var zM={paint:new $o({"sky-type":new ni(ot.paint_sky["sky-type"]),"sky-atmosphere-sun":new ni(ot.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ni(ot.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ni(ot.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ni(ot.paint_sky["sky-gradient-radius"]),"sky-gradient":new op(ot.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ni(ot.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ni(ot.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ni(ot.paint_sky["sky-opacity"])}),layout:qn};function Fw(a,s,d){const f=[0,0,1],v=_.bi.identity([]);return _.bi.rotateY(v,v,d?-mi(a)+Math.PI:mi(a)),_.bi.rotateX(v,v,-mi(s)),_.N.transformQuat(f,f,v),_.N.normalize(f,f)}var CI={paint:new $o({})};function UM(a,s){const d=Nw(a.projection,a.zoom,a.width,a.height),f=function(y,E,M,k,R){const L=new Ze(M.lng-180*Np,M.lat),V=new Ze(M.lng+180*Np,M.lat),j=y.project(L.lng,L.lat),q=y.project(V.lng,V.lat),Z=-Math.atan2(q.y-j.y,q.x-j.x),J=Sr.fromLngLat(M);J.y=Ii(J.y,-1+Np,1-Np);const ne=J.toLngLat(),le=y.project(ne.lng,ne.lat),xe=Sr.fromLngLat(ne);xe.x+=Np;const Ee=xe.toLngLat(),Te=y.project(Ee.lng,Ee.lat),Le=wE(Te.x-le.x,Te.y-le.y,Z),ke=Sr.fromLngLat(ne);ke.y+=Np;const Be=ke.toLngLat(),We=y.project(Be.lng,Be.lat),tt=wE(We.x-le.x,We.y-le.y,Z),ct=Math.abs(Le.x)/Math.abs(tt.y),it=_.a6.identity([]);_.a6.rotateZ(it,it,-Z*(1-(R?0:k)));const xt=_.a6.identity([]);return _.a6.scale(xt,xt,[1,1-(1-ct)*k,1]),xt[4]=-tt.x/tt.y*k,_.a6.rotateZ(xt,xt,Z),_.a6.multiply(xt,it,xt),xt}(a.projection,0,a.center,d,s),v=jM(a);return _.a6.scale(f,f,[v,v,1]),f}function jM(a){const s=a.projection,d=Nw(a.projection,a.zoom,a.width,a.height),f=Qv(s,a.center),v=Qv(s,Ze.convert(s.center));return Math.pow(2,f*d+(1-d)*v)}function Nw(a,s,d,f,v=1/0){const y=a.range;if(!y)return 0;const E=Math.min(v,Math.max(d,f)),M=Math.log(E/1024)/Math.LN2;return an(y[0]+M,y[1]+M,s)}const Np=1/4e4;function Qv(a,s){const d=Ii(s.lat,-Mi,Mi),f=new Ze(s.lng-180*Np,d),v=new Ze(s.lng+180*Np,d),y=a.project(f.lng,d),E=a.project(v.lng,d),M=Sr.fromLngLat(f),k=Sr.fromLngLat(v),R=E.x-y.x,L=E.y-y.y,V=k.x-M.x,j=k.y-M.y,q=Math.sqrt((V*V+j*j)/(R*R+L*L));return Math.log(q)/Math.LN2}function wE(a,s,d){const f=Math.cos(d),v=Math.sin(d);return{x:a*f-s*v,y:a*v+s*f}}function GM(a,s,d){_.a6.identity(a),_.a6.rotateZ(a,a,mi(s[2])),_.a6.rotateX(a,a,mi(s[0])),_.a6.rotateY(a,a,mi(s[1])),_.a6.scale(a,a,d),_.a6.multiply(a,a,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function bm(a,s,d,f,v,y,E,M){const k=[d[0]-s[0],d[1]-s[1],0],R=[f[0]-s[0],f[1]-s[1],0];if(_.N.length(k)<1e-12||_.N.length(R)<1e-12)return _.bi.identity(a);const L=_.N.cross([],k,R);_.N.normalize(L,L),_.N.subtract(R,f,s),k[2]=(y-v)*M,R[2]=(E-v)*M;const V=k;return _.N.cross(V,k,R),_.N.normalize(V,V),_.bi.rotationTo(a,L,V)}function Bw(a,s,d=!1){const f=Ih(s.zoom),v=function(y,E,M){const k=E.worldSize,R=[y[12],y[13],y[14]],L=fr(R[1]/k),V=Dn(R[0]/k),j=_.a6.identity([]),q=xn(1,L)*k,Z=xn(1,0)*k*ar(L,E.zoom),J=1/cw(k);let ne=Z*J;if(M){const Te=Nw(E.projection,E.zoom,E.width,E.height,1024);ne=J*E.projection.pixelSpaceConversion(E.center.lat,k,Te)}const le=rt(L,V);_.N.add(le,le,_.N.scale([],_.N.normalize([],le),q*ne*R[2]));const xe=function(Te){const Le=[Te[0],Te[1],Te[2]];let ke=[0,1,0];const Be=_.N.cross([],ke,Le);return _.N.cross(ke,Le,Be),0===_.N.squaredLength(ke)&&(ke=[0,1,0],_.N.cross(Be,Le,ke)),_.N.normalize(Be,Be),_.N.normalize(ke,ke),_.N.normalize(Le,Le),[Be[0],Be[1],Be[2],0,ke[0],ke[1],ke[2],0,Le[0],Le[1],Le[2],0,Te[0],Te[1],Te[2],1]}(le);_.a6.scale(j,j,[ne,ne,ne*q]),_.a6.translate(j,j,[-R[0],-R[1],-R[2]]);const Ee=_.a6.multiply([],E.globeMatrix,xe);return _.a6.multiply(Ee,Ee,j),_.a6.multiply(Ee,Ee,y),Ee}(a,s,d);return f>0?function(E,M,k){const R=(Z,J,ne)=>{const le=_.N.length(Z),xe=_.N.length(J),Ee=wd(Z,J,ne);return _.N.scale(Ee,Ee,1/_.N.length(Ee)*rr(le,xe,ne))},L=R([E[0],E[1],E[2]],[M[0],M[1],M[2]],k),V=R([E[4],E[5],E[6]],[M[4],M[5],M[6]],k),j=R([E[8],E[9],E[10]],[M[8],M[9],M[10]],k),q=wd([E[12],E[13],E[14]],[M[12],M[13],M[14]],k);return[L[0],L[1],L[2],0,V[0],V[1],V[2],0,j[0],j[1],j[2],0,q[0],q[1],q[2],1]}(v,function(E,M){const k=M.worldSize,R=xn(1,0)*k*ar(M.center.lat,M.zoom)/cw(k),L=xn(1,M.center.lat)*k,V=_.a6.identity([]);return _.a6.rotateY(V,V,mi(M.center.lng)),_.a6.rotateX(V,V,mi(M.center.lat)),_.a6.translate(V,V,[0,0,we]),_.a6.scale(V,V,[R,R,R*L]),_.a6.translate(V,V,[M.point.x-.5*k,M.point.y-.5*k,0]),_.a6.multiply(V,V,E),_.a6.multiply(V,M.globeMatrix,V)}(a,s),f):v}function Xa(a,s,d,f){const v=ss.projectAabbCorners(f,d);let y=Number.MAX_VALUE,E=-1;for(let R=0;R<v.length;++R){const L=v[R];L[0]=(.5*L[0]+.5)*s.width,L[1]=(.5-.5*L[1])*s.height,L[2]<y&&(E=R,y=L[2])}const M=R=>new mt(v[R][0],v[R][1]);let k;switch(E){case 0:case 6:k=[M(1),M(5),M(4),M(7),M(3),M(2),M(1)];break;case 1:case 7:k=[M(0),M(4),M(5),M(6),M(2),M(3),M(0)];break;case 3:case 5:k=[M(1),M(0),M(4),M(7),M(6),M(2),M(1)];break;default:k=[M(1),M(5),M(6),M(7),M(3),M(0),M(1)]}if(vc(a,k))return y}const Bp=Ir([{name:"a_pos_3f",components:3,type:"Float32"}]),CE=Ir([{name:"a_color_3f",components:3,type:"Float32"}]),Vw=Ir([{name:"a_color_4f",components:4,type:"Float32"}]),HM=Ir([{name:"a_uv_2f",components:2,type:"Float32"}]),EE=Ir([{name:"a_normal_3f",components:3,type:"Float32"}]),TE=Ir([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),SE=Ir([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class d_{constructor(s,d){this.feature=s,this.instancedDataOffset=d,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class Jv{constructor(){this.instancedDataArray=new Nu,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class eh{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.layers=s.layers,this.layerIds=this.layers.map(d=>d.fqid),this.projection=s.projection,this.index=s.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(s,d,f,v){this.tileToMeter=vr(f);const y=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:E,id:M,index:k,sourceLayerIndex:R}of s){const L=ks(E,y);if(!this.layers[0]._featureFilter.filter(new qr(this.zoom),L,f))continue;const V={id:M,sourceLayerIndex:R,index:k,geometry:y?L.geometry:Ks(E,f,v),properties:E.properties,type:E.type,patterns:{}},j=this.addFeature(V,V.geometry,L);j&&d.featureIndex.insert(E,V.geometry,k,R,this.index,this.instancesPerModel[j].instancedDataArray.length,Nt/32)}this.lookup=null}update(s,d,f,v){for(const y in this.instancesPerModel){const E=this.instancesPerModel[y];for(const M in s)E.idToFeaturesIndex.hasOwnProperty(M)&&this.evaluate(E.features[E.idToFeaturesIndex[M]],s[M],E,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let s=!1;for(const d in this.instancesPerModel){const f=this.instancesPerModel[d];for(const v of f.features){const y=this.layers[0],E=v.feature,M=this.canonical,k=y.paint.get("model-rotation").evaluate(E,{},M),R=y.paint.get("model-scale").evaluate(E,{},M),L=y.paint.get("model-translation").evaluate(E,{},M);_.N.exactEquals(v.rotation,k)&&_.N.exactEquals(v.scale,R)&&_.N.exactEquals(v.translation,L)||(this.evaluate(v,v.featureStates,f,!0),s=!0)}}return s}isEmpty(){for(const s in this.instancesPerModel)if(0!==this.instancesPerModel[s].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(s){if(!this.uploaded)for(const d in this.instancesPerModel){const f=this.instancesPerModel[d];f.instancedDataArray.length<0||0===f.instancedDataArray.length||(f.instancedDataBuffer?f.instancedDataBuffer.updateData(f.instancedDataArray):f.instancedDataBuffer=s.createVertexBuffer(f.instancedDataArray,TE.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const d=this.instancesPerModel[s];0!==d.instancedDataArray.length&&d.instancedDataBuffer&&d.instancedDataBuffer.destroy()}}addFeature(s,d,f){const v=this.layers[0],y=v.layout.get("model-id").evaluate(f,{},this.canonical);if(!y)return Qe(`modelId is not evaluated for layer ${v.id} and it is not going to get rendered.`),y;this.instancesPerModel[y]||(this.instancesPerModel[y]=new Jv);const E=this.instancesPerModel[y],M=E.instancedDataArray,k=new d_(f,M.length);for(const R of d)for(const L of R){if(L.x<0||L.x>=Nt||L.y<0||L.y>=Nt)continue;const V=(this.lookupDim-1)/Nt,j=this.lookupDim*(L.y*V|0)+L.x*V|0;if(this.lookup){if(0!==this.lookup[j])continue;this.lookup[j]=1}this.instanceCount++;const q=M.length;M.resize(q+1),E.instancesEvaluatedElevation.push(0),M.float32[16*q]=L.x,M.float32[16*q+1]=L.y}return k.instancedDataCount=E.instancedDataArray.length-k.instancedDataOffset,k.instancedDataCount>0&&(s.id&&(E.idToFeaturesIndex[s.id]=E.features.length),E.features.push(k),this.evaluate(k,{},E,!1)),y}evaluate(s,d,f,v){const y=this.layers[0],E=s.feature,M=this.canonical,k=s.rotation=y.paint.get("model-rotation").evaluate(E,d,M),R=s.scale=y.paint.get("model-scale").evaluate(E,d,M),L=s.translation=y.paint.get("model-translation").evaluate(E,d,M),V=y.paint.get("model-color").evaluate(E,d,M);V.a=y.paint.get("model-color-mix-intensity").evaluate(E,d,M);const j=[];this.maxVerticalOffset<L[2]&&(this.maxVerticalOffset=L[2]),this.maxScale=Math.max(Math.max(this.maxScale,R[0]),Math.max(R[1],R[2])),GM(j,k,R);const q=Math.round(100*V.a)+V.b/1.05;for(let Z=0;Z<s.instancedDataCount;++Z){const J=s.instancedDataOffset+Z,ne=16*J,le=f.instancedDataArray.float32;let xe=0;v&&(xe=le[ne+6]-f.instancesEvaluatedElevation[J]);const Ee=0|le[ne+1];le[ne]=(0|le[ne])+V.r/1.05,le[ne+1]=Ee+V.g/1.05,le[ne+2]=q,le[ne+3]=1/(M.z>10?this.tileToMeter:vr(M,Ee)),le[ne+4]=L[0],le[ne+5]=L[1],le[ne+6]=L[2]+xe,le[ne+7]=j[0],le[ne+8]=j[1],le[ne+9]=j[2],le[ne+10]=j[4],le[ne+11]=j[5],le[ne+12]=j[6],le[ne+13]=j[8],le[ne+14]=j[9],le[ne+15]=j[10],f.instancesEvaluatedElevation[J]=L[2]}}}Oi(eh,"ModelBucket",{omit:["layers"]}),Oi(Jv,"PerModelAttributes"),Oi(d_,"ModelFeature");const EI=new $o({visibility:new ni(ot.layout_model.visibility),"model-id":new Ji(ot.layout_model["model-id"])});var TI={paint:new $o({"model-opacity":new ni(ot.paint_model["model-opacity"]),"model-rotation":new Ji(ot.paint_model["model-rotation"]),"model-scale":new Ji(ot.paint_model["model-scale"]),"model-translation":new Ji(ot.paint_model["model-translation"]),"model-color":new Ji(ot.paint_model["model-color"]),"model-color-mix-intensity":new Ji(ot.paint_model["model-color-mix-intensity"]),"model-type":new ni(ot.paint_model["model-type"]),"model-cast-shadows":new ni(ot.paint_model["model-cast-shadows"]),"model-receive-shadows":new ni(ot.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new ni(ot.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Ji(ot.paint_model["model-emissive-strength"]),"model-roughness":new Ji(ot.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Ji(ot.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new ni(ot.paint_model["model-cutoff-fade-range"])}),layout:EI};const th={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function cl(a,s,d,f,v,y,E,M,k,R=!1){const L=d.zoom,V=d.project(f),j=ar(f.lat,L),q=1/j;_.a6.identity(a),_.a6.translate(a,a,[V.x+E[0]*q,V.y+E[1]*q,E[2]]);let Z=1,J=1;const ne=d.worldSize;if(R){if("mercator"===d.projection.name){let Te=0;d.elevation&&(Te=d.elevation.getAtPointOrZero(new Sr(V.x/ne,V.y/ne),0));const Le=_.a7.transformMat4([],[V.x,V.y,Te,1],d.projMatrix)[3]/d.cameraToCenterDistance;Z=Le,J=Le*ar(d.center.lat,L)}else if("globe"===d.projection.name){const Te=Bw(a,d),Le=_.a6.multiply([],d.projMatrix,Te),ke=[0,0,0,1];_.a7.transformMat4(ke,ke,Le);const Be=ke[3]/d.cameraToCenterDistance,We=Ih(L),tt=d.projection.pixelsPerMeter(f.lat,ne)*ar(f.lat,L),ct=d.projection.pixelsPerMeter(d.center.lat,ne)*ar(d.center.lat,L);Z=Be/rr(tt,Do(d.center.lat),We),J=Be*j/tt,Z*=ct,J*=ct}}else Z=q;_.a6.scale(a,a,[Z,Z,J]);const le=[...a],xe=s.orientation,Ee=[];if(GM(Ee,[xe[0]+v[0],xe[1]+v[1],xe[2]+v[2]],y),_.a6.multiply(a,le,Ee),M&&d.elevation){let Te=0;const Le=[];if(k&&d.elevation){Te=function(We,tt,ct,it,xt){const Rt=tt.elevation;if(!Rt)return 0;const _t=ss.projectAabbCorners(ct,it),At=xn(1,xt.lat)*tt.worldSize,ft=function(Qi,Hn){const hn=[0,0,1],Yn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const In of Yn){const xr=Qi[In.corners[0]],Rn=Qi[In.corners[1]],po=Qi[In.corners[2]],Fr=[Rn[0]-xr[0],Rn[1]-xr[1],Hn*(Rn[2]-xr[2])],Mr=_.N.cross(Fr,Fr,[po[0]-xr[0],po[1]-xr[1],Hn*(po[2]-xr[2])]);_.N.normalize(Mr,Mr),In.dotProductWithUp=_.N.dot(Mr,hn)}return Yn.sort((In,xr)=>In.dotProductWithUp-xr.dotProductWithUp),Yn[0].corners}(_t,At),Dt=_t[ft[0]],ii=_t[ft[1]],Lt=_t[ft[2]],Ui=_t[ft[3]],Ti=Rt.getAtPointOrZero(new Sr(Dt[0]/tt.worldSize,Dt[1]/tt.worldSize),0),Ut=Rt.getAtPointOrZero(new Sr(ii[0]/tt.worldSize,ii[1]/tt.worldSize),0),on=Rt.getAtPointOrZero(new Sr(Lt[0]/tt.worldSize,Lt[1]/tt.worldSize),0),Gi=Rt.getAtPointOrZero(new Sr(Ui[0]/tt.worldSize,Ui[1]/tt.worldSize),0),Bi=(Ti+Gi)/2,Gt=(Ut+on)/2;return Bi>Gt?Ut<on?bm(We,ii,Ui,Dt,Ut,Gi,Ti,At):bm(We,Lt,Dt,Ui,on,Ti,Gi,At):Ti<Gi?bm(We,Dt,ii,Lt,Ti,Ut,on,At):bm(We,Ui,Lt,ii,Gi,on,Ut,At),Math.max(Bi,Gt)}(Le,d,s.aabb,a,f);const ke=_.a6.fromQuat([],Le),Be=_.a6.multiply([],ke,Ee);_.a6.multiply(a,le,Be)}else Te=d.elevation.getAtPointOrZero(new Sr(V.x/ne,V.y/ne),0);0!==Te&&(a[14]+=Te)}}function eb(a,s,d=!1){a.uploaded||(a.gfxTexture=new l_(s,a.image,d?s.gl.R8:s.gl.RGBA,{useMipmap:a.sampler.minFilter>=s.gl.NEAREST_MIPMAP_NEAREST}),a.uploaded=!0,a.image=null)}function $M(a,s,d){a.indexBuffer=s.createIndexBuffer(a.indexArray,!1,!0),a.vertexBuffer=s.createVertexBuffer(a.vertexArray,Bp.members,!1,!0),a.normalArray&&(a.normalBuffer=s.createVertexBuffer(a.normalArray,EE.members,!1,!0)),a.texcoordArray&&(a.texcoordBuffer=s.createVertexBuffer(a.texcoordArray,HM.members,!1,!0)),a.colorArray&&(a.colorBuffer=s.createVertexBuffer(a.colorArray,(12===a.colorArray.bytesPerElement?CE:Vw).members,!1,!0)),a.featureArray&&(a.pbrBuffer=s.createVertexBuffer(a.featureArray,SE.members,!0)),a.segments=Wo.simpleSegment(0,0,a.vertexArray.length,a.indexArray.length);const f=a.material;f.pbrMetallicRoughness.baseColorTexture&&eb(f.pbrMetallicRoughness.baseColorTexture,s),f.pbrMetallicRoughness.metallicRoughnessTexture&&eb(f.pbrMetallicRoughness.metallicRoughnessTexture,s),f.normalTexture&&eb(f.normalTexture,s),f.occlusionTexture&&eb(f.occlusionTexture,s,d),f.emissionTexture&&eb(f.emissionTexture,s)}function ME(a,s,d){if(a.meshes)for(const f of a.meshes)$M(f,s,d);if(a.children)for(const f of a.children)ME(f,s,d)}function tb(a){if(a.meshes)for(const s of a.meshes)s.indexArray.destroy(),s.vertexArray.destroy(),s.colorArray&&s.colorArray.destroy(),s.normalArray&&s.normalArray.destroy(),s.texcoordArray&&s.texcoordArray.destroy(),s.featureArray&&s.featureArray.destroy();if(a.children)for(const s of a.children)tb(s)}function zw(a){if(a.meshes)for(const d of a.meshes)d.vertexBuffer&&(d.vertexBuffer.destroy(),d.indexBuffer.destroy(),d.normalBuffer&&d.normalBuffer.destroy(),d.texcoordBuffer&&d.texcoordBuffer.destroy(),d.colorBuffer&&d.colorBuffer.destroy(),d.pbrBuffer&&d.pbrBuffer.destroy(),d.segments.destroy(),d.material&&((s=d.material).pbrMetallicRoughness.baseColorTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),s.pbrMetallicRoughness.metallicRoughnessTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),s.normalTexture&&s.normalTexture.gfxTexture&&s.normalTexture.gfxTexture.destroy(),s.emissionTexture&&s.emissionTexture.gfxTexture&&s.emissionTexture.gfxTexture.destroy(),s.occlusionTexture&&s.occlusionTexture.gfxTexture&&s.occlusionTexture.gfxTexture.destroy()));var s;if(a.children)for(const d of a.children)zw(d)}class WM{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class AE{constructor(){this.tasks={},this.taskQueue=[],Eo(["process"],this),this.invoker=new WM(this.process),this.nextId=0}add(s,d){const f=this.nextId++,v=function({type:y,isSymbolTile:E,zoom:M}){return M=M||0,"message"===y?0:"maybePrepare"!==y||E?"parseTile"!==y||E?"parseTile"===y&&E?300-M:"maybePrepare"===y&&E?400-M:500:200-M:100-M}(d);if(0===v){qt();try{s()}finally{}return null}return this.tasks[f]={fn:s,metadata:d,priority:v,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){qt();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const s=this.pick();if(null===s)return;const d=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!d)return;d.fn()}finally{}}pick(){let s=null,d=1/0;for(let v=0;v<this.taskQueue.length;v++){const y=this.tasks[this.taskQueue[v]];y.priority<d&&(d=y.priority,s=v)}if(null===s)return null;const f=this.taskQueue[s];return this.taskQueue.splice(s,1),f}remove(){this.invoker.remove()}}class DE{constructor(s,d,f){this.target=s,this.parent=d,this.mapId=f,this.callbacks={},this.cancelCallbacks={},Eo(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new AE}send(s,d,f,v,y=!1,E){const M=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(f.metadata=E,this.callbacks[M]=f);const k=new Set;return this.target.postMessage({id:M,type:s,hasCallback:!!f,targetMapId:v,mustQueue:y,sourceMapId:this.mapId,data:Jd(d,k)},k),{cancel:()=>{f&&delete this.callbacks[M],this.target.postMessage({id:M,type:"<cancel>",targetMapId:v,sourceMapId:this.mapId})}}}receive(s){const d=s.data,f=d.id;if(f&&(!d.targetMapId||this.mapId===d.targetMapId))if("<cancel>"===d.type){const v=this.cancelCallbacks[f];delete this.cancelCallbacks[f],v&&v.cancel()}else if(d.mustQueue||qt()){const v=this.callbacks[f],y=this.scheduler.add(()=>this.processTask(f,d),v&&v.metadata||{type:"message"});y&&(this.cancelCallbacks[f]=y)}else this.processTask(f,d)}processTask(s,d){if(delete this.cancelCallbacks[s],"<response>"===d.type){const f=this.callbacks[s];delete this.callbacks[s],f&&(d.error?f(Ra(d.error)):f(null,Ra(d.data)))}else{const f=new Set,v=d.hasCallback?(E,M)=>{this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:E?Jd(E):null,data:Jd(M,f)},f)}:E=>{},y=Ra(d.data);if(this.parent[d.type])this.parent[d.type](d.sourceMapId,y,v);else if(this.parent.getWorkerSource){const E=d.type.split(".");this.parent.getWorkerSource(d.sourceMapId,E[0],y.source,y.scope)[E[1]](y,v)}else v(new Error(`Could not find function ${d.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}let Vp=(()=>{class a{constructor(d,f){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=va();const v=this.workerPool.acquire(this.id);for(let y=0;y<v.length;y++){const E=new a.Actor(v[y],f,this.id);E.name=`Worker ${y}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(d,f,v){uo(this.actors,(y,E)=>{y.send(d,f,E)},v=v||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(d=>{d.remove()}),this.actors=[],this.workerPool.release(this.id)}}return a.Actor=DE,a})();var ib={workerUrl:"",workerClass:null,workerParams:void 0};function zp(){return null!=ib.workerClass?new ib.workerClass:new self.Worker(ib.workerUrl,ib.workerParams)}const dl="mapboxgl_preloaded_worker_pool";class ul{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<ul.workerCount;)this.workers.push(new zp);return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.workers&&0===this.numActive()&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[dl]}numActive(){return Object.keys(this.active).length}}let ym;function xm(){return ym||(ym=new ul),ym}ul.workerCount=2;let Up,u_,Ec,nb,jp,wm=null;function Gp(){return qt()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:u_||Ri.DRACO_URL}function s0(){if(qt()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(nb)return nb;const a=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if("object"!=typeof WebAssembly)throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return nb=WebAssembly.validate(a)?Ri.MESHOPT_SIMD_URL:Ri.MESHOPT_URL,nb}const h_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},rb={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},f_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function Uw(a,s,d){const f=d.json.bufferViews.length,v=d.buffers.length;s.bufferView=f,d.json.bufferViews[f]={buffer:v,byteLength:a.byteLength},d.buffers[v]=a}const Gh="KHR_draco_mesh_compression";function jw(a,s){const d=a.extensions&&a.extensions[Gh];if(!d)return;const f=new Ec.Decoder,v=IE(s,d.bufferView),y=new Ec.Mesh;if(!f.DecodeArrayToMesh(v,v.byteLength,y))throw new Error("Failed to decode Draco mesh");const E=s.json.accessors[a.indices],M=h_[E.componentType],k=E.count*M.BYTES_PER_ELEMENT,R=Ec._malloc(k);M===Uint16Array?f.GetTrianglesUInt16Array(y,k,R):f.GetTrianglesUInt32Array(y,k,R),Uw(Ec.memory.buffer.slice(R,R+k),E,s),Ec._free(R);for(const L of Object.keys(d.attributes)){const V=f.GetAttributeByUniqueId(y,d.attributes[L]),j=s.json.accessors[a.attributes[L]],q=rb[j.componentType],Z=j.count*f_[j.type]*h_[j.componentType].BYTES_PER_ELEMENT,J=Ec._malloc(Z);f.GetAttributeDataArrayForAllPoints(y,V,Ec[q],Z,J),Uw(Ec.memory.buffer.slice(J,J+Z),j,s),Ec._free(J)}f.destroy(),y.destroy(),delete a.extensions[Gh]}const ob="EXT_meshopt_compression";function a0(a,s){if(!a.extensions||!a.extensions[ob])return;const d=a.extensions[ob],f=new Uint8Array(s.buffers[d.buffer],d.byteOffset||0,d.byteLength||0),v=new Uint8Array(d.count*d.byteStride);jp.decodeGltfBuffer(v,d.count,d.byteStride,f,d.mode,d.filter),a.buffer=s.buffers.length,a.byteOffset=0,s.buffers[a.buffer]=v.buffer,delete a.extensions[ob]}const m_=1179937895,sb=new TextDecoder("utf8");function Gw(a,s){return new URL(a,s).href}function kE(a,s,d,f){return fetch(Gw(a.uri,f)).then(v=>v.arrayBuffer()).then(v=>{s.buffers[d]=v})}function IE(a,s){const d=a.json.bufferViews[s];return new Uint8Array(a.buffers[d.buffer],d.byteOffset||0,d.byteLength)}function Hw(a,s,d,f){if(a.uri){const v=Gw(a.uri,f);return fetch(v).then(y=>y.blob()).then(y=>createImageBitmap(y)).then(y=>{s.images[d]=y})}if(void 0!==a.bufferView){const v=IE(s,a.bufferView),y=new Blob([v],{type:a.mimeType});return createImageBitmap(y).then(E=>{s.images[d]=E})}}function XM(a,s=0,d){const f={json:null,images:[],buffers:[]};if(new Uint32Array(a,s,1)[0]===m_){const L=new Uint32Array(a,s);let V=2;const j=(L[V++]>>2)-3,q=L[V++]>>2;if(V++,f.json=JSON.parse(sb.decode(L.subarray(V,V+q))),V+=q,V<j){const Z=L[V++];V++;const J=s+(V<<2);f.buffers[0]=a.slice(J,J+Z)}}else f.json=JSON.parse(sb.decode(new Uint8Array(a,s)));const{buffers:v,images:y,meshes:E,extensionsUsed:M,bufferViews:k}=f.json;let R=Promise.resolve();if(v){const L=[];for(let V=0;V<v.length;V++){const j=v[V];j.uri?L.push(kE(j,f,V,d)):f.buffers[V]||(f.buffers[V]=null)}R=Promise.all(L)}return R.then(()=>{const L=[],V=M&&M.includes(Gh),j=M&&M.includes(ob);if(V&&L.push(function(){if(!Ec)return Up||(Up=function(q){let Z,J=null;function ne(){Z=new Uint8Array(J.buffer)}function le(){throw new Error("Unexpected Draco error.")}const xe={a:{a:le,d:function(Ee,Te,Le){return Z.copyWithin(Ee,Te,Te+Le)},c:function(Ee){const Te=Z.length,Le=Math.max(Ee>>>0,Math.ceil(1.2*Te)),ke=Math.ceil((Le-Te)/65536);try{return J.grow(ke),ne(),!0}catch{return!1}},b:le}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(q,xe):q.then(Ee=>Ee.arrayBuffer()).then(Ee=>WebAssembly.instantiate(Ee,xe))).then(Ee=>{const{Rb:Te,Qb:Le,P:ke,T:Be,X:We,Ja:tt,La:ct,Qa:it,Va:xt,Wa:Rt,eb:_t,jb:At,f:ft,e:Dt,yb:ii,zb:Lt,Ab:Ui,Bb:Ti,Db:Ut,Gb:on}=Ee.instance.exports;J=Dt;const Gi=(()=>{let Bi=0,Gt=0,Qi=0,Hn=0;return hn=>{Qi&&(Te(Hn),Te(Bi),Gt+=Qi,Qi=Bi=0),Bi||(Gt+=128,Bi=Le(Gt));const Yn=hn.length+7&-8;let In=Bi;Yn>=Gt&&(Qi=Yn,In=Hn=Le(Yn));for(let xr=0;xr<hn.length;xr++)Z[In+xr]=hn[xr];return In}})();return ne(),ft(),{memory:Dt,_free:Te,_malloc:Le,Mesh:class{constructor(){this.ptr=ke()}destroy(){Be(this.ptr)}},Decoder:class{constructor(){this.ptr=tt()}destroy(){At(this.ptr)}DecodeArrayToMesh(Bi,Gt,Qi){const Hn=Gi(Bi),hn=ct(this.ptr,Hn,Gt,Qi.ptr);return!!We(hn)}GetAttributeByUniqueId(Bi,Gt){return{ptr:it(this.ptr,Bi.ptr,Gt)}}GetTrianglesUInt16Array(Bi,Gt,Qi){xt(this.ptr,Bi.ptr,Gt,Qi)}GetTrianglesUInt32Array(Bi,Gt,Qi){Rt(this.ptr,Bi.ptr,Gt,Qi)}GetAttributeDataArrayForAllPoints(Bi,Gt,Qi,Hn,hn){_t(this.ptr,Bi.ptr,Gt.ptr,Qi,Hn,hn)}},DT_INT8:ii(),DT_UINT8:Lt(),DT_INT16:Ui(),DT_UINT16:Ti(),DT_UINT32:Ut(),DT_FLOAT32:on()}})}(fetch(Gp())),Up.then(q=>{Ec=q,Up=void 0}))}()),j&&L.push(function(){if(jp)return;const q=function(Z){let J;const ne=WebAssembly.instantiateStreaming(Z,{}).then(Ee=>{J=Ee.instance,J.exports.__wasm_call_ctors()}),le={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},xe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ne,supported:!0,decodeGltfBuffer(Ee,Te,Le,ke,Be,We){!function(tt,ct,it,xt,Rt,_t,At){const ft=tt.exports.sbrk,Dt=xt+3&-4,ii=ft(Dt*Rt),Lt=ft(_t.length),Ui=new Uint8Array(tt.exports.memory.buffer);Ui.set(_t,Lt);const Ti=ct(ii,xt,Rt,Lt,_t.length);if(0===Ti&&At&&At(ii,Dt,Rt),it.set(Ui.subarray(ii,ii+xt*Rt)),ft(ii-ft(0)),0!==Ti)throw new Error(`Malformed buffer data: ${Ti}`)}(J,J.exports[xe[Be]],Ee,Te,Le,ke,J.exports[le[We]])}}}(fetch(s0()));return q.ready.then(()=>{jp=q})}()),y)for(let q=0;q<y.length;q++)L.push(Hw(y[q],f,q,d));return(L.length?Promise.all(L):Promise.resolve()).then(()=>{if(V&&E)for(const{primitives:q}of E)for(const Z of q)jw(Z,f);if(j&&E&&k)for(const q of k)a0(q,f);return f})})}class $w{constructor(s,d,f){if(this.triangleCount=d.length/3,this.min=new mt(0,0),this.max=new mt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===s.length||0===f)return;const v=s.map(L=>L.x),y=s.map(L=>L.y);this.min=new mt(Math.min(...v),Math.min(...y)),this.max=new mt(Math.max(...v),Math.max(...y));const E=this.max.sub(this.min);E.x=Math.max(E.x,1),E.y=Math.max(E.y,1);const M=Math.max(E.x,E.y)/f;this.cellsX=Math.max(1,Math.ceil(E.x/M)),this.cellsY=Math.max(1,Math.ceil(E.y/M)),this.xScale=1/M,this.yScale=1/M;const k=[];for(let L=0;L<this.triangleCount;L++){const V=s[d[3*L+0]].sub(this.min),j=s[d[3*L+1]].sub(this.min),q=s[d[3*L+2]].sub(this.min),Z=uu(Math.floor(Math.min(V.x,j.x,q.x)),this.xScale,this.cellsX),J=uu(Math.floor(Math.max(V.x,j.x,q.x)),this.xScale,this.cellsX),ne=uu(Math.floor(Math.min(V.y,j.y,q.y)),this.yScale,this.cellsY),le=uu(Math.floor(Math.max(V.y,j.y,q.y)),this.yScale,this.cellsY),xe=new mt(0,0),Ee=new mt(0,0),Te=new mt(0,0),Le=new mt(0,0);for(let ke=ne;ke<=le;++ke){xe.y=Ee.y=ke*M,Te.y=Le.y=(ke+1)*M;for(let Be=Z;Be<=J;++Be)xe.x=Te.x=Be*M,Ee.x=Le.x=(Be+1)*M,(fa(V,j,q,xe,Ee,Le)||fa(V,j,q,xe,Le,Te))&&k.push({cellIdx:ke*this.cellsX+Be,triIdx:L})}}if(0===k.length)return;k.sort((L,V)=>L.cellIdx-V.cellIdx||L.triIdx-V.triIdx);let R=0;for(;R<k.length;){const L=k[R].cellIdx,V={start:this.payload.length,len:0};for(;R<k.length&&k[R].cellIdx===L;)++V.len,this.payload.push(k[R++].triIdx);this.cells[L]=V}}query(s,d,f){if(0===this.triangleCount||0===this.cells.length||s.x>this.max.x||this.min.x>d.x||s.y>this.max.y||this.min.y>d.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let k=0;k<this.lookup.length;k++)this.lookup[k]=0;const v=uu(s.x-this.min.x,this.xScale,this.cellsX),y=uu(d.x-this.min.x,this.xScale,this.cellsX),E=uu(s.y-this.min.y,this.yScale,this.cellsY),M=uu(d.y-this.min.y,this.yScale,this.cellsY);for(let k=E;k<=M;k++)for(let R=v;R<=y;R++){const L=this.cells[k*this.cellsX+R];if(L)for(let V=0;V<L.len;V++){const j=this.payload[L.start+V],q=Math.floor(j/8),Z=1<<j%8;if(!(this.lookup[q]&Z)&&(this.lookup[q]|=Z,f.push(j),f.length===this.triangleCount))return}}}}function uu(a,s,d){return Math.max(0,Math.min(d-1,Math.floor(a*s)))}function Hh(a,s){const d=a.json.bufferViews[s.bufferView],f=h_[s.componentType];return new f(a.buffers[d.buffer],(s.byteOffset||0)+(d.byteOffset||0),s.count*(d.byteStride&&d.byteStride!==f_[s.type]*f.BYTES_PER_ELEMENT?d.byteStride/f.BYTES_PER_ELEMENT:f_[s.type]))}function p_(a,s,d,f){const v=h_[s.componentType],y=function(L){switch(L){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(v),E=a.json.bufferViews[s.bufferView],M=E.byteStride?E.byteStride/v.BYTES_PER_ELEMENT:f_[s.type],k=d.float32,R=k.length/d.capacity;for(let L=0,V=0;L<s.count*M;L+=M,V+=R)for(let j=0;j<R;j++)k[V+j]=f[L+j]*y;d._trim()}function Hp(a,s,d){const f=a.indices,v=a.attributes,y={};y.indexArray=new ln;const E=s.json.accessors[f],M=E.count/3;y.indexArray.reserve(M);const k=Hh(s,E);for(let j=0;j<M;j++)y.indexArray.emplaceBack(k[3*j],k[3*j+1],k[3*j+2]);y.indexArray._trim(),y.vertexArray=new Ha;const R=s.json.accessors[v.POSITION];y.vertexArray.reserve(R.count);const L=Hh(s,R);for(let j=0;j<R.count;j++)y.vertexArray.emplaceBack(L[3*j],L[3*j+1],L[3*j+2]);if(y.vertexArray._trim(),y.aabb=new ss(R.min,R.max),y.centroid=function(j,q){const Z=[0,0,0],J=j.length;if(J>0){for(let ne=0;ne<J;ne++){const le=3*j[ne];Z[0]+=q[le],Z[1]+=q[le+1],Z[2]+=q[le+2]}Z[0]/=J,Z[1]/=J,Z[2]/=J}return Z}(k,L),void 0!==v.COLOR_0){const j=s.json.accessors[v.COLOR_0],q=f_[j.type],Z=Hh(s,j);y.colorArray=3===q?new Ha:new Fu,y.colorArray.resize(j.count),p_(s,j,y.colorArray,Z)}if(void 0!==v.NORMAL){y.normalArray=new Ha;const j=s.json.accessors[v.NORMAL];y.normalArray.resize(j.count);const q=Hh(s,j);p_(s,j,y.normalArray,q)}if(void 0!==v.TEXCOORD_0&&d.length>0){y.texcoordArray=new _r;const j=s.json.accessors[v.TEXCOORD_0];y.texcoordArray.resize(j.count);const q=Hh(s,j);p_(s,j,y.texcoordArray,q)}if(void 0!==v._FEATURE_ID_RGBA4444){const j=s.json.accessors[v._FEATURE_ID_RGBA4444];s.json.extensionsUsed&&s.json.extensionsUsed.includes("EXT_meshopt_compression")&&(y.featureData=Hh(s,j))}void 0!==v._FEATURE_RGBA4444&&(y.featureData=new Uint32Array(Hh(s,s.json.accessors[v._FEATURE_RGBA4444]).buffer));const V=a.material;return y.material=function(j,q){const{emissiveFactor:Z=[0,0,0],alphaMode:J="OPAQUE",alphaCutoff:ne=.5,normalTexture:le,occlusionTexture:xe,emissiveTexture:Ee,doubleSided:Te}=j,{baseColorFactor:Le=[1,1,1,1],metallicFactor:ke=1,roughnessFactor:Be=1,baseColorTexture:We,metallicRoughnessTexture:tt}=j.pbrMetallicRoughness||{},ct=xe?q[xe.index]:void 0;if(xe&&xe.extensions&&xe.extensions.KHR_texture_transform&&ct){const it=xe.extensions.KHR_texture_transform;ct.offsetScale=[it.offset[0],it.offset[1],it.scale[0],it.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Vo(...Le),metallicFactor:ke,roughnessFactor:Be,baseColorTexture:We?q[We.index]:void 0,metallicRoughnessTexture:tt?q[tt.index]:void 0},doubleSided:Te,emissiveFactor:Z,alphaMode:J,alphaCutoff:ne,normalTexture:le?q[le.index]:void 0,occlusionTexture:ct,emissionTexture:Ee?q[Ee.index]:void 0,defined:void 0===j.defined}}(void 0!==V?s.json.materials[V]:{defined:!1},d),y}function g_(a,s,d){const{matrix:f,rotation:v,translation:y,scale:E,mesh:M,extras:k,children:R}=a,L={};if(L.matrix=f||_.a6.fromRotationTranslationScale([],v||[0,0,0,1],y||[0,0,0],E||[1,1,1]),void 0!==M){L.meshes=d[M];const V=L.anchor=[0,0];for(const j of L.meshes){const{min:q,max:Z}=j.aabb;V[0]+=q[0]+Z[0],V[1]+=q[1]+Z[1]}V[0]=Math.floor(V[0]/L.meshes.length/2),V[1]=Math.floor(V[1]/L.meshes.length/2)}if(k&&(k.id&&(L.id=k.id),k.lights&&(L.lights=function(V){if(!V.length)return[];const j=function(le){const xe=atob(le),Ee=new Uint8Array(xe.length);for(let Te=0;Te<xe.length;Te++)Ee[Te]=xe.codePointAt(Te);return Ee}(V),q=[],Z=j.length/24,J=new Uint16Array(j.buffer),ne=new Float32Array(j.buffer);for(let le=0;le<Z;le++){const xe=J[2*le*6]/30,Ee=J[2*le*6+1]/30,Te=J[2*le*6+10]/100,Le=ne[6*le+1],ke=ne[6*le+2],Be=ne[6*le+3],We=ne[6*le+4],tt=Be-Le,ct=We-ke,it=Math.hypot(tt,ct);q.push({pos:[Le+.5*tt,ke+.5*ct,Ee],normal:[ct/it,-tt/it,0],width:it,height:xe,depth:Te,points:[Le,ke,Be,We]})}return q}(k.lights))),R){const V=[];for(const j of R)V.push(g_(s.json.nodes[j],s,d));L.children=V}return L}function l0(a){if(0===a.vertices.length||0===a.indices.length)return null;const[s,d]=[a.vertices[0].clone(),a.vertices[0].clone()];for(let E=1;E<a.vertices.length;++E){const M=a.vertices[E];s.x=Math.min(s.x,M.x),s.y=Math.min(s.y,M.y),d.x=Math.max(d.x,M.x),d.y=Math.max(d.y,M.y)}const f=Math.ceil(Math.max(d.x-s.x,d.y-s.y)/256),v=Math.max(8,f),y=new $w(a.vertices,a.indices,v);return{vertices:a.vertices,indices:a.indices,grid:y,min:s,max:d}}function Fl(a){if(!a.extras||!a.extras.ground)return null;const s=a.extras.ground;if(!s||!Array.isArray(s)||0===s.length)return null;const d=s[0];if(!d||!Array.isArray(d)||0===d.length)return null;const f=[];for(const E of d){if(!Array.isArray(E)||2!==E.length)continue;const M=E[0],k=E[1];"number"==typeof M&&"number"==typeof k&&f.push(new mt(M,k))}if(f.length<3)return null;f.length>1&&f[f.length-1].equals(f[0])&&f.pop();let v=0;for(let E=0;E<f.length;E++){const M=f[E],k=f[(E+1)%f.length],R=f[(E+2)%f.length];v+=(M.x-k.x)*(R.y-k.y)-(R.x-k.x)*(M.y-k.y)}v>0&&f.reverse();const y=Oy(f.flatMap(E=>[E.x,E.y]),[]);return 0===y.length?null:{vertices:f,indices:y}}function Ww(a){const s=[],d=[];let f=0;for(const v of a){f=s.length;const y=v.vertexArray.float32,E=v.indexArray.uint16;for(let M=0;M<v.vertexArray.length;M++)s.push(new mt(y[3*M+0],y[3*M+1]));for(let M=0;M<3*v.indexArray.length;M++)d.push(E[M]+f)}if(d.length%3!=0)return null;for(let v=0;v<d.length;v+=3){const y=s[d[v+0]],E=s[d[v+1]],M=s[d[v+2]];(y.x-E.x)*(M.y-E.y)-(M.x-E.x)*(y.y-E.y)>0&&([d[v+1],d[v+2]]=[d[v+2],d[v+1]])}return{vertices:s,indices:d}}function qM(a){const d=function(k,R){const L=[];for(const V of k.json.meshes){const j=[];for(const q of V.primitives)j.push(Hp(q,k,R));L.push(j)}return L}(a,function(k,R){const L=[],V=WebGL2RenderingContext;if(k.json.textures)for(const j of k.json.textures){const q={magFilter:V.LINEAR,minFilter:V.NEAREST,wrapS:V.REPEAT,wrapT:V.REPEAT};void 0!==j.sampler&&Object.assign(q,k.json.samplers[j.sampler]),L.push({image:R[j.source],sampler:q,uploaded:!1})}return L}(a,a.images)),{scenes:f,scene:v,nodes:y}=a.json,E=f?f[v||0].nodes:y,M=[];for(const k of E)M.push(g_(y[k],a,d));return function(k,R,L){const V={},j=new Set;for(let q=0;q<k.length;q++){const Z=L[R[q]];if(!Z.extras)continue;const J=Z.extras["mapbox:footprint:version"],ne=Z.extras["mapbox:footprint:id"];(J||ne)&&j.add(q),"1.0.0"===J&&ne&&(V[ne]=q)}for(let q=0;q<k.length;q++){if(j.has(q))continue;const Z=k[q],J=L[R[q]];if(!J.extras)continue;let ne=null;Z.id in V&&(ne=Ww(k[V[Z.id]].meshes)),ne||(ne=Fl(J)),ne&&(Z.footprint=l0(ne))}if(j.size>0){const q=Array.from(j.values()).sort((Z,J)=>Z-J);for(let Z=q.length-1;Z>=0;Z--)k.splice(q[Z],1)}}(M,E,a.json.nodes),M}function YM(a){a.heightmap=new Float32Array(4096),a.heightmap.fill(-1);const s=a.vertexArray.float32,d=a.aabb.min[0]-1,f=a.aabb.min[1]-1,v=64/(a.aabb.max[0]-d+2),y=64/(a.aabb.max[1]-f+2);for(let E=0;E<s.length;E+=3){const M=s[E+2],k=(s[E+0]-d)*v|0,R=(s[E+1]-f)*y|0;M>a.heightmap[64*R+k]&&(a.heightmap[64*R+k]=M)}}function RE(a,s){const d={};d.indexArray=new ln,d.indexArray.reserve(4*a.length),d.vertexArray=new Ha,d.vertexArray.reserve(10*a.length),d.colorArray=new Fu,d.vertexArray.reserve(10*a.length);let f=0;for(const E of a){const M=Math.min(10,Math.max(4,1.3*E.height))*s,k=[-E.normal[1],E.normal[0],0],R=Math.min(.29,.1*E.width/E.depth),L=E.width-2*E.depth*s*(R+.01),V=_.N.scaleAndAdd([],E.pos,k,L/2),j=_.N.scaleAndAdd([],E.pos,k,-L/2),q=[V[0],V[1],V[2]+E.height],Z=[j[0],j[1],j[2]+E.height],J=_.N.scaleAndAdd([],E.normal,k,R);_.N.scale(J,J,M);const ne=_.N.scaleAndAdd([],E.normal,k,-R);_.N.scale(ne,ne,M),_.N.add(J,V,J),_.N.add(ne,j,ne),V[2]+=.1,j[2]+=.1,d.vertexArray.emplaceBack(J[0],J[1],J[2]),d.vertexArray.emplaceBack(ne[0],ne[1],ne[2]),d.vertexArray.emplaceBack(V[0],V[1],V[2]),d.vertexArray.emplaceBack(j[0],j[1],j[2]),d.vertexArray.emplaceBack(q[0],q[1],q[2]),d.vertexArray.emplaceBack(Z[0],Z[1],Z[2]),d.vertexArray.emplaceBack(V[0],V[1],V[2]),d.vertexArray.emplaceBack(j[0],j[1],j[2]),d.vertexArray.emplaceBack(J[0],J[1],J[2]),d.vertexArray.emplaceBack(ne[0],ne[1],ne[2]);const le=L/M/2;d.colorArray.emplaceBack(-le-R,-1,le,.8),d.colorArray.emplaceBack(le+R,-1,le,.8),d.colorArray.emplaceBack(-le,0,le,1.3),d.colorArray.emplaceBack(le,0,le,1.3),d.colorArray.emplaceBack(le+R,-.8,le,.7),d.colorArray.emplaceBack(le+R,-.8,le,.7),d.colorArray.emplaceBack(0,0,le,1.3),d.colorArray.emplaceBack(0,0,le,1.3),d.colorArray.emplaceBack(le+R,-1.2,le,.8),d.colorArray.emplaceBack(le+R,-1.2,le,.8),d.indexArray.emplaceBack(6+f,4+f,8+f),d.indexArray.emplaceBack(7+f,9+f,5+f),d.indexArray.emplaceBack(0+f,1+f,2+f),d.indexArray.emplaceBack(1+f,3+f,2+f),f+=10}const v={defined:!0,emissiveFactor:[0,0,0]},y={};return y.baseColorFactor=Vo.white,v.pbrMetallicRoughness=y,d.material=v,d.aabb=new ss([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),d}Oi($w,"TriangleGridIndex");class c0{constructor(s){this._stringToNumber={},this._numberToString=[];for(let d=0;d<s.length;d++){const f=s[d];this._stringToNumber[f]=d,this._numberToString[d]=f}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const PE=["tile","layer","source","sourceLayer","state"];class __{constructor(s,d,f,v,y){this.type="Feature",this._vectorTileFeature=s,this._z=d,this._x=f,this._y=v,this.properties=s.properties,this.id=y}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(s.id=this.id);for(const d of PE)void 0!==this[d]&&(s[d]=this[d]);return s}}class La{constructor(s,d){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Qd(Nt,16,0),this.featureIndexArray=new sr,this.promoteId=d,this.is3DTile=!1}insert(s,d,f,v,y,E=0,M=0){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,v,y,E);const R=this.grid;for(let L=0;L<d.length;L++){const V=d[L],j=[1/0,1/0,-1/0,-1/0];for(let q=0;q<V.length;q++){const Z=V[q];j[0]=Math.min(j[0],Z.x),j[1]=Math.min(j[1],Z.y),j[2]=Math.max(j[2],Z.x),j[3]=Math.max(j[3],Z.y)}0!==M&&(j[0]-=M,j[1]-=M,j[2]+=M,j[3]+=M),j[0]<Nt&&j[1]<Nt&&j[2]>=0&&j[3]>=0&&R.insert(k,j[0],j[1],j[2],j[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new bw(new ru(this.rawTileData)).layers,this.sourceLayerCoder=new c0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,d,f,v){this.loadVTLayers();const y=s.params||{},E=Fs(y.filter),M=s.tileResult,k=s.transform,R=M.bufferedTilespaceBounds,L=this.grid.query(R.min.x,R.min.y,R.max.x,R.max.y,(Z,J,ne,le)=>Fx(M.bufferedTilespaceGeometry,Z,J,ne,le));L.sort(LE);let V=null;k.elevation&&L.length>0&&(V=Rv.create(k.elevation,this.tileID));const j={};let q;for(let Z=0;Z<L.length;Z++){const J=L[Z];if(J===q)continue;q=J;const ne=this.featureIndexArray.get(J);let le=null;if(this.is3DTile){const xe=this.bucketLayerIDs[0][0],Ee=d[xe];if("model"!==Ee.type)continue;const{queryFeature:Te,intersectionZ:Le}=Ee.queryIntersectsMatchingFeature(M,ne.featureIndex,E,k);Te&&this.appendToResult(j,xe,ne.featureIndex,Te,Le)}else this.loadMatchingFeature(j,ne,E,y.layers,y.availableImages,d,f,v,(xe,Ee,Te,Le=0)=>(le||(le=Ks(xe,this.tileID.canonical,s.tileTransform)),Ee.queryIntersectsFeature(M,xe,Te,le,this.z,s.transform,s.pixelPosMatrix,V,Le)))}return j}loadMatchingFeature(s,d,f,v,y,E,M,k,R){const{featureIndex:L,bucketIndex:V,sourceLayerIndex:j,layoutVertexArrayOffset:q}=d,Z=this.bucketLayerIDs[V];if(v&&!function(xe,Ee){for(let Te=0;Te<xe.length;Te++)if(Ee.indexOf(xe[Te])>=0)return!0;return!1}(v,Z))return;const J=this.sourceLayerCoder.decode(j),ne=this.vtLayers[J].feature(L);if(f.needGeometry){const xe=ks(ne,!0);if(!f.filter(new qr(this.tileID.overscaledZ),xe,this.tileID.canonical))return}else if(!f.filter(new qr(this.tileID.overscaledZ),ne))return;const le=this.getId(ne,J);for(let xe=0;xe<Z.length;xe++){const Ee=Z[xe];if(v&&v.indexOf(Ee)<0)continue;const Te=E[Ee];if(!Te)continue;let Le={};void 0!==le&&k&&(Le=k.getState(Te.sourceLayer||"_geojsonTileLayer",le));const ke=!R||R(ne,Te,Le,q);if(!ke)continue;const Be=new __(ne,this.z,this.x,this.y,le),We=Hr({},M[Ee]);We.paint=OE(We.paint,Te.paint,ne,Le,y),We.layout=OE(We.layout,Te.layout,ne,Le,y),Be.layer=We,this.appendToResult(s,Ee,L,Be,ke)}}appendToResult(s,d,f,v,y){let E=s[d];void 0===E&&(E=s[d]=[]),E.push({featureIndex:f,feature:v,intersectionZ:y})}lookupSymbolFeatures(s,d,f,v,y,E,M,k){const R={};this.loadVTLayers();const L=Fs(y);for(const V of s)this.loadMatchingFeature(R,{bucketIndex:f,sourceLayerIndex:v,featureIndex:V,layoutVertexArrayOffset:0},L,E,M,k,d);return R}loadFeature(s){const{featureIndex:d,sourceLayerIndex:f}=s;this.loadVTLayers();const v=this.sourceLayerCoder.decode(f),y=this.vtFeatures[v];if(y[d])return y[d];const E=this.vtLayers[v].feature(d);return y[d]=E,E}hasLayer(s){for(const d of this.bucketLayerIDs)for(const f of d)if(s===f)return!0;return!1}getId(s,d){let f=s.id;if(this.promoteId){const v="string"==typeof this.promoteId?this.promoteId:this.promoteId[d];null!=v&&(f=s.properties[v]),"boolean"==typeof f&&(f=Number(f))}return f}}function OE(a,s,d,f,v){return No(a,(y,E)=>{const M=s instanceof Ff?s.get(E):null;return M&&M.evaluate?M.evaluate(d,f,v):M})}function LE(a,s){return s-a}Oi(La,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const d0=new Float32Array(262144),ih=new Uint8Array(262144);function Xw(a){let s=0;if(a.meshes)for(const d of a.meshes)s=Math.max(s,d.aabb.max[2]);if(a.children)for(const d of a.children)s=Math.max(s,Xw(d));return s}function qw(a,s,d){if(a.meshes)for(const f of a.meshes)f.aabb.min[0]!==1/0&&d.insert(s,f.aabb.min[0],f.aabb.min[1],f.aabb.max[0],f.aabb.max[1]);if(a.children)for(const f of a.children)qw(f,s,d)}const FE=["","wall","door","roof","window","lamp","logo"];class v_{constructor(s){this.node=s,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:s.id,geometry:[],properties:{height:Xw(s)}}}getLocalBounds(){if(!this.node.meshes)return new ss([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let s=0;const d=new ss([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const f of this.node.meshes)this.node.lightMeshIndex!==s&&d.encapsulate(f.aabb),s++;this.aabb=d}return this.aabb}}class hu{constructor(s,d,f,v,y,E){this.id=d,this.modelTraits|=th.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,f&&(this.modelTraits|=th.HasMapboxMeshFeatures),v&&(this.modelTraits|=th.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=y,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const M of s)this.nodesInfo.push(new v_(M)),qw(M,E.featureIndexArray.length,E.grid),E.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,E.bucketLayerIDs.length-1,0)}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(s){if(!this.needsUpload)return;const d=this.getNodesInfo();for(const f of d){const v=f.node;this.uploaded?this.updatePbrBuffer(v):ME(v,s,!0)}for(const f of d)tb(f.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(s){let d=!1;if(!s.meshes)return d;for(const f of s.meshes)f.pbrBuffer&&(f.pbrBuffer.updateData(f.featureArray),d=!0);return d}needsReEvaluation(s,d,f){const v=s.transform.projectionOptions,y=s.style.getBrightness(),E=this.brightness!==y;return!!(!this.uploaded||this.dirty||v.name!==this.projection.name||$p(f.paint.get("model-color").value,E)||$p(f.paint.get("model-color-mix-intensity").value,E)||$p(f.paint.get("model-roughness").value,E)||$p(f.paint.get("model-emissive-strength").value,E)||$p(f.paint.get("model-height-based-emissive-strength-multiplier").value,E))&&(this.projection=v,this.brightness=y,!0)}evaluateScale(s,d){if(s.transform.zoom===this.zoom)return;this.zoom=s.transform.zoom;const f=this.getNodesInfo(),v=this.id.canonical;for(const y of f){const E=y.feature;y.evaluatedScale=d.paint.get("model-scale").evaluate(E,{},v)}}evaluate(s){const d=this.getNodesInfo();for(const f of d){if(!f.node.meshes)continue;const v=f.feature,y=f.node.meshes&&f.node.meshes[0].featureData,E=f.evaluatedColor[2],M=f.evaluatedRMEA[2],k=this.id.canonical;if(f.hasTranslucentParts=!1,y){for(let R=0;R<FE.length;R++){const L=FE[R];L.length&&(v.properties.part=L);const V=s.paint.get("model-color").evaluate(v,{},k),j=s.paint.get("model-color-mix-intensity").evaluate(v,{},k);f.evaluatedColor[R]=[V.r,V.g,V.b,j],f.evaluatedRMEA[R][0]=s.paint.get("model-roughness").evaluate(v,{},k),f.evaluatedRMEA[R][2]=s.paint.get("model-emissive-strength").evaluate(v,{},k),f.evaluatedRMEA[R][3]=V.a,f.emissionHeightBasedParams[R]=s.paint.get("model-height-based-emissive-strength-multiplier").evaluate(v,{},k),!f.hasTranslucentParts&&V.a<1&&(f.hasTranslucentParts=!0)}delete v.properties.part,Qc(f,E!==f.evaluatedColor[2]||M!==f.evaluatedRMEA[2],this.modelTraits)}else f.evaluatedRMEA[0][2]=s.paint.get("model-emissive-strength").evaluate(v,{},k);f.evaluatedScale=s.paint.get("model-scale").evaluate(v,{},k),this.updatePbrBuffer(f.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(s,d,f,v){const y=s.findDEMTileFor(f);if(y&&(y.tileID.canonical!==this.terrainTile||d!==this.terrainExaggeration)){if(y.dem&&y.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=y.tileID.overscaledZ;const E=Rv.create(s,f,y);if(!E)return;this.modelTraits&th.HasMapboxMeshFeatures&&this.updateDEM(s,E,f,v);for(const M of this.getNodesInfo()){const k=M.node;if(!k.footprint||!k.footprint.vertices||!k.footprint.vertices.length)continue;const R=k.footprint.vertices;let L=E.getElevationAt(R[0].x,R[0].y,!0,!0);for(let V=1;V<R.length;V++)L=Math.min(L,E.getElevationAt(R[V].x,R[V].y,!0,!0));k.elevation=L}}this.terrainTile=y.tileID.canonical,this.terrainExaggeration=d}}updateDEM(s,d,f,v){let y=d._dem._modifiedForSources[v];if(void 0===y&&(d._dem._modifiedForSources[v]=[],y=d._dem._modifiedForSources[v]),y.includes(f.canonical))return;const E=d._dem.dim;y.push(f.canonical);let M=!1;for(const k of this.getNodesInfo()){const R=k.node;if(!R.footprint||!R.footprint.grid)continue;const L=R.footprint.grid,V=d.tileCoordToPixel(L.min.x,L.min.y),j=d.tileCoordToPixel(L.max.x,L.max.y),q=Math.min(Math.min(E-j.y,V.x),Math.min(V.y,E-j.x));if(q<0)continue;const Z=Ii(q,2,5);let J=Math.max(0,V.x-Z),ne=Math.max(0,V.y-Z),le=Math.min(j.x+Z,E-1),xe=Math.min(j.y+Z,E-1);for(let ke=ne;ke<=xe;++ke)for(let Be=J;Be<=le;++Be)ih[ke*E+Be]=255;let Ee=0,Te=0;for(let ke=0;ke<L.cellsY;++ke)for(let Be=0;Be<L.cellsX;++Be){if(!L.cells[ke*L.cellsX+Be])continue;const We=d.tileCoordToPixel(L.min.x+Be/L.xScale,L.min.y+ke/L.yScale),tt=d.tileCoordToPixel(L.min.x+(Be+1)/L.xScale,L.min.y+(ke+1)/L.yScale);for(let ct=We.y;ct<=Math.min(tt.y+1,E-1);++ct)for(let it=We.x;it<=Math.min(tt.x+1,E-1);++it)255===ih[ct*E+it]&&(ih[ct*E+it]=0,Ee+=d.getElevationAtPixel(it,ct),Te++)}const Le=Ee/Te;J=Math.max(1,V.x-Z),ne=Math.max(1,V.y-Z),le=Math.min(j.x+Z,E-2),xe=Math.min(j.y+Z,E-2),M=!0;for(let ke=ne;ke<=xe;++ke)for(let Be=J;Be<=le;++Be)0===ih[ke*E+Be]&&(d0[ke*E+Be]=d._dem.set(Be,ke,Le));for(let ke=1;ke<Z;++ke){J=Math.max(1,V.x-ke),ne=Math.max(1,V.y-ke),le=Math.min(j.x+ke,E-2),xe=Math.min(j.y+ke,E-2);for(let Be=ne;Be<=xe;++Be)for(let We=J;We<=le;++We){const tt=Be*E+We;if(255===ih[tt]){let ct=0,it=0,xt=-1,Rt=-1;for(let _t=-1;_t<=1;++_t)for(let At=-1;At<=1;++At){const ft=(Be+_t)*E+We+At;if(ih[ft]>=ke)continue;const Dt=d0[ft],ii=Math.abs(Dt);ii>it&&(ct=Dt,it=ii,xt=At,Rt=_t)}if(it>.1){const _t=1-(ke+.5*Math.abs(xt*Rt))/Z;let At=d._dem.get(We,Be)+ct*_t;const ft=d._dem.get(We+xt,Be+Rt),Dt=d._dem.get(We-xt,Be-Rt,!0);(At-ft)*(At-Dt)>0&&(At=(ft+Dt)/2),d0[tt]=d._dem.set(We,Be,At),ih[tt]=ke}}}}}M&&(d._demTile.needsDEMTextureUpload=!0,d._dem._timestamp=Ht.now())}getNodesInfo(){return this.nodesInfo}destroy(){const s=this.getNodesInfo();for(const d of s)tb(d.node),zw(d.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(s,d){if(d.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=d.updateTime;const f=d.getReplacementRegionsForTile(s.toUnwrapped()),v=this.getNodesInfo();for(let y=0;y<this.nodesInfo.length;y++){const E=v[y].node;v[y].hiddenByReplacement=!!E.footprint&&!f.find(M=>M.footprint===E.footprint)}}getHeightAtTileCoord(s,d){const f=this.getNodesInfo(),v=[];for(let y=0;y<this.nodesInfo.length;y++){const E=f[y],M=E.node.meshes[0];if(s<M.aabb.min[0]||d<M.aabb.min[1]||s>M.aabb.max[0]||d>M.aabb.max[1])continue;const k=(s-M.aabb.min[0])/(M.aabb.max[0]-M.aabb.min[0])*64|0,R=64*Math.min(63,(d-M.aabb.min[1])/(M.aabb.max[1]-M.aabb.min[1])*64|0)+Math.min(63,k);if(!(M.heightmap[R]<0&&E.node.footprint))return E.hiddenByReplacement?void 0:{height:M.heightmap[R],maxHeight:E.feature.properties.height,hidden:!1,verticalScale:E.evaluatedScale[2]};if(E.node.footprint.grid.query(new mt(s,d),new mt(s,d),v),v.length>0)return{height:void 0,maxHeight:E.feature.properties.height,hidden:E.hiddenByReplacement,verticalScale:E.evaluatedScale[2]}}}}function $p(a,s){return!a.isLightConstant&&s}function b_(a,s,d,f,v,y,E,M){let k=(61440&s|(61440&s)>>4)>>8,R=(3840&s|(3840&s)>>4)>>4,L=240&s|(240&s)>>4;d[3]>0&&(k=rr(k,255*d[0],d[3]),R=rr(R,255*d[1],d[3]),L=rr(L,255*d[2],d[3]));const V=k<<8|R,j=L<<8|Math.floor(255*f[3]),q=function(ke){const Be=Ii(ke,0,2);return Math.min(Math.round(.5*Be*255),255)}(f[2])<<8|15*f[0]<<4|15*f[1],Z=Ii(v[0],0,1),J=Ii(v[1],0,1),ne=Ii(v[2],0,1),le=Ii(v[3],0,1);let xe,Ee,Te,Le;if(Z!==J&&E!==y&&J!==Z){const ke=E-y;Ee=1/(ke*(J-Z)),Te=-(y+ke*Z)/(ke*(J-Z));const Be=Ii(v[4],-1,1);Le=Math.pow(10,Be),xe=255*ne<<8|255*le}else xe=65535,Ee=0,Te=1,Le=1;if(a.emplaceBack(V,j,q,xe,Ee,Te,Le),M){const ke=M.length;M.clear();for(let Be=0;Be<ke;Be++)M.emplaceBack(V,j,q,xe,Ee,Te,Le)}}function Qc(a,s,d){const f=a.node;let v=0;const y=d&th.HasMeshoptCompression;for(const E of f.meshes){if(f.lights&&f.lightMeshIndex===v||!E.featureData)continue;E.featureArray=new Gf,E.featureArray.reserve(E.featureData.length);let M=s;for(const k of E.featureData){const R=y?65535&k:k>>16&65535,L=y?k>>16&65535:65535&k,V=(15&L)<8?15&L:0,j=a.evaluatedRMEA[V],q=a.evaluatedColor[V],Z=a.emissionHeightBasedParams[V];let J;if(M&&2===V&&f.lights&&(J=new Gf,J.resize(10*f.lights.length)),b_(E.featureArray,R,q,j,Z,E.aabb.min[2],E.aabb.max[2],J),J&&M){M=!1;const ne=f.meshes[f.lightMeshIndex];ne.featureArray=J,ne.featureArray._trim()}}E.featureArray._trim(),v++}}function fu(a,s,d,f){const v=1<<a.z;s.lat=fr((f/Nt+a.y)/v),s.lng=Dn((d/Nt+a.x)/v)}Oi(hu,"Tiled3dModelBucket",{omit:["layers"]}),Oi(v_,"Tiled3dModelFeature");const u0={circle:class extends Tl{constructor(a,s,d){super(a,Og,s,d)}createBucket(a){return new nl(a)}queryRadius(a){const s=a;return bc("circle-radius",this,s)+bc("circle-stroke-width",this,s)+up(this.paint.get("circle-translate"))}queryIntersectsFeature(a,s,d,f,v,y,E,M){const k=iu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,a.pixelToTileUnitsFactor),R=this.paint.get("circle-radius").evaluate(s,d)+this.paint.get("circle-stroke-width").evaluate(s,d);return zC(a,f,y,E,M,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),k,R)}getProgramIds(){return["circle"]}getDefaultProgramParams(a,s){const d=VC(this);return{config:new ie(this,s),defines:d,overrideFog:!1}}},heatmap:class extends Tl{createBucket(a){return new eM(a)}constructor(a,s,d){super(a,Ty,s,d),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"heatmap-color"===a&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Sy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return bc("heatmap-radius",this,a)}queryIntersectsFeature(a,s,d,f,v,y,E,M){const k=this.paint.get("heatmap-radius").evaluate(s,d);return zC(a,f,y,E,M,!0,!0,new mt(0,0),k)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(a,s){return"heatmap"===a?{config:new ie(this,s),overrideFog:!1}:{}}},hillshade:class extends Tl{constructor(a,s,d){super(a,UC,s,d)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(a,s){return{overrideFog:!1}}},fill:class extends Tl{constructor(a,s,d){super(a,Ly,s,d)}getProgramIds(){const a=this.paint.get("fill-pattern"),s=a&&a.constantOr(1),d=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&d.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),d}getDefaultProgramParams(a,s){return{config:new ie(this,s),overrideFog:!1}}recalculate(a,s){super.recalculate(a,s);const d=this.paint._values["fill-outline-color"];"constant"===d.value.kind&&void 0===d.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new Ug(a)}queryRadius(){return up(this.paint.get("fill-translate"))}queryIntersectsFeature(a,s,d,f,v,y){return!a.queryGeometry.isAboveHorizon&&Xc(fd(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,a.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends Tl{constructor(a,s,d){super(a,aI,s,d),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(a){return new Pv(a)}queryRadius(){return up(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(a,s,d,f,v,y,E,M,k){const R=iu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,a.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(s,d),V=this.paint.get("fill-extrusion-base").evaluate(s,d),j=[0,0],q=M&&y.elevation,Z=y.elevation?y.elevation.exaggeration():1,J=a.tile.getBucket(this);if(q&&J instanceof Pv){const Te=J.centroidVertexArray,Le=k+1;Le<Te.length&&(j[0]=Te.geta_centroid_pos0(Le),j[1]=Te.geta_centroid_pos1(Le))}if(0===j[0]&&1===j[1])return!1;"globe"===y.projection.name&&(f=mM([f],[new mt(0,0),new mt(Nt,Nt)],a.tileID.canonical).map(Te=>Te.polygon).flat());const ne=q?M:null,[le,xe]=(Le=f,ke=V,Be=L,We=R,tt=E,ct=ne,it=j,xt=Z,Rt=y.center.lat,"globe"===(Te=y).projection.name?function(At,ft,Dt,ii,Lt,Ui,Ti,Ut,on,Gi,Bi){const Gt=[],Qi=[],Hn=At.projection.upVectorScale(Bi,At.center.lat,At.worldSize).metersToTile,hn=[0,0,0,1],Yn=[0,0,0,1],In=(Rn,po,Fr,Mr)=>{Rn[0]=po,Rn[1]=Fr,Rn[2]=Mr,Rn[3]=1},xr=fM();Dt>0&&(Dt+=xr),ii+=xr;for(const Rn of ft){const po=[],Fr=[];for(const Mr of Rn){const Er=Mr.x+Lt.x,Gr=Mr.y+Lt.y,Mo=At.projection.projectTilePoint(Er,Gr,Bi),Jr=At.projection.upVector(Bi,Mr.x,Mr.y);let ms=Dt,Is=ii;if(Ti){const aa=tE(Er,Gr,Dt,ii,Ti,Ut,on,Gi);ms+=aa.base,Is+=aa.top}0!==Dt?In(hn,Mo.x+Jr[0]*Hn*ms,Mo.y+Jr[1]*Hn*ms,Mo.z+Jr[2]*Hn*ms):In(hn,Mo.x,Mo.y,Mo.z),In(Yn,Mo.x+Jr[0]*Hn*Is,Mo.y+Jr[1]*Hn*Is,Mo.z+Jr[2]*Hn*Is),_.N.transformMat4(hn,hn,Ui),_.N.transformMat4(Yn,Yn,Ui),po.push(new Ov(hn[0],hn[1],hn[2])),Fr.push(new Ov(Yn[0],Yn[1],Yn[2]))}Gt.push(po),Qi.push(Fr)}return[Gt,Qi]}(Te,Le,ke,Be,We,tt,ct,it,xt,Rt,a.tileID.canonical):ct?function(At,ft,Dt,ii,Lt,Ui,Ti,Ut,on){const Gi=[],Bi=[],Gt=[0,0,0,1];for(const Qi of At){const Hn=[],hn=[];for(const Yn of Qi){const In=Yn.x+ii.x,xr=Yn.y+ii.y,Rn=tE(In,xr,ft,Dt,Ui,Ti,Ut,on);Gt[0]=In,Gt[1]=xr,Gt[2]=Rn.base,Gt[3]=1,_.a7.transformMat4(Gt,Gt,Lt),Gt[3]=Math.max(Gt[3],1e-5);const po=new Ov(Gt[0]/Gt[3],Gt[1]/Gt[3],Gt[2]/Gt[3]);Gt[0]=In,Gt[1]=xr,Gt[2]=Rn.top,Gt[3]=1,_.a7.transformMat4(Gt,Gt,Lt),Gt[3]=Math.max(Gt[3],1e-5);const Fr=new Ov(Gt[0]/Gt[3],Gt[1]/Gt[3],Gt[2]/Gt[3]);Hn.push(po),hn.push(Fr)}Gi.push(Hn),Bi.push(hn)}return[Gi,Bi]}(Le,ke,Be,We,tt,ct,it,xt,Rt):function(At,ft,Dt,ii,Lt){const Ui=[],Ti=[],Ut=Lt[8]*ft,on=Lt[9]*ft,Gi=Lt[10]*ft,Bi=Lt[11]*ft,Gt=Lt[8]*Dt,Qi=Lt[9]*Dt,Hn=Lt[10]*Dt,hn=Lt[11]*Dt;for(const Yn of At){const In=[],xr=[];for(const Rn of Yn){const po=Rn.x+ii.x,Fr=Rn.y+ii.y,Mr=Lt[0]*po+Lt[4]*Fr+Lt[12],Er=Lt[1]*po+Lt[5]*Fr+Lt[13],Gr=Lt[2]*po+Lt[6]*Fr+Lt[14],Mo=Lt[3]*po+Lt[7]*Fr+Lt[15],Jr=Mr+Ut,ms=Er+on,Is=Gr+Gi,aa=Math.max(Mo+Bi,1e-5),Uo=Mr+Gt,ts=Er+Qi,ma=Gr+Hn,pa=Math.max(Mo+hn,1e-5);In.push(new Ov(Jr/aa,ms/aa,Is/aa)),xr.push(new Ov(Uo/pa,ts/pa,ma/pa))}Ui.push(In),Ti.push(xr)}return[Ui,Ti]}(Le,ke,Be,We,tt)),Ee=a.queryGeometry;var Te,Le,ke,Be,We,tt,ct,it,xt,Rt;return function(Te,Le,ke){let Be=1/0;Xc(ke,Le)&&(Be=zy(ke,Le[0]));for(let We=0;We<Le.length;We++){const tt=Le[We],ct=Te[We];for(let it=0;it<tt.length-1;it++){const xt=tt[it],Rt=[xt,tt[it+1],ct[it+1],ct[it],xt];vc(ke,Rt)&&(Be=Math.min(Be,zy(ke,Rt)))}}return Be!==1/0&&Be}(le,xe,Ee.isPointQuery()?Ee.screenBounds:Ee.screenGeometry)}},line:class extends Tl{constructor(a,s,d){super(a,yM,s,d),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if("line-gradient"===a){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof Nc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,s){super.recalculate(a,s),this.paint._values["line-floorwidth"]=wM.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new rE(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(a,s){const d=uI(this);return{config:new ie(this,s),defines:d,overrideFog:!1}}queryRadius(a){const s=a,d=CM(bc("line-width",this,s),bc("line-gap-width",this,s)),f=bc("line-offset",this,s);return d/2+Math.abs(f)+up(this.paint.get("line-translate"))}queryIntersectsFeature(a,s,d,f,v,y){if(a.queryGeometry.isAboveHorizon)return!1;const E=fd(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,a.pixelToTileUnitsFactor),M=a.pixelToTileUnitsFactor/2*CM(this.paint.get("line-width").evaluate(s,d),this.paint.get("line-gap-width").evaluate(s,d)),k=this.paint.get("line-offset").evaluate(s,d);return k&&(f=function(R,L){const V=[],j=new mt(0,0);for(let q=0;q<R.length;q++){const Z=R[q],J=[];for(let ne=0;ne<Z.length;ne++){const le=Z[ne],xe=Z[ne+1],Ee=0===ne?j:le.sub(Z[ne-1])._unit()._perp(),Te=ne===Z.length-1?j:xe.sub(le)._unit()._perp(),Le=Ee._add(Te)._unit();Le._mult(1/(Le.x*Te.x+Le.y*Te.y)),J.push(Le._mult(L)._add(le))}V.push(J)}return V}(f,k*a.pixelToTileUnitsFactor)),function(R,L,V){for(let j=0;j<L.length;j++){const q=L[j];if(R.length>=3)for(let Z=0;Z<q.length;Z++)if(ju(R,q[Z]))return!0;if(Wl(R,q,V))return!0}return!1}(E,f,M)}isTileClipped(){return!0}},symbol:a_,background:class extends Tl{constructor(a,s,d){super(a,FM,s,d)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(a,s){return{overrideFog:!1}}},raster:vm,"raster-particle":Fp,sky:class extends Tl{constructor(a,s,d){super(a,zM,s,d),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"sky-gradient"===a?this._updateColorRamp():"sky-atmosphere-sun"!==a&&"sky-atmosphere-halo-color"!==a&&"sky-atmosphere-color"!==a&&"sky-atmosphere-sun-intensity"!==a||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Sy({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(a,s){if("atmosphere"===this.paint.get("sky-type")){const f=this.paint.get("sky-atmosphere-sun"),v=!f,y=a.style.light,E=y.properties.get("position");return v&&"viewport"===y.properties.get("anchor")&&Qe("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),v?Fw(E.azimuthal,90-E.polar,s):Fw(f[0],90-f[1],s)}const d=this.paint.get("sky-gradient-center");return Fw(d[0],90-d[1],s)}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return"atmosphere"===a?["skyboxCapture","skybox"]:"gradient"===a?["skyboxGradient"]:null}},slot:class extends Tl{constructor(a,s,d){super(a,CI,s)}},model:class extends Tl{constructor(a,s,d){super(a,TI,s,d),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(a){return new eh(a)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(a){return a instanceof hu?Nt-1:0}queryIntersectsFeature(a,s,d,f,v,y){if(!this.modelManager)return!1;const E=this.modelManager,M=a.tile.getBucket(this);if(!(M&&M instanceof eh))return!1;const k=M;for(const R in k.instancesPerModel){const L=k.instancesPerModel[R];if(L.idToFeaturesIndex.hasOwnProperty(s.id)){const V=L.features[L.idToFeaturesIndex[s.id]],j=E.getModel(R,this.scope);if(!j)return!1;let q=_.a6.create();const Z=new Ze(0,0),J=k.canonical;let ne=Number.MAX_VALUE;for(let le=0;le<V.instancedDataCount;++le){const xe=16*(V.instancedDataOffset+le),Ee=L.instancedDataArray.float32,Te=[Ee[xe+4],Ee[xe+5],Ee[xe+6]];fu(J,Z,Ee[xe],0|Ee[xe+1]),cl(q,j,y,Z,V.rotation,V.scale,Te,!1,!1,!1),"globe"===y.projection.name&&(q=Bw(q,y));const Le=_.a6.multiply([],y.projMatrix,q),ke=a.queryGeometry,Be=Xa(ke.isPointQuery()?ke.screenBounds:ke.screenGeometry,y,Le,j.aabb);null!=Be&&(ne=Math.min(Be,ne))}return ne!==Number.MAX_VALUE&&ne}}return!1}_handleOverridablePaintPropertyUpdate(a,s,d){return!(!this.layout||s.isDataDriven()||d.isDataDriven()||"model-color"!==a&&"model-color-mix-intensity"!==a&&"model-rotation"!==a&&"model-scale"!==a&&"model-translation"!==a&&"model-emissive-strength"!==a)}_isPropertyZoomDependent(a){const s=this._transitionablePaint._values[a];return null!=s&&null!=s.value&&null!=s.value.expression&&s.value.expression instanceof ao}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(a,s,d,f){const v=a.tile,y=v.getBucket(this);let E=null,M=Number.MAX_VALUE;if(!(y&&y instanceof hu))return{queryFeature:E,intersectionZ:M};const k=y.getNodesInfo()[s];if(k.hiddenByReplacement||!k.node.meshes||!d.filter(new qr(v.tileID.overscaledZ),k.feature,v.tileID.canonical))return{queryFeature:E,intersectionZ:M};const R=k.node,L=f.calculatePosMatrix(v.tileID.toUnwrapped(),f.worldSize),V=k.evaluatedScale;let j=0;f.elevation&&R.elevation&&(j=R.elevation*f.elevation.exaggeration()),_.a6.translate(L,L,[(R.anchor?R.anchor[0]:0)*(V[0]-1),(R.anchor?R.anchor[1]:0)*(V[1]-1),j]),_.a6.scale(L,L,V),_.a6.multiply(L,L,R.matrix);const q=a.queryGeometry,Z=q.isPointQuery()?q.screenBounds:q.screenGeometry,J=function(le){const xe=_.a6.multiply([],L,le.matrix),Ee=_.a6.multiply(xe,f.expandedFarZProjMatrix,xe);for(let Te=0;Te<le.meshes.length;++Te){const Le=le.meshes[Te];if(Te===le.lightMeshIndex)continue;const ke=Xa(Z,f,Ee,Le.aabb);null!=ke&&(M=Math.min(ke,M))}if(le.children)for(const Te of le.children)J(Te)};if(J(R),M===Number.MAX_VALUE)return{queryFeature:E,intersectionZ:M};const ne=new Ze(0,0);return fu(v.tileID.canonical,ne,k.node.anchor[0],k.node.anchor[1]),E={type:"Feature",geometry:{type:"Point",coordinates:[ne.lng,ne.lat]},properties:k.feature.properties,id:k.feature.id,state:{},layer:this.serialize()},{queryFeature:E,intersectionZ:M}}}},Bn={read:function(a,s){return a.readFields(Bn._readField,{header_length:0,x:0,y:0,z:0,layers:[]},s)},_readField:function(a,s,d){1===a?s.header_length=d.readFixed32():2===a?s.x=d.readVarint():3===a?s.y=d.readVarint():4===a?s.z=d.readVarint():5===a&&s.layers.push(Bn.Layer.read(d,d.readVarint()+d.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};Bn.Filter.read=function(a,s){return a.readFields(Bn.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},s)},Bn.Filter._readField=function(a,s,d){1===a?(s.delta_filter=Bn.Filter.Delta.read(d,d.readVarint()+d.pos),s.filter="delta_filter"):2===a?(s.zigzag_filter=Bn.Filter.Zigzag.read(d,d.readVarint()+d.pos),s.filter="zigzag_filter"):3===a?(s.bitshuffle_filter=Bn.Filter.BitShuffle.read(d,d.readVarint()+d.pos),s.filter="bitshuffle_filter"):4===a&&(s.byteshuffle_filter=Bn.Filter.ByteShuffle.read(d,d.readVarint()+d.pos),s.filter="byteshuffle_filter")},Bn.Filter.Delta={},Bn.Filter.Delta.read=function(a,s){return a.readFields(Bn.Filter.Delta._readField,{block_size:0},s)},Bn.Filter.Delta._readField=function(a,s,d){1===a&&(s.block_size=d.readVarint())},Bn.Filter.Zigzag={},Bn.Filter.Zigzag.read=function(a,s){return a.readFields(Bn.Filter.Zigzag._readField,{},s)},Bn.Filter.Zigzag._readField=function(a,s,d){},Bn.Filter.BitShuffle={},Bn.Filter.BitShuffle.read=function(a,s){return a.readFields(Bn.Filter.BitShuffle._readField,{},s)},Bn.Filter.BitShuffle._readField=function(a,s,d){},Bn.Filter.ByteShuffle={},Bn.Filter.ByteShuffle.read=function(a,s){return a.readFields(Bn.Filter.ByteShuffle._readField,{},s)},Bn.Filter.ByteShuffle._readField=function(a,s,d){},Bn.Codec={},Bn.Codec.read=function(a,s){return a.readFields(Bn.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},s)},Bn.Codec._readField=function(a,s,d){1===a?(s.gzip_data=Bn.Codec.GzipData.read(d,d.readVarint()+d.pos),s.codec="gzip_data"):2===a?(s.jpeg_image=Bn.Codec.JpegImage.read(d,d.readVarint()+d.pos),s.codec="jpeg_image"):3===a?(s.webp_image=Bn.Codec.WebpImage.read(d,d.readVarint()+d.pos),s.codec="webp_image"):4===a&&(s.png_image=Bn.Codec.PngImage.read(d,d.readVarint()+d.pos),s.codec="png_image")},Bn.Codec.GzipData={},Bn.Codec.GzipData.read=function(a,s){return a.readFields(Bn.Codec.GzipData._readField,{},s)},Bn.Codec.GzipData._readField=function(a,s,d){},Bn.Codec.JpegImage={},Bn.Codec.JpegImage.read=function(a,s){return a.readFields(Bn.Codec.JpegImage._readField,{},s)},Bn.Codec.JpegImage._readField=function(a,s,d){},Bn.Codec.WebpImage={},Bn.Codec.WebpImage.read=function(a,s){return a.readFields(Bn.Codec.WebpImage._readField,{},s)},Bn.Codec.WebpImage._readField=function(a,s,d){},Bn.Codec.PngImage={},Bn.Codec.PngImage.read=function(a,s){return a.readFields(Bn.Codec.PngImage._readField,{},s)},Bn.Codec.PngImage._readField=function(a,s,d){},Bn.DataIndexEntry={},Bn.DataIndexEntry.read=function(a,s){return a.readFields(Bn.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},s)},Bn.DataIndexEntry._readField=function(a,s,d){1===a?s.first_byte=d.readFixed64():2===a?s.last_byte=d.readFixed64():3===a?s.filters.push(Bn.Filter.read(d,d.readVarint()+d.pos)):4===a?s.codec=Bn.Codec.read(d,d.readVarint()+d.pos):5===a?s.offset=d.readFloat():6===a?s.scale=d.readFloat():7===a&&s.bands.push(d.readString())},Bn.Layer={},Bn.Layer.read=function(a,s){return a.readFields(Bn.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},s)},Bn.Layer._readField=function(a,s,d){1===a?s.version=d.readVarint():2===a?s.name=d.readString():3===a?s.units=d.readString():4===a?s.tilesize=d.readVarint():5===a?s.buffer=d.readVarint():6===a?s.pixel_format=d.readVarint():7===a&&s.data_index.push(Bn.DataIndexEntry.read(d,d.readVarint()+d.pos))};const Rd={read:function(a,s){return a.readFields(Rd._readField,{uint32_values:null,values:null,fixed32_values:null},s)},_readField:function(a,s,d){2===a?(s.uint32_values=Rd.Uint32Values.read(d,d.readVarint()+d.pos),s.values="uint32_values"):3===a&&(s.fixed32_values=Rd.Fixed32Values.read(d,d.readVarint()+d.pos),s.values="fixed32_values")},Uint32Values:{}};Rd.Uint32Values.read=function(a,s){return a.readFields(Rd.Uint32Values._readField,{values:[]},s)},Rd.Uint32Values._readField=function(a,s,d){1===a&&(s.readValuesInto=function(f){if(2!==f.type)throw new Error(`Unsupported pbf type "${f.type}"`);const v=2===(E=f).type?E.readVarint()+E.pos:E.pos+1,y=f.pos;var E;return f.pos=v,function(E){f.pos=y;let M=0;for(;f.pos<v;){const k=f.readVarint();E[M++]=k}return E}}(d))},Rd.Fixed32Values={},Rd.Fixed32Values.read=function(a,s){return a.readFields(Rd.Fixed32Values._readField,{values:[]},s)},Rd.Fixed32Values._readField=function(a,s,d){throw new Error("Not implemented")};class Cm{constructor(s=0,d=0,f=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=s,this.resetTtl=f,this.size=0,this.ttl=d}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(s){if(this.has(s)){const d=this.items[s];delete this.items[s],this.size--,null!==d.prev&&(d.prev.next=d.next),null!==d.next&&(d.next.prev=d.prev),this.first===d&&(this.first=d.next),this.last===d&&(this.last=d.prev)}return this}entries(s=this.keys()){return s.map(d=>[d,this.get(d)])}evict(s=!1){if(s||this.size>0){const d=this.first;delete this.items[d.key],0==--this.size?(this.first=null,this.last=null):(this.first=d.next,this.first.prev=null)}return this}expiresAt(s){let d;return this.has(s)&&(d=this.items[s].expiry),d}get(s){let d;if(this.has(s)){const f=this.items[s];this.ttl>0&&f.expiry<=Date.now()?this.delete(s):(d=f.value,this.set(s,d,!0))}return d}has(s){return s in this.items}keys(){const s=[];let d=this.first;for(;null!==d;)s.push(d.key),d=d.next;return s}set(s,d,f=!1,v=this.resetTtl){let y;if(f||this.has(s)){if(y=this.items[s],y.value=d,!1===f&&v&&(y.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==y){const E=this.last,M=y.next,k=y.prev;this.first===y&&(this.first=y.next),y.next=null,y.prev=this.last,E.next=y,null!==k&&(k.next=M),null!==M&&(M.prev=k)}}else this.max>0&&this.size===this.max&&this.evict(!0),y=this.items[s]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:s,prev:this.last,next:null,value:d},1==++this.size?this.first=y:this.last.next=y;return this.last=y,this}values(s=this.keys()){return s.map(d=>this.get(d))}}function Em(a,s){if(4!==s.length)throw new Error(`Expected data of dimension 4 but got ${s.length}.`);let d=s[3];for(let f=2;f>=1;f--){const v=1===f?1:0,y=2===f?1:0;for(let E=0;E<s[0];E++){const M=s[1]*E;for(let k=v;k<s[1];k++){const R=s[2]*(k+M);for(let L=y;L<s[2];L++){const V=s[3]*(L+R);for(let j=0;j<s[3];j++){const q=V+j;a[q]+=a[q-d]}}}}d*=s[f]}return a}function ZM(a){for(let s=0,d=a.length;s<d;s++)a[s]=a[s]>>>1^-(1&a[s]);return a}function KM(a,s){switch(s){case"uint32":return a;case"uint16":for(let d=0;d<a.length;d+=2){const f=a[d],v=a[d+1];a[d]=(240&f)>>4|(61440&f)>>8|(240&v)<<4|61440&v,a[d+1]=15&f|(3840&f)>>4|(15&v)<<8|(3840&v)<<4}return a;case"uint8":for(let d=0;d<a.length;d+=4){const f=a[d],v=a[d+1],y=a[d+2],E=a[d+3];a[d+0]=(192&f)>>6|(192&v)>>4|(192&y)>>2|192&E,a[d+1]=(48&f)>>4|(48&v)>>2|48&y|(48&E)<<2,a[d+2]=(12&f)>>2|12&v|(12&y)<<2|(12&E)<<4,a[d+3]=3&f|(3&v)<<2|(3&y)<<4|(3&E)<<6}return a;default:throw new Error(`Invalid pixel format, "${s}"`)}}class $h extends Error{constructor(s){super(s),this.name="MRTError"}}var tc=Uint8Array,y_=Uint16Array,h0=Int32Array,NE=new tc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f0=new tc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),m0=new tc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),BE=function(a,s){for(var d=new y_(31),f=0;f<31;++f)d[f]=s+=1<<a[f-1];var v=new h0(d[30]);for(f=1;f<30;++f)for(var y=d[f];y<d[f+1];++y)v[y]=y-d[f]<<5|f;return{b:d,r:v}},Yw=BE(NE,2),Wp=Yw.b,VE=Yw.r;Wp[28]=258,VE[258]=28;for(var zE=BE(f0,0).b,Wh=new y_(32768),es=0;es<32768;++es){var Xh=(43690&es)>>1|(21845&es)<<1;Wh[es]=((65280&(Xh=(61680&(Xh=(52428&Xh)>>2|(13107&Xh)<<2))>>4|(3855&Xh)<<4))>>8|(255&Xh)<<8)>>1}var ab=function(a,s,d){for(var f=a.length,v=0,y=new y_(s);v<f;++v)a[v]&&++y[a[v]-1];var E,M=new y_(s);for(v=1;v<s;++v)M[v]=M[v-1]+y[v-1]<<1;if(d){E=new y_(1<<s);var k=15-s;for(v=0;v<f;++v)if(a[v])for(var R=v<<4|a[v],L=s-a[v],V=M[a[v]-1]++<<L,j=V|(1<<L)-1;V<=j;++V)E[Wh[V]>>k]=R}else for(E=new y_(f),v=0;v<f;++v)a[v]&&(E[v]=Wh[M[a[v]-1]++]>>15-a[v]);return E},lb=new tc(288);for(es=0;es<144;++es)lb[es]=8;for(es=144;es<256;++es)lb[es]=9;for(es=256;es<280;++es)lb[es]=7;for(es=280;es<288;++es)lb[es]=8;var QM=new tc(32);for(es=0;es<32;++es)QM[es]=5;var JM=ab(lb,9,1),SI=ab(QM,5,1),Zw=function(a){for(var s=a[0],d=1;d<a.length;++d)a[d]>s&&(s=a[d]);return s},qh=function(a,s,d){var f=s/8|0;return(a[f]|a[f+1]<<8)>>(7&s)&d},Kw=function(a,s){var d=s/8|0;return(a[d]|a[d+1]<<8|a[d+2]<<16)>>(7&s)},cb=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Tc=function(a,s,d){var f=new Error(s||cb[a]);if(f.code=a,Error.captureStackTrace&&Error.captureStackTrace(f,Tc),!d)throw f;return f},eA=new tc(0),MI=typeof TextDecoder<"u"&&new TextDecoder;try{MI.decode(eA,{stream:!0})}catch{}const tA={gzip_data:"gzip"},AI={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Qw={uint32:1,uint16:2,uint8:4},hl={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class Jw{constructor(s=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=s}getLayer(s){return this.layers[s]}getHeaderLength(s){const d=new Uint8Array(s),f=new DataView(s);if(13!==d[0])throw new $h("File is not a valid MRT.");return f.getUint32(1,!0)}parseHeader(s){const d=new Uint8Array(s),f=this.getHeaderLength(s);if(d.length<f)throw new $h(`Expected header with length >= ${f} but got buffer of length ${d.length}`);const v=new ru(d.subarray(0,f)),y=Bn.read(v);if(!isNaN(this.x)&&(this.x!==y.x||this.y!==y.y||this.z!==y.z))throw new $h(`Invalid attempt to parse header ${y.z}/${y.x}/${y.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=y.x,this.y=y.y,this.z=y.z;for(const E of y.layers)this.layers[E.name]=new e1(E,{cacheSize:this._cacheSize});return this}createDecodingTask(s){const d=[],f=this.getLayer(s.layerName);for(let v=0;v<f.dataIndex.length;v++){const y=f.dataIndex[v],E=y.first_byte-s.firstByte,M=y.last_byte+1-s.firstByte;if(v<s.firstBlock||v>s.lastBlock||f._blocksInProgress.has(v))continue;const k={layerName:f.name,firstByte:E,lastByte:M,pixelFormat:f.pixelFormat,blockIndex:v,blockShape:[y.bands.length].concat(f.bandShape),buffer:f.buffer,codec:y.codec.codec,filters:y.filters.map(R=>R.filter)};f._blocksInProgress.add(v),d.push(k)}return new t1(d,()=>{d.forEach(v=>f._blocksInProgress.delete(v.blockIndex))},(v,y)=>{if(d.forEach(E=>f._blocksInProgress.delete(E.blockIndex)),v)throw v;y.forEach(E=>{this.getLayer(E.layerName).processDecodedData(E)})})}}class e1{constructor({version:s,name:d,units:f,tilesize:v,pixel_format:y,buffer:E,data_index:M},k){if(this.version=s,1!==this.version)throw new $h(`Cannot parse raster layer encoded with MRT version ${s}`);this.name=d,this.units=f,this.tileSize=v,this.buffer=E,this.pixelFormat=AI[y],this.dataIndex=M,this.bandShape=[v+2*E,v+2*E,Qw[this.pixelFormat]],this._decodedBlocks=function(R=1e3,L=0,V=!1){if(isNaN(R)||R<0)throw new TypeError("Invalid max value");if(isNaN(L)||L<0)throw new TypeError("Invalid ttl value");if("boolean"!=typeof V)throw new TypeError("Invalid resetTtl value");return new Cm(R,L,V)}(k?k.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(s){const d=s.blockIndex.toString();this._decodedBlocks.get(d)||this._decodedBlocks.set(d,s.data)}getBlockForBand(s){let d=0;switch(typeof s){case"string":for(const[f,v]of this.dataIndex.entries()){for(const[y,E]of v.bands.entries())if(E===s)return{bandIndex:d+y,blockIndex:f,blockBandIndex:y};d+=v.bands.length}break;case"number":for(const[f,v]of this.dataIndex.entries()){if(s>=d&&s<d+v.bands.length)return{bandIndex:s,blockIndex:f,blockBandIndex:s-d};d+=v.bands.length}break;default:throw new $h(`Invalid band \`${JSON.stringify(s)}\`. Expected string or integer.`)}throw new $h(`Band not found: ${JSON.stringify(s)}`)}getDataRange(s){let d=1/0,f=-1/0,v=1/0,y=-1/0;for(const E of s){const{blockIndex:M}=this.getBlockForBand(E);if(M<0)throw new $h(`Invalid band: ${JSON.stringify(E)}`);const k=this.dataIndex[M];v=Math.min(v,M),y=Math.max(y,M),d=Math.min(d,k.first_byte),f=Math.max(f,k.last_byte)}return{layerName:this.name,firstByte:d,lastByte:f,firstBlock:v,lastBlock:y}}hasBand(s){const{blockIndex:d}=this.getBlockForBand(s);return d>=0}hasDataForBand(s){const{blockIndex:d}=this.getBlockForBand(s);return d>=0&&!!this._decodedBlocks.get(d.toString())}getBandView(s){const{blockIndex:d,blockBandIndex:f}=this.getBlockForBand(s),v=this._decodedBlocks.get(d.toString());if(!v)throw new $h(`Data for band ${JSON.stringify(s)} of layer "${this.name}" not decoded.`);const y=this.dataIndex[d],E=this.bandShape.reduce((R,L)=>R*L,1),M=f*E,k=v.subarray(M,M+E);return{data:k,bytes:new Uint8Array(k.buffer).subarray(k.byteOffset,k.byteOffset+k.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:y.offset,scale:y.scale}}}class t1{constructor(s,d,f){this.tasks=s,this._onCancel=d,this._onComplete=f,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(s,d){this._finalized||(this._onComplete(s,d),this._finalized=!0)}}Jw.performDecoding=function(a,s){return Promise.all(s.tasks.map(d=>{const{layerName:f,firstByte:v,lastByte:y,pixelFormat:E,blockShape:M,blockIndex:k,filters:R,codec:L}=d,V=new Uint8Array(a).subarray(v,y+1),j=new Uint32Array(M[0]*M[1]*M[2]);let q;if("gzip_data"!==L)throw new Error(`Unhandled codec: ${L}`);return q=function(Z,J){if(!globalThis.DecompressionStream&&"gzip_data"===J)return Promise.resolve(((Ee=function(ke){31==ke[0]&&139==ke[1]&&8==ke[2]||Tc(6,"invalid gzip data");var Be=ke[3],We=10;4&Be&&(We+=2+(ke[10]|ke[11]<<8));for(var tt=(Be>>3&1)+(Be>>4&1);tt>0;tt-=!ke[We++]);return We+(2&Be)}(xe=Z))+8>xe.length&&Tc(6,"invalid gzip data"),function(ke,Be,We){var ct=ke.length;if(!ct||Be.f&&!Be.l)return We||new tc(0);var it=!We,xt=it||2!=Be.i,Rt=Be.i;it&&(We=new tc(3*ct));var wa,fl,Pd,_t=function(wa){var fl=We.length;if(wa>fl){var Pd=new tc(Math.max(2*fl,wa));Pd.set(We),We=Pd}},At=Be.f||0,ft=Be.p||0,Dt=Be.b||0,ii=Be.l,Lt=Be.d,Ui=Be.m,Ti=Be.n,Ut=8*ct;do{if(!ii){At=qh(ke,ft,1);var on=qh(ke,ft+1,3);if(ft+=3,!on){var Gi=ke[(Fr=4+((ft+7)/8|0))-4]|ke[Fr-3]<<8,Bi=Fr+Gi;if(Bi>ct){Rt&&Tc(0);break}xt&&_t(Dt+Gi),We.set(ke.subarray(Fr,Bi),Dt),Be.b=Dt+=Gi,Be.p=ft=8*Bi,Be.f=At;continue}if(1==on)ii=JM,Lt=SI,Ui=9,Ti=5;else if(2==on){var Gt=qh(ke,ft,31)+257,Qi=qh(ke,ft+10,15)+4,Hn=Gt+qh(ke,ft+5,31)+1;ft+=14;for(var hn=new tc(Hn),Yn=new tc(19),In=0;In<Qi;++In)Yn[m0[In]]=qh(ke,ft+3*In,7);ft+=3*Qi;var xr=Zw(Yn),Rn=(1<<xr)-1,po=ab(Yn,xr,1);for(In=0;In<Hn;){var Fr,Mr=po[qh(ke,ft,Rn)];if(ft+=15&Mr,(Fr=Mr>>4)<16)hn[In++]=Fr;else{var Er=0,Gr=0;for(16==Fr?(Gr=3+qh(ke,ft,3),ft+=2,Er=hn[In-1]):17==Fr?(Gr=3+qh(ke,ft,7),ft+=3):18==Fr&&(Gr=11+qh(ke,ft,127),ft+=7);Gr--;)hn[In++]=Er}}var Mo=hn.subarray(0,Gt),Jr=hn.subarray(Gt);Ui=Zw(Mo),Ti=Zw(Jr),ii=ab(Mo,Ui,1),Lt=ab(Jr,Ti,1)}else Tc(1);if(ft>Ut){Rt&&Tc(0);break}}xt&&_t(Dt+131072);for(var ms=(1<<Ui)-1,Is=(1<<Ti)-1,aa=ft;;aa=ft){var Uo=(Er=ii[Kw(ke,ft)&ms])>>4;if((ft+=15&Er)>Ut){Rt&&Tc(0);break}if(Er||Tc(2),Uo<256)We[Dt++]=Uo;else{if(256==Uo){aa=ft,ii=null;break}var ts=Uo-254;Uo>264&&(ts=qh(ke,ft,(1<<(ga=NE[In=Uo-257]))-1)+Wp[In],ft+=ga);var ma=Lt[Kw(ke,ft)&Is],pa=ma>>4;if(ma||Tc(3),ft+=15&ma,Jr=zE[pa],pa>3){var ga=f0[pa];Jr+=Kw(ke,ft)&(1<<ga)-1,ft+=ga}if(ft>Ut){Rt&&Tc(0);break}xt&&_t(Dt+131072);var Co=Dt+ts;if(Dt<Jr){var ic=0-Jr,Yh=Math.min(Jr,Co);for(ic+Dt<0&&Tc(3);Dt<Yh;++Dt)We[Dt]=undefined[ic+Dt]}for(;Dt<Co;++Dt)We[Dt]=We[Dt-Jr]}}Be.l=ii,Be.p=aa,Be.b=Dt,Be.f=At,ii&&(At=1,Be.m=Ui,Be.d=Lt,Be.n=Ti)}while(!At);return Dt!=We.length&&it?(wa=We,(null==(fl=0)||fl<0)&&(fl=0),(null==(Pd=Dt)||Pd>wa.length)&&(Pd=wa.length),new tc(wa.subarray(fl,Pd))):We.subarray(0,Dt)}(xe.subarray(Ee,-8),{i:2},new tc(((ne=xe)[(le=ne.length)-4]|ne[le-3]<<8|ne[le-2]<<16|ne[le-1]<<24)>>>0))));var ne,le,xe,Ee;const Te=tA[J];if(!Te)throw new Error(`Unhandled codec: ${J}`);const Le=new globalThis.DecompressionStream(Te);return new Response(new Blob([Z]).stream().pipeThrough(Le)).arrayBuffer().then(ke=>new Uint8Array(ke))}(V,L).then(Z=>{const J=Rd.read(new ru(Z));if("uint32_values"===J.values)return J.uint32_values.readValuesInto(j),new hl[E](j.buffer);throw new Error(`Unhandled numeric data "${J.values}"`)}),q.then(Z=>{for(let J=R.length-1;J>=0;J--)switch(R[J]){case"delta_filter":Em(Z,M);break;case"zigzag_filter":ZM(Z);break;case"bitshuffle_filter":KM(Z,E);break;default:throw new Error(`Unhandled filter "${R[J]}"`)}return{layerName:f,blockIndex:k,data:Z}}).catch(Z=>{throw Z})}))},Oi(t1,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const UE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class fs{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[d,f]=new Uint8Array(s,0,2);if(219!==d)throw new Error("Data does not appear to be in a KDBush format.");const v=f>>4;if(1!==v)throw new Error(`Got v${v} data when expected v1.`);const y=UE[15&f];if(!y)throw new Error("Unrecognized array type.");const[E]=new Uint16Array(s,2,1),[M]=new Uint32Array(s,4,1);return new fs(M,E,y,s)}constructor(s,d=64,f=Float64Array,v){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+d,2),65535),this.ArrayType=f,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const y=UE.indexOf(this.ArrayType),E=2*s*this.ArrayType.BYTES_PER_ELEMENT,M=s*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-M%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${f}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+M+k,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+E+M+k),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+M+k,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=d,new Uint32Array(this.data,4,1)[0]=s)}add(s,d){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=s,this.coords[this._pos++]=d,f}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return n1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,d,f,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:E,nodeSize:M}=this,k=[0,y.length-1,0],R=[];for(;k.length;){const L=k.pop()||0,V=k.pop()||0,j=k.pop()||0;if(V-j<=M){for(let ne=j;ne<=V;ne++){const le=E[2*ne],xe=E[2*ne+1];le>=s&&le<=f&&xe>=d&&xe<=v&&R.push(y[ne])}continue}const q=j+V>>1,Z=E[2*q],J=E[2*q+1];Z>=s&&Z<=f&&J>=d&&J<=v&&R.push(y[q]),(0===L?s<=Z:d<=J)&&(k.push(j),k.push(q-1),k.push(1-L)),(0===L?f>=Z:v>=J)&&(k.push(q+1),k.push(V),k.push(1-L))}return R}within(s,d,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:y,nodeSize:E}=this,M=[0,v.length-1,0],k=[],R=f*f;for(;M.length;){const L=M.pop()||0,V=M.pop()||0,j=M.pop()||0;if(V-j<=E){for(let ne=j;ne<=V;ne++)rh(y[2*ne],y[2*ne+1],s,d)<=R&&k.push(v[ne]);continue}const q=j+V>>1,Z=y[2*q],J=y[2*q+1];rh(Z,J,s,d)<=R&&k.push(v[q]),(0===L?s-f<=Z:d-f<=J)&&(M.push(j),M.push(q-1),M.push(1-L)),(0===L?s+f>=Z:d+f>=J)&&(M.push(q+1),M.push(V),M.push(1-L))}return k}}function n1(a,s,d,f,v,y){if(v-f<=d)return;const E=f+v>>1;p0(a,s,E,f,v,y),n1(a,s,d,f,E-1,1-y),n1(a,s,d,E+1,v,1-y)}function p0(a,s,d,f,v,y){for(;v>f;){if(v-f>600){const R=v-f+1,L=d-f+1,V=Math.log(R),j=.5*Math.exp(2*V/3),q=.5*Math.sqrt(V*j*(R-j)/R)*(L-R/2<0?-1:1);p0(a,s,d,Math.max(f,Math.floor(d-L*j/R+q)),Math.min(v,Math.floor(d+(R-L)*j/R+q)),y)}const E=s[2*d+y];let M=f,k=v;for(g0(a,s,f,d),s[2*v+y]>E&&g0(a,s,f,v);M<k;){for(g0(a,s,M,k),M++,k--;s[2*M+y]<E;)M++;for(;s[2*k+y]>E;)k--}s[2*f+y]===E?g0(a,s,f,k):(k++,g0(a,s,k,v)),k<=d&&(f=k+1),d<=k&&(v=k-1)}}function g0(a,s,d,f){nh(a,d,f),nh(s,2*d,2*f),nh(s,2*d+1,2*f+1)}function nh(a,s,d){const f=a[s];a[s]=a[d],a[d]=f}function rh(a,s,d,f){const v=a-d,y=s-f;return v*v+y*y}_.$=pE,_.A=el,_.B=Jb,_.C=Kn,_.D=ot,_.E=Ea,_.F=$o,_.G=ni,_.H=class{constructor(a){this.specification=a}possiblyEvaluate(a,s){return kt(a.expression.evaluate(s))}interpolate(a,s,d){return{x:rr(a.x,s.x,d),y:rr(a.y,s.y,d),z:rr(a.z,s.z,d),azimuthal:rr(a.azimuthal,s.azimuthal,d),polar:rr(a.polar,s.polar,d)}}},_.I=fm,_.J=gc,_.K=qr,_.L=Sr,_.M=class{constructor(a,s,d,f){this.id=a,this.position=null!=s?new Ze(s[0],s[1]):new Ze(0,0),this.orientation=d??[0,0,0],this.nodes=f,this.uploaded=!1,this.aabb=new ss([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(a,s){if(_.a6.multiply(a.matrix,s,a.matrix),a.meshes)for(const d of a.meshes){const f=ss.applyTransform(d.aabb,a.matrix);this.aabb.encapsulate(f)}if(a.children)for(const d of a.children)this._applyTransformations(d,a.matrix)}computeBoundsAndApplyParent(){const a=_.a6.identity([]);for(const s of this.nodes)this._applyTransformations(s,a)}computeModelMatrix(a,s,d,f,v,y,E=!1){cl(this.matrix,this,a.transform,this.position,s,d,f,v,y,E)}upload(a){if(!this.uploaded){for(const s of this.nodes)ME(s,a);for(const s of this.nodes)tb(s);this.uploaded=!0}}destroy(){for(const a of this.nodes)zw(a)}},_.O=an,_.P=mt,_.Q=Ff,_.R=ca,_.S=Ih,_.T=l_,_.U=rr,_.V=Nt,_.W=id,_.X=class{constructor(a){this.specification=a}possiblyEvaluate(a,s){return function([d,f]){const v=kt([1,d,f]);return{x:v.x,y:v.y,z:v.z}}(a.expression.evaluate(s))}interpolate(a,s,d){return{x:rr(a.x,s.x,d),y:rr(a.y,s.y,d),z:rr(a.z,s.z,d)}}},_.Y=function(a,s,d=0,f=!0){const v=new mt(d,d),y=a.sub(v),E=s.add(v),M=[y,new mt(E.x,y.y),E,new mt(y.x,E.y)];return f&&M.push(y.clone()),M},_.Z=ao,_._=function(a,s){const d=[];for(let f=0;f<a.length;f++){const v=Vr(f-1,-1,a.length-1),y=Vr(f+1,-1,a.length-1),E=a[f],M=a[y],k=a[v].sub(E).unit(),R=M.sub(E).unit(),L=R.angleWithSep(k.x,k.y),V=k.add(R).unit().mult(-1*s/Math.sin(L/2));d.push(E.add(V))}return d},_.a=xi,_.a$=function(a){const s=[];for(const d in a)s.push(a[d]);return s},_.a0=Fx,_.a1=function(a,s,d=0){return _.N.fromValues(((s.x-d)*a.scale-a.x)*Nt,(s.y*a.scale-a.y)*Nt,jr(s.z,s.y))},_.a2=bv,_.a3=xM,_.a4=function(a){let s=1/0,d=1/0,f=-1/0,v=-1/0;for(const y of a)s=Math.min(s,y.x),d=Math.min(d,y.y),f=Math.max(f,y.x),v=Math.max(v,y.y);return{min:new mt(s,d),max:new mt(f,v)}},_.a5=Sn,_.a8=ju,_.a9=Yr,_.aA=Af,_.aB=Wo,_.aC=va,_.aD=Bu,_.aE=e0,_.aF=function(){na.isLoading()||na.isLoaded()||"deferred"!==ps()||ya()},_.aG=Fs,_.aH=ks,_.aI=__,_.aJ=Bt,_.aK=rE,_.aL=Ug,_.aM=Ks,_.aN=dn,_.aO=xs,_.aP=sw,_.aQ=Oy,_.aR=n0,_.aS=function(a,s){const d=Ih(s.zoom);if(0===d)return xd(a);const f=xv(a),v=wy(f),y=Sn(f.getWest())*s.worldSize,E=Sn(f.getEast())*s.worldSize,M=bn(f.getNorth())*s.worldSize,k=bn(f.getSouth())*s.worldSize,R=[y,M,0],L=[E,M,0],V=[y,k,0],j=[E,k,0],q=_.a6.invert([],s.globeMatrix);return _.N.transformMat4(R,R,q),_.N.transformMat4(L,L,q),_.N.transformMat4(V,V,q),_.N.transformMat4(j,j,q),v[0]=wd(v[0],V,d),v[1]=wd(v[1],j,d),v[2]=wd(v[2],L,d),v[3]=wd(v[3],R,d),ss.fromPoints(v)},_.aT=Cy,_.aU=wv,_.aV=wd,_.aW=il,_.aX=yy,_.aY=Eo,_.aZ=Jw,_.a_=wt,_.aa=Ii,_.ab=we,_.ac=function(a,s){const d={};for(let f=0;f<s.length;f++){const v=s[f];v in a&&(d[v]=a[v])}return d},_.ad=ht,_.ae=bn,_.af=class{constructor(a){this.entries={},this.scheduler=a}request(a,s,d,f){const v=this.entries[a]=this.entries[a]||{callbacks:[]};if(v.result){const[y,E]=v.result;return this.scheduler?this.scheduler.add(()=>{f(y,E)},s):f(y,E),()=>{}}return v.callbacks.push(f),v.cancel||(v.cancel=d((y,E)=>{v.result=[y,E];for(const M of v.callbacks)this.scheduler?this.scheduler.add(()=>{M(y,E)},s):M(y,E);setTimeout(()=>delete this.entries[a],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(y=>y!==f),v.callbacks.length||(v.cancel(),delete this.entries[a]))}}},_.ag=xa,_.ah=function(a,s,d){const f=JSON.stringify(a.request);return a.data&&(this.deduped.entries[f]={result:[null,a.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},v=>{const y=wt(a.request,(E,M,k,R)=>{E?v(E):M&&v(null,{vectorTile:d?void 0:new bw(new ru(M)),rawData:M,cacheControl:k,expires:R})});return()=>{y.cancel(),v()}},s)},_.ai=function(a){Tr++,Tr>Ni&&(a.getActor().send("enforceCacheSizeLimit",gt),Tr=0)},_.aj=ho,_.ak=bt,_.al=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},_.am=Wt,_.an=vm,_.ao=Fp,_.ap=o0,_.aq=function(a,s){const d=document.createElement("video");d.muted=!0,d.onloadstart=function(){s(null,d)};for(let f=0;f<a.length;f++){const v=document.createElement("source");Vt(a[f])||(d.crossOrigin="Anonymous"),v.src=a[f],d.appendChild(v)}return{cancel:()=>{}}},_.ar=c_,_.as=o_,_.at=Dn,_.au=fr,_.av=Hc,_.aw=ln,_.ax=Vo,_.ay=Ir,_.az=Ha,_.b=Ps,_.b$=ny,_.b0=function(a,s){const d=[];for(const f in a)f in s||d.push(f);return d},_.b1=uo,_.b2=["type","source","source-layer","minzoom","maxzoom","filter","layout"],_.b3=function(a,s){const{x:d,y:f}=a.point,v=Ey(d,f,a.worldSize/a._pixelsPerMercatorPixel,0,0);return _.a6.multiply(v,v,lw(xd(s)))},_.b5=jy,_.b6=Jl,_.b7=aE,_.b8=function(a,s,d,f,v){const y=5*s+2;a.float32[y+0]=d,a.float32[y+1]=f,a.float32[y+2]=v},_.b9=s_,_.bA=Nw,_.bB=UM,_.bC=function(a){const s=UM(a,!0);return _.b4.invert([],[s[0],s[1],s[4],s[5]])},_.bD=yp,_.bE=function(a){const{x:s,y:d}=a.point,{lng:f,lat:v}=a._center;return Ey(s,d,a.worldSize,f,v)},_.bF=Mn,_.bG=Se,_.bH=function(a){const s=Math.round((a+45+360)%360/90)%4;return vn[s]},_.bI=45,_.bJ=Xi,_.bK=w,_.bL=Wf,_.bM=gC,_.bN=Al,_.bO=$f,_.bP=x,_.bQ=function(a,s,d){const f=Math.sqrt(a*a+s*s+d*d),v=f>0?Math.acos(d/f)*en:0;let y=0!==a||0!==s?Math.atan2(-s,-a)*en+90:0;return y<0&&(y+=360),[f,y,v]},_.bR=vr,_.bS=ss,_.bT=kt,_.bU=function(a){return[Math.pow(a[0],1/2.2),Math.pow(a[1],1/2.2),Math.pow(a[2],1/2.2)]},_.bV=function(a){return a({pluginStatus:tl,pluginURL:Ou}),no.on("pluginStateChange",a),a},_.bW=Vp,_.bX=xm,_.bY=Ip,_.bZ=zv,_.b_=Yo,_.ba=Hy,_.bb=vc,_.bc=al,_.bd=fE,_.be=i_,_.bf=Vs,_.bg=fs,_.bh=Vr,_.bj=mi,_.bk=Ce,_.bl=xn,_.bm=function(a,s,d){a[4*s+0]=d[0],a[4*s+1]=d[1],a[4*s+2]=d[2],a[4*s+3]=d[3]},_.bn=Ze,_.bo=qv,_.bp=ti,_.bq=by,_.br=jM,_.bs=Mt,_.bt=xy,_.bu=function(a,s,d,f,v,y,E,M,k){if("globe"===k.name)return xy(a,s,new Mt(d,f,v),!1);const R=o_({z:d,x:f,y:v},k);return new ss([(y+R.x/R.scale)*s,s*(R.y/R.scale),E],[(y+R.x2/R.scale)*s,s*(R.y2/R.scale),M])},_.bv=function(a,s,d){let f=0;for(let v=0;v<2;++v){const y=d?d[v]:0;a[v]>y&&(f+=(a[v]-y)*(a[v]-y)),s[v]<y&&(f+=(y-s[v])*(y-s[v]))}return f},_.bw=Mi,_.bx=pe,_.by=function(a){const s=_.a6.identity(new Float64Array(16));_.a6.multiply(s,a.pixelMatrix,a.globeMatrix);const d=[0,je,0],f=[0,at,0];return _.N.transformMat4(d,d,s),_.N.transformMat4(f,f,s),[d[0]>0&&d[0]<=a.width&&d[1]>0&&d[1]<=a.height&&!Ev(a,new Ze(a.center.lat,90)),f[0]>0&&f[0]<=a.width&&f[1]>0&&f[1]<=a.height&&!Ev(a,new Ze(a.center.lat,-90))]},_.bz=function(a,s){const{scale:d}=a.tileTransform,f=d*Nt/(a.tileSize*Math.pow(2,s.zoom-a.tileID.overscaledZ+a.tileID.canonical.z));return _.b4.scale(new Float32Array(4),s.inverseAdjustmentMatrix,[f,f])},_.c=qM,_.c$=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},_.c0=Kt,_.c1=io,_.c2=function(a,s,d){return"custom"===a.type?new Lw(a,s):new u0[a.type](a,s,d)},_.c3=function(a){const s=a.indexOf("\x1f");return s>=0?a.slice(0,s):a},_.c4=function(a){return a.indexOf("\x1f")>=0},_.c5=function(a){const s=a.indexOf("\x1f");return s>=0?a.slice(s+1):""},_.c6=function(a){const s=[],d=a.id;return void 0===d&&s.push({message:`layers.${d}: missing required property "id"`}),void 0===a.render&&s.push({message:`layers.${d}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&s.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),s},_.c7=la,_.c8=no,_.c9=dt,_.cA=uI,_.cB=(a,s,d,f,v,y)=>{const E=a.transform;return{u_matrix:dI(a,s,d,f),u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(s),u_device_pixel_ratio:v,u_image:0,u_tile_units_to_pixels:oE(s,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:y}},_.cC=(a,s,d,f,v,y,E)=>{const M=a.transform,k=M.calculatePixelsToTileUnitsMatrix(s);return{u_matrix:dI(a,s,d,f),u_pixels_to_tile_units:k,u_device_pixel_ratio:y,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:Fv(d)&&s.lineAtlasTexture?s.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:oE(s,a.transform),u_alpha_discard_threshold:0,u_trim_offset:E,u_emissive_strength:d.paint.get("line-emissive-strength")}},_.cD=ta,_.cE=Sy,_.cF=fM,_.cG=vi,_.cH=Pv,_.cI=Ap,_.cJ=450,_.cK=7,_.cL=VM,_.cM=256,_.cN=lw,_.cO=Ns,_.cP=eu,_.cQ=function(a,s,d,f,v){return Ii((a-s)/(d-s)*(v-f)+f,f,v)},_.cR=ar,_.cS=Bw,_.cT=[1,1,1],_.cU=Rv,_.cV=th,_.cW=$c,_.cX=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(a){const s=sl(new mt(0,0),new mt(Nt,Nt),a),d=[];for(const f of this._activeRegions){if(f.hiddenByOverlap||!Fh(s,f))continue;const v=Tp(f.min,f.max,a);d.push({min:v.min,max:v.max,sourceId:this._sourceIds[f.priority],footprint:f.footprint,footprintTileId:f.tileId})}return d}setSources(a){this._setSources(a.map(s=>({getSourceId:()=>s.cache.id,getFootprints:()=>{const d=[];for(const f of s.cache.getVisibleCoordinates()){const v=s.cache.getTile(f).buckets[s.layer];if(v)for(const y of v.getNodesInfo()){const E=y.node;E.footprint&&d.push({footprint:E.footprint,id:f.toUnwrapped()})}}return d}})))}_addSource(a){const s=a.getFootprints();if(0!==s.length){for(const d of s){if(!d.footprint)continue;const f=sl(d.footprint.min,d.footprint.max,d.id);this._activeRegions.push({min:f.min,max:f.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:d.id,footprint:d.footprint})}this._sourceIds.push(a.getSourceId())}}_computeReplacement(){this._activeRegions.sort((s,d)=>s.priority-d.priority||lm(s.min,d.min)||lm(s.max,d.max));let a=this._activeRegions.length!==this._prevRegions.length;if(!a){let s=0,d=0;for(;!a&&s!==this._activeRegions.length;){const f=this._activeRegions[s],v=this._prevRegions[d];a=f.priority!==v.priority||!sM(f,v),++s,++d}}if(a){++this._updateTime;const s=d=>{const f=this._activeRegions;if(d>=f.length)return d;const v=f[d].priority;for(;d<f.length&&f[d].priority===v;)++d;return d};if(this._sourceIds.length>1){let d=0,f=s(d);for(;d!==f;){let v=d;const y=d;for(;v!==f;){const E=this._activeRegions[v];E.hiddenByOverlap=!1;for(let M=0;M<y;M++){const k=this._activeRegions[M];if(!k.hiddenByOverlap&&Fh(E,k)&&(E.hiddenByOverlap=$g(E.footprint,E.tileId,k.footprint,k.tileId),E.hiddenByOverlap))break}++v}d=f,f=s(d)}}}}_setSources(a){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let s=a.length-1;s>=0;s--)this._addSource(a[s]);this._computeReplacement()}},_.cY=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy()}_fillGridMeshWithLods(a,s){const d=new dn,f=new ln,v=[],y=a+1+2,E=s[0]+1,M=s[0]+1+(1+s.length),k=(R,L,V)=>{let j=R===y-1?R-2:0===R?R:R-1;return j+=V?24575:0,[j,L]};for(let R=0;R<y;++R)d.emplaceBack(...k(R,0,!0));for(let R=0;R<E;++R)for(let L=0;L<y;++L)d.emplaceBack(...k(L,R,(0===L||L===y-1)&&!0));for(let R=0;R<s.length;++R){const L=s[R];for(let V=0;V<y;++V)d.emplaceBack(...k(V,L,!0))}for(let R=0;R<s.length;++R){const L=f.length,V=s[R]+1+2,j=new ln;for(let J=0;J<V-1;J++){const ne=J===V-2,le=ne?y*(M-s.length+R-J):y;for(let xe=0;xe<y-1;xe++){const Ee=J*y+xe;0===J||ne||0===xe||xe===y-2?(j.emplaceBack(Ee+1,Ee,Ee+le),j.emplaceBack(Ee+le,Ee+le+1,Ee+1)):(f.emplaceBack(Ee+1,Ee,Ee+le),f.emplaceBack(Ee+le,Ee+le+1,Ee+1))}}const q=Wo.simpleSegment(0,L,d.length,f.length-L);for(let J=0;J<j.uint16.length;J+=3)f.emplaceBack(j.uint16[J],j.uint16[J+1],j.uint16[J+2]);const Z=Wo.simpleSegment(0,L,d.length,f.length-L);v.push({withoutSkirts:q,withSkirts:Z})}return{vertices:d,indices:f,segments:v}}_createGrid(a){const s=this._fillGridMeshWithLods(64,Ne);this._gridSegments=s.segments,this._gridBuffer=a.createVertexBuffer(s.vertices,sw.members),this._gridIndexBuffer=a.createIndexBuffer(s.indices,!0)}_createPoles(a){const s=new ln;for(let E=0;E<=64;E++)s.emplaceBack(0,E+1,E+2);this._poleIndexBuffer=a.createIndexBuffer(s,!0);const d=new Ns,f=new Ns,v=new Ns,y=new Ns;this._poleSegments=[];for(let E=0,M=0;E<Se;E++){const k=360/(1<<E);d.emplaceBack(0,-we,0,.5,0),f.emplaceBack(0,-we,0,.5,1),v.emplaceBack(0,-we,0,.5,.5),y.emplaceBack(0,-we,0,.5,.5);for(let R=0;R<=64;R++){let L=R/64,V=0;const j=rr(0,k,L),[q,Z,J]=Ke(NC,BC,j,we);d.emplaceBack(q,Z,J,L,V),f.emplaceBack(q,Z,J,L,1-V);const ne=mi(j);L=.5+.5*Math.sin(ne),V=.5+.5*Math.cos(ne),v.emplaceBack(q,Z,J,L,V),y.emplaceBack(q,Z,J,L,1-V)}this._poleSegments.push(Wo.simpleSegment(M,0,66,64)),M+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(d,Oa,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(f,Oa,!1),this._texturedPoleNorthVertexBuffer=a.createVertexBuffer(v,Oa,!1),this._texturedPoleSouthVertexBuffer=a.createVertexBuffer(y,Oa,!1)}getGridBuffers(a,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a,s){return[s?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,s?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}},_.cZ=function(a){return Ka.has(a)},_.c_=Vn,_.ca=u,_.cb=class extends zu{constructor(a){super(a),this.current=S}set(a,s,d){if(this.fetchUniformLocation(a,s))for(let f=0;f<9;f++)if(d[f]!==this.current[f]){this.current=d,this.gl.uniformMatrix3fv(this.location,!1,d);break}}},_.cc=St,_.cd=function(a,s,d){const f=Ih(d.zoom),v=a.style.map._antialias,y=s.options.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return 0===f&&!v&&!y},_.ce=function(a){const s=a.pixelsPerMeter,d=s/xn(1,a.center.lat),f=_.a6.identity(new Float64Array(16));return _.a6.translate(f,f,[a.point.x,a.point.y,0]),_.a6.scale(f,f,[d,d,s]),Float32Array.from(f)},_.cf=xv,_.cg=function(a){const s=Mi-5;a=Ii(a,-s,s)/s*90;const d=Math.pow(Math.abs(Math.sin(mi(a))),3);return Math.round(d*(Ne.length-1))},_.ch=function(a,s,d,f){const v=s.getNorth(),y=s.getSouth(),E=s.getWest(),M=s.getEast(),k=1<<a.z,R=M-E,L=v-y,V=R/64,j=-L/Ne[d],q=[0,V,0,j,0,0,v,E,0];if(a.z>0){const Z=180/f;_.co.multiply(q,q,[Z/R+1,0,0,0,Z/L+1,0,-.5*Z/V,.5*Z/j,1])}return q[2]=k,q[5]=a.x,q[8]=a.y,q},_.ci=xd,_.cj=function(a,s,d){const f=_.a6.identity(new Float64Array(16)),v=(s/(1<<a)-.5)*Math.PI*2;return _.a6.rotateY(f,d.globeMatrix,v),Float32Array.from(f)},_.ck=class{isDataAvailableAtPoint(a){const s=this._source();if(this.isUsingMockSource()||!s||a.y<0||a.y>1)return!1;const d=s.getSource().maxzoom,f=1<<d,v=Math.floor(a.x),y=Math.floor((a.x-v)*f),E=Math.floor(a.y*f),M=this.findDEMTileFor(new Wt(d,v,d,y,E));return!(!M||!M.dem)}getAtPointOrZero(a,s=0){return this.getAtPoint(a,s)||0}getAtPoint(a,s,d=!0){if(this.isUsingMockSource())return null;null==s&&(s=null);const f=this._source();if(!f||a.y<0||a.y>1)return s;const v=f.getSource().maxzoom,y=1<<v,E=Math.floor(a.x),M=a.x-E,k=new Wt(v,E,v,Math.floor(M*y),Math.floor(a.y*y)),R=this.findDEMTileFor(k);if(!R||!R.dem)return s;const L=R.dem,V=1<<R.tileID.canonical.z,j=(M*V-R.tileID.canonical.x)*L.dim,q=(a.y*V-R.tileID.canonical.y)*L.dim,Z=Math.floor(j),J=Math.floor(q);return(d?this.exaggeration():1)*rr(rr(L.get(Z,J),L.get(Z,J+1),q-J),rr(L.get(Z+1,J),L.get(Z+1,J+1),q-J),j-Z)}getAtTileOffset(a,s,d){const f=1<<a.canonical.z;return this.getAtPointOrZero(new Sr(a.wrap+(a.canonical.x+s/Nt)/f,(a.canonical.y+d/Nt)/f))}getAtTileOffsetFunc(a,s,d,f){return v=>{const y=this.getAtTileOffset(a,v.x,v.y),E=f.upVector(a.canonical,v.x,v.y),M=f.upVectorScale(a.canonical,s,d).metersToTile;return _.N.scale(E,E,y*M),E}}getForTilePoints(a,s,d,f){if(this.isUsingMockSource())return!1;const v=Rv.create(this,a,f);return!!v&&(s.forEach(y=>{y[2]=this.exaggeration()*v.getElevationAt(y[0],y[1],d)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(a);if(!s||!s.dem)return null;const d=s.dem.tree,f=s.tileID,v=1<<a.canonical.z-f.canonical.z;let y=a.canonical.x/v-f.canonical.x,E=a.canonical.y/v-f.canonical.y,M=0;for(let k=0;k<a.canonical.z-f.canonical.z&&!d.leaves[M];k++){y*=2,E*=2;const R=2*Math.floor(E)+Math.floor(y);M=d.childOffsets[M]+R,y%=1,E%=1}return{min:this.exaggeration()*d.minimums[M],max:this.exaggeration()*d.maximums[M]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,s,d){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const a=this.visibleDemTiles;if(0===a.length)return null;let s=!1,d=Number.MAX_VALUE,f=Number.MIN_VALUE;for(const v of a){const y=this.getMinMaxForTile(v.tileID);y&&(d=Math.min(d,y.min),f=Math.max(f,y.max),s=!0)}return s?{min:d,max:f}:null}},_.cl=yd,_.cm=mw,_.cn=function(a,s){return[Math.pow(a[0],2.2)*s,Math.pow(a[1],2.2)*s,Math.pow(a[2],2.2)*s]},_.cp=dw,_.cq=256,_.cr=function(a,s){const d=[0,0,0],f=Cy(xd(s.canonical));return _.N.transformMat4(d,d,f),_.N.transformMat4(d,d,a),d},_.cs=a=>({u_camera_to_center_distance:new Al(a),u_extrude_scale:new P(a),u_device_pixel_ratio:new Al(a),u_matrix:new w(a),u_inv_rot_matrix:new w(a),u_merc_center:new Wf(a),u_tile_id:new gC(a),u_zoom_transition:new Al(a),u_up_dir:new gC(a),u_emissive_strength:new Al(a)}),_.ct=a=>({u_matrix:new w(a),u_pixels_to_tile_units:new P(a),u_device_pixel_ratio:new Al(a),u_units_to_pixels:new Wf(a),u_dash_image:new $f(a),u_gradient_image:new $f(a),u_image_height:new Al(a),u_texsize:new Wf(a),u_tile_units_to_pixels:new Al(a),u_alpha_discard_threshold:new Al(a),u_trim_offset:new Wf(a),u_emissive_strength:new Al(a)}),_.cu=a=>({u_matrix:new w(a),u_texsize:new Wf(a),u_pixels_to_tile_units:new P(a),u_device_pixel_ratio:new Al(a),u_image:new $f(a),u_units_to_pixels:new Wf(a),u_tile_units_to_pixels:new Al(a),u_alpha_discard_threshold:new Al(a),u_trim_offset:new Wf(a)}),_.cv=Ko,_.cw=sE,_.cx=pL,_.cy=VC,_.cz=(a,s,d,f,v,y)=>{const E=a.transform,M="globe"===E.projection.name;let k;if("map"===y.paint.get("circle-pitch-alignment"))if(M){const L=dw(E.zoom,s.canonical)*E._pixelsPerMercatorPixel;k=Float32Array.from([L,0,0,L])}else k=E.calculatePixelsToTileUnitsMatrix(d);else k=new Float32Array([E.pixelsToGLUnits[0],0,0,E.pixelsToGLUnits[1]]);const R={u_camera_to_center_distance:a.transform.getCameraToCenterDistance(E.projection),u_matrix:a.translatePosMatrix(s.projMatrix,d,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ht.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:Cd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:y.paint.get("circle-emissive-strength")};if(M){R.u_inv_rot_matrix=f,R.u_merc_center=v,R.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],R.u_zoom_transition=Ih(E.zoom);const L=v[0]*Nt,V=v[1]*Nt;R.u_up_dir=E.projection.upVector(new Mt(0,0,0),L,V)}return R},_.d=ai,_.d0=yn,_.d1=Lr,_.d2=rt,_.d3=function([a,s,d]){const f=Math.hypot(a,s,d),v=Math.atan2(a,d),y=.5*Math.PI-Math.acos(-s/f);return new Ze(Mn(v),Mn(y))},_.d4=pt,_.d5=Ri,_.d6=Ev,_.d7=Rh,_.d8=function(a){const s=[0,0,0],d=_.a6.identity(new Float64Array(16));return _.a6.multiply(d,a.pixelMatrix,a.globeMatrix),_.N.transformMat4(s,s,d),new mt(s[0],s[1])},_.d9=function(a){const s=a.navigator?a.navigator.userAgent:null;return!!function(d){if(null==lt){const f=d.navigator?d.navigator.userAgent:null;lt=!!d.safari||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||f.match("Safari")&&!f.match("Chrome")))}return lt}(a)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},_.dA=Ll,_.dB=c0,_.dC=La,_.dD=vM,_.dE=No,_.dF=Cc,_.dG=function(a,s,d,f,v,y,E,M,k,R,L){a.createArrays(),a.tilePixelRatio=Nt/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const V=a.layers[0].layout,j=a.layers[0]._unevaluatedLayout._values,q={};if("composite"===a.textSizeData.kind){const{minZoom:le,maxZoom:xe}=a.textSizeData;q.compositeTextSizes=[j["text-size"].possiblyEvaluate(new qr(le),M),j["text-size"].possiblyEvaluate(new qr(xe),M)]}if("composite"===a.iconSizeData.kind){const{minZoom:le,maxZoom:xe}=a.iconSizeData;q.compositeIconSizes=[j["icon-size"].possiblyEvaluate(new qr(le),M),j["icon-size"].possiblyEvaluate(new qr(xe),M)]}q.layoutTextSize=j["text-size"].possiblyEvaluate(new qr(k+1),M),q.layoutIconSize=j["icon-size"].possiblyEvaluate(new qr(k+1),M),q.textMaxSize=j["text-size"].possiblyEvaluate(new qr(18),M);const Z="map"===V.get("text-rotation-alignment")&&"point"!==V.get("symbol-placement"),J=V.get("text-size");let ne=!1;for(const le of a.features)if(le.icon&&le.icon.nameSecondary){ne=!0;break}for(const le of a.features){const xe=V.get("text-font").evaluate(le,{},M).join(","),Ee=J.evaluate(le,{},M),Te=q.layoutTextSize.evaluate(le,{},M),Le=(q.layoutIconSize.evaluate(le,{},M),{horizontal:{},vertical:void 0}),ke=le.text;let Be,We=[0,0];if(ke){const it=ke.toString(),xt=V.get("text-letter-spacing").evaluate(le,{},M)*al,Rt=V.get("text-line-height").evaluate(le,{},M)*al,_t=tp(it)?xt:0,At=V.get("text-anchor").evaluate(le,{},M),ft=V.get("text-variable-anchor");if(!ft){const Ti=V.get("text-radial-offset").evaluate(le,{},M);We=Ti?fE(At,[Ti*al,Xy]):V.get("text-offset").evaluate(le,{},M).map(Ut=>Ut*al)}let Dt=Z?"center":V.get("text-justify").evaluate(le,{},M);const ii="point"===V.get("symbol-placement"),Lt=ii?V.get("text-max-width").evaluate(le,{},M)*al:1/0,Ui=Ti=>{a.allowVerticalPlacement&&Uc(it)&&(Le.vertical=Uh(ke,s,d,v,xe,Lt,Rt,At,Ti,_t,We,Jl.vertical,!0,Te,Ee))};if(!Z&&ft){const Ti="auto"===Dt?ft.map(on=>i_(on)):[Dt];let Ut=!1;for(let on=0;on<Ti.length;on++){const Gi=Ti[on];if(!Le.horizontal[Gi])if(Ut)Le.horizontal[Gi]=Le.horizontal[0];else{const Bi=Uh(ke,s,d,v,xe,Lt,Rt,"center",Gi,_t,We,Jl.horizontal,!1,Te,Ee);Bi&&(Le.horizontal[Gi]=Bi,Ut=1===Bi.positionedLines.length)}}Ui("left")}else{if("auto"===Dt&&(Dt=i_(At)),ii||V.get("text-writing-mode").indexOf("horizontal")>=0||!Uc(it)){const Ti=Uh(ke,s,d,v,xe,Lt,Rt,At,Dt,_t,We,Jl.horizontal,!1,Te,Ee);Ti&&(Le.horizontal[Dt]=Ti)}Ui(ii?"left":Dt)}}let tt=!1;if(le.icon&&le.icon.namePrimary){const it=f[le.icon.namePrimary];it&&(Be=Jg(v[le.icon.namePrimary],le.icon.nameSecondary?v[le.icon.nameSecondary]:void 0,V.get("icon-offset").evaluate(le,{},M),V.get("icon-anchor").evaluate(le,{},M)),tt=it.sdf,void 0===a.sdfIcons?a.sdfIcons=it.sdf:a.sdfIcons!==it.sdf&&Qe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(it.pixelRatio!==a.pixelRatio||0!==V.get("icon-rotate").constantOr(1))&&(a.iconsNeedLinear=!0))}const ct=Gv(Le.horizontal)||Le.vertical;a.iconsInText||(a.iconsInText=!!ct&&ct.iconsInText),(ct||Be)&&n_(a,le,Le,Be,f,q,Te,0,We,tt,E,M,R,L,ne)}y&&a.generateCollisionDebugBuffers(k,a.collisionBoxArray)},_.dH=bw,_.dI=ru,_.dJ=yw,_.dK=un,_.dL=Ep,_.dM=am,_.dN=ki,_.dO=Sw,_.dP=function(a){let s=0;if(new Uint32Array(a,0,1)[0]!==m_){const d=new Uint32Array(a,0,7),[,,f,v,y,E]=d;s=d.byteLength+v+y+E+y,(f!==a.byteLength||s>=a.byteLength)&&Qe("Invalid b3dm header information.")}return XM(a,s)},_.dQ=function(a,s){const d=qM(a);for(const f of d){for(const v of f.meshes)YM(v);f.lights&&(f.lightMeshIndex=f.meshes.length,f.meshes.push(RE(f.lights,s)))}return d},_.dR=hu,_.dS=DE,_.dT=na,_.dU=function(a){eo(),wi&&wi.then(s=>{s.keys().then(d=>{for(let f=0;f<d.length-a;f++)s.delete(d[f])})})},_.da=class{constructor(a,s,d){this._transformRequestFn=a,this._customAccessToken=s,this._silenceAuthErrors=!!d,this._createSkuToken()}_createSkuToken(){const a=function(){let s="";for(let d=0;d<10;d++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Zt,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,s){return this._transformRequestFn&&this._transformRequestFn(a,s)||{url:a}}normalizeStyleURL(a,s){if(!Kt(a))return a;const d=sn(a);return d.params.push(`sdk=js-${Tt}`),d.path=`/styles/v1${d.path}`,this._makeAPIURL(d,this._customAccessToken||s)}normalizeGlyphsURL(a,s){if(!Kt(a))return a;const d=sn(a);return d.path=`/fonts/v1${d.path}`,this._makeAPIURL(d,this._customAccessToken||s)}normalizeModelURL(a,s){if(!Kt(a))return a;const d=sn(a);return d.path=`/models/v1${d.path}`,this._makeAPIURL(d,this._customAccessToken||s)}normalizeSourceURL(a,s,d,f){if(!Kt(a))return a;const v=sn(a);return v.path=`/v4/${v.authority}.json`,v.params.push("secure"),d&&v.params.push(`language=${d}`),f&&v.params.push(`worldview=${f}`),this._makeAPIURL(v,this._customAccessToken||s)}normalizeSpriteURL(a,s,d,f){const v=sn(a);return Kt(a)?(v.path=`/styles/v1${v.path}/sprite${s}${d}`,this._makeAPIURL(v,this._customAccessToken||f)):(v.path+=`${s}${d}`,Zn(v))}normalizeTileURL(a,s,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!Kt(a))return a;const f=sn(a);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||d&&"raster"!==f.authority&&512===d?"@2x":""}${cr.supported?".webp":"$1"}`),"raster"===f.authority?f.path=`/${Ri.RASTER_URL_PREFIX}${f.path}`:"rasterarrays"===f.authority?f.path=`/${Ri.RASTERARRAYS_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${Ri.TILE_URL_VERSION}${f.path}`);const v=this._customAccessToken||function(y){for(const E of y){const M=E.match(/^access_token=(.*)$/);if(M)return M[1]}return null}(f.params)||Ri.ACCESS_TOKEN;return Ri.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,v)}canonicalizeTileURL(a,s){const d=sn(a);if(!d.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!d.path.match(/\.[\w]+$/))return a;let f="mapbox://";d.path.match(/^\/raster\/v1\//)?f+=`raster/${d.path.replace(`/${Ri.RASTER_URL_PREFIX}/`,"")}`:d.path.match(/^\/rasterarrays\/v1\//)?f+=`rasterarrays/${d.path.replace(`/${Ri.RASTERARRAYS_URL_PREFIX}/`,"")}`:f+=`tiles/${d.path.replace(`/${Ri.TILE_URL_VERSION}/`,"")}`;let v=d.params;return s&&(v=v.filter(y=>!y.match(/^access_token=/))),v.length&&(f+=`?${v.join("&")}`),f}canonicalizeTileset(a,s){const d=!!s&&Kt(s),f=[];for(const v of a.tiles||[])Ar(v)?f.push(this.canonicalizeTileURL(v,d)):f.push(v);return f}_makeAPIURL(a,s){const d="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=sn(Ri.API_URL);if(a.protocol=f.protocol,a.authority=f.authority,"http"===a.protocol){const v=a.params.indexOf("secure");v>=0&&a.params.splice(v,1)}if("/"!==f.path&&(a.path=`${f.path}${a.path}`),!Ri.REQUIRE_ACCESS_TOKEN)return Zn(a);if(s=s||Ri.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${d}`);if("s"===s[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${d}`)}return a.params=a.params.filter(v=>-1===v.indexOf("access_token")),a.params.push(`access_token=${s||""}`),Zn(a)}},_.db=function(a,s){s?Ka.add(a):Ka.delete(a)},_.dc=cr,_.dd=$s,_.de=gh,_.df=ri,_.dg=ir,_.dh=function(a){Ka.delete(a)},_.di=nr,_.dj=bo,_.dk=Tt,_.dl=function(a,s){gt=a,Ni=s},_.dm=function(a,s,d=!1){if(tl===iy||tl===ip||tl===Sg)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ou=Ht.resolveURL(a),tl=iy,sv=s,av(),d||ya()},_.dn=ps,_.dp=function(){xm().acquire(dl)},_.dq=function(){const a=ym;a&&(a.isPreloaded()&&1===a.numActive()?(a.release(dl),ym=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},_.dr=ul,_.ds=function(a){const s=jn();if(!s)return;const d=s.delete(hi);a&&d.catch(a).then(()=>a())},_.dt=ib,_.du=Gp,_.dv=function(a){u_=Ht.resolveURL(a),wm||(wm=new Vp(xm(),new Ea)),wm.broadcast("setDracoUrl",u_)},_.dw=s0,_.dx=function(a){nb=Ht.resolveURL(a),wm||(wm=new Vp(xm(),new Ea)),wm.broadcast("setMeshoptUrl",nb)},_.dy=Oi,_.dz=Zu,_.e=Hr,_.f=Ht,_.g=function(a,s){return dt(Hr(a,{type:"json"}),s)},_.h=xc,_.i=sd,_.j=Sa,_.k=kf,_.l=function(a){return fetch(a).then(s=>s.arrayBuffer()).then(s=>XM(s,0,a))},_.m=iv,_.n=If,_.o=Nf,_.p=Pw,_.q=Pu,_.r=Ru,_.s=Ix,_.t=Tu,_.u=Mg,_.v=qs,_.w=Qe,_.x=ad,_.z=cv}),Yt(0,function(_){function Tt(lt){const ve=lt?lt.url.toString():void 0;return ve?performance.getEntriesByName(ve):[]}function Si(lt){if("number"==typeof lt||"boolean"==typeof lt||"string"==typeof lt||null==lt)return JSON.stringify(lt);if(Array.isArray(lt)){let Ce="[";for(const He of lt)Ce+=`${Si(He)},`;return`${Ce}]`}let ve="{";for(const Ce of Object.keys(lt).sort())ve+=`${Ce}:${Si(lt[Ce])},`;return`${ve}}`}function Ri(lt){let ve="";for(const Ce of _.b2)ve+=`/${Si(lt[Ce])}`;return ve}class Ar{constructor(ve){this.keyCache={},this._layers={},this._layerConfigs={},ve&&this.replace(ve)}replace(ve,Ce){this._layerConfigs={},this._layers={},this.update(ve,[],Ce)}update(ve,Ce,He){this._options=He;for(const bt of ve)this._layerConfigs[bt.id]=bt,(this._layers[bt.id]=_.c2(bt,this.scope,this._options)).compileFilter(),this.keyCache[bt.id]&&delete this.keyCache[bt.id];for(const bt of Ce)delete this.keyCache[bt],delete this._layerConfigs[bt],delete this._layers[bt];this.familiesBySource={};const ut=function(bt,Ht){const hi={};for(let Ni=0;Ni<bt.length;Ni++){const wi=Ht&&Ht[bt[Ni].id]||Ri(bt[Ni]);Ht&&(Ht[bt[Ni].id]=wi);let $i=hi[wi];$i||($i=hi[wi]=[]),$i.push(bt[Ni])}const gt=[];for(const Ni in hi)gt.push(hi[Ni]);return gt}(_.a$(this._layerConfigs),this.keyCache);for(const bt of ut){const Ht=bt.map(jn=>this._layers[jn.id]),hi=Ht[0];if("none"===hi.visibility)continue;const gt=hi.source||"";let Ni=this.familiesBySource[gt];Ni||(Ni=this.familiesBySource[gt]={});const wi=hi.sourceLayer||"_geojsonTileLayer";let $i=Ni[wi];$i||($i=Ni[wi]=[]),$i.push(Ht)}}}const Kt=1*_.dA;class ui{constructor(ve){const Ce={},He=[];for(const hi in ve){const gt=ve[hi],Ni=Ce[hi]={};for(const wi in gt.glyphs){const $i=gt.glyphs[+wi];if(!$i||0===$i.bitmap.width||0===$i.bitmap.height)continue;const jn=$i.metrics.localGlyph?Kt:1,eo={x:0,y:0,w:$i.bitmap.width+2*jn,h:$i.bitmap.height+2*jn};He.push(eo),Ni[wi]=eo}}const{w:ut,h:bt}=_.p(He),Ht=new _.dz({width:ut||1,height:bt||1});for(const hi in ve){const gt=ve[hi];for(const Ni in gt.glyphs){const wi=gt.glyphs[+Ni];if(!wi||0===wi.bitmap.width||0===wi.bitmap.height)continue;const $i=Ce[hi][Ni],jn=wi.metrics.localGlyph?Kt:1;_.dz.copy(wi.bitmap,Ht,{x:0,y:0},{x:$i.x+jn,y:$i.y+jn},wi.bitmap)}}this.image=Ht,this.positions=Ce}}_.dy(ui,"GlyphAtlas");class Ft{constructor(ve){this.tileID=new _.am(ve.tileID.overscaledZ,ve.tileID.wrap,ve.tileID.canonical.z,ve.tileID.canonical.x,ve.tileID.canonical.y),this.tileZoom=ve.tileZoom,this.uid=ve.uid,this.zoom=ve.zoom,this.canonical=ve.tileID.canonical,this.pixelRatio=ve.pixelRatio,this.tileSize=ve.tileSize,this.source=ve.source,this.scope=ve.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ve.showCollisionBoxes,this.collectResourceTiming=!!ve.collectResourceTiming,this.promoteId=ve.promoteId,this.isSymbolTile=ve.isSymbolTile,this.tileTransform=_.as(ve.tileID.canonical,ve.projection),this.projection=ve.projection,this.brightness=ve.brightness,this.extraShadowCaster=!!ve.extraShadowCaster}parse(ve,Ce,He,ut,bt){this.status="parsing",this.data=ve,this.collisionBoxArray=new _.aD;const Ht=new _.dB(Object.keys(ve.layers).sort()),hi=new _.dC(this.tileID,this.promoteId);hi.bucketLayerIDs=[];const gt={},Ni=new _.dD(256,256),wi={featureIndex:hi,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Ni,availableImages:He,brightness:this.brightness},$i=Ce.familiesBySource[this.source];for(const kn in $i){const Xr=ve.layers[kn];if(!Xr)continue;let gi=!1,di=!1,ro=!1;for(const ls of $i[kn])"symbol"===ls[0].type?gi=!0:di=!0,ls[0].is3D()&&"model"!==ls[0].type&&(ro=!0);if(this.extraShadowCaster&&!ro||!0===this.isSymbolTile&&!gi||!1===this.isSymbolTile&&!di)continue;1===Xr.version&&_.w(`Vector tile source "${this.source}" layer "${kn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Hs=Ht.encode(kn),ca=[];for(let ls=0;ls<Xr.length;ls++){const Yo=Xr.feature(ls),dt=hi.getId(Yo,kn);ca.push({feature:Yo,id:dt,index:ls,sourceLayerIndex:Hs})}for(const ls of $i[kn]){const Yo=ls[0];(!this.extraShadowCaster||Yo.is3D()&&"model"!==Yo.type)&&(void 0!==this.isSymbolTile&&"symbol"===Yo.type!==this.isSymbolTile||Yo.minzoom&&this.zoom<Math.floor(Yo.minzoom)||Yo.maxzoom&&this.zoom>=Yo.maxzoom||"none"!==Yo.visibility&&(Li(ls,this.zoom,wi.brightness,He),(gt[Yo.id]=Yo.createBucket({index:hi.bucketLayerIDs.length,layers:ls,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Hs,sourceID:this.source,projection:this.projection.spec})).populate(ca,wi,this.tileID.canonical,this.tileTransform),hi.bucketLayerIDs.push(ls.map(dt=>dt.id))))}}let jn,eo,_o,Pn;Ni.trim();const Tr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},cr=()=>{if(jn)return this.status="done",bt(jn);if(this.extraShadowCaster)this.status="done",bt(null,{buckets:_.a$(gt).filter(kn=>!kn.isEmpty()),featureIndex:hi,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:wi.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(eo&&_o&&Pn){const kn=new ui(eo),Xr=new _.dF(_o,Pn);for(const gi in gt){const di=gt[gi];di instanceof _.aE?(Li(di.layers,this.zoom,wi.brightness,He),_.dG(di,eo,kn.positions,_o,Xr.iconPositions,this.showCollisionBoxes,He,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):di.hasPattern&&(di instanceof _.aK||di instanceof _.aL||di instanceof _.cH)&&(Li(di.layers,this.zoom,wi.brightness,He),di.addFeatures(wi,this.tileID.canonical,Xr.patternPositions,He,this.tileTransform,this.brightness))}this.status="done",bt(null,{buckets:_.a$(gt).filter(gi=>!gi.isEmpty()),featureIndex:hi,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:kn.image,lineAtlas:Ni,imageAtlas:Xr,brightness:wi.brightness})}};if(!this.extraShadowCaster){const kn=_.dE(wi.glyphDependencies,di=>Object.keys(di).map(Number));Object.keys(kn).length?ut.send("getGlyphs",{uid:this.uid,stacks:kn,scope:this.scope},(di,ro)=>{jn||(jn=di,eo=ro,cr())},void 0,!1,Tr):eo={};const Xr=Object.keys(wi.iconDependencies);Xr.length?ut.send("getImages",{icons:Xr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(di,ro)=>{jn||(jn=di,_o=ro,cr())},void 0,!1,Tr):_o={};const gi=Object.keys(wi.patternDependencies);gi.length?ut.send("getImages",{icons:gi,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(di,ro)=>{jn||(jn=di,Pn=ro,cr())},void 0,!1,Tr):Pn={}}cr()}}function Li(lt,ve,Ce,He){const ut=new _.K(ve,{brightness:Ce});for(const bt of lt)bt.recalculate(ut,He)}class er extends _.E{constructor(ve,Ce,He,ut,bt,Ht){super(),this.actor=ve,this.layerIndex=Ce,this.availableImages=He,this.loadVectorData=bt||_.ah,this.loading={},this.loaded={},this.deduped=new _.af(ve.scheduler),this.isSpriteLoaded=ut,this.scheduler=ve.scheduler,this.brightness=Ht}loadTile(ve,Ce){const He=ve.uid,ut=ve&&ve.request,bt=ut&&ut.collectResourceTiming,Ht=this.loading[He]=new Ft(ve);Ht.abort=this.loadVectorData(ve,(hi,gt)=>{const Ni=!this.loading[He];if(delete this.loading[He],Ni||hi||!gt)return Ht.status="done",Ni||(this.loaded[He]=Ht),Ce(hi);const wi=gt.rawData,$i={};gt.expires&&($i.expires=gt.expires),gt.cacheControl&&($i.cacheControl=gt.cacheControl),Ht.vectorTile=gt.vectorTile||new _.dH(new _.dI(wi));const jn=()=>{Ht.parse(Ht.vectorTile,this.layerIndex,this.availableImages,this.actor,(eo,_o)=>{if(eo||!_o)return Ce(eo);const Pn={};if(bt){const Tr=Tt(ut);Tr.length>0&&(Pn.resourceTiming=JSON.parse(JSON.stringify(Tr)))}Ce(null,_.e({rawTileData:wi.slice(0)},_o,$i,Pn))})};this.isSpriteLoaded?jn():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(jn,{type:"parseTile",isSymbolTile:ve.isSymbolTile,zoom:ve.tileZoom}):jn()}),this.loaded=this.loaded||{},this.loaded[He]=Ht})}reloadTile(ve,Ce){const He=this.loaded,ut=ve.uid,bt=this;if(He&&He[ut]){const Ht=He[ut];Ht.showCollisionBoxes=ve.showCollisionBoxes,Ht.projection=ve.projection,Ht.brightness=ve.brightness,Ht.tileTransform=_.as(ve.tileID.canonical,ve.projection),Ht.extraShadowCaster=ve.extraShadowCaster;const hi=(gt,Ni)=>{const wi=Ht.reloadCallback;wi&&(delete Ht.reloadCallback,Ht.parse(Ht.vectorTile,bt.layerIndex,this.availableImages,bt.actor,wi)),Ce(gt,Ni)};"parsing"===Ht.status?Ht.reloadCallback=hi:"done"===Ht.status&&(Ht.vectorTile?Ht.parse(Ht.vectorTile,this.layerIndex,this.availableImages,this.actor,hi):hi())}else Ce(null,void 0)}abortTile(ve,Ce){const He=ve.uid,ut=this.loading[He];ut&&(ut.abort&&ut.abort(),delete this.loading[He]),Ce()}removeTile(ve,Ce){const He=this.loaded,ut=ve.uid;He&&He[ut]&&delete He[ut],Ce()}}class ji{loadTile(ve,Ce){const{uid:He,encoding:ut,rawImageData:bt,padding:Ht}=ve,hi=ImageBitmap&&bt instanceof ImageBitmap?this.getImageData(bt,Ht):bt;Ce(null,new _.dJ(He,hi,ut,Ht<1))}getImageData(ve,Ce){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ve.width,ve.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ve.width,this.offscreenCanvas.height=ve.height,this.offscreenCanvasContext.drawImage(ve,0,0,ve.width,ve.height);const He=this.offscreenCanvasContext.getImageData(-Ce,-Ce,ve.width+2*Ce,ve.height+2*Ce);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),He}}class un{decodeRasterArray({task:ve,buffer:Ce},He){_.aZ.performDecoding(Ce,ve).then(ut=>{He(null,ut)},ut=>{He(ut)})}}function tr(lt,ve){if(0!==lt.length){bi(lt[0],ve);for(var Ce=1;Ce<lt.length;Ce++)bi(lt[Ce],!ve)}}function bi(lt,ve){for(var Ce=0,He=0,ut=0,bt=lt.length,Ht=bt-1;ut<bt;Ht=ut++){var hi=(lt[ut][0]-lt[Ht][0])*(lt[Ht][1]+lt[ut][1]),gt=Ce+hi;He+=Math.abs(Ce)>=Math.abs(hi)?Ce-gt+hi:hi-gt+Ce,Ce=gt}Ce+He>=0!=!!ve&&lt.reverse()}var Di=_.dK(function lt(ve,Ce){var He,ut=ve&&ve.type;if("FeatureCollection"===ut)for(He=0;He<ve.features.length;He++)lt(ve.features[He],Ce);else if("GeometryCollection"===ut)for(He=0;He<ve.geometries.length;He++)lt(ve.geometries[He],Ce);else if("Feature"===ut)lt(ve.geometry,Ce);else if("Polygon"===ut)tr(ve.coordinates,Ce);else if("MultiPolygon"===ut)for(He=0;He<ve.coordinates.length;He++)tr(ve.coordinates[He],Ce);return ve});const ki=_.dL.prototype.toGeoJSON;let Ki=class{constructor(lt){this._feature=lt,this.extent=_.V,this.type=lt.type,this.properties=lt.tags,"id"in lt&&!isNaN(lt.id)&&(this.id=parseInt(lt.id,10))}loadGeometry(){if(1===this._feature.type){const lt=[];for(const ve of this._feature.geometry)lt.push([new _.P(ve[0],ve[1])]);return lt}{const lt=[];for(const ve of this._feature.geometry){const Ce=[];for(const He of ve)Ce.push(new _.P(He[0],He[1]));lt.push(Ce)}return lt}}toGeoJSON(lt,ve,Ce){return ki.call(this,lt,ve,Ce)}},mt=class{constructor(lt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=_.V,this.length=lt.length,this._features=lt}feature(lt){return new Ki(this._features[lt])}};var yi={exports:{}},en=_.dN,mi=_.dM.VectorTileFeature,Mn=vn;function vn(lt,ve){this.options=ve||{},this.features=lt,this.length=lt.length}function St(lt,ve){this.id="number"==typeof lt.id?lt.id:void 0,this.type=lt.type,this.rawGeometry=1===lt.type?[lt.geometry]:lt.geometry,this.properties=lt.tags,this.extent=ve||4096}vn.prototype.feature=function(lt){return new St(this.features[lt],this.options.extent)},St.prototype.loadGeometry=function(){var lt=this.rawGeometry;this.geometry=[];for(var ve=0;ve<lt.length;ve++){for(var Ce=lt[ve],He=[],ut=0;ut<Ce.length;ut++)He.push(new en(Ce[ut][0],Ce[ut][1]));this.geometry.push(He)}return this.geometry},St.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var lt=this.geometry,ve=1/0,Ce=-1/0,He=1/0,ut=-1/0,bt=0;bt<lt.length;bt++)for(var Ht=lt[bt],hi=0;hi<Ht.length;hi++){var gt=Ht[hi];ve=Math.min(ve,gt.x),Ce=Math.max(Ce,gt.x),He=Math.min(He,gt.y),ut=Math.max(ut,gt.y)}return[ve,He,Ce,ut]},St.prototype.toGeoJSON=mi.prototype.toGeoJSON;var Vn=_.dO,yn=Mn;function Ii(lt){var ve=new Vn;return function(Ce,He){for(var ut in Ce.layers)He.writeMessage(3,an,Ce.layers[ut])}(lt,ve),ve.finish()}function an(lt,ve){var Ce;ve.writeVarintField(15,lt.version||1),ve.writeStringField(1,lt.name||""),ve.writeVarintField(5,lt.extent||4096);var He={keys:[],values:[],keycache:{},valuecache:{}};for(Ce=0;Ce<lt.length;Ce++)He.feature=lt.feature(Ce),ve.writeMessage(2,Vr,He);var ut=He.keys;for(Ce=0;Ce<ut.length;Ce++)ve.writeStringField(3,ut[Ce]);var bt=He.values;for(Ce=0;Ce<bt.length;Ce++)ve.writeMessage(4,jt,bt[Ce])}function Vr(lt,ve){var Ce=lt.feature;void 0!==Ce.id&&ve.writeVarintField(1,Ce.id),ve.writeMessage(2,uo,lt),ve.writeVarintField(3,Ce.type),ve.writeMessage(4,va,Ce)}function uo(lt,ve){var Ce=lt.feature,He=lt.keys,ut=lt.values,bt=lt.keycache,Ht=lt.valuecache;for(var hi in Ce.properties){var gt=Ce.properties[hi],Ni=bt[hi];if(null!==gt){void 0===Ni&&(He.push(hi),bt[hi]=Ni=He.length-1),ve.writeVarint(Ni);var wi=typeof gt;"string"!==wi&&"boolean"!==wi&&"number"!==wi&&(gt=JSON.stringify(gt));var $i=wi+":"+gt,jn=Ht[$i];void 0===jn&&(ut.push(gt),Ht[$i]=jn=ut.length-1),ve.writeVarint(jn)}}}function Hr(lt,ve){return(ve<<3)+(7&lt)}function as(lt){return lt<<1^lt>>31}function va(lt,ve){for(var Ce=lt.loadGeometry(),He=lt.type,ut=0,bt=0,Ht=Ce.length,hi=0;hi<Ht;hi++){var gt=Ce[hi],Ni=1;1===He&&(Ni=gt.length),ve.writeVarint(Hr(1,Ni));for(var wi=3===He?gt.length-1:gt.length,$i=0;$i<wi;$i++){1===$i&&1!==He&&ve.writeVarint(Hr(2,wi-1));var jn=gt[$i].x-ut,eo=gt[$i].y-bt;ve.writeVarint(as(jn)),ve.writeVarint(as(eo)),ut+=jn,bt+=eo}3===He&&ve.writeVarint(Hr(7,1))}}function jt(lt,ve){var Ce=typeof lt;"string"===Ce?ve.writeStringField(1,lt):"boolean"===Ce?ve.writeBooleanField(7,lt):"number"===Ce&&(lt%1!=0?ve.writeDoubleField(3,lt):lt<0?ve.writeSVarintField(6,lt):ve.writeVarintField(5,lt))}yi.exports=Ii,yi.exports.fromVectorTileJs=Ii,yi.exports.fromGeojsonVt=function(lt,ve){ve=ve||{};var Ce={};for(var He in lt)Ce[He]=new yn(lt[He].features,ve),Ce[He].name=He,Ce[He].version=ve.version,Ce[He].extent=ve.extent;return Ii({layers:Ce})},yi.exports.GeoJSONWrapper=yn;var ta=_.dK(yi.exports);const Za={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:lt=>lt},Eo=Math.fround||(zr=new Float32Array(1),lt=>(zr[0]=+lt,zr[0]));var zr;const No=3,la=5,io=6;class Ge{constructor(ve){this.options=Object.assign(Object.create(Za),ve),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ve){const{log:Ce,minZoom:He,maxZoom:ut}=this.options;Ce&&console.time("total time");const bt=`prepare ${ve.length} points`;Ce&&console.time(bt),this.points=ve;const Ht=[];for(let gt=0;gt<ve.length;gt++){const Ni=ve[gt];if(!Ni.geometry)continue;const[wi,$i]=Ni.geometry.coordinates,jn=Eo(Xt(wi)),eo=Eo(kt($i));Ht.push(jn,eo,1/0,gt,-1,1),this.options.reduce&&Ht.push(0)}let hi=this.trees[ut+1]=this._createTree(Ht);Ce&&console.timeEnd(bt);for(let gt=ut;gt>=He;gt--){const Ni=+Date.now();hi=this.trees[gt]=this._createTree(this._cluster(hi,gt)),Ce&&console.log("z%d: %d clusters in %dms",gt,hi.numItems,+Date.now()-Ni)}return Ce&&console.timeEnd("total time"),this}getClusters(ve,Ce){let He=((ve[0]+180)%360+360)%360-180;const ut=Math.max(-90,Math.min(90,ve[1]));let bt=180===ve[2]?180:((ve[2]+180)%360+360)%360-180;const Ht=Math.max(-90,Math.min(90,ve[3]));if(ve[2]-ve[0]>=360)He=-180,bt=180;else if(He>bt){const $i=this.getClusters([He,ut,180,Ht],Ce),jn=this.getClusters([-180,ut,bt,Ht],Ce);return $i.concat(jn)}const hi=this.trees[this._limitZoom(Ce)],gt=hi.range(Xt(He),kt(Ht),Xt(bt),kt(ut)),Ni=hi.data,wi=[];for(const $i of gt){const jn=this.stride*$i;wi.push(Ni[jn+la]>1?Qe(Ni,jn,this.clusterProps):this.points[Ni[jn+No]])}return wi}getChildren(ve){const Ce=this._getOriginId(ve),He=this._getOriginZoom(ve),ut="No cluster with the specified id.",bt=this.trees[He];if(!bt)throw new Error(ut);const Ht=bt.data;if(Ce*this.stride>=Ht.length)throw new Error(ut);const hi=this.options.radius/(this.options.extent*Math.pow(2,He-1)),gt=bt.within(Ht[Ce*this.stride],Ht[Ce*this.stride+1],hi),Ni=[];for(const wi of gt){const $i=wi*this.stride;Ht[$i+4]===ve&&Ni.push(Ht[$i+la]>1?Qe(Ht,$i,this.clusterProps):this.points[Ht[$i+No]])}if(0===Ni.length)throw new Error(ut);return Ni}getLeaves(ve,Ce,He){const ut=[];return this._appendLeaves(ut,ve,Ce=Ce||10,He=He||0,0),ut}getTile(ve,Ce,He){const ut=this.trees[this._limitZoom(ve)],bt=Math.pow(2,ve),{extent:Ht,radius:hi}=this.options,gt=hi/Ht,Ni=(He-gt)/bt,wi=(He+1+gt)/bt,$i={features:[]};return this._addTileFeatures(ut.range((Ce-gt)/bt,Ni,(Ce+1+gt)/bt,wi),ut.data,Ce,He,bt,$i),0===Ce&&this._addTileFeatures(ut.range(1-gt/bt,Ni,1,wi),ut.data,bt,He,bt,$i),Ce===bt-1&&this._addTileFeatures(ut.range(0,Ni,gt/bt,wi),ut.data,-1,He,bt,$i),$i.features.length?$i:null}getClusterExpansionZoom(ve){let Ce=this._getOriginZoom(ve)-1;for(;Ce<=this.options.maxZoom;){const He=this.getChildren(ve);if(Ce++,1!==He.length)break;ve=He[0].properties.cluster_id}return Ce}_appendLeaves(ve,Ce,He,ut,bt){const Ht=this.getChildren(Ce);for(const hi of Ht){const gt=hi.properties;if(gt&&gt.cluster?bt+gt.point_count<=ut?bt+=gt.point_count:bt=this._appendLeaves(ve,gt.cluster_id,He,ut,bt):bt<ut?bt++:ve.push(hi),ve.length===He)break}return bt}_createTree(ve){const Ce=new _.bg(ve.length/this.stride|0,this.options.nodeSize,Float32Array);for(let He=0;He<ve.length;He+=this.stride)Ce.add(ve[He],ve[He+1]);return Ce.finish(),Ce.data=ve,Ce}_addTileFeatures(ve,Ce,He,ut,bt,Ht){for(const hi of ve){const gt=hi*this.stride,Ni=Ce[gt+la]>1;let wi,$i,jn;if(Ni)wi=nt(Ce,gt,this.clusterProps),$i=Ce[gt],jn=Ce[gt+1];else{const Pn=this.points[Ce[gt+No]];wi=Pn.properties;const[Tr,cr]=Pn.geometry.coordinates;$i=Xt(Tr),jn=kt(cr)}const eo={type:1,geometry:[[Math.round(this.options.extent*($i*bt-He)),Math.round(this.options.extent*(jn*bt-ut))]],tags:wi};let _o;_o=Ni||this.options.generateId?Ce[gt+No]:this.points[Ce[gt+No]].id,void 0!==_o&&(eo.id=_o),Ht.features.push(eo)}}_limitZoom(ve){return Math.max(this.options.minZoom,Math.min(Math.floor(+ve),this.options.maxZoom+1))}_cluster(ve,Ce){const{radius:He,extent:ut,reduce:bt,minPoints:Ht}=this.options,hi=He/(ut*Math.pow(2,Ce)),gt=ve.data,Ni=[],wi=this.stride;for(let $i=0;$i<gt.length;$i+=wi){if(gt[$i+2]<=Ce)continue;gt[$i+2]=Ce;const jn=gt[$i],eo=gt[$i+1],_o=ve.within(gt[$i],gt[$i+1],hi),Pn=gt[$i+la];let Tr=Pn;for(const cr of _o){const kn=cr*wi;gt[kn+2]>Ce&&(Tr+=gt[kn+la])}if(Tr>Pn&&Tr>=Ht){let cr,kn=jn*Pn,Xr=eo*Pn,gi=-1;const di=($i/wi<<5)+(Ce+1)+this.points.length;for(const ro of _o){const Hs=ro*wi;if(gt[Hs+2]<=Ce)continue;gt[Hs+2]=Ce;const ca=gt[Hs+la];kn+=gt[Hs]*ca,Xr+=gt[Hs+1]*ca,gt[Hs+4]=di,bt&&(cr||(cr=this._map(gt,$i,!0),gi=this.clusterProps.length,this.clusterProps.push(cr)),bt(cr,this._map(gt,Hs)))}gt[$i+4]=di,Ni.push(kn/Tr,Xr/Tr,1/0,di,-1,Tr),bt&&Ni.push(gi)}else{for(let cr=0;cr<wi;cr++)Ni.push(gt[$i+cr]);if(Tr>1)for(const cr of _o){const kn=cr*wi;if(!(gt[kn+2]<=Ce)){gt[kn+2]=Ce;for(let Xr=0;Xr<wi;Xr++)Ni.push(gt[kn+Xr])}}}}return Ni}_getOriginId(ve){return ve-this.points.length>>5}_getOriginZoom(ve){return(ve-this.points.length)%32}_map(ve,Ce,He){if(ve[Ce+la]>1){const Ht=this.clusterProps[ve[Ce+io]];return He?Object.assign({},Ht):Ht}const ut=this.points[ve[Ce+No]].properties,bt=this.options.map(ut);return He&&bt===ut?Object.assign({},bt):bt}}function Qe(lt,ve,Ce){return{type:"Feature",id:lt[ve+No],properties:nt(lt,ve,Ce),geometry:{type:"Point",coordinates:[(He=lt[ve],360*(He-.5)),qt(lt[ve+1])]}};var He}function nt(lt,ve,Ce){const He=lt[ve+la],ut=He>=1e4?`${Math.round(He/1e3)}k`:He>=1e3?Math.round(He/100)/10+"k":He,bt=lt[ve+io],Ht=-1===bt?{}:Object.assign({},Ce[bt]);return Object.assign(Ht,{cluster:!0,cluster_id:lt[ve+No],point_count:He,point_count_abbreviated:ut})}function Xt(lt){return lt/360+.5}function kt(lt){const ve=Math.sin(lt*Math.PI/180),Ce=.5-.25*Math.log((1+ve)/(1-ve))/Math.PI;return Ce<0?0:Ce>1?1:Ce}function qt(lt){const ve=(180-360*lt)*Math.PI/180;return 360*Math.atan(Math.exp(ve))/Math.PI-90}var Bt={exports:{}};Bt.exports=function(){function lt(dt,wt,Vt,st){for(var ei,si=st,ai=Vt-wt>>1,Zt=Vt-wt,ri=dt[wt],oi=dt[wt+1],sn=dt[Vt],Zn=dt[Vt+1],zi=wt+3;zi<Vt;zi+=3){var Kr=ve(dt[zi],dt[zi+1],ri,oi,sn,Zn);if(Kr>si)ei=zi,si=Kr;else if(Kr===si){var hr=Math.abs(zi-ai);hr<Zt&&(ei=zi,Zt=hr)}}si>st&&(ei-wt>3&&lt(dt,wt,ei,st),dt[ei+2]=si,Vt-ei>3&&lt(dt,ei,Vt,st))}function ve(dt,wt,Vt,st,ei,si){var ai=ei-Vt,Zt=si-st;if(0!==ai||0!==Zt){var ri=((dt-Vt)*ai+(wt-st)*Zt)/(ai*ai+Zt*Zt);ri>1?(Vt=ei,st=si):ri>0&&(Vt+=ai*ri,st+=Zt*ri)}return(ai=dt-Vt)*ai+(Zt=wt-st)*Zt}function Ce(dt,wt,Vt,st){var ei={id:void 0===dt?null:dt,type:wt,geometry:Vt,tags:st,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(si){var ai=si.geometry,Zt=si.type;if("Point"===Zt||"MultiPoint"===Zt||"LineString"===Zt)He(si,ai);else if("Polygon"===Zt||"MultiLineString"===Zt)for(var ri=0;ri<ai.length;ri++)He(si,ai[ri]);else if("MultiPolygon"===Zt)for(ri=0;ri<ai.length;ri++)for(var oi=0;oi<ai[ri].length;oi++)He(si,ai[ri][oi])}(ei),ei}function He(dt,wt){for(var Vt=0;Vt<wt.length;Vt+=3)dt.minX=Math.min(dt.minX,wt[Vt]),dt.minY=Math.min(dt.minY,wt[Vt+1]),dt.maxX=Math.max(dt.maxX,wt[Vt]),dt.maxY=Math.max(dt.maxY,wt[Vt+1])}function ut(dt,wt,Vt,st){if(wt.geometry){var ei=wt.geometry.coordinates,si=wt.geometry.type,ai=Math.pow(Vt.tolerance/((1<<Vt.maxZoom)*Vt.extent),2),Zt=[],ri=wt.id;if(Vt.promoteId?ri=wt.properties[Vt.promoteId]:Vt.generateId&&(ri=st||0),"Point"===si)bt(ei,Zt);else if("MultiPoint"===si)for(var oi=0;oi<ei.length;oi++)bt(ei[oi],Zt);else if("LineString"===si)Ht(ei,Zt,ai,!1);else if("MultiLineString"===si){if(Vt.lineMetrics){for(oi=0;oi<ei.length;oi++)Ht(ei[oi],Zt=[],ai,!1),dt.push(Ce(ri,"LineString",Zt,wt.properties));return}hi(ei,Zt,ai,!1)}else if("Polygon"===si)hi(ei,Zt,ai,!0);else{if("MultiPolygon"!==si){if("GeometryCollection"===si){for(oi=0;oi<wt.geometry.geometries.length;oi++)ut(dt,{id:ri,geometry:wt.geometry.geometries[oi],properties:wt.properties},Vt,st);return}throw new Error("Input data is not a valid GeoJSON object.")}for(oi=0;oi<ei.length;oi++){var sn=[];hi(ei[oi],sn,ai,!0),Zt.push(sn)}}dt.push(Ce(ri,si,Zt,wt.properties))}}function bt(dt,wt){wt.push(gt(dt[0])),wt.push(Ni(dt[1])),wt.push(0)}function Ht(dt,wt,Vt,st){for(var ei,si,ai=0,Zt=0;Zt<dt.length;Zt++){var ri=gt(dt[Zt][0]),oi=Ni(dt[Zt][1]);wt.push(ri),wt.push(oi),wt.push(0),Zt>0&&(ai+=st?(ei*oi-ri*si)/2:Math.sqrt(Math.pow(ri-ei,2)+Math.pow(oi-si,2))),ei=ri,si=oi}var sn=wt.length-3;wt[2]=1,lt(wt,0,sn,Vt),wt[sn+2]=1,wt.size=Math.abs(ai),wt.start=0,wt.end=wt.size}function hi(dt,wt,Vt,st){for(var ei=0;ei<dt.length;ei++){var si=[];Ht(dt[ei],si,Vt,st),wt.push(si)}}function gt(dt){return dt/360+.5}function Ni(dt){var wt=Math.sin(dt*Math.PI/180),Vt=.5-.25*Math.log((1+wt)/(1-wt))/Math.PI;return Vt<0?0:Vt>1?1:Vt}function wi(dt,wt,Vt,st,ei,si,ai,Zt){if(st/=wt,si>=(Vt/=wt)&&ai<st)return dt;if(ai<Vt||si>=st)return null;for(var ri=[],oi=0;oi<dt.length;oi++){var sn=dt[oi],Zn=sn.geometry,zi=sn.type,Kr=0===ei?sn.minX:sn.minY,hr=0===ei?sn.maxX:sn.maxY;if(Kr>=Vt&&hr<st)ri.push(sn);else if(!(hr<Vt||Kr>=st)){var Qr=[];if("Point"===zi||"MultiPoint"===zi)$i(Zn,Qr,Vt,st,ei);else if("LineString"===zi)jn(Zn,Qr,Vt,st,ei,!1,Zt.lineMetrics);else if("MultiLineString"===zi)_o(Zn,Qr,Vt,st,ei,!1);else if("Polygon"===zi)_o(Zn,Qr,Vt,st,ei,!0);else if("MultiPolygon"===zi)for(var ho=0;ho<Zn.length;ho++){var bo=[];_o(Zn[ho],bo,Vt,st,ei,!0),bo.length&&Qr.push(bo)}if(Qr.length){if(Zt.lineMetrics&&"LineString"===zi){for(ho=0;ho<Qr.length;ho++)ri.push(Ce(sn.id,zi,Qr[ho],sn.tags));continue}"LineString"!==zi&&"MultiLineString"!==zi||(1===Qr.length?(zi="LineString",Qr=Qr[0]):zi="MultiLineString"),"Point"!==zi&&"MultiPoint"!==zi||(zi=3===Qr.length?"Point":"MultiPoint"),ri.push(Ce(sn.id,zi,Qr,sn.tags))}}}return ri.length?ri:null}function $i(dt,wt,Vt,st,ei){for(var si=0;si<dt.length;si+=3){var ai=dt[si+ei];ai>=Vt&&ai<=st&&(wt.push(dt[si]),wt.push(dt[si+1]),wt.push(dt[si+2]))}}function jn(dt,wt,Vt,st,ei,si,ai){for(var Zt,ri,oi=eo(dt),sn=0===ei?Tr:cr,Zn=dt.start,zi=0;zi<dt.length-3;zi+=3){var Kr=dt[zi],hr=dt[zi+1],Qr=dt[zi+2],ho=dt[zi+3],bo=dt[zi+4],ir=0===ei?Kr:hr,Ss=0===ei?ho:bo,$s=!1;ai&&(Zt=Math.sqrt(Math.pow(Kr-ho,2)+Math.pow(hr-bo,2))),ir<Vt?Ss>Vt&&(ri=sn(oi,Kr,hr,ho,bo,Vt),ai&&(oi.start=Zn+Zt*ri)):ir>st?Ss<st&&(ri=sn(oi,Kr,hr,ho,bo,st),ai&&(oi.start=Zn+Zt*ri)):Pn(oi,Kr,hr,Qr),Ss<Vt&&ir>=Vt&&(ri=sn(oi,Kr,hr,ho,bo,Vt),$s=!0),Ss>st&&ir<=st&&(ri=sn(oi,Kr,hr,ho,bo,st),$s=!0),!si&&$s&&(ai&&(oi.end=Zn+Zt*ri),wt.push(oi),oi=eo(dt)),ai&&(Zn+=Zt)}var nr=dt.length-3;Kr=dt[nr],hr=dt[nr+1],Qr=dt[nr+2],(ir=0===ei?Kr:hr)>=Vt&&ir<=st&&Pn(oi,Kr,hr,Qr),nr=oi.length-3,si&&nr>=3&&(oi[nr]!==oi[0]||oi[nr+1]!==oi[1])&&Pn(oi,oi[0],oi[1],oi[2]),oi.length&&wt.push(oi)}function eo(dt){var wt=[];return wt.size=dt.size,wt.start=dt.start,wt.end=dt.end,wt}function _o(dt,wt,Vt,st,ei,si){for(var ai=0;ai<dt.length;ai++)jn(dt[ai],wt,Vt,st,ei,si,!1)}function Pn(dt,wt,Vt,st){dt.push(wt),dt.push(Vt),dt.push(st)}function Tr(dt,wt,Vt,st,ei,si){var ai=(si-wt)/(st-wt);return dt.push(si),dt.push(Vt+(ei-Vt)*ai),dt.push(1),ai}function cr(dt,wt,Vt,st,ei,si){var ai=(si-Vt)/(ei-Vt);return dt.push(wt+(st-wt)*ai),dt.push(si),dt.push(1),ai}function kn(dt,wt){for(var Vt=[],st=0;st<dt.length;st++){var ei,si=dt[st],ai=si.type;if("Point"===ai||"MultiPoint"===ai||"LineString"===ai)ei=Xr(si.geometry,wt);else if("MultiLineString"===ai||"Polygon"===ai){ei=[];for(var Zt=0;Zt<si.geometry.length;Zt++)ei.push(Xr(si.geometry[Zt],wt))}else if("MultiPolygon"===ai)for(ei=[],Zt=0;Zt<si.geometry.length;Zt++){for(var ri=[],oi=0;oi<si.geometry[Zt].length;oi++)ri.push(Xr(si.geometry[Zt][oi],wt));ei.push(ri)}Vt.push(Ce(si.id,ai,ei,si.tags))}return Vt}function Xr(dt,wt){var Vt=[];Vt.size=dt.size,void 0!==dt.start&&(Vt.start=dt.start,Vt.end=dt.end);for(var st=0;st<dt.length;st+=3)Vt.push(dt[st]+wt,dt[st+1],dt[st+2]);return Vt}function gi(dt,wt){if(dt.transformed)return dt;var Vt,st,ei,si=1<<dt.z,ai=dt.x,Zt=dt.y;for(Vt=0;Vt<dt.features.length;Vt++){var ri=dt.features[Vt],oi=ri.geometry,sn=ri.type;if(ri.geometry=[],1===sn)for(st=0;st<oi.length;st+=2)ri.geometry.push(di(oi[st],oi[st+1],wt,si,ai,Zt));else for(st=0;st<oi.length;st++){var Zn=[];for(ei=0;ei<oi[st].length;ei+=2)Zn.push(di(oi[st][ei],oi[st][ei+1],wt,si,ai,Zt));ri.geometry.push(Zn)}}return dt.transformed=!0,dt}function di(dt,wt,Vt,st,ei,si){return[Math.round(Vt*(dt*st-ei)),Math.round(Vt*(wt*st-si))]}function ro(dt,wt,Vt,st,ei){for(var si=wt===ei.maxZoom?0:ei.tolerance/((1<<wt)*ei.extent),ai={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Vt,y:st,z:wt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Zt=0;Zt<dt.length;Zt++){ai.numFeatures++,Hs(ai,dt[Zt],si,ei);var ri=dt[Zt].minX,oi=dt[Zt].minY,sn=dt[Zt].maxX,Zn=dt[Zt].maxY;ri<ai.minX&&(ai.minX=ri),oi<ai.minY&&(ai.minY=oi),sn>ai.maxX&&(ai.maxX=sn),Zn>ai.maxY&&(ai.maxY=Zn)}return ai}function Hs(dt,wt,Vt,st){var ei=wt.geometry,si=wt.type,ai=[];if("Point"===si||"MultiPoint"===si)for(var Zt=0;Zt<ei.length;Zt+=3)ai.push(ei[Zt]),ai.push(ei[Zt+1]),dt.numPoints++,dt.numSimplified++;else if("LineString"===si)ca(ai,ei,dt,Vt,!1,!1);else if("MultiLineString"===si||"Polygon"===si)for(Zt=0;Zt<ei.length;Zt++)ca(ai,ei[Zt],dt,Vt,"Polygon"===si,0===Zt);else if("MultiPolygon"===si)for(var ri=0;ri<ei.length;ri++){var oi=ei[ri];for(Zt=0;Zt<oi.length;Zt++)ca(ai,oi[Zt],dt,Vt,!0,0===Zt)}if(ai.length){var sn=wt.tags||null;if("LineString"===si&&st.lineMetrics){for(var Zn in sn={},wt.tags)sn[Zn]=wt.tags[Zn];sn.mapbox_clip_start=ei.start/ei.size,sn.mapbox_clip_end=ei.end/ei.size}var zi={geometry:ai,type:"Polygon"===si||"MultiPolygon"===si?3:"LineString"===si||"MultiLineString"===si?2:1,tags:sn};null!==wt.id&&(zi.id=wt.id),dt.features.push(zi)}}function ca(dt,wt,Vt,st,ei,si){var ai=st*st;if(st>0&&wt.size<(ei?ai:st))Vt.numPoints+=wt.length/3;else{for(var Zt=[],ri=0;ri<wt.length;ri+=3)(0===st||wt[ri+2]>ai)&&(Vt.numSimplified++,Zt.push(wt[ri]),Zt.push(wt[ri+1])),Vt.numPoints++;ei&&function(oi,sn){for(var Zn=0,zi=0,Kr=oi.length,hr=Kr-2;zi<Kr;hr=zi,zi+=2)Zn+=(oi[zi]-oi[hr])*(oi[zi+1]+oi[hr+1]);if(Zn>0===sn)for(zi=0,Kr=oi.length;zi<Kr/2;zi+=2){var Qr=oi[zi],ho=oi[zi+1];oi[zi]=oi[Kr-2-zi],oi[zi+1]=oi[Kr-1-zi],oi[Kr-2-zi]=Qr,oi[Kr-1-zi]=ho}}(Zt,si),dt.push(Zt)}}function ls(dt,wt){var Vt=(wt=this.options=function(ei,si){for(var ai in si)ei[ai]=si[ai];return ei}(Object.create(this.options),wt)).debug;if(Vt&&console.time("preprocess data"),wt.maxZoom<0||wt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(wt.promoteId&&wt.generateId)throw new Error("promoteId and generateId cannot be used together.");var ei,si,ai,Zt,ri,oi,st=function(ei,si){var ai=[];if("FeatureCollection"===ei.type)for(var Zt=0;Zt<ei.features.length;Zt++)ut(ai,ei.features[Zt],si,Zt);else ut(ai,"Feature"===ei.type?ei:{geometry:ei},si);return ai}(dt,wt);this.tiles={},this.tileCoords=[],Vt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",wt.indexMaxZoom,wt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ei=st,si=wt,ai=si.buffer/si.extent,Zt=ei,ri=wi(ei,1,-1-ai,ai,0,-1,2,si),oi=wi(ei,1,1-ai,2+ai,0,-1,2,si),(ri||oi)&&(Zt=wi(ei,1,-ai,1+ai,0,-1,2,si)||[],ri&&(Zt=kn(ri,1).concat(Zt)),oi&&(Zt=Zt.concat(kn(oi,-1)))),st=Zt).length&&this.splitTile(st,0,0,0),Vt&&(st.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Yo(dt,wt,Vt){return 32*((1<<dt)*Vt+wt)+dt}return ls.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ls.prototype.splitTile=function(dt,wt,Vt,st,ei,si,ai){for(var Zt=[dt,wt,Vt,st],ri=this.options,oi=ri.debug;Zt.length;){st=Zt.pop(),Vt=Zt.pop(),wt=Zt.pop(),dt=Zt.pop();var sn=1<<wt,Zn=Yo(wt,Vt,st),zi=this.tiles[Zn];if(!zi&&(oi>1&&console.time("creation"),zi=this.tiles[Zn]=ro(dt,wt,Vt,st,ri),this.tileCoords.push({z:wt,x:Vt,y:st}),oi)){oi>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",wt,Vt,st,zi.numFeatures,zi.numPoints,zi.numSimplified),console.timeEnd("creation"));var Kr="z"+wt;this.stats[Kr]=(this.stats[Kr]||0)+1,this.total++}if(zi.source=dt,ei){if(wt===ri.maxZoom||wt===ei)continue;var hr=1<<ei-wt;if(Vt!==Math.floor(si/hr)||st!==Math.floor(ai/hr))continue}else if(wt===ri.indexMaxZoom||zi.numPoints<=ri.indexMaxPoints)continue;if(zi.source=null,0!==dt.length){oi>1&&console.time("clipping");var Qr,ho,bo,ir,Ss,$s,nr=.5*ri.buffer/ri.extent,gh=.5-nr,Ka=.5+nr,On=1+nr;Qr=ho=bo=ir=null,Ss=wi(dt,sn,Vt-nr,Vt+Ka,0,zi.minX,zi.maxX,ri),$s=wi(dt,sn,Vt+gh,Vt+On,0,zi.minX,zi.maxX,ri),dt=null,Ss&&(Qr=wi(Ss,sn,st-nr,st+Ka,1,zi.minY,zi.maxY,ri),ho=wi(Ss,sn,st+gh,st+On,1,zi.minY,zi.maxY,ri),Ss=null),$s&&(bo=wi($s,sn,st-nr,st+Ka,1,zi.minY,zi.maxY,ri),ir=wi($s,sn,st+gh,st+On,1,zi.minY,zi.maxY,ri),$s=null),oi>1&&console.timeEnd("clipping"),Zt.push(Qr||[],wt+1,2*Vt,2*st),Zt.push(ho||[],wt+1,2*Vt,2*st+1),Zt.push(bo||[],wt+1,2*Vt+1,2*st),Zt.push(ir||[],wt+1,2*Vt+1,2*st+1)}}},ls.prototype.getTile=function(dt,wt,Vt){var st=this.options,ei=st.extent,si=st.debug;if(dt<0||dt>24)return null;var ai=1<<dt,Zt=Yo(dt,wt=(wt%ai+ai)%ai,Vt);if(this.tiles[Zt])return gi(this.tiles[Zt],ei);si>1&&console.log("drilling down to z%d-%d-%d",dt,wt,Vt);for(var ri,oi=dt,sn=wt,Zn=Vt;!ri&&oi>0;)oi--,sn=Math.floor(sn/2),Zn=Math.floor(Zn/2),ri=this.tiles[Yo(oi,sn,Zn)];return ri&&ri.source?(si>1&&console.log("found parent tile z%d-%d-%d",oi,sn,Zn),si>1&&console.time("drilling down"),this.splitTile(ri.source,oi,sn,Zn,dt,wt,Vt),si>1&&console.timeEnd("drilling down"),this.tiles[Zt]?gi(this.tiles[Zt],ei):null):null},function(dt,wt){return new ls(dt,wt)}}();var pi=_.dK(Bt.exports);function pn(lt,ve){const Ce=lt.tileID.canonical;if(!this._geoJSONIndex)return ve(null,null);const He=this._geoJSONIndex.getTile(Ce.z,Ce.x,Ce.y);if(!He)return ve(null,null);const ut=new mt(He.features);let bt=ta(ut);0===bt.byteOffset&&bt.byteLength===bt.buffer.byteLength||(bt=new Uint8Array(bt)),ve(null,{vectorTile:ut,rawData:bt.buffer})}class Pr extends er{constructor(ve,Ce,He,ut,bt,Ht){super(ve,Ce,He,ut,pn,Ht),bt&&(this.loadGeoJSON=bt)}loadData(ve,Ce){const He=ve&&ve.request,ut=He&&He.collectResourceTiming;this.loadGeoJSON(ve,(bt,Ht)=>{if(bt||!Ht)return Ce(bt);if("object"!=typeof Ht)return Ce(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`));{Di(Ht,!0);try{if(ve.filter){const gt=_.r(ve.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===gt.result)throw new Error(gt.value.map(wi=>`${wi.key}: ${wi.message}`).join(", "));Ht={type:"FeatureCollection",features:Ht.features.filter(wi=>gt.value.evaluate({zoom:0},wi))}}this._geoJSONIndex=ve.cluster?new Ge(function({superclusterOptions:gt,clusterProperties:Ni}){if(!Ni||!gt)return gt;const wi={},$i={},jn={accumulated:null,zoom:0},eo={properties:null},_o=Object.keys(Ni);for(const Pn of _o){const[Tr,cr]=Ni[Pn],kn=_.r(cr),Xr=_.r("string"==typeof Tr?[Tr,["accumulated"],["get",Pn]]:Tr);wi[Pn]=kn.value,$i[Pn]=Xr.value}return gt.map=Pn=>{eo.properties=Pn;const Tr={};for(const cr of _o)Tr[cr]=wi[cr].evaluate(jn,eo);return Tr},gt.reduce=(Pn,Tr)=>{eo.properties=Tr;for(const cr of _o)jn.accumulated=Pn[cr],Pn[cr]=$i[cr].evaluate(jn,eo)},gt}(ve)).load(Ht.features):pi(Ht,ve.geojsonVtOptions)}catch(gt){return Ce(gt)}this.loaded={};const hi={};if(ut){const gt=Tt(He);gt&&(hi.resourceTiming={},hi.resourceTiming[ve.source]=JSON.parse(JSON.stringify(gt)))}Ce(null,hi)}})}reloadTile(ve,Ce){const He=this.loaded;return He&&He[ve.uid]?super.reloadTile(ve,Ce):this.loadTile(ve,Ce)}loadGeoJSON(ve,Ce){if(ve.request)_.g(ve.request,Ce);else{if("string"!=typeof ve.data)return Ce(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`));try{return Ce(null,JSON.parse(ve.data))}catch{return Ce(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ve,Ce){try{Ce(null,this._geoJSONIndex.getClusterExpansionZoom(ve.clusterId))}catch(He){Ce(He)}}getClusterChildren(ve,Ce){try{Ce(null,this._geoJSONIndex.getChildren(ve.clusterId))}catch(He){Ce(He)}}getClusterLeaves(ve,Ce){try{Ce(null,this._geoJSONIndex.getLeaves(ve.clusterId,ve.limit,ve.offset))}catch(He){Ce(He)}}}class br{constructor(ve,Ce){this.tileID=new _.am(ve.tileID.overscaledZ,ve.tileID.wrap,ve.tileID.canonical.z,ve.tileID.canonical.x,ve.tileID.canonical.y),this.tileZoom=ve.tileZoom,this.uid=ve.uid,this.zoom=ve.zoom,this.canonical=ve.tileID.canonical,this.pixelRatio=ve.pixelRatio,this.tileSize=ve.tileSize,this.source=ve.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ve.projection,this.brightness=Ce}parse(ve,Ce,He,ut){this.status="parsing";const bt=new _.am(He.tileID.overscaledZ,He.tileID.wrap,He.tileID.canonical.z,He.tileID.canonical.x,He.tileID.canonical.y),Ht={},hi=Ce.familiesBySource[He.source],gt=new _.dC(bt,He.promoteId);return gt.bucketLayerIDs=[],gt.is3DTile=!0,_.dP(ve).then(Ni=>{if(!Ni)return ut(new Error("Could not parse tile"));const wi=_.dQ(Ni,1/_.bR(He.tileID.canonical)),$i=Ni.json.extensionsUsed&&Ni.json.extensionsUsed.includes("MAPBOX_mesh_features")||Ni.json.asset.extras&&Ni.json.asset.extras.MAPBOX_mesh_features,jn=Ni.json.extensionsUsed&&Ni.json.extensionsUsed.includes("EXT_meshopt_compression"),eo=new _.K(this.zoom,{brightness:this.brightness});for(const _o in hi)for(const Pn of hi[_o]){const Tr=Pn[0];gt.bucketLayerIDs.push(Pn.map(kn=>kn.id)),Tr.recalculate(eo,[]);const cr=new _.dR(wi,bt,$i,jn,this.brightness,gt);$i||(cr.needsUpload=!0),Ht[Tr.fqid]=cr,cr.evaluate(Tr)}this.status="done",ut(null,{buckets:Ht,featureIndex:gt})}).catch(Ni=>ut(new Error(Ni.message)))}}class Ho{constructor(ve,Ce,He,ut,bt,Ht){this.actor=ve,this.layerIndex=Ce,this.brightness=Ht,this.loading={},this.loaded={}}loadTile(ve,Ce){const He=ve.uid,ut=this.loading[He]=new br(ve,this.brightness);_.a_(ve.request,(bt,Ht)=>{const hi=!this.loading[He];return delete this.loading[He],hi||bt?(ut.status="done",hi||(this.loaded[He]=ut),Ce(bt)):Ht&&0!==Ht.byteLength?void ut.parse(Ht,this.layerIndex,ve,(gt,Ni)=>{ut.status="done",this.loaded=this.loaded||{},this.loaded[He]=ut,gt||!Ni?Ce(gt):Ce(null,Ni)}):(ut.status="done",this.loaded[He]=ut,Ce())})}reloadTile(ve,Ce){const He=this.loaded,ut=ve.uid;if(He&&He[ut]){const bt=He[ut];bt.projection=ve.projection,bt.brightness=ve.brightness;const Ht=(hi,gt)=>{bt.reloadCallback&&(delete bt.reloadCallback,this.loadTile(ve,Ce)),Ce(hi,gt)};"parsing"===bt.status?bt.reloadCallback=Ht:"done"===bt.status&&this.loadTile(ve,Ce)}}abortTile(ve,Ce){const He=ve.uid;this.loading[He]&&delete this.loading[He],Ce()}removeTile(ve,Ce){const He=this.loaded,ut=ve.uid;He&&He[ut]&&delete He[ut],Ce()}}class qo{constructor(ve){this.self=ve,this.actor=new _.dS(ve,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=_.bo({name:"mercator"}),this.workerSourceTypes={vector:er,geojson:Pr,"batched-model":Ho},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Ce,He)=>{if(this.workerSourceTypes[Ce])throw new Error(`Worker source with name "${Ce}" already registered.`);this.workerSourceTypes[Ce]=He},this.self.registerRTLTextPlugin=Ce=>{if(_.dT.isParsed())throw new Error("RTL text plugin already registered.");_.dT.applyArabicShaping=Ce.applyArabicShaping,_.dT.processBidirectionalText=Ce.processBidirectionalText,_.dT.processStyledBidirectionalText=Ce.processStyledBidirectionalText}}clearCaches(ve,Ce,He){delete this.layerIndexes[ve],delete this.availableImages[ve],delete this.workerSources[ve],delete this.demWorkerSources[ve],delete this.rasterArrayWorkerSource,He()}checkIfReady(ve,Ce,He){He()}setReferrer(ve,Ce){this.referrer=Ce}spriteLoaded(ve,{scope:Ce,isLoaded:He}){if(this.isSpriteLoaded[ve]||(this.isSpriteLoaded[ve]={}),this.isSpriteLoaded[ve][Ce]=He,this.workerSources[ve]&&this.workerSources[ve][Ce])for(const ut in this.workerSources[ve][Ce]){const bt=this.workerSources[ve][Ce][ut];for(const Ht in bt)bt[Ht]instanceof er&&(bt[Ht].isSpriteLoaded=He,bt[Ht].fire(new _.b("isSpriteLoaded")))}}setImages(ve,{scope:Ce,images:He},ut){if(this.availableImages[ve]||(this.availableImages[ve]={}),this.availableImages[ve][Ce]=He,this.workerSources[ve]&&this.workerSources[ve][Ce]){for(const bt in this.workerSources[ve][Ce]){const Ht=this.workerSources[ve][Ce][bt];for(const hi in Ht)Ht[hi].availableImages=He}ut()}else ut()}setProjection(ve,Ce){this.projections[ve]=_.bo(Ce)}setBrightness(ve,Ce,He){this.brightness=Ce,He()}setLayers(ve,Ce,He){this.getLayerIndex(ve,Ce.scope).replace(Ce.layers,Ce.options),He()}updateLayers(ve,Ce,He){this.getLayerIndex(ve,Ce.scope).update(Ce.layers,Ce.removedIds,Ce.options),He()}loadTile(ve,Ce,He){Ce.projection=this.projections[ve]||this.defaultProjection,this.getWorkerSource(ve,Ce.type,Ce.source,Ce.scope).loadTile(Ce,He)}loadDEMTile(ve,Ce,He){this.getDEMWorkerSource(ve,Ce.source,Ce.scope).loadTile(Ce,He)}decodeRasterArray(ve,Ce,He){this.getRasterArrayWorkerSource().decodeRasterArray(Ce,He)}reloadTile(ve,Ce,He){Ce.projection=this.projections[ve]||this.defaultProjection,this.getWorkerSource(ve,Ce.type,Ce.source,Ce.scope).reloadTile(Ce,He)}abortTile(ve,Ce,He){this.getWorkerSource(ve,Ce.type,Ce.source,Ce.scope).abortTile(Ce,He)}removeTile(ve,Ce,He){this.getWorkerSource(ve,Ce.type,Ce.source,Ce.scope).removeTile(Ce,He)}removeSource(ve,Ce,He){if(!(this.workerSources[ve]&&this.workerSources[ve][Ce.scope]&&this.workerSources[ve][Ce.scope][Ce.type]&&this.workerSources[ve][Ce.scope][Ce.type][Ce.source]))return;const ut=this.workerSources[ve][Ce.scope][Ce.type][Ce.source];delete this.workerSources[ve][Ce.scope][Ce.type][Ce.source],void 0!==ut.removeSource?ut.removeSource(Ce,He):He()}loadWorkerSource(ve,Ce,He){try{this.self.importScripts(Ce.url),He()}catch(ut){He(ut.toString())}}syncRTLPluginState(ve,Ce,He){try{_.dT.setState(Ce);const ut=_.dT.getPluginURL();if(_.dT.isLoaded()&&!_.dT.isParsed()&&null!=ut){this.self.importScripts(ut);const bt=_.dT.isParsed();He(bt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ut}`),bt)}}catch(ut){He(ut.toString())}}setDracoUrl(ve,Ce){this.dracoUrl=Ce}getAvailableImages(ve,Ce){this.availableImages[ve]||(this.availableImages[ve]={});let He=this.availableImages[ve][Ce];return He||(He=[]),He}getLayerIndex(ve,Ce){this.layerIndexes[ve]||(this.layerIndexes[ve]={});let He=this.layerIndexes[ve][Ce];return He||(He=this.layerIndexes[ve][Ce]=new Ar,He.scope=Ce),He}getWorkerSource(ve,Ce,He,ut){return this.workerSources[ve]||(this.workerSources[ve]={}),this.workerSources[ve][ut]||(this.workerSources[ve][ut]={}),this.workerSources[ve][ut][Ce]||(this.workerSources[ve][ut][Ce]={}),this.isSpriteLoaded[ve]||(this.isSpriteLoaded[ve]={}),this.workerSources[ve][ut][Ce][He]||(this.workerSources[ve][ut][Ce][He]=new this.workerSourceTypes[Ce]({send:(Ht,hi,gt,Ni,wi,$i)=>{this.actor.send(Ht,hi,gt,ve,wi,$i)},scheduler:this.actor.scheduler},this.getLayerIndex(ve,ut),this.getAvailableImages(ve,ut),this.isSpriteLoaded[ve][ut],void 0,this.brightness)),this.workerSources[ve][ut][Ce][He]}getDEMWorkerSource(ve,Ce,He){return this.demWorkerSources[ve]||(this.demWorkerSources[ve]={}),this.demWorkerSources[ve][He]||(this.demWorkerSources[ve][He]={}),this.demWorkerSources[ve][He][Ce]||(this.demWorkerSources[ve][He][Ce]=new ji),this.demWorkerSources[ve][He][Ce]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new un),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ve,Ce){_.dU(Ce)}getWorkerPerformanceMetrics(ve,Ce,He){He(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new qo(self)),qo}),Yt(0,function(_){function Tt(x,u){if(Array.isArray(x)){if(!Array.isArray(u)||x.length!==u.length)return!1;for(let g=0;g<x.length;g++)if(!Tt(x[g],u[g]))return!1;return!0}if("object"==typeof x&&null!==x&&null!==u){if("object"!=typeof u||Object.keys(x).length!==Object.keys(u).length)return!1;for(const g in x)if(!Tt(x[g],u[g]))return!1;return!0}return x===u}var Si=Ri;function Ri(x){return u=x,!(typeof window>"u"||typeof document>"u"||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,S,D=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(D);try{S=new Worker(P),w=!0}catch{w=!1}return S&&S.terminate(),URL.revokeObjectURL(P),w}()||!function(){var w=document.createElement("canvas");w.width=w.height=1;var S=w.getContext("2d");if(!S)return!1;var D=S.getImageData(0,0,1,1);return D&&D.width===w.width}()||(void 0===Ar[g=u&&u.failIfMajorPerformanceCaveat]&&(Ar[g]=function(w){var S,P,F,U,D=(P=w,F=document.createElement("canvas"),(U=Object.create(Ri.webGLContextAttributes)).failIfMajorPerformanceCaveat=P,F.getContext("webgl2",U));if(!D)return!1;try{S=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!S||D.isContextLost())&&(D.shaderSource(S,"void main() {}"),D.compileShader(S),!0===D.getShaderParameter(S,D.COMPILE_STATUS))}(g)),!Ar[g]||document.documentMode));var u,g}var Ar={};function Kt(x,u,g){const w=document.createElement(x);return null!=u&&(w.className=u),g&&g.appendChild(w),w}function ui(x,u,g){const w=document.createElementNS("http://www.w3.org/2000/svg",x);for(const S of Object.keys(u))w.setAttributeNS(null,S,String(u[S]));return g&&g.appendChild(w),w}Ri.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Ft=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Li=Ft&&void 0!==Ft.userSelect?"userSelect":"WebkitUserSelect";let er;function ji(){Ft&&Li&&(er=Ft[Li],Ft[Li]="none")}function un(){Ft&&Li&&(Ft[Li]=er)}function tr(x){x.preventDefault(),x.stopPropagation(),window.removeEventListener("click",tr,!0)}function bi(){window.addEventListener("click",tr,!0),window.setTimeout(()=>{window.removeEventListener("click",tr,!0)},0)}function Di(x,u){const g=x.getBoundingClientRect();return mt(x,g,u)}function ki(x,u){const g=x.getBoundingClientRect(),w=[];for(let S=0;S<u.length;S++)w.push(mt(x,g,u[S]));return w}function Ki(x){return void 0!==window.InstallTrigger&&2===x.button&&x.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:x.button}function mt(x,u,g){const w=x.offsetWidth===u.width?1:x.offsetWidth/u.width;return new _.P((g.clientX-u.left)*w,(g.clientY-u.top)*w)}class yi{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(u,g){this._updatedSourceCaches[u]=g,this.setDirty()}discardSourceCacheUpdate(u){delete this._updatedSourceCaches[u]}updateLayer(u){const g=u.scope;this._updatedLayers[g]=this._updatedLayers[g]||new Set,this._updatedLayers[g].add(u.id),this.setDirty()}removeLayer(u){const g=u.scope;this._removedLayers[g]=this._removedLayers[g]||{},this._updatedLayers[g]=this._updatedLayers[g]||new Set,this._removedLayers[g][u.id]=u,this._updatedLayers[g].delete(u.id),this._updatedPaintProps.delete(u.fqid),this.setDirty()}getRemovedLayer(u){return this._removedLayers[u.scope]?this._removedLayers[u.scope][u.id]:null}discardLayerRemoval(u){this._removedLayers[u.scope]&&delete this._removedLayers[u.scope][u.id]}getLayerUpdatesByScope(){const u={};for(const g in this._updatedLayers)u[g]=u[g]||{},u[g].updatedIds=Array.from(this._updatedLayers[g].values());for(const g in this._removedLayers)u[g]=u[g]||{},u[g].removedIds=Object.keys(this._removedLayers[g]);return u}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(u){this._updatedPaintProps.add(u.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(u){this._updatedImages.add(u),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}class en extends _.E{constructor(u){super(),this.requestManager=u,this.models={"":{}},this.numModelsLoading={}}loadModel(u,g){return _.l(this.requestManager.transformRequest(g,_.R.Model).url).then(w=>{if(!w)return;const S=_.c(w),D=new _.M(u,void 0,void 0,S);return D.computeBoundsAndApplyParent(),D}).catch(w=>{this.fire(new _.a(new Error(`Could not load model ${u} from ${g}: ${w.message}`)))})}load(u,g){this.models[g]||(this.models[g]={});const w=Object.keys(u);this.numModelsLoading[g]=(this.numModelsLoading[g]||0)+w.length;const S=[];for(const D of w)S.push(this.loadModel(D,u[D]));Promise.allSettled(S).then(D=>{for(let P=0;P<D.length;P++){const{status:F,value:U}=D[P];"fulfilled"===F&&U&&(this.models[g][w[P]]=U)}this.numModelsLoading[g]-=w.length,this.fire(new _.b("data",{dataType:"style"}))}).catch(D=>{this.fire(new _.a(new Error(`Could not load models: ${D.message}`)))})}isLoaded(){for(const u in this.numModelsLoading)if(this.numModelsLoading[u]>0)return!1;return!0}hasModel(u,g){return!!this.getModel(u,g)}getModel(u,g){return this.models[g]||(this.models[g]={}),this.models[g][u]}addModel(u,g,w){this.models[w]||(this.models[w]={}),this.hasModel(u,w)&&this.removeModel(u,w),this.load({[u]:this.requestManager.normalizeModelURL(g)},w)}addModels(u,g){const w={};for(const S in u)w[S]=this.requestManager.normalizeModelURL(u[S]);this.load(w,g)}removeModel(u,g){this.models[g]||(this.models[g]={});const w=this.models[g][u];delete this.models[g][u],w.destroy()}listModels(u){return this.models[u]||(this.models[u]={}),Object.keys(this.models[u])}upload(u,g){this.models[g]||(this.models[g]={});for(const w in this.models[g])this.models[g][w].upload(u.context)}}class mi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(u,g,w){const S=String(g);if(this.stateChanges[u]=this.stateChanges[u]||{},this.stateChanges[u][S]=this.stateChanges[u][S]||{},_.e(this.stateChanges[u][S],w),null===this.deletedStates[u]){this.deletedStates[u]={};for(const D in this.state[u])D!==S&&(this.deletedStates[u][D]=null)}else if(this.deletedStates[u]&&null===this.deletedStates[u][S]){this.deletedStates[u][S]={};for(const D in this.state[u][S])w[D]||(this.deletedStates[u][S][D]=null)}else for(const D in w)this.deletedStates[u]&&this.deletedStates[u][S]&&null===this.deletedStates[u][S][D]&&delete this.deletedStates[u][S][D]}removeFeatureState(u,g,w){if(null===this.deletedStates[u])return;const S=String(g);if(this.deletedStates[u]=this.deletedStates[u]||{},w&&void 0!==g)null!==this.deletedStates[u][S]&&(this.deletedStates[u][S]=this.deletedStates[u][S]||{},this.deletedStates[u][S][w]=null);else if(void 0!==g)if(this.stateChanges[u]&&this.stateChanges[u][S])for(w in this.deletedStates[u][S]={},this.stateChanges[u][S])this.deletedStates[u][S][w]=null;else this.deletedStates[u][S]=null;else this.deletedStates[u]=null}getState(u,g){const w=String(g),S=_.e({},(this.state[u]||{})[w],(this.stateChanges[u]||{})[w]);if(null===this.deletedStates[u])return{};if(this.deletedStates[u]){const D=this.deletedStates[u][g];if(null===D)return{};for(const P in D)delete S[P]}return S}initializeTileState(u,g){u.setFeatureState(this.state,g)}coalesceChanges(u,g){const w={};for(const S in this.stateChanges){this.state[S]=this.state[S]||{};const D={};for(const P in this.stateChanges[S])this.state[S][P]||(this.state[S][P]={}),_.e(this.state[S][P],this.stateChanges[S][P]),D[P]=this.state[S][P];w[S]=D}for(const S in this.deletedStates){this.state[S]=this.state[S]||{};const D={};if(null===this.deletedStates[S])for(const P in this.state[S])D[P]={},this.state[S][P]={};else for(const P in this.deletedStates[S]){if(null===this.deletedStates[S][P])this.state[S][P]={};else if(this.state[S][P])for(const F of Object.keys(this.deletedStates[S][P]))delete this.state[S][P][F];D[P]=this.state[S][P]}w[S]=w[S]||{},_.e(w[S],D)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(w).length)for(const S in u)u[S].setFeatureState(w,g)}}function Mn(x){const{userImage:u}=x;return!!(u&&u.render&&u.render())&&(x.data.replace(new Uint8Array(u.data.buffer)),!0)}class vn extends _.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(u){this.images[u]={},this.loaded[u]=!1,this.updatedImages[u]={},this.patterns[u]={},this.callbackDispatchedThisFrame[u]={},this.atlasImage[u]=new _.h({width:1,height:1})}isLoaded(){for(const u in this.loaded)if(!this.loaded[u])return!1;return!0}setLoaded(u,g){if(this.loaded[g]!==u&&(this.loaded[g]=u,u)){for(const{ids:w,callback:S}of this.requestors)this._notify(w,g,S);this.requestors=[]}}hasImage(u,g){return!!this.getImage(u,g)}getImage(u,g){return this.images[g][u]}addImage(u,g,w){this._validate(u,w)&&(this.images[g][u]=w)}_validate(u,g){let w=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new _.a(new Error(`Image "${u}" has invalid "stretchX" value`))),w=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new _.a(new Error(`Image "${u}" has invalid "stretchY" value`))),w=!1),this._validateContent(g.content,g)||(this.fire(new _.a(new Error(`Image "${u}" has invalid "content" value`))),w=!1),w}_validateStretch(u,g){if(!u)return!0;let w=0;for(const S of u){if(S[0]<w||S[1]<S[0]||g<S[1])return!1;w=S[1]}return!0}_validateContent(u,g){return!(u&&(4!==u.length||u[0]<0||g.data.width<u[0]||u[1]<0||g.data.height<u[1]||u[2]<0||g.data.width<u[2]||u[3]<0||g.data.height<u[3]||u[2]<u[0]||u[3]<u[1]))}updateImage(u,g,w){w.version=this.images[g][u].version+1,this.images[g][u]=w,this.updatedImages[g][u]=!0}removeImage(u,g){const w=this.images[g][u];delete this.images[g][u],delete this.patterns[g][u],w.userImage&&w.userImage.onRemove&&w.userImage.onRemove()}listImages(u){return Object.keys(this.images[u])}getImages(u,g,w){let S=!0;const D=!!this.loaded[g];if(!D)for(const P of u)this.images[g][P]||(S=!1);D||S?this._notify(u,g,w):this.requestors.push({ids:u,scope:g,callback:w})}getUpdatedImages(u){return this.updatedImages[u]}_notify(u,g,w){const S={};for(const D of u){this.images[g][D]||this.fire(new _.b("styleimagemissing",{id:D}));const P=this.images[g][D];P?S[D]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!(!P.userImage||!P.userImage.render)}:_.w(`Image "${D}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}w(null,S)}getPixelSize(u){const{width:g,height:w}=this.atlasImage[u];return{width:g,height:w}}getPattern(u,g){const w=this.patterns[g][u],S=this.getImage(u,g);if(!S)return null;if(w&&w.position.version===S.version)return w.position;if(w)w.position.version=S.version;else{const D={w:S.data.width+2,h:S.data.height+2,x:0,y:0},P=new _.I(D,S);this.patterns[g][u]={bin:D,position:P}}return this._updatePatternAtlas(g),this.patterns[g][u].position}bind(u,g){const w=u.gl;let S=this.atlasTexture[g];S?this.dirty&&(S.update(this.atlasImage[g]),this.dirty=!1):(S=new _.T(u,this.atlasImage[g],w.RGBA),this.atlasTexture[g]=S),S.bind(w.LINEAR,w.CLAMP_TO_EDGE)}_updatePatternAtlas(u){const g=[];for(const P in this.patterns[u])g.push(this.patterns[u][P].bin);const{w,h:S}=_.p(g),D=this.atlasImage[u];D.resize({width:w||1,height:S||1});for(const P in this.patterns[u]){const{bin:F}=this.patterns[u][P],U=F.x+1,H=F.y+1,X=this.images[u][P].data,K=X.width,ee=X.height;_.h.copy(X,D,{x:0,y:0},{x:U,y:H},{width:K,height:ee}),_.h.copy(X,D,{x:0,y:ee-1},{x:U,y:H-1},{width:K,height:1}),_.h.copy(X,D,{x:0,y:0},{x:U,y:H+ee},{width:K,height:1}),_.h.copy(X,D,{x:K-1,y:0},{x:U-1,y:H},{width:1,height:ee}),_.h.copy(X,D,{x:0,y:0},{x:U+K,y:H},{width:1,height:ee})}this.dirty=!0}beginFrame(){for(const u in this.images)this.callbackDispatchedThisFrame[u]={}}dispatchRenderCallbacks(u,g){for(const w of u){if(this.callbackDispatchedThisFrame[g][w])continue;this.callbackDispatchedThisFrame[g][w]=!0;const S=this.images[g][w];Mn(S)&&this.updateImage(w,g,S)}}}class St{constructor(u,g,w,S){this.message=(u?`${u}: `:"")+w,S&&(this.identifier=S),null!=g&&g.__line__&&(this.line=g.__line__)}}class Vn extends St{}function yn(x){const u=x.key,g=x.value,w=x.valueSpec||{},S=x.objectElementValidators||{},D=x.style,P=x.styleSpec;let F=[];const U=_.i(g);if("object"!==U)return[new St(u,g,`object expected, ${U} found`)];for(const H in g){const X=H.split(".")[0];let K;S[X]?K=S[X]:w[X]?K=pi:S["*"]?K=S["*"]:w["*"]&&(K=pi),K?F=F.concat(K({key:(u&&`${u}.`)+H,value:g[H],valueSpec:w[X]||w["*"],style:D,styleSpec:P,object:g,objectKey:H},g)):F.push(new Vn(u,g[H],`unknown property "${H}"`))}for(const H in w)S[H]||w[H].required&&void 0===w[H].default&&void 0===g[H]&&F.push(new St(u,g,`missing required property "${H}"`));return F}function Ii(x){const u=x.value,g=x.valueSpec,w=x.style,S=x.styleSpec,D=x.key,P=x.arrayElementValidator||pi;if("array"!==_.i(u))return[new St(D,u,`array expected, ${_.i(u)} found`)];if(g.length&&u.length!==g.length)return[new St(D,u,`array length ${g.length} expected, length ${u.length} found`)];if(g["min-length"]&&u.length<g["min-length"])return[new St(D,u,`array length at least ${g["min-length"]} expected, length ${u.length} found`)];let F={type:g.value,values:g.values,minimum:g.minimum,maximum:g.maximum,function:void 0};S.$version<7&&(F.function=g.function),"object"===_.i(g.value)&&(F=g.value);let U=[];for(let H=0;H<u.length;H++)U=U.concat(P({array:u,arrayIndex:H,value:u[H],valueSpec:F,style:w,styleSpec:S,key:`${D}[${H}]`},!0));return U}function an(x){const u=x.key,g=x.value,w=x.valueSpec;let S=_.i(g);if("number"===S&&g!=g&&(S="NaN"),"number"!==S)return[new St(u,g,`number expected, ${S} found`)];if("minimum"in w){let D=w.minimum;if("array"===_.i(w.minimum)&&(D=w.minimum[x.arrayIndex]),g<D)return[new St(u,g,`${g} is less than the minimum value ${D}`)]}if("maximum"in w){let D=w.maximum;if("array"===_.i(w.maximum)&&(D=w.maximum[x.arrayIndex]),g>D)return[new St(u,g,`${g} is greater than the maximum value ${D}`)]}return[]}function Vr(x){const u=x.valueSpec,g=_.u(x.value.type);let w,S,D,P={};const F="categorical"!==g&&void 0===x.value.property,U=!F,H="array"===_.i(x.value.stops)&&"array"===_.i(x.value.stops[0])&&"object"===_.i(x.value.stops[0][0]),X=yn({key:x.key,value:x.value,valueSpec:x.styleSpec.function,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{stops:function(ie){if("identity"===g)return[new St(ie.key,ie.value,'identity function may not have a "stops" property')];let ae=[];const ce=ie.value;return ae=ae.concat(Ii({key:ie.key,value:ce,valueSpec:ie.valueSpec,style:ie.style,styleSpec:ie.styleSpec,arrayElementValidator:K})),"array"===_.i(ce)&&0===ce.length&&ae.push(new St(ie.key,ce,"array must have at least one stop")),ae},default:function(ie){return pi({key:ie.key,value:ie.value,valueSpec:u,style:ie.style,styleSpec:ie.styleSpec})}}});return"identity"===g&&F&&X.push(new St(x.key,x.value,'missing required property "property"')),"identity"===g||x.value.stops||X.push(new St(x.key,x.value,'missing required property "stops"')),"exponential"===g&&x.valueSpec.expression&&!_.s(x.valueSpec)&&X.push(new St(x.key,x.value,"exponential functions not supported")),x.styleSpec.$version>=8&&(U&&!_.k(x.valueSpec)?X.push(new St(x.key,x.value,"property functions not supported")):F&&!_.m(x.valueSpec)&&X.push(new St(x.key,x.value,"zoom functions not supported"))),"categorical"!==g&&!H||void 0!==x.value.property||X.push(new St(x.key,x.value,'"property" property is required')),X;function K(ie){let ae=[];const ce=ie.value,me=ie.key;if("array"!==_.i(ce))return[new St(me,ce,`array expected, ${_.i(ce)} found`)];if(2!==ce.length)return[new St(me,ce,`array length 2 expected, length ${ce.length} found`)];if(H){if("object"!==_.i(ce[0]))return[new St(me,ce,`object expected, ${_.i(ce[0])} found`)];if(void 0===ce[0].zoom)return[new St(me,ce,"object stop key must have zoom")];if(void 0===ce[0].value)return[new St(me,ce,"object stop key must have value")];const se=_.u(ce[0].zoom);if("number"!=typeof se)return[new St(me,ce[0].zoom,"stop zoom values must be numbers")];if(D&&D>se)return[new St(me,ce[0].zoom,"stop zoom values must appear in ascending order")];se!==D&&(D=se,S=void 0,P={}),ae=ae.concat(yn({key:`${me}[0]`,value:ce[0],valueSpec:{zoom:{}},style:ie.style,styleSpec:ie.styleSpec,objectElementValidators:{zoom:an,value:ee}}))}else ae=ae.concat(ee({key:`${me}[0]`,value:ce[0],valueSpec:{},style:ie.style,styleSpec:ie.styleSpec},ce));return _.n(_.o(ce[1]))?ae.concat([new St(`${me}[1]`,ce[1],"expressions are not allowed in function stops.")]):ae.concat(pi({key:`${me}[1]`,value:ce[1],valueSpec:u,style:ie.style,styleSpec:ie.styleSpec}))}function ee(ie,ae){const ce=_.i(ie.value),me=_.u(ie.value),se=null!==ie.value?ie.value:ae;if(w){if(ce!==w)return[new St(ie.key,se,`${ce} stop domain type must match previous stop domain type ${w}`)]}else w=ce;if("number"!==ce&&"string"!==ce&&"boolean"!==ce&&"number"!=typeof me&&"string"!=typeof me&&"boolean"!=typeof me)return[new St(ie.key,se,"stop domain value must be a number, string, or boolean")];if("number"!==ce&&"categorical"!==g){let be=`number expected, ${ce} found`;return _.k(u)&&void 0===g&&(be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new St(ie.key,se,be)]}return"categorical"!==g||"number"!==ce||"number"==typeof me&&isFinite(me)&&Math.floor(me)===me?"categorical"!==g&&"number"===ce&&"number"==typeof me&&"number"==typeof S&&void 0!==S&&me<S?[new St(ie.key,se,"stop domain values must appear in ascending order")]:(S=me,"categorical"===g&&me in P?[new St(ie.key,se,"stop domain values must be unique")]:(P[me]=!0,[])):[new St(ie.key,se,`integer expected, found ${String(me)}`)]}}function uo(x){const u=("property"===x.expressionContext?_.q:_.r)(_.o(x.value),x.valueSpec);if("error"===u.result)return u.value.map(w=>new St(`${x.key}${w.key}`,x.value,w.message));const g=u.value.expression||u.value._styleExpression.expression;if("property"===x.expressionContext&&"text-font"===x.propertyKey&&!g.outputDefined())return[new St(x.key,x.value,`Invalid data expression for "${x.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===x.expressionContext&&"layout"===x.propertyType&&!_.t(g))return[new St(x.key,x.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===x.expressionContext)return Hr(g,x);if(x.expressionContext&&0===x.expressionContext.indexOf("cluster")){if(!_.v(g,["zoom","feature-state"]))return[new St(x.key,x.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===x.expressionContext&&!_.x(g))return[new St(x.key,x.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Hr(x,u){const g=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(u.valueSpec&&u.valueSpec.expression)for(const S of u.valueSpec.expression.parameters)g.delete(S);if(0===g.size)return[];const w=[];return x instanceof _.C&&g.has(x.name)?[new St(u.key,u.value,`["${x.name}"] expression is not supported in a filter for a ${u.object.type} layer with id: ${u.object.id}`)]:(x.eachChild(S=>{w.push(...Hr(S,u))}),w)}function as(x){const u=x.key,g=x.value,w=x.valueSpec,S=[];return Array.isArray(w.values)?-1===w.values.indexOf(_.u(g))&&S.push(new St(u,g,`expected one of [${w.values.join(", ")}], ${JSON.stringify(g)} found`)):-1===Object.keys(w.values).indexOf(_.u(g))&&S.push(new St(u,g,`expected one of [${Object.keys(w.values).join(", ")}], ${JSON.stringify(g)} found`)),S}function va(x){return _.z(_.o(x.value))?uo(_.j({},x,{expressionContext:"filter",valueSpec:x.styleSpec[`filter_${x.layerType||"fill"}`]})):jt(x)}function jt(x){const u=x.value,g=x.key;if("array"!==_.i(u))return[new St(g,u,`array expected, ${_.i(u)} found`)];const w=x.styleSpec;let S,D=[];if(u.length<1)return[new St(g,u,"filter array must have at least 1 element")];switch(D=D.concat(as({key:`${g}[0]`,value:u[0],valueSpec:w.filter_operator,style:x.style,styleSpec:x.styleSpec})),_.u(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&"$type"===_.u(u[1])&&D.push(new St(g,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":3!==u.length&&D.push(new St(g,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(S=_.i(u[1]),"string"!==S&&D.push(new St(`${g}[1]`,u[1],`string expected, ${S} found`)));for(let P=2;P<u.length;P++)S=_.i(u[P]),"$type"===_.u(u[1])?D=D.concat(as({key:`${g}[${P}]`,value:u[P],valueSpec:w.geometry_type,style:x.style,styleSpec:x.styleSpec})):"string"!==S&&"number"!==S&&"boolean"!==S&&D.push(new St(`${g}[${P}]`,u[P],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let P=1;P<u.length;P++)D=D.concat(jt({key:`${g}[${P}]`,value:u[P],style:x.style,styleSpec:x.styleSpec}));break;case"has":case"!has":S=_.i(u[1]),2!==u.length?D.push(new St(g,u,`filter array for "${u[0]}" operator must have 2 elements`)):"string"!==S&&D.push(new St(`${g}[1]`,u[1],`string expected, ${S} found`))}return D}function ta(x,u){const g=x.key,w=x.style,S=x.layer,D=x.styleSpec,P=x.value,F=x.objectKey,U=D[`${u}_${x.layerType}`];if(!U)return[];const H=F.match(/^(.*)-transition$/);if("paint"===u&&H&&U[H[1]]&&U[H[1]].transition)return pi({key:g,value:P,valueSpec:D.transition,style:w,styleSpec:D});const X=x.valueSpec||U[F];if(!X)return[new Vn(g,P,`unknown property "${F}"`)];let K;if("string"===_.i(P)&&_.k(X)&&!X.tokens&&(K=/^{([^}]+)}$/.exec(P))){const ie=`\`{ "type": "identity", "property": ${K?JSON.stringify(K[1]):'"_"'} }\``;return[new St(g,P,`"${F}" does not support interpolation syntax\nUse an identity property function instead: ${ie}.`)]}const ee=[];if("symbol"===x.layerType)"text-field"!==F||!w||w.glyphs||w.imports||ee.push(new St(g,P,'use of "text-field" requires a style "glyphs" property')),"text-font"===F&&_.A(_.o(P))&&"identity"===_.u(P.type)&&ee.push(new St(g,P,'"text-font" does not support identity functions'));else if("model"===x.layerType&&"paint"===u&&S&&S.layout&&S.layout.hasOwnProperty("model-id")&&_.k(X)&&(_.B(X)||_.m(X))){const ie=_.q(_.o(P),X),ae=ie.value.expression||ie.value._styleExpression.expression;ae&&!_.v(ae,["measure-light"])&&("model-emissive-strength"===F&&_.x(ae)&&_.t(ae)||ee.push(new St(g,P,`${F} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ee.concat(pi({key:x.key,value:P,valueSpec:X,style:w,styleSpec:D,expressionContext:"property",propertyType:u,propertyKey:F}))}function Za(x){return ta(x,"paint")}function Eo(x){return ta(x,"layout")}function zr(x){let u=[];const g=x.value,w=x.key,S=x.style,D=x.styleSpec;g.type||g.ref||u.push(new St(w,g,'either "type" or "ref" is required'));let P=_.u(g.type);const F=_.u(g.ref);if(g.id){const U=_.u(g.id);for(let H=0;H<x.arrayIndex;H++){const X=S.layers[H];_.u(X.id)===U&&u.push(new St(w,g.id,`duplicate layer id "${g.id}", previously used at line ${X.id.__line__}`))}}if("ref"in g){let U;["type","source","source-layer","filter","layout"].forEach(H=>{H in g&&u.push(new St(w,g[H],`"${H}" is prohibited for ref layers`))}),S.layers.forEach(H=>{_.u(H.id)===F&&(U=H)}),U?U.ref?u.push(new St(w,g.ref,"ref cannot reference another ref layer")):P=_.u(U.type):"string"==typeof F&&u.push(new St(w,g.ref,`ref layer "${F}" not found`))}else if("background"!==P&&"sky"!==P&&"slot"!==P)if(g.source){const U=S.sources&&S.sources[g.source],H=U&&_.u(U.type);U?"vector"===H&&"raster"===P?u.push(new St(w,g.source,`layer "${g.id}" requires a raster source`)):"raster"===H&&"raster"!==P?u.push(new St(w,g.source,`layer "${g.id}" requires a vector source`)):"vector"!==H||g["source-layer"]?"raster-dem"===H&&"hillshade"!==P?u.push(new St(w,g.source,"raster-dem source can only be used with layer type 'hillshade'.")):"raster-array"!==H||["raster","raster-particle"].includes(P)?"line"!==P||!g.paint||!g.paint["line-gradient"]&&!g.paint["line-trim-offset"]||"geojson"===H&&U.lineMetrics?"raster-particle"===P&&"raster-array"!==H&&u.push(new St(w,g.source,`layer "${g.id}" requires a 'raster-array' source.`)):u.push(new St(w,g,`layer "${g.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new St(w,g.source,"raster-array source can only be used with layer type 'raster'.")):u.push(new St(w,g,`layer "${g.id}" must specify a "source-layer"`)):u.push(new St(w,g.source,`source "${g.source}" not found`))}else u.push(new St(w,g,'missing required property "source"'));return u=u.concat(yn({key:w,value:g,valueSpec:D.layer,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":()=>[],type:()=>pi({key:`${w}.type`,value:g.type,valueSpec:D.layer.type,style:x.style,styleSpec:x.styleSpec,object:g,objectKey:"type"}),filter:U=>va(_.j({layerType:P},U)),layout:U=>yn({layer:g,key:U.key,value:U.value,valueSpec:{},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{"*":H=>Eo(_.j({layerType:P},H))}}),paint:U=>yn({layer:g,key:U.key,value:U.value,valueSpec:{},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{"*":H=>Za(_.j({layerType:P,layer:g},H))}})}})),u}function No(x){const u=x.value,g=x.key,w=_.i(u);return"string"!==w?[new St(g,u,`string expected, ${w} found`)]:[]}const la={promoteId:function({key:x,value:u}){if("string"===_.i(u))return No({key:x,value:u});{const g=[];for(const w in u)g.push(...No({key:`${x}.${w}`,value:u[w]}));return g}}};function io(x){const u=x.value,g=x.key,w=x.styleSpec,S=x.style;if(!u.type)return[new St(g,u,'"type" is required')];const D=_.u(u.type);let P=[];switch(["vector","raster","raster-dem","raster-array"].includes(D)&&(u.url||u.tiles||P.push(new Vn(g,u,'Either "url" or "tiles" is required.'))),D){case"vector":case"raster":case"raster-dem":case"raster-array":return P=P.concat(yn({key:g,value:u,valueSpec:w[`source_${D.replace("-","_")}`],style:x.style,styleSpec:w,objectElementValidators:la})),P;case"geojson":if(P=yn({key:g,value:u,valueSpec:w.source_geojson,style:S,styleSpec:w,objectElementValidators:la}),u.cluster)for(const F in u.clusterProperties){const[U,H]=u.clusterProperties[F],X="string"==typeof U?[U,["accumulated"],["get",F]]:U;P.push(...uo({key:`${g}.${F}.map`,value:H,expressionContext:"cluster-map"})),P.push(...uo({key:`${g}.${F}.reduce`,value:X,expressionContext:"cluster-reduce"}))}return P;case"video":return yn({key:g,value:u,valueSpec:w.source_video,style:S,styleSpec:w});case"image":return yn({key:g,value:u,valueSpec:w.source_image,style:S,styleSpec:w});case"canvas":return[new St(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return as({key:`${g}.type`,value:u.type,valueSpec:{values:Ge(w)},style:S,styleSpec:w})}}function Ge(x){return x.source.reduce((u,g)=>{const w=x[g];return"enum"===w.type.type&&(u=u.concat(Object.keys(w.type.values))),u},[])}function Qe(x){const u=x.value;let g=[];if(!u)return g;const w=_.i(u);return"string"!==w?(g=g.concat([new St(x.key,u,`string expected, "${w}" found`)]),g):(function(S){const D=-1===S.indexOf("://");try{return new URL(S,D?"http://example.com":void 0),!0}catch{return!1}}(u)||(g=g.concat([new St(x.key,u,`invalid url "${u}"`)])),g)}function nt(x){const u=x.value,g=x.styleSpec,w=g.light,S=x.style;let D=[];const P=_.i(u);if(void 0===u)return D;if("object"!==P)return D=D.concat([new St("light",u,`object expected, ${P} found`)]),D;for(const F in u){const U=F.match(/^(.*)-transition$/);D=D.concat(U&&w[U[1]]&&w[U[1]].transition?pi({key:F,value:u[F],valueSpec:g.transition,style:S,styleSpec:g}):w[F]?pi({key:F,value:u[F],valueSpec:w[F],style:S,styleSpec:g}):[new St(F,u[F],`unknown property "${F}"`)])}return D}function Xt(x){const u=x.value;let g=[];if(!u)return g;const w=_.i(u);if("object"!==w)return g=g.concat([new St("light-3d",u,`object expected, ${w} found`)]),g;const S=x.styleSpec,D=S["light-3d"],P=x.key,F=x.style,U=x.style.lights;for(const K of["type","id"])if(!(K in u))return g=g.concat([new St("light-3d",u,`missing property ${K} on light`)]),g;if(u.type&&U)for(let K=0;K<x.arrayIndex;K++){const ee=_.u(u.type),ie=U[K];_.u(ie.type)===ee&&g.push(new St(P,u.id,`duplicate light type "${u.type}", previously defined at line ${ie.id.__line__}`))}const H=`properties_light_${u.type}`;if(!(H in S))return g=g.concat([new St("light-3d",u,`Invalid light type ${u.type}`)]),g;const X=S[H];for(const K in u)if("properties"===K){const ee=u[K],ie=_.i(ee);if("object"!==ie)return g=g.concat([new St("properties",ee,`object expected, ${ie} found`)]),g;for(const ae in ee)g=g.concat(X[ae]?pi({key:ae,value:ee[ae],valueSpec:X[ae],style:F,styleSpec:S}):[new Vn(x.key,ee[ae],`unknown property "${ae}"`)])}else{const ee=K.match(/^(.*)-transition$/);g=g.concat(ee&&D[ee[1]]&&D[ee[1]].transition?pi({key:K,value:u[K],valueSpec:S.transition,style:F,styleSpec:S}):D[K]?pi({key:K,value:u[K],valueSpec:D[K],style:F,styleSpec:S}):[new Vn(K,u[K],`unknown property "${K}"`)])}return g}function kt(x){const u=x.value,g=x.key,w=x.style,S=x.styleSpec,D=S.terrain;let P=[];const F=_.i(u);if(void 0===u||"null"===F)return P;if("object"!==F)return P=P.concat([new St("terrain",u,`object expected, ${F} found`)]),P;for(const U in u){const H=U.match(/^(.*)-transition$/);P=P.concat(H&&D[H[1]]&&D[H[1]].transition?pi({key:U,value:u[U],valueSpec:S.transition,style:w,styleSpec:S}):D[U]?pi({key:U,value:u[U],valueSpec:D[U],style:w,styleSpec:S}):[new Vn(U,u[U],`unknown property "${U}"`)])}if(u.source){const U=w.sources&&w.sources[u.source],H=U&&_.u(U.type);U?"raster-dem"!==H&&P.push(new St(g,u.source,`terrain cannot be used with a source of type ${String(H)}, it only be used with a "raster-dem" source type`)):P.push(new St(g,u.source,`source "${u.source}" not found`))}else P.push(new St(g,u,'terrain is missing required property "source"'));return P}function qt(x){const u=x.value,g=x.style,w=x.styleSpec,S=w.fog;let D=[];const P=_.i(u);if(void 0===u)return D;if("object"!==P)return D=D.concat([new St("fog",u,`object expected, ${P} found`)]),D;for(const F in u){const U=F.match(/^(.*)-transition$/);D=D.concat(U&&S[U[1]]&&S[U[1]].transition?pi({key:F,value:u[F],valueSpec:w.transition,style:g,styleSpec:w}):S[F]?pi({key:F,value:u[F],valueSpec:S[F],style:g,styleSpec:w}):[new Vn(F,u[F],`unknown property "${F}"`)])}return D}const Bt={"*":()=>[],array:Ii,boolean:function(x){const u=x.value,g=x.key,w=_.i(u);return"boolean"!==w?[new St(g,u,`boolean expected, ${w} found`)]:[]},number:an,color:function(x){const u=x.key,g=x.value,w=_.i(g);return"string"!==w?[new St(u,g,`color expected, ${w} found`)]:null===_.y(g)?[new St(u,g,`color expected, "${g}" found`)]:[]},enum:as,filter:va,function:Vr,layer:zr,object:yn,source:io,model:Qe,light:nt,"light-3d":Xt,terrain:kt,fog:qt,string:No,formatted:function(x){return 0===No(x).length?[]:uo(x)},resolvedImage:function(x){return 0===No(x).length?[]:uo(x)},projection:function(x){const u=x.value,g=x.styleSpec,w=g.projection,S=x.style;let D=[];const P=_.i(u);if("object"===P)for(const F in u)D=D.concat(pi({key:F,value:u[F],valueSpec:w[F],style:S,styleSpec:g}));else"string"!==P&&(D=D.concat([new St("projection",u,`object or string expected, ${P} found`)]));return D},import:function(x){const{value:u,styleSpec:g}=x,{data:w,...S}=u;Object.defineProperty(S,"__line__",{value:u.__line__,enumerable:!1});let D=yn(_.j({},x,{value:S,valueSpec:g.import}));return""===_.u(S.id)&&D.push(new St(`${x.key}.id`,S,"import id can't be an empty string")),w&&(D=D.concat(Pr(w,g,{key:`${x.key}.data`}))),D}};function pi(x,u=!1){const g=x.value,w=x.valueSpec,S=x.styleSpec;if(w.expression&&_.A(_.u(g)))return Vr(x);if(w.expression&&_.n(_.o(g)))return uo(x);if(w.type&&Bt[w.type]){const D=Bt[w.type](x);return!0===u&&D.length>0&&"array"===_.i(x.value)?uo(x):D}return yn(_.j({},x,{valueSpec:w.type?S[w.type]:w}))}function pn(x){const u=x.value,g=x.key,w=No(x);return w.length||(-1===u.indexOf("{fontstack}")&&w.push(new St(g,u,'"glyphs" url must include a "{fontstack}" token')),-1===u.indexOf("{range}")&&w.push(new St(g,u,'"glyphs" url must include a "{range}" token'))),w}function Pr(x,u=_.D,g={}){return pi({key:g.key||"",value:x,valueSpec:u.$root,styleSpec:u,style:x,objectElementValidators:{glyphs:pn,"*":()=>[]}})}function br(x,u=_.D){return gt(Pr(x,u))}const Ho=x=>gt(io(x)),qo=x=>gt(nt(x)),lt=x=>gt(Xt(x)),ve=x=>gt(kt(x)),Ce=x=>gt(qt(x)),He=x=>gt(zr(x)),ut=x=>gt(va(x)),bt=x=>gt(Za(x)),Ht=x=>gt(Eo(x)),hi=x=>gt(Qe(x));function gt(x){return x.slice().sort((u,g)=>u.line&&g.line?u.line-g.line:0)}function Ni(x,u){let g=!1;if(u&&u.length)for(const w of u)w instanceof Vn?_.w(w.message):(x.fire(new _.a(new Error(w.message))),g=!0);return g}const wi=new _.F({anchor:new _.G(_.D.light.anchor),position:new _.H(_.D.light.position),color:new _.G(_.D.light.color),intensity:new _.G(_.D.light.intensity)});class $i extends _.E{constructor(u,g="flat"){super(),this._transitionable=new _.J(wi),this.setLight(u,g),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,g,w={}){this._validate(qo,u,w)||(this._transitionable.setTransitionOrValue(u),this.id=g)}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,w){return(!w||!1!==w.validate)&&Ni(this,u.call(br,_.e({value:g,style:{glyphs:!0,sprite:!0},styleSpec:_.D})))}}const jn=new _.F({source:new _.G(_.D.terrain.source),exaggeration:new _.G(_.D.terrain.exaggeration)});let eo=class extends _.E{constructor(x,u,g,w){super(),this.scope=g,this._transitionable=new _.J(jn,g,w),this._transitionable.setTransitionOrValue(x,w),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(x,u){this._transitionable.setTransitionOrValue(x,u)}updateTransitions(x){this._transitioning=this._transitionable.transitioned(x,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(x){this.properties=this._transitioning.possiblyEvaluate(x)}getExaggeration(x){return this._transitioning.possiblyEvaluate(new _.K(x)).get("exaggeration")}isZoomDependent(){const x=this._transitionable._values.exaggeration;return null!=x&&null!=x.value&&null!=x.value.expression&&x.value.expression instanceof _.Z}};const _o=45,Pn=65,Tr=.05;function cr(x,u,g,w){const S=_.O(_o,Pn,g),[D,P]=kn(x,w);let F=1-Math.min(1,Math.exp((u-D)/(P-D)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*S*x.alpha}function kn(x,u){const g=.5/Math.tan(.5*u);return[x.range[0]+g,x.range[1]+g]}function Xr(x,u,g,w,S){const D=_.N.transformMat4([],[u,g,w],S.mercatorFogMatrix);return cr(x,_.N.length(D),S.pitch,S._fov)}function gi(x,u,g,w,S,D,P){const F=[[g,w,0],[S,w,0],[S,D,0],[g,D,0]];let U=Number.MAX_VALUE,H=-Number.MAX_VALUE;for(const X of F){const K=_.N.transformMat4([],X,u),ee=_.N.length(K);U=Math.min(U,ee),H=Math.max(H,ee)}return[cr(x,U,P.pitch,P._fov),cr(x,H,P.pitch,P._fov)]}const di=new _.F({range:new _.G(_.D.fog.range),color:new _.G(_.D.fog.color),"high-color":new _.G(_.D.fog["high-color"]),"space-color":new _.G(_.D.fog["space-color"]),"horizon-blend":new _.G(_.D.fog["horizon-blend"]),"star-intensity":new _.G(_.D.fog["star-intensity"]),"vertical-range":new _.G(_.D.fog["vertical-range"])});class ro extends _.E{constructor(u,g,w,S){super(),this._transitionable=new _.J(di,w,new Map(S)),this.set(u,S),this._transitioning=this._transitionable.untransitioned(),this._transform=g,this.properties=new _.Q(di)}get state(){const u=this._transform,g="globe"===u.projection.name,w=_.S(u.zoom),S=this.properties.get("range"),D=[.5,3];return{range:g?[_.U(D[0],S[0],w),_.U(D[1],S[1],w)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(u,g,w={}){if(this._validate(Ce,u,w))return;const S=_.e({},u);for(const D of Object.keys(_.D.fog))void 0===S[D]&&(S[D]=_.D.fog[D].default);this._options=S,this._transitionable.setTransitionOrValue(this._options,g)}getOpacity(u){if(!this._transform.projection.supportsFog)return 0;const g=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:_.O(_o,Pn,u))*g.a}getOpacityAtLatLng(u,g){return this._transform.projection.supportsFog?function(w,S,D){const P=_.L.fromLngLat(S),F=D.elevation?D.elevation.getAtPointOrZero(P):0;return Xr(w,P.x,P.y,F,D)}(this.state,u,g):0}getOpacityForTile(u){if(!this._transform.projection.supportsFog)return[1,1];const g=this._transform.calculateFogTileMatrix(u.toUnwrapped());return gi(this.state,g,0,0,_.V,_.V,this._transform)}getOpacityForBounds(u,g,w,S,D){return this._transform.projection.supportsFog?gi(this.state,u,g,w,S,D,this._transform):[1,1]}getFovAdjustedRange(u){return this._transform.projection.supportsFog?kn(this.state,u):[0,1]}isVisibleOnFrustum(u){if(!this._transform.projection.supportsFog)return!1;const g=[4,5,6,7];for(const w of g){const S=u.points[w];let D;if(S[2]>=0)D=S;else{const P=u.points[w-4];D=_.W(P,S,P[2]/(P[2]-S[2]))}if(Xr(this.state,D[0],D[1],0,this._transform)>=Tr)return!0}return!1}updateConfig(u){this._transitionable.setTransitionOrValue(this._options,new Map(u))}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,g,w){return(!w||!1!==w.validate)&&Ni(this,u.call(br,_.e({value:g,style:{glyphs:!0,sprite:!0},styleSpec:_.D})))}}class Hs extends _.E{constructor(u,g,w,S){super(),this.scope=w,this._options=u,this.properties=new _.Q(g),this._transitionable=new _.J(g,w,new Map(S)),this._transitionable.setTransitionOrValue(u.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(u){this._transitionable.setTransitionOrValue(this._options.properties,new Map(u))}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(u,g){this._options=u,this._transitionable.setTransitionOrValue(u.properties,g)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}const ca=new _.F({color:new _.G(_.D.properties_light_ambient.color),intensity:new _.G(_.D.properties_light_ambient.intensity)}),ls=new _.F({direction:new _.X(_.D.properties_light_directional.direction),color:new _.G(_.D.properties_light_directional.color),intensity:new _.G(_.D.properties_light_directional.intensity),"cast-shadows":new _.G(_.D.properties_light_directional["cast-shadows"]),"shadow-intensity":new _.G(_.D.properties_light_directional["shadow-intensity"])});class Yo{constructor(u,g,w,S){this.screenBounds=u,this.cameraPoint=g,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=w,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(u,g){let w,S;if(u instanceof _.P||"number"==typeof u[0]){const D=_.P.convert(u);w=[D],S=g.isPointAboveHorizon(D)}else{const D=_.P.convert(u[0]),P=_.P.convert(u[1]);w=[D,P],S=_.Y(D,P).every(F=>g.isPointAboveHorizon(F))}return new Yo(w,g.getCameraPoint(),S,g)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(u){return _.Y(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],u)}bufferedCameraGeometry(u){const g=this.screenBounds[0],w=1===this.screenBounds.length?this.screenBounds[0].add(new _.P(1,1)):this.screenBounds[1],S=_.Y(g,w,0,!1);return this.cameraPoint.y>w.y&&(this.cameraPoint.x>g.x&&this.cameraPoint.x<w.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=w.x?S[2]=this.cameraPoint:this.cameraPoint.x<=g.x&&(S[3]=this.cameraPoint)),_._(S,u)}bufferedCameraGeometryGlobe(u){const g=this.screenBounds[0],w=1===this.screenBounds.length?this.screenBounds[0].add(new _.P(1,1)):this.screenBounds[1],S=_.Y(g,w,u),D=this.cameraPoint.clone();switch(3*((D.y>g.y)+(D.y>w.y))+((D.x>g.x)+(D.x>w.x))){case 0:S[0]=D,S[4]=D.clone();break;case 1:S.splice(1,0,D);break;case 2:S[1]=D;break;case 3:S.splice(4,0,D);break;case 5:S.splice(2,0,D);break;case 6:S[3]=D;break;case 7:S.splice(3,0,D);break;case 8:S[2]=D}return S}containsTile(u,g,w,S=0){const D=u.queryPadding/g._pixelsPerMercatorPixel+1,P=w?this._bufferedCameraMercator(D,g):this._bufferedScreenMercator(D,g);let F=u.tileID.wrap+(P.unwrapped?S:0);const U=P.polygon.map(me=>_.$(u.tileTransform,me,F));if(!_.a0(U,0,0,_.V,_.V))return;F=u.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const H=this.screenGeometryMercator.polygon.map(me=>_.a1(u.tileTransform,me,F)),X=H.map(me=>new _.P(me[0],me[1])),K=g.getFreeCameraOptions().position||new _.L(0,0,0),ee=_.a1(u.tileTransform,K,F),ie=H.map(me=>{const se=_.N.sub(me,me,ee);return _.N.normalize(se,se),new _.a2(ee,se)}),ae=_.a3(u,1,g.zoom)*g._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:X,tilespaceRays:ie,bufferedTilespaceGeometry:U,bufferedTilespaceBounds:(ce=_.a4(U),ce.min.x=_.aa(ce.min.x,0,_.V),ce.min.y=_.aa(ce.min.y,0,_.V),ce.max.x=_.aa(ce.max.x,0,_.V),ce.max.y=_.aa(ce.max.y,0,_.V),ce),tile:u,tileID:u.tileID,pixelToTileUnitsFactor:ae};var ce}_bufferedScreenMercator(u,g){const w=Vt(u);if(this._screenRaycastCache[w])return this._screenRaycastCache[w];{let S;return S="globe"===g.projection.name?this._projectAndResample(this.bufferedScreenGeometry(u),g):{polygon:this.bufferedScreenGeometry(u).map(D=>g.pointCoordinate3D(D)),unwrapped:!0},this._screenRaycastCache[w]=S,S}}_bufferedCameraMercator(u,g){const w=Vt(u);if(this._cameraRaycastCache[w])return this._cameraRaycastCache[w];{let S;return S="globe"===g.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(u),g):{polygon:this.bufferedCameraGeometry(u).map(D=>g.pointCoordinate3D(D)),unwrapped:!0},this._cameraRaycastCache[w]=S,S}}_projectAndResample(u,g){const w=function(D,P){const F=_.a6.multiply([],P.pixelMatrix,P.globeMatrix),U=[0,-_.ab,0,1],H=[0,_.ab,0,1],X=[0,0,0,1];_.a7.transformMat4(U,U,F),_.a7.transformMat4(H,H,F),_.a7.transformMat4(X,X,F);const K=new _.P(U[0]/U[3],U[1]/U[3]),ee=new _.P(H[0]/H[3],H[1]/H[3]),ie=_.a8(D,K)&&U[3]<X[3],ae=_.a8(D,ee)&&H[3]<X[3];if(!ie&&!ae)return null;const ce=function(De,Fe,Ne){for(let je=1;je<De.length;je++){const at=wt(Fe.pointCoordinate3D(De[je-1]).x),Ke=wt(Fe.pointCoordinate3D(De[je]).x);if(Ne<0){if(at<Ke)return{idx:je,t:-at/(Ke-1-at)}}else if(Ke<at)return{idx:je,t:(1-at)/(Ke+1-at)}}return null}(D,P,ie?-1:1);if(!ce)return null;const{idx:me,t:se}=ce;let be=me>1?dt(D.slice(0,me),P):[],Me=me<D.length?dt(D.slice(me),P):[];be=be.map(De=>new _.P(wt(De.x),De.y)),Me=Me.map(De=>new _.P(wt(De.x),De.y));const we=[...be];0===we.length&&we.push(Me[Me.length-1]);const Se=_.U(we[we.length-1].y,(0===Me.length?be[0]:Me[0]).y,se);let pe;return pe=ie?[new _.P(0,Se),new _.P(0,0),new _.P(1,0),new _.P(1,Se)]:[new _.P(1,Se),new _.P(1,1),new _.P(0,1),new _.P(0,Se)],we.push(...pe),0===Me.length?we.push(be[0]):we.push(...Me),{polygon:we.map(De=>new _.L(De.x,De.y)),unwrapped:!1}}(u,g);if(w)return w;const S=function(D,P){let F=!1,U=-1/0,H=0;for(let K=0;K<D.length-1;K++)D[K].x>U&&(U=D[K].x,H=K);for(let K=0;K<D.length-1;K++){const ee=(H+K)%(D.length-1),ie=D[ee],ae=D[ee+1];Math.abs(ie.x-ae.x)>.5&&(ie.x<ae.x?(ie.x+=1,0===ee&&(D[D.length-1].x+=1)):(ae.x+=1,ee+1===D.length-1&&(D[0].x+=1)),F=!0)}const X=_.a5(P.center.lng);return F&&X<Math.abs(X-1)&&D.forEach(K=>{K.x-=1}),{polygon:D,unwrapped:F}}(dt(u,g).map(D=>new _.P(wt(D.x),D.y)),g);return{polygon:S.polygon.map(D=>new _.L(D.x,D.y)),unwrapped:S.unwrapped}}}function dt(x,u){return _.a9(x,g=>{const w=u.pointCoordinate3D(g);g.x=w.x,g.y=w.y},1/256)}function wt(x){return x<0?1+x%1:x%1}function Vt(x){return 100*x|0}function st(x,u,g,w,S){const D=function(P,F){if(P)return S(P);if(F){x.url&&F.tiles&&x.tiles&&delete x.tiles;const U=_.ac(_.e(F,x),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);F.vector_layers&&(U.vectorLayers=F.vector_layers,U.vectorLayerIds=U.vectorLayers.map(H=>H.id)),F.raster_layers&&(U.rasterLayers=F.raster_layers,U.rasterLayerIds=U.rasterLayers.map(H=>H.id)),U.tiles=u.canonicalizeTileset(U,x.url),S(null,U)}};return x.url?_.g(u.transformRequest(u.normalizeSourceURL(x.url,null,g,w),_.R.Source),D):_.f.frame(()=>D(null,x))}class ei{constructor(u,g,w){this.bounds=_.ad.convert(this.validateBounds(u)),this.minzoom=g||0,this.maxzoom=w||24}validateBounds(u){return Array.isArray(u)&&4===u.length?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const g=Math.pow(2,u.z),w=Math.floor(_.a5(this.bounds.getWest())*g),S=Math.floor(_.ae(this.bounds.getNorth())*g),D=Math.ceil(_.a5(this.bounds.getEast())*g),P=Math.ceil(_.ae(this.bounds.getSouth())*g);return u.x>=w&&u.x<D&&u.y>=S&&u.y<P}}class si extends _.E{constructor(u,g,w,S){if(super(),this.id=u,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,_.e(this,_.ac(g,["url","scheme","tileSize","promoteId"])),this._options=_.e({type:"vector"},g),this._collectResourceTiming=!!g.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new _.af}load(u){this._loaded=!1,this.fire(new _.b("dataloading",{dataType:"source"}));const g=Array.isArray(this.map._language)?this.map._language.join():this.map._language,w=this.map._worldview;this._tileJSONRequest=st(this._options,this.map._requestManager,g,w,(S,D)=>{this._tileJSONRequest=null,this._loaded=!0,S?(g&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${g}`),w&&2!==w.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${w}`),this.fire(new _.a(S))):D&&(_.e(this,D),D.bounds&&(this.tileBounds=new ei(D.bounds,this.minzoom,this.maxzoom)),_.aj(D.tiles,this.map._requestManager._customAccessToken),this.fire(new _.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.b("data",{dataType:"source",sourceDataType:"content"}))),u&&u(S)})}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest();const u=_.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(u))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _.e({},this._options)}loadTile(u,g){const w=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(w,_.R.Tile),data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:_.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:u.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:u.isExtraShadowCaster};if(S.request.collectResourceTiming=this._collectResourceTiming,u.actor&&"expired"!==u.state)"loading"===u.state?u.reloadCallback=g:u.request=u.actor.send("reloadTile",S,D.bind(this));else if(u.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)u.request=u.actor.send("loadTile",S,D.bind(this),void 0,!0);else{const P=_.ah.call({deduped:this._deduped},S,(F,U)=>{F||!U?D.call(this,F):(S.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},u.actor&&u.actor.send("loadTile",S,D.bind(this),void 0,!0))},!0);u.request={cancel:P}}function D(P,F){return delete u.request,u.aborted?g(null):P&&404!==P.status?g(P):(F&&F.resourceTiming&&(u.resourceTiming=F.resourceTiming),this.map._refreshExpiredTiles&&F&&u.setExpiryData(F),u.loadVectorData(F,this.map.painter),_.ai(this.dispatcher),g(null),void(u.reloadCallback&&(this.loadTile(u,u.reloadCallback),u.reloadCallback=null)))}}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.actor&&u.actor.send("abortTile",{uid:u.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(u){u.actor&&u.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id,scope:this.scope}),u.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ai extends _.E{constructor(u,g,w,S){super(),this.id=u,this.dispatcher=w,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=_.e({type:"raster"},g),_.e(this,_.ac(g,["url","scheme","tileSize"]))}load(u){this._loaded=!1,this.fire(new _.b("dataloading",{dataType:"source"})),this._tileJSONRequest=st(this._options,this.map._requestManager,null,null,(g,w)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new _.a(g)):w&&(_.e(this,w),w.bounds&&(this.tileBounds=new ei(w.bounds,this.minzoom,this.maxzoom)),_.aj(w.tiles),this.fire(new _.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.b("data",{dataType:"source",sourceDataType:"content"}))),u&&u(g)})}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest();const u=_.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(u))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _.e({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,g){const w=_.f.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),w,this.tileSize);u.request=_.d(this.map._requestManager.transformRequest(S,_.R.Tile),(D,P,F,U)=>(delete u.request,u.aborted?(u.state="unloaded",g(null)):D?(u.state="errored",g(D)):P?(this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:F,expires:U}),u.setTexture(P,this.map.painter),u.state="loaded",_.ai(this.dispatcher),void g(null)):g(null)))}abortTile(u,g){u.request&&(u.request.cancel(),delete u.request),g()}unloadTile(u,g){u.texture&&u.texture instanceof _.T?(u.destroy(!0),u.texture&&u.texture instanceof _.T&&this.map.painter.saveTileTexture(u.texture)):u.destroy(),g()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Zt extends ai{constructor(u,g,w,S){super(u,g,w,S),this.type="raster-array",this.maxzoom=22,this._options=_.e({type:"raster-array"},g)}triggerRepaint(u){const g=this.map.painter._terrain,w=this.map.style.getSourceCache(this.id);g&&g.enabled&&w&&g._clearRenderCacheForTile(w.id,u.tileID),this.map.triggerRepaint()}loadTile(u,g){const w=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(w,_.R.Tile);u.requestParams=S,u.actor||(u.actor=this.dispatcher.getActor()),u.request=u.fetchHeader(void 0,(D,P,F,U)=>(delete u.request,u.aborted?(u.state="unloaded",g(null)):D?20===D.code?void 0:(u.state="errored",g(D)):(this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:F,expires:U}),u.state="empty",void g(null))))}unloadTile(u){const g=u.texture;g&&g instanceof _.T?(u.destroy(!0),this.map.painter.saveTileTexture(g)):(u.destroy(),u.flushQueues(),u._isHeaderLoaded=!1,delete u._mrt,delete u.textureDescriptor),u.fbo&&(u.fbo.destroy(),delete u.fbo),delete u.request,delete u.requestParams,delete u.neighboringTiles,u.state="unloaded"}prepareTile(u,g,w){u._isHeaderLoaded&&("empty"!==u.state&&(u.state="reloading"),u.fetchBand(g,w,(S,D)=>{if(S)return u.state="errored",this.fire(new _.a(S)),void this.triggerRepaint(u);D&&(u.setTexture(D,this.map.painter),u.state="loaded",this.triggerRepaint(u))}))}getInitialBand(u){if(!this.rasterLayers)return 0;const g=this.rasterLayers.find(({id:D})=>D===u),w=g&&g.fields,S=w&&w.bands&&w.bands;return S?S[0]:0}getTextureDescriptor(u,g,w){if(!u)return;const S=g.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!S)return;let D=null;g instanceof _.an?D=g.paint.get("raster-array-band"):g instanceof _.ao&&(D=g.paint.get("raster-particle-array-band"));const P=D||this.getInitialBand(S);if(null!=P)if(u.textureDescriptor){if(!u.updateNeeded(S,P)||w)return Object.assign({},u.textureDescriptor,{texture:u.texture})}else this.prepareTile(u,S,P)}}const sn=new Uint16Array(8184);for(let x=0;x<2046;x++){let u=x+2,g=0,w=0,S=0,D=0,P=0,F=0;for(1&u?S=D=P=32:g=w=F=32;(u>>=1)>1;){const H=g+S>>1,X=w+D>>1;1&u?(S=g,D=w,g=P,w=F):(g=S,w=D,S=P,D=F),P=H,F=X}const U=4*x;sn[U+0]=g,sn[U+1]=w,sn[U+2]=S,sn[U+3]=D}const Zn=new Uint16Array(2178),zi=new Uint8Array(1089),Kr=new Uint16Array(1089);function hr(x){return 0===x?-.03125:32===x?.03125:0}let Qr=(()=>{class x{constructor(g,w,S,D){this.id=x.uniqueIdxCounter,x.uniqueIdxCounter++,this.context=g;const P=g.gl;this.buffer=P.createBuffer(),this.dynamicDraw=!!S,this.context.unbindVAO(),g.bindElementBuffer.set(this.buffer),P.bufferData(P.ELEMENT_ARRAY_BUFFER,w.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||D||w.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(g){this.id=x.uniqueIdxCounter,x.uniqueIdxCounter++;const w=this.context.gl;this.context.unbindVAO(),this.bind(),w.bufferSubData(w.ELEMENT_ARRAY_BUFFER,0,g.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return x.uniqueIdxCounter=0,x})();const ho={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class bo{constructor(u,g,w,S,D,P){this.length=g.length,this.attributes=w,this.itemSize=g.bytesPerElement,this.dynamicDraw=S,this.instanceCount=P,this.context=u;const F=u.gl;this.buffer=F.createBuffer(),u.bindVertexBuffer.set(this.buffer),F.bufferData(F.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?F.DYNAMIC_DRAW:F.STATIC_DRAW),this.dynamicDraw||D||g.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,g){for(let w=0;w<this.attributes.length;w++){const S=g.attributes[this.attributes[w].name];void 0!==S&&u.enableVertexAttribArray(S)}}setVertexAttribPointers(u,g,w){for(let S=0;S<this.attributes.length;S++){const D=this.attributes[S],P=g.attributes[D.name];void 0!==P&&u.vertexAttribPointer(P,D.components,u[ho[D.type]],!1,this.itemSize,D.offset+this.itemSize*(w||0))}}setVertexAttribDivisor(u,g,w){for(let S=0;S<this.attributes.length;S++){const D=g.attributes[this.attributes[S].name];void 0!==D&&this.instanceCount&&this.instanceCount>0&&u.vertexAttribDivisor(D,w)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ir{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ss extends ir{getDefault(){return _.ax.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class $s extends ir{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class nr extends ir{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class gh extends ir{getDefault(){return[!0,!0,!0,!0]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Ka extends ir{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class On extends ir{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class bl extends ir{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const g=this.current;(u.func!==g.func||u.ref!==g.ref||u.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class Ps extends ir{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class xi extends ir{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=u,this.dirty=!1}}class Ea extends ir{getDefault(){return[0,1]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class rs extends ir{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=u,this.dirty=!1}}class Ua extends ir{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class Ta extends ir{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.BLEND):g.disable(g.BLEND),this.current=u,this.dirty=!1}}class _h extends ir{getDefault(){const u=this.gl;return[u.ONE,u.ZERO,u.ONE,u.ZERO]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.blendFuncSeparate(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Nn extends ir{getDefault(){return _.ax.transparent}set(u){const g=this.current;(u.r!==g.r||u.g!==g.g||u.b!==g.b||u.a!==g.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class Bo extends ir{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(u,u),this.current=u,this.dirty=!1)}}class Vo extends ir{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;u?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=u,this.dirty=!1}}class rr extends ir{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class id extends ir{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}let Ic=class extends ir{getDefault(){return null}set(x){(x!==this.current||this.dirty)&&(this.gl.useProgram(x),this.current=x,this.dirty=!1)}};class Sa extends ir{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class yl extends ir{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const g=this.current;(u[0]!==g[0]||u[1]!==g[1]||u[2]!==g[2]||u[3]!==g[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Os extends ir{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class Rc extends ir{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class mf extends ir{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class Ma extends ir{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Ci extends ir{getDefault(){return null}set(u){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Or extends ir{getDefault(){return null}set(u){this.gl&&(u!==this.current||this.dirty)&&(this.gl.bindVertexArray(u),this.current=u,this.dirty=!1)}}class wr extends ir{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class Ae extends ir{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class Oe extends ir{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class Ve extends ir{constructor(u,g){super(u),this.context=u,this.parent=g}getDefault(){return null}}class Et extends Ve{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class Qt extends Ve{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,this.attachment(),g.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Ei extends Ve{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,this.attachment(),g.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class fn extends Qt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class An{constructor(u,g,w,S,D){this.context=u,this.width=g,this.height=w;const P=this.framebuffer=u.gl.createFramebuffer();S&&(this.colorAttachment=new Et(u,P)),D&&(this.depthAttachmentType=D,this.depthAttachment="renderbuffer"===D?new Qt(u,P):new Ei(u,P))}destroy(){const u=this.context.gl;if(this.colorAttachment){const g=this.colorAttachment.get();g&&u.deleteTexture(g)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const g=this.depthAttachment.get();g&&u.deleteRenderbuffer(g)}else{const g=this.depthAttachment.get();g&&u.deleteTexture(g)}u.deleteFramebuffer(this.framebuffer)}}class Pi{constructor(u,g,w){this.func=u,this.mask=g,this.range=w}}Pi.ReadOnly=!1,Pi.ReadWrite=!0,Pi.disabled=new Pi(519,Pi.ReadOnly,[0,1]);class nn{constructor(u,g,w,S,D,P){this.test=u,this.ref=g,this.mask=w,this.fail=S,this.depthFail=D,this.pass=P}}nn.disabled=new nn({func:519,mask:0},0,0,7680,7680,7680);class $n{constructor(u,g,w,S){this.blendFunction=u,this.blendColor=g,this.mask=w,this.blendEquation=S}}$n.Replace=[1,0,1,0],$n.disabled=new $n($n.Replace,_.ax.transparent,[!1,!1,!1,!1]),$n.unblended=new $n($n.Replace,_.ax.transparent,[!0,!0,!0,!0]),$n.alphaBlended=new $n([1,771,1,771],_.ax.transparent,[!0,!0,!0,!0]),$n.multiply=new $n([774,0,774,0],_.ax.transparent,[!0,!0,!0,!0]);class rn{constructor(u,g,w){this.enable=u,this.mode=g,this.frontFace=w}}rn.disabled=new rn(!1,1029,2305),rn.backCCW=new rn(!0,1029,2305),rn.backCW=new rn(!0,1029,2304),rn.frontCW=new rn(!0,1028,2304),rn.frontCCW=new rn(!0,1028,2305);class Qa{constructor(u,g){this.gl=u,this.clearColor=new Ss(this),this.clearDepth=new $s(this),this.clearStencil=new nr(this),this.colorMask=new gh(this),this.depthMask=new Ka(this),this.stencilMask=new On(this),this.stencilFunc=new bl(this),this.stencilOp=new Ps(this),this.stencilTest=new xi(this),this.depthRange=new Ea(this),this.depthTest=new rs(this),this.depthFunc=new Ua(this),this.blend=new Ta(this),this.blendFunc=new _h(this),this.blendColor=new Nn(this),this.blendEquation=new Bo(this),this.cullFace=new Vo(this),this.cullFaceSide=new rr(this),this.frontFace=new id(this),this.program=new Ic(this),this.activeTexture=new Sa(this),this.viewport=new yl(this),this.bindFramebuffer=new Os(this),this.bindRenderbuffer=new Rc(this),this.bindTexture=new mf(this),this.bindVertexBuffer=new Ma(this),this.bindElementBuffer=new Ci(this),this.bindVertexArrayOES=new Or(this),this.pixelStoreUnpack=new wr(this),this.pixelStoreUnpackPremultiplyAlpha=new Ae(this),this.pixelStoreUnpackFlipY=new Oe(this),this.options=g?{...g}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=u.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=u.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=u.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=u.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE),this.maxPointSize=u.getParameter(u.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,g,w){return new Qr(this,u,g,w)}createVertexBuffer(u,g,w,S,D){return new bo(this,u,g,w,S,D)}createRenderbuffer(u,g,w){const S=this.gl,D=S.createRenderbuffer();return this.bindRenderbuffer.set(D),S.renderbufferStorage(S.RENDERBUFFER,u,g,w),this.bindRenderbuffer.set(null),D}createFramebuffer(u,g,w,S){return new An(this,u,g,w,S)}clear({color:u,depth:g,stencil:w,colorMask:S}){const D=this.gl;let P=0;u&&(P|=D.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set(S||[!0,!0,!0,!0])),void 0!==g&&(P|=D.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),void 0!==w&&(P|=D.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),D.clear(P)}setCullFace(u){!1===u.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){Tt(u.blendFunction,$n.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor),u.blendEquation?this.blendEquation.set(u.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(u.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}var lc=_.ay([{name:"a_pos",type:"Float32",components:3}]);class cs{constructor(u,g,w,S){const D={width:w[0],height:w[1],data:null},P=u.gl;this.targetColorTexture=new _.T(u,D,P.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new _.T(u,D,P.RGBA,{useMipmap:!1}),this.context=u,this.setNumParticles(g,S),this.lastInvalidatedAt=0}setNumParticles(u,g){if(this.numParticles===g)return;(this.particleVertices0||this.particleVertices1||this.particleSegment)&&(this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy());const w=new _.az;w.reserve(Math.round(g));const S=_.aA(u.key);for(let D=0;D<g;D++)w.emplaceBack(S(),S(),S());this.particleVertices0=this.context.createVertexBuffer(w,lc.members,!0),this.particleVertices1=this.context.createVertexBuffer(w,lc.members,!0),this.particleSegment=_.aB.simpleSegment(0,0,this.particleVertices0.length,0),this.numParticles=g}update(u){return!(this.lastInvalidatedAt<u&&(this.lastInvalidatedAt=_.f.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy()}}const ds={type:2,extent:_.V,loadGeometry:()=>[[new _.P(0,0),new _.P(_.V+1,0),new _.P(_.V+1,_.V+1),new _.P(0,_.V+1),new _.P(0,0)]]};class Ul{constructor(u,g,w,S,D){this.tileID=u,this.uid=_.aC(),this.uses=0,this.tileSize=g,this.tileZoom=w,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=D,S&&S.style&&(this._lastUpdatedBrightness=S.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",S&&S.transform&&(this.projection=S.transform.projection)}registerFadeDuration(u){const g=u+this.timeAdded;g<_.f.now()||this.fadeEndTime&&g<this.fadeEndTime||(this.fadeEndTime=g)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=_.as(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(u,g,w){if(this.unloadVectorData(),this.state="loaded",u){u.featureIndex&&(this.latestFeatureIndex=u.featureIndex,u.rawTileData?(this.latestRawTileData=u.rawTileData,this.latestFeatureIndex.rawTileData=u.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=u.collisionBoxArray,this.buckets=function(S,D){const P={};if(!D)return P;for(const F of S){const U=F.layerIds.map(H=>D.getLayer(H)).filter(Boolean);if(0!==U.length){F.layers=U,F.stateDependentLayerIds&&(F.stateDependentLayers=F.stateDependentLayerIds.map(H=>U.filter(X=>X.id===H)[0]));for(const H of U)P[H.fqid]=F}}return P}(u.buckets,g.style),this.hasSymbolBuckets=!1;for(const S in this.buckets){const D=this.buckets[S];if(D instanceof _.aE){if(this.hasSymbolBuckets=!0,!w)break;D.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const S in this.buckets){const D=this.buckets[S];if(D instanceof _.aE&&D.hasRTLText){this.hasRTLText=!0,_.aF();break}}this.queryPadding=0;for(const S in this.buckets){const D=this.buckets[S],P=g.style.getOwnLayer(S);if(!P)continue;const F=P.queryRadius(D);this.queryPadding=Math.max(this.queryPadding,F)}u.imageAtlas&&(this.imageAtlas=u.imageAtlas),u.glyphAtlasImage&&(this.glyphAtlasImage=u.glyphAtlasImage),u.lineAtlas&&(this.lineAtlas=u.lineAtlas),this._lastUpdatedBrightness=u.brightness}else this.collisionBoxArray=new _.aD}unloadVectorData(){if(this.hasData()){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(u){return this.buckets[u.fqid]}upload(u){for(const S in this.buckets){const D=this.buckets[S];D.uploadPending()&&D.upload(u)}const g=u.gl,w=this.imageAtlas;if(w&&!w.uploaded){const S=!!Object.keys(w.patternPositions).length;this.imageAtlasTexture=new _.T(u,w.image,g.RGBA,{useMipmap:S}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new _.T(u,this.glyphAtlasImage,g.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new _.T(u,this.lineAtlas.image,g.R8),this.lineAtlas.uploaded=!0)}prepare(u,g,w){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(u,this.imageAtlasTexture,w),!g||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const S=g.style.getBrightness();(this._lastUpdatedBrightness||S)&&(this._lastUpdatedBrightness&&S&&Math.abs(this._lastUpdatedBrightness-S)<.001||(this._lastUpdatedBrightness=S,this.updateBuckets(void 0,g)))}queryRenderedFeatures(u,g,w,S,D,P,F,U){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:S,pixelPosMatrix:F,transform:P,params:D,tileTransform:this.tileTransform},u,g,w):{}}querySourceFeatures(u,g){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const S=w.loadVTLayers(),D=g?g.sourceLayer:"",P=S._geojsonTileLayer||S[D];if(!P)return;const F=_.aG(g&&g.filter),{z:U,x:H,y:X}=this.tileID.canonical,K={z:U,x:H,y:X};for(let ee=0;ee<P.length;ee++){const ie=P.feature(ee);if(F.needGeometry){const me=_.aH(ie,!0);if(!F.filter(new _.K(this.tileID.overscaledZ),me,this.tileID.canonical))continue}else if(!F.filter(new _.K(this.tileID.overscaledZ),ie))continue;const ae=w.getId(ie,D),ce=new _.aI(ie,U,H,X,ae);ce.tile=K,u.push(ce)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}bucketsLoaded(){for(const u in this.buckets)if(this.buckets[u].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(u){const g=this.expirationTime;if(u.cacheControl){const w=_.aJ(u.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else u.expires&&(this.expirationTime=new Date(u.expires).getTime());if(this.expirationTime){const w=Date.now();let S=!1;if(this.expirationTime>w)S=!1;else if(g)if(this.expirationTime<g)S=!0;else{const D=this.expirationTime-g;D?this.expirationTime=w+Math.max(D,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(u,g){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(u).length&&g&&this.updateBuckets(u,g)}updateBuckets(u,g){if(!this.latestFeatureIndex)return;const w=this.latestFeatureIndex.loadVTLayers(),S=g.style.listImages(),D=g.style.getBrightness();for(const P in this.buckets){if(!g.style.hasLayer(P))continue;const F=this.buckets[P],U=F.layers[0].sourceLayer||"_geojsonTileLayer",H=w[U];let X={};if(u&&(X=u[U],!H||!X||0===Object.keys(X).length))continue;if(F.update(X,H,S,this.imageAtlas&&this.imageAtlas.patternPositions||{},D),F instanceof _.aK||F instanceof _.aL){const ee=g.style.getOwnSourceCache(F.layers[0].source);g._terrain&&g._terrain.enabled&&ee&&F.programConfigurations.needsUpload&&g._terrain._clearRenderCacheForTile(ee.id,this.tileID)}const K=g&&g.style&&g.style.getOwnLayer(P);K&&(this.queryPadding=Math.max(this.queryPadding,K.queryRadius(F)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_.f.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(u){this.symbolFadeHoldUntil=_.f.now()+u}setTexture(u,g){const w=g.context,S=w.gl;this.texture=this.texture||g.getTileTexture(u.width),this.texture&&this.texture instanceof _.T?this.texture.update(u,{useMipmap:!0}):(this.texture=new _.T(w,u,S.RGBA,{useMipmap:!0}),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE))}setDependencies(u,g){const w={};for(const S of g)w[S]=!0;this.dependencies[u]=w}hasDependency(u,g){for(const w of u){const S=this.dependencies[w];if(S)for(const D of g)if(S[D])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(u,g){if(!g||"mercator"===g.name||this._tileDebugBuffer)return;const w=_.aM(ds,this.tileID.canonical,this.tileTransform)[0],S=new _.aN,D=new _.aO;for(let P=0;P<w.length;P++){const{x:F,y:U}=w[P];S.emplaceBack(F,U),D.emplaceBack(P)}D.emplaceBack(0),this._tileDebugIndexBuffer=u.createIndexBuffer(D),this._tileDebugBuffer=u.createVertexBuffer(S,_.aP.members),this._tileDebugSegments=_.aB.simpleSegment(0,0,S.length,D.length)}_makeTileBoundsBuffers(u,g){if(this._tileBoundsBuffer||!g||"mercator"===g.name)return;const w=_.aM(ds,this.tileID.canonical,this.tileTransform)[0];let S,D;if(this.isRaster){const P=function(F,U){const H=_.as(F,U),X=Math.pow(2,F.z);for(let me=0;me<33;me++)for(let se=0;se<33;se++){const be=_.at((F.x+(se+hr(se))/32)/X),Me=_.au((F.y+(me+hr(me))/32)/X),we=U.project(be,Me),Se=33*me+se;Zn[2*Se+0]=Math.round((we.x*H.scale-H.x)*_.V),Zn[2*Se+1]=Math.round((we.y*H.scale-H.y)*_.V)}zi.fill(0),Kr.fill(0);for(let me=2045;me>=0;me--){const se=4*me,be=sn[se+0],Me=sn[se+1],we=sn[se+2],Se=sn[se+3],pe=be+we>>1,De=Me+Se>>1,Fe=pe+De-Me,Ne=De+be-pe,je=33*Me+be,at=33*Se+we,Ke=33*De+pe,rt=Math.hypot((Zn[2*je+0]+Zn[2*at+0])/2-Zn[2*Ke+0],(Zn[2*je+1]+Zn[2*at+1])/2-Zn[2*Ke+1])>=16;zi[Ke]=zi[Ke]||(rt?1:0),me<1022&&(zi[Ke]=zi[Ke]||zi[33*(Me+Ne>>1)+(be+Fe>>1)]||zi[33*(Se+Ne>>1)+(we+Fe>>1)])}const K=new _.av,ee=new _.aw;let ie=0;function ae(me,se){const be=33*se+me;return 0===Kr[be]&&(K.emplaceBack(Zn[2*be+0],Zn[2*be+1],me*_.V/32,se*_.V/32),Kr[be]=++ie),Kr[be]-1}function ce(me,se,be,Me,we,Se){const pe=me+be>>1,De=se+Me>>1;if(Math.abs(me-we)+Math.abs(se-Se)>1&&zi[33*De+pe])ce(we,Se,me,se,pe,De),ce(be,Me,we,Se,pe,De);else{const Fe=ae(me,se),Ne=ae(be,Me),je=ae(we,Se);ee.emplaceBack(Fe,Ne,je)}}return ce(0,0,32,32,32,0),ce(32,32,0,0,0,32),{vertices:K,indices:ee}}(this.tileID.canonical,g);S=P.vertices,D=P.indices}else{S=new _.av,D=new _.aw;for(const{x:F,y:U}of w)S.emplaceBack(F,U,0,0);const P=_.aQ(S.int16,void 0,4);for(let F=0;F<P.length;F+=3)D.emplaceBack(P[F],P[F+1],P[F+2])}this._tileBoundsBuffer=u.createVertexBuffer(S,_.aR.members),this._tileBoundsIndexBuffer=u.createIndexBuffer(D),this._tileBoundsSegments=_.aB.simpleSegment(0,0,S.length,D.length)}_makeGlobeTileDebugBuffers(u,g){const w=g.projection;if(!w||"globe"!==w.name||g.freezeTileCoverage)return;const S=this.tileID.canonical,D=_.aS(S,g),P=_.aT(D),F=_.S(g.zoom);let U;F>0&&(U=_.a6.invert(new Float64Array(16),g.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(u,S,g,P,U,F),this._makeGlobeTileDebugTextBuffer(u,S,g,P,U,F)}_globePoint(u,g,w,S,D,P,F){let U=_.aU(u,g,w);if(P){const H=1<<w.z,X=_.a5(S.center.lng),K=_.ae(S.center.lat),ee=(w.x+.5)/H-X;let ie=0;ee>.5?ie=-1:ee<-.5&&(ie=1);let ae=(u/_.V+w.x)/H+ie,ce=(g/_.V+w.y)/H;ae=(ae-X)*S._pixelsPerMercatorPixel+X,ce=(ce-K)*S._pixelsPerMercatorPixel+K;const me=[ae*S.worldSize,ce*S.worldSize,0];_.N.transformMat4(me,me,P),U=_.aV(U,me,F)}return _.N.transformMat4(U,U,D)}_makeGlobeTileDebugBorderBuffer(u,g,w,S,D,P){const F=new _.aN,U=new _.aO,H=new _.aW,X=(ee,ie,ae,ce,me)=>{const se=(ae-ee)/(me-1),be=(ce-ie)/(me-1),Me=F.length;for(let we=0;we<me;we++){const Se=ee+we*se,pe=ie+we*be;F.emplaceBack(Se,pe);const De=this._globePoint(Se,pe,g,w,S,D,P);H.emplaceBack(De[0],De[1],De[2]),U.emplaceBack(Me+we)}},K=_.V;X(0,0,K,0,16),X(K,0,K,K,16),X(K,K,0,K,16),X(0,K,0,0,16),this._tileDebugIndexBuffer=u.createIndexBuffer(U),this._tileDebugBuffer=u.createVertexBuffer(F,_.aP.members),this._globeTileDebugBorderBuffer=u.createVertexBuffer(H,_.aX.members),this._tileDebugSegments=_.aB.simpleSegment(0,0,F.length,U.length)}_makeGlobeTileDebugTextBuffer(u,g,w,S,D,P){const F=_.V/4,U=new _.aN,H=new _.aw,X=new _.aW,K=25;H.reserve(32),U.reserve(K),X.reserve(K);const ee=(ie,ae)=>K*ie+ae;for(let ie=0;ie<K;ie++){const ae=ie*F;for(let ce=0;ce<K;ce++){const me=ce*F;U.emplaceBack(me,ae);const se=this._globePoint(me,ae,g,w,S,D,P);X.emplaceBack(se[0],se[1],se[2])}}for(let ie=0;ie<4;ie++)for(let ae=0;ae<4;ae++){const ce=ee(ie,ae),me=ee(ie,ae+1),se=ee(ie+1,ae),be=ee(ie+1,ae+1);H.emplaceBack(ce,me,se),H.emplaceBack(se,me,be)}this._tileDebugTextIndexBuffer=u.createIndexBuffer(H),this._tileDebugTextBuffer=u.createVertexBuffer(U,_.aP.members),this._globeTileDebugTextBuffer=u.createVertexBuffer(X,_.aX.members),this._tileDebugTextSegments=_.aB.simpleSegment(0,0,K,32)}destroy(u=!1){for(const g in this.buckets)this.buckets[g].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!u&&this.texture&&this.texture instanceof _.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}const Gd={vector:si,raster:ai,"raster-dem":class extends ai{constructor(x,u,g,w){super(x,u,g,w),this.type="raster-dem",this.maxzoom=22,this._options=_.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(x,u){const g=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function w(S,D){S&&(x.state="errored",u(S)),D&&(x.dem=D,x.dem.onDeserialize(),x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0,x.state="loaded",u(null))}x.request=_.d(this.map._requestManager.transformRequest(g,_.R.Tile),function(S,D,P,F){if(delete x.request,x.aborted)x.state="unloaded",u(null);else if(S)x.state="errored",u(S);else if(D){this.map._refreshExpiredTiles&&x.setExpiryData({cacheControl:P,expires:F});const U=ImageBitmap&&D instanceof ImageBitmap&&_.ak(),H=1-(D.width-_.al(D.width))/2;H<1||x.neighboringTiles||(x.neighboringTiles=this._getNeighboringTiles(x.tileID));const X=U?D:_.f.getImageData(D,H),K={uid:x.uid,coord:x.tileID,source:this.id,scope:this.scope,rawImageData:X,encoding:this.encoding,padding:H};x.actor&&"expired"!==x.state||(x.actor=this.dispatcher.getActor(),x.actor.send("loadDEMTile",K,w.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(x){const u=x.canonical,g=Math.pow(2,u.z),w=(u.x-1+g)%g,S=0===u.x?x.wrap-1:x.wrap,D=(u.x+1+g)%g,P=u.x+1===g?x.wrap+1:x.wrap,F={};return F[new _.am(x.overscaledZ,S,u.z,w,u.y).key]={backfilled:!1},F[new _.am(x.overscaledZ,P,u.z,D,u.y).key]={backfilled:!1},u.y>0&&(F[new _.am(x.overscaledZ,S,u.z,w,u.y-1).key]={backfilled:!1},F[new _.am(x.overscaledZ,x.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},F[new _.am(x.overscaledZ,P,u.z,D,u.y-1).key]={backfilled:!1}),u.y+1<g&&(F[new _.am(x.overscaledZ,S,u.z,w,u.y+1).key]={backfilled:!1},F[new _.am(x.overscaledZ,x.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},F[new _.am(x.overscaledZ,P,u.z,D,u.y+1).key]={backfilled:!1}),F}},"raster-array":Zt,geojson:class extends _.E{constructor(x,u,g,w){super(),this.id=x,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=g.getActor(),this.setEventedParent(w),this._data=u.data,this._options=_.e({},u),this._collectResourceTiming=u.collectResourceTiming,void 0!==u.maxzoom&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const S=_.V/this.tileSize;this.workerOptions=_.e({source:this.id,scope:this.scope,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(void 0!==u.buffer?u.buffer:128)*S,tolerance:(void 0!==u.tolerance?u.tolerance:.375)*S,extent:_.V,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:void 0!==u.clusterMaxZoom?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:_.V,radius:(void 0!==u.clusterRadius?u.clusterRadius:50)*S,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}onAdd(x){this.map=x,this.setData(this._data)}setData(x){return this._data=x,this._updateWorkerData(),this}getClusterExpansionZoom(x,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:x,source:this.id,scope:this.scope},u),this}getClusterChildren(x,u){return this.actor.send("geojson.getClusterChildren",{clusterId:x,source:this.id,scope:this.scope},u),this}getClusterLeaves(x,u,g,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:x,limit:u,offset:g},w),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new _.b("dataloading",{dataType:"source"})),this._loaded=!1;const x=_.e({},this.workerOptions);x.scope=this.scope;const u=this._data;"string"==typeof u?(x.request=this.map._requestManager.transformRequest(_.f.resolveURL(u),_.R.Source),x.request.collectResourceTiming=this._collectResourceTiming):x.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,x,(g,w)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new _.a(g));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(S.resourceTiming=w.resourceTiming[this.id]),this.fire(new _.b("data",S)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(x,u){const g=x.actor?"reloadTile":"loadTile";x.actor=this.actor;const w={type:this.type,uid:x.uid,tileID:x.tileID,tileZoom:x.tileZoom,zoom:x.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:_.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};x.request=this.actor.send(g,w,(S,D)=>(delete x.request,x.destroy(),x.aborted?u(null):S?u(S):(x.loadVectorData(D,this.map.painter,"reloadTile"===g),u(null))),void 0,"loadTile"===g)}abortTile(x){x.request&&(x.request.cancel(),delete x.request),x.aborted=!0}unloadTile(x){this.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id,scope:this.scope}),x.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return _.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends _.ap{constructor(x,u,g,w){super(x,u,g,w),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const x=this.options;this.urls=[];for(const u of x.urls)this.urls.push(this.map._requestManager.transformRequest(u,_.R.Source).url);_.aq(this.urls,(u,g)=>{this._loaded=!0,u?this.fire(new _.a(u)):g&&(this.video=g,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(x){if(this.video){const u=this.video.seekable;x<u.start(0)||x>u.end(0)?this.fire(new _.a(new St(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=x}}getVideo(){return this.video}onAdd(x){this.map||(this.map=x,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const x=this.map.painter.context,u=x.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new _.T(x,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(x)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:_.ap,model:class extends _.E{constructor(x,u,g,w){super(),this.id=x,this.type="model",this.models=[],this._loaded=!1,this._options=u}load(){const x=[];for(const u in this._options.models){const g=this._options.models[u],w=_.l(this.map._requestManager.transformRequest(g.uri,_.R.Model).url).then(S=>{if(!S)return;const D=_.c(S),P=new _.M(u,g.position,g.orientation,D);P.computeBoundsAndApplyParent(),this.models.push(P)}).catch(S=>{this.fire(new _.a(new Error(`Could not load model ${u} from ${g.uri}: ${S.message}`)))});x.push(w)}return Promise.allSettled(x).then(()=>{this._loaded=!0,this.fire(new _.b("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(u=>{this.fire(new _.a(new Error(`Could not load models: ${u.message}`)))})}onAdd(x){this.map=x,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(x,u){}serialize(){return{type:"model"}}},"batched-model":class extends _.E{constructor(x,u,g,w){super(),this.type="batched-model",this.id=x,this.tileSize=512,this._options=u,this.tiles=this._options.tiles,this.maxzoom=u.maxzoom||19,this.minzoom=u.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=g,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(w)}onAdd(x){this.map=x,this.load()}load(x){this._loaded=!1,this.fire(new _.b("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=st(this._options,this.map._requestManager,u,g,(w,S)=>{this._tileJSONRequest=null,this._loaded=!0,w?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&2!==g.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new _.a(w))):S&&(_.e(this,S),S.bounds&&(this.tileBounds=new ei(S.bounds,this.minzoom,this.maxzoom)),_.aj(S.tiles,this.map._requestManager._customAccessToken),this.fire(new _.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.b("data",{dataType:"source",sourceDataType:"content"}))),x&&x(w)})}hasTransition(){return!1}hasTile(x){return!this.tileBounds||this.tileBounds.contains(x.canonical)}loaded(){return this._loaded}loadTile(x,u){const g=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(g,_.R.Tile),data:void 0,uid:x.uid,tileID:x.tileID,tileZoom:x.tileZoom,zoom:x.tileID.overscaledZ,tileSize:this.tileSize*x.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:x.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(x.actor&&"expired"!==x.state)if("loading"===x.state)x.reloadCallback=u;else{if(x.buckets){const D=Object.values(x.buckets);for(const P of D)P.dirty=!0;return void(x.state="loaded")}x.request=x.actor.send("reloadTile",w,S.bind(this))}else x.actor=this.dispatcher.getActor(),x.request=x.actor.send("loadTile",w,S.bind(this),void 0,!0);function S(D,P){return x.aborted?u(null):D&&404!==D.status?u(D):(P&&(P.resourceTiming&&(x.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&x.setExpiryData(P),x.buckets={...x.buckets,...P.buckets},P.featureIndex&&(x.latestFeatureIndex=P.featureIndex)),x.state="loaded",void u(null))}}serialize(){return _.e({},this._options)}},canvas:class extends _.ap{constructor(x,u,g,w){super(x,u,g,w),u.coordinates?Array.isArray(u.coordinates)&&4===u.coordinates.length&&!u.coordinates.some(S=>!Array.isArray(S)||2!==S.length||S.some(D=>"number"!=typeof D))||this.fire(new _.a(new St(`sources.${x}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new _.a(new St(`sources.${x}`,null,'missing required property "coordinates"'))),u.animate&&"boolean"!=typeof u.animate&&this.fire(new _.a(new St(`sources.${x}`,null,'optional "animate" property must be a boolean value'))),u.canvas?"string"==typeof u.canvas||u.canvas instanceof HTMLCanvasElement||this.fire(new _.a(new St(`sources.${x}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new _.a(new St(`sources.${x}`,null,'missing required property "canvas"'))),this.options=u,this.animate=void 0===u.animate||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new _.a(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(x){this.map=x,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let x=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,x=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,x=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const u=this.map.painter.context;this.texture?!x&&!this._playing||this.texture instanceof _.ar||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _.T(u,this.canvas,u.gl.RGBA,{premultiply:!0}),this._prepareData(u)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const x of[this.canvas.width,this.canvas.height])if(isNaN(x)||x<=0)return!0;return!1}},custom:class extends _.E{constructor(x,u,g,w){super(),this.id=x,this.type="custom",this._dataType="raster",this._dispatcher=g,this._implementation=u,this.setEventedParent(w),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new _.a(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new _.a(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ei(this._implementation.bounds,this.minzoom,this.maxzoom)),u.update=this._update.bind(this),u.clearTiles=this._clearTiles.bind(this),u.coveringTiles=this._coveringTiles.bind(this),_.e(this,_.ac(u,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return _.ac(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new _.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new _.b("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(x){this._map=x,this._loaded=!1,this.fire(new _.b("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(x),this.load()}onRemove(x){this._implementation.onRemove&&this._implementation.onRemove(x)}hasTile(x){if(this._implementation.hasTile){const{x:u,y:g,z:w}=x.canonical;return this._implementation.hasTile({x:u,y:g,z:w})}return!this.tileBounds||this.tileBounds.contains(x.canonical)}loadTile(x,u){const{x:g,y:w,z:S}=x.tileID.canonical,D=new AbortController;x.request=Promise.resolve(this._implementation.loadTile({x:g,y:w,z:S},{signal:D.signal})).then(function(P){return delete x.request,x.aborted?(x.state="unloaded",u(null)):void 0===P?(x.state="errored",u(null)):null===P?(this.loadTileData(x,{width:this.tileSize,height:this.tileSize,data:null}),x.state="loaded",u(null)):(F=P)instanceof ImageData||F instanceof HTMLCanvasElement||F instanceof ImageBitmap||F instanceof HTMLImageElement?(this.loadTileData(x,P),x.state="loaded",void u(null)):(x.state="errored",u(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var F}.bind(this)).catch(P=>{20!==P.code&&(x.state="errored",u(P))}),x.request.cancel=()=>D.abort()}loadTileData(x,u){x.setTexture(u,this._map.painter)}unloadTile(x,u){if(x.texture&&x.texture instanceof _.T?(x.destroy(!0),x.texture&&x.texture instanceof _.T&&this._map.painter.saveTileTexture(x.texture)):x.destroy(),this._implementation.unloadTile){const{x:g,y:w,z:S}=x.tileID.canonical;this._implementation.unloadTile({x:g,y:w,z:S})}u()}abortTile(x,u){x.request&&x.request.cancel&&(x.request.cancel(),delete x.request),u()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(x=>({x:x.canonical.x,y:x.canonical.y,z:x.canonical.z}))}_clearTiles(){const x=_.ag(this.id,this.scope);this._map.style.clearSource(x)}_update(){this.fire(new _.b("data",{dataType:"source",sourceDataType:"content"}))}}},Ls=function(x,u,g,w){const S=new Gd[u.type](x,u,g,w);if(S.id!==x)throw new Error(`Expected Source id to be ${x} instead of ${S.id}`);return _.aY(["load","abort","unload","serialize","prepare"],S),S};function H_(x,u){const g=_.a6.identity([]);return _.a6.scale(g,g,[.5*x.width,.5*-x.height,1]),_.a6.translate(g,g,[1,-1,0]),_.a6.multiply(g,g,x.calculateProjMatrix(u.toUnwrapped())),Float32Array.from(g)}function pf(x,u,g,w,S,D,P,F=!1){const U=x.tilesIn(w,P,F);U.sort(Pc);const H=[];for(const K of U)H.push({wrappedTileID:K.tile.tileID.wrapped().key,queryResults:K.tile.queryRenderedFeatures(u,g,x._state,K,S,D,H_(x.transform,K.tile.tileID),F)});const X=function(K){const ee={},ie={};for(const ae of K){const ce=ae.queryResults,me=ae.wrappedTileID,se=ie[me]=ie[me]||{};for(const be in ce){const Me=ce[be],we=se[be]=se[be]||{},Se=ee[be]=ee[be]||[];for(const pe of Me)we[pe.featureIndex]||(we[pe.featureIndex]=!0,Se.push(pe))}}return ee}(H);for(const K in X)X[K].forEach(ee=>{const ie=ee.feature,ae=ie.layer;ae&&"background"!==ae.type&&"sky"!==ae.type&&"slot"!==ae.type&&(ie.source=ae.source,ae["source-layer"]&&(ie.sourceLayer=ae["source-layer"]),ie.state=void 0!==ie.id?x.getFeatureState(ae["source-layer"],ie.id):{})});return X}function rd(x,u){const g=x.getRenderableIds().map(D=>x.getTileByID(D)),w=[],S={};for(let D=0;D<g.length;D++){const P=g[D],F=P.tileID.canonical.key;S[F]||(S[F]=!0,P.querySourceFeatures(w,u))}return w}function Pc(x,u){const g=x.tileID,w=u.tileID;return g.overscaledZ-w.overscaledZ||g.canonical.y-w.canonical.y||g.wrap-w.wrap||g.canonical.x-w.canonical.x}class od extends Ul{constructor(u,g,w,S,D){super(u,g,w,S,D),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(u,g){const w=g.context,S=w.gl;this.texture=this.texture||g.getTileTexture(u.width),this.texture&&this.texture instanceof _.T?this.texture.update(u,{useMipmap:!1,premultiply:!1}):this.texture=new _.T(w,u,S.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(u=16384,g){const w=this._mrt=new _.aZ(30),S=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(u-1)}});return this.entireBuffer=null,this.request=_.a_(S,(D,P,F,U)=>{if(D)g(D);else try{const H=w.getHeaderLength(P);if(H>u)return void(this.request=this.fetchHeader(H,g));w.parseHeader(P),this._isHeaderLoaded=!0;let X=0;for(const K of Object.values(w.layers))X=Math.max(X,K.dataIndex[K.dataIndex.length-1].last_byte);P.byteLength>=X&&(this.entireBuffer=P),g(null,this.entireBuffer||P,F,U)}catch(H){g(H)}}),this.request}fetchBand(u,g,w){const S=this._mrt;if(!this._isHeaderLoaded||!S)return void w(new Error("Tile header is not ready"));const D=this.actor;if(!D)return void w(new Error("Can't fetch tile band without an actor"));let P;const F=(K,ee)=>{P.complete(K,ee),K?w(K):(this.updateTextureDescriptor(u,g),w(null,this.textureDescriptor&&this.textureDescriptor.img))},U=(K,ee)=>{if(K)return w(K);const ie=D.send("decodeRasterArray",{buffer:ee,task:P},F,void 0,!0);this._workQueue.push(()=>{ie&&ie.cancel(),P.cancel()})},H=S.getLayer(u);if(!H)return void w(new Error(`Unknown sourceLayer "${u}"`));if(H.hasDataForBand(g))return this.updateTextureDescriptor(u,g),void w(null,this.textureDescriptor?this.textureDescriptor.img:null);const X=H.getDataRange([g]);if(P=S.createDecodingTask(X),!P||P.tasks.length)if(this.flushQueues(),this.entireBuffer)U(null,this.entireBuffer.slice(X.firstByte,X.lastByte+1));else{const K=Object.assign({},this.requestParams,{headers:{Range:`bytes=${X.firstByte}-${X.lastByte}`}}),ee=_.a_(K,U);this._fetchQueue.push(()=>{ee.cancel(),P.cancel()})}else w(null)}updateNeeded(u,g){return(!this.textureDescriptor||this.textureDescriptor.band!==g||this.textureDescriptor.layer!==u)&&"errored"!==this.state}updateTextureDescriptor(u,g){if(!this._mrt)return;const w=this._mrt.getLayer(u);if(!w||!w.hasBand(g)||!w.hasDataForBand(g))return;const{bytes:S,tileSize:D,buffer:P,offset:F,scale:U}=w.getBandView(g),H=D+2*P,X={data:S,width:H,height:H},K=this.texture;K&&K instanceof _.T&&K.update(X,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:u,band:g,img:X,buffer:P,offset:F,tileSize:D,format:w.pixelFormat,mix:[U,256*U,65536*U,16777216*U]}}}class sd{constructor(u,g){this.max=u,this.onRemove=g,this.reset()}reset(){for(const u in this.data)for(const g of this.data[u])g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value);return this.data={},this.order=[],this}add(u,g,w){const S=u.wrapped().key;void 0===this.data[S]&&(this.data[S]=[]);const D={value:g,timeout:void 0};if(void 0!==w&&(D.timeout=setTimeout(()=>{this.remove(u,D)},w)),this.data[S].push(D),this.order.push(S),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(u){return u.wrapped().key in this.data}getAndRemove(u){return this.has(u)?this._getAndRemoveByKey(u.wrapped().key):null}_getAndRemoveByKey(u){const g=this.data[u].shift();return g.timeout&&clearTimeout(g.timeout),0===this.data[u].length&&delete this.data[u],this.order.splice(this.order.indexOf(u),1),g.value}getByKey(u){const g=this.data[u];return g?g[0].value:null}get(u){return this.has(u)?this.data[u.wrapped().key][0].value:null}remove(u,g){if(!this.has(u))return this;const w=u.wrapped().key,S=void 0===g?0:this.data[w].indexOf(g),D=this.data[w][S];return this.data[w].splice(S,1),D.timeout&&clearTimeout(D.timeout),0===this.data[w].length&&delete this.data[w],this.onRemove(D.value),this.order.splice(this.order.indexOf(w),1),this}setMaxSize(u){for(this.max=u;this.order.length>this.max;){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}filter(u){const g=[];for(const w in this.data)for(const S of this.data[w])u(S.value)||g.push(S);for(const w of g)this.remove(w.value.tileID,w)}}class cc extends _.E{constructor(u,g,w){super(),this.id=u,this._onlySymbols=w,g.on("data",S=>{"source"===S.dataType&&"metadata"===S.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===S.dataType&&"content"===S.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),g.on("error",()=>{this._sourceErrored=!0}),this._source=g,this._tiles={},this._cache=new sd(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new mi,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"raster-array"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(u){this.map=u,this._minTileCacheSize=void 0===this._minTileCacheSize&&u?u._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&u?u._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const u in this._tiles){const g=this._tiles[u];if("errored"!==g.state&&("loaded"!==g.state||!g.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const u=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,u&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(u,g){return u.isSymbolTile=this._onlySymbols,u.isExtraShadowCaster=this._shadowCasterTiles[u.tileID.key],this._source.loadTile(u,g)}_unloadTile(u){if(this._source.unloadTile)return this._source.unloadTile(u,()=>{})}_abortTile(u){if(this._source.abortTile)return this._source.abortTile(u,()=>{})}serialize(){return this._source.serialize()}prepare(u){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const g in this._tiles){const w=this._tiles[g];w.upload(u),w.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return _.a$(this._tiles).map(u=>u.tileID).sort(Ms).map(u=>u.key)}getRenderableIds(u,g){const w=[];for(const S in this._tiles)this._isIdRenderable(+S,u,g)&&w.push(this._tiles[S]);return u?w.sort((S,D)=>{const P=S.tileID,F=D.tileID,U=new _.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle),H=new _.P(F.canonical.x,F.canonical.y)._rotate(this.transform.angle);return P.overscaledZ-F.overscaledZ||H.y-U.y||H.x-U.x}).map(S=>S.tileID.key):w.map(S=>S.tileID).sort(Ms).map(S=>S.key)}hasRenderableParent(u){const g=this.findLoadedParent(u,0);return!!g&&this._isIdRenderable(g.tileID.key)}_isIdRenderable(u,g,w){return this._tiles[u]&&this._tiles[u].hasData()&&!this._coveredTiles[u]&&(g||!this._tiles[u].holdingForFade())&&(w||!this._shadowCasterTiles[u])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)"errored"!==this._tiles[u].state&&this._reloadTile(+u,"reloading")}}_reloadTile(u,g){const w=this._tiles[u];w&&("loading"!==w.state&&(w.state=g),this._loadTile(w,this._tileLoaded.bind(this,w,u,g)))}_tileLoaded(u,g,w,S){if(S)if(u.state="errored",404!==S.status)this._source.fire(new _.a(S,{tile:u}));else{if(!(u.tileID.key in this._loadedParentTiles))return void this._source.fire(new _.b("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const D=this.map.painter.terrain;this.update(this.transform,D.getScaledDemTileSize(),!0),D.resetTileLookupCache(this.id)}else this.update(this.transform)}else u.timeAdded=_.f.now(),"expired"===w&&(u.refreshedUponExpiration=!0),this._setTileReloadTimer(g,u),"raster-dem"===this._source.type&&u.dem&&this._backfillDEM(u),this._state.initializeTileState(u,this.map?this.map.painter:null),this._source.fire(new _.b("data",{dataType:"source",tile:u,coord:u.tileID,sourceCacheId:this.id}))}_backfillDEM(u){const g=this.getRenderableIds();for(let S=0;S<g.length;S++){const D=g[S];if(u.neighboringTiles&&u.neighboringTiles[D]){const P=this.getTileByID(D);w(u,P),w(P,u)}}function w(S,D){if(!S.dem||S.dem.borderReady)return;S.needsHillshadePrepare=!0,S.needsDEMTextureUpload=!0;let P=D.tileID.canonical.x-S.tileID.canonical.x;const F=D.tileID.canonical.y-S.tileID.canonical.y,U=Math.pow(2,S.tileID.canonical.z),H=D.tileID.key;0===P&&0===F||Math.abs(F)>1||(Math.abs(P)>1&&(1===Math.abs(P+U)?P+=U:1===Math.abs(P-U)&&(P-=U)),D.dem&&S.dem&&(S.dem.backfillBorder(D.dem,P,F),S.neighboringTiles&&S.neighboringTiles[H]&&(S.neighboringTiles[H].backfilled=!0)))}}getTile(u){return this.getTileByID(u.key)}getTileByID(u){return this._tiles[u]}_retainLoadedChildren(u,g,w,S){for(const D in this._tiles){let P=this._tiles[D];if(S[D]||!P.hasData()||P.tileID.overscaledZ<=g||P.tileID.overscaledZ>w)continue;let F=P.tileID;for(;P&&P.tileID.overscaledZ>g+1;){const H=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[H.key],P&&P.hasData()&&(F=H)}let U=F;for(;U.overscaledZ>g;)if(U=U.scaledTo(U.overscaledZ-1),u[U.key]){S[F.key]=F;break}}}findLoadedParent(u,g){if(u.key in this._loadedParentTiles){const w=this._loadedParentTiles[u.key];return w&&w.tileID.overscaledZ>=g?w:null}for(let w=u.overscaledZ-1;w>=g;w--){const S=u.scaledTo(w),D=this._getLoadedTile(S);if(D)return D}}_getLoadedTile(u){const g=this._tiles[u.key];return g&&g.hasData()?g:this._cache.getByKey(this._source.reparseOverscaled?u.wrapped().key:u.canonical.key)}updateCacheSize(u,g){g=g||this._source.tileSize;const w=Math.ceil(u.width/g)+1,S=Math.ceil(u.height/g)+1,D=Math.floor(w*S*5),P="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,D):D,F="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,P):P;this._cache.setMaxSize(F)}handleWrapJump(u){const g=Math.round((u-(void 0===this._prevLng?u:this._prevLng))/360);if(this._prevLng=u,g){const w={};for(const S in this._tiles){const D=this._tiles[S];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+g),w[D.tileID.key]=D}this._tiles=w;for(const S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(const S in this._tiles)this._setTileReloadTimer(+S,this._tiles[S])}}update(u,g,w,S){if(this.transform=u,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!w)return;let D;if(this.updateCacheSize(u,g),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain)if(this._source.tileID)D=u.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new _.am(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y));else if(0!==this.tileCoverLift){const U=u.clone();U.tileCoverLift=this.tileCoverLift,D=U.coveringTiles({tileSize:g||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!w,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&"globe"===u.projection.name&&(D.push(new _.am(1,0,1,0,0)),D.push(new _.am(1,0,1,1,0)),D.push(new _.am(1,0,1,0,1)),D.push(new _.am(1,0,1,1,1)))}else D=u.coveringTiles({tileSize:g||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!w,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(D=D.filter(U=>this._source.hasTile(U)));else D=[];if(D.length>0&&this.castsShadows&&S&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!dc(this._source.type)){const U=u.coveringZoomLevel({tileSize:g||this._source.tileSize,roundZoom:this._source.roundZoom&&!w}),H=Math.min(U,this._source.maxzoom),X=u.extendTileCoverForShadows(D,S,H);for(const K of X)this._shadowCasterTiles[K.key]=!0,D.push(K)}const P=this._updateRetainedTiles(D);if(dc(this._source.type)&&0!==D.length){const U={},H={},X=Object.keys(P);for(const ee of X){const ie=P[ee],ae=this._tiles[ee];if(!ae||ae.fadeEndTime&&ae.fadeEndTime<=_.f.now())continue;const ce=this.findLoadedParent(ie,Math.max(ie.overscaledZ-cc.maxOverzooming,this._source.minzoom));ce&&(this._addTile(ce.tileID),U[ce.tileID.key]=ce.tileID),H[ee]=ie}const K=D[D.length-1].overscaledZ;for(const ee in this._tiles){const ie=this._tiles[ee];if(P[ee]||!ie.hasData())continue;let ae=ie.tileID;for(;ae.overscaledZ>K;){ae=ae.scaledTo(ae.overscaledZ-1);const ce=this._tiles[ae.key];if(ce&&ce.hasData()&&H[ae.key]){P[ee]=ie.tileID;break}}}for(const ee in U)P[ee]||(this._coveredTiles[ee]=!0,P[ee]=U[ee])}for(const U in P)this._tiles[U].clearFadeHold();const F=_.b0(this._tiles,P);for(const U of F){const H=this._tiles[U];H.hasSymbolBuckets&&!H.holdingForFade()?H.setHoldDuration(this.map._fadeDuration):H.hasSymbolBuckets&&!H.symbolFadeFinished()||this._removeTile(+U)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const u in this._tiles)this._tiles[u].holdingForFade()&&this._removeTile(+u)}_updateRetainedTiles(u){const g={};if(0===u.length)return g;const w={},S=u.reduce((H,X)=>Math.min(H,X.overscaledZ),1/0),D=u[0].overscaledZ,P=Math.max(D-cc.maxOverzooming,this._source.minzoom),F=Math.max(D+cc.maxUnderzooming,this._source.minzoom),U={};for(const H of u){const X=this._addTile(H);g[H.key]=H,X.hasData()||S<this._source.maxzoom&&(U[H.key]=H)}this._retainLoadedChildren(U,S,F,g);for(const H of u){let X=this._tiles[H.key];if(X.hasData())continue;if(H.canonical.z>=this._source.maxzoom){const ee=H.children(this._source.maxzoom)[0],ie=this.getTile(ee);if(ie&&ie.hasData()){g[ee.key]=ee;continue}}else{const ee=H.children(this._source.maxzoom);if(g[ee[0].key]&&g[ee[1].key]&&g[ee[2].key]&&g[ee[3].key])continue}let K=X.wasRequested();for(let ee=H.overscaledZ-1;ee>=P;--ee){const ie=H.scaledTo(ee);if(w[ie.key]||(w[ie.key]=!0,X=this.getTile(ie),!X&&K&&(X=this._addTile(ie)),X&&(g[ie.key]=ie,K=X.wasRequested(),X.hasData())))break}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const u in this._tiles){const g=[];let w,S=this._tiles[u].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){w=this._loadedParentTiles[S.key];break}g.push(S.key);const D=S.scaledTo(S.overscaledZ-1);if(w=this._getLoadedTile(D),w)break;S=D}for(const D of g)this._loadedParentTiles[D]=w}}_addTile(u){let g=this._tiles[u.key];if(g)return!0!==g.isExtraShadowCaster||this._shadowCasterTiles[u.key]||this._reloadTile(u.key,"reloading"),g;g=this._cache.getAndRemove(u),g&&(this._setTileReloadTimer(u.key,g),g.tileID=u,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[u.key]&&(clearTimeout(this._cacheTimers[u.key]),delete this._cacheTimers[u.key],this._setTileReloadTimer(u.key,g)));const w=!!g;if(!w){const S=this.map?this.map.painter:null,D=this._source.tileSize*u.overscaleFactor();g="raster-array"===this._source.type?new od(u,D,this.transform.tileZoom,S,this._isRaster):new Ul(u,D,this.transform.tileZoom,S,this._isRaster),this._loadTile(g,this._tileLoaded.bind(this,g,u.key,g.state))}return g?(g.uses++,this._tiles[u.key]=g,w||this._source.fire(new _.b("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g):null}_setTileReloadTimer(u,g){u in this._timers&&(clearTimeout(this._timers[u]),delete this._timers[u]);const w=g.getExpiryTimeout();w&&(this._timers[u]=setTimeout(()=>{this._reloadTile(u,"expired"),delete this._timers[u]},w))}_removeTile(u){const g=this._tiles[u];g&&(g.uses--,delete this._tiles[u],this._timers[u]&&(clearTimeout(this._timers[u]),delete this._timers[u]),g.uses>0||(g.hasData()&&"reloading"!==g.state||"empty"===g.state?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const u in this._tiles)this._removeTile(+u);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(u,g,w){const S=[],D=this.transform;if(!D)return S;const P="globe"===D.projection.name,F=_.a5(D.center.lng);for(const U in this._tiles){const H=this._tiles[U];if(w&&H.clearQueryDebugViz(),H.holdingForFade())continue;let X;if(P){const K=H.tileID.canonical;if(0===K.z){const ee=[Math.abs(_.aa(F,...vh(K,-1))-F),Math.abs(_.aa(F,...vh(K,1))-F)];X=[0,2*ee.indexOf(Math.min(...ee))-1]}else{const ee=[Math.abs(_.aa(F,...vh(K,-1))-F),Math.abs(_.aa(F,...vh(K,0))-F),Math.abs(_.aa(F,...vh(K,1))-F)];X=[ee.indexOf(Math.min(...ee))-1]}}else X=[0];for(const K of X){const ee=u.containsTile(H,D,g,K);ee&&S.push(ee)}}return S}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(u){return this._getRenderableCoordinates(u)}_getRenderableCoordinates(u,g){const w=this.getRenderableIds(u,g).map(D=>this._tiles[D].tileID),S="globe"===this.transform.projection.name;for(const D of w)D.projMatrix=this.transform.calculateProjMatrix(D.toUnwrapped()),D.expandedProjMatrix=S?this.transform.calculateProjMatrix(D.toUnwrapped(),!1,!0):D.projMatrix;return w}sortCoordinatesByDistance(u){const g=u.slice(),w=this.transform._camera.position,S=this.transform._camera.forward(),D={};for(const P of g){const F=1/(1<<P.canonical.z);D[P.key]=((P.canonical.x+.5)*F+P.wrap-w[0])*S[0]+((P.canonical.y+.5)*F-w[1])*S[1]-w[2]*S[2]}return g.sort((P,F)=>D[P.key]-D[F.key]),g}hasTransition(){if(this._source.hasTransition())return!0;if(dc(this._source.type))for(const u in this._tiles){const g=this._tiles[u];if(void 0!==g.fadeEndTime&&g.fadeEndTime>=_.f.now())return!0}return!1}setFeatureState(u,g,w){this._state.updateState(u=u||"_geojsonTileLayer",g,w)}removeFeatureState(u,g,w){this._state.removeFeatureState(u=u||"_geojsonTileLayer",g,w)}getFeatureState(u,g){return this._state.getState(u=u||"_geojsonTileLayer",g)}setDependencies(u,g,w){const S=this._tiles[u];S&&S.setDependencies(g,w)}reloadTilesForDependencies(u,g){for(const w in this._tiles)this._tiles[w].hasDependency(u,g)&&this._reloadTile(+w,"reloading");this._cache.filter(w=>!w.hasDependency(u,g))}_preloadTiles(u,g){if(!this._sourceLoaded){const U=()=>{this._sourceLoaded&&(this._source.off("data",U),this._preloadTiles(u,g))};return void this._source.on("data",U)}const w=new Map,S=Array.isArray(u)?u:[u],D=this.map.painter.terrain,P=this.usedForTerrain&&D?D.getScaledDemTileSize():this._source.tileSize;for(const U of S){const H=U.coveringTiles({tileSize:P,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const X of H)w.set(X.key,X);this.usedForTerrain&&U.updateElevation(!1)}const F=Array.from(w.values());_.b1(F,(U,H)=>{const X=new Ul(U,this._source.tileSize*U.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(X,K=>{"raster-dem"===this._source.type&&X.dem&&this._backfillDEM(X),H(K,X)})},g)}}function Ms(x,u){const g=Math.abs(2*x.wrap)-+(x.wrap<0),w=Math.abs(2*u.wrap)-+(u.wrap<0);return x.overscaledZ-u.overscaledZ||w-g||u.canonical.y-x.canonical.y||u.canonical.x-x.canonical.x}function dc(x){return"raster"===x||"image"===x||"video"===x||"custom"===x}function vh(x,u){const g=1<<x.z;return[x.x/g+u,(x.x+1)/g+u]}cc.maxOverzooming=10,cc.maxUnderzooming=3;class $_{constructor(u){this.style=u,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const u=!1,g=!1;for(const w in this.style._mergedLayers){const S=this.style._mergedLayers[w];if("fill-extrusion"===S.type)this.layers.push({layer:S,visible:u,visibilityChanged:g});else if("model"===S.type){const D=this.style.getLayerSource(S);D&&"batched-model"===D.type&&this.layers.push({layer:S,visible:u,visibilityChanged:g})}}}onNewFrame(u){this.layersGotHidden=!1;for(const g of this.layers){const w=g.layer;let S=!1;"fill-extrusion"===w.type?S=!w.isHidden(u)&&w.paint.get("fill-extrusion-opacity")>0:"model"===w.type&&(S=!w.isHidden(u)&&w.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!S&&g.visible,g.visible=S}}updateZOffset(u,g){this.currentBuildingBuckets=[];for(const S of this.layers){const D=S.layer,P=this.style.getLayerSourceCache(D);let F=1;"fill-extrusion"===D.type&&(F=S.visible?D.paint.get("fill-extrusion-vertical-scale"):0);let U=P?P.getTile(g):null;if(!U&&P&&g.canonical.z>P.getSource().minzoom){let H=g.scaledTo(Math.min(P.getSource().maxzoom,g.overscaledZ-1));for(;H.overscaledZ>=P.getSource().minzoom&&(U=P.getTile(H),!U&&0!==H.overscaledZ);)H=H.scaledTo(H.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:U?U.getBucket(D):null,tileID:U?U.tileID:g,verticalScale:F})}u.hasAnyZOffset=!1;let w=!1;for(let S=0;S<u.symbolInstances.length;S++){const D=u.symbolInstances.get(S),P=D.zOffset,F=this._getHeightAtTileOffset(g,D.tileAnchorX,D.tileAnchorY);D.zOffset=F!==Number.NEGATIVE_INFINITY?F:P,w||P===D.zOffset||(w=!0),u.hasAnyZOffset||0===D.zOffset||(u.hasAnyZOffset=!0)}w&&(u.zOffsetBuffersNeedUpload=!0,u.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(u,g,w,S){let D=g,P=w;if(u.canonical.z!==S.canonical.z){const F=S.canonical,U=1/(1<<u.canonical.z-F.z);D=(g+u.canonical.x*_.V)*U-F.x*_.V|0,P=(w+u.canonical.y*_.V)*U-F.y*_.V|0}return{tileX:D,tileY:P}}_getHeightAtTileOffset(u,g,w){let S,D;for(let P=0;P<this.layers.length;++P){if("fill-extrusion"!==this.layers[P].layer.type)continue;const{bucket:F,tileID:U,verticalScale:H}=this.currentBuildingBuckets[P];if(!F)continue;const{tileX:X,tileY:K}=this._mapCoordToOverlappingTile(u,g,w,U),ee=F.getHeightAtTileCoord(X,K);ee&&void 0!==ee.height&&(ee.hidden?S=ee.height:D=Math.max(ee.height*H,D||0))}if(void 0!==D)return D;for(let P=0;P<this.layers.length;++P){const F=this.layers[P];if("model"!==F.layer.type||!F.visible)continue;const{bucket:U,tileID:H}=this.currentBuildingBuckets[P];if(!U)continue;const{tileX:X,tileY:K}=this._mapCoordToOverlappingTile(u,g,w,H),ee=U.getHeightAtTileCoord(X,K);if(ee&&!ee.hidden)return void 0===ee.height&&void 0!==S?Math.min(ee.maxHeight,S)*ee.verticalScale:(ee.height||0)*ee.verticalScale}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Hd(x,u){const g={};for(const w in x)"ref"!==w&&(g[w]=x[w]);return _.b2.forEach(w=>{w in u&&(g[w]=u[w])}),g}function gf(x){x=x.slice();const u=Object.create(null);for(let g=0;g<x.length;g++)u[x[g].id]=x[g];for(let g=0;g<x.length;g++)"ref"in x[g]&&(x[g]=Hd(x[g],u[x[g].ref]));return x}const Kn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function zm(x,u,g){g.push({command:Kn.addSource,args:[x,u[x]]})}function Oc(x,u,g){u.push({command:Kn.removeSource,args:[x]}),g[x]=!0}function he(x,u,g,w){Oc(x,g,w),zm(x,u,g)}function N(x,u,g){let w;for(w in x[g])if(x[g].hasOwnProperty(w)&&"data"!==w&&!Tt(x[g][w],u[g][w]))return!1;for(w in u[g])if(u[g].hasOwnProperty(w)&&"data"!==w&&!Tt(x[g][w],u[g][w]))return!1;return!0}function W(x,u,g,w,S,D){let P;for(P in u=u||{},x=x||{})x.hasOwnProperty(P)&&(Tt(x[P],u[P])||g.push({command:D,args:[w,P,u[P],S]}));for(P in u)u.hasOwnProperty(P)&&!x.hasOwnProperty(P)&&(Tt(x[P],u[P])||g.push({command:D,args:[w,P,u[P],S]}))}function re(x){return x.id}function _e(x,u){return x[u.id]=u,x}class Ie{constructor(u,g){this.reset(u,g)}reset(u,g){this.points=u||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(1===this.points.length)return this.points[0];u=_.aa(u,0,1);let g=1,w=this._distances[g];const S=u*this.paddedLength+this.padding;for(;w<S&&g<this._distances.length;)w=this._distances[++g];const D=g-1,P=this._distances[D],F=w-P,U=F>0?(S-P)/F:0;return this.points[D].mult(1-U).add(this.points[g].mult(U))}}class $e{constructor(u,g,w){const S=this.boxCells=[],D=this.circleCells=[];this.xCellCount=Math.ceil(u/w),this.yCellCount=Math.ceil(g/w);for(let P=0;P<this.xCellCount*this.yCellCount;P++)S.push([]),D.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=g,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,g,w,S,D){this._forEachCell(g,w,S,D,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(g),this.bboxes.push(w),this.bboxes.push(S),this.bboxes.push(D)}insertCircle(u,g,w,S){this._forEachCell(g-S,w-S,g+S,w+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(g),this.circles.push(w),this.circles.push(S)}_insertBoxCell(u,g,w,S,D,P){this.boxCells[D].push(P)}_insertCircleCell(u,g,w,S,D,P){this.circleCells[D].push(P)}_query(u,g,w,S,D,P){if(w<0||u>this.width||S<0||g>this.height)return!D&&[];const F=[];if(u<=0&&g<=0&&this.width<=w&&this.height<=S){if(D)return!0;for(let U=0;U<this.boxKeys.length;U++)F.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const H=this.circles[3*U],X=this.circles[3*U+1],K=this.circles[3*U+2];F.push({key:this.circleKeys[U],x1:H-K,y1:X-K,x2:H+K,y2:X+K})}return P?F.filter(P):F}return this._forEachCell(u,g,w,S,this._queryCell,F,{hitTest:D,seenUids:{box:{},circle:{}}},P),D?F.length>0:F}_queryCircle(u,g,w,S,D){const P=u-w,F=u+w,U=g-w,H=g+w;if(F<0||P>this.width||H<0||U>this.height)return!S&&[];const X=[];return this._forEachCell(P,U,F,H,this._queryCellCircle,X,{hitTest:S,circle:{x:u,y:g,radius:w},seenUids:{box:{},circle:{}}},D),S?X.length>0:X}query(u,g,w,S,D){return this._query(u,g,w,S,!1,D)}hitTest(u,g,w,S,D){return this._query(u,g,w,S,!0,D)}hitTestCircle(u,g,w,S){return this._queryCircle(u,g,w,!0,S)}_queryCell(u,g,w,S,D,P,F,U){const H=F.seenUids,X=this.boxCells[D];if(null!==X){const ee=this.bboxes;for(const ie of X)if(!H.box[ie]){H.box[ie]=!0;const ae=4*ie;if(u<=ee[ae+2]&&g<=ee[ae+3]&&w>=ee[ae+0]&&S>=ee[ae+1]&&(!U||U(this.boxKeys[ie]))){if(F.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[ie],x1:ee[ae],y1:ee[ae+1],x2:ee[ae+2],y2:ee[ae+3]})}}}const K=this.circleCells[D];if(null!==K){const ee=this.circles;for(const ie of K)if(!H.circle[ie]){H.circle[ie]=!0;const ae=3*ie;if(this._circleAndRectCollide(ee[ae],ee[ae+1],ee[ae+2],u,g,w,S)&&(!U||U(this.circleKeys[ie]))){if(F.hitTest)return P.push(!0),!0;{const ce=ee[ae],me=ee[ae+1],se=ee[ae+2];P.push({key:this.circleKeys[ie],x1:ce-se,y1:me-se,x2:ce+se,y2:me+se})}}}}}_queryCellCircle(u,g,w,S,D,P,F,U){const H=F.circle,X=F.seenUids,K=this.boxCells[D];if(null!==K){const ie=this.bboxes;for(const ae of K)if(!X.box[ae]){X.box[ae]=!0;const ce=4*ae;if(this._circleAndRectCollide(H.x,H.y,H.radius,ie[ce+0],ie[ce+1],ie[ce+2],ie[ce+3])&&(!U||U(this.boxKeys[ae])))return P.push(!0),!0}}const ee=this.circleCells[D];if(null!==ee){const ie=this.circles;for(const ae of ee)if(!X.circle[ae]){X.circle[ae]=!0;const ce=3*ae;if(this._circlesCollide(ie[ce],ie[ce+1],ie[ce+2],H.x,H.y,H.radius)&&(!U||U(this.circleKeys[ae])))return P.push(!0),!0}}}_forEachCell(u,g,w,S,D,P,F,U){const H=this._convertToXCellCoord(u),X=this._convertToYCellCoord(g),K=this._convertToXCellCoord(w),ee=this._convertToYCellCoord(S);for(let ie=H;ie<=K;ie++)for(let ae=X;ae<=ee;ae++)if(D.call(this,u,g,w,S,this.xCellCount*ae+ie,P,F,U))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,g,w,S,D,P){const F=S-u,U=D-g,H=w+P;return H*H>F*F+U*U}_circleAndRectCollide(u,g,w,S,D,P,F){const U=(P-S)/2,H=Math.abs(u-(S+U));if(H>U+w)return!1;const X=(F-D)/2,K=Math.abs(g-(D+X));if(K>X+w)return!1;if(H<=U||K<=X)return!0;const ee=H-U,ie=K-X;return ee*ee+ie*ie<=w*w}}const Ue={unknown:0,flipRequired:1,flipNotRequired:2},Ct=Math.tan(85*Math.PI/180);function zt(x,u,g,w,S,D,P){const F=_.a6.create();if(g)if("globe"===D.name){const U=_.b3(S,u);_.a6.multiply(F,F,U)}else{const U=_.b4.invert([],P);F[0]=U[0],F[1]=U[1],F[4]=U[2],F[5]=U[3],w||_.a6.rotateZ(F,F,S.angle)}else _.a6.multiply(F,S.labelPlaneMatrix,x);return F}function li(x,u,g,w,S,D,P){const F=zt(x,u,g,w,S,D,P);return"globe"===D.name&&g||(F[2]=F[6]=F[10]=F[14]=0),F}function Ln(x,u,g,w,S,D,P){if(g){if("globe"===D.name){const F=zt(x,u,g,w,S,D,P);return _.a6.invert(F,F),_.a6.multiply(F,x,F),F}{const F=_.a6.clone(x),U=_.a6.identity([]);return U[0]=P[0],U[1]=P[1],U[4]=P[2],U[5]=P[3],_.a6.multiply(F,F,U),w||_.a6.rotateZ(F,F,-S.angle),F}}return S.glCoordMatrix}function En(x,u,g,w){const S=[x,u,g,1];g?_.a7.transformMat4(S,S,w):Fc(S,S,w);const D=S[3];return S[0]/=D,S[1]/=D,S[2]/=D,S}function Wn(x,u){return Math.min(.5+x/u*.5,1.5)}function pr(x,u){const g=x[0]/x[3],w=x[1]/x[3];return g>=-u[0]&&g<=u[0]&&w>=-u[1]&&w<=u[1]}function ys(x,u,g,w,S,D,P,F,U,H){const X=g.transform,K=w?x.textSizeData:x.iconSizeData,ee=_.b5(K,g.transform.zoom),ie="globe"===X.projection.name,ae=[256/g.width*2+1,256/g.height*2+1],ce=w?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;ce.clear();let me=null;ie&&(me=w?x.text.globeExtVertexArray:x.icon.globeExtVertexArray);const se=x.lineVertexArray,be=w?x.text.placedSymbolArray:x.icon.placedSymbolArray,Me=g.transform.width/g.transform.height;let we,Se=!1;for(let pe=0;pe<be.length;pe++){const De=be.get(pe),{numGlyphs:Fe,writingMode:Ne}=De;if(Ne!==_.b6.vertical||Se||we===_.b6.horizontal||(Se=!0),we=Ne,(De.hidden||Ne===_.b6.vertical)&&!Se){fo(Fe,ce);continue}Se=!1;const je=new _.P(De.tileAnchorX,De.tileAnchorY);let{x:at,y:Ke,z:rt}=X.projection.projectTilePoint(je.x,je.y,H.canonical);if(U){const[_i,vi,Yi]=U(je);at+=_i,Ke+=vi,rt+=Yi}const pt=[at,Ke,rt,1];if(_.a7.transformMat4(pt,pt,u),!pr(pt,ae)){fo(Fe,ce);continue}const Pt=pt[3],Ze=Wn(g.transform.getCameraToCenterDistance(X.projection),Pt),ht=_.b7(K,ee,De),ze=P?ht/Ze:ht*Ze,Ye=En(at,Ke,rt,S);if(Ye[3]<=0){fo(Fe,ce);continue}let Mt={};const ti=P?null:U,Wt=Lc(De,ze,!1,F,u,S,D,x.glyphOffsetArray,se,ce,me,Ye,je,Mt,Me,ti,X.projection,H,P);Se=Wt.useVertical,ti&&Wt.needsFlipping&&(Mt={}),(Wt.notEnoughRoom||Se||Wt.needsFlipping&&Lc(De,ze,!0,F,u,S,D,x.glyphOffsetArray,se,ce,me,Ye,je,Mt,Me,ti,X.projection,H,P).notEnoughRoom)&&fo(Fe,ce)}w?(x.text.dynamicLayoutVertexBuffer.updateData(ce),me&&x.text.globeExtVertexBuffer&&x.text.globeExtVertexBuffer.updateData(me)):(x.icon.dynamicLayoutVertexBuffer.updateData(ce),me&&x.icon.globeExtVertexBuffer&&x.icon.globeExtVertexBuffer.updateData(me))}function Ja(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce){const{lineStartIndex:me,glyphStartIndex:se,segment:be}=F,Me=se+F.numGlyphs,we=me+F.lineLength,Se=u.getoffsetX(se),pe=u.getoffsetX(Me-1),De=wl(x*Se,g,w,S,D,P,be,me,we,U,H,X,K,ee,!0,ie,ae,ce);if(!De)return null;const Fe=wl(x*pe,g,w,S,D,P,be,me,we,U,H,X,K,ee,!0,ie,ae,ce);return Fe?{first:De,last:Fe}:null}function xl(x,u,g,w){return x===_.b6.horizontal&&Math.abs(w)>Math.abs(g)?{useVertical:!0}:x===_.b6.vertical?w>0?{needsFlipping:!0}:null:u!==Ue.unknown&&(0===(S=g)||Math.abs(w/S)>Ct)?u===Ue.flipRequired?{needsFlipping:!0}:null:g<0?{needsFlipping:!0}:null;var S}function Lc(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce,me,se,be){const Me=u/24,we=x.lineOffsetX*Me,Se=x.lineOffsetY*Me,{lineStartIndex:pe,glyphStartIndex:De,numGlyphs:Fe,segment:Ne,writingMode:je,flipState:at}=x,Ke=pe+x.lineLength,rt=pt=>{if(X){const[ze,Ye,Mt]=pt.up,ti=H.length;_.b8(X,ti+0,ze,Ye,Mt),_.b8(X,ti+1,ze,Ye,Mt),_.b8(X,ti+2,ze,Ye,Mt),_.b8(X,ti+3,ze,Ye,Mt)}const[Pt,Ze,ht]=pt.point;_.b9(H,Pt,Ze,ht,pt.angle)};if(Fe>1){const pt=Ja(Me,F,we,Se,g,K,ee,x,U,D,ie,ce,!1,me,se,be);if(!pt)return{notEnoughRoom:!0};if(w&&!g){let[Pt,Ze,ht]=pt.first.point,[ze,Ye,Mt]=pt.last.point;[Pt,Ze]=En(Pt,Ze,ht,P),[ze,Ye]=En(ze,Ye,Mt,P);const ti=xl(je,at,(ze-Pt)*ae,Ye-Ze);if(x.flipState=ti&&ti.needsFlipping?Ue.flipRequired:Ue.flipNotRequired,ti)return ti}rt(pt.first);for(let Pt=De+1;Pt<De+Fe-1;Pt++){const Ze=wl(Me*F.getoffsetX(Pt),we,Se,g,K,ee,Ne,pe,Ke,U,D,ie,ce,!1,!1,me,se,be);if(!Ze)return H.length-=4*(Pt-De),{notEnoughRoom:!0};rt(Ze)}rt(pt.last)}else{if(w&&!g){const Pt=En(ee.x,ee.y,0,S),Ze=pe+Ne+1,ht=new _.P(U.getx(Ze),U.gety(Ze)),ze=En(ht.x,ht.y,0,S),Ye=ze[3]>0?ze:Ga(ee,ht,Pt,1,S,void 0,me,se.canonical),Mt=xl(je,at,(Ye[0]-Pt[0])*ae,Ye[1]-Pt[1]);if(x.flipState=Mt&&Mt.needsFlipping?Ue.flipRequired:Ue.flipNotRequired,Mt)return Mt}const pt=wl(Me*F.getoffsetX(De),we,Se,g,K,ee,Ne,pe,Ke,U,D,ie,ce,!1,!1,me,se,be);if(!pt)return{notEnoughRoom:!0};rt(pt)}return{}}function ja(x,u,g,w,S){const{x:D,y:P,z:F}=w.projectTilePoint(x.x,x.y,u);if(!S)return En(D,P,F,g);const[U,H,X]=S(x);return En(D+U,P+H,F+X,g)}function Ga(x,u,g,w,S,D,P,F){const U=ja(x.sub(u)._unit()._add(x),F,S,P,D);return _.N.sub(U,g,U),_.N.normalize(U,U),_.N.scaleAndAdd(U,g,U,w)}function wl(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce,me,se){const be=w?x-u:x+u;let Me=be>0?1:-1,we=0;w&&(Me*=-1,we=Math.PI),Me<0&&(we+=Math.PI);let Se=F+P+(Me>0?0:1)|0,pe=S,De=S,Fe=0,Ne=0;const je=Math.abs(be),at=[],Ke=[];let rt=D,pt=rt;const Pt=()=>Ga(pt,rt,De,je-Fe+1,X,ee,ce,me.canonical);for(;Fe+Ne<=je;){if(Se+=Me,Se<F||Se>=U)return null;if(De=pe,pt=rt,at.push(De),ie&&Ke.push(pt),rt=new _.P(H.getx(Se),H.gety(Se)),pe=K[Se],!pe){const vi=ja(rt,me.canonical,X,ce,ee);pe=vi[3]>0?K[Se]=vi:Pt()}Fe+=Ne,Ne=_.N.distance(De,pe)}ae&&ee&&(K[Se]&&(pe=Pt(),Ne=_.N.distance(De,pe)),K[Se]=pe);const Ze=(je-Fe)/Ne,ht=rt.sub(pt)._mult(Ze)._add(pt),ze=_.N.sub([],pe,De),Ye=_.N.scaleAndAdd([],De,ze,Ze);let Mt=[0,0,1],ti=ze[0],Wt=ze[1];if(se&&(Mt=ce.upVector(me.canonical,ht.x,ht.y),0!==Mt[0]||0!==Mt[1]||1!==Mt[2])){const vi=[Mt[2],0,-Mt[0]],Yi=_.N.cross([],Mt,vi);_.N.normalize(vi,vi),_.N.normalize(Yi,Yi),ti=_.N.dot(ze,vi),Wt=_.N.dot(ze,Yi)}if(g){const vi=_.N.cross([],Mt,ze);_.N.normalize(vi,vi),_.N.scaleAndAdd(Ye,Ye,vi,g*Me)}const _i=we+Math.atan2(Wt,ti);return at.push(Ye),ie&&Ke.push(ht),{point:Ye,angle:_i,path:at,tilePath:Ke,up:Mt}}function fo(x,u){const g=u.length,w=g+4*x;u.resize(w),u.float32.fill(-1/0,4*g,4*w)}function Fc(x,u,g){const w=u[0],S=u[1];return x[0]=g[0]*w+g[4]*S+g[12],x[1]=g[1]*w+g[5]*S+g[13],x[3]=g[3]*w+g[7]*S+g[15],x}const da=100;class Nt{constructor(u,g,w=new $e(u.width+200,u.height+200,25),S=new $e(u.width+200,u.height+200,25)){this.transform=u,this.grid=w,this.ignoredGrid=S,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+da,this.screenBottomBoundary=u.height+da,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.fogState=g}placeCollisionBox(u,g,w,S,D,P,F,U){let H=w.projectedAnchorX,X=w.projectedAnchorY,K=w.projectedAnchorZ;const ee=w.elevation,ie=w.tileID,ae=u.getProjection();if(ee&&ie){const[pe,De,Fe]=ae.upVector(ie.canonical,w.tileAnchorX,w.tileAnchorY),Ne=ae.upVectorScale(ie.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=pe*ee*Ne,X+=De*ee*Ne,K+=Fe*ee*Ne}const ce=this.projectAndGetPerspectiveRatio(F,H,X,K,w.tileID,"globe"===ae.name||!!ee||this.transform.pitch>0,ae),me=P*ce.perspectiveRatio,se=(w.x1*g+S.x-w.padding)*me+ce.point.x,be=(w.y1*g+S.y-w.padding)*me+ce.point.y,Me=(w.x2*g+S.x+w.padding)*me+ce.point.x,we=(w.y2*g+S.y+w.padding)*me+ce.point.y,Se=ce.perspectiveRatio<=.55||ce.occluded;return!this.isInsideGrid(se,be,Me,we)||!D&&this.grid.hitTest(se,be,Me,we,U)||Se?{box:[],offscreen:!1,occluded:ce.occluded}:{box:[se,be,Me,we],offscreen:this.isOffscreen(se,be,Me,we),occluded:!1}}placeCollisionCircles(u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce){const me=[],se=this.transform.elevation,be=u.getProjection(),Me=se?se.getAtTileOffsetFunc(ce,this.transform.center.lat,this.transform.worldSize,be):null,we=new _.P(w.tileAnchorX,w.tileAnchorY);let{x:Se,y:pe,z:De}=be.projectTilePoint(we.x,we.y,ce.canonical);if(Me){const[ht,ze,Ye]=Me(we);Se+=ht,pe+=ze,De+=Ye}const Fe="globe"===be.name,Ne=this.projectAndGetPerspectiveRatio(F,Se,pe,De,ce,Fe||!!se||this.transform.pitch>0,be),{perspectiveRatio:je}=Ne,at=(K?P/je:P*je)/_.bc,Ke=En(Se,pe,De,U),rt=Ne.signedDistanceFromCamera>0?Ja(at,D,w.lineOffsetX*at,w.lineOffsetY*at,!1,Ke,we,w,S,U,{},se&&!K?Me:null,K&&!!se,be,ce,K):null;let pt=!1,Pt=!1,Ze=!0;if(rt&&!Ne.occluded){const ht=.5*ie*je+ae,ze=new _.P(-100,-100),Ye=new _.P(this.screenRightBoundary,this.screenBottomBoundary),Mt=new Ie,{first:ti,last:Wt}=rt,_i=ti.path.length;let vi=[];for(let Xi=_i-1;Xi>=1;Xi--)vi.push(ti.path[Xi]);for(let Xi=1;Xi<Wt.path.length;Xi++)vi.push(Wt.path[Xi]);const Yi=2.5*ht;H&&(vi=vi.map(([Xi,Sn,bn],xn)=>(Me&&!Fe&&(bn=Me(xn<_i-1?ti.tilePath[_i-1-xn]:Wt.tilePath[xn-_i+2])[2]),En(Xi,Sn,bn,H))),vi.some(Xi=>Xi[3]<=0)&&(vi=[]));let qi=[];if(vi.length>0){let Xi=1/0,Sn=-1/0,bn=1/0,xn=-1/0;for(const Dn of vi)Xi=Math.min(Xi,Dn[0]),bn=Math.min(bn,Dn[1]),Sn=Math.max(Sn,Dn[0]),xn=Math.max(xn,Dn[1]);Sn>=ze.x&&Xi<=Ye.x&&xn>=ze.y&&bn<=Ye.y&&(qi=[vi.map(Dn=>new _.P(Dn[0],Dn[1]))],(Xi<ze.x||Sn>Ye.x||bn<ze.y||xn>Ye.y)&&(qi=_.ba(qi,ze.x,ze.y,Ye.x,Ye.y)))}for(const Xi of qi){Mt.reset(Xi,.25*ht);let Sn=0;Sn=Mt.length<=.5*ht?1:Math.ceil(Mt.paddedLength/Yi)+1;for(let bn=0;bn<Sn;bn++){const xn=bn/Math.max(Sn-1,1),Dn=Mt.lerp(xn),fr=Dn.x+da,jr=Dn.y+da;me.push(fr,jr,ht,0);const Mi=fr-ht,Do=jr-ht,ar=fr+ht,Lr=jr+ht;if(Ze=Ze&&this.isOffscreen(Mi,Do,ar,Lr),Pt=Pt||this.isInsideGrid(Mi,Do,ar,Lr),!g&&this.grid.hitTestCircle(fr,jr,ht,ee)&&(pt=!0,!X))return{circles:[],offscreen:!1,collisionDetected:pt,occluded:!1}}}}return{circles:!X&&pt||!Pt?[]:me,offscreen:Ze,collisionDetected:pt,occluded:Ne.occluded}}queryRenderedSymbols(u){if(0===u.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const g=[];let w=1/0,S=1/0,D=-1/0,P=-1/0;for(const X of u){const K=new _.P(X.x+da,X.y+da);w=Math.min(w,K.x),S=Math.min(S,K.y),D=Math.max(D,K.x),P=Math.max(P,K.y),g.push(K)}const F=this.grid.query(w,S,D,P).concat(this.ignoredGrid.query(w,S,D,P)),U={},H={};for(const X of F){const K=X.key;if(void 0===U[K.bucketInstanceId]&&(U[K.bucketInstanceId]={}),U[K.bucketInstanceId][K.featureIndex])continue;const ee=[new _.P(X.x1,X.y1),new _.P(X.x2,X.y1),new _.P(X.x2,X.y2),new _.P(X.x1,X.y2)];_.bb(g,ee)&&(U[K.bucketInstanceId][K.featureIndex]=!0,void 0===H[K.bucketInstanceId]&&(H[K.bucketInstanceId]=[]),H[K.bucketInstanceId].push(K.featureIndex))}return H}insertCollisionBox(u,g,w,S,D){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:S,collisionGroupID:D},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,g,w,S,D){const P=g?this.ignoredGrid:this.grid,F={bucketInstanceId:w,featureIndex:S,collisionGroupID:D};for(let U=0;U<u.length;U+=4)P.insertCircle(F,u[U],u[U+1],u[U+2])}projectAndGetPerspectiveRatio(u,g,w,S,D,P,F){const U=[g,w,S,1];let H=!1;S||this.transform.pitch>0?(_.a7.transformMat4(U,U,u),this.fogState&&D&&"globe"!==F.name&&(H=function(ee,ie,ae,ce,me,se){const be=se.calculateFogTileMatrix(me),Me=[ie,ae,ce];return _.N.transformMat4(Me,Me,be),cr(ee,_.N.length(Me),se.pitch,se._fov)}(this.fogState,g,w,S,D.toUnwrapped(),this.transform)>.9)):Fc(U,U,u);const X=U[3];return{point:new _.P((U[0]/X+1)/2*this.transform.width+da,(-U[1]/X+1)/2*this.transform.height+da),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(F)/X*.5,1.5),signedDistanceFromCamera:X,occluded:P&&U[2]>X||H}}isOffscreen(u,g,w,S){return w<da||u>=this.screenRightBoundary||S<da||g>this.screenBottomBoundary}isInsideGrid(u,g,w,S){return w>=0&&u<this.gridRightBoundary&&S>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const u=_.a6.identity([]);return _.a6.translate(u,u,[-100,-100,0]),u}}function Um(x,u,g){const w=u.createTileMatrix(x,x.worldSize,g.toUnwrapped());return _.a6.multiply(new Float32Array(16),x.projMatrix,w)}function Xs(x,u,g){if(u.projection.name===g.projection.name)return x.projMatrix;const w=g.clone();return w.setProjection(u.projection),Um(w,u.getProjection(),x)}function Cu(x,u,g){return u.name===g.projection.name?x.projMatrix:Um(g,u,x)}class jm{constructor(u,g,w,S){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?g:-g))):S&&w?1:0,this.placed=w}isHidden(){return 0===this.opacity&&!this.placed}}class uc{constructor(u,g,w,S,D,P=!1){this.text=new jm(u?u.text:null,g,w,D),this.icon=new jm(u?u.icon:null,g,S,D),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Cl{constructor(u,g,w,S=!1){this.text=u,this.icon=g,this.skipFade=w,this.clipped=S}}class gr{constructor(){this.invProjMatrix=_.a6.create(),this.viewportMatrix=_.a6.create(),this.circles=[]}}class hc{constructor(u,g,w,S,D){this.bucketInstanceId=u,this.featureIndex=g,this.sourceLayerIndex=w,this.bucketIndex=S,this.tileID=D}}class Aa{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const g=++this.maxGroupID;this.collisionGroups[u]={ID:g,predicate:w=>w.collisionGroupID===g}}return this.collisionGroups[u]}}function _f(x,u,g,w,S){const{horizontalAlign:D,verticalAlign:P}=_.bf(x),F=-(D-.5)*u,U=-(P-.5)*g,H=_.bd(x,w);return new _.P(F+H[0]*S,U+H[1]*S)}function Gm(x,u,g,w,S){const D=new _.P(x,u);return g&&D._rotate(w?S:-S),D}class hC{constructor(u,g,w,S,D,P){this.transform=u.clone(),this.projection=u.projection.name,this.collisionIndex=new Nt(this.transform,D),this.buildingIndex=P,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Aa(w),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(u,g,w,S){const D=w.getBucket(g),P=w.latestFeatureIndex;if(!D||!P||g.fqid!==D.layerIds[0])return;const F=D.layers[0].layout,U=w.collisionBoxArray,H=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),X=w.tileSize/_.V,K=w.tileID.toUnwrapped();this.transform.setProjection(D.projection);const ee=(ie=w.tileID,ae=D.getProjection(),ce=this.transform,ae.name===this.projection?ce.calculateProjMatrix(ie.toUnwrapped()):Um(ce,ae,ie));var ie,ae,ce;const me="map"===F.get("text-pitch-alignment"),se="map"===F.get("text-rotation-alignment");g.compileFilter();const be=g.dynamicFilter(),Me=g.dynamicFilterNeedsFeature(),we=this.transform.calculatePixelsToTileUnitsMatrix(w),Se=li(ee,w.tileID.canonical,me,se,this.transform,D.getProjection(),we);let pe=null;if(me){const Ne=Ln(ee,w.tileID.canonical,me,se,this.transform,D.getProjection(),we);pe=_.a6.multiply([],this.transform.labelPlaneMatrix,Ne)}let De=null;be&&w.latestFeatureIndex&&(De={unwrappedTileID:K,dynamicFilter:be,dynamicFilterNeedsFeature:Me,featureIndex:w.latestFeatureIndex}),this.retainedQueryData[D.bucketInstanceId]=new hc(D.bucketInstanceId,P,D.sourceLayerIndex,D.index,w.tileID);const Fe={bucket:D,layout:F,posMatrix:ee,textLabelPlaneMatrix:Se,labelToScreenMatrix:pe,clippingData:De,scale:H,textPixelRatio:X,holdingForFade:w.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:_.b5(D.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:_.b5(D.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(D.sourceID)};if(S)for(const Ne of D.sortKeyRanges){const{sortKey:je,symbolInstanceStart:at,symbolInstanceEnd:Ke}=Ne;u.push({sortKey:je,symbolInstanceStart:at,symbolInstanceEnd:Ke,parameters:Fe})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:D.symbolInstances.length,parameters:Fe})}attemptAnchorPlacement(u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce,me,se,be){const{textOffset0:Me,textOffset1:we,crossTileID:Se}=ee,pe=[Me,we],De=_f(u,w,S,pe,D),Fe=this.collisionIndex.placeCollisionBox(ae,D,g,Gm(De.x,De.y,P,F,this.transform.angle),K,U,H,X.predicate);if(me){const Ne=ae.getSymbolInstanceIconSize(be,this.transform.zoom,ee.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(ae,Ne,me,Gm(De.x,De.y,P,F,this.transform.angle),K,U,H,X.predicate).box.length)return}if(Fe.box.length>0){let Ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[Se]&&this.prevPlacement.placements[Se]&&this.prevPlacement.placements[Se].text&&(Ne=this.prevPlacement.variableOffsets[Se].anchor),this.variableOffsets[Se]={textOffset:pe,width:w,height:S,anchor:u,textScale:D,prevAnchor:Ne},this.markUsedJustification(ae,u,ee,ce),ae.allowVerticalPlacement&&(this.markUsedOrientation(ae,ce,ee),this.placedOrientations[Se]=ce),{shift:De,placedGlyphBoxes:Fe}}}placeLayerBucketPart(u,g,w,S){const{bucket:D,layout:P,posMatrix:F,textLabelPlaneMatrix:U,labelToScreenMatrix:H,clippingData:X,textPixelRatio:K,holdingForFade:ee,collisionBoxArray:ie,partiallyEvaluatedTextSize:ae,partiallyEvaluatedIconSize:ce,collisionGroup:me}=u.parameters,se=P.get("text-optional"),be=P.get("icon-optional"),Me=P.get("text-allow-overlap"),we=P.get("icon-allow-overlap"),Se="map"===P.get("text-rotation-alignment"),pe="map"===P.get("text-pitch-alignment"),De="viewport-y"===P.get("symbol-z-order"),Fe=P.get("symbol-z-elevate");this.transform.setProjection(D.projection);let Ne=Me&&(we||!D.hasIconData()||be),je=we&&(Me||!D.hasTextData()||se);!D.collisionArrays&&ie&&D.deserializeCollisionBoxes(ie),w&&S&&D.updateCollisionDebugBuffers(this.transform.zoom,ie);const at=(Ke,rt,pt)=>{const{crossTileID:Pt,numVerticalGlyphVertices:Ze}=Ke;if(X){const ar={zoom:this.transform.zoom,pitch:this.transform.pitch};let Lr=null;if(X.dynamicFilterNeedsFeature){const vr=this.retainedQueryData[D.bucketInstanceId];Lr=X.featureIndex.loadFeature({featureIndex:Ke.featureIndex,bucketIndex:vr.bucketIndex,sourceLayerIndex:vr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,X.dynamicFilter)(ar,Lr,this.retainedQueryData[D.bucketInstanceId].tileID.canonical,new _.P(Ke.tileAnchorX,Ke.tileAnchorY),this.transform.calculateDistanceTileData(X.unwrappedTileID)))return this.placements[Pt]=new Cl(!1,!1,!1,!0),void g.add(Pt)}if(g.has(Pt))return;if(ee)return void(this.placements[Pt]=new Cl(!1,!1,!1));let ht=!1,ze=!1,Ye=!0,Mt=!1,ti=!1,Wt=null,_i={box:null,offscreen:null,occluded:null},vi={box:null,offscreen:null,occluded:null},Yi=null,qi=null,Xi=null,Sn=0,bn=0,xn=0;pt.textFeatureIndex?Sn=pt.textFeatureIndex:Ke.useRuntimeCollisionCircles&&(Sn=Ke.featureIndex),pt.verticalTextFeatureIndex&&(bn=pt.verticalTextFeatureIndex);const Dn=ar=>{ar.tileID=this.retainedQueryData[D.bucketInstanceId].tileID;const Lr=this.transform.elevation;ar.elevation=Ke.zOffset+(Lr?Lr.getAtTileOffset(ar.tileID,ar.tileAnchorX,ar.tileAnchorY):0)},fr=pt.textBox;if(fr){Dn(fr);const ar=vr=>{let Sr=_.b6.horizontal;if(D.allowVerticalPlacement&&!vr&&this.prevPlacement){const ko=this.prevPlacement.placedOrientations[Pt];ko&&(this.placedOrientations[Pt]=ko,Sr=ko,this.markUsedOrientation(D,Sr,Ke))}return Sr},Lr=(vr,Sr)=>{if(D.allowVerticalPlacement&&Ze>0&&pt.verticalTextBox){for(const ko of D.writingModes)if(ko===_.b6.vertical?(_i=Sr(),vi=_i):_i=vr(),_i&&_i.box&&_i.box.length)break}else _i=vr()};if(P.get("text-variable-anchor")){let vr=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Pt]){const Yr=this.prevPlacement.variableOffsets[Pt];vr.indexOf(Yr.anchor)>0&&(vr=vr.filter(Zs=>Zs!==Yr.anchor),vr.unshift(Yr.anchor))}const Sr=(Yr,Zs,ws)=>{const Dl=D.getSymbolInstanceTextSize(ae,Ke,this.transform.zoom,rt),hd=(Yr.x2-Yr.x1)*Dl+2*Yr.padding,kl=(Yr.y2-Yr.y1)*Dl+2*Yr.padding,Ks=Ke.hasIconTextFit&&!we?Zs:null;Ks&&Dn(Ks);let ks={box:[],offscreen:!1,occluded:!1};const Ot=Me?2*vr.length:vr.length;for(let Jn=0;Jn<Ot;++Jn){const nl=this.attemptAnchorPlacement(vr[Jn%vr.length],Yr,hd,kl,Dl,Se,pe,K,F,me,Jn>=vr.length,Ke,rt,D,ws,Ks,ae,ce);if(nl&&(ks=nl.placedGlyphBoxes,ks&&ks.box&&ks.box.length)){ht=!0,Wt=nl.shift;break}}return ks};Lr(()=>Sr(fr,pt.iconBox,_.b6.horizontal),()=>{const Yr=pt.verticalTextBox;return Yr&&Dn(Yr),D.allowVerticalPlacement&&!(_i&&_i.box&&_i.box.length)&&Ze>0&&Yr?Sr(Yr,pt.verticalIconBox,_.b6.vertical):{box:null,offscreen:null,occluded:null}}),_i&&(ht=_i.box,Ye=_i.offscreen,Mt=_i.occluded);const ko=ar(!(!_i||!_i.box));if(!ht&&this.prevPlacement){const Yr=this.prevPlacement.variableOffsets[Pt];Yr&&(this.variableOffsets[Pt]=Yr,this.markUsedJustification(D,Yr.anchor,Ke,ko))}}else{const vr=(Sr,ko)=>{const Yr=D.getSymbolInstanceTextSize(ae,Ke,this.transform.zoom,rt),Zs=this.collisionIndex.placeCollisionBox(D,Yr,Sr,new _.P(0,0),Me,K,F,me.predicate);return Zs&&Zs.box&&Zs.box.length&&(this.markUsedOrientation(D,ko,Ke),this.placedOrientations[Pt]=ko),Zs};Lr(()=>vr(fr,_.b6.horizontal),()=>{const Sr=pt.verticalTextBox;return D.allowVerticalPlacement&&Ze>0&&Sr?(Dn(Sr),vr(Sr,_.b6.vertical)):{box:null,offscreen:null,occluded:null}}),ar(!!(_i&&_i.box&&_i.box.length))}}if(Yi=_i,ht=Yi&&Yi.box&&Yi.box.length>0,Ye=Yi&&Yi.offscreen,Mt=Yi&&Yi.occluded,Ke.useRuntimeCollisionCircles){const ar=D.text.placedSymbolArray.get(Ke.centerJustifiedTextSymbolIndex>=0?Ke.centerJustifiedTextSymbolIndex:Ke.verticalPlacedTextSymbolIndex),Lr=_.b7(D.textSizeData,ae,ar),vr=P.get("text-padding");qi=this.collisionIndex.placeCollisionCircles(D,Me,ar,D.lineVertexArray,D.glyphOffsetArray,Lr,F,U,H,w,pe,me.predicate,Ke.collisionCircleDiameter*Lr/_.bc,vr,this.retainedQueryData[D.bucketInstanceId].tileID),ht=Me||qi.circles.length>0&&!qi.collisionDetected,Ye=Ye&&qi.offscreen,Mt=qi.occluded}if(pt.iconFeatureIndex&&(xn=pt.iconFeatureIndex),pt.iconBox){const ar=Lr=>{Dn(Lr);const vr=Ke.hasIconTextFit&&Wt?Gm(Wt.x,Wt.y,Se,pe,this.transform.angle):new _.P(0,0),Sr=D.getSymbolInstanceIconSize(ce,this.transform.zoom,Ke.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(D,Sr,Lr,vr,we,K,F,me.predicate)};vi&&vi.box&&vi.box.length&&pt.verticalIconBox?(Xi=ar(pt.verticalIconBox),ze=Xi.box.length>0):(Xi=ar(pt.iconBox),ze=Xi.box.length>0),Ye=Ye&&Xi.offscreen,ti=Xi.occluded}const jr=se||0===Ke.numHorizontalGlyphVertices&&0===Ze,Mi=be||0===Ke.numIconVertices;if(jr||Mi?Mi?jr||(ze=ze&&ht):ht=ze&&ht:ze=ht=ze&&ht,ht&&Yi&&Yi.box&&this.collisionIndex.insertCollisionBox(Yi.box,P.get("text-ignore-placement"),D.bucketInstanceId,vi&&vi.box&&bn?bn:Sn,me.ID),ze&&Xi&&this.collisionIndex.insertCollisionBox(Xi.box,P.get("icon-ignore-placement"),D.bucketInstanceId,xn,me.ID),qi&&(ht&&this.collisionIndex.insertCollisionCircles(qi.circles,P.get("text-ignore-placement"),D.bucketInstanceId,Sn,me.ID),w)){const ar=D.bucketInstanceId;let Lr=this.collisionCircleArrays[ar];void 0===Lr&&(Lr=this.collisionCircleArrays[ar]=new gr);for(let vr=0;vr<qi.circles.length;vr+=4)Lr.circles.push(qi.circles[vr+0]),Lr.circles.push(qi.circles[vr+1]),Lr.circles.push(qi.circles[vr+2]),Lr.circles.push(qi.collisionDetected?1:0)}const Do="globe"!==D.projection.name;Ne=Ne&&(Do||!Mt),je=je&&(Do||!ti),this.placements[Pt]=new Cl(ht||Ne,ze||je,Ye||D.justReloaded),g.add(Pt)};if(Fe&&this.buildingIndex&&(this.buildingIndex.updateZOffset(D,this.retainedQueryData[D.bucketInstanceId].tileID),D.updateZOffset()),De){const Ke=D.getSortedSymbolIndexes(this.transform.angle);for(let rt=Ke.length-1;rt>=0;--rt){const pt=Ke[rt];at(D.symbolInstances.get(pt),pt,D.collisionArrays[pt])}D.hasAnyZOffset&&_.w(`${D.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(D.hasAnyZOffset){const Ke=D.getSortedIndexesByZOffset();for(let rt=0;rt<Ke.length;++rt){const pt=Ke[rt];at(D.symbolInstances.get(pt),pt,D.collisionArrays[pt])}}else for(let Ke=u.symbolInstanceStart;Ke<u.symbolInstanceEnd;Ke++)at(D.symbolInstances.get(Ke),Ke,D.collisionArrays[Ke]);if(w&&D.bucketInstanceId in this.collisionCircleArrays){const Ke=this.collisionCircleArrays[D.bucketInstanceId];_.a6.invert(Ke.invProjMatrix,F),Ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1}markUsedJustification(u,g,w,S){const{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:U,crossTileID:H}=w,X=_.be(g),K=S===_.b6.vertical?U:"left"===X?D:"center"===X?P:"right"===X?F:-1;D>=0&&(u.text.placedSymbolArray.get(D).crossTileID=K>=0&&D!==K?0:H),P>=0&&(u.text.placedSymbolArray.get(P).crossTileID=K>=0&&P!==K?0:H),F>=0&&(u.text.placedSymbolArray.get(F).crossTileID=K>=0&&F!==K?0:H),U>=0&&(u.text.placedSymbolArray.get(U).crossTileID=K>=0&&U!==K?0:H)}markUsedOrientation(u,g,w){const S=g===_.b6.horizontal||g===_.b6.horizontalOnly?g:0,D=g===_.b6.vertical?g:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:F,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:H}=w,X=u.text.placedSymbolArray;P>=0&&(X.get(P).placedOrientation=S),F>=0&&(X.get(F).placedOrientation=S),U>=0&&(X.get(U).placedOrientation=S),H>=0&&(X.get(H).placedOrientation=D)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let w=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const S=g?g.symbolFadeChange(u):1,D=g?g.opacities:{},P=g?g.variableOffsets:{},F=g?g.placedOrientations:{};for(const U in this.placements){const H=this.placements[U],X=D[U];X?(this.opacities[U]=new uc(X,S,H.text,H.icon,null,H.clipped),w=w||H.text!==X.text.placed||H.icon!==X.icon.placed):(this.opacities[U]=new uc(null,S,H.text,H.icon,H.skipFade,H.clipped),w=w||H.text||H.icon)}for(const U in D){const H=D[U];if(!this.opacities[U]){const X=new uc(H,S,!1,!1);X.isHidden()||(this.opacities[U]=X,w=w||H.text.placed||H.icon.placed)}}for(const U in P)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=P[U]);for(const U in F)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=F[U]);w?this.lastPlacementChangeTime=u:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:u)}updateLayerOpacities(u,g){const w=new Set;for(const S of g){const D=S.getBucket(u);D&&S.latestFeatureIndex&&u.fqid===D.layerIds[0]&&(this.updateBucketOpacities(D,w,S.collisionBoxArray),D.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(D,S.tileID),D.updateZOffset()))}}updateBucketOpacities(u,g,w){u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const S=u.layers[0].layout,D=!!u.layers[0].dynamicFilter(),P=new uc(null,0,!1,!1,!0),F=S.get("text-allow-overlap"),U=S.get("icon-allow-overlap"),H=S.get("text-variable-anchor"),X="map"===S.get("text-rotation-alignment"),K="map"===S.get("text-pitch-alignment"),ee=new uc(null,0,F&&(U||!u.hasIconData()||S.get("icon-optional")),U&&(F||!u.hasTextData()||S.get("text-optional")),!0);!u.collisionArrays&&w&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(w);const ie=(ce,me,se)=>{for(let be=0;be<me/4;be++)ce.opacityVertexArray.emplaceBack(se)};let ae=0;for(let ce=0;ce<u.symbolInstances.length;ce++){const me=u.symbolInstances.get(ce),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:be,crossTileID:Me,numIconVertices:we}=me,Se=g.has(Me);let pe=this.opacities[Me];Se?pe=P:pe||(pe=ee,this.opacities[Me]=pe),g.add(Me);const De=se>0||be>0,Fe=we>0,Ne=this.placedOrientations[Me],je=Ne===_.b6.vertical,at=Ne===_.b6.horizontal||Ne===_.b6.horizontalOnly;if(!De&&!Fe||pe.isHidden()||ae++,De){const Ke=$b(pe.text);ie(u.text,se,je?Da:Ke),ie(u.text,be,at?Da:Ke);const rt=pe.text.isHidden(),{leftJustifiedTextSymbolIndex:pt,centerJustifiedTextSymbolIndex:Pt,rightJustifiedTextSymbolIndex:Ze,verticalPlacedTextSymbolIndex:ht}=me,ze=u.text.placedSymbolArray,Ye=rt||je?1:0;pt>=0&&(ze.get(pt).hidden=Ye),Pt>=0&&(ze.get(Pt).hidden=Ye),Ze>=0&&(ze.get(Ze).hidden=Ye),ht>=0&&(ze.get(ht).hidden=rt||at?1:0);const Mt=this.variableOffsets[Me];Mt&&this.markUsedJustification(u,Mt.anchor,me,Ne);const ti=this.placedOrientations[Me];ti&&(this.markUsedJustification(u,"left",me,ti),this.markUsedOrientation(u,ti,me))}if(Fe){const Ke=$b(pe.icon),{placedIconSymbolIndex:rt,verticalPlacedIconSymbolIndex:pt}=me,Pt=u.icon.placedSymbolArray,Ze=pe.icon.isHidden()?1:0;rt>=0&&(ie(u.icon,we,je?Da:Ke),Pt.get(rt).hidden=Ze),pt>=0&&(ie(u.icon,me.numVerticalIconVertices,at?Da:Ke),Pt.get(pt).hidden=Ze)}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const Ke=u.collisionArrays[ce];if(Ke){let rt=new _.P(0,0),pt=!0;if(Ke.textBox||Ke.verticalTextBox){if(H){const Ze=this.variableOffsets[Me];Ze?(rt=_f(Ze.anchor,Ze.width,Ze.height,Ze.textOffset,Ze.textScale),X&&rt._rotate(K?this.transform.angle:-this.transform.angle)):pt=!1}D&&(pt=!pe.clipped),Ke.textBox&&jl(u.textCollisionBox.collisionVertexArray,pe.text.placed,!pt||je,rt.x,rt.y),Ke.verticalTextBox&&jl(u.textCollisionBox.collisionVertexArray,pe.text.placed,!pt||at,rt.x,rt.y)}const Pt=pt&&!(at||!Ke.verticalIconBox);Ke.iconBox&&jl(u.iconCollisionBox.collisionVertexArray,pe.icon.placed,Pt,me.hasIconTextFit?rt.x:0,me.hasIconTextFit?rt.y:0),Ke.verticalIconBox&&jl(u.iconCollisionBox.collisionVertexArray,pe.icon.placed,!Pt,me.hasIconTextFit?rt.x:0,me.hasIconTextFit?rt.y:0)}}}if(u.fullyClipped=0===ae,u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=ce.invProjMatrix,u.placementViewportMatrix=ce.viewportMatrix,u.collisionCircleArray=ce.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}}symbolFadeChange(u){return 0===this.fadeDuration?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,g){const w=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*w>u}setStale(){this.stale=!0}}function jl(x,u,g,w,S){x.emplaceBack(u?1:0,g?1:0,w||0,S||0),x.emplaceBack(u?1:0,g?1:0,w||0,S||0),x.emplaceBack(u?1:0,g?1:0,w||0,S||0),x.emplaceBack(u?1:0,g?1:0,w||0,S||0)}const fC=Math.pow(2,25),W_=Math.pow(2,24),Mx=Math.pow(2,17),Gb=Math.pow(2,16),Ax=Math.pow(2,9),Hb=Math.pow(2,8),X_=Math.pow(2,1);function $b(x){if(0===x.opacity&&!x.placed)return 0;if(1===x.opacity&&x.placed)return 4294967295;const u=x.placed?1:0,g=Math.floor(127*x.opacity);return g*fC+u*W_+g*Mx+u*Gb+g*Ax+u*Hb+g*X_+u}const Da=0;class yr{constructor(u){this._sortAcrossTiles="viewport-y"!==u.layout.get("symbol-z-order")&&void 0!==u.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(u,g,w,S,D){const P=this._bucketParts;for(;this._currentTileIndex<u.length;)if(g.getBucketParts(P,S,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,D())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((F,U)=>F.sortKey-U.sortKey));this._currentPartIndex<P.length;){const F=P[this._currentPartIndex];if(g.placeLayerBucketPart(F,this._seenCrossTileIDs,w,0===F.symbolInstanceStart),this._currentPartIndex++,D())return!0}return!1}}class mg{constructor(u,g,w,S,D,P,F,U,H){this.placement=new hC(u,D,P,F,U,H),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(u,g,w,S){const D=_.f.now(),P=()=>{const F=_.f.now()-D;return!this._forceFullPlacement&&F>2};for(;this._currentPlacementIndex>=0;){const F=g[u[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if("symbol"===F.type&&(!F.minzoom||F.minzoom<=U)&&(!F.maxzoom||F.maxzoom>U)){const H=F,X=H.layout.get("symbol-z-elevate"),K=this._inProgressLayer=this._inProgressLayer||new yr(H),ee=_.ag(F.source,F.scope);if(K.continuePlacement(X?S[ee]:w[ee],this.placement,this._showCollisionBoxes,F,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const pg=512/_.V/2;class Wb{constructor(u,g,w){this.tileID=u,this.bucketInstanceId=w,this.index=new _.bg(g.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=u.canonical.x*_.V,D=u.canonical.y*_.V;for(let P=0;P<g.length;P++){const{key:F,crossTileID:U,tileAnchorX:H,tileAnchorY:X}=g.get(P),K=Math.floor((S+H)*pg),ee=Math.floor((D+X)*pg);this.index.add(K,ee),this.keys.push(F),this.crossTileIDs.push(U)}this.index.finish()}findMatches(u,g,w){const S=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z),D=pg/Math.pow(2,g.canonical.z-this.tileID.canonical.z),P=g.canonical.x*_.V,F=g.canonical.y*_.V;for(let U=0;U<u.length;U++){const H=u.get(U);if(H.crossTileID)continue;const{key:X,tileAnchorX:K,tileAnchorY:ee}=H,ie=Math.floor((P+K)*D),ae=Math.floor((F+ee)*D),ce=this.index.range(ie-S,ae-S,ie+S,ae+S);for(const me of ce){const se=this.crossTileIDs[me];if(this.keys[me]===X&&!w.has(se)){w.add(se),H.crossTileID=se;break}}}}}class Hm{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class q_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const g=Math.round((u-this.lng)/360);if(0!==g)for(const w in this.indexes){const S=this.indexes[w],D={};for(const P in S){const F=S[P];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+g),D[F.tileID.key]=F}this.indexes[w]=D}this.lng=u}addBucket(u,g,w){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let D=0;D<g.symbolInstances.length;D++)g.symbolInstances.get(D).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]=new Set);const S=this.usedCrossTileIDs[u.overscaledZ];for(const D in this.indexes){const P=this.indexes[D];if(Number(D)>u.overscaledZ)for(const F in P){const U=P[F];U.tileID.isChildOf(u)&&U.findMatches(g.symbolInstances,u,S)}else{const F=P[u.scaledTo(Number(D)).key];F&&F.findMatches(g.symbolInstances,u,S)}}for(let D=0;D<g.symbolInstances.length;D++){const P=g.symbolInstances.get(D);P.crossTileID||(P.crossTileID=w.generate(),S.add(P.crossTileID))}return void 0===this.indexes[u.overscaledZ]&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new Wb(u,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(u,g){for(const w of g.crossTileIDs)this.usedCrossTileIDs[u].delete(w)}removeStaleBuckets(u){let g=!1;for(const w in this.indexes){const S=this.indexes[w];for(const D in S)u[S[D].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,S[D]),delete S[D],g=!0)}return g}}class zo{constructor(){this.layerIndexes={},this.crossTileIDs=new Hm,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,g,w,S){let D=this.layerIndexes[u.fqid];void 0===D&&(D=this.layerIndexes[u.fqid]=new q_);let P=!1;const F={};"globe"!==S.name&&D.handleWrapJump(w);for(const U of g){const H=U.getBucket(u);H&&u.fqid===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),D.addBucket(U.tileID,H,this.crossTileIDs)&&(P=!0),F[H.bucketInstanceId]=!0)}return D.removeStaleBuckets(F)&&(P=!0),P}pruneUnusedLayers(u){const g={};u.forEach(w=>{g[w]=!0});for(const w in this.layerIndexes)g[w]||delete this.layerIndexes[w]}}class vf{constructor(u=0,g=0,w=0,S=0){if(isNaN(u)||u<0||isNaN(g)||g<0||isNaN(w)||w<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=g,this.left=w,this.right=S}interpolate(u,g,w){return null!=g.top&&null!=u.top&&(this.top=_.U(u.top,g.top,w)),null!=g.bottom&&null!=u.bottom&&(this.bottom=_.U(u.bottom,g.bottom,w)),null!=g.left&&null!=u.left&&(this.left=_.U(u.left,g.left,w)),null!=g.right&&null!=u.right&&(this.right=_.U(u.right,g.right,w)),this}getCenter(u,g){const w=_.aa((this.left+u-this.right)/2,0,u),S=_.aa((this.top+g-this.bottom)/2,0,g);return new _.P(w,S)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new vf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Eu(x,u){const g=_.bk(x,3);_.a6.fromQuat(x,u),_.bm(x,3,g)}function $d(x,u){const g=_.bi.identity([]);return _.bi.rotateZ(g,g,-u),_.bi.rotateX(g,g,-x),g}function Xb(x,u){const g=[x[0],x[1],0],w=[u[0],u[1],0];if(_.N.length(g)>=1e-15){const P=_.N.normalize([],g);_.N.scale(w,P,_.N.dot(w,P)),u[0]=w[0],u[1]=w[1]}const S=_.N.cross([],u,x);if(_.N.len(S)<1e-15)return null;const D=Math.atan2(-S[1],S[0]);return $d(Math.atan2(Math.sqrt(x[0]*x[0]+x[1]*x[1]),-x[2]),D)}class fc{constructor(u,g){this.position=u,this.orientation=g}get position(){return this._position}set position(u){if(u){const g=u instanceof _.L?u:new _.L(u[0],u[1],u[2]);this._renderWorldCopies&&(g.x=_.bh(g.x,0,1)),this._position=g}else this._position=null}lookAtPoint(u,g){if(this.orientation=null,!this.position)return;const w=this.position,S=this._elevation?this._elevation.getAtPointOrZero(_.L.fromLngLat(u)):0,D=_.L.fromLngLat(u,S),P=[D.x-w.x,D.y-w.y,D.z-w.z];g||(g=[0,0,1]),g[2]=Math.abs(g[2]),this.orientation=Xb(P,g)}setPitchBearing(u,g){this.orientation=$d(_.bj(u),_.bj(-g))}}class bf{constructor(u,g){this._transform=_.a6.identity([]),this.orientation=g,this.position=u}get mercatorPosition(){const u=this.position;return new _.L(u[0],u[1],u[2])}get position(){const u=_.bk(this._transform,3);return[u[0],u[1],u[2]]}set position(u){var g;u&&_.bm(this._transform,3,[(g=u)[0],g[1],g[2],1])}get orientation(){return this._orientation}set orientation(u){this._orientation=u||_.bi.identity([]),u&&Eu(this._transform,this._orientation)}getPitchBearing(){const u=this.forward(),g=this.right();return{bearing:Math.atan2(-g[1],g[0]),pitch:Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2])}}setPitchBearing(u,g){this._orientation=$d(u,g),Eu(this._transform,this._orientation)}forward(){const u=_.bk(this._transform,2);return[-u[0],-u[1],-u[2]]}up(){const u=_.bk(this._transform,1);return[-u[0],-u[1],-u[2]]}right(){const u=_.bk(this._transform,0);return[u[0],u[1],u[2]]}getCameraToWorld(u,g){const w=new Float64Array(16);return _.a6.invert(w,this.getWorldToCamera(u,g)),w}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(u,g,w){const S=this.position;_.N.scale(S,S,-u);const D=new Float64Array(16);return _.a6.fromScaling(D,[w,w,w]),_.a6.translate(D,D,S),D[10]*=g,D}getWorldToCamera(u,g){const w=new Float64Array(16),S=new Float64Array(4),D=this.position;return _.bi.conjugate(S,this._orientation),_.N.scale(D,D,-u),_.a6.fromQuat(w,S),_.a6.translate(w,w,D),w[1]*=-1,w[5]*=-1,w[9]*=-1,w[13]*=-1,w[8]*=g,w[9]*=g,w[10]*=g,w[11]*=g,w}getCameraToClipPerspective(u,g,w,S){const D=new Float64Array(16);return _.a6.perspective(D,u,g,w,S),D}getCameraToClipOrthographic(u,g,w,S,D,P){const F=new Float64Array(16);return _.a6.ortho(F,u,g,w,S,D,P),F}getDistanceToElevation(u,g=!1){const w=0===u?0:_.bl(u,g?_.au(this.position[1]):this.position[1]),S=this.forward();return(w-this.position[2])/S[2]}clone(){return new bf([...this.position],[...this.orientation])}}const ad=(x,u,g)=>(1-g)*x+g*u,Tu=x=>x*x*x*x*x;class Wd{constructor(u,g,w,S,D,P,F){this.tileSize=512,this._renderWorldCopies=void 0===D||D,this._minZoom=u||0,this._maxZoom=g||22,this._minPitch=w??0,this._maxPitch=S??60,this.setProjection(P),this.setMaxBounds(F),this.width=0,this.height=0,this._center=new _.bn(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new vf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new bf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const u=new Wd(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return u._elevation=this._elevation,u._centerAltitude=this._centerAltitude,u._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,u.tileSize=this.tileSize,u.mercatorFromTransition=this.mercatorFromTransition,u.width=this.width,u.height=this.height,u.cameraElevationReference=this.cameraElevationReference,u._center=this._center,u._setZoom(this.zoom),u._seaLevelZoom=this._seaLevelZoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._nearZ=this._nearZ,u._farZ=this._farZ,u._averageElevation=this._averageElevation,u._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._camera=this._camera.clone(),u._calcMatrices(),u.freezeTileCoverage=this.freezeTileCoverage,u.frustumCorners=this.frustumCorners,u}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(u){this._elevation!==u&&(this._elevation=u,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(u,g=!1){const w=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||w)&&this._updateCameraOnTerrain(),(u||w)&&this._constrainCamera(g),this._calcMatrices()}getProjection(){return _.ac(this.projection,["name","center","parallels"])}setProjection(u){this.projectionOptions=u||{name:"mercator"};const g=this.projection?this.getProjection():void 0;this.projection=_.bo(this.projectionOptions);const w=!Tt(g,this.getProjection());return w&&this._calcMatrices(),this.mercatorFromTransition=!1,w}setOrthographicProjectionAtLowPitch(u){return this._orthographicProjectionAtLowPitch!==u&&(this._orthographicProjectionAtLowPitch=u,this._calcMatrices(),!0)}setMercatorFromTransition(){const u=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=_.bo({name:"mercator"});const g=u!==this.projection.name;return g&&this._calcMatrices(),g}get minZoom(){return this._minZoom}set minZoom(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))}get maxZoom(){return this._maxZoom}set maxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))}get minPitch(){return this._minPitch}set minPitch(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))}get maxPitch(){return this._maxPitch}set maxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(u){void 0===u?u=!0:null===u&&(u=!1),this._renderWorldCopies=u}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get cameraWorldSize(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return _.bl(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new _.P(this.width,this.height)}get bearing(){return _.bh(this.rotation,-180,180)}set bearing(u){this.rotation=u}get rotation(){return-this.angle/Math.PI*180}set rotation(u){const g=-u*Math.PI/180;this.angle!==g&&(this._unmodified=!1,this.angle=g,this._calcMatrices(),this.rotationMatrix=_.b4.create(),_.b4.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(u){const g=_.aa(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==g&&(this._unmodified=!1,this._pitch=g,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const u=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/u)}set fov(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=_.bj(u),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(u){this._averageElevation=u,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(u){const g=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==g&&(this._unmodified=!1,this._setZoom(g),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(u){this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(u){this._tileCoverLift!==u&&(this._tileCoverLift=u)}_updateCameraOnTerrain(){const u=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,g=this.elevation&&u===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||u===Number.NEGATIVE_INFINITY&&(!g||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const w=this._elevation;g||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&w.exaggeration()&&this._centerAltitudeValidForExaggeration!==w.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*w.exaggeration(),this._centerAltitudeValidForExaggeration=w.exaggeration()):(this._centerAltitude=u||0,this._centerAltitudeValidForExaggeration=w.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const u=this._elevation,g=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],w=this.horizonLineFromTop();let S=0,D=0;for(let P=0;P<g.length;P++){const F=new _.P(g[P][0]*this.width,w+g[P][1]*(this.height-w)),U=u.pointCoordinate(F);if(!U)continue;const H=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);S+=U[3]*H,D+=H}return 0===D?NaN:S/D}get center(){return this._center}set center(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const u=this._seaLevelZoom,g=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),w=this.pixelsPerMeter/this.worldSize*g,S=this._mercatorZfromZoom(u),D=this._mercatorZfromZoom(this._maxZoom),P=Math.max(S-w,D);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}computeZoomRelativeTo(u){const g=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,u.toAltitude()));let w;w=u.z<this._camera.position[2]?[g.x,g.y,g.z]:[u.x,u.y,u.z];const S=_.N.length(_.N.sub([],this._camera.position,w));return _.aa(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(u){if(!this.height||!u.position&&!u.orientation)return;this._updateCameraState();let g=!1;if(u.orientation&&!_.bi.exactEquals(u.orientation,this._camera.orientation)&&(g=this._setCameraOrientation(u.orientation)),u.position){const w=[u.position.x,u.position.y,u.position.z];_.N.exactEquals(w,this._camera.position)||(this._setCameraPosition(w),g=!0)}g&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const u=this._camera.position,g=new fc;return g.position=new _.L(u[0],u[1],u[2]),g.orientation=this._camera.orientation,g._elevation=this.elevation,g._renderWorldCopies=this.renderWorldCopies,g}_setCameraOrientation(u){if(!_.bi.length(u))return!1;_.bi.normalize(u,u);const g=_.N.transformQuat([],[0,0,-1],u),w=_.N.transformQuat([],[0,-1,0],u);if(w[2]<0)return!1;const S=Xb(g,w);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(u){const g=this.zoomScale(this.minZoom)*this.tileSize,w=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;u[2]=_.aa(u[2],S/w,S/g),this._camera.position=u}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,g,w){this._unmodified=!1,this._edgeInsets.interpolate(u,g,w),this._constrain(),this._calcMatrices()}coveringZoomLevel(u){const g=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,g)}getVisibleUnwrappedCoordinates(u){const g=[new _.bp(0,u)];if(this.renderWorldCopies){const w=this.pointCoordinate(new _.P(0,0)),S=this.pointCoordinate(new _.P(this.width,0)),D=this.pointCoordinate(new _.P(this.width,this.height)),P=this.pointCoordinate(new _.P(0,this.height)),F=Math.floor(Math.min(w.x,S.x,D.x,P.x)),U=Math.floor(Math.max(w.x,S.x,D.x,P.x)),H=1;for(let X=F-H;X<=U+H;X++)0!==X&&g.push(new _.bp(X,u))}return g}isLODDisabled(u){return(!u||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(u,g,w){let S=[];if(0===g[0]&&0===g[1])return S;for(const P of u){const F=P.canonical,U=P.overscaledZ,H=P.wrap,X=1<<F.z,K=F.x+1<X,ee=F.x>0,ie=F.y+1<X,ae=F.y>0,ce=P.wrap-(ee?0:1),me=P.wrap+(K?0:1),se=ee?F.x-1:X-1,be=K?F.x+1:0;g[0]<0?(S.push(new _.am(U,me,F.z,be,F.y)),g[1]<0&&ie&&(S.push(new _.am(U,H,F.z,F.x,F.y+1)),S.push(new _.am(U,me,F.z,be,F.y+1))),g[1]>0&&ae&&(S.push(new _.am(U,H,F.z,F.x,F.y-1)),S.push(new _.am(U,me,F.z,be,F.y-1)))):g[0]>0?(S.push(new _.am(U,ce,F.z,se,F.y)),g[1]<0&&ie&&(S.push(new _.am(U,H,F.z,F.x,F.y+1)),S.push(new _.am(U,ce,F.z,se,F.y+1))),g[1]>0&&ae&&(S.push(new _.am(U,H,F.z,F.x,F.y-1)),S.push(new _.am(U,ce,F.z,se,F.y-1)))):g[1]<0&&ie?S.push(new _.am(U,H,F.z,F.x,F.y+1)):ae&&S.push(new _.am(U,H,F.z,F.x,F.y-1))}if(S.length>1){S.sort((U,H)=>U.overscaledZ-H.overscaledZ||U.wrap-H.wrap||U.canonical.z-H.canonical.z||U.canonical.x-H.canonical.x||U.canonical.y-H.canonical.y);let P=0,F=0;for(;F<S.length;)S[F].equals(S[P])?++F:S[++P]=S[F++];S.length=P+1}const D=[];for(const P of S)S.some(F=>P.isChildOf(F))||D.push(P);return S=D.filter(P=>!u.some(F=>!!(P.overscaledZ<w&&F.isChildOf(P))||P.equals(F)||P.isChildOf(F))),S}coveringTiles(u){let g=this.coveringZoomLevel(u);const w=g,S=this.elevation&&this.elevation.exaggeration(),D=S&&!u.isTerrainDEM,P="mercator"===this.projection.name;if(void 0!==u.minzoom&&g<u.minzoom)return[];void 0!==u.maxzoom&&g>u.maxzoom&&(g=u.maxzoom);const F=this.locationCoordinate(this.center),U=this.center.lat,H=1<<g,X=[H*F.x,H*F.y,0],K="globe"===this.projection.name,ee=!K,ie=_.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g,ee),ae=K?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ce=H*_.bl(1,this.center.lat),me=this._camera.position[2]/_.bl(1,this.center.lat),se=[H*ae.x,H*ae.y,me*(ee?1:ce)],be=K||S,Me=this.cameraToCenterDistance/u.tileSize*(u.roundZoom?1:.502),we=this.isLODDisabled(!0)?g:0;let Se;if(this._elevation&&u.isTerrainDEM)Se=1e4*this._elevation.exaggeration();else if(this._elevation){const ze=this._elevation.getMinMaxForVisibleTiles();Se=ze?ze.max:this._centerAltitude}else Se=this._centerAltitude;const pe=u.isTerrainDEM?-Se:this._elevation?this._elevation.getMinElevationBelowMSL():0,De=this.projection.isReprojectedInTileSpace?_.br(this):1,Fe=ze=>{const Mt=new _.L(ze.x+25e-6,ze.y,ze.z),ti=new _.L(ze.x,ze.y+25e-6,ze.z),Wt=ze.toLngLat(),_i=Mt.toLngLat(),vi=ti.toLngLat(),Yi=this.locationCoordinate(Wt),qi=this.locationCoordinate(_i),Xi=this.locationCoordinate(vi),Sn=Math.hypot(qi.x-Yi.x,qi.y-Yi.y),bn=Math.hypot(Xi.x-Yi.x,Xi.y-Yi.y);return Math.sqrt(Sn*bn)*De/25e-6},Ne=ze=>{const Ye=Se,Mt=pe;return{aabb:_.bu(this,H,0,0,0,ze,Mt,Ye,this.projection),zoom:0,x:0,y:0,minZ:Mt,maxZ:Ye,wrap:ze,fullyVisible:!1}},je=[];let at=[];const Ke=g,rt=u.reparseOverscaled?w:g,pt=ze=>ze*ze,Pt=pt((me-this._centerAltitude)*ce),Ze=ze=>{if(!this._elevation||!ze.tileID||!P)return;const Ye=this._elevation.getMinMaxForTile(ze.tileID),Mt=ze.aabb;Ye?(Mt.min[2]=Ye.min,Mt.max[2]=Ye.max,Mt.center[2]=(Mt.min[2]+Mt.max[2])/2):(ze.shouldSplit=ht(ze),ze.shouldSplit||(Mt.min[2]=Mt.max[2]=Mt.center[2]=this._centerAltitude))},ht=ze=>{if(ze.zoom<we)return!0;if(ze.zoom===Ke)return!1;if(null!=ze.shouldSplit)return ze.shouldSplit;const Ye=ze.aabb.distanceX(se),Mt=ze.aabb.distanceY(se);let ti=Pt,Wt=1;if(K){ti=pt(ze.aabb.distanceZ(se));const Yi=Math.pow(2,ze.zoom),qi=_.au((ze.y+1)/Yi),Xi=_.au(ze.y/Yi),Sn=Math.min(Math.max(U,qi),Xi),bn=_.bJ(Sn)/_.bJ(U);if(Wt=Sn===U?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,bn/this._mercatorScaleRatio),this.zoom<=_.bG&&ze.zoom===Ke-1&&bn>=.9)return!0}else if(D&&(ti=pt(ze.aabb.distanceZ(se)*ce)),this.projection.isReprojectedInTileSpace&&w<=5){const Yi=Math.pow(2,ze.zoom),qi=Fe(new _.L((ze.x+.5)/Yi,(ze.y+.5)/Yi));Wt=qi>.85?1:qi}const _i=Ye*Ye+Mt*Mt+ti;return _i<pt((1<<Ke-ze.zoom)*Me*Wt*((Yi,qi)=>{if(qi*pt(.707)<Yi)return 1;const Xi=Math.sqrt(qi/Yi);return Xi/(1.4144271570014144+(Math.pow(1.1,Xi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ti,Pt),_i))};if(this.renderWorldCopies)for(let ze=1;ze<=3;ze++)je.push(Ne(-ze)),je.push(Ne(ze));for(je.push(Ne(0));je.length>0;){const ze=je.pop(),Ye=ze.x,Mt=ze.y;let ti=ze.fullyVisible;const Wt=()=>"globe"===this.projection.name&&(0===ze.y||ze.y===(1<<ze.zoom)-1);if(!ti){let _i=be?ze.aabb.intersects(ie):ze.aabb.intersectsFlat(ie);if(0===_i&&Wt()){const vi=new _.bs(ze.zoom,Ye,Mt);_i=_.bt(this,H,vi,!0).intersects(ie)}if(0===_i)continue;ti=2===_i}if(ze.zoom!==Ke&&ht(ze))for(let _i=0;_i<4;_i++){const vi=(Ye<<1)+_i%2,Yi=(Mt<<1)+(_i>>1),qi={aabb:P?ze.aabb.quadrant(_i):_.bu(this,H,ze.zoom+1,vi,Yi,ze.wrap,ze.minZ,ze.maxZ,this.projection),zoom:ze.zoom+1,x:vi,y:Yi,wrap:ze.wrap,fullyVisible:ti,tileID:void 0,shouldSplit:void 0,minZ:ze.minZ,maxZ:ze.maxZ};D&&!K&&(qi.tileID=new _.am(ze.zoom+1===Ke?rt:ze.zoom+1,ze.wrap,ze.zoom+1,vi,Yi),Ze(qi)),je.push(qi)}else{const _i=ze.zoom===Ke?rt:ze.zoom;if(u.minzoom&&u.minzoom>_i)continue;if(!ti){let Xi=be?ze.aabb.intersectsPrecise(ie):ze.aabb.intersectsPreciseFlat(ie);if(0===Xi&&Wt()){const Sn=new _.bs(ze.zoom,Ye,Mt);Xi=_.bt(this,H,Sn,!0).intersectsPrecise(ie)}if(0===Xi)continue}const vi=X[0]-(.5+Ye+(ze.wrap<<ze.zoom))*(1<<g-ze.zoom),Yi=X[1]-.5-Mt,qi=ze.tileID?ze.tileID:new _.am(_i,ze.wrap,ze.zoom,Ye,Mt);at.push({tileID:qi,distanceSq:vi*vi+Yi*Yi})}}if(this.fogCullDistSq){const ze=this.fogCullDistSq,Ye=this.horizonLineFromTop();at=at.filter(Mt=>{const ti=[0,0,0,1],Wt=[_.V,_.V,0,1],_i=this.calculateFogTileMatrix(Mt.tileID.toUnwrapped());_.a7.transformMat4(ti,ti,_i),_.a7.transformMat4(Wt,Wt,_i);const vi=_.a7.min([],ti,Wt),Yi=_.a7.max([],ti,Wt),qi=_.bv(vi,Yi);if(0===qi)return!0;let Xi=!1;const Sn=this._elevation;if(Sn&&qi>ze&&0!==Ye){const bn=this.calculateProjMatrix(Mt.tileID.toUnwrapped());let xn;u.isTerrainDEM||(xn=Sn.getMinMaxForTile(Mt.tileID)),xn||(xn={min:pe,max:Se});const Dn=_.bH(this.rotation),fr=[Dn[0]*_.V,Dn[1]*_.V,xn.max];_.N.transformMat4(fr,fr,bn),Xi=(1-fr[1])*this.height*.5<Ye}return qi<ze||Xi})}return at.sort((ze,Ye)=>ze.distanceSq-Ye.distanceSq).map(ze=>ze.tileID)}resize(u,g){this.width=u,this.height=g,this.pixelsToGLUnits=[2/u,-2/g],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(u){return Math.pow(2,u)}scaleZoom(u){return Math.log(u)/Math.LN2}project(u){const g=_.aa(u.lat,-_.bw,_.bw),w=this.projection.project(u.lng,g);return new _.P(w.x*this.worldSize,w.y*this.worldSize)}unproject(u){return this.projection.unproject(u.x/this.worldSize,u.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/_.bl(1,this.center.lat)/this.worldSize}setLocationAtPoint(u,g){let w,S;const D=this.centerPoint;if("globe"===this.projection.name){const F=this.worldSize;w=(g.x-D.x)/F,S=(g.y-D.y)/F}else{const F=this.pointCoordinate(g),U=this.pointCoordinate(D);w=F.x-U.x,S=F.y-U.y}const P=this.locationCoordinate(u);this.setLocation(new _.L(P.x-w,P.y-S))}setLocation(u){this.center=this.coordinateLocation(u),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(u){return this.projection.locationPoint(this,u)}locationPoint3D(u){return this.projection.locationPoint(this,u,!0)}pointLocation(u){return this.coordinateLocation(this.pointCoordinate(u))}pointLocation3D(u){return this.coordinateLocation(this.pointCoordinate3D(u))}locationCoordinate(u,g){const w=g?_.bl(g,u.lat):void 0,S=this.projection.project(u.lng,u.lat);return new _.L(S.x,S.y,w)}coordinateLocation(u){return this.projection.unproject(u.x,u.y)}pointRayIntersection(u,g){const w=g??this._centerAltitude,S=[u.x,u.y,0,1],D=[u.x,u.y,1,1];_.a7.transformMat4(S,S,this.pixelMatrixInverse),_.a7.transformMat4(D,D,this.pixelMatrixInverse);const P=D[3];_.a7.scale(S,S,1/S[3]),_.a7.scale(D,D,1/P);const F=S[2],U=D[2];return{p0:S,p1:D,t:F===U?0:(w-F)/(U-F)}}screenPointToMercatorRay(u){const g=[u.x,u.y,0,1],w=[u.x,u.y,1,1];return _.a7.transformMat4(g,g,this.pixelMatrixInverse),_.a7.transformMat4(w,w,this.pixelMatrixInverse),_.a7.scale(g,g,1/g[3]),_.a7.scale(w,w,1/w[3]),g[2]=_.bl(g[2],this._center.lat)*this.worldSize,w[2]=_.bl(w[2],this._center.lat)*this.worldSize,_.a7.scale(g,g,1/this.worldSize),_.a7.scale(w,w,1/this.worldSize),new _.a2([g[0],g[1],g[2]],_.N.normalize([],_.N.sub([],w,g)))}rayIntersectionCoordinate(u){const{p0:g,p1:w,t:S}=u,D=_.bl(g[2],this._center.lat),P=_.bl(w[2],this._center.lat);return new _.L(_.U(g[0],w[0],S)/this.worldSize,_.U(g[1],w[1],S)/this.worldSize,_.U(D,P,S))}pointCoordinate(u,g=this._centerAltitude){return this.projection.pointCoordinate(this,u.x,u.y,g)}pointCoordinate3D(u){if(!this.elevation)return this.pointCoordinate(u);let g=this.projection.pointCoordinate3D(this,u.x,u.y);if(g)return new _.L(g[0],g[1],g[2]);let w=0,S=this.horizonLineFromTop();if(u.y>S)return this.pointCoordinate(u);const D=.02*S,P=u.clone();for(let F=0;F<10&&S-w>D;F++){P.y=_.U(w,S,.66);const U=this.projection.pointCoordinate3D(this,P.x,P.y);U?(S=P.y,g=U):w=P.y}return g?new _.L(g[0],g[1],g[2]):this.pointCoordinate(u)}isPointAboveHorizon(u){return this.projection.isPointAboveHorizon(this,u)}isPointOnSurface(u){if(u.y<0||u.y>this.height||u.x<0||u.x>this.width)return!1;if(this.elevation||this.zoom>=_.bx)return!this.isPointAboveHorizon(u);const g=this.pointCoordinate(u);return g.y>=0&&g.y<=1}_coordinatePoint(u,g){const w=g&&this.elevation?this.elevation.getAtPointOrZero(u,this._centerAltitude):this._centerAltitude,S=[u.x*this.worldSize,u.y*this.worldSize,w+u.toAltitude(),1];return _.a7.transformMat4(S,S,this.pixelMatrix),S[3]>0?new _.P(S[0]/S[3],S[1]/S[3]):new _.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:u,left:g}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,D=this.pointLocation3D(new _.P(g,u)),P=this.pointLocation3D(new _.P(S,u)),F=this.pointLocation3D(new _.P(S,w)),U=this.pointLocation3D(new _.P(g,w));let H=Math.min(D.lng,P.lng,F.lng,U.lng),X=Math.max(D.lng,P.lng,F.lng,U.lng),K=Math.min(D.lat,P.lat,F.lat,U.lat),ee=Math.max(D.lat,P.lat,F.lat,U.lat);const ie=Math.pow(2,-this.zoom)/16*270,ae="globe"===this.projection.name?1:4,ce=(me,se,be,Me,we)=>{const Se=(me+be)/2,pe=(se+Me)/2,De=new _.P(Se,pe),{lng:Fe,lat:Ne}=this.pointLocation3D(De),je=Math.max(0,H-Fe,K-Ne,Fe-X,Ne-ee);H=Math.min(H,Fe),X=Math.max(X,Fe),K=Math.min(K,Ne),ee=Math.max(ee,Ne),(we<ae||je>ie)&&(ce(me,se,Se,pe,we+1),ce(Se,pe,be,Me,we+1))};if(ce(g,u,S,u,1),ce(S,u,S,w,1),ce(S,w,g,w,1),ce(g,w,g,u,1),"globe"===this.projection.name){const[me,se]=_.by(this);me?(ee=90,X=180,H=-180):se&&(K=-90,X=180,H=-180)}return new _.ad(new _.bn(H,K),new _.bn(X,ee))}_getBoundsRectangular(u,g){const{top:w,left:S}=this._edgeInsets,D=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,F=new _.P(S,w),U=new _.P(P,w),H=new _.P(P,D),X=new _.P(S,D);let K=this.pointCoordinate(F,u),ee=this.pointCoordinate(U,u);const ie=this.pointCoordinate(H,g),ae=this.pointCoordinate(X,g),ce=(me,se)=>(se.y-me.y)/(se.x-me.x);return K.y>1&&ee.y>=0?K=new _.L((1-ae.y)/ce(ae,K)+ae.x,1):K.y<0&&ee.y<=1&&(K=new _.L(-ae.y/ce(ae,K)+ae.x,0)),ee.y>1&&K.y>=0?ee=new _.L((1-ie.y)/ce(ie,ee)+ie.x,1):ee.y<0&&K.y<=1&&(ee=new _.L(-ie.y/ce(ie,ee)+ie.x,0)),(new _.ad).extend(this.coordinateLocation(K)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(ae)).extend(this.coordinateLocation(ie))}_getBoundsRectangularTerrain(){const u=this.elevation;if(!u.visibleDemTiles.length||u.isUsingMockSource())return this._getBoundsRectangular(0,0);const g=u.visibleDemTiles.reduce((w,S)=>{if(S.dem){const D=S.dem.tree;w.min=Math.min(w.min,D.minimums[0]),w.max=Math.max(w.max,D.maximums[0])}return w},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(g.min*u.exaggeration(),g.max*u.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(u=!0){const g=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,w=this.height/2-g*(1-this._horizonShift);return u?Math.max(0,w):w}getMaxBounds(){return this.maxBounds}setMaxBounds(u){this.maxBounds=u,this.minLat=-_.bw,this.maxLat=_.bw,this.minLng=-180,this.maxLng=180,u&&(this.minLat=u.getSouth(),this.maxLat=u.getNorth(),this.minLng=u.getWest(),this.maxLng=u.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=_.a5(this.minLng)*this.tileSize,this.worldMaxX=_.a5(this.maxLng)*this.tileSize,this.worldMinY=_.ae(this.maxLat)*this.tileSize,this.worldMaxY=_.ae(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(u,g){return this.projection.createTileMatrix(this,g,u)}calculateDistanceTileData(u){const g=u.key,w=this._distanceTileDataCache;if(w[g])return w[g];const S=u.canonical,D=1/this.height,P=this.cameraWorldSize,F=P/this.zoomScale(S.z),U=(S.x+Math.pow(2,S.z)*u.wrap)*F,H=S.y*F,X=this.point;X.x*=P/this.worldSize,X.y*=P/this.worldSize;const K=this.angle,ee=Math.sin(-K),ie=-Math.cos(-K);return w[g]={bearing:[ee,ie],center:[(X.x-U)*D,(X.y-H)*D],scale:F/_.V*D},w[g]}calculateFogTileMatrix(u){const g=u.key,w=this._fogTileMatrixCache;if(w[g])return w[g];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,u);return _.a6.multiply(S,this.worldToFogMatrix,S),w[g]=new Float32Array(S),w[g]}calculateProjMatrix(u,g=!1,w=!1){const S=u.key;let D;if(D=w?this._expandedProjMatrixCache:g?this._alignedProjMatrixCache:this._projMatrixCache,D[S])return D[S];const P=this.calculatePosMatrix(u,this.worldSize);let F;return F=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:w?this.expandedFarZProjMatrix:g?this.alignedProjMatrix:this.projMatrix,_.a6.multiply(P,F,P),D[S]=new Float32Array(P),D[S]}calculatePixelsToTileUnitsMatrix(u){const g=u.tileID.key,w=this._pixelsToTileUnitsCache;if(w[g])return w[g];const S=_.bz(u,this);return w[g]=S,w[g]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const u=1/this.worldSize,g=_.a6.fromScaling([],[u,u,u]);return _.a6.multiply(g,g,this.globeMatrix),g}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const u=this._elevation;this._updateCameraState();const g=_.bl(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(g),S=this._camera.forward(),D=_.bl(1,this._center.lat);w[2]/=D,S[2]/=D,_.N.normalize(S,S);const P=u.raycast(w,S,u.exaggeration());if(P){const F=_.N.scaleAndAdd([],w,S,P),U=new _.L(F[0],F[1],_.bl(F[2],_.au(F[1]))),H=(U.z+_.N.length([U.x-w[0],U.y-w[1],U.z-w[2]*D]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(u=!1){if(!this._elevation)return;const g=this._elevation,w=_.bl(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(w),D=g.getAtPointOrZero(new _.L(...S)),P=this.pixelsPerMeter/this.worldSize*D,F=this._minimumHeightOverTerrain(),U=S[2]-P;if(U<=F)if(U<0||u){const H=this.locationCoordinate(this._center,this._centerAltitude),X=[S[0],S[1],H.z-S[2]],K=_.N.length(X);X[2]-=(F-U)/this._pixelsPerMercatorPixel;const ee=_.N.length(X);if(0===ee)return;_.N.scale(X,X,K/ee*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],H.z*this._pixelsPerMercatorPixel-X[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const u="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||u){const ee=this.center;return ee.lat=_.aa(ee.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!u)&&(ee.lng=_.aa(ee.lng,this.minLng,this.maxLng)),this.center=ee,void(this._constraining=!1)}const g=this._unmodified,{x:w,y:S}=this.point;let D=0,P=w,F=S;const U=this.width/2,H=this.height/2,X=this.worldMinY*this.scale,K=this.worldMaxY*this.scale;if(S-H<X&&(F=X+H),S+H>K&&(F=K-H),K-X<this.height&&(D=Math.max(D,this.height/(K-X)),F=(K+X)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ee=this.worldMinX*this.scale,ie=this.worldMaxX*this.scale,ae=this.worldSize/2-(ee+ie)/2;P=(w+ae+this.worldSize)%this.worldSize-ae,P-U<ee&&(P=ee+U),P+U>ie&&(P=ie-U),ie-ee<this.width&&(D=Math.max(D,this.width/(ie-ee)),P=(ie+ee)/2)}P===w&&F===S||(this.center=this.unproject(new _.P(P,F))),D&&(this.zoom+=this.scaleZoom(D)),this._constrainCamera(),this._unmodified=g,this._constraining=!1}_minZoomForBounds(){let u=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(u=Math.max(u,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),u}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const u=this.centerOffset,g="globe"===this.projection.name,w=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=_.bl(1,this.center.lat)/_.bl(1,_.bI));const S=_.bA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const D="meters"===this.projection.zAxisUnit?w:1,P=this._camera.getWorldToCamera(this.worldSize,D);let F;const U=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(U[8]=2*-u.x/this.width,U[9]=2*u.y/this.height,this.isOrthographic){let Ne=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),je=Ne*this.aspect,at=-je,Ke=-Ne;je-=u.x,at-=u.x,Ne+=u.y,Ke+=u.y,F=this._camera.getCameraToClipOrthographic(at,je,Ke,Ne,this._nearZ,this._farZ),((rt,pt,Pt,Ze)=>{for(let ht=0;ht<16;ht++)rt[ht]=ad(pt[ht],Pt[ht],Ze)})(F,F,U,Tu(this.pitch>=15?1:this.pitch/15))}else F=U;const H=_.a6.mul([],U,P);let X=_.a6.mul([],F,P);if(this.projection.isReprojectedInTileSpace){const Ne=this.locationCoordinate(this.center),je=_.a6.identity([]);_.a6.translate(je,je,[Ne.x*this.worldSize,Ne.y*this.worldSize,0]),_.a6.multiply(je,je,_.bB(this)),_.a6.translate(je,je,[-Ne.x*this.worldSize,-Ne.y*this.worldSize,0]),_.a6.multiply(X,X,je),_.a6.multiply(H,H,je),this.inverseAdjustmentMatrix=_.bC(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=_.a6.scale([],X,[this.worldSize,this.worldSize,this.worldSize/D,1]),this.projMatrix=X,this.invProjMatrix=_.a6.invert(new Float64Array(16),this.projMatrix),g){const Ne=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ne[8]=2*-u.x/this.width,Ne[9]=2*u.y/this.height,this.expandedFarZProjMatrix=_.a6.mul([],Ne,P)}else this.expandedFarZProjMatrix=this.projMatrix;const K=_.a6.invert([],F);this.frustumCorners=_.bD.fromInvProjectionMatrix(K,this.horizonLineFromTop(),this.height),this.cameraFrustum=_.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!g);const ee=new Float32Array(16);_.a6.identity(ee),_.a6.scale(ee,ee,[1,-1,1]),_.a6.rotateX(ee,ee,this._pitch),_.a6.rotateZ(ee,ee,this.angle);const ie=_.a6.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=_.a6.clone(ie);const ae=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ie[8]=2*-u.x/this.width,ie[9]=2*(u.y+ae)/this.height,this.skyboxMatrix=_.a6.multiply(ee,ie,ee);const ce=this.point,me=ce.x,se=ce.y,be=this.width%2/2,Me=this.height%2/2,we=Math.cos(this.angle),Se=Math.sin(this.angle),pe=me-Math.round(me)+we*be+Se*Me,De=se-Math.round(se)+we*Me+Se*be,Fe=new Float64Array(X);if(_.a6.translate(Fe,Fe,[pe>.5?pe-1:pe,De>.5?De-1:De,0]),this.alignedProjMatrix=Fe,X=_.a6.create(),_.a6.scale(X,X,[this.width/2,-this.height/2,1]),_.a6.translate(X,X,[1,-1,0]),this.labelPlaneMatrix=X,X=_.a6.create(),_.a6.scale(X,X,[1,-1,1]),_.a6.translate(X,X,[-1,-1,0]),_.a6.scale(X,X,[2/this.width,2/this.height,1]),this.glCoordMatrix=X,this.pixelMatrix=_.a6.multiply(new Float64Array(16),this.labelPlaneMatrix,H),this._calcFogMatrices(),this._distanceTileDataCache={},X=_.a6.invert(new Float64Array(16),this.pixelMatrix),!X)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=X,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=_.bE(this);const Ne=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=_.N.transformMat4(Ne,Ne,P),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=X;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const u=this.cameraWorldSizeForFog,g=this.cameraPixelsPerMeter,w=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,D=[u,u,g];_.N.scale(D,D,S),_.N.scale(w,w,-1),_.N.multiply(w,w,D);const P=_.a6.create();_.a6.translate(P,P,w),_.a6.scale(P,P,D),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(u,g,S)}_computeCameraPosition(u){const g=(u=u||this.pixelsPerMeter)/this.pixelsPerMeter,w=this._camera.forward(),S=this.point,D=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*g-u/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-w[0]*D,S.y/this.worldSize-w[1]*D,u/this.worldSize*this._centerAltitude-w[2]*D]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(u){const g=this._maxCameraBoundsDistance()*Math.cos(this._pitch),w=this._camera.position[2],S=u[2];let D=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(D=Math.min((g-w)/S,1)),this._camera.position=_.N.scaleAndAdd([],this._camera.position,u,D),this._updateStateFromCamera()}_updateStateFromCamera(){const u=this._camera.position,g=this._camera.forward(),{pitch:w,bearing:S}=this._camera.getPitchBearing(),D=_.bl(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(_.bj(this._maxPitch)),F=Math.max((u[2]-D)/Math.cos(w),P),U=this._zoomFromMercatorZ(F);_.N.scaleAndAdd(u,u,g,F),this._pitch=_.aa(w,_.bj(this.minPitch),_.bj(this.maxPitch)),this.angle=_.bh(S,-Math.PI,Math.PI),this._setZoom(_.aa(U,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new _.L(u[0],u[1],u[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(u){return Math.pow(2,u)*this.tileSize}_mercatorZfromZoom(u){return this.cameraToCenterDistance/this._worldSizeFromZoom(u)}_minimumHeightOverTerrain(){const u=Math.min(null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(u)}_zoomFromMercatorZ(u){return this.scaleZoom(this.cameraToCenterDistance/(u*this.tileSize))}zoomFromMercatorZAdjusted(u){let g=0,w=_.bx,S=0,D=1/0;for(;w-g>1e-6&&w>g;){const P=g+.5*(w-g),F=this.tileSize*Math.pow(2,P),U=this.getCameraToCenterDistance(this.projection,P,F),H=this.scaleZoom(U/(u*this.tileSize)),X=Math.abs(P-H);X<D&&(D=X,S=P),P<H?g=P:w=P}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(_.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(u,g){const w=Math.min(u.x,g.x),S=Math.max(u.x,g.x),D=Math.min(u.y,g.y),P=Math.max(u.y,g.y);if(D<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const F=[new _.P(w,D),new _.P(S,P),new _.P(w,P),new _.P(S,D)],U=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const X of F){const K=this.pointRayIntersection(X);if(K.t<0)return!0;const ee=this.rayIntersectionCoordinate(K);if(ee.x<U||ee.y<0||ee.x>H||ee.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+_.bF(this.fovAboveCenter)>88||this.anyCornerOffEdge(new _.P(0,0),new _.P(this.width,this.height))}zoomDeltaToMovement(u,g){const w=_.N.length(_.N.sub([],this._camera.position,u)),S=this._zoomFromMercatorZ(w)+g;return w-this._mercatorZfromZoom(S)}getCameraPoint(){if("globe"===this.projection.name){const u=function([g,w,S],D){const P=[g,w,S,1];_.a7.transformMat4(P,P,D);const F=P[3]=Math.max(P[3],1e-6);return P[0]/=F,P[1]/=F,P[2]/=F,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new _.P(u[0],u[1])}{const u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new _.P(0,u))}}getCameraToCenterDistance(u,g=this.zoom,w=this.worldSize){const S=_.bA(u,g,this.width,this.height,1024),D=u.pixelSpaceConversion(this.center.lat,w,S);let P=.5/Math.tan(.5*this._fov)*this.height*D;return this.isOrthographic&&(P=ad(1,P,Tu(this.pitch>=15?1:this.pitch/15))),P}getWorldToCameraMatrix(){const u=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&_.a6.multiply(u,u,this.globeMatrix),u}getFrustum(u){return _.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,"meters"===this.projection.zAxisUnit)}}const qs={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},Su=(x,u)=>{if(u>0&&x.terrain&&_.w("Cutoff is currently disabled on terrain"),u<=0||x.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const g=x.transform,w=Math.max(Math.abs(g._zoom-(x.minCutoffZoom-1)),1),S=g.isLODDisabled(!1)?_.O(60,45,g.pitch):_.O(30,15,g.pitch),D=g._farZ-g._nearZ,P=u*g.height,F=((1-(U=S))*g.cameraToCenterDistance+U*(g._farZ+P))*w;var U;return{shouldRenderCutoff:S<1,uniformValues:{u_cutoff_params:[g._nearZ,g._farZ,(F-g._nearZ)/D,(F-P-g._nearZ)/D]}}},Qn={cascadeCount:2,shadowMapResolution:2048};class gg{constructor(u,g){this.aabb=u,this.lastCascade=g}}class Y_{add(u,g){const w=this.receivers[u.key];void 0!==w?(w.aabb.min[0]=Math.min(w.aabb.min[0],g.min[0]),w.aabb.min[1]=Math.min(w.aabb.min[1],g.min[1]),w.aabb.min[2]=Math.min(w.aabb.min[2],g.min[2]),w.aabb.max[0]=Math.max(w.aabb.max[0],g.max[0]),w.aabb.max[1]=Math.max(w.aabb.max[1],g.max[1]),w.aabb.max[2]=Math.max(w.aabb.max[2],g.max[2])):this.receivers[u.key]=new gg(g,null)}clear(){this.receivers={}}get(u){return this.receivers[u.key]}computeRequiredCascades(u,g,w){const S=_.bS.fromPoints(u.points);let D=0;for(const P in this.receivers){const F=this.receivers[P];if(!F||!S.intersectsAabb(F.aabb))continue;F.aabb.min=S.closestPoint(F.aabb.min),F.aabb.max=S.closestPoint(F.aabb.max);const U=F.aabb.getCorners();for(let H=0;H<w.length;H++){let X=!0;for(const K of U){const ee=[K[0]*g,K[1]*g,K[2]];if(_.N.transformMat4(ee,ee,w[H].matrix),ee[0]<-1||ee[0]>1||ee[1]<-1||ee[1]>1){X=!1;break}}if(F.lastCascade=H,D=Math.max(D,H),X)break}}return D+1}}class $m{constructor(u){this.painter=u,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Y_,this._depthMode=new Pi(u.context.gl.LEQUAL,Pi.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1,u.tp.registerParameter(Qn,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),u.tp.registerParameter(Qn,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32})}destroy(){for(const u of this._cascades)u.texture.destroy(),u.framebuffer.destroy();this._cascades=[]}updateShadowParameters(u,g){const w=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!g||!g.properties)return;const S=g.properties.get("shadow-intensity");if(!g.shadowsEnabled()||S<=0||(this._shadowLayerCount=w.style.order.reduce((ae,ce)=>{const me=w.style._mergedLayers[ce];return ae+(me.hasShadowPass()&&!me.isHidden(u.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const D=w.context,P=Qn.shadowMapResolution,F=Qn.shadowMapResolution;if(0===this._cascades.length||Qn.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ae=0;ae<Qn.cascadeCount;++ae){const ce=w._shadowMapDebug,me=D.gl,se=D.createFramebuffer(P,F,ce,"texture"),be=new _.T(D,{width:P,height:F,data:null},me.DEPTH_COMPONENT);if(se.depthAttachment.set(be.texture),ce){const Me=new _.T(D,{width:P,height:F,data:null},me.RGBA);se.colorAttachment.set(Me.texture)}this._cascades.push({framebuffer:se,texture:be,matrix:[],far:0,boundingSphereRadius:0,frustum:new _.bq,scale:0})}}this.shadowDirection=mc(g);let U=0;if(u.elevation){const ae=u.elevation,ce=[1e4,-1e4];ae.visibleDemTiles.filter(me=>me.dem).forEach(me=>{const se=me.dem.tree;ce[0]=Math.min(ce[0],se.minimums[0]),ce[1]=Math.max(ce[1],se.maximums[0])}),1e4!==ce[0]&&(U=(ce[1]-ce[0])*ae.exaggeration())}const H=1.5*u.cameraToCenterDistance,X=3*H,K=new Float64Array(16);for(let ae=0;ae<this._cascades.length;++ae){const ce=this._cascades[ae];let me=u.height/50,se=1;1===Qn.cascadeCount?se=X:0===ae?se=H:(me=H,se=X);const[be,Me]=mC(u,this.shadowDirection,me,se,Qn.shadowMapResolution,U);ce.scale=u.scale,ce.matrix=be,ce.boundingSphereRadius=Me,_.a6.invert(K,ce.matrix),ce.frustum=_.bq.fromInvProjectionMatrix(K,1,0,!0),ce.far=se}const ee=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[ee].far,this._cascades[ee].far],this._uniformValues.u_shadow_intensity=S,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Qn.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Qn.shadowMapResolution,this._uniformValues.u_shadowmap_0=qs.ShadowMap0,this._uniformValues.u_shadowmap_1=qs.ShadowMap0+1,this._groundShadowTiles=w.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ie=w.transform.elevation;for(const ae of this._groundShadowTiles){let ce={min:0,max:0};if(ie){const me=ie.getMinMaxForTile(ae);me&&(ce=me)}this.addShadowReceiver(ae.toUnwrapped(),ce.min,ce.max)}}get enabled(){return this._enabled}set enabled(u){this._enabled=u}drawShadowPass(u,g){if(!this._enabled)return;const w=this.painter,S=w.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(w.transform.getFrustum(0),w.transform.worldSize,this._cascades),S.viewport.set([0,0,Qn.shadowMapResolution,Qn.shadowMapResolution]);for(let D=0;D<this._numCascadesToRender;++D){w.currentShadowCascade=D,S.bindFramebuffer.set(this._cascades[D].framebuffer.framebuffer),S.clear({color:_.ax.white,depth:1});for(const P of u.order){const F=u._mergedLayers[P];if(!F.hasShadowPass()||F.isHidden(w.transform.zoom))continue;const U=u.getLayerSourceCache(F),H=U?g[U.id]:void 0;("model"===F.type||H&&H.length)&&w.renderLayer(w,U,F,H)}}w.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const u=this.painter,g=u.style,w=u.context,S=g.directionalLight,D=g.ambientLight;if(!S||!D)return;const P=[],F=Su(u,u.longestCutoffRange);F.shouldRenderCutoff&&P.push("RENDER_CUTOFF");const U=Nc(S,D),H=new Pi(w.gl.LEQUAL,Pi.ReadOnly,u.depthRangeFor3D);for(const X of this._groundShadowTiles){const K=X.toUnwrapped(),ee=u.isTileAffectedByFog(X),ie=u.getOrCreateProgram("groundShadow",{defines:P,overrideFog:ee});this.setupShadows(K,ie),u.uploadCommonUniforms(w,ie,K,null,F);const ae={u_matrix:u.transform.calculateProjMatrix(K),u_ground_shadow_factor:U};ie.draw(u,w.gl.TRIANGLES,H,nn.disabled,$n.multiply,rn.disabled,ae,"ground_shadow",u.tileExtentBuffer,u.quadTriangleIndexBuffer,u.tileExtentSegments,{},u.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?$n.unblended:$n.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(u){const g=this.painter.transform,w=g.calculatePosMatrix(u,g.worldSize);return _.a6.multiply(w,this._cascades[this.painter.currentShadowCascade].matrix,w),Float32Array.from(w)}calculateShadowPassMatrixFromMatrix(u){return _.a6.multiply(u,this._cascades[this.painter.currentShadowCascade].matrix,u),Float32Array.from(u)}setupShadows(u,g,w,S=0){if(!this._enabled)return;const D=this.painter.transform,P=this.painter.context,F=P.gl,U=this._uniformValues,H=new Float64Array(16),X=D.calculatePosMatrix(u,D.worldSize);for(let K=0;K<this._cascades.length;K++)_.a6.multiply(H,this._cascades[K].matrix,X),U[0===K?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(H),P.activeTexture.set(F.TEXTURE0+qs.ShadowMap0+K),this._cascades[K].texture.bind(F.NEAREST,F.CLAMP_TO_EDGE);if(this.useNormalOffset=!!w,this.useNormalOffset){const K=_.bR(u.canonical),ee=2/D.tileSize*_.V/Qn.shadowMapResolution,ie=ee*this._cascades[0].boundingSphereRadius,ae=ee*this._cascades[this._cascades.length-1].boundingSphereRadius,ce=("vector-tile"===w?1:3)/Math.pow(2,S-u.canonical.z-(1-D.zoom+Math.floor(D.zoom)));U.u_shadow_normal_offset=[K,ie*ce,ae*ce],U.u_shadow_bias=[6e-5,.0012,.012]}else U.u_shadow_bias=[36e-5,.0012,.012];g.setShadowUniformValues(P,U)}setupShadowsFromMatrix(u,g,w=!1){if(!this._enabled)return;const S=this.painter.context,D=S.gl,P=this._uniformValues,F=new Float64Array(16);for(let U=0;U<Qn.cascadeCount;U++)_.a6.multiply(F,this._cascades[U].matrix,u),P[0===U?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(F),S.activeTexture.set(D.TEXTURE0+qs.ShadowMap0+U),this._cascades[U].texture.bind(D.NEAREST,D.CLAMP_TO_EDGE);this.useNormalOffset=w,w?(P.u_shadow_normal_offset=[1,5,5],P.u_shadow_bias=[6e-5,.0012,.012]):P.u_shadow_bias=[36e-5,.0012,.012],g.setShadowUniformValues(S,P)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(u,g,w,S){if(S[2]>=0)return{};const D=function(U,H,X){const K=X/(1<<U.canonical.z);return new _.bS([U.canonical.x*K+U.wrap*X,U.canonical.y*K+U.wrap*X,0],[(U.canonical.x+1)*K+U.wrap*X,(U.canonical.y+1)*K+U.wrap*X,H])}(u,g,w).getCorners(),P=g/-S[2];S[0]<0?(_.N.add(D[0],D[0],[S[0]*P,0,0]),_.N.add(D[3],D[3],[S[0]*P,0,0])):S[0]>0&&(_.N.add(D[1],D[1],[S[0]*P,0,0]),_.N.add(D[2],D[2],[S[0]*P,0,0])),S[1]<0?(_.N.add(D[0],D[0],[0,S[1]*P,0]),_.N.add(D[1],D[1],[0,S[1]*P,0])):S[1]>0&&(_.N.add(D[2],D[2],[0,S[1]*P,0]),_.N.add(D[3],D[3],[0,S[1]*P,0]));const F={};return F.vertices=D,F.planes=[Xd(D[1],D[0],D[4]),Xd(D[2],D[1],D[5]),Xd(D[3],D[2],D[6]),Xd(D[0],D[3],D[7])],F}addShadowReceiver(u,g,w){this._receivers.add(u,_.bS.fromTileIdAndHeight(u,g,w))}getMaxCascadeForTile(u){const g=this._receivers.get(u);return g&&g.lastCascade?g.lastCascade:0}}function Xd(x,u,g){const w=_.N.sub([],g,u),S=_.N.sub([],x,u),D=_.N.cross([],w,S),P=_.N.length(D);return 0===P?[0,0,1,0]:(_.N.scale(D,D,1/P),[D[0],D[1],D[2],-_.N.dot(D,u)])}function mc(x){const u=x.properties.get("direction"),g=_.bQ(u.x,u.y,u.z);g[2]=_.aa(g[2],0,75);const w=_.bT([g[0],g[1],g[2]]);return _.N.fromValues(w.x,w.y,w.z)}function Nc(x,u){const g=x.properties.get("color"),w=x.properties.get("intensity"),S=x.properties.get("direction"),D=[S.x,S.y,S.z],P=u.properties.get("color"),F=u.properties.get("intensity"),U=Math.max(_.N.dot([0,0,1],D),0),H=[0,0,0];_.N.scale(H,P.toArray01Linear().slice(0,3),F);const X=[0,0,0];return _.N.scale(X,g.toArray01Linear().slice(0,3),U*w),_.bU([H[0]>0?H[0]/(H[0]+X[0]):0,H[1]>0?H[1]/(H[1]+X[1]):0,H[2]>0?H[2]/(H[2]+X[2]):0])}function mC(x,u,g,w,S,D){const P=x.zoom,F=x.scale,U=x.worldSize,H=1/U,X=x.aspect,K=Math.sqrt(1+X*X)*Math.tan(.5*x.fovX),ee=K*K,ie=w-g,ae=w+g;let ce,me;ee>ie/ae?(ce=w,me=w*K):(ce=.5*ae*(1+ee),me=.5*Math.sqrt(ie*ie+2*(w*w+g*g)*ee+ae*ae*ee*ee));const se=x.projection.pixelsPerMeter(x.center.lat,U),be=x._camera.getCameraToWorldMercator(),Me=[0,0,-ce*H];_.N.transformMat4(Me,Me,be);let we=me*H;const Se=x._edgeInsets;if(!(0===Se.left&&0===Se.top&&0===Se.right&&0===Se.bottom||Se.left===Se.right&&Se.top===Se.bottom)){const ti=x._camera.getWorldToCamera(x.worldSize,"meters"===x.projection.zAxisUnit?se:1),Wt=x._camera.getCameraToClipPerspective(x._fov,x.width/x.height,g,w);Wt[8]=2*-x.centerOffset.x/x.width,Wt[9]=2*x.centerOffset.y/x.height;const _i=new Float64Array(16);_.a6.mul(_i,Wt,ti);const vi=new Float64Array(16);_.a6.invert(vi,_i);const Yi=_.bq.fromInvProjectionMatrix(vi,U,P,!0);for(const qi of Yi.points){const Xi=((pe=qi)[0]/=F,pe[1]/=F,pe[2]=_.bl(pe[2],x._center.lat),pe);we=Math.max(we,_.N.len(_.N.subtract([],Me,Xi)))}}var pe;we*=S/(S-1);const De=Math.acos(u[2]),Fe=Math.atan2(-u[0],-u[1]),Ne=new bf;Ne.position=Me,Ne.setPitchBearing(De,Fe);const je=Ne.getWorldToCamera(U,se),at=we*U,Ke=Math.min(x._mercatorZfromZoom(17)*U*-2,-2*at),rt=Ne.getCameraToClipOrthographic(-at,at,-at,at,Ke,(at+D*se)/u[2]),pt=new Float64Array(16);_.a6.multiply(pt,rt,je);const Pt=_.N.fromValues(Math.floor(1e6*Me[0])/1e6*U,Math.floor(1e6*Me[1])/1e6*U,0),Ze=.5*S,ht=[0,0,0];_.N.transformMat4(ht,Pt,pt),_.N.scale(ht,ht,Ze);const ze=[Math.floor(ht[0]),Math.floor(ht[1]),Math.floor(ht[2])],Ye=[0,0,0];_.N.sub(Ye,ht,ze),_.N.scale(Ye,Ye,-1/Ze);const Mt=new Float64Array(16);return _.a6.identity(Mt),_.a6.translate(Mt,Mt,Ye),_.a6.multiply(pt,Mt,pt),[pt,at]}const ka=(x,u)=>Ni(x,u&&u.filter(g=>"source.canvas"!==g.identifier)),Dx=_.ac(Kn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Wm=_.ac(Kn,["setCenter","setZoom","setBearing","setPitch"]),Xm={version:8,layers:[],sources:{}},yf={duration:300,delay:0},xf=new Set(["fill","line","background","hillshade","raster"]);class Gl extends _.E{constructor(u,g={}){super(),this.map=u,this.scope=g.scope||"",this.fragments=[],this.importDepth=g.importDepth||0,this.importsCache=g.importsCache||new Map,this.resolvedImports=g.resolvedImports||new Set,this.transition=_.e({},yf),this._buildingIndex=new $_(this),this.crossTileSymbolIndex=new zo,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=g.styleChanges||new yi,this.dispatcher=g.dispatcher?g.dispatcher:new _.bW(_.bX(),this),g.imageManager?this.imageManager=g.imageManager:(this.imageManager=new vn,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=g.glyphManager?g.glyphManager:new _.bY(u._requestManager,g.localFontFamily?_.bZ.all:g.localIdeographFontFamily?_.bZ.ideographs:_.bZ.none,g.localFontFamily||g.localIdeographFontFamily),g.modelManager?this.modelManager=g.modelManager:(this.modelManager=new en(u._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=g.configOptions?g.configOptions:new Map,this._configDependentLayers=g.configDependentLayers?g.configDependentLayers:new Set,this._config=g.config,this.dispatcher.broadcast("setReferrer",_.b_());const w=this;this._rtlTextPluginCallback=Gl.registerForPluginStateChange(S=>{w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(D,P)=>{if(_.b$(D),P&&P.every(F=>F))for(const F in w._sourceCaches){const U=w._sourceCaches[F],H=U.getSource().type;"vector"!==H&&"geojson"!==H||U.reload()}})}),this.on("data",S=>{if("source"!==S.dataType||"metadata"!==S.sourceDataType)return;const D=this.getOwnSource(S.sourceId);if(D&&D.vectorLayerIds)for(const P in this._layers){const F=this._layers[P];F.source===D.id&&this._validateLayer(F)}})}loadURL(u,g={}){this.fire(new _.b("dataloading",{dataType:"style"}));const w="boolean"==typeof g.validate?g.validate:!_.c0(u);u=this.map._requestManager.normalizeStyleURL(u,g.accessToken),this.resolvedImports.add(u);const S=this.importsCache.get(u);if(S)return this._load(S,w);const D=this.map._requestManager.transformRequest(u,_.R.Style);this._request=_.g(D,(P,F)=>{if(this._request=null,P)this.fire(new _.a(P));else if(F)return this.importsCache.set(u,F),this._load(F,w)})}loadJSON(u,g={}){this.fire(new _.b("dataloading",{dataType:"style"})),this._request=_.f.frame(()=>{this._request=null,this._load(u,!1!==g.validate)})}loadEmpty(){this.fire(new _.b("dataloading",{dataType:"style"})),this._load(Xm,!1)}_loadImports(u,g,w){if(this.importDepth>=4)return _.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const S=[];for(const D of u){const P=this._createFragmentStyle(D),F=new Promise(X=>{P.once("style.import.load",X),P.once("error",X)}).then(()=>this.mergeAll());if(S.push(F),this.resolvedImports.has(D.url)){P.loadEmpty();continue}const U=D.data||this.importsCache.get(D.url);U?P.loadJSON(U,{validate:g}):D.url?P.loadURL(D.url,{validate:g}):P.loadEmpty();const H={style:P,id:D.id,config:D.config};if(w){const X=this.fragments.findIndex(({id:K})=>K===w);this.fragments=this.fragments.slice(0,X).concat(H).concat(this.fragments.slice(X))}else this.fragments.push(H)}return Promise.allSettled(S)}_createFragmentStyle(u){const g=this.scope?_.ag(u.id,this.scope):u.id,w=new Gl(this.map,{scope:g,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:u.config,configOptions:this.options,configDependentLayers:this._configDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const u=this.isRootStyle();this._shouldPrecompile=u,this.fire(new _.b(u?"style.load":"style.import.load"))}_load(u,g){const w=u.schema;if(this.isRootStyle()&&(u.fragment||w&&!1!==u.fragment)){const P=_.e({},Xm,{imports:[{id:"basemap",data:u,url:""}]});return void this._load(P,g)}if(this.setConfig(this._config,w),g&&ka(this,br(u)))return;this._loaded=!0,this.stylesheet=_.c1(u);for(const P in u.sources)this.addSource(P,u.sources[P],{validate:!1,isInitialLoad:!0});u.sprite?this._loadSprite(u.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(u.glyphs,this.scope);const S=gf(this.stylesheet.layers);if(this._order=S.map(P=>P.id),this.stylesheet.light&&_.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const P=this.stylesheet.lights[0];this.light=new $i(P.properties,P.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new $i(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const P of S){const F=_.c2(P,this.scope,this.options);F.isConfigDependent&&this._configDependentLayers.add(F.fqid),F.setEventedParent(this,{layer:{id:F.id}}),this._layers[F.id]=F,this._serializedLayers[F.id]=F.serialize();const U=this.getOwnLayerSourceCache(F),H=!!this.directionalLight&&this.directionalLight.shadowsEnabled();U&&F.canCastShadows()&&H&&(U.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const D=this.stylesheet.terrain;D&&(void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=_.f.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?_.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(D,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new _.b("data",{dataType:"style"})),u.imports?this._loadImports(u.imports,g).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return 0===this.importDepth}mergeAll(){let u,g,w,S,D,P,F,U;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(H=>{if(H.stylesheet){if(null!=H.light&&(u=H.light),H.stylesheet.lights)for(const X of H.stylesheet.lights)"ambient"===X.type&&null!=H.ambientLight&&(g=H.ambientLight),"directional"===X.type&&null!=H.directionalLight&&(w=H.directionalLight);S=this._prioritizeTerrain(S,H.terrain,H.stylesheet.terrain),H.stylesheet.fog&&null!=H.fog&&(D=H.fog),null!=H.stylesheet.camera&&(U=H.stylesheet.camera),null!=H.stylesheet.projection&&(P=H.stylesheet.projection),null!=H.stylesheet.transition&&(F=H.stylesheet.transition)}}),this.light=u,this.ambientLight=g,this.directionalLight=w,this.fog=D,null===S?delete this.terrain:this.terrain=S,this.camera=U||{"camera-projection":"perspective"},this.projection=P||{name:"mercator"},this.transition=_.e({},yf,F),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(u){const g=w=>{for(const S of w.fragments)g(S.style);u(w)};g(this)}_prioritizeTerrain(u,g,w){const S=u&&0===u.drapeRenderMode;return null===w?g&&0===g.drapeRenderMode?g:S?u:null:null!=g&&(!u||S||g&&1===g.drapeRenderMode)?g:u}mergeTerrain(){let u;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(g=>{u=this._prioritizeTerrain(u,g.terrain,g.stylesheet.terrain)}),null===u?delete this.terrain:this.terrain=u}mergeProjection(){let u;this.forEachFragmentStyle(g=>{null!=g.stylesheet.projection&&(u=g.stylesheet.projection)}),this.projection=u||{name:"mercator"}}mergeSources(){const u={},g={},w={};this.forEachFragmentStyle(S=>{for(const D in S._sourceCaches){const P=_.ag(D,S.scope);u[P]=S._sourceCaches[D]}for(const D in S._otherSourceCaches){const P=_.ag(D,S.scope);g[P]=S._otherSourceCaches[D]}for(const D in S._symbolSourceCaches){const P=_.ag(D,S.scope);w[P]=S._symbolSourceCaches[D]}}),this._mergedSourceCaches=u,this._mergedOtherSourceCaches=g,this._mergedSymbolSourceCaches=w}mergeLayers(){const u={},g=[],w={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(D=>{for(const P of D._order){const F=D._layers[P];if("slot"===F.type){const U=_.c3(P);if(u[U])continue;u[U]=[]}F.slot&&u[F.slot]?u[F.slot].push(F):g.push(F)}}),this._mergedOrder=[];const S=(D=[])=>{for(const P of D)if("slot"===P.type){const F=_.c3(P.id);u[F]&&S(u[F])}else{const F=_.ag(P.id,P.scope);this._mergedOrder.push(F),w[F]=P,P.is3D()&&(this._has3DLayers=!0),"circle"===P.type&&(this._hasCircleLayers=!0),"symbol"===P.type&&(this._hasSymbolLayers=!0)}};S(g),this._mergedLayers=w,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(u){return this.stylesheet.camera=_.e({},this.stylesheet.camera,u),this.camera=this.stylesheet.camera,this}setProjection(u){u?this.stylesheet.projection=u:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(u){this._spriteRequest=function(g,w,S){let D,P,F;const U=_.f.devicePixelRatio>1?"@2x":"";let H=_.g(w.transformRequest(w.normalizeSpriteURL(g,U,".json"),_.R.SpriteJSON),(ee,ie)=>{H=null,F||(F=ee,D=ie,K())}),X=_.d(w.transformRequest(w.normalizeSpriteURL(g,U,".png"),_.R.SpriteImage),(ee,ie)=>{X=null,F||(F=ee,P=ie,K())});function K(){if(F)S(F);else if(D&&P){const ee=_.f.getImageData(P),ie={};for(const ae in D){const{width:ce,height:me,x:se,y:be,sdf:Me,pixelRatio:we,stretchX:Se,stretchY:pe,content:De}=D[ae],Fe=new _.h({width:ce,height:me});_.h.copy(ee,Fe,{x:se,y:be},{x:0,y:0},{width:ce,height:me}),ie[ae]={data:Fe,pixelRatio:we,sdf:Me,stretchX:Se,stretchY:pe,content:De}}S(null,ie)}}return{cancel(){H&&(H.cancel(),H=null),X&&(X.cancel(),X=null)}}}(u,this.map._requestManager,(g,w)=>{if(this._spriteRequest=null,g)this.fire(new _.a(g));else if(w)for(const S in w)this.imageManager.addImage(S,this.scope,w[S]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new _.b("data",{dataType:"style"}))})}_validateLayer(u){const g=this.getOwnSource(u.source);if(!g)return;const w=u.sourceLayer;w&&("geojson"===g.type||g.vectorLayerIds&&-1===g.vectorLayerIds.indexOf(w))&&this.fire(new _.a(new Error(`Source layer "${w}" does not exist on source "${g.id}" as specified by style layer "${u.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const u in this._sourceCaches)if(!this._sourceCaches[u].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:u}of this.fragments)if(!u.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((u,g)=>{const w=this.fragments[g];return w&&w.style&&(u.data=w.style.serialize()),u})}_serializeSources(){const u={};for(const g in this._sourceCaches){const w=this._sourceCaches[g].getSource();u[w.id]||(u[w.id]=w.serialize())}return u}_serializeLayers(u){const g=[];for(const w of u){const S=this._layers[w];S&&"custom"!==S.type&&g.push(S.serialize())}return g}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const u in this._sourceCaches)if(this._sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(u){return!!this.terrain&&("function"==typeof u.isLayerDraped?u.isLayerDraped(this.getLayerSourceCache(u)):xf.has(u.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(u){const g=this.getOwnLayer(u);if(g)return g;this.fire(new _.a(new Error(`The layer '${u}' does not exist in the map's style.`)))}_checkSource(u){const g=this.getOwnSource(u);if(g)return g;this.fire(new _.a(new Error(`The source '${u}' does not exist in the map's style.`)))}update(u){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(u),this.directionalLight&&this.directionalLight.recalculate(u);const g=this.calculateLightsBrightness();u.brightness=g||0,g!==this._brightness&&(this._brightness=g,this.dispatcher.broadcast("setBrightness",g));const w=this._changes.isDirty();if(this._changes.isDirty()){const D=this._changes.getLayerUpdatesByScope();for(const P in D){const{updatedIds:F,removedIds:U}=D[P];(F||U)&&this._updateWorkerLayers(P,F,U)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(u),this.light&&this.light.updateTransitions(u),this.ambientLight&&this.ambientLight.updateTransitions(u),this.directionalLight&&this.directionalLight.updateTransitions(u),this.fog&&this.fog.updateTransitions(u),this._changes.reset()}const S={};for(const D in this._mergedSourceCaches){const P=this._mergedSourceCaches[D];S[D]=P.used,P.used=!1,P.tileCoverLift=0}for(const D of this._mergedOrder){const P=this._mergedLayers[D];if(P.recalculate(u,this._availableImages),!P.isHidden(u.zoom)){const F=this.getLayerSourceCache(P);F&&(F.used=!0,F.tileCoverLift=Math.max(F.tileCoverLift,P.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let F=P.minzoom||0;F<(P.maxzoom||25.5);F++){const U=this.map.painter;if(U){const H=P.getProgramIds();if(!H)continue;for(const X of H){const K=P.getDefaultProgramParams(X,u.zoom);K&&(U.style=this,this.fog&&(U._fogVisible=!0,K.overrideFog=!0,U.getOrCreateProgram(X,K)),U._fogVisible=!1,K.overrideFog=!1,U.getOrCreateProgram(X,K),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(K.overrideRtt=!0,U.getOrCreateProgram(X,K)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const D in S){const P=this._mergedSourceCaches[D];S[D]!==P.used&&P.getSource().fire(new _.b("data",{sourceDataType:"visibility",dataType:"source",sourceId:P.getSource().id}))}this.light&&this.light.recalculate(u),this.terrain&&this.terrain.recalculate(u),this.fog&&this.fog.recalculate(u),this.z=u.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),w&&this.fire(new _.b("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=this._changes.getUpdatedImages();if(u.length){for(const g in this._sourceCaches)this._sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],u);this._changes.resetUpdatedImages()}}_updateWorkerLayers(u,g,w){const S=this.getFragmentStyle(u);S&&this.dispatcher.broadcast("updateLayers",{layers:g?S._serializeLayers(g):[],scope:u,removedIds:w||[],options:S.options})}setState(u){if(this._checkLoaded(),ka(this,br(u)))return!1;(u=_.c1(u)).layers=gf(u.layers);const g=function(S,D){if(!S)return[{command:Kn.setStyle,args:[D]}];let P=[];try{if(!Tt(S.version,D.version))return[{command:Kn.setStyle,args:[D]}];Tt(S.center,D.center)||P.push({command:Kn.setCenter,args:[D.center]}),Tt(S.zoom,D.zoom)||P.push({command:Kn.setZoom,args:[D.zoom]}),Tt(S.bearing,D.bearing)||P.push({command:Kn.setBearing,args:[D.bearing]}),Tt(S.pitch,D.pitch)||P.push({command:Kn.setPitch,args:[D.pitch]}),Tt(S.sprite,D.sprite)||P.push({command:Kn.setSprite,args:[D.sprite]}),Tt(S.glyphs,D.glyphs)||P.push({command:Kn.setGlyphs,args:[D.glyphs]}),Tt(S.imports,D.imports)||function(K=[],ee=[],ie){ee=ee||[];const ae=(K=K||[]).map(re),ce=ee.map(re),me=K.reduce(_e,{}),se=ee.reduce(_e,{}),be=ae.slice();let Me,we,Se,pe;for(Me=0,we=0;Me<ae.length;Me++)Se=ae[Me],se.hasOwnProperty(Se)?we++:(ie.push({command:Kn.removeImport,args:[Se]}),be.splice(be.indexOf(Se,we),1));for(Me=0,we=0;Me<ce.length;Me++)Se=ce[ce.length-1-Me],be[be.length-1-Me]!==Se&&(me.hasOwnProperty(Se)?(ie.push({command:Kn.removeImport,args:[Se]}),be.splice(be.lastIndexOf(Se,be.length-we),1)):we++,pe=be[be.length-Me],ie.push({command:Kn.addImport,args:[se[Se],pe]}),be.splice(be.length-Me,0,Se));for(const De of ee){const Fe=me[De.id];Fe&&!Tt(Fe,De)&&ie.push({command:Kn.updateImport,args:[De.id,De]})}}(S.imports,D.imports,P),Tt(S.transition,D.transition)||P.push({command:Kn.setTransition,args:[D.transition]}),Tt(S.light,D.light)||P.push({command:Kn.setLight,args:[D.light]}),Tt(S.fog,D.fog)||P.push({command:Kn.setFog,args:[D.fog]}),Tt(S.projection,D.projection)||P.push({command:Kn.setProjection,args:[D.projection]}),Tt(S.lights,D.lights)||P.push({command:Kn.setLights,args:[D.lights]}),Tt(S.camera,D.camera)||P.push({command:Kn.setCamera,args:[D.camera]});const F={},U=[];!function(K,ee,ie,ae){let ce;for(ce in ee=ee||{},K=K||{})K.hasOwnProperty(ce)&&(ee.hasOwnProperty(ce)||Oc(ce,ie,ae));for(ce in ee){if(!ee.hasOwnProperty(ce))continue;const me=ee[ce];K.hasOwnProperty(ce)?Tt(K[ce],me)||("geojson"===K[ce].type&&"geojson"===me.type&&N(K,ee,ce)?ie.push({command:Kn.setGeoJSONSourceData,args:[ce,me.data]}):he(ce,ee,ie,ae)):zm(ce,ee,ie)}}(S.sources,D.sources,U,F);const H=[];S.layers&&S.layers.forEach(K=>{K.source&&F[K.source]?P.push({command:Kn.removeLayer,args:[K.id]}):H.push(K)});let X=S.terrain;X&&F[X.source]&&(P.push({command:Kn.setTerrain,args:[void 0]}),X=void 0),P=P.concat(U),Tt(X,D.terrain)||P.push({command:Kn.setTerrain,args:[D.terrain]}),function(K,ee,ie){ee=ee||[];const ae=(K=K||[]).map(re),ce=ee.map(re),me=K.reduce(_e,{}),se=ee.reduce(_e,{}),be=ae.slice(),Me=Object.create(null);let we,Se,pe,De,Fe,Ne,je;for(we=0,Se=0;we<ae.length;we++)pe=ae[we],se.hasOwnProperty(pe)?Se++:(ie.push({command:Kn.removeLayer,args:[pe]}),be.splice(be.indexOf(pe,Se),1));for(we=0,Se=0;we<ce.length;we++)pe=ce[ce.length-1-we],be[be.length-1-we]!==pe&&(me.hasOwnProperty(pe)?(ie.push({command:Kn.removeLayer,args:[pe]}),be.splice(be.lastIndexOf(pe,be.length-Se),1)):Se++,Ne=be[be.length-we],ie.push({command:Kn.addLayer,args:[se[pe],Ne]}),be.splice(be.length-we,0,pe),Me[pe]=!0);for(we=0;we<ce.length;we++)if(pe=ce[we],De=me[pe],Fe=se[pe],!Me[pe]&&!Tt(De,Fe))if(Tt(De.source,Fe.source)&&Tt(De["source-layer"],Fe["source-layer"])&&Tt(De.type,Fe.type)){for(je in W(De.layout,Fe.layout,ie,pe,null,Kn.setLayoutProperty),W(De.paint,Fe.paint,ie,pe,null,Kn.setPaintProperty),Tt(De.slot,Fe.slot)||ie.push({command:Kn.setSlot,args:[pe,Fe.slot]}),Tt(De.filter,Fe.filter)||ie.push({command:Kn.setFilter,args:[pe,Fe.filter]}),Tt(De.minzoom,Fe.minzoom)&&Tt(De.maxzoom,Fe.maxzoom)||ie.push({command:Kn.setLayerZoomRange,args:[pe,Fe.minzoom,Fe.maxzoom]}),De)De.hasOwnProperty(je)&&"layout"!==je&&"paint"!==je&&"filter"!==je&&"metadata"!==je&&"minzoom"!==je&&"maxzoom"!==je&&"slot"!==je&&(0===je.indexOf("paint.")?W(De[je],Fe[je],ie,pe,je.slice(6),Kn.setPaintProperty):Tt(De[je],Fe[je])||ie.push({command:Kn.setLayerProperty,args:[pe,je,Fe[je]]}));for(je in Fe)Fe.hasOwnProperty(je)&&!De.hasOwnProperty(je)&&"layout"!==je&&"paint"!==je&&"filter"!==je&&"metadata"!==je&&"minzoom"!==je&&"maxzoom"!==je&&"slot"!==je&&(0===je.indexOf("paint.")?W(De[je],Fe[je],ie,pe,je.slice(6),Kn.setPaintProperty):Tt(De[je],Fe[je])||ie.push({command:Kn.setLayerProperty,args:[pe,je,Fe[je]]}))}else ie.push({command:Kn.removeLayer,args:[pe]}),Ne=be[be.lastIndexOf(pe)+1],ie.push({command:Kn.addLayer,args:[Fe,Ne]})}(H,D.layers,P)}catch(F){console.warn("Unable to compute style diff:",F),P=[{command:Kn.setStyle,args:[D]}]}return P}(this.serialize(),u).filter(S=>!(S.command in Wm));if(0===g.length)return!1;const w=g.filter(S=>!(S.command in Dx));if(w.length>0)throw new Error(`Unimplemented: ${w.map(S=>S.command).join(", ")}.`);return g.forEach(S=>{this[S.command].apply(this,S.args)}),this.stylesheet=u,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(u,g){return this.getImage(u)?this.fire(new _.a(new Error("An image with this name already exists."))):(this.imageManager.addImage(u,this.scope,g),this._afterImageUpdated(u),this)}updateImage(u,g){this.imageManager.updateImage(u,this.scope,g)}getImage(u){return this.imageManager.getImage(u,this.scope)}removeImage(u){return this.getImage(u)?(this.imageManager.removeImage(u,this.scope),this._afterImageUpdated(u),this):this.fire(new _.a(new Error("No image with this name exists.")))}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(u),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new _.b("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(u,g,w={}){return this._checkLoaded(),this._validate(hi,`models.${u}`,g,null,w)||(this.modelManager.addModel(u,g,this.scope),this._changes.setDirty()),this}hasModel(u){return this.modelManager.hasModel(u,this.scope)}removeModel(u){return this.hasModel(u)?(this.modelManager.removeModel(u,this.scope),this):this.fire(new _.a(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(u,g,w={}){if(this._checkLoaded(),void 0!==this.getOwnSource(u))throw new Error(`There is already a source with ID "${u}".`);if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(Ho,`sources.${u}`,g,null,w))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const S=Ls(u,g,this.dispatcher,this);S.scope=this.scope,S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(S.id),source:S.serialize(),sourceId:S.id}));const D=P=>{const F=(P?"symbol:":"other:")+S.id,U=_.ag(F,this.scope),H=this._sourceCaches[F]=new cc(U,S,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[S.id]=H,H.onAdd(this.map)};D(!1),"vector"!==g.type&&"geojson"!==g.type||D(!0),S.onAdd&&S.onAdd(this.map),w.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(u){this._checkLoaded();const g=this.getOwnSource(u);if(!g)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===u)return this.fire(new _.a(new Error(`Source "${u}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===u)return this.fire(new _.a(new Error(`Source "${u}" cannot be removed while terrain is using it.`)));const w=this.getOwnSourceCaches(u);for(const S of w){const D=_.c3(S.id);delete this._sourceCaches[D],this._changes.discardSourceCacheUpdate(S.id),S.fire(new _.b("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles()}return delete this._otherSourceCaches[u],delete this._symbolSourceCaches[u],this.mergeSources(),g.setEventedParent(null),g.onRemove&&g.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(u,g){this._checkLoaded(),this.getOwnSource(u).setData(g),this._changes.setDirty()}getOwnSource(u){const g=this.getOwnSourceCache(u);return g&&g.getSource()}getOwnSources(){const u=[];for(const g in this._otherSourceCaches){const w=this.getOwnSourceCache(g);w&&u.push(w.getSource())}return u}areTilesLoaded(){const u=this._mergedSourceCaches;for(const g in u){const w=u[g]._tiles;for(const S in w){const D=w[S];if("loaded"!==D.state&&"errored"!==D.state)return!1}}return!0}setLights(u){if(this._checkLoaded(),!u)return delete this.ambientLight,void delete this.directionalLight;const g=this._getTransitionParameters();for(const S of u){if(this._validate(lt,"lights",S))return;switch(S.type){case"ambient":if(this.ambientLight){const D=this.ambientLight;D.set(S),D.updateTransitions(g)}else this.ambientLight=new Hs(S,ca,this.scope,this.options);break;case"directional":if(this.directionalLight){const D=this.directionalLight;D.set(S),D.updateTransitions(g)}else this.directionalLight=new Hs(S,ls,this.scope,this.options)}}const w=new _.K(this.z||0,g);this.ambientLight&&this.ambientLight.recalculate(w),this.directionalLight&&this.directionalLight.recalculate(w),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const u=this.directionalLight,g=this.ambientLight;if(!u||!g)return;const w=K=>.2126*(K[0]<=.03928?K[0]/12.92:Math.pow((K[0]+.055)/1.055,2.4))+.7152*(K[1]<=.03928?K[1]/12.92:Math.pow((K[1]+.055)/1.055,2.4))+.0722*(K[2]<=.03928?K[2]/12.92:Math.pow((K[2]+.055)/1.055,2.4)),S=u.properties.get("color").toArray01(),D=u.properties.get("intensity"),P=u.properties.get("direction"),F=1-_.bQ(P.x,P.y,P.z)[2]/90,U=w(S)*D*F,H=g.properties.get("color").toArray01(),X=g.properties.get("intensity");return(U+w(H)*X)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const u=[];return this.directionalLight&&u.push(this.directionalLight.get()),this.ambientLight&&u.push(this.ambientLight.get()),u}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(u){if(!u)return this;if(_.c4(u)){const g=_.c5(u),w=this.fragments.find(({id:D})=>D===g);if(!w)throw new Error(`Style import not found: ${u}`);const S=_.c3(u);return w.style.getFragmentStyle(S)}{const g=this.fragments.find(({id:w})=>w===u);if(!g)throw new Error(`Style import not found: ${u}`);return g.style}}getConfigProperty(u,g){const w=this.getFragmentStyle(u);if(!w)return null;const S=_.ag(g,w.scope),D=w.options.get(S),P=D?D.value||D.default:null;return P?P.serialize():null}setConfigProperty(u,g,w){const S=_.r(w);if("success"!==S.result)return void ka(this,S.value);const D=S.value.expression,P=this.getFragmentStyle(u);if(!P)return;const F=_.ag(g,P.scope),U=P.options.get(F);U&&(this.options.set(F,{...U,value:D}),this.updateConfigDependencies())}setConfig(u,g){if(this._config=u,u||g)if(g)for(const w in g){let S,D;const P=_.r(g[w].default);if("success"===P.result&&(S=P.value.expression),u&&void 0!==u[w]){const ee=_.r(u[w]);"success"===ee.result&&(D=ee.value.expression)}const{minValue:F,maxValue:U,stepValue:H,type:X,values:K}=g[w];if(S){const ee=_.ag(w,this.scope);this.options.set(ee,{default:S,value:D,minValue:F,maxValue:U,stepValue:H,type:X,values:K})}else this.fire(new _.a(new Error(`No schema defined for config option "${w}".`)))}else this.fire(new _.a(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const u of this._configDependentLayers){const g=this.getLayer(u);g&&(g.possiblyEvaluateVisibility(),this._updateLayer(g))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this._changes.setDirty()}addLayer(u,g,w={}){this._checkLoaded();const S=u.id;if(this._layers[S])return void this.fire(new _.a(new Error(`Layer with id "${S}" already exists on this map`)));let D;if("custom"===u.type){if(ka(this,_.c6(u)))return;D=_.c2(u,this.scope,this.options)}else{if("object"==typeof u.source&&(this.addSource(S,u.source),u=_.c1(u),u=_.e(u,{source:S})),this._validate(He,`layers.${S}`,u,{arrayIndex:-1},w))return;D=_.c2(u,this.scope,this.options),this._validateLayer(D),D.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[D.id]=D.serialize()}D.isConfigDependent&&this._configDependentLayers.add(D.fqid);let P=this._order.length;if(g){const X=this._order.indexOf(g);if(-1===X)return void this.fire(new _.a(new Error(`Layer with id "${g}" does not exist on this map.`)));D.slot===this._layers[g].slot?P=X:_.w(`Layer with id "${g}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(P,0,S),this._layerOrderChanged=!0,this._layers[S]=D;const F=this.getOwnLayerSourceCache(D),U=!!this.directionalLight&&this.directionalLight.shadowsEnabled();F&&D.canCastShadows()&&U&&(F.castsShadows=!0);const H=this._changes.getRemovedLayer(D);if(H&&D.source&&F&&"custom"!==D.type){this._changes.discardLayerRemoval(D);const X=_.ag(D.source,D.scope);H.type!==D.type?this._changes.updateSourceCache(X,"clear"):(this._changes.updateSourceCache(X,"reload"),F.pause())}this._updateLayer(D),D.onAdd&&D.onAdd(this.map),D.scope=this.scope,this.mergeLayers()}moveLayer(u,g){this._checkLoaded();const w=this._checkLayer(u);if(!w||u===g)return;const S=this._order.indexOf(u);this._order.splice(S,1);let D=this._order.length;if(g){const P=this._order.indexOf(g);if(-1===P)return void this.fire(new _.a(new Error(`Layer with id "${g}" does not exist on this map.`)));w.slot===this._layers[g].slot?D=P:_.w(`Layer with id "${g}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(D,0,u),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(u){this._checkLoaded();const g=this._checkLayer(u);if(!g)return;g.setEventedParent(null);const w=this._order.indexOf(u);this._order.splice(w,1),delete this._layers[u],delete this._serializedLayers[u],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(g.fqid),this._changes.removeLayer(g);const S=this.getOwnLayerSourceCache(g);if(S&&S.castsShadows){let D=!1;for(const P in this._layers)if(this._layers[P].source===g.source&&this._layers[P].canCastShadows()){D=!0;break}S.castsShadows=D}g.onRemove&&g.onRemove(this.map),this.mergeLayers()}getOwnLayer(u){return this._layers[u]}hasLayer(u){return u in this._mergedLayers}hasLayerType(u){for(const g in this._layers)if(this._layers[g].type===u)return!0;return!1}setLayerZoomRange(u,g,w){this._checkLoaded();const S=this._checkLayer(u);S&&(S.minzoom===g&&S.maxzoom===w||(null!=g&&(S.minzoom=g),null!=w&&(S.maxzoom=w),this._updateLayer(S)))}setSlot(u,g){this._checkLoaded();const w=this._checkLayer(u);w&&w.slot!==g&&(w.slot=g,this._updateLayer(w))}setFilter(u,g,w={}){this._checkLoaded();const S=this._checkLayer(u);if(S&&!Tt(S.filter,g))return null==g?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(ut,`layers.${S.id}.filter`,g,{layerType:S.type},w)||(S.filter=_.c1(g),this._updateLayer(S)))}getFilter(u){const g=this._checkLayer(u);if(g)return _.c1(g.filter)}setLayoutProperty(u,g,w,S={}){this._checkLoaded();const D=this._checkLayer(u);if(D&&!Tt(D.getLayoutProperty(g),w)){if(null!=w&&(!S||!1!==S.validate)&&ka(D,Ht.call(br,{key:`layers.${u}.layout.${g}`,layerType:D.type,objectKey:g,value:w,styleSpec:_.D,style:{glyphs:!0,sprite:!0}})))return;D.setLayoutProperty(g,w),D.isConfigDependent&&this._configDependentLayers.add(D.fqid),this._updateLayer(D)}}getLayoutProperty(u,g){const w=this._checkLayer(u);if(w)return w.getLayoutProperty(g)}setPaintProperty(u,g,w,S={}){this._checkLoaded();const D=this._checkLayer(u);if(!D||Tt(D.getPaintProperty(g),w)||null!=w&&(!S||!1!==S.validate)&&ka(D,bt.call(br,{key:`layers.${u}.paint.${g}`,layerType:D.type,objectKey:g,value:w,styleSpec:_.D})))return;const P=D.setPaintProperty(g,w);D.isConfigDependent&&this._configDependentLayers.add(D.fqid),P&&this._updateLayer(D),this._changes.updatePaintProperties(D)}getPaintProperty(u,g){const w=this._checkLayer(u);if(w)return w.getPaintProperty(g)}setFeatureState(u,g){this._checkLoaded();const w=u.source,S=u.sourceLayer,D=this._checkSource(w);if(!D)return;const P=D.type;if("geojson"===P&&S)return void this.fire(new _.a(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===P&&!S)return void this.fire(new _.a(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===u.id&&this.fire(new _.a(new Error("The feature id parameter must be provided.")));const F=this.getOwnSourceCaches(w);for(const U of F)U.setFeatureState(S,u.id,g)}removeFeatureState(u,g){this._checkLoaded();const w=u.source,S=this._checkSource(w);if(!S)return;const D=S.type,P="vector"===D?u.sourceLayer:void 0;if("vector"===D&&!P)return void this.fire(new _.a(new Error("The sourceLayer parameter must be provided for vector source types.")));if(g&&"string"!=typeof u.id&&"number"!=typeof u.id)return void this.fire(new _.a(new Error("A feature id is required to remove its specific state property.")));const F=this.getOwnSourceCaches(w);for(const U of F)U.removeFeatureState(P,u.id,g)}getFeatureState(u){this._checkLoaded();const g=u.source,w=u.sourceLayer,S=this._checkSource(g);if(S){if("vector"!==S.type||w)return void 0===u.id&&this.fire(new _.a(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(g)[0].getFeatureState(w,u.id);this.fire(new _.a(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(u){return this.stylesheet.transition=_.e({},this.stylesheet.transition,u),this.transition=this.stylesheet.transition,this}getTransition(){return _.e({},this.stylesheet.transition)}serialize(){this._checkLoaded();const u=this.getTerrain(),g=u&&this.terrain&&this.terrain.scope===this.scope?u:this.stylesheet.terrain;return _.c7({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:g,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},w=>void 0!==w)}_updateLayer(u){this._changes.updateLayer(u);const g=this.getLayerSourceCache(u),w=_.ag(u.source,u.scope),S=this._changes.getUpdatedSourceCaches();u.source&&!S[w]&&g&&"raster"!==g.getSource().type&&(this._changes.updateSourceCache(w,"reload"),g.pause()),u.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(u){const g=F=>"fill-extrusion"===this._mergedLayers[F].type||"model"===this._mergedLayers[F].type,w=this.order,S={},D=[];for(let F=w.length-1;F>=0;F--){const U=w[F];if(g(U)){S[U]=F;for(const H of u){const X=H[U];if(X)for(const K of X)D.push(K)}}}D.sort((F,U)=>U.intersectionZ-F.intersectionZ);const P=[];for(let F=w.length-1;F>=0;F--){const U=w[F];if(g(U))for(let H=D.length-1;H>=0;H--){const X=D[H].feature;if(S[X.layer.id]<F)break;P.push(X),D.pop()}else for(const H of u){const X=H[U];if(X)for(const K of X)P.push(K.feature)}}return P}queryRenderedFeatures(u,g,w){g&&g.filter&&this._validate(ut,"queryRenderedFeatures.filter",g.filter,null,g),g.scope=this.scope,g.availableImages=this._availableImages,g.serializedLayers=this._serializedLayers;const S={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new _.a(new Error("parameters.layers must be an Array."))),[];for(const H of g.layers){const X=this._mergedLayers[H];if(!X)return this.fire(new _.a(new Error(`The layer '${H}' does not exist in the map's style and cannot be queried for features.`))),[];S[X.source]=!0}}const D=[],P=g.serializedLayers||{},F=g&&g.layers?g.layers.some(H=>{const X=this.getLayer(H);return X&&X.is3D()}):this.has3DLayers(),U=Yo.createFromScreenPoints(u,w);for(const H in this._mergedSourceCaches){const X=this._mergedSourceCaches[H].getSource();if(!X||X.scope!==g.scope)continue;const K=this._mergedSourceCaches[H].getSource().id;g.layers&&!S[K]||D.push(pf(this._mergedSourceCaches[H],this._mergedLayers,P,U,g,w,F,!!this.map._showQueryGeometry))}return this.placement&&D.push(function(H,X,K,ee,ie,ae,ce){const me={},se=ae.queryRenderedSymbols(ee),be=[];for(const Me of Object.keys(se).map(Number))be.push(ce[Me]);be.sort(Pc);for(const Me of be){const we=Me.featureIndex.lookupSymbolFeatures(se[Me.bucketInstanceId],X,Me.bucketIndex,Me.sourceLayerIndex,ie.filter,ie.layers,ie.availableImages,H);for(const Se in we){const pe=me[Se]=me[Se]||[],De=we[Se];De.sort((Fe,Ne)=>{const je=Me.featureSortOrder;if(je){const at=je.indexOf(Fe.featureIndex);return je.indexOf(Ne.featureIndex)-at}return Ne.featureIndex-Fe.featureIndex});for(const Fe of De)pe.push(Fe)}}for(const Me in me)me[Me].forEach(we=>{const Se=we.feature,pe=K(H[Me]);if(!pe)return;const De=pe.getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=De});return me}(this._mergedLayers,P,this.getLayerSourceCache.bind(this),U.screenGeometry,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(D)}querySourceFeatures(u,g){g&&g.filter&&this._validate(ut,"querySourceFeatures.filter",g.filter,null,g);const w=this.getOwnSourceCaches(u);let S=[];for(const D of w)S=S.concat(rd(D,g));return S}addSourceType(u,g,w){return Gl.getSourceType(u)?w(new Error(`A source type called "${u}" already exists.`)):(Gl.setSourceType(u,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:u,url:g.workerSourceURL},w):w(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(u,g,w={}){this._checkLoaded();const S=this.light.getLight();let D=!1;for(const F in u)if(!Tt(u[F],S[F])){D=!0;break}if(!D)return;const P=this._getTransitionParameters();this.light.setLight(u,g,w),this.light.updateTransitions(P)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(u,g=1){if(this._checkLoaded(),!u)return this.terrainSetForDrapingOnly()&&0!==g||delete this.terrain,null===u?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let w=u;const S=null==u.source;if(1===g){if("object"==typeof w.source){const F="terrain-dem-src";this.addSource(F,w.source),w=_.c1(w),w=_.e(w,{source:F})}const D=_.e({},w),P={};if(this.terrain&&S){D.source=this.terrain.get().source;const F=this.terrain?this.getFragmentStyle(this.terrain.scope):null;F&&(P.style=F.serialize())}if(this._validate(ve,"terrain",D,P))return}if(!this.terrain||this.terrain.scope!==this.scope&&!S||this.terrain&&g!==this.terrain.drapeRenderMode){if(!w)return;this._createTerrain(w,g),this.fire(new _.b("data",{dataType:"style"}))}else{const D=this.terrain,P=D.get();for(const F of Object.keys(_.D.terrain))!w.hasOwnProperty(F)&&_.D.terrain[F].default&&(w[F]=_.D.terrain[F].default);for(const F in u)if(!Tt(u[F],P[F])){D.set(u,this.options),this.stylesheet.terrain=u;const U=this._getTransitionParameters({duration:0});D.updateTransitions(U),this.fire(new _.b("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(u){const g=this.fog=new ro(u,this.map.transform,this.scope,this.options);this.stylesheet.fog=g.get();const w=this._getTransitionParameters({duration:0});g.updateTransitions(w)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const u of this.map._markers)u._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(u){if(this._checkLoaded(),!u)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const g=this.fog;if(!Tt(g.get(),u)){g.set(u,this.options),this.stylesheet.fog=g.get();const w=this._getTransitionParameters({duration:0});g.updateTransitions(w)}}else this._createFog(u);this._markersNeedUpdate=!0}_getTransitionParameters(u){return{now:_.f.now(),transition:_.e(this.transition,u)}}updateDrapeFirstLayers(){if(!this.terrain)return;const u=[],g=[];for(const w in this._mergedLayers)this.isLayerDraped(this._mergedLayers[w])?u.push(w):g.push(w);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...u),this._drapedFirstOrder.push(...g)}_createTerrain(u,g){const w=this.terrain=new eo(u,g,this.scope,this.options);1===g&&(this.stylesheet.terrain=u),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const S=this._getTransitionParameters({duration:0});w.updateTransitions(S)}_force3DLayerUpdate(){for(const u in this._layers){const g=this._layers[u];"fill-extrusion"===g.type&&this._updateLayer(g)}}_forceSymbolLayerUpdate(){for(const u in this._layers){const g=this._layers[u];"symbol"===g.type&&this._updateLayer(g)}}_validate(u,g,w,S,D={}){if(D&&!1===D.validate)return!1;const P=_.e({},this.serialize());return ka(this,u.call(br,_.e({key:g,style:P,value:w,styleSpec:_.D},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),_.c8.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._mergedLayers)this._mergedLayers[u].setEventedParent(null);for(const u in this._mergedSourceCaches)this._mergedSourceCaches[u].clearTiles(),this._mergedSourceCaches[u].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(u){const g=this.getSourceCaches(u);for(const w of g)w.clearTiles()}clearSources(){for(const u in this._mergedSourceCaches)this._mergedSourceCaches[u].clearTiles()}reloadSource(u){const g=this.getSourceCaches(u);for(const w of g)w.resume(),w.reload()}reloadSources(){for(const u of this.getSources())u.reload&&u.reload()}updateSources(u){let g;this.directionalLight&&(g=mc(this.directionalLight));for(const w in this._mergedSourceCaches)this._mergedSourceCaches[w].update(u,void 0,void 0,g)}_generateCollisionBoxes(){for(const u in this._sourceCaches){const g=this._sourceCaches[u];g.resume(),g.reload()}}_updatePlacement(u,g,w,S,D=!1){let P=!1,F=!1;const U={},H={};for(const X of this._mergedOrder){const K=this._mergedLayers[X];if("symbol"!==K.type)continue;const ee=_.ag(K.source,K.scope);let ie=U[ee];if(!ie){const ce=this.getLayerSourceCache(K);if(!ce)continue;const me=ce.getRenderableIds(!0).map(se=>ce.getTileByID(se));H[ee]=me.slice(),ie=U[ee]=me.sort((se,be)=>be.tileID.overscaledZ-se.tileID.overscaledZ||(se.tileID.isLessThan(be.tileID)?-1:1))}const ae=this.crossTileSymbolIndex.addLayer(K,ie,u.center.lng,u.projection);P=P||ae}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),D=D||this._layerOrderChanged||0===w,this._layerOrderChanged&&this.fire(new _.b("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(_.f.now(),u.zoom))&&(this.pauseablePlacement=new mg(u,this._mergedOrder,D,g,w,S,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,U,H),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(_.f.now()),F=!0),P&&this.pauseablePlacement.placement.setStale()),F||P){this._buildingIndex.onNewFrame(u.zoom);for(const X of this._mergedOrder){const K=this._mergedLayers[X];"symbol"===K.type&&this.placement.updateLayerOpacities(K,U[_.ag(K.source,K.scope)])}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(_.f.now())}_releaseSymbolFadeTiles(){for(const u in this._sourceCaches)this._sourceCaches[u].releaseSymbolFadeTiles()}addImport(u,g){this._checkLoaded();const w=this.stylesheet.imports=this.stylesheet.imports||[];if(-1!==w.findIndex(({id:D})=>D===u.id))return this.fire(new _.a(new Error(`Import with id '${u.id}' already exists in the map's style.`)));if(!g)return w.push(u),this._loadImports([u],!0),this;const S=w.findIndex(({id:D})=>D===g);return-1===S?this.fire(new _.a(new Error(`Import with id "${g}" does not exist on this map.`))):(this.stylesheet.imports=w.slice(0,S).concat(u).concat(w.slice(S)),this._loadImports([u],!0,g),this)}updateImport(u,g){this._checkLoaded();const w=this.stylesheet.imports||[],S=this.getImportIndex(u);return-1===S?this:"string"==typeof g?(this.setImportUrl(u,g),this):(g.url&&g.url!==w[S].url&&this.setImportUrl(u,g.url),Tt(g.config,w[S].config)||this.setImportConfig(u,g.config),Tt(g.data,w[S].data)||this.setImportData(u,g.data),this)}moveImport(u,g){this._checkLoaded();let w=this.stylesheet.imports||[];const S=this.getImportIndex(u);if(-1===S)return this;const D=this.getImportIndex(g);if(-1===D)return this;const P=w[S],F=this.fragments[S];return w=w.filter(({id:U})=>U!==u),this.fragments=this.fragments.filter(({id:U})=>U!==u),this.stylesheet.imports=w.slice(0,D).concat(P).concat(w.slice(D)),this.fragments=this.fragments.slice(0,D).concat(F).concat(this.fragments.slice(D)),this.mergeLayers(),this}setImportUrl(u,g){this._checkLoaded();const w=this.stylesheet.imports||[],S=this.getImportIndex(u);if(-1===S)return this;w[S].url=g;const D=this.fragments[S];return D.style=this._createFragmentStyle(w[S]),D.style.on("style.import.load",()=>this.mergeAll()),D.style.loadURL(g),this}setImportData(u,g){this._checkLoaded();const w=this.getImportIndex(u),S=this.stylesheet.imports||[];return-1===w?this:g?(this.fragments[w].style.setState(g),this._reloadImports(),this):(delete S[w].data,this.setImportUrl(u,S[w].url))}setImportConfig(u,g){this._checkLoaded();const w=this.getImportIndex(u),S=this.stylesheet.imports||[];if(-1===w)return this;g?S[w].config=g:delete S[w].config;const D=this.fragments[w],P=D.style.stylesheet&&D.style.stylesheet.schema;return D.config=g,D.style.setConfig(g,P),this.updateConfigDependencies(),this}removeImport(u){this._checkLoaded();const g=this.stylesheet.imports||[],w=this.getImportIndex(u);return-1===w||(g.splice(w,1),this.fragments[w].style._remove(),this.fragments.splice(w,1),this._reloadImports()),this}getImportIndex(u){const g=(this.stylesheet.imports||[]).findIndex(w=>w.id===u);return-1===g&&this.fire(new _.a(new Error(`Import '${u}' does not exist in the map's style and cannot be updated.`))),g}getLayer(u){return this._mergedLayers[u]}getSources(){const u=[];for(const g in this._mergedOtherSourceCaches){const w=this._mergedOtherSourceCaches[g];w&&u.push(w.getSource())}return u}getSource(u,g){const w=this.getSourceCache(u,g);return w&&w.getSource()}getLayerSource(u){const g=this.getLayerSourceCache(u);return g&&g.getSource()}getSourceCache(u,g){const w=_.ag(u,g);return this._mergedOtherSourceCaches[w]}getLayerSourceCache(u){const g=_.ag(u.source,u.scope);return"symbol"===u.type?this._mergedSymbolSourceCaches[g]:this._mergedOtherSourceCaches[g]}getSourceCaches(u){const g=[];return this._mergedOtherSourceCaches[u]&&g.push(this._mergedOtherSourceCaches[u]),this._mergedSymbolSourceCaches[u]&&g.push(this._mergedSymbolSourceCaches[u]),g}updateSourceCaches(){const u=this._changes.getUpdatedSourceCaches();for(const g in u){const w=u[g];"reload"===w?this.reloadSource(g):"clear"===w&&this.clearSource(g)}}updateLayers(u){const g=this._changes.getUpdatedPaintProperties();for(const w of g){const S=this.getLayer(w);S&&S.updateTransitions(u)}}getImages(u,g,w){this.imageManager.getImages(g.icons,g.scope,w),this._updateTilesForChangedImages();const S=D=>{D&&D.setDependencies(g.tileID.key,g.type,g.icons)};S(this._otherSourceCaches[g.source]),S(this._symbolSourceCaches[g.source])}getGlyphs(u,g,w){this.glyphManager.getGlyphs(g.stacks,g.scope,w)}getResource(u,g,w){return _.c9(g,w)}getOwnSourceCache(u){return this._otherSourceCaches[u]}getOwnLayerSourceCache(u){return"symbol"===u.type?this._symbolSourceCaches[u.source]:this._otherSourceCaches[u.source]}getOwnSourceCaches(u){const g=[];return this._otherSourceCaches[u]&&g.push(this._otherSourceCaches[u]),this._symbolSourceCaches[u]&&g.push(this._symbolSourceCaches[u]),g}_isSourceCacheLoaded(u){const g=this.getOwnSourceCaches(u);return 0===g.length?(this.fire(new _.a(new Error(`There is no source with ID '${u}'`))),!1):g.every(w=>w.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(u=>{u.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Gl.getSourceType=function(x){return Gd[x]},Gl.setSourceType=function(x,u){Gd[x]=u},Gl.registerForPluginStateChange=_.bV;var qm="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",pc="\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif\nvec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}",Mu="\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}",Ym="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Dr="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",To="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Z_="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",wf="#ifdef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)\n);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)\n);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",Cf="#ifdef RASTER_ARRAY\nuniform sampler2D u_velocity;uniform vec2 u_velocity_res;uniform float u_max_speed;const vec2 INVALID_VELOCITY=vec2(-1);uniform vec2 u_texture_offset;uniform float u_data_offset;uniform vec4 u_data_scale;vec2 lookup_velocity(vec2 uv) {uv=u_texture_offset.x+u_texture_offset.y*uv;vec2 fxy;ivec4 c=_raTexLinearCoord(uv,u_velocity_res,fxy);vec4 tl=texelFetch(u_velocity,c.yz,0);vec4 tr=texelFetch(u_velocity,c.xz,0);vec4 bl=texelFetch(u_velocity,c.yw,0);vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NODATA) {return INVALID_VELOCITY;}if (tr==NODATA) {return INVALID_VELOCITY;}if (bl==NODATA) {return INVALID_VELOCITY;}if (br==NODATA) {return INVALID_VELOCITY;}vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);\n#ifdef DATA_FORMAT_UINT32\nvec2 velocity=vec2(u_data_offset+dot(t,u_data_scale),0);return velocity;\n#else\nvec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));\n#endif\nreturn velocity/max(u_max_speed,length(velocity));}\n#endif",qb="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",Zm="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef NATIVE\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const Au=[];Yd(qm,Au),Yd(Mu,Au),Yd(pc,Au);const Cr={"_prelude_fog.vertex.glsl":To,"_prelude_terrain.vertex.glsl":Dr,"_prelude_shadow.vertex.glsl":qb,"_prelude_fog.fragment.glsl":Z_,"_prelude_shadow.fragment.glsl":Zm,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":wf,"_prelude_raster_particle.glsl":Cf},qd={};kr("",Dr),kr(Z_,To),kr(Zm,qb),kr(wf,""),kr(Cf,"");const _g=kr(pc,Mu),Ia=qm;var vg={background:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:kr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:kr('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:kr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:kr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:kr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:kr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin highp vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nuniform float u_emissive_strength;in float v_height;void main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat cutoff=1.0;vec3 scaled_pos=pos;\n#ifdef RENDER_CUTOFF\nvec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),fillExtrusionDepth:kr("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nout vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:kr('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:kr("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;\n#endif\nHANDLE_WIREFRAME_DEBUG;\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:kr("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    \nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 v_uv;\n#endif\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float pattern_x=v_linesofar/pattern_size.x*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}\n#endif\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_ground(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 a_packed;\n#endif\nin float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nout highp vec4 v_uv;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nfloat a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nin float v_split_fade;\n#endif\nuniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;\n#ifdef GLOBE_POLES\ncolor.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);\n#endif\nvec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef PROJECTION_GLOBE_VIEW\nglFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));\n#endif\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nout float v_split_fade;\n#endif\nvoid main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    \nv_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\ngl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),rasterParticle:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\nin vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;vec2 uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nvec2 uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}'),rasterParticleDraw:kr("precision highp float;uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",'precision highp float;\n#include "_prelude_raster_array.glsl"\n#include "_prelude_raster_particle.glsl"\nin vec3 a_pos;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {vec2 pos=a_pos.xy+u_tile_offset;vec2 tex_coords=fract(pos);gl_PointSize=1.0;vec2 velocity=lookup_velocity(tex_coords);if (velocity==INVALID_VELOCITY) {v_particle_speed=0.0;gl_Position=vec4(2.0,2.0,2.0,1.0);} else {v_particle_speed=length(velocity);gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);}}'),rasterParticleTexture:kr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {v_tex_pos=0.5*a_pos+vec2(0.5);gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:kr("void main() {}",'#include "_prelude_raster_array.glsl"\n#include "_prelude_raster_particle.glsl"\nin vec3 a_pos;uniform float u_speed_factor;uniform float u_lifetime_delta;uniform float u_rand_seed;out vec3 v_new_particle;const vec3 rand_constants=vec3(12.9898,78.233,4375.85453);float rand(const vec2 co) {float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {float lifetime=a_pos.z;vec2 pos=a_pos.xy;vec2 uv=clamp(pos,vec2(0.0),vec2(1.0));vec2 velocity=lookup_velocity(uv);float next_lifetime=lifetime-u_lifetime_delta;float t=step(0.0,next_lifetime);\n#ifdef DATA_FORMAT_UINT32\nvec2 dp=vec2(0);\n#else\nvec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;\n#endif\nvec2 seed=pos*u_rand_seed;vec2 next_pos=pos+dp;vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));v_new_particle=vec3(\nvec2(mix(random_pos,next_pos,t)),mix(1.0,next_lifetime,t)\n);}'),symbolIcon:kr('#include "_prelude_lighting.glsl"\nuniform sampler2D u_texture;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\nin float v_fade_opacity;in vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nuniform mediump float u_icon_saturation;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nlowp float alpha=opacity*v_fade_opacity;vec4 out_color;\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;\n#else\nout_color=texture(u_texture,v_tex_a)*alpha;\n#endif\n#ifdef SATURATION\nvec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nv_tex_a=a_tex/u_texsize;\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\nv_fade_opacity=out_fade_opacity;}'),symbolSDF:kr('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}'),symbolTextAndIcon:kr('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nfloat out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}'),terrainRaster:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);\n#endif\n}'),terrainDepth:kr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:kr('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Ym),skyboxGradient:kr('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Ym),skyboxCapture:kr("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:kr('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:kr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nuniform vec4 u_occlusionTextureTransform;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\nif(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}\n#endif\nreturn vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nvec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;\n#else\nvec2 uv=uv_2f;\n#endif\nao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 shadow_pos=local_pos;\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:kr("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:kr("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}")};function Yd(x,u){const g=x.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let w of g)if(w=w.trim(),"#"===w[0]&&w.includes("if")&&!w.includes("endif")){w=w.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=w.split(" ");for(const D of S)u.includes(D)||u.push(D)}}function kr(x,u){const g=/#include\s+"([^"]+)"/g,w=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let S=u.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);S&&(S=S.map(H=>{const X=H.split(" ");return X[X.length-1]}),S=[...new Set(S)]);const D={},P=[],F=[];if(x=x.replace(g,(H,X)=>(F.push(X),"")),(u=u.replace(g,(H,X)=>(P.push(X),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let U=[...Au];Yd(x,U),Yd(u,U);for(const H of[...P,...F])Cr[H]||console.error(`Undefined include: ${H}`),qd[H]||(qd[H]=[],Yd(Cr[H],qd[H])),U=[...U,...qd[H]];return{fragmentSource:x=x.replace(w,(H,X,K,ee,ie)=>(D[ie]=!0,"define"===X?`\n#ifndef HAS_UNIFORM_u_${ie}\nin ${K} ${ee} ${ie};\n#else\nuniform ${K} ${ee} u_${ie};\n#endif\n`:"initialize"===X?`\n#ifdef HAS_UNIFORM_u_${ie}\n    ${K} ${ee} ${ie} = u_${ie};\n#endif\n`:"define-attribute"===X?`\n#ifdef HAS_ATTRIBUTE_a_${ie}\n    in ${K} ${ee} ${ie};\n#endif\n`:"initialize-attribute"===X?"":void 0)),vertexSource:u=u.replace(w,(H,X,K,ee,ie)=>{const ae="float"===ee?"vec2":ee,ce=ie.match(/color/)?"color":ae;return"define-attribute-vertex-shader-only"===X?`\n#ifdef HAS_ATTRIBUTE_a_${ie}\nin ${K} ${ee} a_${ie};\n#endif\n`:D[ie]?"define"===X?`\n#ifndef HAS_UNIFORM_u_${ie}\nuniform lowp float u_${ie}_t;\nin ${K} ${ae} a_${ie};\nout ${K} ${ee} ${ie};\n#else\nuniform ${K} ${ee} u_${ie};\n#endif\n`:"initialize"===X?"vec4"===ce?`\n#ifndef HAS_UNIFORM_u_${ie}\n    ${ie} = a_${ie};\n#else\n    ${K} ${ee} ${ie} = u_${ie};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ie}\n    ${ie} = unpack_mix_${ce}(a_${ie}, u_${ie}_t);\n#else\n    ${K} ${ee} ${ie} = u_${ie};\n#endif\n`:"define-attribute"===X?`\n#ifdef HAS_ATTRIBUTE_a_${ie}\n    in ${K} ${ee} a_${ie};\n    out ${K} ${ee} ${ie};\n#endif\n`:"initialize-attribute"===X?`\n#ifdef HAS_ATTRIBUTE_a_${ie}\n    ${ie} = a_${ie};\n#endif\n`:void 0:"define"===X?`\n#ifndef HAS_UNIFORM_u_${ie}\nuniform lowp float u_${ie}_t;\nin ${K} ${ae} a_${ie};\n#else\nuniform ${K} ${ee} u_${ie};\n#endif\n`:"define-instanced"===X?"mat4"===ce?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${ie}0;\nin vec4 a_${ie}1;\nin vec4 a_${ie}2;\nin vec4 a_${ie}3;\n#else\nuniform ${K} ${ee} u_${ie};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${K} ${ae} a_${ie};\n#else\nuniform ${K} ${ee} u_${ie};\n#endif\n`:"initialize-attribute-custom"===X?`\n#ifdef HAS_ATTRIBUTE_a_${ie}\n    ${K} ${ee} ${ie} = a_${ie};\n#endif\n`:"vec4"===ce?`\n#ifndef HAS_UNIFORM_u_${ie}\n    ${K} ${ee} ${ie} = a_${ie};\n#else\n    ${K} ${ee} ${ie} = u_${ie};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ie}\n    ${K} ${ee} ${ie} = unpack_mix_${ce}(a_${ie}, u_${ie}_t);\n#else\n    ${K} ${ee} ${ie} = u_${ie};\n#endif\n`}),staticAttributes:S,usedDefines:U,vertexIncludes:P,fragmentIncludes:F}}class Ef{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(u,g,w,S,D,P,F,U){this.context=u;let H=this.boundPaintVertexBuffers.length!==S.length;for(let K=0;!H&&K<S.length;K++)this.boundPaintVertexBuffers[K]!==S[K]&&(H=!0);let X=this.boundDynamicVertexBuffers.length!==F.length;for(let K=0;!X&&K<F.length;K++)this.boundDynamicVertexBuffers[K]!==F[K]&&(X=!0);if(!this.vao||this.boundProgram!==g||this.boundLayoutVertexBuffer!==w||H||X||this.boundIndexBuffer!==D||this.boundVertexOffset!==P)this.freshBind(g,w,S,D,P,F,U);else{u.bindVertexArrayOES.set(this.vao);for(const K of F)K&&(K.bind(),U&&K.instanceCount&&K.setVertexAttribDivisor(u.gl,g,U));D&&D.dynamicDraw&&D.bind()}}freshBind(u,g,w,S,D,P,F){const U=u.numAttributes,H=this.context,X=H.gl;this.vao&&this.destroy(),this.vao=H.gl.createVertexArray(),H.bindVertexArrayOES.set(this.vao),this.boundProgram=u,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=S,this.boundVertexOffset=D,this.boundDynamicVertexBuffers=P,g.enableAttributes(X,u),g.bind(),g.setVertexAttribPointers(X,u,D);for(const K of w)K.enableAttributes(X,u),K.bind(),K.setVertexAttribPointers(X,u,D);for(const K of P)K&&(K.enableAttributes(X,u),K.bind(),K.setVertexAttribPointers(X,u,D),F&&K.instanceCount&&K.setVertexAttribDivisor(X,u,F));S&&S.bind(),H.currentNumAttributes=U}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Yb(x,u){const g=Math.pow(2,u.canonical.z),w=u.canonical.y;return[new _.L(0,w/g).toLngLat().lat,new _.L(0,(w+1)/g).toLngLat().lat]}function os(x,u,g,w,S,D,P){const F=x.context,U=F.gl,H=g.hillshadeFBO;if(!H)return;x.prepareDrawTile();const X=x.isTileAffectedByFog(u),K=x.getOrCreateProgram("hillshade",{overrideFog:X});F.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,H.colorAttachment.get());const ee=((me,se,be,Me)=>{const we=be.paint.get("hillshade-shadow-color"),Se=be.paint.get("hillshade-highlight-color"),pe=be.paint.get("hillshade-accent-color"),De=be.paint.get("hillshade-emissive-strength");let Fe=_.bj(be.paint.get("hillshade-illumination-direction"));if("viewport"===be.paint.get("hillshade-illumination-anchor"))Fe-=me.transform.angle;else if(me.style&&me.style.enable3dLights()&&me.style.directionalLight){const je=me.style.directionalLight.properties.get("direction"),at=_.bQ(je.x,je.y,je.z);Fe=_.bj(at[1])}const Ne=!me.options.moving;return{u_matrix:Me||me.transform.calculateProjMatrix(se.tileID.toUnwrapped(),Ne),u_image:0,u_latrange:Yb(0,se.tileID),u_light:[be.paint.get("hillshade-exaggeration"),Fe],u_shadow:we,u_highlight:Se,u_emissive_strength:De,u_accent:pe}})(x,g,w,x.terrain?u.projMatrix:null);x.uploadCommonUniforms(F,K,u.toUnwrapped());const{tileBoundsBuffer:ie,tileBoundsIndexBuffer:ae,tileBoundsSegments:ce}=x.getTileBoundsBuffers(g);K.draw(x,U.TRIANGLES,S,D,P,rn.disabled,ee,w.id,ie,ae,ce)}function K_(x,u,g){if(!u.needsDEMTextureUpload)return;const w=x.context,S=w.gl;w.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||x.getTileTexture(g.stride);const D=g.getPixels();u.demTexture?u.demTexture.update(D,{premultiply:!1}):u.demTexture=new _.T(w,D,S.R32F,{premultiply:!1}),u.needsDEMTextureUpload=!1}function Q_(x,u,g){const w=x.context,S=w.gl;if(!u.dem)return;const D=u.dem;if(w.activeTexture.set(S.TEXTURE1),K_(x,u,D),!u.demTexture)return;u.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const P=D.dim;w.activeTexture.set(S.TEXTURE0);let F=u.hillshadeFBO;if(!F){const ee=new _.T(w,{width:P,height:P,data:null},S.RGBA);ee.bind(S.LINEAR,S.CLAMP_TO_EDGE),F=u.hillshadeFBO=w.createFramebuffer(P,P,!0,"renderbuffer"),F.colorAttachment.set(ee.texture)}w.bindFramebuffer.set(F.framebuffer),w.viewport.set([0,0,P,P]);const{tileBoundsBuffer:U,tileBoundsIndexBuffer:H,tileBoundsSegments:X}=x.getMercatorTileBoundsBuffers(),K=[];x.linearFloatFilteringSupported()&&K.push("TERRAIN_DEM_FLOAT_FORMAT"),x.getOrCreateProgram("hillshadePrepare",{defines:K}).draw(x,S.TRIANGLES,Pi.disabled,nn.disabled,$n.unblended,rn.disabled,((ee,ie)=>{const ae=ie.stride,ce=_.a6.create();return _.a6.ortho(ce,0,_.V,-_.V,0,0,1),_.a6.translate(ce,ce,[0,-_.V,0]),{u_matrix:ce,u_image:1,u_dimension:[ae,ae],u_zoom:ee.overscaledZ}})(u.tileID,D),g.id,U,H,X),u.needsHillshadePrepare=!1}const Km=x=>({u_matrix:new _.bK(x),u_image0:new _.bO(x),u_skirt_height:new _.bN(x),u_ground_shadow_factor:new _.bM(x)}),Tf=(x,u,g)=>({u_matrix:x,u_image0:0,u_skirt_height:u,u_ground_shadow_factor:g}),Sf=(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce)=>({u_proj_matrix:Float32Array.from(x),u_globe_matrix:u,u_normalize_matrix:Float32Array.from(w),u_merc_matrix:g,u_zoom_transition:S,u_merc_center:D,u_image0:0,u_frustum_tl:P,u_frustum_tr:F,u_frustum_br:U,u_frustum_bl:H,u_globe_pos:X,u_globe_radius:K,u_viewport:ee,u_grid_matrix:ce?Float32Array.from(ce):new Float32Array(9),u_skirt_height:ie,u_far_z_cutoff:ae});function Qm(x,u){return null!=x&&null!=u&&!(!x.hasData()||!u.hasData())&&null!=x.demTexture&&null!=u.demTexture&&x.tileID.key!==u.tileID.key}const Hl=new class{constructor(){this.operations={}}newMorphing(x,u,g,w,S){if(x in this.operations){const D=this.operations[x];D.to.tileID.key!==g.tileID.key&&(D.queued=g)}else this.operations[x]={startTime:w,phase:0,duration:S,from:u,to:g,queued:null}}getMorphValuesForProxy(x){if(!(x in this.operations))return null;const u=this.operations[x];return{from:u.from,to:u.to,phase:u.phase}}update(x){for(const u in this.operations){const g=this.operations[u];for(g.phase=(x-g.startTime)/g.duration;g.phase>=1||!this._validOp(g);)if(!this._nextOp(g,x)){delete this.operations[u];break}}}_nextOp(x,u){return!!x.queued&&(x.from=x.to,x.to=x.queued,x.queued=null,x.phase=0,x.startTime=u,!0)}_validOp(x){return x.from.hasData()&&x.to.hasData()}},J_={0:null,1:"TERRAIN_VERTEX_MORPHING"};function ba(x,u,g){if(0===u)return 0;const w=u<1&&514===g?.25/u:1;return 6*Math.pow(1.5,22-x)*Math.max(u,1)*w}function Du(x,u){const g=1<<x.z;return!u&&(0===x.x||x.x===g-1)||0===x.y||x.y===g-1}const Tn=x=>({u_matrix:x});function Jm(x,u,g,w,S){if(S>0){const D=_.f.now(),P=(D-x.timeAdded)/S,F=u?(D-u.timeAdded)/S:-1,U=g.getSource(),H=w.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),X=!u||Math.abs(u.tileID.overscaledZ-H)>Math.abs(x.tileID.overscaledZ-H),K=X&&x.refreshedUponExpiration?1:_.aa(X?P:1-F,0,1);return x.refreshedUponExpiration&&P>=1&&(x.refreshedUponExpiration=!1),u?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}class Mf extends cc{constructor(u){const g={type:"raster-dem",maxzoom:u.transform.maxZoom},w=new _.bW(_.bX(),null),S=Ls("mock-dem",g,w,u.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(u,g){u.state="loaded",g(null)}}class bg extends cc{constructor(u){const g=Ls("proxy",{type:"geojson",maxzoom:u.transform.maxZoom},new _.bW(_.bX(),null),u.style);super("proxy",g,!1),g.setEventedParent(this),this.map=this.getSource().map=u,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(u,g,w){if(u.freezeTileCoverage)return;this.transform=u;const S=u.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((D,P)=>{if(D[P.key]="",!this._tiles[P.key]){const F=new Ul(P,this._source.tileSize*P.overscaleFactor(),u.tileZoom);F.state="loaded",this._tiles[P.key]=F}return D},{});for(const D in this._tiles)D in S||(this.freeFBO(D),this._tiles[D].unloadVectorData(),delete this._tiles[D])}freeFBO(u){const g=this.proxyCachedFBO[u];if(void 0!==g){const w=Object.values(g);this.renderCachePool.push(...w),delete this.proxyCachedFBO[u]}}deallocRenderCache(){this.renderCache.forEach(u=>u.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ev extends _.am{constructor(u,g,w){super(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y),this.proxyTileKey=g,this.projMatrix=w}}class kx extends _.ck{constructor(u,g){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},u.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),u.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),u.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=u,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[w,S,D]=function(){const H=new _.aN,X=new _.aw,K=131;H.reserve(17161),X.reserve(33800);const ee=_.V/128,ie=_.V+ee/2,ae=ie+ee;for(let me=-ee;me<ae;me+=ee)for(let se=-ee;se<ae;se+=ee){const be=se<0||se>ie||me<0||me>ie?24575:0,Me=_.aa(Math.round(se),0,_.V),we=_.aa(Math.round(me),0,_.V);H.emplaceBack(Me+be,we)}const ce=(me,se)=>{const be=se*K+me;X.emplaceBack(be+1,be,be+K),X.emplaceBack(be+K,be+K+1,be+1)};for(let me=1;me<129;me++)for(let se=1;se<129;se++)ce(se,me);return[0,129].forEach(me=>{for(let se=0;se<130;se++)ce(se,me),ce(me,se)}),[H,X,32768]}(),P=u.context;this.gridBuffer=P.createVertexBuffer(w,_.aP.members),this.gridIndexBuffer=P.createIndexBuffer(S),this.gridSegments=_.aB.simpleSegment(0,0,w.length,S.length),this.gridNoSkirtSegments=_.aB.simpleSegment(0,0,w.length,D),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new bg(g.map),this.orthoMatrix=_.a6.create(),_.a6.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,_.V,0,_.V,0,1);const F=P.gl;this._overlapStencilMode=new nn({func:F.GEQUAL,mask:255},0,255,F.KEEP,F.KEEP,F.REPLACE),this._previousZoom=u.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=g,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Mf(g.map),this._pendingGroundEffectLayers=[]}set style(u){u.on("data",this._onStyleDataEvent.bind(this)),this._style=u,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(u,g,w){if(u&&u.terrain){this._style!==u&&(this.style=u,this._evaluationZoom=void 0);const S=u.terrain.properties,D=0===u.terrain.drapeRenderMode,P=u.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=_.f.now();const F=u.terrain&&u.terrain.scope,U=S.get("source"),H=D?this._mockSourceCache:u.getSourceCache(U,F);if(!H)return void _.w(`Couldn't find terrain source "${U}".`);if(this.sourceCache=H,this._exaggeration=P?this.calculateExaggeration(g):S.get("exaggeration"),!g.projection.requiresDraping&&P&&0===this._exaggeration)return void this._disable();this.enabled=!0;const X=()=>{this.sourceCache.used&&_.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const K=this.getScaledDemTileSize();this.sourceCache.update(g,K,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,X(),this._initializing=!0),X(),g.updateElevation(!0,w),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(g),this._emptyDEMTextureDirty=!0,this._previousZoom=g.zoom}else this._disable()}calculateExaggeration(u){const g=this._previousCameraAltitude,w=u.getFreeCameraOptions().position.z/u.pixelsPerMeter*u.worldSize;this._previousCameraAltitude=w;const S=null!=g?w-g:Number.MAX_VALUE;if(Math.abs(S)<2)return this._exaggeration;const D=u.zoom,P=this._style.terrain;if(!this._previousUpdateTimestamp)return P.getExaggeration(D);let F=D-this._previousZoom;const U=this._previousUpdateTimestamp;let H=D;null!=this._evaluationZoom&&(H=this._evaluationZoom,Math.abs(D-H)>.5&&(F=.5*(D-H+F)),F*S<0&&(H+=F)),this._evaluationZoom=H;const X=P.getExaggeration(H),K=X===P.getExaggeration(Math.max(0,H-.1));if(K&&Math.abs(X-this._exaggeration)<.01)return X;let ee=Math.min(.1,.00375*(this._updateTimestamp-U));return(K||X<.1||Math.abs(F)<1e-4)&&(ee=Math.min(.2,4*ee)),_.U(this._exaggeration,X,ee)}resetTileLookupCache(u){this._findCoveringTileCache[u]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(u){u.coord&&"source"===u.dataType?this._clearRenderCacheForTile(u.sourceCacheId,u.coord):"style"===u.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const u in this._style._mergedSourceCaches)this._style._mergedSourceCaches[u].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(u=>u.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const u=2*this.proxySourceCache.getSource().tileSize;return[u,u]}set useVertexMorphing(u){this._useVertexMorphing=u}updateTileBinding(u){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const g=this.proxySourceCache,w=this.painter.transform;this._initializing&&(this._initializing=0===w._centerAltitude&&-1===this.getAtPointOrZero(_.L.fromLngLat(w.center),-1),this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=g.getIds().map(U=>{const H=g.getTileByID(U).tileID;return H.projMatrix=w.calculateProjMatrix(H.toUnwrapped()),H});!function(U,H){const X=H.transform.pointCoordinate(H.transform.getCameraPoint()),K=new _.P(X.x,X.y);U.sort((ee,ie)=>{if(ie.overscaledZ-ee.overscaledZ)return ie.overscaledZ-ee.overscaledZ;const ae=new _.P(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),ce=new _.P(ie.canonical.x+(1<<ie.canonical.z)*ie.wrap,ie.canonical.y),me=K.mult(1<<ee.canonical.z);return me.x-=.5,me.y-=.5,me.distSqr(ae)-me.distSqr(ce)})}(S,this.painter);const D=this.proxyToSource||{};this.proxyToSource={},S.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const P=this._style._mergedSourceCaches;for(const U in P){const H=P[U];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,u[U],D),H.usedForTerrain))continue;const X=u[U];H.getSource().reparseOverscaled&&this._assignTerrainTiles(X)}this.proxiedCoords[g.id]=S.map(U=>new ev(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(D),this.renderingToTexture=!1;const F={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const H=this.terrainTileForTile[U.key];if(!H)continue;const X=H.tileID.key;X in F||(this._visibleDemTiles.push(H),F[X]=X)}}_assignTerrainTiles(u){this._initializing||u.forEach(g=>{if(this.terrainTileForTile[g.key])return;const w=this._findTileCoveringTileID(g,this.sourceCache);w&&(this.terrainTileForTile[g.key]=w)})}_prepareDEMTextures(){const u=this.painter.context,g=u.gl;for(const w in this.terrainTileForTile){const S=this.terrainTileForTile[w],D=S.dem;!D||S.demTexture&&!S.needsDEMTextureUpload||(u.activeTexture.set(g.TEXTURE1),K_(this.painter,S,D))}}_prepareDemTileUniforms(u,g,w,S){if(!g||null==g.demTexture)return!1;const D=u.tileID.canonical,P=Math.pow(2,g.tileID.canonical.z-D.z),F=S||"";return w[`u_dem_tl${F}`]=[D.x*P%1,D.y*P%1],w[`u_dem_scale${F}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const u=this.painter.context,g=u.gl;if(!this._emptyDepthBufferTexture){const w=new _.h({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new _.T(u,w,g.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let u=0;const g=this._visibleDemTiles.reduce((w,S)=>{if(!S.dem)return w;const D=S.dem.tree.minimums[0];return D>0&&u++,w+D},0);return u?g/u:0}_updateEmptyDEMTexture(){const u=this.painter.context,g=u.gl;u.activeTexture.set(g.TEXTURE2);const w=this._getLoadedAreaMinimum(),[S,D]=(()=>{const F=new _.cm({width:1,height:1},new Float32Array([w]));return[g.R32F,F]})();this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(D,{premultiply:!1}):P=this._emptyDEMTexture=new _.T(u,D,S,{premultiply:!1}),P}setupElevationDraw(u,g,w){const S=this.painter.context,D=S.gl,P={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};P.u_exaggeration=this.exaggeration();let F=null,U=null,H=1;if(w&&w.morphing&&this._useVertexMorphing){const ee=w.morphing.srcDemTile,ie=w.morphing.dstDemTile;H=w.morphing.phase,ee&&ie&&(this._prepareDemTileUniforms(u,ee,P,"_prev")&&(U=ee),this._prepareDemTileUniforms(u,ie,P)&&(F=ie))}const X=ee=>ee&&ee.demTexture&&this.painter.linearFloatFilteringSupported()?D.LINEAR:D.NEAREST,K=ee=>{P.u_dem_size=1===ee.size[0]?1:ee.size[0]-2};if(U&&F)S.activeTexture.set(D.TEXTURE2),F.demTexture.bind(X(F),D.CLAMP_TO_EDGE),S.activeTexture.set(D.TEXTURE4),U.demTexture.bind(X(U),D.CLAMP_TO_EDGE),F.demTexture&&K(F.demTexture),P.u_dem_lerp=H;else{F=this.terrainTileForTile[u.tileID.key],S.activeTexture.set(D.TEXTURE2);const ee=this._prepareDemTileUniforms(u,F,P)?F.demTexture:this.emptyDEMTexture;ee.bind(X(F),D.CLAMP_TO_EDGE),K(ee)}if(S.activeTexture.set(D.TEXTURE3),w&&w.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),this._depthFBO&&(P.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),P.u_depth_size_inv=[1,1]),w&&w.useMeterToDem&&F){const ee=(1<<F.tileID.canonical.z)*_.bl(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=ee}if(w&&w.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=w.labelPlaneMatrixInv),g.setTerrainUniformValues(S,P),"globe"===this.painter.transform.projection.name){const ee=this.globeUniformValues(this.painter.transform,u.tileID.canonical,w&&w.useDenormalizedUpVectorScale);g.setGlobeUniformValues(S,ee)}}globeUniformValues(u,g,w){const S=u.projection;return{u_tile_tl_up:S.upVector(g,0,0),u_tile_tr_up:S.upVector(g,_.V,0),u_tile_br_up:S.upVector(g,_.V,_.V),u_tile_bl_up:S.upVector(g,0,_.V),u_tile_up_scale:w?_.cl(1):S.upVectorScale(g,u.center.lat,u.worldSize).metersToTile}}renderToBackBuffer(u){const g=this.painter,w=this.painter.context;0!==u.length&&(w.bindFramebuffer.set(null),w.viewport.set([0,0,g.width,g.height]),g.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,D,P,F,U){if("globe"===S.transform.projection.name)!function(H,X,K,ee,ie){const ae=H.context,ce=ae.gl;let me,se;const be=H.transform,Me=_.cd(H,ae,be),we=(rt,pt)=>{if(se===pt)return;const Pt=[J_[pt],"PROJECTION_GLOBE_VIEW"];Me&&Pt.push("CUSTOM_ANTIALIASING");const Ze=H.isTileAffectedByFog(rt);me=H.getOrCreateProgram("globeRaster",{defines:Pt,overrideFog:Ze}),se=pt},Se=H.colorModeForRenderPass(),pe=new Pi(ce.LEQUAL,Pi.ReadWrite,H.depthRangeFor3D);Hl.update(ie);const De=_.ce(be),Fe=[_.a5(be.center.lng),_.ae(be.center.lat)],Ne=H.globeSharedBuffers,je=[be.width*_.f.devicePixelRatio,be.height*_.f.devicePixelRatio],at=Float32Array.from(be.globeMatrix),Ke={useDenormalizedUpVectorScale:!0};{const rt=H.transform,pt=ba(rt.zoom,X.exaggeration(),X.sourceCache._source.tileSize);se=-1;const Pt=ce.TRIANGLES;for(const Ze of ee){const ht=K.getTile(Ze),ze=nn.disabled,Ye=X.prevTerrainTileForTile[Ze.key],Mt=X.terrainTileForTile[Ze.key];Qm(Ye,Mt)&&Hl.newMorphing(Ze.key,Ye,Mt,ie,250),ae.activeTexture.set(ce.TEXTURE0),ht.texture&&ht.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const ti=Hl.getMorphValuesForProxy(Ze.key),Wt=ti?1:0;ti&&_.j(Ke,{morphing:{srcDemTile:ti.from,dstDemTile:ti.to,phase:_.cc(ti.phase)}});const _i=_.cf(Ze.canonical),vi=_.cg(_i.getCenter().lat),Yi=_.ch(Ze.canonical,_i,vi,rt.worldSize/rt._pixelsPerMercatorPixel),qi=_.aT(_.ci(Ze.canonical)),Xi=Sf(rt.expandedFarZProjMatrix,at,De,qi,_.S(rt.zoom),Fe,rt.frustumCorners.TL,rt.frustumCorners.TR,rt.frustumCorners.BR,rt.frustumCorners.BL,rt.globeCenterInViewSpace,rt.globeRadius,je,pt,rt._farZ,Yi);if(we(Ze,Wt),me&&(X.setupElevationDraw(ht,me,Ke),H.uploadCommonUniforms(ae,me,Ze.toUnwrapped()),Ne)){const[Sn,bn,xn]=Ne.getGridBuffers(vi,0!==pt);me.draw(H,Pt,pe,ze,Se,rn.backCCW,Xi,"globe_raster",Sn,bn,xn)}}}if(Ne&&(H.renderDefaultNorthPole||H.renderDefaultSouthPole)){const rt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Me&&rt.push("CUSTOM_ANTIALIASING"),me=H.getOrCreateProgram("globeRaster",{defines:rt});for(const pt of ee){const{x:Pt,y:Ze,z:ht}=pt.canonical,ze=0===Ze,Ye=Ze===(1<<ht)-1,[Mt,ti,Wt,_i]=Ne.getPoleBuffers(ht,!1);if(_i&&(ze||Ye)){const vi=K.getTile(pt);ae.activeTexture.set(ce.TEXTURE0),vi.texture&&vi.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);let Yi=_.cj(ht,Pt,be);const qi=_.aT(_.ci(pt.canonical)),Xi=(Sn,bn)=>Sn.draw(H,ce.TRIANGLES,pe,nn.disabled,Se,rn.disabled,Sf(be.expandedFarZProjMatrix,Yi,Yi,qi,0,Fe,be.frustumCorners.TL,be.frustumCorners.TR,be.frustumCorners.BR,be.frustumCorners.BL,be.globeCenterInViewSpace,be.globeRadius,je,0,be._farZ),"globe_pole_raster",bn,Wt,_i);X.setupElevationDraw(vi,me,Ke),H.uploadCommonUniforms(ae,me,pt.toUnwrapped()),ze&&H.renderDefaultNorthPole&&Xi(me,Mt),Ye&&H.renderDefaultSouthPole&&(Yi=_.a6.scale(_.a6.create(),Yi,[1,-1,1]),Xi(me,ti))}}}}(S,D,P,F,U);else{const H=S.context,X=H.gl;let K,ee;const ie=S.shadowRenderer,ae=Su(S,S.longestCutoffRange),ce=Se=>{if(ee===Se)return;const pe=[];pe.push(J_[Se]),ae.shouldRenderCutoff&&pe.push("RENDER_CUTOFF"),K=S.getOrCreateProgram("terrainRaster",{defines:pe}),ee=Se},me=S.colorModeForRenderPass(),se=new Pi(X.LEQUAL,Pi.ReadWrite,S.depthRangeFor3D);Hl.update(U);const be=S.transform,Me=ba(be.zoom,D.exaggeration(),D.sourceCache._source.tileSize);let we=[0,0,0];if(ie){const Se=S.style.directionalLight,pe=S.style.ambientLight;Se&&pe&&(we=Nc(Se,pe))}{ee=-1;const Se=X.TRIANGLES,[pe,De]=[D.gridIndexBuffer,D.gridSegments];for(const Fe of F){const Ne=P.getTile(Fe),je=nn.disabled,at=D.prevTerrainTileForTile[Fe.key],Ke=D.terrainTileForTile[Fe.key];Qm(at,Ke)&&Hl.newMorphing(Fe.key,at,Ke,U,250),H.activeTexture.set(X.TEXTURE0),Ne.texture&&Ne.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const rt=Hl.getMorphValuesForProxy(Fe.key),pt=rt?1:0;let Pt;rt&&(Pt={morphing:{srcDemTile:rt.from,dstDemTile:rt.to,phase:_.cc(rt.phase)}});const Ze=Tf(Fe.projMatrix,Du(Fe.canonical,be.renderWorldCopies)?Me/10:Me,we);if(ce(pt),!K)continue;D.setupElevationDraw(Ne,K,Pt);const ht=Fe.toUnwrapped();ie&&ie.setupShadows(ht,K),S.uploadCommonUniforms(H,K,ht,null,ae),K.draw(S,Se,se,je,me,rn.backCCW,Ze,"terrain_raster",D.gridBuffer,pe,De)}}}}(g,this,this.proxySourceCache,u,this._updateTimestamp),this.renderingToTexture=!0,g.gpuTimingDeferredRenderEnd(),u.splice(0,u.length))}renderBatch(u){if(0===this._drapedRenderBatches.length)return u+1;this.renderingToTexture=!0;const g=this.painter,w=this.painter.context,S=this.proxySourceCache,D=this.proxiedCoords[S.id],P=this._drapedRenderBatches.shift(),F=g.style.order,U=[];let H=0;for(const X of D){const K=S.getTileByID(X.proxyTileKey),ee=S.proxyCachedFBO[X.key]?S.proxyCachedFBO[X.key][u]:void 0,ie=void 0!==ee?S.renderCache[ee]:this.pool[H++],ae=void 0!==ee;if(K.texture=ie.tex,ae&&!ie.dirty){U.push(K.tileID);continue}let ce;w.bindFramebuffer.set(ie.fb.framebuffer),this.renderedToTile=!1,ie.dirty&&(w.clear({color:_.ax.transparent,stencil:0}),ie.dirty=!1);for(let me=P.start;me<=P.end;++me){const se=g.style._mergedLayers[F[me]];if(se.isHidden(g.transform.zoom))continue;const be=g.style.getLayerSourceCache(se),Me=be?this.proxyToSource[X.key][be.id]:[X];if(!Me)continue;const we=Me;w.viewport.set([0,0,ie.fb.width,ie.fb.height]),ce!==(be?be.id:null)&&(this._setupStencil(ie,Me,se,be),ce=be?be.id:null),g.renderLayer(g,be,se,we)}if(0===this._drapedRenderBatches.length)for(const me of this._pendingGroundEffectLayers){const se=g.style._mergedLayers[F[me]];if(se.isHidden(g.transform.zoom))continue;const be=g.style.getLayerSourceCache(se),Me=be?this.proxyToSource[X.key][be.id]:[X];if(!Me)continue;const we=Me;w.viewport.set([0,0,ie.fb.width,ie.fb.height]),ce!==(be?be.id:null)&&(this._setupStencil(ie,Me,se,be),ce=be?be.id:null),g.renderLayer(g,be,se,we)}this.renderedToTile?(ie.dirty=!0,U.push(K.tileID)):ae||--H,5===H&&(H=0,this.renderToBackBuffer(U))}return this.renderToBackBuffer(U),this.renderingToTexture=!1,w.bindFramebuffer.set(null),w.viewport.set([0,0,g.width,g.height]),P.end+1}postRender(){}isLayerOrderingCorrect(u){const g=u.order.length;let w=-1,S=g;for(let D=0;D<g;++D)this._style.isLayerDraped(u._mergedLayers[u.order[D]])?w=Math.max(w,D):S=Math.min(S,D);return S>w}getMinElevationBelowMSL(){let u=0;return this._visibleDemTiles.filter(g=>g.dem).forEach(g=>{u=Math.min(u,g.dem.tree.minimums[0])}),0===u?u:(u-30)*this._exaggeration}raycast(u,g,w){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(D=>D.dem).map(D=>{const P=D.tileID,F=1<<P.overscaledZ,{x:U,y:H}=P.canonical,X=U/F,K=(U+1)/F,ee=H/F,ie=(H+1)/F;return{minx:X,miny:ee,maxx:K,maxy:ie,t:D.dem.tree.raycastRoot(X,ee,K,ie,u,g,w),tile:D}});S.sort((D,P)=>(null!==D.t?D.t:Number.MAX_VALUE)-(null!==P.t?P.t:Number.MAX_VALUE));for(const D of S){if(null==D.t)return null;const P=D.tile.dem.tree.raycast(D.minx,D.miny,D.maxx,D.maxy,u,g,w);if(null!=P)return P}return null}_createFBO(){const u=this.painter.context,g=u.gl,w=this.drapeBufferSize;u.activeTexture.set(g.TEXTURE0);const S=new _.T(u,{width:w[0],height:w[1],data:null},g.RGBA);S.bind(g.LINEAR,g.CLAMP_TO_EDGE);const D=u.createFramebuffer(w[0],w[1],!0,null);return D.colorAttachment.set(S.texture),D.depthAttachment=new fn(u,D.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=u.createRenderbuffer(u.gl.DEPTH_STENCIL,w[0],w[1]),this._stencilRef=0,D.depthAttachment.set(this._sharedDepthStencil),u.clear({stencil:0})):D.depthAttachment.set(this._sharedDepthStencil),u.extTextureFilterAnisotropic&&g.texParameterf(g.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax),{fb:D,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const u in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[u].hasTransition())return!0;return this._style.order.some(u=>{const g=this._style._mergedLayers[u],w=g.isHidden(this.painter.transform.zoom);return"custom"===g.type?!w&&g.shouldRedrape():!w&&g.hasTransition()})}_clearLineLayersFromRenderCache(){let u=!1;for(const w of this._style.getSources())if(w instanceof si){u=!0;break}if(!u)return;const g={};for(let w=0;w<this._style.order.length;++w){const S=this._style._mergedLayers[this._style.order[w]],D=this._style.getLayerSourceCache(S);if(D&&!g[D.id]&&!S.isHidden(this.painter.transform.zoom)&&"line"===S.type&&S.widthExpression()instanceof _.Z){g[D.id]=!0;for(const P of this.proxyCoords){const F=this.proxyToSource[P.key][D.id];if(F)for(const U of F)this._clearRenderCacheForTile(D.id,U)}}}}_clearRasterLayersFromRenderCache(){let u=!1;for(const w in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[w]._source instanceof ai){u=!0;break}if(!u)return;const g={};for(let w=0;w<this._style.order.length;++w){const S=this._style._mergedLayers[this._style.order[w]],D=this._style.getLayerSourceCache(S);if(!D||g[D.id]||S.isHidden(this.painter.transform.zoom)||"raster"!==S.type)continue;const P=S.paint.get("raster-fade-duration");for(const F of this.proxyCoords){const U=this.proxyToSource[F.key][D.id];if(U)for(const H of U){const X=Jm(D.getTile(H),D.findLoadedParent(H,0),D,this.painter.transform,P);(1!==X.opacity||0!==X.mix)&&this._clearRenderCacheForTile(D.id,H)}}}}_setupDrapedRenderBatches(){const u=this._style.order,g=u.length;if(0===g)return;const w=[];this._pendingGroundEffectLayers=[];let S,D=0,P=this._style._mergedLayers[u[D]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++D<g;)P=this._style._mergedLayers[u[D]];for(;D<g;++D){const F=this._style._mergedLayers[u[D]];F.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(F)?void 0===S&&(S=D):("fill-extrusion"===F.type&&this._pendingGroundEffectLayers.push(D),void 0!==S&&(w.push({start:S,end:D-1}),S=void 0)))}if(void 0!==S&&w.push({start:S,end:D-1}),0!==w.length){const F=w[w.length-1];this._pendingGroundEffectLayers.every(U=>U>F.end)||_.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=w}_setupRenderCache(u){const g=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,g.renderCache.length>g.renderCachePool.length){const P=Object.values(g.proxyCachedFBO);g.proxyCachedFBO={};for(let F=0;F<P.length;++F){const U=Object.values(P[F]);g.renderCachePool.push(...U)}}return}this._clearRasterLayersFromRenderCache();const w=this.proxyCoords,S=this._tilesDirty;for(let P=w.length-1;P>=0;P--){const F=w[P];if(g.getTileByID(F.key),void 0!==g.proxyCachedFBO[F.key]){const U=u[F.key],H=this.proxyToSource[F.key];let X=0;for(const K in H){const ee=H[K],ie=U[K];if(!ie||ie.length!==ee.length||ee.some((ae,ce)=>ae!==ie[ce]||S[K]&&S[K].hasOwnProperty(ae.key))){X=-1;break}++X}for(const K in g.proxyCachedFBO[F.key])g.renderCache[g.proxyCachedFBO[F.key][K]].dirty=X<0||X!==Object.values(U).length}}const D=[...this._drapedRenderBatches];D.sort((P,F)=>F.end-F.start-(P.end-P.start));for(const P of D)for(const F of w){if(g.proxyCachedFBO[F.key])continue;let U=g.renderCachePool.pop();void 0===U&&g.renderCache.length<50&&(U=g.renderCache.length,g.renderCache.push(this._createFBO())),void 0!==U&&(g.proxyCachedFBO[F.key]={},g.proxyCachedFBO[F.key][P.start]=U,g.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(u,g,w,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const D=this.painter.context,P=D.gl;if(g.length<=1)return void(this._overlapStencilType=!1);let F;if(w.isTileClipped())F=g.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(g[0].overscaledZ>g[g.length-1].overscaledZ))return void(this._overlapStencilType=!1);F=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+F>255&&(D.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=F,this._overlapStencilMode.ref=this._stencilRef,w.isTileClipped()&&this._renderTileClippingMasks(g,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(u){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[u.key]),this._overlapStencilMode):nn.disabled}_renderTileClippingMasks(u,g){const w=this.painter,S=this.painter.context,D=S.gl;w._tileClippingMaskIDs={},S.setColorMode($n.disabled),S.setDepthMode(Pi.disabled);const P=w.getOrCreateProgram("clippingMask");for(const F of u){const U=w._tileClippingMaskIDs[F.key]=--g;P.draw(w,D.TRIANGLES,Pi.disabled,new nn({func:D.ALWAYS,mask:0},U,255,D.KEEP,D.KEEP,D.REPLACE),$n.disabled,rn.disabled,Tn(F.projMatrix),"$clipping",w.tileExtentBuffer,w.quadTriangleIndexBuffer,w.tileExtentSegments)}}pointCoordinate(u){const g=this.painter.transform;if(u.x<0||u.x>g.width||u.y<0||u.y>g.height)return null;const w=[u.x,u.y,1,1];_.a7.transformMat4(w,w,g.pixelMatrixInverse),_.a7.scale(w,w,1/w[3]),w[0]/=g.worldSize,w[1]/=g.worldSize;const S=g._camera.position,D=_.bl(1,g.center.lat),P=[S[0],S[1],S[2]/D,0],F=_.N.subtract([],w.slice(0,3),P);_.N.normalize(F,F);const U=this.raycast(P,F,this._exaggeration);return null!==U&&U?(_.N.scaleAndAdd(P,P,F,U),P[3]=P[2],P[2]*=D,P):null}drawDepth(){const u=this.painter,g=u.context,w=this.proxySourceCache,S=Math.ceil(u.width),D=Math.ceil(u.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===D||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const P=g.gl,F=g.createFramebuffer(S,D,!0,"renderbuffer");g.activeTexture.set(P.TEXTURE0);const U=new _.T(g,{width:S,height:D,data:null},P.RGBA);U.bind(P.NEAREST,P.CLAMP_TO_EDGE),F.colorAttachment.set(U.texture);const H=g.createRenderbuffer(g.gl.DEPTH_COMPONENT16,S,D);F.depthAttachment.set(H),this._depthFBO=F,this._depthTexture=U}g.bindFramebuffer.set(this._depthFBO.framebuffer),g.viewport.set([0,0,S,D]),function(P,F,U,H){if("globe"===P.transform.projection.name)return;const X=P.context,K=X.gl;X.clear({depth:1});const ee=P.getOrCreateProgram("terrainDepth"),ie=new Pi(K.LESS,Pi.ReadWrite,P.depthRangeFor3D);for(const ae of H){const ce=U.getTile(ae),me=Tf(ae.projMatrix,0,[0,0,0]);F.setupElevationDraw(ce,ee),ee.draw(P,K.TRIANGLES,ie,nn.disabled,$n.unblended,rn.backCCW,me,"terrain_depth",F.gridBuffer,F.gridIndexBuffer,F.gridNoSkirtSegments)}}(u,this,w,this.proxyCoords)}_setupProxiedCoordsForOrtho(u,g,w){if(u.getSource()instanceof _.ap)return this._setupProxiedCoordsForImageSource(u,g,w);this._findCoveringTileCache[u.id]=this._findCoveringTileCache[u.id]||{};const S=this.proxiedCoords[u.id]=[],D=this.proxyCoords;for(let U=0;U<D.length;U++){const H=D[U],X=this._findTileCoveringTileID(H,u);if(X){const K=this._createProxiedId(H,X,w[H.key]&&w[H.key][u.id]);S.push(K),this.proxyToSource[H.key][u.id]=[K]}}let P=!1;const F=new Set;for(let U=0;U<g.length;U++){const H=u.getTile(g[U]);if(!H||!H.hasData())continue;const X=this._findTileCoveringTileID(H.tileID,this.proxySourceCache);if(X&&X.tileID.canonical.z!==H.tileID.canonical.z){const K=this.proxyToSource[X.tileID.key][u.id],ee=this._createProxiedId(X.tileID,H,w[X.tileID.key]&&w[X.tileID.key][u.id]);K?K.splice(K.length-1,0,ee):this.proxyToSource[X.tileID.key][u.id]=[ee];const ie=this.proxyToSource[X.tileID.key][u.id];F.has(ie)||F.add(ie),S.push(ee),P=!0}}if(this._sourceTilesOverlap[u.id]=P,P&&this._debugParams.sortTilesHiZFirst)for(const U of F)U.sort((H,X)=>X.overscaledZ-H.overscaledZ)}_setupProxiedCoordsForImageSource(u,g,w){if(!u.getSource().loaded())return;const S=this.proxiedCoords[u.id]=[],D=this.proxyCoords,P=u.getSource(),F=P.tileID;if(!F)return;const U=new _.P(F.x,F.y)._div(1<<F.z),H=P.coordinates.map(_.L.fromLngLat).reduce((K,ee)=>(K.min.x=Math.min(K.min.x,ee.x-U.x),K.min.y=Math.min(K.min.y,ee.y-U.y),K.max.x=Math.max(K.max.x,ee.x-U.x),K.max.y=Math.max(K.max.y,ee.y-U.y),K),{min:new _.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new _.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),X=(K,ee)=>{const ie=K.wrap+K.canonical.x/(1<<K.canonical.z),ae=K.canonical.y/(1<<K.canonical.z),ce=_.V/(1<<K.canonical.z),me=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),se=ee.canonical.y/(1<<ee.canonical.z);return ie+ce<me+H.min.x||ie>me+H.max.x||ae+ce<se+H.min.y||ae>se+H.max.y};for(let K=0;K<D.length;K++){const ee=D[K];for(let ie=0;ie<g.length;ie++){const ae=u.getTile(g[ie]);if(!ae||!ae.hasData()||X(ee,ae.tileID))continue;const ce=this._createProxiedId(ee,ae,w[ee.key]&&w[ee.key][u.id]),me=this.proxyToSource[ee.key][u.id];me?me.push(ce):this.proxyToSource[ee.key][u.id]=[ce],S.push(ce)}}}_createProxiedId(u,g,w){let S=this.orthoMatrix;if(w){const D=w.find(P=>P.key===g.tileID.key);if(D)return D}if(g.tileID.key!==u.key){const D=u.canonical.z-g.tileID.canonical.z;let P,F,U;S=_.a6.create();const H=g.tileID.wrap-u.wrap<<u.overscaledZ;D>0?(P=_.V>>D,F=P*((g.tileID.canonical.x<<D)-u.canonical.x+H),U=P*((g.tileID.canonical.y<<D)-u.canonical.y)):(P=_.V<<-D,F=_.V*(g.tileID.canonical.x-(u.canonical.x+H<<-D)),U=_.V*(g.tileID.canonical.y-(u.canonical.y<<-D))),_.a6.ortho(S,0,P,0,P,0,1),_.a6.translate(S,S,[F,U,0])}return new ev(g.tileID,u.key,S)}_findTileCoveringTileID(u,g){let w=g.getTile(u);if(w&&w.hasData())return w;const S=this._findCoveringTileCache[g.id],D=S[u.key];if(w=D?g.getTileByID(D):null,w&&w.hasData()||null===D)return w;let P=w?w.tileID:u,F=P.overscaledZ;const U=g.getSource().minzoom,H=[];if(!D){const K=g.getSource().maxzoom;if(u.canonical.z>=K){const ee=u.canonical.z-K;g.getSource().reparseOverscaled?(F=Math.max(u.canonical.z+2,g.transform.tileZoom),P=new _.am(F,u.wrap,K,u.canonical.x>>ee,u.canonical.y>>ee)):0!==ee&&(F=K,P=new _.am(F,u.wrap,K,u.canonical.x>>ee,u.canonical.y>>ee))}P.key!==u.key&&(H.push(P.key),w=g.getTile(P))}const X=K=>{H.forEach(ee=>{S[ee]=K}),H.length=0};for(F-=1;F>=U&&(!w||!w.hasData());F--){w&&X(w.tileID.key);const K=P.calculateScaledKey(F);if(w=g.getTileByID(K),w&&w.hasData())break;const ee=S[K];if(null===ee)break;void 0===ee?H.push(K):w=g.getTileByID(ee)}return X(w?w.tileID.key:null),w&&w.hasData()?w:null}findDEMTileFor(u){return this.enabled?this._findTileCoveringTileID(u,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(u,g){let w=this._tilesDirty[u];w||(w=this._tilesDirty[u]={}),w[g.key]=!0}}function tv(x,u,g){const w=function(F,U,H){const X=_.N.dot(U,F),K=_.N.dot(H,[.2126,.7152,.0722]),ee=(ae,ce,me)=>(1-me)*ae+me*ce,ie=ee(1-.3*Math.min(K,1),1,Math.min(X+1,1));return ee(.92,1,Math.asin(_.aa(U[2],-1,1))/Math.PI+.5)*ie}(x,[0,0,1],u),S=[0,0,0];_.N.scale(S,g.slice(0,3),w);const D=[0,0,0];_.N.scale(D,u.slice(0,3),x[2]);const P=[0,0,0];return _.N.add(P,S,D),_.bU(P)}const bh=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Af=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Zb{static cacheKey(u,g,w,S){let D=`${g}${S?S.cacheKey:""}`;for(const P of w)u.usedDefines.includes(P)&&(D+=`/${P}`);return D}constructor(u,g,w,S,D,P,F){const U=u.gl;this.program=U.createProgram(),this.configuration=S,this.name=g,this.fixedDefines=[...P];const H=S?S.getBinderAttributes():[],X=(w.staticAttributes||[]).concat(H);let K=S?S.defines():[];K=K.concat(P.map(se=>`#define ${se}`));const ee="#version 300 es\n";let ie=ee+K.concat("precision mediump float;",Ia,_g.fragmentSource).join("\n");for(const se of w.fragmentIncludes)ie+=`\n${Cr[se]}`;ie+=`\n${w.fragmentSource}`;let ae=ee+K.concat("precision highp float;",Ia,_g.vertexSource).join("\n");for(const se of w.vertexIncludes)ae+=`\n${Cr[se]}`;ae+=`\n${w.vertexSource}`;const ce=U.createShader(U.FRAGMENT_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);U.shaderSource(ce,ie),U.compileShader(ce),U.attachShader(this.program,ce);const me=U.createShader(U.VERTEX_SHADER);if(U.isContextLost())this.failedToCreate=!0;else{U.shaderSource(me,ae),U.compileShader(me),U.attachShader(this.program,me),this.attributes={},this.numAttributes=X.length;for(let se=0;se<this.numAttributes;se++)if(X[se]){const be=X[se].startsWith("a_")?X[se]:`a_${X[se]}`;U.bindAttribLocation(this.program,se,be),this.attributes[be]=se}F&&F.shaderVaryings.length>0&&U.transformFeedbackVaryings(this.program,F.shaderVaryings,F.bufferMode),U.linkProgram(this.program),U.deleteShader(me),U.deleteShader(ce),this.fixedUniforms=D(u),this.binderUniforms=S?S.getUniforms(u):[],P.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new _.bO(se=u),u_dem_prev:new _.bO(se),u_dem_tl:new _.bL(se),u_dem_scale:new _.bN(se),u_dem_tl_prev:new _.bL(se),u_dem_scale_prev:new _.bN(se),u_dem_size:new _.bN(se),u_dem_lerp:new _.bN(se),u_exaggeration:new _.bN(se),u_depth:new _.bO(se),u_depth_size_inv:new _.bL(se),u_meter_to_dem:new _.bN(se),u_label_plane_matrix_inv:new _.bK(se)}),P.includes("GLOBE")&&(this.globeUniforms=(se=>({u_tile_tl_up:new _.bM(se),u_tile_tr_up:new _.bM(se),u_tile_br_up:new _.bM(se),u_tile_bl_up:new _.bM(se),u_tile_up_scale:new _.bN(se)}))(u)),P.includes("FOG")&&(this.fogUniforms=(se=>({u_fog_matrix:new _.bK(se),u_fog_range:new _.bL(se),u_fog_color:new _.bP(se),u_fog_horizon_blend:new _.bN(se),u_fog_vertical_limit:new _.bL(se),u_fog_temporal_offset:new _.bN(se),u_frustum_tl:new _.bM(se),u_frustum_tr:new _.bM(se),u_frustum_br:new _.bM(se),u_frustum_bl:new _.bM(se),u_globe_pos:new _.bM(se),u_globe_radius:new _.bN(se),u_globe_transition:new _.bN(se),u_is_globe:new _.bO(se),u_viewport:new _.bL(se)}))(u)),P.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(se=>({u_cutoff_params:new _.bP(se)}))(u)),P.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(se=>({u_lighting_ambient_color:new _.bM(se),u_lighting_directional_dir:new _.bM(se),u_lighting_directional_color:new _.bM(se),u_ground_radiance:new _.bM(se)}))(u)),P.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(se=>({u_light_matrix_0:new _.bK(se),u_light_matrix_1:new _.bK(se),u_fade_range:new _.bL(se),u_shadow_normal_offset:new _.bM(se),u_shadow_intensity:new _.bN(se),u_shadow_texel_size:new _.bN(se),u_shadow_map_resolution:new _.bN(se),u_shadow_direction:new _.bM(se),u_shadow_bias:new _.bM(se),u_shadowmap_0:new _.bO(se),u_shadowmap_1:new _.bO(se)}))(u))}var se}setTerrainUniformValues(u,g){if(!this.terrainUniforms)return;const w=this.terrainUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in g)w[S]&&w[S].set(this.program,S,g[S])}}setGlobeUniformValues(u,g){if(!this.globeUniforms)return;const w=this.globeUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in g)w[S]&&w[S].set(this.program,S,g[S])}}setFogUniformValues(u,g){if(!this.fogUniforms)return;const w=this.fogUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in g)w[S].set(this.program,S,g[S])}}setCutoffUniformValues(u,g){if(!this.cutoffUniforms)return;const w=this.cutoffUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in g)w[S].set(this.program,S,g[S])}}setLightsUniformValues(u,g){if(!this.lightsUniforms)return;const w=this.lightsUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in g)w[S].set(this.program,S,g[S])}}setShadowUniformValues(u,g){if(this.failedToCreate||!this.shadowUniforms)return;const w=this.shadowUniforms;u.program.set(this.program);for(const S in g)w[S].set(this.program,S,g[S])}_drawDebugWireframe(u,g,w,S,D,P,F,U,H,X){const K=u.options.wireframe;if(!1===K.terrain&&!1===K.layers2D&&!1===K.layers3D)return;const ee=u.context;if(!(K.terrain&&("terrainRaster"===this.name||"globeRaster"===this.name)||!(!K.layers2D||u._terrain&&u._terrain.renderingToTexture)&&bh.includes(this.name)||K.layers3D&&Af.includes(this.name)))return;const ie=ee.gl,ae=u.wireframeDebugCache.getLinesFromTrianglesBuffer(u.frameCounter,D,ee);if(!ae)return;const ce=[...this.fixedDefines];ce.push("DEBUG_WIREFRAME");const me=u.getOrCreateProgram(this.name,{config:this.configuration,defines:ce});ee.program.set(me.program);const se=(we,Se,pe)=>{if(Se[we]&&pe[we])for(const De in Se[we])pe[we][De]&&pe[we][De].set(pe.program,De,Se[we][De].current)};H&&H.setUniforms(me.program,ee,me.binderUniforms,F,{zoom:U}),se("fixedUniforms",this,me),se("terrainUniforms",this,me),se("globeUniforms",this,me),se("fogUniforms",this,me),se("lightsUniforms",this,me),se("shadowUniforms",this,me),ae.bind(),ee.setColorMode(new $n([ie.ONE,ie.ONE_MINUS_SRC_ALPHA,ie.ZERO,ie.ONE],_.ax.transparent,[!0,!0,!0,!1])),ee.setDepthMode(new Pi(g.func===ie.LESS?ie.LEQUAL:g.func,Pi.ReadOnly,g.range)),ee.setStencilMode(nn.disabled);const be=3*P.primitiveLength*2,Me=3*P.primitiveOffset*2*2;X&&X>1?ie.drawElementsInstanced(ie.LINES,be,ie.UNSIGNED_SHORT,Me,X):ie.drawElements(ie.LINES,be,ie.UNSIGNED_SHORT,Me),D.bind(),ee.program.set(this.program),ee.setDepthMode(g),ee.setStencilMode(w),ee.setColorMode(S)}draw(u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce,me,se){const be=u.context,Me=be.gl;if(this.failedToCreate)return;be.program.set(this.program),be.setDepthMode(w),be.setStencilMode(S),be.setColorMode(D),be.setCullFace(P);for(const De of Object.keys(this.fixedUniforms))this.fixedUniforms[De].set(this.program,De,F[De]);ae&&ae.setUniforms(this.program,be,this.binderUniforms,ee,{zoom:ie});const we={[Me.POINTS]:1,[Me.LINES]:2,[Me.TRIANGLES]:3,[Me.LINE_STRIP]:1}[g],Se=se&&se.length>0;if(Se){for(const De of se)Me.bindBufferBase(Me.TRANSFORM_FEEDBACK_BUFFER,De.targetIndex,De.buffer.buffer);Me.beginTransformFeedback(g)}const pe=me&&me>0?1:void 0;for(const De of K.get()){const Fe=De.vaos||(De.vaos={});(Fe[U]||(Fe[U]=new Ef)).bind(be,this,H,ae?ae.getPaintVertexBuffers():[],X,De.vertexOffset,ce||[],pe),me&&me>1?Me.drawElementsInstanced(g,De.primitiveLength*we,Me.UNSIGNED_SHORT,De.primitiveOffset*we*2,me):X?Me.drawElements(g,De.primitiveLength*we,Me.UNSIGNED_SHORT,De.primitiveOffset*we*2):Me.drawArrays(g,De.vertexOffset,De.vertexLength),g===Me.TRIANGLES&&X&&this._drawDebugWireframe(u,w,S,D,X,De,ee,ie,ae,me)}Se&&Me.endTransformFeedback()}}function Df(x,u){const g=Math.pow(2,u.tileID.overscaledZ),w=u.tileSize*Math.pow(2,x.transform.tileZoom)/g,S=w*(u.tileID.canonical.x+u.tileID.wrap*g),D=w*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture?u.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/_.a3(u,1,x.transform.tileZoom),u_pixel_coord_upper:[S>>16,D>>16],u_pixel_coord_lower:[65535&S,65535&D]}}const Kb=_.a6.create(),ku=(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce)=>{const me=u.style.light,se=me.properties.get("position"),be=[se.x,se.y,se.z],Me=_.co.create();"viewport"===me.properties.get("anchor")&&(_.co.fromRotation(Me,-u.transform.angle),_.N.transformMat3(be,be,Me));const we=me.properties.get("color"),Se=u.transform,pe={u_matrix:x,u_lightpos:be,u_lightintensity:me.properties.get("intensity"),u_lightcolor:[we.r,we.g,we.b],u_vertical_gradient:+g,u_opacity:w,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Kb,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:D,u_flood_light_color:K,u_vertical_scale:ee,u_flood_light_intensity:ie,u_ground_shadow_factor:ae,u_emissive_strength:ce};return"globe"===Se.projection.name&&(pe.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],pe.u_zoom_transition=U,pe.u_inv_rot_matrix=X,pe.u_merc_center=H,pe.u_up_dir=Se.projection.upVector(new _.bs(0,0,0),H[0]*_.V,H[1]*_.V),pe.u_height_lift=F),pe},Qb=(x,u,g)=>({u_matrix:x,u_edge_radius:u,u_vertical_scale:g}),ia=(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie)=>{const ae=ku(x,u,g,w,S,D,P,U,H,X,K,ee,ie,1,[0,0,0],0),ce={u_height_factor:-Math.pow(2,P.overscaledZ)/F.tileSize/8};return _.e(ae,Df(u,F),ce)},Bc=(x,u)=>({u_matrix:x,u_emissive_strength:u}),yg=(x,u,g,w)=>_.e(Bc(x,u),Df(g,w)),Zd=(x,u,g)=>({u_matrix:x,u_world:g,u_emissive_strength:u}),xg=(x,u,g,w,S)=>_.e(yg(x,u,g,w),{u_world:S}),kf=(x,u,g,w)=>{const S=_.V/g.tileSize;return{u_matrix:x,u_camera_to_center_distance:u.getCameraToCenterDistance(w),u_extrude_scale:[u.pixelsToGLUnits[0]/S,u.pixelsToGLUnits[1]/S]}},Jb=(x,u,g=1)=>({u_matrix:x,u_color:u,u_overlay:0,u_overlay_scale:g}),iv=_.a6.create(),Ix=(x,u,g,w,S,D,P)=>{const F=x.transform,U="globe"===F.projection.name,H=U?_.cp(F.zoom,u.canonical)*F._pixelsPerMercatorPixel:_.a3(g,1,D),X={u_matrix:u.projMatrix,u_extrude_scale:H,u_intensity:P,u_inv_rot_matrix:iv,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){X.u_inv_rot_matrix=w,X.u_merc_center=S,X.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],X.u_zoom_transition=_.S(F.zoom);const K=S[0]*_.V,ee=S[1]*_.V;X.u_up_dir=F.projection.upVector(new _.bs(0,0,0),K,ee)}return X};function el(x,[u,g,w,S],[D,P]){if(D===P)return[0,0,0,0];const F=255*(x-1)/(x*(P-D));return[u*F,g*F,w*F,S*F]}function wg(x,u,[g,w]){return g===w?0:.5/x+(u-g)*(x-1)/(x*(w-g))}const Iu=(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce,me,se,be,Me,we)=>{return{u_matrix:x,u_normalize_matrix:u,u_globe_matrix:g,u_merc_matrix:w,u_grid_matrix:S,u_tl_parent:D,u_scale_parent:H,u_fade_t:X.mix,u_opacity:X.opacity*K.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:K.paint.get("raster-brightness-min"),u_brightness_high:K.paint.get("raster-brightness-max"),u_saturation_factor:(pe=K.paint.get("raster-saturation"),pe>0?1-1/(1.001-pe):-pe),u_contrast_factor:(Se=K.paint.get("raster-contrast"),Se>0?1/(1-Se):1+Se),u_spin_weights:Cg(K.paint.get("raster-hue-rotate")),u_perspective_transform:ee,u_raster_elevation:ie,u_zoom_transition:P,u_merc_center:F,u_cutoff_params:U,u_colorization_mix:el(_.cq,ce,se),u_colorization_offset:wg(_.cq,me,se),u_color_ramp:ae,u_texture_offset:[Me/(be+2*Me),be/(be+2*Me)],u_texture_res:[be+2*Me,be+2*Me],u_emissive_strength:we};var Se,pe};function Cg(x){x*=Math.PI/180;const u=Math.sin(x),g=Math.cos(x);return[(2*g+1)/3,(-Math.sqrt(3)*u-g+1)/3,(Math.sqrt(3)*u-g+1)/3]}const Rx=(x,u,g,w,S,D,P,F,U,H,X,K)=>({u_matrix:x,u_normalize_matrix:u,u_globe_matrix:g,u_merc_matrix:w,u_grid_matrix:S,u_tl_parent:D,u_scale_parent:H,u_fade_t:X.mix,u_opacity:X.opacity,u_image0:0,u_image1:1,u_raster_elevation:K,u_zoom_transition:P,u_merc_center:F,u_cutoff_params:U}),Kd=(x,u,g,w,S,D,P,F)=>({u_tile_offset:x,u_velocity:u,u_color_ramp:w,u_velocity_res:g,u_max_speed:S,u_texture_offset:D,u_data_scale:P,u_data_offset:F}),yo=(x,u,g,w,S,D,P,F)=>({u_velocity:x,u_velocity_res:u,u_max_speed:g,u_speed_factor:w,u_lifetime_delta:S,u_rand_seed:Math.random(),u_texture_offset:D,u_data_scale:P,u_data_offset:F}),Vc=_.a6.create(),ep=(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce,me,se)=>{const be=S.transform,Me={u_is_size_zoom_constant:+("constant"===x||"source"===x),u_is_size_feature_constant:+("constant"===x||"camera"===x),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:be.getCameraToCenterDistance(ce),u_rotate_symbol:+g,u_aspect_ratio:be.width/be.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:P,u_coord_matrix:F,u_is_text:+U,u_pitch_with_map:+w,u_texsize:H,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Vc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Vc,u_up_vector:[0,-1,0],u_icon_transition:se||0,u_icon_saturation:me};return"globe"===ce.name&&(Me.u_tile_id=[X.canonical.x,X.canonical.y,1<<X.canonical.z],Me.u_zoom_transition=K,Me.u_inv_rot_matrix=ie,Me.u_merc_center=ee,Me.u_camera_forward=be._camera.forward(),Me.u_ecef_origin=_.cr(be.globeMatrix,X.toUnwrapped()),Me.u_tile_matrix=Float32Array.from(be.globeMatrix),Me.u_up_vector=ae),Me},If=(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce,me)=>_.e(ep(x,u,g,w,S,D,P,F,U,H,K,ee,ie,ae,ce,me,1),{u_gamma_scale:w?S.transform.getCameraToCenterDistance(me)*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:_.f.devicePixelRatio,u_is_halo:+X,undefined:void 0}),Ru=(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce)=>_.e(If(x,u,g,w,S,D,P,F,!0,U,!0,X,K,ee,ie,ae,ce),{u_texsize_icon:H,u_texture_icon:1}),Rf=(x,u,g,w)=>({u_matrix:x,u_emissive_strength:u,u_opacity:g,u_color:w}),ao=(x,u,g,w,S,D,P)=>_.e(function(F,U,H,X){const K=H.imageManager.getPattern(F.toString(),U),{width:ee,height:ie}=H.imageManager.getPixelSize(U),ae=Math.pow(2,X.tileID.overscaledZ),ce=X.tileSize*Math.pow(2,H.transform.tileZoom)/ae,me=ce*(X.tileID.canonical.x+X.tileID.wrap*ae),se=ce*X.tileID.canonical.y;return{u_image:0,u_pattern_tl:K.tl,u_pattern_br:K.br,u_texsize:[ee,ie],u_pattern_size:K.displaySize,u_tile_units_to_pixels:1/_.a3(X,1,H.transform.tileZoom),u_pixel_coord_upper:[me>>16,se>>16],u_pixel_coord_lower:[65535&me,65535&se]}}(S,D,w,P),{u_matrix:x,u_emissive_strength:u,u_opacity:g}),Pu=(x,u,g,w,S,D,P,F,U,H,X,K,ee=[0,0,0],ie)=>{const ae=w.style.light,ce=ae.properties.get("position"),me=[-ce.x,-ce.y,ce.z],se=_.co.create();"viewport"===ae.properties.get("anchor")&&(_.co.fromRotation(se,-w.transform.angle),_.N.transformMat3(me,me,se));const be="MASK"===H.alphaMode,Me=ae.properties.get("color"),we=K.paint.get("model-ambient-occlusion-intensity"),Se=K.paint.get("model-color").constantOr(_.ax.white),pe=K.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:x,u_lighting_matrix:u,u_normal_matrix:g,u_lightpos:me,u_lightintensity:ae.properties.get("intensity"),u_lightcolor:[Me.r,Me.g,Me.b],u_camera_pos:ee,u_opacity:S,u_baseTextureIsAlpha:0,u_alphaMask:+be,u_alphaCutoff:H.alphaCutoff,u_baseColorFactor:[D.r,D.g,D.b,D.a],u_emissiveFactor:[P[0],P[1],P[2],1],u_metallicFactor:F,u_roughnessFactor:U,u_baseColorTexture:qs.BaseColor,u_metallicRoughnessTexture:qs.MetallicRoughness,u_normalTexture:qs.Normal,u_occlusionTexture:qs.Occlusion,u_emissionTexture:qs.Emission,u_color_mix:[Se.r,Se.g,Se.b,pe],u_aoIntensity:we,u_emissive_strength:X,u_occlusionTextureTransform:ie||[0,0,0,0]}},Eg=new Float32Array(16),Pf=(x,u=Eg,g=Eg)=>({u_matrix:x,u_instance:u,u_node_matrix:g}),Px={fillExtrusion:x=>({u_matrix:new _.bK(x),u_lightpos:new _.bM(x),u_lightintensity:new _.bN(x),u_lightcolor:new _.bM(x),u_vertical_gradient:new _.bN(x),u_opacity:new _.bN(x),u_edge_radius:new _.bN(x),u_ao:new _.bL(x),u_tile_id:new _.bM(x),u_zoom_transition:new _.bN(x),u_inv_rot_matrix:new _.bK(x),u_merc_center:new _.bL(x),u_up_dir:new _.bM(x),u_height_lift:new _.bN(x),u_flood_light_color:new _.bM(x),u_vertical_scale:new _.bN(x),u_flood_light_intensity:new _.bN(x),u_ground_shadow_factor:new _.bM(x),u_emissive_strength:new _.bN(x)}),fillExtrusionDepth:x=>({u_matrix:new _.bK(x),u_edge_radius:new _.bN(x),u_vertical_scale:new _.bN(x)}),fillExtrusionPattern:x=>({u_matrix:new _.bK(x),u_lightpos:new _.bM(x),u_lightintensity:new _.bN(x),u_lightcolor:new _.bM(x),u_vertical_gradient:new _.bN(x),u_height_factor:new _.bN(x),u_edge_radius:new _.bN(x),u_ao:new _.bL(x),u_tile_id:new _.bM(x),u_zoom_transition:new _.bN(x),u_inv_rot_matrix:new _.bK(x),u_merc_center:new _.bL(x),u_up_dir:new _.bM(x),u_height_lift:new _.bN(x),u_image:new _.bO(x),u_texsize:new _.bL(x),u_pixel_coord_upper:new _.bL(x),u_pixel_coord_lower:new _.bL(x),u_tile_units_to_pixels:new _.bN(x),u_opacity:new _.bN(x)}),fillExtrusionGroundEffect:x=>({u_matrix:new _.bK(x),u_opacity:new _.bN(x),u_ao_pass:new _.bN(x),u_meter_to_tile:new _.bN(x),u_ao:new _.bL(x),u_flood_light_intensity:new _.bN(x),u_flood_light_color:new _.bM(x),u_attenuation:new _.bN(x),u_edge_radius:new _.bN(x),u_fb:new _.bO(x),u_fb_size:new _.bN(x)}),fill:x=>({u_matrix:new _.bK(x),u_emissive_strength:new _.bN(x)}),fillPattern:x=>({u_matrix:new _.bK(x),u_emissive_strength:new _.bN(x),u_image:new _.bO(x),u_texsize:new _.bL(x),u_pixel_coord_upper:new _.bL(x),u_pixel_coord_lower:new _.bL(x),u_tile_units_to_pixels:new _.bN(x)}),fillOutline:x=>({u_matrix:new _.bK(x),u_emissive_strength:new _.bN(x),u_world:new _.bL(x)}),fillOutlinePattern:x=>({u_matrix:new _.bK(x),u_emissive_strength:new _.bN(x),u_world:new _.bL(x),u_image:new _.bO(x),u_texsize:new _.bL(x),u_pixel_coord_upper:new _.bL(x),u_pixel_coord_lower:new _.bL(x),u_tile_units_to_pixels:new _.bN(x)}),circle:_.cs,collisionBox:x=>({u_matrix:new _.bK(x),u_camera_to_center_distance:new _.bN(x),u_extrude_scale:new _.bL(x)}),collisionCircle:x=>({u_matrix:new _.bK(x),u_inv_matrix:new _.bK(x),u_camera_to_center_distance:new _.bN(x),u_viewport_size:new _.bL(x)}),debug:x=>({u_color:new _.ca(x),u_matrix:new _.bK(x),u_overlay:new _.bO(x),u_overlay_scale:new _.bN(x)}),clippingMask:x=>({u_matrix:new _.bK(x)}),heatmap:x=>({u_extrude_scale:new _.bN(x),u_intensity:new _.bN(x),u_matrix:new _.bK(x),u_inv_rot_matrix:new _.bK(x),u_merc_center:new _.bL(x),u_tile_id:new _.bM(x),u_zoom_transition:new _.bN(x),u_up_dir:new _.bM(x)}),heatmapTexture:x=>({u_image:new _.bO(x),u_color_ramp:new _.bO(x),u_opacity:new _.bN(x)}),hillshade:x=>({u_matrix:new _.bK(x),u_image:new _.bO(x),u_latrange:new _.bL(x),u_light:new _.bL(x),u_shadow:new _.ca(x),u_highlight:new _.ca(x),u_emissive_strength:new _.bN(x),u_accent:new _.ca(x)}),hillshadePrepare:x=>({u_matrix:new _.bK(x),u_image:new _.bO(x),u_dimension:new _.bL(x),u_zoom:new _.bN(x)}),line:_.ct,linePattern:_.cu,raster:x=>({u_matrix:new _.bK(x),u_normalize_matrix:new _.bK(x),u_globe_matrix:new _.bK(x),u_merc_matrix:new _.bK(x),u_grid_matrix:new _.cb(x),u_tl_parent:new _.bL(x),u_scale_parent:new _.bN(x),u_fade_t:new _.bN(x),u_opacity:new _.bN(x),u_image0:new _.bO(x),u_image1:new _.bO(x),u_brightness_low:new _.bN(x),u_brightness_high:new _.bN(x),u_saturation_factor:new _.bN(x),u_contrast_factor:new _.bN(x),u_spin_weights:new _.bM(x),u_perspective_transform:new _.bL(x),u_raster_elevation:new _.bN(x),u_zoom_transition:new _.bN(x),u_merc_center:new _.bL(x),u_cutoff_params:new _.bP(x),u_colorization_mix:new _.bP(x),u_colorization_offset:new _.bN(x),u_color_ramp:new _.bO(x),u_texture_offset:new _.bL(x),u_texture_res:new _.bL(x),u_emissive_strength:new _.bN(x)}),rasterParticle:x=>({u_matrix:new _.bK(x),u_normalize_matrix:new _.bK(x),u_globe_matrix:new _.bK(x),u_merc_matrix:new _.bK(x),u_grid_matrix:new _.cb(x),u_tl_parent:new _.bL(x),u_scale_parent:new _.bN(x),u_fade_t:new _.bN(x),u_opacity:new _.bN(x),u_image0:new _.bO(x),u_image1:new _.bO(x),u_raster_elevation:new _.bN(x),u_zoom_transition:new _.bN(x),u_merc_center:new _.bL(x),u_cutoff_params:new _.bP(x)}),rasterParticleTexture:x=>({u_texture:new _.bO(x),u_opacity:new _.bN(x)}),rasterParticleDraw:x=>({u_tile_offset:new _.bL(x),u_velocity:new _.bO(x),u_color_ramp:new _.bO(x),u_velocity_res:new _.bL(x),u_max_speed:new _.bN(x),u_texture_offset:new _.bL(x),u_data_scale:new _.bP(x),u_data_offset:new _.bN(x)}),rasterParticleUpdate:x=>({u_velocity:new _.bO(x),u_velocity_res:new _.bL(x),u_max_speed:new _.bN(x),u_speed_factor:new _.bN(x),u_lifetime_delta:new _.bN(x),u_rand_seed:new _.bN(x),u_texture_offset:new _.bL(x),u_data_scale:new _.bP(x),u_data_offset:new _.bN(x)}),symbolIcon:x=>({u_is_size_zoom_constant:new _.bO(x),u_is_size_feature_constant:new _.bO(x),u_size_t:new _.bN(x),u_size:new _.bN(x),u_camera_to_center_distance:new _.bN(x),u_rotate_symbol:new _.bO(x),u_aspect_ratio:new _.bN(x),u_fade_change:new _.bN(x),u_matrix:new _.bK(x),u_label_plane_matrix:new _.bK(x),u_coord_matrix:new _.bK(x),u_is_text:new _.bO(x),u_pitch_with_map:new _.bO(x),u_texsize:new _.bL(x),u_tile_id:new _.bM(x),u_zoom_transition:new _.bN(x),u_inv_rot_matrix:new _.bK(x),u_merc_center:new _.bL(x),u_camera_forward:new _.bM(x),u_tile_matrix:new _.bK(x),u_up_vector:new _.bM(x),u_ecef_origin:new _.bM(x),u_texture:new _.bO(x),u_icon_transition:new _.bN(x),u_icon_saturation:new _.bN(x)}),symbolSDF:x=>({u_is_size_zoom_constant:new _.bO(x),u_is_size_feature_constant:new _.bO(x),u_size_t:new _.bN(x),u_size:new _.bN(x),u_camera_to_center_distance:new _.bN(x),u_rotate_symbol:new _.bO(x),u_aspect_ratio:new _.bN(x),u_fade_change:new _.bN(x),u_matrix:new _.bK(x),u_label_plane_matrix:new _.bK(x),u_coord_matrix:new _.bK(x),u_is_text:new _.bO(x),u_pitch_with_map:new _.bO(x),u_texsize:new _.bL(x),u_texture:new _.bO(x),u_gamma_scale:new _.bN(x),u_device_pixel_ratio:new _.bN(x),u_tile_id:new _.bM(x),u_zoom_transition:new _.bN(x),u_inv_rot_matrix:new _.bK(x),u_merc_center:new _.bL(x),u_camera_forward:new _.bM(x),u_tile_matrix:new _.bK(x),u_up_vector:new _.bM(x),u_ecef_origin:new _.bM(x),u_is_halo:new _.bO(x)}),symbolTextAndIcon:x=>({u_is_size_zoom_constant:new _.bO(x),u_is_size_feature_constant:new _.bO(x),u_size_t:new _.bN(x),u_size:new _.bN(x),u_camera_to_center_distance:new _.bN(x),u_rotate_symbol:new _.bO(x),u_aspect_ratio:new _.bN(x),u_fade_change:new _.bN(x),u_matrix:new _.bK(x),u_label_plane_matrix:new _.bK(x),u_coord_matrix:new _.bK(x),u_is_text:new _.bO(x),u_pitch_with_map:new _.bO(x),u_texsize:new _.bL(x),u_texsize_icon:new _.bL(x),u_texture:new _.bO(x),u_texture_icon:new _.bO(x),u_gamma_scale:new _.bN(x),u_device_pixel_ratio:new _.bN(x),u_is_halo:new _.bO(x)}),background:x=>({u_matrix:new _.bK(x),u_emissive_strength:new _.bN(x),u_opacity:new _.bN(x),u_color:new _.ca(x)}),backgroundPattern:x=>({u_matrix:new _.bK(x),u_emissive_strength:new _.bN(x),u_opacity:new _.bN(x),u_image:new _.bO(x),u_pattern_tl:new _.bL(x),u_pattern_br:new _.bL(x),u_texsize:new _.bL(x),u_pattern_size:new _.bL(x),u_pixel_coord_upper:new _.bL(x),u_pixel_coord_lower:new _.bL(x),u_tile_units_to_pixels:new _.bN(x)}),terrainRaster:Km,terrainDepth:Km,skybox:x=>({u_matrix:new _.bK(x),u_sun_direction:new _.bM(x),u_cubemap:new _.bO(x),u_opacity:new _.bN(x),u_temporal_offset:new _.bN(x)}),skyboxGradient:x=>({u_matrix:new _.bK(x),u_color_ramp:new _.bO(x),u_center_direction:new _.bM(x),u_radius:new _.bN(x),u_opacity:new _.bN(x),u_temporal_offset:new _.bN(x)}),skyboxCapture:x=>({u_matrix_3f:new _.cb(x),u_sun_direction:new _.bM(x),u_sun_intensity:new _.bN(x),u_color_tint_r:new _.bP(x),u_color_tint_m:new _.bP(x),u_luminance:new _.bN(x)}),globeRaster:x=>({u_proj_matrix:new _.bK(x),u_globe_matrix:new _.bK(x),u_normalize_matrix:new _.bK(x),u_merc_matrix:new _.bK(x),u_zoom_transition:new _.bN(x),u_merc_center:new _.bL(x),u_image0:new _.bO(x),u_grid_matrix:new _.cb(x),u_skirt_height:new _.bN(x),u_far_z_cutoff:new _.bN(x),u_frustum_tl:new _.bM(x),u_frustum_tr:new _.bM(x),u_frustum_br:new _.bM(x),u_frustum_bl:new _.bM(x),u_globe_pos:new _.bM(x),u_globe_radius:new _.bN(x),u_viewport:new _.bL(x)}),globeAtmosphere:x=>({u_frustum_tl:new _.bM(x),u_frustum_tr:new _.bM(x),u_frustum_br:new _.bM(x),u_frustum_bl:new _.bM(x),u_horizon:new _.bN(x),u_transition:new _.bN(x),u_fadeout_range:new _.bN(x),u_color:new _.bP(x),u_high_color:new _.bP(x),u_space_color:new _.bP(x),u_temporal_offset:new _.bN(x),u_horizon_angle:new _.bN(x)}),model:x=>({u_matrix:new _.bK(x),u_lighting_matrix:new _.bK(x),u_normal_matrix:new _.bK(x),u_lightpos:new _.bM(x),u_lightintensity:new _.bN(x),u_lightcolor:new _.bM(x),u_camera_pos:new _.bM(x),u_opacity:new _.bN(x),u_baseColorFactor:new _.bP(x),u_emissiveFactor:new _.bP(x),u_metallicFactor:new _.bN(x),u_roughnessFactor:new _.bN(x),u_baseTextureIsAlpha:new _.bO(x),u_alphaMask:new _.bO(x),u_alphaCutoff:new _.bN(x),u_baseColorTexture:new _.bO(x),u_metallicRoughnessTexture:new _.bO(x),u_normalTexture:new _.bO(x),u_occlusionTexture:new _.bO(x),u_emissionTexture:new _.bO(x),u_color_mix:new _.bP(x),u_aoIntensity:new _.bN(x),u_emissive_strength:new _.bN(x),u_occlusionTextureTransform:new _.bP(x)}),modelDepth:x=>({u_matrix:new _.bK(x),u_instance:new _.bK(x),u_node_matrix:new _.bK(x)}),groundShadow:x=>({u_matrix:new _.bK(x),u_ground_shadow_factor:new _.bM(x)}),stars:x=>({u_matrix:new _.bK(x),u_up:new _.bM(x),u_right:new _.bM(x),u_intensity_multiplier:new _.bN(x)})};let zc;function El(x,u,g,w,S,D,P){const F=x.context,U=F.gl,H=x.transform,X=x.getOrCreateProgram("collisionBox"),K=[];let ee=0,ie=0;for(let we=0;we<w.length;we++){const Se=w[we],pe=u.getTile(Se),De=pe.getBucket(g);if(!De)continue;const Fe=Xs(Se,De,H);let Ne=Fe;0===S[0]&&0===S[1]||(Ne=x.translatePosMatrix(Fe,pe,S,D));const je=P?De.textCollisionBox:De.iconCollisionBox,at=De.collisionCircleArray;if(at.length>0){const Ke=_.a6.create(),rt=Ne;_.a6.mul(Ke,De.placementInvProjMatrix,H.glCoordMatrix),_.a6.mul(Ke,Ke,De.placementViewportMatrix),K.push({circleArray:at,circleOffset:ie,transform:rt,invTransform:Ke,projection:De.getProjection()}),ee+=at.length/4,ie=ee}je&&(x.terrain&&x.terrain.setupElevationDraw(pe,X),X.draw(x,U.LINES,Pi.disabled,nn.disabled,x.colorModeForRenderPass(),rn.disabled,kf(Ne,H,pe,De.getProjection()),g.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,null,H.zoom,null,[je.collisionVertexBuffer,je.collisionVertexBufferExt]))}if(!P||!K.length)return;const ae=x.getOrCreateProgram("collisionCircle"),ce=new _.cv;ce.resize(4*ee),ce._trim();let me=0;for(const we of K)for(let Se=0;Se<we.circleArray.length/4;Se++){const pe=4*Se,De=we.circleArray[pe+0],Fe=we.circleArray[pe+1],Ne=we.circleArray[pe+2],je=we.circleArray[pe+3];ce.emplace(me++,De,Fe,Ne,je,0),ce.emplace(me++,De,Fe,Ne,je,1),ce.emplace(me++,De,Fe,Ne,je,2),ce.emplace(me++,De,Fe,Ne,je,3)}(!zc||zc.length<2*ee)&&(zc=function(we){const Se=2*we,pe=new _.aw;pe.resize(Se),pe._trim();for(let De=0;De<Se;De++){const Fe=6*De;pe.uint16[Fe+0]=4*De+0,pe.uint16[Fe+1]=4*De+1,pe.uint16[Fe+2]=4*De+2,pe.uint16[Fe+3]=4*De+2,pe.uint16[Fe+4]=4*De+3,pe.uint16[Fe+5]=4*De+0}return pe}(ee));const se=F.createIndexBuffer(zc,!0),be=F.createVertexBuffer(ce,_.cw.members,!0);for(const we of K){const Se={u_matrix:we.transform,u_inv_matrix:we.invTransform,u_camera_to_center_distance:(Me=H).getCameraToCenterDistance(we.projection),u_viewport_size:[Me.width,Me.height]};ae.draw(x,U.TRIANGLES,Pi.disabled,nn.disabled,x.colorModeForRenderPass(),rn.disabled,Se,g.id,be,se,_.aB.simpleSegment(0,2*we.circleOffset,we.circleArray.length,we.circleArray.length/2),null,H.zoom)}var Me;be.destroy(),se.destroy()}const Qd=_.a6.create();function Of(x){const u=x._camera.getWorldToCamera(x.worldSize,1),g=_.a6.multiply([],u,x.globeMatrix);_.a6.invert(g,g);const w=[0,0,0],S=[0,1,0,0];return _.a7.transformMat4(S,S,g),w[0]=S[0],w[1]=S[1],w[2]=S[2],_.N.normalize(w,w),w}function Oi({width:x,height:u,anchor:g,textOffset:w,textScale:S},D){const{horizontalAlign:P,verticalAlign:F}=_.bf(g),U=-(P-.5)*x,H=-(F-.5)*u,X=_.bd(g,w);return new _.P((U/S+X[0])*D,(H/S+X[1])*D)}function nv(x,u,g,w,S,D,P,F,U,H,X){const K=x.text.placedSymbolArray,ee=x.text.dynamicLayoutVertexArray,ie=x.icon.dynamicLayoutVertexArray,ae={},ce=x.getProjection(),me=Cu(F,ce,D),se=D.elevation,be=ce.upVectorScale(F.canonical,D.center.lat,D.worldSize).metersToTile;ee.clear();for(let Me=0;Me<K.length;Me++){const we=K.get(Me),{tileAnchorX:Se,tileAnchorY:pe,numGlyphs:De}=we,Fe=we.hidden||!we.crossTileID||x.allowVerticalPlacement&&!we.placedOrientation?null:w[we.crossTileID];if(Fe){let Ne=0,je=0,at=0;if(se){const Mt=se?se.getAtTileOffset(F,Se,pe):0,[ti,Wt,_i]=ce.upVector(F.canonical,Se,pe);Ne=Mt*ti*be,je=Mt*Wt*be,at=Mt*_i*be}let[Ke,rt,pt,Pt]=En(we.projectedAnchorX+Ne,we.projectedAnchorY+je,we.projectedAnchorZ+at,g?me:P);const Ze=Wn(D.getCameraToCenterDistance(ce),Pt);let ht=S.evaluateSizeForFeature(x.textSizeData,H,we)*Ze/_.bc;g&&(ht*=x.tilePixelRatio/U);const ze=Oi(Fe,ht);g?(({x:Ke,y:rt,z:pt}=ce.projectTilePoint(Se+ze.x,pe+ze.y,F.canonical)),[Ke,rt,pt]=En(Ke+Ne,rt+je,pt+at,P)):(u&&ze._rotate(-D.angle),Ke+=ze.x,rt+=ze.y,pt=0);const Ye=x.allowVerticalPlacement&&we.placedOrientation===_.b6.vertical?Math.PI/2:0;for(let Mt=0;Mt<De;Mt++)_.b9(ee,Ke,rt,pt,Ye);X&&we.associatedIconIndex>=0&&(ae[we.associatedIconIndex]={x:Ke,y:rt,z:pt,angle:Ye})}else fo(De,ee)}if(X){ie.clear();const Me=x.icon.placedSymbolArray;for(let we=0;we<Me.length;we++){const Se=Me.get(we),{numGlyphs:pe}=Se,De=ae[we];if(Se.hidden||!De)fo(pe,ie);else{const{x:Fe,y:Ne,z:je,angle:at}=De;for(let Ke=0;Ke<pe;Ke++)_.b9(ie,Fe,Ne,je,at)}}x.icon.dynamicLayoutVertexBuffer.updateData(ie)}x.text.dynamicLayoutVertexBuffer.updateData(ee)}function rv(x,u,g,w,S,D,P={}){const F=g.paint.get("icon-translate"),U=g.paint.get("text-translate"),H=g.paint.get("icon-translate-anchor"),X=g.paint.get("text-translate-anchor"),K=g.layout.get("icon-rotation-alignment"),ee=g.layout.get("text-rotation-alignment"),ie=g.layout.get("icon-pitch-alignment"),ae=g.layout.get("text-pitch-alignment"),ce=g.layout.get("icon-keep-upright"),me=g.layout.get("text-keep-upright"),se=g.paint.get("icon-color-saturation"),be=x.context,Me=be.gl,we=x.transform,Se="map"===K,pe="map"===ee,De="map"===ie,Fe="map"===ae,Ne=void 0!==g.layout.get("symbol-sort-key").constantOr(1);let je=!1;const at=x.depthModeForSublayer(0,Pi.ReadOnly),Ke=[_.a5(we.center.lng),_.ae(we.center.lat)],rt=g.layout.get("text-variable-anchor"),pt="globe"===we.projection.name,Pt=[],Ze=[0,-1,0];for(const ht of w){const ze=u.getTile(ht),Ye=ze.getBucket(g);if(!Ye||"mercator"===Ye.projection.name&&pt||Ye.fullyClipped)continue;const Mt="globe"===Ye.projection.name,ti=Mt?_.S(we.zoom):0,Wt=Cu(ht,Ye.getProjection(),we),_i=we.calculatePixelsToTileUnitsMatrix(ze),vi=rt&&Ye.hasTextData(),Yi=Ye.hasIconTextFit()&&vi&&Ye.hasIconData(),qi=Ye.getProjection().createInversionMatrix(we,ht.canonical),Xi=()=>{const Do=Se&&"point"!==g.layout.get("symbol-placement"),ar=[],Lr=Do||Yi,vr=g.paint.get("icon-image-cross-fade").constantOr(0);x.terrainRenderModeElevated()&&De&&ar.push("PITCH_WITH_MAP_TERRAIN"),Mt&&(ar.push("PROJECTION_GLOBE_VIEW"),Lr&&ar.push("PROJECTED_POS_ON_VIEWPORT")),vr>0&&ar.push("ICON_TRANSITION"),Ye.icon.zOffsetVertexBuffer&&ar.push("Z_OFFSET"),se<1&&ar.push("SATURATION");const Sr=Ye.icon.programConfigurations.get(g.id),ko=x.getOrCreateProgram(Ye.sdfIcons?"symbolSDF":"symbolIcon",{config:Sr,defines:ar});let Yr;const Zs=ze.imageAtlasTexture?ze.imageAtlasTexture.size:[0,0],ws=Ye.iconSizeData,Dl=_.b5(ws,we.zoom),hd=De||0!==we.pitch,kl=zt(Wt,ze.tileID.canonical,De,Se,we,Ye.getProjection(),_i),Ks=Ln(Wt,ze.tileID.canonical,De,Se,we,Ye.getProjection(),_i),ks=x.translatePosMatrix(Ks,ze,F,H,!0),Ot=x.translatePosMatrix(Wt,ze,F,H),Jn=Lr?Qd:kl,nl=Se&&!De&&!Do;let vc=Ze;!pt&&!we.mercatorFromTransition||Se||(vc=Of(we));const lo=Mt?vc:Ze;Yr=Ye.sdfIcons&&!Ye.iconsInText?If(ws.kind,Dl,nl,De,x,Ot,Jn,ks,!1,Zs,!0,ht,ti,Ke,qi,lo,Ye.getProjection()):ep(ws.kind,Dl,nl,De,x,Ot,Jn,ks,!1,Zs,ht,ti,Ke,qi,lo,Ye.getProjection(),se,vr);const Xc=ze.imageAtlasTexture?ze.imageAtlasTexture:null,Wl=1!==g.layout.get("icon-size").constantOr(0)||Ye.iconsNeedLinear,$a=Ye.sdfIcons||x.options.rotating||x.options.zooming||Wl||hd?Me.LINEAR:Me.NEAREST,Xf=Ye.sdfIcons&&0!==g.paint.get("icon-halo-width").constantOr(1),Uu=x.terrain&&De&&Do?_.a6.invert(_.a6.create(),kl):Qd;if(Do&&Ye.icon){const qf=we.elevation,Yf=qf?qf.getAtTileOffsetFunc(ht,we.center.lat,we.worldSize,Ye.getProjection()):null,ju=li(Wt,ze.tileID.canonical,De,Se,we,Ye.getProjection(),_i);ys(Ye,Wt,x,!1,ju,Ks,De,ce,Yf,ht)}return{program:ko,buffers:Ye.icon,uniformValues:Yr,atlasTexture:Xc,atlasTextureIcon:null,atlasInterpolation:$a,atlasInterpolationIcon:null,isSDF:Ye.sdfIcons,hasHalo:Xf,tile:ze,labelPlaneMatrixInv:Uu}},Sn=()=>{const Do=pe&&"point"!==g.layout.get("symbol-placement"),ar=[],Lr=Do||rt||Yi;x.terrainRenderModeElevated()&&Fe&&ar.push("PITCH_WITH_MAP_TERRAIN"),Mt&&(ar.push("PROJECTION_GLOBE_VIEW"),Lr&&ar.push("PROJECTED_POS_ON_VIEWPORT")),Ye.text.zOffsetVertexBuffer&&ar.push("Z_OFFSET");const vr=Ye.text.programConfigurations.get(g.id),Sr=x.getOrCreateProgram(Ye.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:vr,defines:ar});let ko,Yr=[0,0],Zs=null;const ws=Ye.textSizeData;Ye.iconsInText&&(Yr=ze.imageAtlasTexture?ze.imageAtlasTexture.size:[0,0],Zs=ze.imageAtlasTexture?ze.imageAtlasTexture:null,ko=Fe||0!==we.pitch||x.options.rotating||x.options.zooming||"composite"===ws.kind||"camera"===ws.kind?Me.LINEAR:Me.NEAREST);const Dl=ze.glyphAtlasTexture?ze.glyphAtlasTexture.size:[0,0],hd=_.b5(ws,we.zoom),kl=zt(Wt,ze.tileID.canonical,Fe,pe,we,Ye.getProjection(),_i),Ks=Ln(Wt,ze.tileID.canonical,Fe,pe,we,Ye.getProjection(),_i),ks=x.translatePosMatrix(Ks,ze,U,X,!0),Ot=x.translatePosMatrix(Wt,ze,U,X),Jn=Lr?Qd:kl,nl=pe&&!Fe&&!Do;let vc=Ze;!pt&&!we.mercatorFromTransition||pe||(vc=Of(we));const lo=Mt?vc:Ze;let Xc;Xc=Ye.iconsInText?Ru(ws.kind,hd,nl,Fe,x,Ot,Jn,ks,Dl,Yr,ht,ti,Ke,qi,lo,Ye.getProjection()):If(ws.kind,hd,nl,Fe,x,Ot,Jn,ks,!0,Dl,!0,ht,ti,Ke,qi,lo,Ye.getProjection());const Wl=ze.glyphAtlasTexture?ze.glyphAtlasTexture:null,$a=Me.LINEAR,Xf=0!==g.paint.get("text-halo-width").constantOr(1),Uu=x.terrain&&Fe&&Do?_.a6.invert(_.a6.create(),kl):Qd;if(Do&&Ye.text){const qf=we.elevation,Yf=qf?qf.getAtTileOffsetFunc(ht,we.center.lat,we.worldSize,Ye.getProjection()):null,ju=li(Wt,ze.tileID.canonical,Fe,pe,we,Ye.getProjection(),_i);ys(Ye,Wt,x,!0,ju,Ks,Fe,me,Yf,ht)}return{program:Sr,buffers:Ye.text,uniformValues:Xc,atlasTexture:Wl,atlasTextureIcon:Zs,atlasInterpolation:$a,atlasInterpolationIcon:ko,isSDF:!0,hasHalo:Xf,tile:ze,labelPlaneMatrixInv:Uu}},bn=Ye.icon.segments.get().length,xn=Ye.text.segments.get().length,Dn=bn&&!P.onlyText?Xi():null,fr=xn&&!P.onlyIcons?Sn():null,jr=g.paint.get("icon-opacity").constantOr(1),Mi=g.paint.get("text-opacity").constantOr(1);if(Ne&&Ye.canOverlap){je=!0;const Do=jr&&!P.onlyText?Ye.icon.segments.get():[],ar=Mi&&!P.onlyIcons?Ye.text.segments.get():[];for(const Lr of Do)Pt.push({segments:new _.aB([Lr]),sortKey:Lr.sortKey,state:Dn});for(const Lr of ar)Pt.push({segments:new _.aB([Lr]),sortKey:Lr.sortKey,state:fr})}else P.onlyText||Pt.push({segments:jr?Ye.icon.segments:new _.aB([]),sortKey:0,state:Dn}),P.onlyIcons||Pt.push({segments:Mi?Ye.text.segments:new _.aB([]),sortKey:0,state:fr})}je&&Pt.sort((ht,ze)=>ht.sortKey-ze.sortKey);for(const ht of Pt){const ze=ht.state;if(ze)if(x.terrain&&x.terrain.setupElevationDraw(ze.tile,ze.program,{useDepthForOcclusion:we.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:ze.labelPlaneMatrixInv}),be.activeTexture.set(Me.TEXTURE0),ze.atlasTexture&&ze.atlasTexture.bind(ze.atlasInterpolation,Me.CLAMP_TO_EDGE,!0),ze.atlasTextureIcon&&(be.activeTexture.set(Me.TEXTURE1),ze.atlasTextureIcon&&ze.atlasTextureIcon.bind(ze.atlasInterpolationIcon,Me.CLAMP_TO_EDGE,!0)),x.uploadCommonLightUniforms(x.context,ze.program),ze.hasHalo){const Ye=ze.uniformValues;Ye.u_is_halo=1,Jd(ze.buffers,ht.segments,g,x,ze.program,at,S,D,Ye,2),Ye.u_is_halo=0}else{if(ze.isSDF){const Ye=ze.uniformValues;ze.hasHalo&&(Ye.u_is_halo=1,Jd(ze.buffers,ht.segments,g,x,ze.program,at,S,D,Ye,1)),Ye.u_is_halo=0}Jd(ze.buffers,ht.segments,g,x,ze.program,at,S,D,ze.uniformValues,1)}}}function Jd(x,u,g,w,S,D,P,F,U,H){const X=[x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer,x.iconTransitioningVertexBuffer,x.globeExtVertexBuffer,x.zOffsetVertexBuffer];S.draw(w,w.context.gl.TRIANGLES,D,P,F,rn.disabled,U,g.id,x.layoutVertexBuffer,x.indexBuffer,u,g.paint,w.transform.zoom,x.programConfigurations.get(g.id),X,H)}function Ra(x,u,g,w,S,D,P){const F=x.context.gl,U=g.paint.get("fill-pattern"),H=U&&U.constantOr(1);let X,K,ee,ie,ae;P?(K=H&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=F.LINES):(K=H?"fillPattern":"fill",X=F.TRIANGLES);for(const ce of w){const me=u.getTile(ce);if(H&&!me.patternsLoaded())continue;const se=me.getBucket(g);if(!se)continue;x.prepareDrawTile();const be=se.programConfigurations.get(g.id),Me=x.isTileAffectedByFog(ce),we=x.getOrCreateProgram(K,{config:be,overrideFog:Me});H&&(x.context.activeTexture.set(F.TEXTURE0),me.imageAtlasTexture&&me.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),be.updatePaintBuffers());const Se=U.constantOr(null);if(Se&&me.imageAtlas){const Fe=me.imageAtlas.patternPositions[Se.toString()];Fe&&be.setConstantPatternPositions(Fe)}const pe=x.translatePosMatrix(ce.projMatrix,me,g.paint.get("fill-translate"),g.paint.get("fill-translate-anchor")),De=g.paint.get("fill-emissive-strength");if(P){ie=se.indexBuffer2,ae=se.segments2;const Fe=x.terrain&&x.terrain.renderingToTexture?x.terrain.drapeBufferSize:[F.drawingBufferWidth,F.drawingBufferHeight];ee="fillOutlinePattern"===K&&H?xg(pe,De,x,me,Fe):Zd(pe,De,Fe)}else ie=se.indexBuffer,ae=se.segments,ee=H?yg(pe,De,x,me):Bc(pe,De);x.uploadCommonUniforms(x.context,we,ce.toUnwrapped()),we.draw(x,X,S,x.stencilModeForClipping(ce),D,rn.disabled,ee,g.id,se.layoutVertexBuffer,ie,ae,g.paint,x.transform.zoom,be,void 0)}}function Wi(x,u,g,w,S,D,P,F){g.resetLayerRenderingStats(x);const U=x.context,H=U.gl,X=x.transform,K=g.paint.get("fill-extrusion-pattern"),ee=K.constantOr(1),ie=g.paint.get("fill-extrusion-opacity"),ae=x.style.enable3dLights(),ce=g.paint.get(ae&&!ee?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),me=[g.paint.get("fill-extrusion-ambient-occlusion-intensity"),ce],se=g.layout.get("fill-extrusion-edge-radius"),be=se>0&&!g.paint.get("fill-extrusion-rounded-roof"),Me=be?0:se,we="globe"===X.projection.name?_.cF():0,Se="globe"===X.projection.name,pe=Se?_.S(X.zoom):0,De=[_.a5(X.center.lng),_.ae(X.center.lat)],Fe=g.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),Ne=g.paint.get("fill-extrusion-flood-light-intensity"),je=g.paint.get("fill-extrusion-vertical-scale"),at=Su(x,g.paint.get("fill-extrusion-cutoff-fade-range")),Ke=g.paint.get("fill-extrusion-emissive-strength"),rt=[];let pt;Se&&rt.push("PROJECTION_GLOBE_VIEW"),me[0]>0&&rt.push("FAUX_AO"),be&&rt.push("ZERO_ROOF_RADIUS"),F&&rt.push("HAS_CENTROID"),Ne>0&&rt.push("FLOOD_LIGHT"),at.shouldRenderCutoff&&rt.push("RENDER_CUTOFF");const Pt="shadow"===x.renderPass,Ze=x.shadowRenderer,ht=Pt&&!!Ze;x.shadowRenderer&&(x.shadowRenderer.useNormalOffset=!0);let ze=[0,0,0];if(Ze){const ti=x.style.directionalLight,Wt=x.style.ambientLight;ti&&Wt&&(ze=Nc(ti,Wt)),pt=rt.concat(["SHADOWS_SINGLE_CASCADE"])}const Ye=ht?"fillExtrusionDepth":ee?"fillExtrusionPattern":"fillExtrusion",Mt=g.getLayerRenderingStats();for(const ti of w){const Wt=u.getTile(ti),_i=Wt.getBucket(g);if(!_i||_i.projection.name!==X.projection.name)continue;let vi=!1;Ze&&(vi=0===Ze.getMaxCascadeForTile(ti.toUnwrapped()));const Yi=x.isTileAffectedByFog(ti),qi=_i.programConfigurations.get(g.id),Xi=x.getOrCreateProgram(Ye,{config:qi,defines:vi?pt:rt,overrideFog:Yi});if(x.terrain&&x.terrain.setupElevationDraw(Wt,Xi,{useMeterToDem:!0}),!_i.centroidVertexBuffer){const jr=Xi.attributes.a_centroid_pos;void 0!==jr&&H.vertexAttrib2f(jr,0,0)}!Pt&&Ze&&Ze.setupShadows(Wt.tileID.toUnwrapped(),Xi,"vector-tile",Wt.tileID.overscaledZ),ee&&(x.context.activeTexture.set(H.TEXTURE0),Wt.imageAtlasTexture&&Wt.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),qi.updatePaintBuffers());const Sn=K.constantOr(null);if(Sn&&Wt.imageAtlas){const jr=Wt.imageAtlas.patternPositions[Sn.toString()];jr&&qi.setConstantPatternPositions(jr)}const bn=g.paint.get("fill-extrusion-vertical-gradient");let xn;if(Pt&&Ze){if(Tg(Wt.tileID,_i,x))continue;const jr=Ze.calculateShadowPassMatrixFromTile(Wt.tileID.toUnwrapped());xn=Qb(jr,Me,je)}else{const jr=x.translatePosMatrix(ti.expandedProjMatrix,Wt,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),Mi=X.projection.createInversionMatrix(X,ti.canonical);xn=ee?ia(jr,x,bn,ie,me,Me,ti,Wt,we,pe,De,Mi,Fe,je):ku(jr,x,bn,ie,me,Me,ti,we,pe,De,Mi,Fe,je,Ne,ze,Ke)}x.uploadCommonUniforms(U,Xi,ti.toUnwrapped(),null,at);let Dn=_i.segments;if("mercator"===X.projection.name&&!Pt&&(Dn=_i.getVisibleSegments(Wt.tileID,x.terrain,x.transform.getFrustum(0)),!Dn.get().length))continue;if(Mt)if(Pt)for(const jr of Dn.get())Mt.numRenderedVerticesInShadowPass+=jr.primitiveLength;else for(const jr of Dn.get())Mt.numRenderedVerticesInTransparentPass+=jr.primitiveLength;const fr=[];(x.terrain||F)&&fr.push(_i.centroidVertexBuffer),Se&&fr.push(_i.layoutVertexExtBuffer),Xi.draw(x,U.gl.TRIANGLES,S,D,P,rn.backCCW,xn,g.id,_i.layoutVertexBuffer,_i.indexBuffer,Dn,g.paint,x.transform.zoom,qi,fr)}x.shadowRenderer&&(x.shadowRenderer.useNormalOffset=!1)}function Uc(x,u,g,w,S,D,P,F,U,H,X,K,ee,ie,ae,ce,me,se,be){const Me=x.context,we=Me.gl,Se=x.transform,pe=x.transform.zoom,De=[],Fe=Su(x,g.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===H?(De.push("CLEAR_SUBPASS"),be&&(De.push("CLEAR_FROM_TEXTURE"),Me.activeTexture.set(we.TEXTURE0),be.bind(we.LINEAR,we.CLAMP_TO_EDGE))):"sdf"===H&&De.push("SDF_SUBPASS"),me&&De.push("HAS_CENTROID"),Fe.shouldRenderCutoff&&De.push("RENDER_CUTOFF");const Ne=g.layout.get("fill-extrusion-edge-radius"),je=(at,Ke,rt,pt,Pt)=>{const Ze=Ke.programConfigurations.get(g.id),ht=x.isTileAffectedByFog(at),ze=x.getOrCreateProgram("fillExtrusionGroundEffect",{config:Ze,defines:De,overrideFog:ht}),Ye=((ti,Wt,_i,vi,Yi,qi,Xi,Sn,bn,xn,Dn)=>({u_matrix:Wt,u_opacity:_i,u_ao_pass:vi?1:0,u_meter_to_tile:Yi,u_ao:qi,u_flood_light_intensity:Xi,u_flood_light_color:Sn,u_attenuation:bn,u_edge_radius:xn,u_fb:0,u_fb_size:Dn}))(0,pt,X,U,Pt,[K,ee*Pt],ie,ae,ce,pe>=17?0:Ne*Pt,be?be.size[0]:0),Mt=[];me&&Mt.push(Ke.hiddenByLandmarkVertexBuffer),x.uploadCommonUniforms(Me,ze,at.toUnwrapped(),null,Fe),ze.draw(x,Me.gl.TRIANGLES,S,D,P,F,Ye,g.id,Ke.vertexBuffer,Ke.indexBuffer,rt,g.paint,pe,Ze,Mt)};for(const at of w){const Ke=u.getTile(at),rt=Ke.getBucket(g);if(!rt||rt.projection.name!==Se.projection.name||!rt.groundEffect||rt.groundEffect&&!rt.groundEffect.hasData())continue;const pt=rt.groundEffect,Pt=1/rt.tileToMeter;{const Ze=x.translatePosMatrix(at.projMatrix,Ke,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),ht=pt.getDefaultSegment();je(at,pt,ht,Ze,Pt)}if(se)for(let Ze=0;Ze<4;Ze++){const ht=_.cG[Ze](at),ze=u.getTile(ht);if(!ze)continue;const Ye=ze.getBucket(g);if(!Ye||Ye.projection.name!==Se.projection.name||!Ye.groundEffect||Ye.groundEffect&&!Ye.groundEffect.hasData())continue;const Mt=Ye.groundEffect;let ti,Wt;0===Ze?(ti=[-_.V,0,0],Wt=1):1===Ze?(ti=[_.V,0,0],Wt=0):2===Ze?(ti=[0,-_.V,0],Wt=3):(ti=[0,_.V,0],Wt=2);const _i=Mt.regionSegments[Wt];if(!_i)continue;const vi=new Float32Array(16);_.a6.translate(vi,at.projMatrix,ti),je(at,Mt,_i,x.translatePosMatrix(vi,Ke,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),Pt)}}}function tp(x,u,g,w,S,D,P){0===w.centroidVertexArray.length&&w.createCentroidsBuffer();const F=D?D.findDEMTileFor(g):null;if(!(F&&F.dem||P))return;const U=se=>new _.P(Math.ceil((se+_.cJ)*_.cK),0),H=se=>{const be=u.getSource().minzoom,Me=Se=>{const pe=u.getTileByID(Se);if(pe&&pe.hasData())return pe.getBucket(S)},we=[0,-1,1];for(const Se of we){if(se.overscaledZ+Se<be)continue;const pe=Me(se.calculateScaledKey(se.overscaledZ+Se));if(pe)return pe}},X=[0,0,0],K=(se,be)=>(X[0]=Math.min(se.min.y,be.min.y),X[1]=Math.max(se.max.y,be.max.y),X[2]=_.V-be.min.x>se.max.x?be.min.x-_.V:se.max.x,X),ee=(se,be)=>(X[0]=Math.min(se.min.x,be.min.x),X[1]=Math.max(se.max.x,be.max.x),X[2]=_.V-be.min.y>se.max.y?be.min.y-_.V:se.max.y,X),ie=[(se,be)=>K(se,be),(se,be)=>K(be,se),(se,be)=>ee(se,be),(se,be)=>ee(be,se)],ae=(se,be,Me,we,Se,pe,De)=>{if(!D)return 0;const Fe=[[pe?Me:se,pe?se:Me,0],[pe?Me:be,pe?be:Me,0]],Ne=De<0?_.V+De:De,je=[pe?Ne:(se+be)/2,pe?(se+be)/2:Ne,0];return 0===Me&&De<0||0!==Me&&De>0?D.getForTilePoints(Se,[je],!0,we):Fe.push(je),D.getForTilePoints(g,Fe,!0,F),Math.max(Fe[0][2],Fe[1][2],je[2])/D.exaggeration()};for(let se=0;se<4;se++){const be=w.borderFeatureIndices[se];if(0===be.length)continue;const Me=_.cG[se](g),we=H(Me);if(!(we&&we instanceof _.cH)||w.borderDoneWithNeighborZ[se]===we.canonical.z)continue;0===we.centroidVertexArray.length&&we.createCentroidsBuffer();const Se=D?D.findDEMTileFor(Me):null;if(!(Se&&Se.dem||P))continue;const pe=(se<2?1:5)-se,De=we.borderDoneWithNeighborZ[pe]!==w.canonical.z,Fe=we.borderFeatureIndices[pe];let Ne=0;if(w.canonical.z!==we.canonical.z){for(const je of be)w.showCentroid(w.featuresOnBorder[je]);if(De)for(const je of Fe)we.showCentroid(we.featuresOnBorder[je]);w.borderDoneWithNeighborZ[se]=we.canonical.z,we.borderDoneWithNeighborZ[pe]=w.canonical.z}for(const je of be){const at=w.featuresOnBorder[je],Ke=w.centroidData[at.centroidDataIndex],rt=at.borders[se];let pt;for(;Ne<Fe.length;){pt=we.featuresOnBorder[Fe[Ne]];const Pt=pt.borders[pe];if(Pt[1]>rt[0]+3||Pt[0]>rt[0]-3)break;we.showCentroid(pt),Ne++}if(pt&&Ne<Fe.length){const Pt=Ne;let Ze=0;for(;!(pt.borders[pe][0]>rt[1]-3)&&(Ze++,++Ne!==Fe.length);)pt=we.featuresOnBorder[Fe[Ne]];if(pt=we.featuresOnBorder[Fe[Pt]],Ze>1){const Ye=pt.borders[pe];Math.abs(rt[0]-Ye[0])<3&&Math.abs(rt[1]-Ye[1])<3&&(Ze=1,Ne=Pt+1)}else if(0===Ze){w.showCentroid(at);continue}const ht=we.centroidData[pt.centroidDataIndex];P&&1===Ze&&(((ce=Ke).flags|(me=ht).flags)&_.cI?(ce.flags|=_.cI,me.flags|=_.cI):(ce.flags&=~_.cI,me.flags&=~_.cI));const ze=at.intersectsCount()>1||pt.intersectsCount()>1;if(Ze>1)Ne=Pt,Ke.centroidXY=ht.centroidXY=new _.P(0,0);else if(Se&&Se.dem&&!ze){const Ye=ie[se](Ke,ht),Mt=se%2?_.V-1:0,ti=ae(Ye[0],Math.min(_.V-1,Ye[1]),Mt,Se,Me,se<2,Ye[2]);Ke.centroidXY=ht.centroidXY=U(ti)}else ze?Ke.centroidXY=ht.centroidXY=new _.P(0,0):(Ke.centroidXY=w.encodeBorderCentroid(at),ht.centroidXY=we.encodeBorderCentroid(pt));w.writeCentroidToBuffer(Ke),we.writeCentroidToBuffer(ht)}else w.showCentroid(at)}w.borderDoneWithNeighborZ[se]=we.canonical.z,we.borderDoneWithNeighborZ[pe]=w.canonical.z}var ce,me;(w.needsCentroidUpdate||!w.centroidVertexBuffer&&0!==w.centroidVertexArray.length)&&w.uploadCentroid(x)}const pC=[1,0,0],ey=[0,1,0],ov=[0,0,1];function Tg(x,u,g){const w=g.transform,S=g.shadowRenderer;if(!S)return!0;const D=x.toUnwrapped(),P=w.tileSize*S._cascades[g.currentShadowCascade].scale;let F=u.maxHeight;if(w.elevation){const ce=w.elevation.getMinMaxForTile(x);ce&&(F+=ce.max)}const U=[...S.shadowDirection];U[2]=-U[2];const H=S.computeSimplifiedTileShadowVolume(D,F,P,U);if(!H)return!1;const X=[pC,ey,ov,U,[U[0],0,U[2]],[0,U[1],U[2]]],K="globe"===w.projection.name,ee=w.scaleZoom(P),ie=_.bq.fromInvProjectionMatrix(w.invProjMatrix,w.worldSize,ee,!K),ae=S.getCurrentCascadeFrustum();return 0===ie.intersectsPrecise(H.vertices,H.planes,X)||0===ae.intersectsPrecise(H.vertices,H.planes,X)}function Ox(x){return[x[0]*_.cL,x[1]*_.cL,x[2]*_.cL,0]}function ty(x,u,g,w,S,D,P,F,U){const H=w.getSource(),X=g.globeSharedBuffers;if(!X)return;let K,ee,ie;if(u&&(K=w.getTile(u)),H instanceof _.ap?(ee=H.texture,ie=_.cj(0,0,g.transform)):K&&u&&(ee=K.texture,ie=_.cj(u.canonical.z,u.canonical.x,g.transform)),!ee||!ie)return;x||(ie=_.a6.scale(_.a6.create(),ie,[1,-1,1]));const ae=g.context,ce=ae.gl,me="nearest"===S.paint.get("raster-resampling")?ce.NEAREST:ce.LINEAR,se=g.colorModeForDrapableLayerRenderPass(D),be=P.defines;be.push("GLOBE_POLES");const Me=new Pi(ce.LEQUAL,Pi.ReadWrite,g.depthRangeFor3D),we=Float32Array.from(g.transform.expandedFarZProjMatrix),Se=Float32Array.from(_.aT(_.ci(new _.bs(0,0,0))));g.terrain&&g.terrain.prepareDrawTile(),ae.activeTexture.set(ce.TEXTURE0),ee.bind(me,ce.CLAMP_TO_EDGE),ae.activeTexture.set(ce.TEXTURE1),ee.bind(me,ce.CLAMP_TO_EDGE),ee.useMipmap&&ae.extTextureFilterAnisotropic&&g.transform.pitch>20&&ce.texParameterf(ce.TEXTURE_2D,ae.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ae.extTextureFilterAnisotropicMax);const[pe,De,Fe,Ne]=u?X.getPoleBuffers(u.canonical.z,!1):X.getPoleBuffers(0,!0),je=S.paint.get("raster-elevation");let at;x?(at=pe,g.renderDefaultNorthPole=0!==je):(at=De,g.renderDefaultSouthPole=0!==je);const Ke=Ox(P.mix),rt=(Pt=we,Ze=Se,ht=ie,ze=_.S(g.transform.zoom),Mt=S,Wt=je,vi=Ke,Yi=P.offset,qi=P.range,Xi=D,Iu(Pt,Ze,ht,new Float32Array(16),new Float32Array(9),[0,0],ze,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Mt,[0,0],Wt,2,vi,Yi,qi,1,0,Xi)),pt=g.getOrCreateProgram("raster",{defines:be});var Pt,Ze,ht,ze,Mt,Wt,vi,Yi,qi,Xi;g.uploadCommonUniforms(ae,pt,null),pt.draw(g,ce.TRIANGLES,Me,U,se,F,rt,S.id,at,Fe,Ne)}function iy(x){const u=x._nearZ,g=x.projection.farthestPixelDistance(x),w=g-u,S=.2*x.height,D=u+S;return[u,g,(D-S-u)/w,(D-u)/w]}function ip(x,u,g,w){if(x)return u instanceof Zt&&x instanceof od?u.getTextureDescriptor(x,g,!0):{texture:x.texture,mix:Ox(w.mix),offset:w.offset,buffer:0,tileSize:1}}function Sg(x,u,g){if(!x)return null;const w=u.getTextureDescriptor(x,g,!0);if(!w)return null;let{texture:S,mix:D,offset:P,tileSize:F,buffer:U,format:H}=w;if(!S||!H)return null;let X=!1;return"uint32"===H&&(X=!0,D[3]=0,D=el(_.cM,D,[0,g.paint.get("raster-particle-max-speed")]),P=wg(_.cM,P,[0,g.paint.get("raster-particle-max-speed")])),{texture:S,textureOffset:[U/(F+2*U),F/(F+2*U)],tileSize:F,scalarData:X,scale:D,offset:P,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[H]]}}function sv(x){const u=x._nearZ,g=x.projection.farthestPixelDistance(x),w=g-u,S=.2*x.height,D=u+S;return[u,g,(D-S-u)/w,(D-u)/w]}const tl=new _.ax(1,0,0,1),Ou=new _.ax(0,1,0,1),ny=new _.ax(0,0,1,1),av=new _.ax(1,0,1,1),no=new _.ax(0,1,1,1);function ps(x,u,g,w,S,D,P){const F=x.context,U=x.transform,H=F.gl,X="globe"===U.projection.name,K=X?["PROJECTION_GLOBE_VIEW"]:[];let ee=_.a6.clone(g.projMatrix);if(X&&_.S(U.zoom)>0){const Ke=_.aS(g.canonical,U),rt=_.cN(Ke);ee=_.a6.multiply(new Float32Array(16),U.globeMatrix,rt),_.a6.multiply(ee,U.projMatrix,ee)}const ie=_.a6.create();ie[12]+=2*S/(_.f.devicePixelRatio*U.width),ie[13]+=2*D/(_.f.devicePixelRatio*U.height),_.a6.multiply(ee,ie,ee);const ae=x.getOrCreateProgram("debug",{defines:K}),ce=u.getTileByID(g.key);x.terrain&&x.terrain.setupElevationDraw(ce,ae);const me=Pi.disabled,se=nn.disabled,be=x.colorModeForRenderPass();F.activeTexture.set(H.TEXTURE0),x.emptyTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),X?ce._makeGlobeTileDebugBuffers(x.context,U):ce._makeDebugTileBoundsBuffers(x.context,U.projection);const we=ce._tileDebugBuffer||x.debugBuffer,Se=ce._tileDebugIndexBuffer||x.debugIndexBuffer,pe=ce._tileDebugSegments||x.debugSegments;if(ae.draw(x,H.LINE_STRIP,me,se,be,rn.disabled,Jb(ee,w),"$debug",we,Se,pe,null,null,null,[ce._globeTileDebugBorderBuffer]),P){const Ke=ce.latestRawTileData,rt=Math.floor((Ke&&Ke.byteLength||0)/1024);let pt=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(pt+=` => ${g.overscaledZ}`),pt+=` ${ce.state}`,pt+=` ${rt}kb`,function(Pt,Ze){Pt.initDebugOverlayCanvas();const ht=Pt.debugOverlayCanvas,ze=Pt.context.gl,Ye=Pt.debugOverlayCanvas.getContext("2d");Ye.clearRect(0,0,ht.width,ht.height),Ye.shadowColor="white",Ye.shadowBlur=2,Ye.lineWidth=1.5,Ye.strokeStyle="white",Ye.textBaseline="top",Ye.font="bold 36px Open Sans, sans-serif",Ye.fillText(Ze,5,5),Ye.strokeText(Ze,5,5),Pt.debugOverlayTexture.update(ht),Pt.debugOverlayTexture.bind(ze.LINEAR,ze.CLAMP_TO_EDGE)}(x,pt)}const De=u.getTile(g).tileSize,Fe=512/Math.min(De,512)*(g.overscaledZ/U.zoom)*.5,Ne=ce._tileDebugTextBuffer||x.debugBuffer,je=ce._tileDebugTextIndexBuffer||x.quadTriangleIndexBuffer,at=ce._tileDebugTextSegments||x.debugSegments;ae.draw(x,H.TRIANGLES,me,se,$n.alphaBlended,rn.disabled,Jb(ee,_.ax.transparent,Fe),"$debug",Ne,je,at,null,null,null,[ce._globeTileDebugTextBuffer])}function ya(x,u,g,w){qr(x,0,u+g/2,x.transform.width,g,w)}function na(x,u,g,w){qr(x,u-g/2,0,g,x.transform.height,w)}function qr(x,u,g,w,S,D){const P=x.context,F=P.gl;F.enable(F.SCISSOR_TEST),F.scissor(u*_.f.devicePixelRatio,g*_.f.devicePixelRatio,w*_.f.devicePixelRatio,S*_.f.devicePixelRatio),P.clear({color:D}),F.disable(F.SCISSOR_TEST)}const np=_.ay([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:lv}=np;function gc(x,u,g,w){x.emplaceBack(u,g,w)}class ry{constructor(u){this.vertexArray=new _.az,this.indices=new _.aw,gc(this.vertexArray,-1,-1,1),gc(this.vertexArray,1,-1,1),gc(this.vertexArray,-1,1,1),gc(this.vertexArray,1,1,1),gc(this.vertexArray,-1,-1,-1),gc(this.vertexArray,1,-1,-1),gc(this.vertexArray,-1,1,-1),gc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=u.createVertexBuffer(this.vertexArray,lv),this.indexBuffer=u.createIndexBuffer(this.indices),this.segment=_.aB.simpleSegment(0,0,36,12)}}function yh(x,u,g,w,S,D){const P=x.context.gl,F=u.paint.get("sky-atmosphere-color"),U=u.paint.get("sky-atmosphere-halo-color"),H=u.paint.get("sky-atmosphere-sun-intensity"),X={u_matrix_3f:_.co.fromMat4(_.co.create(),w),u_sun_direction:S,u_sun_intensity:H,u_color_tint_r:[(ae=F).r,ae.g,ae.b,ae.a],u_color_tint_m:[(ce=U).r,ce.g,ce.b,ce.a],u_luminance:5e-5};var ae,ce;P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+D,u.skyboxTexture,0),g.draw(x,P.TRIANGLES,Pi.disabled,nn.disabled,$n.unblended,rn.frontCW,X,"skyboxCapture",u.skyboxGeometry.vertexBuffer,u.skyboxGeometry.indexBuffer,u.skyboxGeometry.segment)}const rp=_.ay([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Lf{constructor(u){const g=new _.cO;g.emplaceBack(-1,1,1,0,0),g.emplaceBack(1,1,1,1,0),g.emplaceBack(1,-1,1,1,1),g.emplaceBack(-1,-1,1,0,1);const w=new _.aw;w.emplaceBack(0,1,2),w.emplaceBack(2,3,0),this.vertexBuffer=u.createVertexBuffer(g,rp.members),this.indexBuffer=u.createIndexBuffer(w),this.segments=_.aB.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ff=_.ay([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ni{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Ji{constructor(u){this.colorModeAlphaBlendedWriteRGB=new $n([1,771,1,771],_.ax.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new $n([1,0,1,0],_.ax.transparent,[!1,!1,!1,!0]),this.params=new ni,this.updateNeeded=!0,u.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),u.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),u.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),u.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(u){const g=u.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Lf(g);const w=this.params.sizeRange,S=this.params.intensityRange,D=function(X){const K=_.aA(30),ee=[];for(let ie=0;ie<X;++ie){const ae=2*Math.PI*K(),ce=Math.acos(1-2*K())-.5*Math.PI;ee.push(_.N.fromValues(Math.cos(ce)*Math.cos(ae),Math.cos(ce)*Math.sin(ae),Math.sin(ce)))}return ee}(this.params.starsCount),P=_.aA(300),F=new _.cP,U=new _.aw;let H=0;for(let X=0;X<D.length;++X){const K=_.N.scale([],D[X],200),ee=Math.max(0,1+.01*w*(1*P()-.5)),ie=Math.max(0,1+.01*S*(1*P()-.5));F.emplaceBack(K[0],K[1],K[2],-1,-1,ee,ie),F.emplaceBack(K[0],K[1],K[2],1,-1,ee,ie),F.emplaceBack(K[0],K[1],K[2],1,1,ee,ie),F.emplaceBack(K[0],K[1],K[2],-1,1,ee,ie),U.emplaceBack(H+0,H+1,H+2),U.emplaceBack(H+0,H+2,H+3),H+=4}this.starsVx=g.createVertexBuffer(F,Ff.members),this.starsIdx=g.createIndexBuffer(U),this.starsSegments=_.aB.simpleSegment(0,0,F.length,U.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(u,g){const w=u.context,S=w.gl,D=u.transform,P=new Pi(S.LEQUAL,Pi.ReadOnly,[0,1]),F=_.S(D.zoom),U=g.properties.get("color").toArray01(),H=g.properties.get("high-color").toArray01(),X=g.properties.get("space-color").toArray01PremultipliedAlpha(),K=5e-4,ee=_.cQ(g.properties.get("horizon-blend"),0,1,K,.25),ie=_.cd(u,w,D)&&ee===K?D.worldSize/(2*Math.PI*1.025)-1:D.globeRadius,ae=u.frameCounter/1e3%1,ce=_.N.length(D.globeCenterInViewSpace),me=Math.sqrt(Math.pow(ce,2)-Math.pow(ie,2)),se=Math.acos(me/ce),be=Me=>{const we="globe"===D.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Me&&we.push("ALPHA_PASS");const Se=u.getOrCreateProgram("globeAtmosphere",{defines:we}),pe=((Fe,Ne,je,at,Ke,rt,pt,Pt,Ze,ht,ze,Ye)=>({u_frustum_tl:Fe,u_frustum_tr:Ne,u_frustum_br:je,u_frustum_bl:at,u_horizon:Ke,u_transition:rt,u_fadeout_range:pt,u_color:Pt,u_high_color:Ze,u_space_color:ht,u_temporal_offset:ze,u_horizon_angle:Ye}))(D.frustumCorners.TL,D.frustumCorners.TR,D.frustumCorners.BR,D.frustumCorners.BL,D.frustumCorners.horizon,F,ee,U,H,X,ae,se);u.uploadCommonUniforms(w,Se);const De=this.atmosphereBuffer;De&&Se.draw(u,S.TRIANGLES,P,nn.disabled,Me?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,rn.backCW,pe,Me?"atmosphere_glow_alpha":"atmosphere_glow",De.vertexBuffer,De.indexBuffer,De.segments)};be(!1),be(!0)}drawStars(u,g){const w=_.aa(g.properties.get("star-intensity"),0,1);if(0===w)return;const S=u.context,D=S.gl,P=u.transform,F=u.getOrCreateProgram("stars"),U=_.bi.identity([]);_.bi.rotateX(U,U,-P._pitch),_.bi.rotateZ(U,U,-P.angle),_.bi.rotateX(U,U,_.bj(P._center.lat)),_.bi.rotateY(U,U,-_.bj(P._center.lng));const H=_.a6.fromQuat(new Float32Array(16),U),X=_.a6.multiply([],P.starsProjMatrix,H),K=_.co.fromMat4([],H),ee=_.co.invert([],K),ie=[0,1,0];_.N.transformMat3(ie,ie,ee),_.N.scale(ie,ie,this.params.sizeMultiplier);const ae=[1,0,0];_.N.transformMat3(ae,ae,ee),_.N.scale(ae,ae,this.params.sizeMultiplier);const ce=(me=ie,se=ae,be=w,{u_matrix:Float32Array.from(X),u_up:me,u_right:se,u_intensity_multiplier:be});var me,se,be;u.uploadCommonUniforms(S,F),this.starsVx&&this.starsIdx&&F.draw(u,D.TRIANGLES,Pi.disabled,nn.disabled,this.colorModeAlphaBlendedWriteRGB,rn.disabled,ce,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function op(x,u){const g=[...x],w=u.cameraWorldSizeForFog/u.worldSize,S=_.a6.identity([]);return _.a6.scale(S,S,[w,w,1]),_.a6.multiply(g,S,g),_.a6.multiply(g,u.worldToFogMatrix,g),g}function $o(x,u,g,w){const S=g.material,D=w.context,{baseColorTexture:P,metallicRoughnessTexture:F}=S.pbrMetallicRoughness,{normalTexture:U,occlusionTexture:H,emissionTexture:X}=S;function K(ee,ie,ae){if(ee&&(x.push(ie),D.activeTexture.set(D.gl.TEXTURE0+ae),ee.gfxTexture)){const{minFilter:ce,magFilter:me,wrapS:se,wrapT:be}=ee.sampler;ee.gfxTexture.bindExtraParam(ce,me,se,be)}}K(P,"HAS_TEXTURE_u_baseColorTexture",qs.BaseColor),K(F,"HAS_TEXTURE_u_metallicRoughnessTexture",qs.MetallicRoughness),K(U,"HAS_TEXTURE_u_normalTexture",qs.Normal),K(H,"HAS_TEXTURE_u_occlusionTexture",qs.Occlusion),K(X,"HAS_TEXTURE_u_emissionTexture",qs.Emission),g.texcoordBuffer&&(x.push("HAS_ATTRIBUTE_a_uv_2f"),u.push(g.texcoordBuffer)),g.colorBuffer&&(x.push(12===g.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),u.push(g.colorBuffer)),g.normalBuffer&&(x.push("HAS_ATTRIBUTE_a_normal_3f"),u.push(g.normalBuffer)),g.pbrBuffer&&(x.push("HAS_ATTRIBUTE_a_pbr"),x.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),u.push(g.pbrBuffer)),"OPAQUE"!==S.alphaMode&&"MASK"!==S.alphaMode||x.push("UNPREMULT_TEXTURE_IN_SHADER"),S.defined||x.push("DIFFUSE_SHADED"),x.push("USE_STANDARD_DERIVATIVES")}function Mg(x,u,g,w,S,D){const P=g.paint.get("model-opacity"),F=u.context,U=new Pi(u.context.gl.LEQUAL,Pi.ReadWrite,u.depthRangeFor3D),H=u.transform,X=x.mesh,K=X.material,ee=K.pbrMetallicRoughness,ie=u.style.fog;let ae;ae="pixels"===u.transform.projection.zAxisUnit?[...x.nodeModelMatrix]:_.a6.multiply([],w.zScaleMatrix,x.nodeModelMatrix),_.a6.multiply(ae,w.negCameraPosMatrix,ae);const ce=_.a6.invert([],ae);_.a6.transpose(ce,ce);const me=g.paint.get("model-emissive-strength").constantOr(0),se=Pu(new Float32Array(x.worldViewProjection),new Float32Array(ae),new Float32Array(ce),u,P,ee.baseColorFactor,K.emissiveFactor,ee.metallicFactor,ee.roughnessFactor,K,me,g),be={defines:[]},Me=[];$o(be.defines,Me,X,u);const we=u.shadowRenderer;we&&(we.useNormalOffset=!1);let Se=null;if(ie){const Fe=op(x.nodeModelMatrix,u.transform);if(Se=new Float32Array(Fe),"globe"!==H.projection.name){const Ne=X.aabb.min,je=X.aabb.max,[at,Ke]=ie.getOpacityForBounds(Fe,Ne[0],Ne[1],je[0],je[1]);be.overrideFog=at>=Tr||Ke>=Tr}}const pe=Su(u,g.paint.get("model-cutoff-fade-range"));pe.shouldRenderCutoff&&be.defines.push("RENDER_CUTOFF");const De=u.getOrCreateProgram("model",be);u.uploadCommonUniforms(F,De,null,Se,pe),"shadow"!==u.renderPass&&we&&we.setupShadowsFromMatrix(x.nodeModelMatrix,De),De.draw(u,F.gl.TRIANGLES,U,S,D,X.material.doubleSided?rn.disabled:rn.backCCW,se,g.id,X.vertexBuffer,X.indexBuffer,X.segments,g.paint,u.transform.zoom,void 0,Me)}function Nf(x,u,g,w,S,D,P){let F;F="globe"===x.projection.name?_.cS(g,x):[...g],_.a6.multiply(F,F,u.matrix);const U=_.a6.multiply([],w,F);if(u.meshes)for(const H of u.meshes){if("BLEND"!==H.material.alphaMode){P.push({mesh:H,depth:0,modelIndex:S,worldViewProjection:U,nodeModelMatrix:F});continue}const X=_.N.transformMat4([],H.centroid,U);X[2]>0&&D.push({mesh:H,depth:X[2],modelIndex:S,worldViewProjection:U,nodeModelMatrix:F})}if(u.children)for(const H of u.children)Nf(x,H,g,w,S,D,P)}function ot(x,u,g,w){const S=g.shadowRenderer;if(!S)return;const D=S.getShadowPassDepthMode(),P=S.getShadowPassColorMode(),F=S.calculateShadowPassMatrixFromMatrix(u),U=Pf(F);g.getOrCreateProgram("modelDepth",{defines:g._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(g,g.context.gl.TRIANGLES,D,nn.disabled,P,rn.backCCW,U,w.id,x.vertexBuffer,x.indexBuffer,x.segments,w.paint,g.transform.zoom,void 0,void 0)}function cv(x,u,g){const w=u.updateZoomBasedPaintProperties(),S=function(D,P,F){let U,H,X,K=D.terrain?D.terrain.exaggeration():0;if(D.terrain&&K>0){const ee=D.terrain,ie=ee.findDEMTileFor(F);ie&&ie.dem?U=_.cU.create(ee,F,ie):K=0}if(0===K&&(P.terrainElevationMin=0,P.terrainElevationMax=0),K===P.validForExaggeration&&(0===K||U&&U._demTile&&U._demTile.tileID===P.validForDEMTile.id&&U._dem._timestamp===P.validForDEMTile.timestamp))return!1;for(const ee in P.instancesPerModel){const ie=P.instancesPerModel[ee];for(let ae=0;ae<ie.instancedDataArray.length;++ae){const ce=(U?K*U.getElevationAt(0|ie.instancedDataArray.float32[16*ae],0|ie.instancedDataArray.float32[16*ae+1],!0,!0):0)+ie.instancesEvaluatedElevation[ae];ie.instancedDataArray.float32[16*ae+6]=ce,H=H?Math.min(P.terrainElevationMin,ce):ce,X=X?Math.max(P.terrainElevationMax,ce):ce}}return P.terrainElevationMin=H||0,P.terrainElevationMax=X||0,P.validForExaggeration=K,P.validForDEMTile=U&&U._demTile?{id:U._demTile.tileID,timestamp:U._dem._timestamp}:{id:void 0,timestamp:0},!0}(x,u,g);(w||S)&&(u.uploaded=!1,u.upload(x.context))}const Fs={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new _.bS([0,0,0],[_.V,_.V,0])};function Lx(x,u){const g=1<<x.canonical.z,w=u.getFreeCameraOptions().position,S=u.elevation,D=x.canonical.x/g,P=(x.canonical.x+1)/g,F=x.canonical.y/g,U=(x.canonical.y+1)/g;let H=u._centerAltitude;if(S){const ie=S.getMinMaxForTile(x);ie&&ie.max>H&&(H=ie.max)}const X=_.aa(w.x,D,P)-w.x,K=_.aa(w.y,F,U)-w.y,ee=_.bl(H,u.center.lat)-w.z;return u._zoomFromMercatorZ(Math.sqrt(X*X+K*K+ee*ee))}function Ag(x,u,g,w,S,D,P){const F=x.context,U="shadow"===x.renderPass,H=x.shadowRenderer,X=U&&H?H.getShadowPassDepthMode():new Pi(F.gl.LEQUAL,Pi.ReadWrite,x.depthRangeFor3D),K=x.isTileAffectedByFog(D);if(g.meshes)for(const ee of g.meshes){const ie=["MODEL_POSITION_ON_GPU"],ae=[];let ce,me,se;w.instancedDataArray.length>20&&ie.push("INSTANCED_ARRAYS");const be=Su(x,u.paint.get("model-cutoff-fade-range"));if(be.shouldRenderCutoff&&ie.push("RENDER_CUTOFF"),U&&H)ce=x.getOrCreateProgram("modelDepth",{defines:ie}),me=Pf(P.shadowTileMatrix,P.shadowTileMatrix,Float32Array.from(g.matrix)),se=H.getShadowPassColorMode();else{$o(ie,ae,ee,x),ce=x.getOrCreateProgram("model",{defines:ie,overrideFog:K});const we=ee.material,Se=we.pbrMetallicRoughness,pe=u.paint.get("model-opacity"),De=u.paint.get("model-emissive-strength").constantOr(0);me=Pu(D.expandedProjMatrix,Float32Array.from(g.matrix),new Float32Array(16),x,pe,Se.baseColorFactor,we.emissiveFactor,Se.metallicFactor,Se.roughnessFactor,we,De,u,S),H&&(P.shadowUniformsInitialized?ce.setShadowUniformValues(F,H.getShadowUniformValues()):(H.setupShadows(D.toUnwrapped(),ce,"model-tile",D.overscaledZ),P.shadowUniformsInitialized=!0)),se=be.shouldRenderCutoff||pe<1||"OPAQUE"!==we.alphaMode?$n.alphaBlended:$n.unblended}x.uploadCommonUniforms(F,ce,D.toUnwrapped(),null,be);const Me=ee.material.doubleSided?rn.disabled:rn.backCCW;if(w.instancedDataArray.length>20)ae.push(w.instancedDataBuffer),ce.draw(x,F.gl.TRIANGLES,X,nn.disabled,se,Me,me,u.id,ee.vertexBuffer,ee.indexBuffer,ee.segments,u.paint,x.transform.zoom,void 0,ae,w.instancedDataArray.length);else{const we=U?"u_instance":"u_normal_matrix";for(let Se=0;Se<w.instancedDataArray.length;++Se)me[we]=new Float32Array(w.instancedDataArray.arrayBuffer,64*Se,16),ce.draw(x,F.gl.TRIANGLES,X,nn.disabled,se,Me,me,u.id,ee.vertexBuffer,ee.indexBuffer,ee.segments,u.paint,x.transform.zoom,void 0,ae)}}if(g.children)for(const ee of g.children)Ag(x,u,ee,w,S,D,P)}const So=[1,-1,1];function gs(x,u,g,w){if(!g.modelManager)return!0;const S=g.modelManager;if(!g.shadowRenderer)return!0;const D=g.shadowRenderer,P=u.aabb;let F=!0,U=x.maxHeight;if(0===U){let X=0;for(const K in x.instancesPerModel){const ee=S.getModel(K,w);ee?X=Math.max(X,Math.max(Math.max(ee.aabb.max[0],ee.aabb.max[1]),ee.aabb.max[2])):F=!1}U=x.maxScale*X*1.41+x.maxVerticalOffset,F&&(x.maxHeight=U)}P.max[2]=U,P.min[2]+=x.terrainElevationMin,P.max[2]+=x.terrainElevationMax,_.N.transformMat4(P.min,P.min,u.tileMatrix),_.N.transformMat4(P.max,P.max,u.tileMatrix);const H=P.intersects(D.getCurrentCascadeFrustum());return 0===g.currentShadowCascade&&(x.isInsideFirstShadowMapFrustum=2===H),0===H}class As{}class Ur{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(u,g,w){{const K=this._storage.get(g.id);if(K)return K.lastUsedFrameIdx=u,K.buf}const S=w.gl,D=S.getBufferParameter(S.ELEMENT_ARRAY_BUFFER,S.BUFFER_SIZE),P=new ArrayBuffer(D),F=new Int16Array(P);S.getBufferSubData(S.ELEMENT_ARRAY_BUFFER,0,new Int16Array(P));const U=new _.cW;for(let K=0;K<D/2;K+=3){const ee=F[K],ie=F[K+1],ae=F[K+2];U.emplaceBack(ee,ie),U.emplaceBack(ie,ae),U.emplaceBack(ae,ee)}const H=w.bindVertexArrayOES.current,X=new As;return X.buf=new Qr(w,U),X.lastUsedFrameIdx=u,this._storage.set(g.id,X),w.bindVertexArrayOES.set(H),X.buf}update(u){for(const[g,w]of this._storage)u-w.lastUsedFrameIdx>30&&(w.buf.destroy(),this._storage.delete(g))}destroy(){for(const[u,g]of this._storage)g.buf.destroy(),this._storage.delete(u)}}class ua{registerParameter(u,g,w,S,D){}registerButton(u,g,w){}}const jc={symbol:function(x,u,g,w,S){if("translucent"!==x.renderPass)return;const D=nn.disabled,P=x.colorModeForRenderPass();g.layout.get("text-variable-anchor")&&function(H,X,K,ee,ie,ae,ce){const me=X.transform,se="map"===ie,be="map"===ae;for(const Me of H){const we=ee.getTile(Me),Se=we.getBucket(K);if(!Se||!Se.text||!Se.text.segments.get().length)continue;const pe=_.b5(Se.textSizeData,me.zoom),De=Cu(Me,Se.getProjection(),me),Fe=me.calculatePixelsToTileUnitsMatrix(we),Ne=zt(De,we.tileID.canonical,be,se,me,Se.getProjection(),Fe),je=Se.hasIconTextFit()&&Se.hasIconData();if(pe){const at=Math.pow(2,me.zoom-we.tileID.overscaledZ);nv(Se,se,be,ce,_.cx,me,Ne,Me,at,pe,je)}}}(w,x,g,u,g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),S);const F=0!==g.paint.get("icon-opacity").constantOr(1),U=0!==g.paint.get("text-opacity").constantOr(1);void 0!==g.layout.get("symbol-sort-key").constantOr(1)&&(F||U)?rv(x,u,g,w,D,P):(F&&rv(x,u,g,w,D,P,{onlyIcons:!0}),U&&rv(x,u,g,w,D,P,{onlyText:!0})),u.map.showCollisionBoxes&&(El(x,u,g,w,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),!0),El(x,u,g,w,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),!1))},circle:function(x,u,g,w){if("translucent"!==x.renderPass)return;const S=g.paint.get("circle-opacity"),D=g.paint.get("circle-stroke-width"),P=g.paint.get("circle-stroke-opacity"),F=void 0!==g.layout.get("circle-sort-key").constantOr(1),U=g.paint.get("circle-emissive-strength");if(0===S.constantOr(1)&&(0===D.constantOr(1)||0===P.constantOr(1)))return;const H=x.context,X=H.gl,K=x.transform,ee=x.depthModeForSublayer(0,Pi.ReadOnly),ie=nn.disabled,ae=x.colorModeForDrapableLayerRenderPass(U),ce="globe"===K.projection.name,me=[_.a5(K.center.lng),_.ae(K.center.lat)],se=[];for(let Me=0;Me<w.length;Me++){const we=w[Me],Se=u.getTile(we),pe=Se.getBucket(g);if(!pe||pe.projection.name!==K.projection.name)continue;const De=pe.programConfigurations.get(g.id),Fe=_.cy(g),Ne=x.isTileAffectedByFog(we);ce&&Fe.push("PROJECTION_GLOBE_VIEW");const je=x.getOrCreateProgram("circle",{config:De,defines:Fe,overrideFog:Ne}),at=pe.layoutVertexBuffer,Ke=pe.globeExtVertexBuffer,rt=pe.indexBuffer,pt=K.projection.createInversionMatrix(K,we.canonical),Pt={programConfiguration:De,program:je,layoutVertexBuffer:at,globeExtVertexBuffer:Ke,indexBuffer:rt,uniformValues:_.cz(x,we,Se,pt,me,g),tile:Se};if(F){const Ze=pe.segments.get();for(const ht of Ze)se.push({segments:new _.aB([ht]),sortKey:ht.sortKey,state:Pt})}else se.push({segments:pe.segments,sortKey:0,state:Pt})}F&&se.sort((Me,we)=>Me.sortKey-we.sortKey);const be={useDepthForOcclusion:K.depthOcclusionForSymbolsAndCircles};for(const Me of se){const{programConfiguration:we,program:Se,layoutVertexBuffer:pe,globeExtVertexBuffer:De,indexBuffer:Fe,uniformValues:Ne,tile:je}=Me.state,at=Me.segments;x.terrain&&x.terrain.setupElevationDraw(je,Se,be),x.uploadCommonUniforms(H,Se,je.tileID.toUnwrapped()),Se.draw(x,X.TRIANGLES,ee,ie,ae,rn.disabled,Ne,g.id,pe,Fe,at,g.paint,K.zoom,we,[De])}},heatmap:function(x,u,g,w){if(0!==g.paint.get("heatmap-opacity"))if("offscreen"===x.renderPass){const S=x.context,D=S.gl,P=nn.disabled,F=new $n([D.ONE,D.ONE,D.ONE,D.ONE],_.ax.transparent,[!0,!0,!0,!0]);(function(ie,ae,ce,me){const se=ie.gl,be=ae.width*me,Me=ae.height*me;ie.activeTexture.set(se.TEXTURE1),ie.viewport.set([0,0,be,Me]);let we=ce.heatmapFbo;if(!we||we&&(we.width!==be||we.height!==Me)){we&&we.destroy();const Se=se.createTexture();se.bindTexture(se.TEXTURE_2D,Se),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),we=ce.heatmapFbo=ie.createFramebuffer(be,Me,!0,null),function(pe,De,Fe,Ne,je,at){const Ke=pe.gl;Ke.texImage2D(Ke.TEXTURE_2D,0,pe.extRenderToTextureHalfFloat?Ke.RGBA16F:Ke.RGBA,je,at,0,Ke.RGBA,pe.extRenderToTextureHalfFloat?Ke.HALF_FLOAT:Ke.UNSIGNED_BYTE,null),Ne.colorAttachment.set(Fe)}(ie,0,Se,we,be,Me)}else se.bindTexture(se.TEXTURE_2D,we.colorAttachment.get()),ie.bindFramebuffer.set(we.framebuffer)})(S,x,g,"globe"===x.transform.projection.name?.5:.25),S.clear({color:_.ax.transparent});const U=x.transform,H="globe"===U.projection.name,X=H?["PROJECTION_GLOBE_VIEW"]:[],K=H?rn.frontCCW:rn.disabled,ee=[_.a5(U.center.lng),_.ae(U.center.lat)];for(let ie=0;ie<w.length;ie++){const ae=w[ie];if(u.hasRenderableParent(ae))continue;const ce=u.getTile(ae),me=ce.getBucket(g);if(!me||me.projection.name!==U.projection.name)continue;const se=x.isTileAffectedByFog(ae),be=me.programConfigurations.get(g.id),Me=x.getOrCreateProgram("heatmap",{config:be,defines:X,overrideFog:se}),{zoom:we}=x.transform;x.terrain&&x.terrain.setupElevationDraw(ce,Me),x.uploadCommonUniforms(S,Me,ae.toUnwrapped());const Se=U.projection.createInversionMatrix(U,ae.canonical);Me.draw(x,D.TRIANGLES,Pi.disabled,P,F,K,Ix(x,ae,ce,Se,ee,we,g.paint.get("heatmap-intensity")),g.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,g.paint,x.transform.zoom,be,H?[me.globeExtVertexBuffer]:null)}S.viewport.set([0,0,x.width,x.height])}else"translucent"===x.renderPass&&(x.context.setColorMode(x.colorModeForRenderPass()),function(S,D){const P=S.context,F=P.gl,U=D.heatmapFbo;if(!U)return;P.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,U.colorAttachment.get()),P.activeTexture.set(F.TEXTURE1);let H=D.colorRampTexture;H||(H=D.colorRampTexture=new _.T(P,D.colorRamp,F.RGBA)),H.bind(F.LINEAR,F.CLAMP_TO_EDGE),S.getOrCreateProgram("heatmapTexture").draw(S,F.TRIANGLES,Pi.disabled,nn.disabled,S.colorModeForRenderPass(),rn.disabled,{u_image:0,u_color_ramp:1,u_opacity:D.paint.get("heatmap-opacity")},D.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,D.paint,S.transform.zoom)}(x,g))},line:function(x,u,g,w){if("translucent"!==x.renderPass)return;const S=g.paint.get("line-opacity"),D=g.paint.get("line-width");if(0===S.constantOr(1)||0===D.constantOr(1))return;const P=g.paint.get("line-emissive-strength"),F=x.depthModeForSublayer(0,Pi.ReadOnly),U=x.colorModeForDrapableLayerRenderPass(P),H=x.terrain&&x.terrain.renderingToTexture?1:_.f.devicePixelRatio,X=g.paint.get("line-dasharray"),K=X.constantOr(1),ee=g.layout.get("line-cap"),ie=g.paint.get("line-pattern"),ae=ie.constantOr(1),ce=g.paint.get("line-pattern").constantOr(1),me=1!==g.paint.get("line-opacity").constantOr(1);let se=!ce&&me;const be=g.paint.get("line-gradient"),Me=ae?"linePattern":"line",we=x.context,Se=we.gl,pe=_.cA(g);x.terrain&&x.terrain.clipOrMaskOverlapStencilType()&&(se=!1);for(const De of w){const Fe=u.getTile(De);if(ae&&!Fe.patternsLoaded())continue;const Ne=Fe.getBucket(g);if(!Ne)continue;x.prepareDrawTile();const je=Ne.programConfigurations.get(g.id),at=x.isTileAffectedByFog(De),Ke=x.getOrCreateProgram(Me,{config:je,defines:pe,overrideFog:at}),rt=ie.constantOr(null);if(rt&&Fe.imageAtlas){const ti=Fe.imageAtlas.patternPositions[rt.toString()];ti&&je.setConstantPatternPositions(ti)}const pt=X.constantOr(null),Pt=ee.constantOr(null);if(!ae&&pt&&Pt&&Fe.lineAtlas){const ti=Fe.lineAtlas.getDash(pt,Pt);ti&&je.setConstantPatternPositions(ti)}let[Ze,ht]=g.paint.get("line-trim-offset");("round"===Pt||"square"===Pt)&&Ze!==ht&&(0===Ze&&(Ze-=1),1===ht&&(ht+=1));const ze=x.terrain?De.projMatrix:null,Ye=ae?_.cB(x,Fe,g,ze,H,[Ze,ht]):_.cC(x,Fe,g,ze,Ne.lineClipsArray.length,H,[Ze,ht]);if(be){const ti=Ne.gradients[g.id];let Wt=ti.texture;if(g.gradientVersion!==ti.version){let _i=256;if(g.stepInterpolant){const vi=u.getSource().maxzoom,Yi=De.canonical.z===vi?Math.ceil(1<<x.transform.maxZoom-De.canonical.z):1;_i=_.aa(_.cD(Ne.maxLineLength/_.V*1024*Yi),256,we.maxTextureSize)}ti.gradient=_.cE({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:_i,image:ti.gradient||void 0,clips:Ne.lineClipsArray}),ti.texture?ti.texture.update(ti.gradient):ti.texture=new _.T(we,ti.gradient,Se.RGBA),ti.version=g.gradientVersion,Wt=ti.texture}we.activeTexture.set(Se.TEXTURE1),Wt.bind(g.stepInterpolant?Se.NEAREST:Se.LINEAR,Se.CLAMP_TO_EDGE)}K&&(we.activeTexture.set(Se.TEXTURE0),Fe.lineAtlasTexture&&Fe.lineAtlasTexture.bind(Se.LINEAR,Se.REPEAT),je.updatePaintBuffers()),ae&&(we.activeTexture.set(Se.TEXTURE0),Fe.imageAtlasTexture&&Fe.imageAtlasTexture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),je.updatePaintBuffers()),x.uploadCommonUniforms(we,Ke,De.toUnwrapped());const Mt=ti=>{Ke.draw(x,Se.TRIANGLES,F,ti,U,rn.disabled,Ye,g.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,g.paint,x.transform.zoom,je,[Ne.layoutVertexBuffer2])};if(se){const ti=x.stencilModeForClipping(De).ref;0===ti&&x.terrain&&we.clear({stencil:0});const Wt={func:Se.EQUAL,mask:255};Ye.u_alpha_discard_threshold=.8,Mt(new nn(Wt,ti,255,Se.KEEP,Se.KEEP,Se.INVERT)),Ye.u_alpha_discard_threshold=0,Mt(new nn(Wt,ti,255,Se.KEEP,Se.KEEP,Se.KEEP))}else Mt(x.stencilModeForClipping(De))}se&&(x.resetStencilClippingMasks(),x.terrain&&we.clear({stencil:0}))},fill:function(x,u,g,w){const S=g.paint.get("fill-color"),D=g.paint.get("fill-opacity");if(0===D.constantOr(1))return;const P=g.paint.get("fill-emissive-strength"),F=x.colorModeForDrapableLayerRenderPass(P),U=g.paint.get("fill-pattern"),H=x.opaquePassEnabledForLayer()&&!U.constantOr(1)&&1===S.constantOr(_.ax.transparent).a&&1===D.constantOr(0)?"opaque":"translucent";if(x.renderPass===H){const X=x.depthModeForSublayer(1,"opaque"===x.renderPass?Pi.ReadWrite:Pi.ReadOnly);Ra(x,u,g,w,X,F,!1)}if("translucent"===x.renderPass&&g.paint.get("fill-antialias")){const X=x.depthModeForSublayer(g.getPaintProperty("fill-outline-color")?2:0,Pi.ReadOnly);Ra(x,u,g,w,X,F,!0)}},"fill-extrusion":function(x,u,g,w){const S=g.paint.get("fill-extrusion-opacity"),D=x.context,P=D.gl,F=x.terrain,U=F&&F.renderingToTexture;if(0===S)return;const H=x.conflationActive&&x.layerUsedInConflation(g,u.getSource());if(H&&function(X,K,ee,ie){for(const ae of ie){const ce=K.getTile(ae).getBucket(ee);ce&&(ce.updateReplacement(ae,X.replacementSource),ce.uploadCentroid(X.context))}}(x,u,g,w),F||H)for(const X of w){const K=u.getTile(X).getBucket(g);K&&tp(x.context,u,X,K,g,F,H)}if("shadow"===x.renderPass&&x.shadowRenderer){const X=x.shadowRenderer;if(F&&S<.65&&g._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof _.Z)return;const K=X.getShadowPassDepthMode(),ee=X.getShadowPassColorMode();Wi(x,u,g,w,K,nn.disabled,ee,H)}else if("translucent"===x.renderPass){const X=!g.paint.get("fill-extrusion-pattern").constantOr(1),K=g.paint.get("fill-extrusion-color").constantOr(_.ax.white);if(!U&&0!==K.a){const ee=new Pi(x.context.gl.LEQUAL,Pi.ReadWrite,x.depthRangeFor3D);1===S&&X?Wi(x,u,g,w,ee,nn.disabled,$n.unblended,H):(Wi(x,u,g,w,ee,nn.disabled,$n.disabled,H),Wi(x,u,g,w,ee,x.stencilModeFor3D(),x.colorModeForRenderPass(),H),x.resetStencilClippingMasks())}if(x.style.enable3dLights()&&X&&(!F&&"globe"!==x.transform.projection.name||U)){const ee=g.paint.get("fill-extrusion-opacity"),ie=g.paint.get("fill-extrusion-ambient-occlusion-intensity"),ae=g.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ce=g.paint.get("fill-extrusion-flood-light-intensity"),me=g.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),se=ie>0&&ae>0,be=ce>0,Me=(Se,pe,De)=>(1-De)*Se+De*pe,we=Se=>{const pe=x.depthModeForSublayer(1,Pi.ReadOnly,P.LEQUAL,!0),De=g.paint.get(Se?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Fe=Me(.1,3,De),Ne=x._showOverdrawInspector;if(!Ne){const je=new nn({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),at=new $n([P.ONE,P.ONE,P.ONE,P.ONE],_.ax.transparent,[!1,!1,!1,!0],P.MIN);Uc(x,u,g,w,pe,je,at,rn.disabled,Se,"sdf",ee,ie,ae,ce,me,Fe,H,!1)}{const je=Ne?nn.disabled:new nn({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),at=Ne?x.colorModeForRenderPass():new $n([P.ONE_MINUS_DST_ALPHA,P.DST_ALPHA,P.ONE,P.ONE],_.ax.transparent,[!0,!0,!0,!0]);Uc(x,u,g,w,pe,je,at,rn.disabled,Se,"color",ee,ie,ae,ce,me,Fe,H,!1)}};if(U){const Se=(pe,De,Fe)=>{const Ne=x.depthModeForSublayer(1,Pi.ReadOnly,P.LEQUAL,!1),je=g.paint.get(pe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),at=Me(.1,3,je);{const Ke=new $n([P.ONE,P.ONE,P.ONE,P.ONE],_.ax.transparent,[!1,!1,!1,!0]);Uc(x,u,g,w,Ne,nn.disabled,Ke,rn.disabled,pe,"clear",ee,ie,ae,ce,me,at,H,De)}{const Ke=new nn({func:P.ALWAYS,mask:255},255,255,P.KEEP,P.KEEP,P.REPLACE),rt=new $n([P.ONE,P.ONE,P.ONE,P.ONE],_.ax.transparent,[!1,!1,!1,!0],P.MIN);Uc(x,u,g,w,Ne,Ke,rt,rn.disabled,pe,"sdf",ee,ie,ae,ce,me,at,H,De)}{const Ke=pe?P.ZERO:P.ONE_MINUS_DST_ALPHA,rt=new nn({func:P.EQUAL,mask:255},255,255,P.KEEP,P.DECR,P.DECR),pt=new $n([Ke,P.DST_ALPHA,P.ONE_MINUS_DST_ALPHA,P.ZERO],_.ax.transparent,[!0,!0,!0,!0]);Uc(x,u,g,w,Ne,rt,pt,rn.disabled,pe,"color",ee,ie,ae,ce,me,at,H,De)}{const Ke=new $n([P.ONE,P.ONE,P.ONE,pe?P.ZERO:P.ONE],_.ax.transparent,[!1,!1,!1,!0],pe?P.FUNC_ADD:P.MAX);Uc(x,u,g,w,Ne,nn.disabled,Ke,rn.disabled,pe,"clear",ee,ie,ae,ce,me,at,H,De,Fe)}};if(se||be){let pe;if(x.prepareDrawTile(),F){const De=F.drapeBufferSize[0],Fe=F.drapeBufferSize[1];pe=F.framebufferCopyTexture,pe&&(!pe||pe.size[0]===De&&pe.size[1]===Fe)||(pe&&pe.destroy(),pe=F.framebufferCopyTexture=new _.T(D,new _.h({width:De,height:Fe}),P.RGBA)),pe.bind(P.LINEAR,P.CLAMP_TO_EDGE),P.copyTexImage2D(P.TEXTURE_2D,0,P.RGBA,0,0,De,Fe,0)}se&&Se(!0,!1,pe),be&&Se(!1,!0,pe)}}else se&&we(!0),be&&we(!1)}}},hillshade:function(x,u,g,w){if("offscreen"!==x.renderPass&&"translucent"!==x.renderPass||x.style.disableElevatedTerrain)return;const S=x.context,D=x.terrain&&x.terrain.renderingToTexture,[P,F]="translucent"!==x.renderPass||D?[{},w]:x.stencilConfigForOverlap(w);for(const U of F){const H=u.getTile(U);if(H.needsHillshadePrepare&&"offscreen"===x.renderPass)Q_(x,H,g);else if("translucent"===x.renderPass){const X=x.depthModeForSublayer(0,Pi.ReadOnly),K=g.paint.get("hillshade-emissive-strength"),ee=x.colorModeForDrapableLayerRenderPass(K),ie=D&&x.terrain?x.terrain.stencilModeForRTTOverlap(U):P[U.overscaledZ];os(x,U,H,g,X,ie,ee)}}S.viewport.set([0,0,x.width,x.height]),x.resetStencilClippingMasks()},raster:function(x,u,g,w,S,D){if("translucent"!==x.renderPass||0===g.paint.get("raster-opacity"))return;const P="globe"===x.transform.projection.name,F=0!==g.paint.get("raster-elevation"),U=F&&P;if(x.renderElevatedRasterBackface&&!U)return;const H=x.context,X=H.gl,K=u.getSource(),ee=function(pe,De,Fe,Ne){const je=De.paint.get("raster-color"),at="raster-array"===pe.type,Ke=[],rt=De.paint.get("raster-resampling"),pt=De.paint.get("raster-color-mix");let Pt=De.paint.get("raster-color-range");const Ze=[pt[0],pt[1],pt[2],0],ht=pt[3];let ze="nearest"===rt?Ne.NEAREST:Ne.LINEAR;if(at&&(Ke.push("RASTER_ARRAY"),je||Ke.push("RASTER_COLOR"),"linear"===rt&&Ke.push("RASTER_ARRAY_LINEAR"),ze=Ne.NEAREST,!Pt&&pe.rasterLayers)){const Ye=pe.rasterLayers.find(({id:Mt})=>Mt===De.sourceLayer);Ye&&Ye.fields&&Ye.fields.range&&(Pt=Ye.fields.range)}if(Pt=Pt||[0,1],je){Ke.push("RASTER_COLOR"),Fe.activeTexture.set(Ne.TEXTURE2),De.updateColorRamp(Pt);let Ye=De.colorRampTexture;Ye||(Ye=De.colorRampTexture=new _.T(Fe,De.colorRamp,Ne.RGBA)),Ye.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE)}return{mix:Ze,range:Pt,offset:ht,defines:Ke,resampling:ze}}(K,g,H,X);if(K instanceof _.ap&&!w.length&&!P)return;const ie=g.paint.get("raster-emissive-strength"),ae=x.colorModeForDrapableLayerRenderPass(ie),ce=x.terrain&&x.terrain.renderingToTexture,me=!x.options.moving,se="nearest"===g.paint.get("raster-resampling")?X.NEAREST:X.LINEAR;if(K instanceof _.ap&&!w.length&&(K.onNorthPole||K.onSouthPole)){const pe=F?x.stencilModeFor3D():nn.disabled;return void ty(!!K.onNorthPole,null,x,u,g,ie,ee,rn.disabled,pe)}if(!w.length)return;const[be,Me]=K instanceof _.ap||ce?[{},w]:x.stencilConfigForOverlap(w),we=Me[Me.length-1].overscaledZ;U&&ee.defines.push("PROJECTION_GLOBE_VIEW"),F&&ee.defines.push("RENDER_CUTOFF");const Se=(pe,De,Fe)=>{for(const Ne of pe){const je=Ne.toUnwrapped(),at=u.getTile(Ne);if(ce&&(!at||!at.hasData()))continue;H.activeTexture.set(X.TEXTURE0);const Ke=ip(at,K,g,ee);if(!Ke||!Ke.texture)continue;const{texture:rt,mix:pt,offset:Pt,tileSize:Ze,buffer:ht}=Ke;let ze,Ye;ce?(ze=Pi.disabled,Ye=Ne.projMatrix):F?(ze=new Pi(X.LEQUAL,Pi.ReadWrite,x.depthRangeFor3D),Ye=P?Float32Array.from(x.transform.expandedFarZProjMatrix):x.transform.calculateProjMatrix(je,me)):(ze=x.depthModeForSublayer(Ne.overscaledZ-we,1===g.paint.get("raster-opacity")?Pi.ReadWrite:Pi.ReadOnly,X.LESS),Ye=x.transform.calculateProjMatrix(je,me));const Mt=x.terrain&&ce?x.terrain.stencilModeForRTTOverlap(Ne):be[Ne.overscaledZ],ti=D?0:g.paint.get("raster-fade-duration");at.registerFadeDuration(ti);const Wt=u.findLoadedParent(Ne,0),_i=Jm(at,Wt,u,x.transform,ti);let vi,Yi;x.terrain&&x.terrain.prepareDrawTile(),H.activeTexture.set(X.TEXTURE0),rt.bind(se,X.CLAMP_TO_EDGE),H.activeTexture.set(X.TEXTURE1),Wt?(Wt.texture&&Wt.texture.bind(se,X.CLAMP_TO_EDGE),vi=Math.pow(2,Wt.tileID.overscaledZ-at.tileID.overscaledZ),Yi=[at.tileID.canonical.x*vi%1,at.tileID.canonical.y*vi%1]):rt.bind(se,X.CLAMP_TO_EDGE),rt.useMipmap&&H.extTextureFilterAnisotropic&&x.transform.pitch>20&&X.texParameterf(X.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const qi=x.transform;let Xi;const Sn=F?iy(qi):[0,0,0,0];let bn,xn,Dn,fr,jr,Mi=0;if(U&&K instanceof _.ap&&K.coordinates.length>3)bn=Float32Array.from(_.aT(_.ci(new _.bs(0,0,0)))),xn=Float32Array.from(qi.globeMatrix),Dn=Float32Array.from(_.ce(qi)),fr=[_.a5(qi.center.lng),_.ae(qi.center.lat)],Xi=K.elevatedGlobePerspectiveTransform,jr=K.elevatedGlobeGridMatrix||new Float32Array(9);else if(U){const vr=_.cf(Ne.canonical);Mi=_.cg(vr.getCenter().lat),bn=Float32Array.from(_.aT(_.ci(Ne.canonical))),xn=Float32Array.from(qi.globeMatrix),Dn=Float32Array.from(_.ce(qi)),fr=[_.a5(qi.center.lng),_.ae(qi.center.lat)],Xi=[0,0],jr=Float32Array.from(_.ch(Ne.canonical,vr,Mi,qi.worldSize/qi._pixelsPerMercatorPixel))}else Xi=K instanceof _.ap?K.perspectiveTransform:[0,0],bn=new Float32Array(16),xn=new Float32Array(9),Dn=new Float32Array(16),fr=[0,0],jr=new Float32Array(9);const Do=Iu(Ye,bn,xn,Dn,jr,Yi||[0,0],_.S(x.transform.zoom),fr,Sn,vi||1,_i,g,Xi,F?g.paint.get("raster-elevation"):0,2,pt,Pt,ee.range,Ze,ht,ie),ar=x.isTileAffectedByFog(Ne),Lr=x.getOrCreateProgram("raster",{defines:ee.defines,overrideFog:ar});if(x.uploadCommonUniforms(H,Lr,je),K instanceof _.ap){const vr=K.elevatedGlobeVertexBuffer,Sr=K.elevatedGlobeIndexBuffer;if(ce||!P)K.boundsBuffer&&K.boundsSegments&&Lr.draw(x,X.TRIANGLES,ze,nn.disabled,ae,rn.disabled,Do,g.id,K.boundsBuffer,x.quadTriangleIndexBuffer,K.boundsSegments);else if(vr&&Sr){const ko=qi.zoom<=_.bG?K.elevatedGlobeSegments:K.getSegmentsForLongitude(qi.center.lng);ko&&Lr.draw(x,X.TRIANGLES,ze,nn.disabled,ae,De,Do,g.id,vr,Sr,ko)}}else if(U){ze=new Pi(X.LEQUAL,Pi.ReadOnly,x.depthRangeFor3D);const vr=x.globeSharedBuffers;if(vr){const[Sr,ko,Yr]=vr.getGridBuffers(Mi,!1);Lr.draw(x,X.TRIANGLES,ze,Fe||Mt,x.colorModeForRenderPass(),De,Do,g.id,Sr,ko,Yr)}}else{const{tileBoundsBuffer:vr,tileBoundsIndexBuffer:Sr,tileBoundsSegments:ko}=x.getTileBoundsBuffers(at);Lr.draw(x,X.TRIANGLES,ze,Mt,ae,rn.disabled,Do,g.id,vr,Sr,ko)}}if(!(K instanceof _.ap)&&U)for(const Ne of pe){const je=Ne.canonical.y===(1<<Ne.canonical.z)-1;0===Ne.canonical.y&&ty(!0,Ne,x,u,g,ie,ee,De,Fe||nn.disabled),je&&ty(!1,Ne,x,u,g,ie,ee,De===rn.frontCW?rn.backCW:rn.frontCW,Fe||nn.disabled)}};U?Se(Me,x.renderElevatedRasterBackface?rn.backCW:rn.frontCW,x.stencilModeFor3D()):Se(Me,rn.disabled,void 0),x.resetStencilClippingMasks()},"raster-particle":function(x,u,g,w,S,D){"offscreen"===x.renderPass&&function(P,F,U,H){if(!H.length)return;const X=P.context,K=X.gl,ee=F.getSource();if(!(ee instanceof Zt))return;const ie=[];for(const me of H){const se=F.getTile(me);if(!(se instanceof od))continue;const be=Sg(se,ee,U);if(!be)continue;const Me=[be.tileSize,be.tileSize];let we=U.tileFramebuffer;we||(we=U.tileFramebuffer=X.createFramebuffer(Me[0],Me[1],!0,null));let Se=se.rasterParticleState;const pe=U.paint.get("raster-particle-count");Se||(Se=se.rasterParticleState=new cs(X,me,Me,pe));const De=Se.update(U.lastInvalidatedAt);Se.numParticles!==pe&&Se.setNumParticles(me,pe);const Fe=Se.targetColorTexture;Se.targetColorTexture=Se.backgroundColorTexture,Se.backgroundColorTexture=Fe;const Ne=Se.particleVertices0;Se.particleVertices0=Se.particleVertices1,Se.particleVertices1=Ne,ie.push([me,be,Se,De])}if(0===ie.length)return;const ae=_.f.now(),ce=U.previousDrawTimestamp?.001*(ae-U.previousDrawTimestamp):.0167;if(U.previousDrawTimestamp=ae,U.hasColorMap()){X.activeTexture.set(K.TEXTURE0+2);let me=U.colorRampTexture;me||(me=U.colorRampTexture=new _.T(X,U.colorRamp,K.RGBA)),me.bind(K.LINEAR,K.CLAMP_TO_EDGE)}X.bindFramebuffer.set(U.tileFramebuffer.framebuffer),X.activeTexture.set(K.TEXTURE0),function(me,se,be){const Me=me.context,we=Me.gl,Se=se.tileFramebuffer;Me.activeTexture.set(we.TEXTURE0);const pe={u_texture:0,u_opacity:1.05*(Fe=se.paint.get("raster-particle-fade-opacity-factor"))/(Fe+.05)},De=me.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Fe;for(const Ne of be){const[,,je,at]=Ne;Se.colorAttachment.set(je.targetColorTexture.texture),Me.viewport.set([0,0,Se.width,Se.height]),Me.clear({color:_.ax.transparent}),at&&(je.backgroundColorTexture.bind(we.NEAREST,we.CLAMP_TO_EDGE),De.draw(me,we.TRIANGLES,Pi.disabled,nn.disabled,$n.alphaBlended,rn.disabled,pe,se.id,me.viewportBuffer,me.quadTriangleIndexBuffer,me.viewportSegments))}}(P,U,ie),function(me,se,be,Me){const we=me.context.gl,Se=be.tileFramebuffer,pe="globe"===me.transform.projection.name,De=be.paint.get("raster-particle-max-speed");for(const Fe of Me){const[Ne,je,at]=Fe;je.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE),Se.colorAttachment.set(at.targetColorTexture.texture);const Ke=me.getOrCreateProgram("rasterParticleDraw",{defines:je.defines,overrideFog:!1}),rt=je.scalarData?[]:[0,1,2,3].map(Ze=>_.cG[Ze](Ne));rt.push(Ne);const pt=Ne.canonical.x,Pt=Ne.canonical.y;for(const Ze of rt){const ht=se.getTile(pe?Ze.wrapped():Ze);if(!ht)continue;const ze=ht.rasterParticleState;if(!ze)continue;const Ye=Kd([Ze.canonical.x+(1<<Ze.canonical.z)*(Ze.wrap-Ne.wrap)-pt,Ze.canonical.y-Pt],0,je.texture.size,2,De,je.textureOffset,je.scale,je.offset);Ke.draw(me,we.POINTS,Pi.disabled,nn.disabled,$n.alphaBlended,rn.disabled,Ye,be.id,ze.particleVertices0,void 0,ze.particleSegment)}}}(P,F,U,ie),function(me,se,be,Me){const we=me.context.gl;let Se=se.transformFeedbackObject;Se||(Se=se.transformFeedbackObject=we.createTransformFeedback()),we.bindTransformFeedback(we.TRANSFORM_FEEDBACK,se.transformFeedbackObject);const pe=se.paint.get("raster-particle-max-speed"),De=Me*se.paint.get("raster-particle-speed-factor")*.3,Fe=(Ne=se.paint.get("raster-particle-reset-rate-factor"),Math.pow(Ne,6));var Ne;for(const je of be){const[,at,Ke]=je;at.texture.bind(we.LINEAR,we.CLAMP_TO_EDGE);const rt=yo(0,at.texture.size,pe,De,Fe,at.textureOffset,at.scale,at.offset);me.getOrCreateProgram("rasterParticleUpdate",{defines:at.defines,transformFeedback:{bufferMode:we.SEPARATE_ATTRIBS,shaderVaryings:["v_new_particle"]}}).draw(me,we.POINTS,Pi.disabled,nn.disabled,$n.disabled,rn.disabled,rt,se.id,Ke.particleVertices0,void 0,Ke.particleSegment,{},void 0,void 0,void 0,void 0,[{buffer:Ke.particleVertices1,targetIndex:0}])}we.bindTransformFeedback(we.TRANSFORM_FEEDBACK,null)}(P,U,ie,ce)}(x,u,g,w),"translucent"===x.renderPass&&(function(P,F,U,H){const K=P.context,ee=K.gl,ie=!P.options.moving,ae="globe"===P.transform.projection.name;if(!H.length)return;const[ce,me]=P.stencilConfigForOverlap(H),se=[];ae&&se.push("PROJECTION_GLOBE_VIEW");for(const be of me){const Me=be.toUnwrapped(),we=F.getTile(be);if(!we.rasterParticleState)continue;const Se=we.rasterParticleState,pe=100;we.registerFadeDuration(pe);const De=F.findLoadedParent(be,0),Fe=Jm(we,De,F,P.transform,pe);let Ne,je;P.terrain&&P.terrain.prepareDrawTile(),K.activeTexture.set(ee.TEXTURE0),Se.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),K.activeTexture.set(ee.TEXTURE1),De&&De.rasterParticleState?(De.rasterParticleState.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),Ne=Math.pow(2,De.tileID.overscaledZ-we.tileID.overscaledZ),je=[we.tileID.canonical.x*Ne%1,we.tileID.canonical.y*Ne%1]):Se.targetColorTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const at=ae?Float32Array.from(P.transform.expandedFarZProjMatrix):P.transform.calculateProjMatrix(Me,ie),Ke=P.transform,rt=sv(Ke),pt=_.cf(be.canonical),Pt=_.cg(pt.getCenter().lat);let Ze,ht,ze,Ye,Mt;ae?(Ze=Float32Array.from(_.aT(_.ci(be.canonical))),ht=Float32Array.from(Ke.globeMatrix),ze=Float32Array.from(_.ce(Ke)),Ye=[_.a5(Ke.center.lng),_.ae(Ke.center.lat)],Mt=Float32Array.from(_.ch(be.canonical,pt,Pt,Ke.worldSize/Ke._pixelsPerMercatorPixel))):(Ze=new Float32Array(16),ht=new Float32Array(9),ze=new Float32Array(16),Ye=[0,0],Mt=new Float32Array(9));const ti=Rx(at,Ze,ht,ze,Mt,je||[0,0],_.S(P.transform.zoom),Ye,rt,Ne||1,Fe,250),Wt=P.isTileAffectedByFog(be),_i=P.getOrCreateProgram("rasterParticle",{defines:se,overrideFog:Wt});if(P.uploadCommonUniforms(K,_i,Me),ae){const vi=new Pi(ee.LEQUAL,Pi.ReadWrite,P.depthRangeFor3D),Yi=0,qi=P.globeSharedBuffers;if(qi){const[Xi,Sn,bn]=qi.getGridBuffers(Pt,0!==Yi);_i.draw(P,ee.TRIANGLES,vi,nn.disabled,$n.alphaBlended,rn.backCCW,ti,U.id,Xi,Sn,bn)}}else{const vi=P.depthModeForSublayer(0,Pi.ReadOnly),Yi=ce[be.overscaledZ],{tileBoundsBuffer:qi,tileBoundsIndexBuffer:Xi,tileBoundsSegments:Sn}=P.getTileBoundsBuffers(we);_i.draw(P,ee.TRIANGLES,vi,Yi,$n.alphaBlended,rn.disabled,ti,U.id,qi,Xi,Sn)}}P.resetStencilClippingMasks()}(x,u,g,w),x.style.map.triggerRepaint())},background:function(x,u,g,w){const S=g.paint.get("background-color"),D=g.paint.get("background-opacity"),P=g.paint.get("background-emissive-strength");if(0===D)return;const F=x.context,U=F.gl,H=x.transform,X=H.tileSize,K=g.paint.get("background-pattern");if(x.isPatternMissing(K,g.scope))return;const ee=!K&&1===S.a&&1===D&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==ee)return;const ie=nn.disabled,ae=x.depthModeForSublayer(0,"opaque"===ee?Pi.ReadWrite:Pi.ReadOnly),ce=x.colorModeForDrapableLayerRenderPass(P),me=K?"backgroundPattern":"background";let se,be=w;be||(se=x.getBackgroundTiles(),be=Object.values(se).map(Me=>Me.tileID)),K&&(F.activeTexture.set(U.TEXTURE0),x.imageManager.bind(x.context,g.scope));for(const Me of be){const we=x.isTileAffectedByFog(Me),Se=x.getOrCreateProgram(me,{overrideFog:we}),pe=Me.toUnwrapped(),De=w?Me.projMatrix:x.transform.calculateProjMatrix(pe);x.prepareDrawTile();const Fe=u?u.getTile(Me):se?se[Me.key]:new Ul(Me,X,H.zoom,x),Ne=K?ao(De,P,D,x,K,g.scope,{tileID:Me,tileSize:X}):Rf(De,P,D,S);x.uploadCommonUniforms(F,Se,pe);const{tileBoundsBuffer:je,tileBoundsIndexBuffer:at,tileBoundsSegments:Ke}=x.getTileBoundsBuffers(Fe);Se.draw(x,U.TRIANGLES,ae,ie,ce,rn.disabled,Ne,g.id,je,at,Ke)}},sky:function(x,u,g){const w=x._atmosphere?_.S(x.transform.zoom):1,S=g.paint.get("sky-opacity")*w;if(0===S)return;const D=x.context,P=g.paint.get("sky-type"),F=new Pi(D.gl.LEQUAL,Pi.ReadOnly,[0,1]),U=x.frameCounter/1e3%1;"atmosphere"===P?"offscreen"===x.renderPass?g.needsSkyboxCapture(x)&&(function(H,X){const ie=H.context,ae=ie.gl;let ce=X.skyboxFbo;if(!ce){ce=X.skyboxFbo=ie.createFramebuffer(32,32,!0,null),X.skyboxGeometry=new ry(ie),X.skyboxTexture=ie.gl.createTexture(),ae.bindTexture(ae.TEXTURE_CUBE_MAP,X.skyboxTexture),ae.texParameteri(ae.TEXTURE_CUBE_MAP,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_CUBE_MAP,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_CUBE_MAP,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_CUBE_MAP,ae.TEXTURE_MAG_FILTER,ae.LINEAR);for(let Me=0;Me<6;++Me)ae.texImage2D(ae.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,ae.RGBA,32,32,0,ae.RGBA,ae.UNSIGNED_BYTE,null)}ie.bindFramebuffer.set(ce.framebuffer),ie.viewport.set([0,0,32,32]);const me=X.getCenter(H,!0),se=H.getOrCreateProgram("skyboxCapture"),be=new Float64Array(16);_.a6.identity(be),_.a6.rotateY(be,be,.5*-Math.PI),yh(H,X,se,be,me,0),_.a6.identity(be),_.a6.rotateY(be,be,.5*Math.PI),yh(H,X,se,be,me,1),_.a6.identity(be),_.a6.rotateX(be,be,.5*-Math.PI),yh(H,X,se,be,me,2),_.a6.identity(be),_.a6.rotateX(be,be,.5*Math.PI),yh(H,X,se,be,me,3),_.a6.identity(be),yh(H,X,se,be,me,4),_.a6.identity(be),_.a6.rotateY(be,be,Math.PI),yh(H,X,se,be,me,5),ie.viewport.set([0,0,H.width,H.height])}(x,g),g.markSkyboxValid(x)):"sky"===x.renderPass&&function(H,X,K,ee,ie){const ae=H.context,ce=ae.gl,me=H.transform,se=H.getOrCreateProgram("skybox");ae.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_CUBE_MAP,X.skyboxTexture);const be=((Me,we,Se,pe,De)=>({u_matrix:Me,u_sun_direction:we,u_cubemap:0,u_opacity:pe,u_temporal_offset:De}))(me.skyboxMatrix,X.getCenter(H,!1),0,ee,ie);H.uploadCommonUniforms(ae,se),se.draw(H,ce.TRIANGLES,K,nn.disabled,H.colorModeForRenderPass(),rn.backCW,be,"skybox",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(x,g,F,S,U):"gradient"===P&&"sky"===x.renderPass&&function(H,X,K,ee,ie){const ae=H.context,ce=ae.gl,me=H.transform,se=H.getOrCreateProgram("skyboxGradient");X.skyboxGeometry||(X.skyboxGeometry=new ry(ae)),ae.activeTexture.set(ce.TEXTURE0);let be=X.colorRampTexture;be||(be=X.colorRampTexture=new _.T(ae,X.colorRamp,ce.RGBA)),be.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Me=(we=me.skyboxMatrix,Se=X.getCenter(H,!1),pe=X.paint.get("sky-gradient-radius"),De=ee,Fe=ie,{u_matrix:we,u_color_ramp:0,u_center_direction:Se,u_radius:_.bj(pe),u_opacity:De,u_temporal_offset:Fe});var we,Se,pe,De,Fe;H.uploadCommonUniforms(ae,se),se.draw(H,ce.TRIANGLES,K,nn.disabled,H.colorModeForRenderPass(),rn.backCW,Me,"skyboxGradient",X.skyboxGeometry.vertexBuffer,X.skyboxGeometry.indexBuffer,X.skyboxGeometry.segment)}(x,g,F,S,U)},debug:function(x,u,g,w,S,D){for(let P=0;P<g.length;P++)if(S){const H=new _.ax(.8*w.r,.8*w.g,.8*w.b,1);ps(x,u,g[P],w,-1,-1,D),ps(x,u,g[P],w,-1,1,D),ps(x,u,g[P],w,1,1,D),ps(x,u,g[P],w,1,-1,D),ps(x,u,g[P],H,0,0,D)}else ps(x,u,g[P],w,0,0,D)},custom:function(x,u,g,w){const S=x.context,D=g.implementation;if(!x.transform.projection.unsupportedLayers||!x.transform.projection.unsupportedLayers.includes("custom")||x.terrain&&(x.terrain.renderingToTexture||"offscreen"===x.renderPass)&&g.isLayerDraped(u)){if("offscreen"===x.renderPass){const P=D.prerender;if(P){if(x.setCustomLayerDefaults(),S.setColorMode(x.colorModeForRenderPass()),"globe"===x.transform.projection.name){const F=x.transform.pointMerc;P.call(D,S.gl,x.transform.customLayerMatrix(),x.transform.getProjection(),x.transform.globeToMercatorMatrix(),_.S(x.transform.zoom),[F.x,F.y],x.transform.pixelsPerMeterRatio)}else P.call(D,S.gl,x.transform.customLayerMatrix());S.setDirty(),x.setBaseState()}}else if("translucent"===x.renderPass){if(x.terrain&&x.terrain.renderingToTexture){const F=D.renderToTile;if(F){const U=w[0].canonical,H=new _.L(U.x+w[0].wrap*(1<<U.z),U.y,U.z);S.setDepthMode(Pi.disabled),S.setStencilMode(nn.disabled),S.setColorMode(x.colorModeForRenderPass()),x.setCustomLayerDefaults(),F.call(D,S.gl,H),S.setDirty(),x.setBaseState()}return}x.setCustomLayerDefaults(),S.setColorMode(x.colorModeForRenderPass()),S.setStencilMode(nn.disabled);const P="3d"===D.renderingMode?new Pi(x.context.gl.LEQUAL,Pi.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,Pi.ReadOnly);if(S.setDepthMode(P),"globe"===x.transform.projection.name){const F=x.transform.pointMerc;D.render(S.gl,x.transform.customLayerMatrix(),x.transform.getProjection(),x.transform.globeToMercatorMatrix(),_.S(x.transform.zoom),[F.x,F.y],x.transform.pixelsPerMeterRatio)}else D.render(S.gl,x.transform.customLayerMatrix());S.setDirty(),x.setBaseState(),S.bindFramebuffer.set(null)}}else _.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(x,u,g,w){if("opaque"===x.renderPass)return;const S=g.paint.get("model-opacity");if(0===S)return;const D=g.paint.get("model-cast-shadows");if("shadow"===x.renderPass&&(!D||x.terrain&&S<.65&&g._transitionablePaint._values["model-opacity"].value.expression instanceof _.Z))return;const P=x.shadowRenderer,F=g.paint.get("model-receive-shadows");P&&(P.useNormalOffset=!0,F||(P.enabled=!1));const U=()=>{P&&(P.useNormalOffset=!0,F||(P.enabled=!0))},H=u.getSource();if("light-beam"===x.renderPass&&"batched-model"!==H.type)return;if("vector"===H.type||"geojson"===H.type)return function(se,be,Me,we){const Se=se.transform;if("mercator"!==Se.projection.name)return void _.w(`Drawing 3D models for ${Se.projection.name} projection is not yet implemented`);const pe=Se.getFreeCameraOptions().position;if(!se.modelManager)return;const De=se.modelManager;Me.modelManager=De;const Fe=se.shadowRenderer;if(!Me._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ne=Me._unevaluatedLayout._values["model-id"],je={...Me.layout.get("model-id").parameters};for(const at of we){const Ke=be.getTile(at).getBucket(Me);if(!Ke||Ke.projection.name!==Se.projection.name)continue;const rt=Lx(at,Se);je.zoom=rt;const pt=Ne.possiblyEvaluate(je);if(cv(se,Ke,at),Fs.shadowUniformsInitialized=!1,Fs.useSingleShadowCascade=!!Fe&&0===Fe.getMaxCascadeForTile(at.toUnwrapped()),"shadow"===se.renderPass&&Fe){if(1===se.currentShadowCascade&&Ke.isInsideFirstShadowMapFrustum)continue;const ht=Se.calculatePosMatrix(at.toUnwrapped(),Se.worldSize);if(Fs.tileMatrix.set(ht),Fs.shadowTileMatrix=Float32Array.from(Fe.calculateShadowPassMatrixFromMatrix(ht)),Fs.aabb.min.fill(0),Fs.aabb.max[0]=Fs.aabb.max[1]=_.V,Fs.aabb.max[2]=0,gs(Ke,Fs,se,Me.scope))continue}const Pt=1<<at.canonical.z,Ze=[((pe.x-at.wrap)*Pt-at.canonical.x)*_.V,(pe.y*Pt-at.canonical.y)*_.V,pe.z*Pt*_.V];for(let ht in Ke.instancesPerModel){const ze=Ke.instancesPerModel[ht];ze.features.length>0&&(ht=pt.evaluate(ze.features[0].feature,{}));const Ye=De.getModel(ht,Me.scope);if(Ye&&Ye.uploaded)for(const Mt of Ye.nodes)Ag(se,Me,Mt,ze,Ze,at,Fs)}}}(x,u,g,w),void U();if(!H.loaded())return;if("batched-model"===H.type)return function(se,be,Me,we){Me.resetLayerRenderingStats(se);const Se=se.context,pe=se.transform,De=se.style.fog,Fe=se.shadowRenderer;if("mercator"!==pe.projection.name)return void _.w(`Drawing 3D landmark models for ${pe.projection.name} projection is not yet implemented`);const Ne=se.transform.getFreeCameraOptions().position,je=_.N.scale([],[Ne.x,Ne.y,Ne.z],se.transform.worldSize);_.N.negate(je,je);const at=_.a6.identity([]),Ke=_.cR(pe.center.lat,pe.zoom),rt=_.a6.fromScaling([],[1,1,1/Ke]);_.a6.translate(at,at,je);const pt=Me.paint.get("model-opacity"),Pt=new Pi(Se.gl.LEQUAL,Pi.ReadWrite,se.depthRangeFor3D),Ze=new Pi(Se.gl.LEQUAL,Pi.ReadOnly,se.depthRangeFor3D),ht=new _.bS([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),ze="shadow"===se.renderPass,Ye=ze&&Fe?Fe.getCurrentCascadeFrustum():pe.getFrustum(pe.scaleZoom(pe.worldSize)),Mt=Me.getLayerRenderingStats(),ti=function(Wt,_i){for(const vi of we){const Yi=be.getTile(vi).getBucket(Me);if(!Yi||!Yi.uploaded)continue;let qi=!1;Fe&&(qi=0===Fe.getMaxCascadeForTile(vi.toUnwrapped()));const Xi=pe.calculatePosMatrix(vi.toUnwrapped(),pe.worldSize),Sn=Yi.modelTraits;for(const bn of Yi.getNodesInfo()){if(bn.hiddenByReplacement||!bn.node.meshes)continue;const xn=bn.evaluatedScale,Dn=bn.node;let fr=0;if(se.terrain&&Dn.elevation&&(fr=Dn.elevation*se.terrain.exaggeration()),xn[0]<=1&&xn[1]<=1&&xn[2]<=1&&0===(()=>{const ko=bn.getLocalBounds();return ht.min=[...ko.min],ht.max=[...ko.max],ht.min[2]+=fr,ht.max[2]+=fr,_.N.transformMat4(ht.min,ht.min,Xi),_.N.transformMat4(ht.max,ht.max,Xi),ht})().intersects(Ye))continue;const jr="light-beam"===se.renderPass,Mi=[...Xi];_.a6.translate(Mi,Mi,[(Dn.anchor?Dn.anchor[0]:0)*(xn[0]-1),(Dn.anchor?Dn.anchor[1]:0)*(xn[1]-1),fr]),_.N.exactEquals(xn,_.cT)||_.a6.scale(Mi,Mi,xn),_.a6.multiply(Mi,Mi,Dn.matrix);const Do=_.a6.multiply([],rt,Mi);_.a6.multiply(Do,at,Do);const ar=_.a6.invert([],Do);_.a6.transpose(ar,ar),_.a6.scale(ar,ar,So);const Lr=_.a6.multiply([],pe.expandedFarZProjMatrix,Mi),vr=Sn&_.cV.HasMapboxMeshFeatures,Sr=vr?0:bn.evaluatedRMEA[0][2];for(let ko=0;ko<Dn.meshes.length;++ko){const Yr=Dn.meshes[ko],Zs=ko===Dn.lightMeshIndex;if(Zs){if(!jr&&!se.terrain&&se.shadowRenderer){se.currentLayer<se.firstLightBeamLayer&&(se.firstLightBeamLayer=se.currentLayer);continue}}else if(jr)continue;const ws={defines:[]},Dl=[];if($o(ws.defines,Dl,Yr,se),vr||ws.defines.push("DIFFUSE_SHADED"),qi&&ws.defines.push("SHADOWS_SINGLE_CASCADE"),Mt&&(ze?Mt.numRenderedVerticesInShadowPass+=Yr.vertexArray.length:Mt.numRenderedVerticesInTransparentPass+=Yr.vertexArray.length),ze){ot(Yr,Mi,se,Me);continue}let hd=null;if(De){const nl=op(Mi,se.transform);if(hd=new Float32Array(nl),"globe"!==pe.projection.name){const vc=Yr.aabb.min,lo=Yr.aabb.max,[Xc,Wl]=De.getOpacityForBounds(nl,vc[0],vc[1],lo[0],lo[1]);ws.overrideFog=Xc>=Tr||Wl>=Tr}}const kl=Yr.material;let Ks;kl.occlusionTexture&&kl.occlusionTexture.offsetScale&&(Ks=kl.occlusionTexture.offsetScale,ws.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!ze&&Fe&&(Fe.useNormalOffset=!!Yr.normalBuffer);const ks=se.getOrCreateProgram("model",ws);!ze&&Fe&&Fe.setupShadowsFromMatrix(Mi,ks,Fe.useNormalOffset),se.uploadCommonUniforms(Se,ks,vi.toUnwrapped(),hd);const Ot=kl.pbrMetallicRoughness;Ot.metallicFactor=.9,Ot.roughnessFactor=.5;const Jn=Pu(new Float32Array(Lr),new Float32Array(Do),new Float32Array(ar),se,pt,Ot.baseColorFactor,kl.emissiveFactor,Ot.metallicFactor,Ot.roughnessFactor,kl,Sr,Me,[0,0,0],Ks);ks.draw(se,Se.gl.TRIANGLES,_i&&!Zs?Pt:Ze,nn.disabled,Wt?Zs||pt<1||bn.hasTranslucentParts?$n.alphaBlended:$n.unblended:$n.disabled,rn.backCCW,Jn,Me.id,Yr.vertexBuffer,Yr.indexBuffer,Yr.segments,Me.paint,se.transform.zoom,void 0,Dl)}}}};(function(Wt,_i,vi,Yi){const qi=Wt.terrain?Wt.terrain.exaggeration():0,Xi=Wt.transform.zoom;for(const Sn of Yi){const bn=_i.getTile(Sn).getBucket(vi);bn&&(Wt.conflationActive&&bn.updateReplacement(Sn,Wt.replacementSource),bn.evaluateScale(Wt,vi),Wt.terrain&&qi>0&&bn.elevationUpdate(Wt.terrain,qi,Sn,vi.source),bn.needsReEvaluation(Wt,Xi,vi)&&bn.evaluate(vi))}})(se,be,Me,we),1===pt?ti(!0,!0):(ti(!1,!0),ti(!0,!1))}(x,u,g,w),void U();const X=H.getModels(),K=[],ee=x.transform.getFreeCameraOptions().position,ie=_.N.scale([],[ee.x,ee.y,ee.z],x.transform.worldSize);_.N.negate(ie,ie);const ae=[],ce=[];let me=0;for(const se of X){const be=g.paint.get("model-rotation").constantOr(null),Me=g.paint.get("model-scale").constantOr(null),we=g.paint.get("model-translation").constantOr(null);se.computeModelMatrix(x,be,Me,we,!0,!0,!1);const Se=_.a6.identity([]),pe=_.cR(se.position.lat,x.transform.zoom),De=_.a6.fromScaling([],[1,1,1/pe]);_.a6.translate(Se,Se,ie),K.push({zScaleMatrix:De,negCameraPosMatrix:Se});for(const Fe of se.nodes)Nf(x.transform,Fe,se.matrix,x.transform.expandedFarZProjMatrix,me,ae,ce);me++}if(ae.sort((se,be)=>be.depth-se.depth),"shadow"!==x.renderPass){if(1===S)for(const se of ce)Mg(se,x,g,K[se.modelIndex],nn.disabled,x.colorModeForRenderPass());else{for(const se of ce)Mg(se,x,g,K[se.modelIndex],nn.disabled,$n.disabled);for(const se of ce)Mg(se,x,g,K[se.modelIndex],x.stencilModeFor3D(),x.colorModeForRenderPass());x.resetStencilClippingMasks()}for(const se of ae)Mg(se,x,g,K[se.modelIndex],nn.disabled,x.colorModeForRenderPass());U()}else{for(const se of ce)ot(se.mesh,se.nodeModelMatrix,x,g);for(const se of ae)ot(se.mesh,se.nodeModelMatrix,x,g);U()}}},sp={model:function(x,u,g){const w=x.scope,S=u.getSource();if(!S.loaded())return;if("vector"===S.type||"geojson"===S.type)return void(g.modelManager&&g.modelManager.upload(g,w));if("batched-model"===S.type)return;const D=S.getModels();for(const P of D)P.upload(g.context)},raster:function(x,u,g){const w=u.getSource();if(!(w instanceof Zt&&w.loaded()))return;const S=x.sourceLayer||w.rasterLayerIds&&w.rasterLayerIds[0];if(!S)return;const D=x.paint.get("raster-array-band")||w.getInitialBand(S);if(null==D)return;const P=u.getIds().map(F=>u.getTileByID(F));for(const F of P)F.updateNeeded(S,D)&&w.prepareTile(F,S,D)},"raster-particle":function(x,u,g){const w=u.getSource();if(!(w instanceof Zt&&w.loaded()))return;const S=x.sourceLayer||w.rasterLayerIds&&w.rasterLayerIds[0];if(!S)return;const D=x.paint.get("raster-particle-array-band")||w.getInitialBand(S);if(null==D)return;const P=u.getIds().map(F=>u.getTileByID(F));for(const F of P)F.updateNeeded(S,D)&&w.prepareTile(F,S,D)}};class Lu{constructor(u,g,w,S){this.context=new Qa(u,g),this.transform=w,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=S,this._debugParams={showTerrainProxyTiles:!1},S.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),this.setup(),this.numSublayers=cc.maxUnderzooming+cc.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new _.cX,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new $m(this),this._wireframeDebugCache=new Ur,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(u,g){const w=!!u&&!!u.terrain&&this.transform.projection.supportsTerrain;if(!(w||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new kx(this,u));const S=this._terrain;this.transform.elevation=w?S:null,S.update(u,this.transform,g),this.transform.elevation&&!S.enabled&&(this.transform.elevation=null)}_updateFog(u){const g=u.fog;if(!g||"globe"===this.transform.projection.name||g.getOpacity(this.transform.pitch)<1||g.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[w,S]=g.getFovAdjustedRange(this.transform._fov);if(w>S)return void(this.transform.fogCullDistSq=null);const D=w+.78*(S-w);this.transform.fogCullDistSq=D*D}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(u,g){if(this.width=u*_.f.devicePixelRatio,this.height=g*_.f.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const w of this.style.order)this.style._mergedLayers[w].resize()}setup(){const u=this.context,g=new _.aN;g.emplaceBack(0,0),g.emplaceBack(_.V,0),g.emplaceBack(0,_.V),g.emplaceBack(_.V,_.V),this.tileExtentBuffer=u.createVertexBuffer(g,_.aP.members),this.tileExtentSegments=_.aB.simpleSegment(0,0,4,2);const w=new _.aN;w.emplaceBack(0,0),w.emplaceBack(_.V,0),w.emplaceBack(0,_.V),w.emplaceBack(_.V,_.V),this.debugBuffer=u.createVertexBuffer(w,_.aP.members),this.debugSegments=_.aB.simpleSegment(0,0,4,5);const S=new _.aN;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(S,_.aP.members),this.viewportSegments=_.aB.simpleSegment(0,0,4,2);const D=new _.av;D.emplaceBack(0,0,0,0),D.emplaceBack(_.V,0,_.V,0),D.emplaceBack(0,_.V,0,_.V),D.emplaceBack(_.V,_.V,_.V,_.V),this.mercatorBoundsBuffer=u.createVertexBuffer(D,_.aR.members),this.mercatorBoundsSegments=_.aB.simpleSegment(0,0,4,2);const P=new _.aw;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(P);const F=new _.aO;for(const H of[0,1,3,2,0])F.emplaceBack(H);this.debugIndexBuffer=u.createIndexBuffer(F),this.emptyTexture=new _.T(u,new _.h({width:1,height:1},Uint8Array.of(0,0,0,0)),u.gl.RGBA),this.identityMat=_.a6.create();const U=this.context.gl;this.stencilClearMode=new nn({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(u){return u._makeTileBoundsBuffers(this.context,this.transform.projection),u._tileBoundsBuffer?{tileBoundsBuffer:u._tileBoundsBuffer,tileBoundsIndexBuffer:u._tileBoundsIndexBuffer,tileBoundsSegments:u._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const u=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,u.TRIANGLES,Pi.disabled,this.stencilClearMode,$n.disabled,rn.disabled,Tn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(u,g,w){if(!g||this.currentStencilSource===g.id||!u.isTileClipped()||!w||0===w.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let F=!1;for(const U of w)if(void 0===this._tileClippingMaskIDs[U.key]){F=!0;break}if(!F)return}this.currentStencilSource=g.id;const S=this.context,D=S.gl;this.nextStencilID+w.length>256&&this.clearStencil(),S.setColorMode($n.disabled),S.setDepthMode(Pi.disabled);const P=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const F of w){const U=g.getTile(F),H=this._tileClippingMaskIDs[F.key]=this.nextStencilID++,{tileBoundsBuffer:X,tileBoundsIndexBuffer:K,tileBoundsSegments:ee}=this.getTileBoundsBuffers(U);P.draw(this,D.TRIANGLES,Pi.disabled,new nn({func:D.ALWAYS,mask:0},H,255,D.KEEP,D.KEEP,D.REPLACE),$n.disabled,rn.disabled,Tn(F.projMatrix),"$clipping",X,K,ee)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,g=this.context.gl;return new nn({func:g.NOTEQUAL,mask:255},u,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(u){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(u);const g=this.context.gl;return new nn({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,g.KEEP,g.KEEP,g.REPLACE)}stencilConfigForOverlap(u){const g=this.context.gl,w=u.sort((P,F)=>F.overscaledZ-P.overscaledZ),S=w[w.length-1].overscaledZ,D=w[0].overscaledZ-S+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();const P={};for(let F=0;F<D;F++)P[F+S]=new nn({func:g.GEQUAL,mask:255},F+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=D,[P,w]}return[{[S]:nn.disabled},w]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new $n([u.CONSTANT_COLOR,u.ONE,u.CONSTANT_COLOR,u.ONE],new _.ax(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?$n.unblended:$n.alphaBlended}colorModeForDrapableLayerRenderPass(u){const g=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&"translucent"===this.renderPass?new $n([g.ONE,g.ONE_MINUS_SRC_ALPHA,g.CONSTANT_ALPHA,g.ONE_MINUS_SRC_ALPHA],new _.ax(0,0,0,void 0===u?0:u),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(u,g,w,S=!1){if(!this.opaquePassEnabledForLayer()&&!S)return Pi.disabled;const D=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new Pi(w||this.context.gl.LEQUAL,g,[D,D])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(u,g){this._wireframeDebugCache.update(this.frameCounter),this.style=u,this.options=g;const w=this.style._mergedLayers,S=this.style.order,D=S.map(pe=>w[pe]),P=this.style._mergedSourceCaches;this.imageManager=u.imageManager,this.modelManager=u.modelManager,this.symbolFadeChange=u.placement.symbolFadeChange(_.f.now()),this.imageManager.beginFrame();let F=0,U=!1;for(const pe in P){const De=P[pe];De.used&&(De.prepare(this.context),De.getSource().usedInConflation&&++F)}for(const pe of D)pe.isHidden(this.transform.zoom)||this.prepareLayer(pe);const H={},X={},K={},ee={},ie={};for(const pe in P){const De=P[pe];H[pe]=De.getVisibleCoordinates(),X[pe]=H[pe].slice().reverse(),K[pe]=De.getVisibleCoordinates(!0).reverse(),ee[pe]=De.getShadowCasterCoordinates(),ie[pe]=De.sortCoordinatesByDistance(H[pe])}const ae=pe=>{const De=this.style.getLayerSourceCache(pe);return De&&De.used?De.getSource():null};if(F){const pe=[];for(const De of D)this.layerUsedInConflation(De,ae(De))&&pe.push(De);if(pe&&pe.length>1){const De=[];for(const Fe of pe){const Ne=this.style.getLayerSourceCache(Fe);Ne&&Ne.used&&Ne.getSource().usedInConflation&&De.push({layer:Fe.fqid,cache:Ne})}this.replacementSource.setSources(De),U=!0}}U||this.replacementSource.clear(),this.conflationActive=U,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const pe of D){const De=pe.cutoffRange();if(this.longestCutoffRange=Math.max(De,this.longestCutoffRange),De>0){const Fe=ae(pe);Fe&&(this.minCutoffZoom=Math.max(Fe.minzoom,this.minCutoffZoom)),pe.minzoom&&(this.minCutoffZoom=Math.max(pe.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let pe=0;pe<D.length;pe++)if(D[pe].is3D()){this.opaquePassCutoff=pe;break}const ce=this.style&&this.style.fog;ce?(this._fogVisible=0!==ce.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=ce.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(K),this.opaquePassCutoff=0);const me=this._shadowRenderer;if(me){me.updateShadowParameters(this.transform,this.style.directionalLight);for(const pe in P)for(const De of H[pe]){let Fe={min:0,max:0};this.terrain&&(Fe=this.terrain.getMinMaxForTile(De)||Fe),me.addShadowReceiver(De.toUnwrapped(),Fe.min,Fe.max)}}if("globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new _.cY(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Ji(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!_.cZ(this.context.gl))return;this.renderPass="offscreen";for(const pe of D){const De=u.getLayerSourceCache(pe);if(!pe.hasOffscreenPass()||pe.isHidden(this.transform.zoom))continue;const Fe=De?X[De.id]:void 0;("custom"===pe.type||"raster"===pe.type||"raster-particle"===pe.type||pe.isSky()||Fe&&Fe.length)&&this.renderLayer(this,De,pe,Fe)}this.depthRangeFor3D=[0,1-(D.length+2)*this.numSublayers*this.depthEpsilon];const se=this.terrain;se&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&se.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ee)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const be="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),Me=(()=>{if(g.showOverdrawInspector)return _.ax.black;if(this.style.fog&&this.transform.projection.supportsFog&&!be){const pe=this.style.fog.properties.get("color").toArray01();return new _.ax(...pe)}if(this.style.fog&&this.transform.projection.supportsFog&&be){const pe=this.style.fog.properties.get("space-color").toArray01();return new _.ax(...pe)}return _.ax.transparent})();if(this.context.clear({color:Me,depth:1}),this.clearStencil(),this._showOverdrawInspector=g.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&be&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const pe=D[this.currentLayer],De=u.getLayerSourceCache(pe);if(pe.isSky())continue;const Fe=De?(pe.is3D()?ie:X)[De.id]:void 0;this._renderTileClippingMasks(pe,De,Fe),this.renderLayer(this,De,pe,Fe)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&be&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||_.S(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const pe=D[this.currentLayer],De=u.getLayerSourceCache(pe);pe.isSky()&&this.renderLayer(this,De,pe,De?X[De.id]:void 0)}function we(pe,De){let Fe;return De&&(Fe=("symbol"===pe.type?K:pe.is3D()?ie:X)[De.id]),Fe}if(this.renderPass="translucent","globe"===this.transform.projection.name){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<S.length;){const pe=D[this.currentLayer];if("raster"===pe.type){const De=u.getLayerSourceCache(pe);this.renderLayer(this,De,pe,we(pe,De))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Se=0;for(me&&(Se=me.getShadowCastingLayerCount());this.currentLayer<S.length;){const pe=D[this.currentLayer],De=u.getLayerSourceCache(pe);if(pe.isSky())++this.currentLayer;else if(se&&this.style.isLayerDraped(pe)){if(pe.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=se.renderBatch(this.currentLayer)}else{if(this._renderTileClippingMasks(pe,De,De?H[De.id]:void 0),this.renderLayer(this,De,pe,we(pe,De)),!se&&me&&Se>0&&pe.hasShadowPass()&&0==--Se&&(me.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Fe=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Fe;this.currentLayer++){const Ne=D[this.currentLayer];if(!Ne.hasLightBeamPass())continue;const je=u.getLayerSourceCache(Ne);this.renderLayer(this,je,Ne,je?X[je.id]:void 0)}this.currentLayer=Fe,this.renderPass="translucent"}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let pe=null;D.forEach(De=>{const Fe=u.getLayerSourceCache(De);Fe&&!De.isHidden(this.transform.zoom)&&Fe.getVisibleCoordinates().length&&(!pe||pe.getSource().maxzoom<Fe.getSource().maxzoom)&&(pe=Fe)}),pe&&this.options.showTileBoundaries&&jc.debug(this,pe,pe.getVisibleCoordinates(),_.ax.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&jc.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new _.ax(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(pe){const De=pe.transform.padding;ya(pe,pe.transform.height-(De.top||0),3,tl),ya(pe,De.bottom||0,3,Ou),na(pe,De.left||0,3,ny),na(pe,pe.transform.width-(De.right||0),3,av);const Fe=pe.transform.centerPoint;var Ne,je,at,Ke;qr(Ne=pe,(je=Fe.x)-1,(at=pe.transform.height-Fe.y)-10,2,20,Ke=no),qr(Ne,je-10,at-1,20,2,Ke)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),U||(this.conflationActive=!1)}prepareLayer(u){this.gpuTimingStart(u);const{unsupportedLayers:g}=this.transform.projection,w=!g||!g.includes(u.type);if(sp[u.type]&&(w||this.terrain&&"custom"===u.type)){const S=this.style.getLayerSourceCache(u);sp[u.type](u,S,this)}this.gpuTimingEnd()}renderLayer(u,g,w,S){w.isHidden(this.transform.zoom)||("background"===w.type||"sky"===w.type||"custom"===w.type||"model"===w.type||"raster"===w.type||"raster-particle"===w.type||S&&S.length)&&(this.id=w.id,this.gpuTimingStart(w),(!u.transform.projection.unsupportedLayers||!u.transform.projection.unsupportedLayers.includes(w.type)||u.terrain&&"custom"===w.type)&&jc[w.type](u,g,w,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(u){if(!this.options.gpuTiming)return;const g=this.context.extTimerQuery,w=this.context.gl;let S=this.gpuTimers[u.id];S||(S=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:w.createQuery()}),S.calls++,w.beginQuery(g.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const u=this.context.extTimerQuery,g=this.context.gl,w=g.createQuery();this.deferredRenderGpuTimeQueries.push(w),g.beginQuery(u.TIME_ELAPSED_EXT,w)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const u=this.gpuTimers;return this.gpuTimers={},u}collectDeferredRenderGpuQueries(){const u=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],u}queryGpuTimers(u){const g={};for(const w in u){const S=u[w],D=this.context.extTimerQuery,P=D.getQueryParameter(S.query,this.context.gl.QUERY_RESULT)/1e6;D.deleteQueryEXT(S.query),g[w]=P}return g}queryGpuTimeDeferredRender(u){if(!this.options.gpuTimingDeferredRender)return 0;const g=this.context.extTimerQuery,w=this.context.gl;let S=0;for(const D of u)S+=g.getQueryParameter(D,w.QUERY_RESULT)/1e6,g.deleteQueryEXT(D);return S}translatePosMatrix(u,g,w,S,D){if(!w[0]&&!w[1])return u;const P=D?"map"===S?this.transform.angle:0:"viewport"===S?-this.transform.angle:0;if(P){const H=Math.sin(P),X=Math.cos(P);w=[w[0]*X-w[1]*H,w[0]*H+w[1]*X]}const F=[D?w[0]:_.a3(g,w[0],this.transform.zoom),D?w[1]:_.a3(g,w[1],this.transform.zoom),0],U=new Float32Array(16);return _.a6.translate(U,u,F),U}saveTileTexture(u){const g=u.size[0],w=this._tileTextures[g];w?w.push(u):this._tileTextures[g]=[u]}getTileTexture(u){const g=this._tileTextures[u];return g&&g.length>0?g.pop():null}isPatternMissing(u,g){return null===u||void 0!==u&&!this.imageManager.getPattern(u.toString(),g)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(u,g,w){const S=void 0===w?this.terrain&&this.terrain.renderingToTexture:w,D=this.terrain&&0===this.terrain.exaggeration(),P=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===u||"terrainRaster"===u?(P.push("LIGHTING_3D_MODE"),P.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):S||P.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass?this._shadowMapDebug||P.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?P.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):P.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(P.push("TERRAIN"),this.linearFloatFilteringSupported()&&P.push("TERRAIN_DEM_FLOAT_FORMAT"),D&&P.push("ZERO_EXAGGERATION")),"globe"===this.transform.projection.name&&P.push("GLOBE"),!this._fogVisible||S||void 0!==g&&!g||P.push("FOG","FOG_DITHERING"),S&&P.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&P.push("OVERDRAW_INSPECTOR"),P}getOrCreateProgram(u,g){this.cache=this.cache||{};const w=g&&g.defines||[],S=g&&g.config,D=g&&g.transformFeedback,P=this.currentGlobalDefines(u,g&&g.overrideFog,g&&g.overrideRtt).concat(w),F=Zb.cacheKey(vg[u],u,P,S);return this.cache[F]||(this.cache[F]=new Zb(this.context,u,vg[u],S,Px[u],P,D)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(u,g){if(this.style.enable3dLights()){const w=this.style.directionalLight,S=this.style.ambientLight;if(w&&S){const D=((P,F)=>{const U=P.properties.get("direction"),H=P.properties.get("color").toArray01(),X=P.properties.get("intensity"),K=F.properties.get("color").toArray01(),ee=F.properties.get("intensity"),ie=[U.x,U.y,U.z],ae=_.cn(K,ee),ce=_.cn(H,X);return{u_lighting_ambient_color:ae,u_lighting_directional_dir:ie,u_lighting_directional_color:ce,u_ground_radiance:tv(ie,ce,ae)}})(w,S);g.setLightsUniformValues(u,D)}}}uploadCommonUniforms(u,g,w,S,D){if(this.uploadCommonLightUniforms(u,g),this.terrain&&this.terrain.renderingToTexture)return;const P=this.style.fog;if(P){const F=P.getOpacity(this.transform.pitch),U=((H,X,K,ee,ie,ae,ce,me,se,be,Me,we)=>{const Se=H.transform,pe=X.properties.get("color").toArray01();pe[3]=ee;const De=H.frameCounter/1e3%1,[Fe,Ne]=X.properties.get("vertical-range");return{u_fog_matrix:K?Se.calculateFogTileMatrix(K):we||H.identityMat,u_fog_range:X.getFovAdjustedRange(Se._fov),u_fog_color:pe,u_fog_horizon_blend:X.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Fe,Ne),Ne],u_fog_temporal_offset:De,u_frustum_tl:ie,u_frustum_tr:ae,u_frustum_br:ce,u_frustum_bl:me,u_globe_pos:se,u_globe_radius:be,u_viewport:Me,u_globe_transition:_.S(Se.zoom),u_is_globe:+("globe"===Se.projection.name)}})(this,P,w,F,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*_.f.devicePixelRatio,this.transform.height*_.f.devicePixelRatio],S);g.setFogUniformValues(u,U)}D&&g.setCutoffUniformValues(u,D.uniformValues)}setTileLoadedFlag(u){this.tileLoaded=u}saveCanvasCopy(){const u=this.canvasCopy();u&&(this.frameCopies.push(u),this.tileLoaded=!1)}canvasCopy(){const u=this.context.gl,g=u.createTexture();return u.bindTexture(u.TEXTURE_2D,g),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,u.drawingBufferWidth,u.drawingBufferHeight,0),g}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const u=this.style&&this.style.fog;return!!u&&0!==u.getOpacity(this.transform.pitch)}getBackgroundTiles(){const u=this._backgroundTiles,g=this._backgroundTiles={},w=this.transform.coveringTiles({tileSize:512});for(const S of w)g[S.key]=u[S.key]||new Ul(S,512,this.transform.tileZoom,this);return g}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(u,g){return!(!u.is3D()||u.minzoom&&u.minzoom>this.transform.zoom||"building"!==u.sourceLayer&&(!g||"batched-model"!==g.type))}isTileAffectedByFog(u){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let g=this._cachedTileFogOpacities[u.key];return g||(this._cachedTileFogOpacities[u.key]=g=this.style.fog.getOpacityForTile(u)),g[0]>=Tr||g[1]>=Tr}}function ld(x,u){let g=!1,w=null;const S=()=>{w=null,g&&(x(),w=setTimeout(S,u),g=!1)};return()=>(g=!0,w||S(),w)}class Oo{constructor(u){this._hashName=u&&encodeURIComponent(u),_.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ld(this._updateHashUnthrottled.bind(this),300)}addTo(u){return this._map=u,window.addEventListener("hashchange",this._onHashChange,!1),u.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const u=this._map;if(!u)return"";const g=xa(u);if(this._hashName){const w=this._hashName;let S=!1;const D=location.hash.slice(1).split("&").map(P=>{const F=P.split("=")[0];return F===w?(S=!0,`${F}=${g}`):P}).filter(P=>P);return S||D.push(`${w}=${g}`),`#${D.join("&")}`}return`#${g}`}_getCurrentHash(){const u=location.hash.replace("#","");if(this._hashName){let g;return u.split("&").map(w=>w.split("=")).forEach(w=>{w[0]===this._hashName&&(g=w)}),(g&&g[1]||"").split("/")}return u.split("/")}_onHashChange(){const u=this._map;if(!u)return!1;const g=this._getCurrentHash();if(g.length>=3&&!g.some(w=>isNaN(w))){const w=u.dragRotate.isEnabled()&&u.touchZoomRotate.isEnabled()?+(g[3]||0):u.getBearing();return u.jumpTo({center:[+g[2],+g[1]],zoom:+g[0],bearing:w,pitch:+(g[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function xa(x,u){const g=x.getCenter(),w=Math.round(100*x.getZoom())/100,S=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),D=Math.pow(10,S),P=Math.round(g.lng*D)/D,F=Math.round(g.lat*D)/D,U=x.getBearing(),H=x.getPitch();let X=u?`/${P}/${F}/${w}`:`${w}/${F}/${P}`;return(U||H)&&(X+="/"+Math.round(10*U)/10),H&&(X+=`/${Math.round(H)}`),X}const Bf={linearity:.3,easing:_.c_(0,0,.3,1)},Tl=_.e({deceleration:2500,maxSpeed:1400},Bf),dv=_.e({deceleration:20,maxSpeed:1400},Bf),Vf=_.e({deceleration:1e3,maxSpeed:360},Bf),vo=_.e({deceleration:1e3,maxSpeed:90},Bf);class Ir{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:_.f.now(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,g=_.f.now();for(;u.length>0&&g-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const g={zoom:0,bearing:0,pitch:0,pan:new _.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:D}of this._inertiaBuffer)g.zoom+=D.zoomDelta||0,g.bearing+=D.bearingDelta||0,g.pitch+=D.pitchDelta||0,D.panDelta&&g.pan._add(D.panDelta),D.around&&(g.around=D.around),D.pinchAround&&(g.pinchAround=D.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(g.pan.mag()){const D=dn(g.pan.mag(),w,_.e({},Tl,u||{}));S.offset=g.pan.mult(D.amount/g.pan.mag()),S.center=this._map.transform.center,Gc(S,D)}if(g.zoom){const D=dn(g.zoom,w,dv);S.zoom=this._map.transform.zoom+D.amount,Gc(S,D)}if(g.bearing){const D=dn(g.bearing,w,Vf);S.bearing=this._map.transform.bearing+_.aa(D.amount,-179,179),Gc(S,D)}if(g.pitch){const D=dn(g.pitch,w,vo);S.pitch=this._map.transform.pitch+D.amount,Gc(S,D)}if(S.zoom||S.bearing){const D=void 0===g.pinchAround?g.around:g.pinchAround;S.around=D?this._map.unproject(D):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Gc(x,u){(!x.duration||x.duration<u.duration)&&(x.duration=u.duration,x.easing=u.easing)}function dn(x,u,g){const{maxSpeed:w,linearity:S,deceleration:D}=g,P=_.aa(x*S/(u/1e3),-w,w),F=Math.abs(P)/(D*S);return{easing:g.easing,duration:1e3*F,amount:P*(F/2)}}class il extends _.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w,S={}){const D=Di(g.getCanvasContainer(),w),P=g.unproject(D);super(u,_.e({point:D,lngLat:P,originalEvent:w},S)),this._defaultPrevented=!1,this.target=g}}class Hc extends _.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w){const S="touchend"===u?w.changedTouches:w.touches,D=ki(g.getCanvasContainer(),S),P=D.map(U=>g.unproject(U)),F=D.reduce((U,H,X,K)=>U.add(H.div(K.length)),new _.P(0,0));super(u,{points:D,point:F,lngLats:P,lngLat:g.unproject(F),originalEvent:w}),this._defaultPrevented=!1}}class _s extends _.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,g,w){super(u,{originalEvent:w}),this._defaultPrevented=!1}}class Dg{constructor(u,g){this._map=u,this._clickTolerance=g.clickTolerance}reset(){this._mousedownPos=void 0}wheel(u){return this._firePreventable(new _s(u.type,this._map,u))}mousedown(u,g){return this._mousedownPos=g,this._firePreventable(new il(u.type,this._map,u))}mouseup(u){this._map.fire(new il(u.type,this._map,u))}preclick(u){const g=_.e({},u);g.type="preclick",this._map.fire(new il(g.type,this._map,g))}click(u,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||(this.preclick(u),this._map.fire(new il(u.type,this._map,u)))}dblclick(u){return this._firePreventable(new il(u.type,this._map,u))}mouseover(u){this._map.fire(new il(u.type,this._map,u))}mouseout(u){this._map.fire(new il(u.type,this._map,u))}touchstart(u){return this._firePreventable(new Hc(u.type,this._map,u))}touchmove(u){this._map.fire(new Hc(u.type,this._map,u))}touchend(u){this._map.fire(new Hc(u.type,this._map,u))}touchcancel(u){this._map.fire(new Hc(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fu{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(u){this._map.fire(new il(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new il("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new il(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _c{constructor(u,g){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,g){this.isEnabled()&&u.shiftKey&&0===u.button&&(ji(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(u,g){if(!this._active)return;const w=g,S=this._startPos,D=this._lastPos;if(!S||!D||D.equals(w)||!this._box&&w.dist(S)<this._clickTolerance)return;this._lastPos=w,this._box||(this._box=Kt("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));const P=Math.min(S.x,w.x),F=Math.max(S.x,w.x),U=Math.min(S.y,w.y),H=Math.max(S.y,w.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${U}px)`,this._box.style.width=F-P+"px",this._box.style.height=H-U+"px")})}mouseupWindow(u,g){if(!this._active)return;const w=this._startPos,S=g;if(w&&0===u.button){if(this.reset(),bi(),w.x!==S.x||w.y!==S.y)return this._map.fire(new _.b("boxzoomend",{originalEvent:u})),{cameraAnimation:D=>D.fitScreenCoordinates(w,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",u)}}keydown(u){this._active&&27===u.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",u))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),un(),delete this._startPos,delete this._lastPos}_fireEvent(u,g){return this._map.fire(new _.b(u,{originalEvent:g}))}}function zf(x,u){const g={};for(let w=0;w<x.length;w++)g[x[w].identifier]=u[w];return g}class Uf{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(u,g,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=u.timeStamp),w.length===this.numTouches&&(this.centroid=function(S){const D=new _.P(0,0);for(const P of S)D._add(P);return D.div(S.length)}(g),this.touches=zf(w,g)))}touchmove(u,g,w){if(this.aborted||!this.centroid)return;const S=zf(w,g);for(const D in this.touches){const P=S[D];(!P||P.dist(this.touches[D])>30)&&(this.aborted=!0)}}touchend(u,g,w){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),0===w.length){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class jf{constructor(u){this.singleTap=new Uf(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(u,g,w){this.singleTap.touchstart(u,g,w)}touchmove(u,g,w){this.singleTap.touchmove(u,g,w)}touchend(u,g,w){const S=this.singleTap.touchend(u,g,w);if(S){const D=u.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(S)<30;if(D&&P||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class kg{constructor(){this._zoomIn=new jf({numTouches:1,numTaps:2}),this._zoomOut=new jf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,g,w){this._zoomIn.touchstart(u,g,w),this._zoomOut.touchstart(u,g,w)}touchmove(u,g,w){this._zoomIn.touchmove(u,g,w),this._zoomOut.touchmove(u,g,w)}touchend(u,g,w){const S=this._zoomIn.touchend(u,g,w),D=this._zoomOut.touchend(u,g,w);return S?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(S)},{originalEvent:u})}):D?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(D)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const ap={0:1,2:2};class $c{constructor(u){this.reset(),this._clickTolerance=u.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(u,g){return!1}_move(u,g){return{}}mousedown(u,g){if(this._lastPoint)return;const w=Ki(u);this._correctButton(u,w)&&(this._lastPoint=g,this._eventButton=w)}mousemoveWindow(u,g){const w=this._lastPoint;if(w)if(u.preventDefault(),null!=this._eventButton&&function(S,D){const P=ap[D];return void 0===S.buttons||(S.buttons&P)!==P}(u,this._eventButton))this.reset();else if(this._moved||!(g.dist(w)<this._clickTolerance))return this._moved=!0,this._lastPoint=g,this._move(w,g)}mouseupWindow(u){this._lastPoint&&Ki(u)===this._eventButton&&(this._moved&&bi(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xh extends $c{mousedown(u,g){super.mousedown(u,g),this._lastPoint&&(this._active=!0)}_correctButton(u,g){return 0===g&&!u.ctrlKey}_move(u,g){return{around:g,panDelta:g.sub(u)}}}class cd extends $c{_correctButton(u,g){return 0===g&&u.ctrlKey||2===g}_move(u,g){const w=.8*(g.x-u.x);if(w)return this._active=!0,{bearingDelta:w}}contextmenu(u){u.preventDefault()}}class Ko extends $c{_correctButton(u,g){return 0===g&&u.ctrlKey||2===g}_move(u,g){const w=-.5*(g.y-u.y);if(w)return this._active=!0,{pitchDelta:w}}contextmenu(u){u.preventDefault()}}class Fi{constructor(u,g){this._map=u,this._el=u.getCanvasContainer(),this._minTouches=1,this._clickTolerance=g.clickTolerance||1,this.reset(),_.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new _.P(0,0)}touchstart(u,g,w){return this._calculateTransform(u,g,w)}touchmove(u,g,w){if(this._active&&!(w.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===w.length&&!_.c$())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return u.cancelable&&u.preventDefault(),this._calculateTransform(u,g,w)}}touchend(u,g,w){this._calculateTransform(u,g,w),this._active&&w.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,g,w){w.length>0&&(this._active=!0);const S=zf(w,g),D=new _.P(0,0),P=new _.P(0,0);let F=0;for(const H in S){const X=S[H],K=this._touches[H];K&&(D._add(X),P._add(X.sub(K)),F++,S[H]=X)}if(this._touches=S,F<this._minTouches||!P.mag())return;const U=P.div(F);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:D.div(F),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Kt("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class ln{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(u){}_move(u,g,w){return{}}touchstart(u,g,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([g[0],g[1]]))}touchmove(u,g,w){const S=this._firstTwoTouches;if(!S)return;u.preventDefault();const[D,P]=S,F=vs(w,g,D),U=vs(w,g,P);if(!F||!U)return;const H=this._aroundCenter?null:F.add(U).div(2);return this._move([F,U],H,u)}touchend(u,g,w){if(!this._firstTwoTouches)return;const[S,D]=this._firstTwoTouches,P=vs(w,g,S),F=vs(w,g,D);P&&F||(this._active&&bi(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&"center"===u.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function vs(x,u,g){for(let w=0;w<x.length;w++)if(x[w].identifier===g)return u[w]}function Sl(x,u){return Math.log(x/u)/Math.LN2}class Ys extends ln{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,g){const w=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(Sl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sl(this._distance,w),pinchAround:g}}}function Ns(x,u){return 180*x.angleWith(u)/Math.PI}class eu extends ln{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,g){const w=this._vector;if(this._vector=u[0].sub(u[1]),w&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ns(this._vector,w),pinchAround:g}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const g=25/(Math.PI*this._minDiameter)*360,w=this._startVector;if(!w)return!1;const S=Ns(u,w);return Math.abs(S)<g}}function Ao(x){return Math.abs(x.y)>Math.abs(x.x)}class xs extends ln{constructor(u){super(),this._map=u}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(u){this._lastPoints=u,Ao(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,g,w){const S=this._lastPoints;if(!S)return;const D=u[0].sub(S[0]),P=u[1].sub(S[1]);return this._map._cooperativeGestures&&!_.c$()&&w.touches.length<3||(this._valid=this.gestureBeginsVertically(D,P,w.timeStamp),!this._valid)?void 0:(this._lastPoints=u,this._active=!0,{pitchDelta:(D.y+P.y)/2*-.5})}gestureBeginsVertically(u,g,w){if(void 0!==this._valid)return this._valid;const S=u.mag()>=2,D=g.mag()>=2;if(!S&&!D)return;if(!S||!D)return null==this._firstMove&&(this._firstMove=w),w-this._firstMove<100&&void 0;const P=u.y>0==g.y>0;return Ao(u)&&Ao(g)&&P}}const Ha={panStep:100,bearingStep:15,pitchStep:10};class _r{constructor(){const u=Ha;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let g=0,w=0,S=0,D=0,P=0;switch(u.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:u.shiftKey?w=-1:(u.preventDefault(),D=-1);break;case 39:u.shiftKey?w=1:(u.preventDefault(),D=1);break;case 38:u.shiftKey?S=1:(u.preventDefault(),P=-1);break;case 40:u.shiftKey?S=-1:(u.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(w=0,S=0),{cameraAnimation:F=>{const U=F.getZoom();F.easeTo({duration:300,easeId:"keyboardHandler",easing:Nu,zoom:g?Math.round(U)+g*(u.shiftKey?2:1):U,bearing:F.getBearing()+w*this._bearingStep,pitch:F.getPitch()+S*this._pitchStep,offset:[-D*this._panStep,-P*this._panStep],center:F.getCenter()},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Nu(x){return x*(2-x)}const Gf=4.000244140625,dd=1/450;class us{constructor(u,g){this._map=u,this._el=u.getCanvasContainer(),this._handler=g,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=dd,_.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&"center"===u.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(u){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(u.ctrlKey||u.metaKey||this.isZooming()||_.c$()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let g=u.deltaMode===WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const w=_.f.now(),S=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,0!==g&&g%Gf==0?this._type="wheel":0!==g&&Math.abs(g)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(S*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),u.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=u,this._delta-=g,this._active||this._start(u)),u.preventDefault()}_onTimeout(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=Di(this._el,u);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:g,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._map.transform;"wheel"===this._type&&u.projection.wrap&&(u._center.lng>=180||u._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const g=()=>u._terrainEnabled()&&this._aroundCoord?u.computeZoomRelativeTo(this._aroundCoord):u.zoom;if(0!==this._delta){const H="wheel"===this._type&&Math.abs(this._delta)>Gf?this._wheelZoomRate:this._defaultZoomRate;let X=2/(1+Math.exp(-Math.abs(this._delta*H)));this._delta<0&&0!==X&&(X=1/X);const K=g(),ee=Math.pow(2,K),ie="number"==typeof this._targetZoom?u.zoomScale(this._targetZoom):ee;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(ie*X))),"wheel"===this._type&&(this._startZoom=K,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const w="number"==typeof this._targetZoom?this._targetZoom:g(),S=this._startZoom,D=this._easing;let P,F=!1;if("wheel"===this._type&&S&&D){const H=Math.min((_.f.now()-this._lastWheelEventTime)/200,1),X=D(H);P=_.U(S,w,X),H<1?this._frameId||(this._frameId=!0):F=!0}else P=w,F=!0;this._active=!0,F&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let U=P-g();return U*this._lastDelta<0&&(U=0),{noInertia:!0,needsRenderFrame:!F,zoomDelta:U,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let g=_.d0;if(this._prevEase){const w=this._prevEase,S=(_.f.now()-w.start)/w.duration,D=w.easing(S+.01)-w.easing(S),P=.27/Math.sqrt(D*D+1e-4)*.01,F=Math.sqrt(.0729-P*P);g=_.c_(P,F,.25,1)}return this._prevEase={start:_.f.now(),duration:u,easing:g},g}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Kt("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Bu{constructor(u,g){this._clickZoom=u,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Vu{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(u,g){return u.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:w.getZoom()+(u.shiftKey?-1:1),around:w.unproject(g)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ud{constructor(){this._tap=new jf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(u,g,w){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?w.length>0&&(this._swipePoint=g[0],this._swipeTouch=w[0].identifier):this._tap.touchstart(u,g,w))}touchmove(u,g,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const S=g[0],D=S.y-this._swipePoint.y;return this._swipePoint=S,u.preventDefault(),this._active=!0,{zoomDelta:D/128}}}else this._tap.touchmove(u,g,w)}touchend(u,g,w){this._tapTime?this._swipePoint&&0===w.length&&this.reset():this._tap.touchend(u,g,w)&&(this._tapTime=u.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wh{constructor(u,g,w){this._el=u,this._mousePan=g,this._touchPan=w}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class uv{constructor(u,g,w){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=g,this._mousePitch=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class tu{constructor(u,g,w,S){this._el=u,this._touchZoom=g,this._touchRotate=w,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ch=x=>x.zoom||x.drag||x.pitch||x.rotate;class Ml extends _.b{}class sr{constructor(){this.constants=[1,1,.01],this.radius=0}setup(u,g){const w=_.N.sub([],g,u);this.radius=_.N.length(w[2]<0?_.N.div([],w,this.constants):[w[0],w[1],0])}projectRay(u){_.N.div(u,u,this.constants),_.N.normalize(u,u),_.N.mul(u,u,this.constants);const g=_.N.scale([],u,this.radius);if(g[2]>0){const w=_.N.scale([],[0,0,1],_.N.dot(g,[0,0,1])),S=_.N.scale([],_.N.normalize([],[g[0],g[1],0]),this.radius),D=_.N.add([],g,_.N.scale([],_.N.sub([],_.N.add([],S,w),g),2));g[0]=D[0],g[1]=D[1]}return g}}function Eh(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}class lp{constructor(u,g){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ir(u),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new sr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(g),_.aY(["handleEvent","handleWindowEvent"],this);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,D,P]of this._listeners){const F=S===document?this.handleWindowEvent:this.handleEvent;S.addEventListener(D,F,P)}}destroy(){for(const[u,g,w]of this._listeners){const S=u===document?this.handleWindowEvent:this.handleEvent;u.removeEventListener(g,S,w)}}_addDefaultHandlers(u){const g=this._map,w=g.getCanvasContainer();this._add("mapEvent",new Dg(g,u));const S=g.boxZoom=new _c(g,u);this._add("boxZoom",S);const D=new kg,P=new Vu;g.doubleClickZoom=new Bu(P,D),this._add("tapZoom",D),this._add("clickZoom",P);const F=new ud;this._add("tapDragZoom",F);const U=g.touchPitch=new xs(g);this._add("touchPitch",U);const H=new cd(u),X=new Ko(u);g.dragRotate=new uv(u,H,X),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",X,["mouseRotate"]);const K=new xh(u),ee=new Fi(g,u);g.dragPan=new wh(w,K,ee),this._add("mousePan",K),this._add("touchPan",ee,["touchZoom","touchRotate"]);const ie=new eu,ae=new Ys;g.touchZoomRotate=new tu(w,ae,ie,F),this._add("touchRotate",ie,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Fu(g));const ce=g.scrollZoom=new us(g,this);this._add("scrollZoom",ce,["mousePan"]);const me=g.keyboard=new _r;this._add("keyboard",me);for(const se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])u.interactive&&u[se]&&g[se].enable(u[se])}_add(u,g,w){this._handlers.push({handlerName:u,handler:g,allowed:w}),this._handlersById[u]=g}stop(u){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ch(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(u,g,w){for(const S in u)if(S!==w&&(!g||g.indexOf(S)<0))return!0;return!1}handleWindowEvent(u){this.handleEvent(u,`${u.type}Window`)}_getMapTouches(u){const g=[];for(const w of u)this._el.contains(w.target)&&g.push(w);return g}handleEvent(u,g){this._updatingCamera=!0;const w="renderFrame"===u.type,S=w?void 0:u,D={needsRenderFrame:!1},P={},F={},U=u.touches?this._getMapTouches(u.touches):void 0,H=U?ki(this._el,U):w?void 0:Di(this._el,u);for(const{handlerName:ee,handler:ie,allowed:ae}of this._handlers){if(!ie.isEnabled())continue;let ce;this._blockedByActive(F,ae,ee)?ie.reset():ie[g||u.type]&&(ce=ie[g||u.type](u,H,U),this.mergeHandlerResult(D,P,ce,ee,S),ce&&ce.needsRenderFrame&&this._triggerRenderFrame()),(ce||ie.isActive())&&(F[ee]=ie)}const X={};for(const ee in this._previousActiveHandlers)F[ee]||(X[ee]=S);this._previousActiveHandlers=F,(Object.keys(X).length||Eh(D))&&(this._changes.push([D,P,X]),this._triggerRenderFrame()),(Object.keys(F).length||Eh(D))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=D;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))}mergeHandlerResult(u,g,w,S,D){if(!w)return;_.e(u,w);const P={handlerName:S,originalEvent:w.originalEvent||D};void 0!==w.zoomDelta&&(g.zoom=P),void 0!==w.panDelta&&(g.drag=P),void 0!==w.pitchDelta&&(g.pitch=P),void 0!==w.bearingDelta&&(g.rotate=P)}_applyChanges(){const u={},g={},w={};for(const[S,D,P]of this._changes)S.panDelta&&(u.panDelta=(u.panDelta||new _.P(0,0))._add(S.panDelta)),S.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+S.pitchDelta),void 0!==S.around&&(u.around=S.around),void 0!==S.aroundCoord&&(u.aroundCoord=S.aroundCoord),void 0!==S.pinchAround&&(u.pinchAround=S.pinchAround),S.noInertia&&(u.noInertia=S.noInertia),_.e(g,D),_.e(w,P);this._updateMapTransform(u,g,w),this._changes=[]}_updateMapTransform(u,g,w){const S=this._map,D=S.transform,P=be=>[be.x,be.y,be.z];if((()=>{const Me=this._eventsInProgress.drag;return Me&&!this._handlersById[Me.handlerName].isActive()})()&&!Eh(u)){const be=D.zoom;D.cameraElevationReference="sea",null!=this._originalZoom&&D._orthographicProjectionAtLowPitch&&"globe"!==D.projection.name&&0===D.pitch?(D.cameraElevationReference="ground",D.zoom=this._originalZoom):(D.recenterOnTerrain(),D.cameraElevationReference="ground"),be!==D.zoom&&this._map._update(!0)}if(D._isCameraConstrained&&S._stop(!0),!Eh(u))return void this._fireEvents(g,w,!0);let{panDelta:F,zoomDelta:U,bearingDelta:H,pitchDelta:X,around:K,aroundCoord:ee,pinchAround:ie}=u;D._isCameraConstrained&&(U>0&&(U=0),D._isCameraConstrained=!1),void 0!==ie&&(K=ie),(U||(()=>g.drag&&!this._eventsInProgress.drag)())&&K&&(this._dragOrigin=P(D.pointCoordinate3D(K)),this._originalZoom=D.zoom,this._trackingEllipsoid.setup(D._camera.position,this._dragOrigin)),D.cameraElevationReference="sea",S._stop(!0),K=K||S.transform.centerPoint,H&&(D.bearing+=H),X&&(D.pitch+=X),D._updateCameraState();const ae=[0,0,0];if(F)if("mercator"===D.projection.name){const be=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(K).dir),Me=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(K.sub(F)).dir);ae[0]=Me[0]-be[0],ae[1]=Me[1]-be[1]}else{const be=D.pointCoordinate(K);if("globe"===D.projection.name){F=F.rotate(-D.angle);const Me=D._pixelsPerMercatorPixel/D.worldSize;ae[0]=-F.x*_.d1(_.au(be.y))*Me,ae[1]=-F.y*_.d1(D.center.lat)*Me}else{const Me=D.pointCoordinate(K.sub(F));be&&Me&&(ae[0]=Me.x-be.x,ae[1]=Me.y-be.y)}}const ce=D.zoom,me=[0,0,0];if(U){const be=P(ee||D.pointCoordinate3D(K)),Me={dir:_.N.normalize([],_.N.sub([],be,D._camera.position))};if(Me.dir[2]<0){const we=D.zoomDeltaToMovement(be,U);_.N.scale(me,Me.dir,we)}}const se=_.N.add(ae,ae,me);D._translateCameraConstrained(se),U&&Math.abs(D.zoom-ce)>1e-4&&D.recenterOnTerrain(),D.cameraElevationReference="ground",this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(g,w,!0)}_fireEvents(u,g,w){const S=Ch(this._eventsInProgress),D=Ch(u),P={};for(const X in u){const{originalEvent:K}=u[X];this._eventsInProgress[X]||(P[`${X}start`]=K),this._eventsInProgress[X]=u[X]}!S&&D&&this._fireEvent("movestart",D.originalEvent);for(const X in P)this._fireEvent(X,P[X]);D&&this._fireEvent("move",D.originalEvent);for(const X in u){const{originalEvent:K}=u[X];this._fireEvent(X,K)}const F={};let U;for(const X in this._eventsInProgress){const{handlerName:K,originalEvent:ee}=this._eventsInProgress[X];this._handlersById[K].isActive()||(delete this._eventsInProgress[X],U=g[K]||ee,F[`${X}end`]=U)}for(const X in F)this._fireEvent(X,F[X]);const H=Ch(this._eventsInProgress);if(w&&(S||D)&&!H){this._updatingCamera=!0;const X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=ee=>0!==ee&&-this._bearingSnap<ee&&ee<this._bearingSnap;X?(K(X.bearing||this._map.getBearing())&&(X.bearing=0),this._map.easeTo(X,{originalEvent:U})):(this._map.fire(new _.b("moveend",{originalEvent:U})),K(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(u,g){this._map.fire(new _.b(u,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(u=>{this._frameId=void 0,this.handleEvent(new Ml("renderFrame",{timeStamp:u})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Wc="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Wo extends _.E{constructor(u,g){super(),this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=g.bearingSnap,this._respectPrefersReducedMotion=!1!==g.respectPrefersReducedMotion,_.aY(["_renderFrameCallback"],this)}getCenter(){return new _.bn(this.transform.center.lng,this.transform.center.lat)}setCenter(u,g){return this.jumpTo({center:u},g)}panBy(u,g,w){return u=_.P.convert(u).mult(-1),this.panTo(this.transform.center,_.e({offset:u},g),w)}panTo(u,g,w){return this.easeTo(_.e({center:u},g),w)}getZoom(){return this.transform.zoom}setZoom(u,g){return this.jumpTo({zoom:u},g),this}zoomTo(u,g,w){return this.easeTo(_.e({zoom:u},g),w)}zoomIn(u,g){return this.zoomTo(this.getZoom()+1,u,g),this}zoomOut(u,g){return this.zoomTo(this.getZoom()-1,u,g),this}getBearing(){return this.transform.bearing}setBearing(u,g){return this.jumpTo({bearing:u},g),this}getPadding(){return this.transform.padding}setPadding(u,g){return this.jumpTo({padding:u},g),this}rotateTo(u,g,w){return this.easeTo(_.e({bearing:u},g),w)}resetNorth(u,g){return this.rotateTo(0,_.e({duration:1e3},u),g),this}resetNorthPitch(u,g){return this.easeTo(_.e({bearing:0,pitch:0,duration:1e3},u),g),this}snapToNorth(u,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,g):this}getPitch(){return this.transform.pitch}setPitch(u,g){return this.jumpTo({pitch:u},g),this}cameraForBounds(u,g){u=_.ad.convert(u);const w=g&&g.bearing||0,S=g&&g.pitch||0,D=u.getNorthWest(),P=u.getSouthEast();return this._cameraForBounds(this.transform,D,P,w,S,g)}_extendCameraOptions(u){const g={top:0,bottom:0,right:0,left:0};if("number"==typeof(u=_.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding){const w=u.padding;u.padding={top:w,bottom:w,right:w,left:w}}return u.padding=_.e(g,u.padding),u}_minimumAABBFrustumDistance(u,g){const w=g.max[0]-g.min[0],S=g.max[1]-g.min[1];return w/S>u.aspect?w/(2*Math.tan(.5*u.fovX)*u.aspect):S/(2*Math.tan(.5*u.fovY)*u.aspect)}_cameraForBoundsOnGlobe(u,g,w,S,D,P){const F=u.clone(),U=this._extendCameraOptions(P);F.bearing=S,F.pitch=D;const H=_.bn.convert(g),X=_.bn.convert(w),K=.5*(H.lat+X.lat),ee=.5*(H.lng+X.lng),ie=_.d2(K,ee),ae=_.N.normalize([],ie),ce=_.N.normalize([],_.N.cross([],ae,[0,1,0])),me=_.N.cross([],ce,ae),se=[ce[0],ce[1],ce[2],0,me[0],me[1],me[2],0,ae[0],ae[1],ae[2],0,0,0,0,1],be=[ie,_.d2(H.lat,H.lng),_.d2(X.lat,H.lng),_.d2(X.lat,X.lng),_.d2(H.lat,X.lng),_.d2(K,H.lng),_.d2(K,X.lng),_.d2(H.lat,ee),_.d2(X.lat,ee)];let Me=_.bS.fromPoints(be.map(Ye=>[_.N.dot(ce,Ye),_.N.dot(me,Ye),_.N.dot(ae,Ye)]));const we=_.N.transformMat4([],Me.center,se);0===_.N.squaredLength(we)&&_.N.set(we,0,0,1),_.N.normalize(we,we),_.N.scale(we,we,_.ab),F.center=_.d3(we);const Se=F.getWorldToCameraMatrix(),pe=_.a6.invert(new Float64Array(16),Se);Me=_.bS.applyTransform(Me,_.a6.multiply([],Se,se)),_.N.transformMat4(we,we,Se);const De=.5*(Me.max[2]-Me.min[2]),Fe=this._minimumAABBFrustumDistance(F,Me),Ne=_.N.scale([],[0,0,1],De),je=_.N.add(Ne,we,Ne),at=Fe+(0===F.pitch?0:_.N.distance(we,je)),Ke=F.globeCenterInViewSpace,rt=_.N.sub([],we,[Ke[0],Ke[1],Ke[2]]);_.N.normalize(rt,rt),_.N.scale(rt,rt,at);const pt=_.N.add([],we,rt);_.N.transformMat4(pt,pt,pe);const Pt=_.d4/_.ab,Ze=_.N.length(pt),ht=_.bl(Math.max(Ze*Pt-_.d4,Number.EPSILON),0),ze=Math.min(F.zoomFromMercatorZAdjusted(ht),U.maxZoom);return ze>.5*(_.bG+_.bx)?(F.setProjection({name:"mercator"}),F.zoom=ze,this._cameraForBounds(F,g,w,S,D,P)):{center:F.center,zoom:ze,bearing:S,pitch:D}}queryTerrainElevation(u,g){const w=this.transform.elevation;return w?(g=_.e({},{exaggerated:!0},g),w.getAtPoint(_.L.fromLngLat(u),null,g.exaggerated)):null}_cameraForBounds(u,g,w,S,D,P){if("globe"===u.projection.name)return this._cameraForBoundsOnGlobe(u,g,w,S,D,P);const F=u.clone(),U=this._extendCameraOptions(P),H=F.padding;F.bearing=S,F.pitch=D;const X=_.bn.convert(g),K=_.bn.convert(w),ee=new _.bn(X.lng,K.lat),ie=new _.bn(K.lng,X.lat),ae=F.project(X),ce=F.project(K),me=this.queryTerrainElevation(X),se=this.queryTerrainElevation(K),be=this.queryTerrainElevation(ee),Me=this.queryTerrainElevation(ie),we=[[ae.x,ae.y,Math.min(me||0,se||0,be||0,Me||0)],[ce.x,ce.y,Math.max(me||0,se||0,be||0,Me||0)]];let Se=_.bS.fromPoints(we);const pe=F.getWorldToCameraMatrix(),De=_.a6.invert(new Float64Array(16),pe);Se=_.bS.applyTransform(Se,pe);const Fe=_.N.sub([],Se.max,Se.min),Ne=H.left||0,je=H.right||0,at=H.bottom||0,Ke=H.top||0,{left:rt,right:pt,top:Pt,bottom:Ze}=U.padding,ht=.5*(Ne+je),ze=.5*(Ke+at),Ye=Math.min(F.scaleZoom(F.scale*Math.min((F.width-(Ne+je+rt+pt))/Fe[0],(F.height-(at+Ke+Ze+Pt))/Fe[1])),U.maxZoom),Mt=F.scale/F.zoomScale(Ye);Se=new _.bS([Se.min[0]-(rt+ht)*Mt,Se.min[1]-(Ze+ze)*Mt,Se.min[2]],[Se.max[0]+(pt+ht)*Mt,Se.max[1]+(Pt+ze)*Mt,Se.max[2]]);const ti=.5*Fe[2],Wt=this._minimumAABBFrustumDistance(F,Se),_i=[0,0,1,0];_.a7.transformMat4(_i,_i,pe),_.a7.normalize(_i,_i);const vi=_.N.scale([],_i,Wt+ti),Yi=_.N.add([],Se.center,vi),qi=("number"==typeof U.offset.x&&"number"==typeof U.offset.y?new _.P(U.offset.x,U.offset.y):_.P.convert(U.offset)).rotate(-_.bj(S));Se.center[0]-=qi.x*Mt,Se.center[1]+=qi.y*Mt,_.N.transformMat4(Se.center,Se.center,De),_.N.transformMat4(Yi,Yi,De);const Xi=[Se.center[0],Se.center[1],Yi[2]*F.pixelsPerMeter];_.N.scale(Xi,Xi,1/F.worldSize);const Sn=_.at(Xi[0]),bn=_.au(Xi[1]),xn=Math.min(F._zoomFromMercatorZ(Xi[2]),U.maxZoom),Dn=new _.bn(Sn,bn);return F.mercatorFromTransition&&xn<.5*(_.bG+_.bx)?(F.setProjection({name:"globe"}),F.zoom=xn,this._cameraForBounds(F,g,w,S,D,P)):{center:Dn,zoom:xn,bearing:S,pitch:D}}fitBounds(u,g,w){const S=this.cameraForBounds(u,g);return this._fitInternal(S,g,w)}fitScreenCoordinates(u,g,w,S,D){const P=_.P.convert(u),F=_.P.convert(g),U=new _.P(Math.min(P.x,F.x),Math.min(P.y,F.y)),H=new _.P(Math.max(P.x,F.x),Math.max(P.y,F.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(P,F))return this;const X=this.transform.pointLocation3D(U),K=this.transform.pointLocation3D(H),ee=this.transform.pointLocation3D(new _.P(U.x,H.y)),ie=this.transform.pointLocation3D(new _.P(H.x,U.y)),ae=[Math.min(X.lng,K.lng,ee.lng,ie.lng),Math.min(X.lat,K.lat,ee.lat,ie.lat)],ce=[Math.max(X.lng,K.lng,ee.lng,ie.lng),Math.max(X.lat,K.lat,ee.lat,ie.lat)],me=S&&S.pitch?S.pitch:this.getPitch(),se=this._cameraForBounds(this.transform,ae,ce,w,me,S);return this._fitInternal(se,S,D)}_fitInternal(u,g,w){return u?(delete(g=_.e(u,g)).padding,g.linear?this.easeTo(g,w):this.flyTo(g,w)):this}jumpTo(u,g){this.stop();const w=u.preloadOnly?this.transform.clone():this.transform;let S=!1,D=!1,P=!1;return"zoom"in u&&w.zoom!==+u.zoom&&(S=!0,w.zoom=+u.zoom),void 0!==u.center&&(w.center=_.bn.convert(u.center)),"bearing"in u&&w.bearing!==+u.bearing&&(D=!0,w.bearing=+u.bearing),"pitch"in u&&w.pitch!==+u.pitch&&(P=!0,w.pitch=+u.pitch),null==u.padding||w.isPaddingEqual(u.padding)||(w.padding=u.padding),u.preloadOnly?(this._preloadTiles(w),this):(this.fire(new _.b("movestart",g)).fire(new _.b("move",g)),S&&this.fire(new _.b("zoomstart",g)).fire(new _.b("zoom",g)).fire(new _.b("zoomend",g)),D&&this.fire(new _.b("rotatestart",g)).fire(new _.b("rotate",g)).fire(new _.b("rotateend",g)),P&&this.fire(new _.b("pitchstart",g)).fire(new _.b("pitch",g)).fire(new _.b("pitchend",g)),this.fire(new _.b("moveend",g)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||_.w(Wc),this.transform.getFreeCameraOptions()}setFreeCameraOptions(u,g){const w=this.transform;if(!w.projection.supportsFreeCamera)return _.w(Wc),this;this.stop();const S=w.zoom,D=w.pitch,P=w.bearing;w.setFreeCameraOptions(u);const F=S!==w.zoom,U=D!==w.pitch,H=P!==w.bearing;return this.fire(new _.b("movestart",g)).fire(new _.b("move",g)),F&&this.fire(new _.b("zoomstart",g)).fire(new _.b("zoom",g)).fire(new _.b("zoomend",g)),H&&this.fire(new _.b("rotatestart",g)).fire(new _.b("rotate",g)).fire(new _.b("rotateend",g)),U&&this.fire(new _.b("pitchstart",g)).fire(new _.b("pitch",g)).fire(new _.b("pitchend",g)),this.fire(new _.b("moveend",g)),this}easeTo(u,g){this._stop(!1,u.easeId),(!1===(u=_.e({offset:[0,0],duration:500,easing:_.d0},u)).animate||this._prefersReducedMotion(u))&&(u.duration=0);const w=this.transform,S=this.getZoom(),D=this.getBearing(),P=this.getPitch(),F=this.getPadding(),U="zoom"in u?+u.zoom:S,H="bearing"in u?this._normalizeBearing(u.bearing,D):D,X="pitch"in u?+u.pitch:P,K="padding"in u?u.padding:w.padding,ee=_.P.convert(u.offset);let ie,ae,ce;if("globe"===w.projection.name){const Ne=_.L.fromLngLat(w.center),je=ee.rotate(-w.angle);Ne.x+=je.x/w.worldSize,Ne.y+=je.y/w.worldSize;const at=Ne.toLngLat(),Ke=_.bn.convert(u.center||at);this._normalizeCenter(Ke),ie=w.centerPoint.add(je),ae=new _.P(Ne.x,Ne.y).mult(w.worldSize),ce=new _.P(_.a5(Ke.lng),_.ae(Ke.lat)).mult(w.worldSize).sub(ae)}else{ie=w.centerPoint.add(ee);const Ne=w.pointLocation(ie),je=_.bn.convert(u.center||Ne);this._normalizeCenter(je),ae=w.project(Ne),ce=w.project(je).sub(ae)}const me=w.zoomScale(U-S);let se,be;u.around&&(se=_.bn.convert(u.around),be=w.locationPoint(se));const Me=this._zooming||U!==S,we=this._rotating||D!==H,Se=this._pitching||X!==P,pe=!w.isPaddingEqual(K),De=Ne=>je=>{if(Me&&(Ne.zoom=_.U(S,U,je)),we&&(Ne.bearing=_.U(D,H,je)),Se&&(Ne.pitch=_.U(P,X,je)),pe&&(Ne.interpolatePadding(F,K,je),ie=Ne.centerPoint.add(ee)),se)Ne.setLocationAtPoint(se,be);else{const at=Ne.zoomScale(Ne.zoom-S),Ke=U>S?Math.min(2,me):Math.max(.5,me),rt=Math.pow(Ke,1-je),pt=Ne.unproject(ae.add(ce.mult(je*rt)).mult(at));Ne.setLocationAtPoint(Ne.renderWorldCopies?pt.wrap():pt,ie)}return u.preloadOnly||this._fireMoveEvents(g),Ne};if(u.preloadOnly){const Ne=this._emulate(De,u.duration,w);return this._preloadTiles(Ne),this}const Fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Me,this._rotating=we,this._pitching=Se,this._easeId=u.easeId,this._prepareEase(g,u.noMoveStart,Fe),this._ease(De(w),Ne=>{"sea"===w.cameraElevationReference&&w.recenterOnTerrain(),this._afterEase(g,Ne)},u),this}_prepareEase(u,g,w={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),g||w.moving||this.fire(new _.b("movestart",u)),this._zooming&&!w.zooming&&this.fire(new _.b("zoomstart",u)),this._rotating&&!w.rotating&&this.fire(new _.b("rotatestart",u)),this._pitching&&!w.pitching&&this.fire(new _.b("pitchstart",u))}_fireMoveEvents(u){this.fire(new _.b("move",u)),this._zooming&&this.fire(new _.b("zoom",u)),this._rotating&&this.fire(new _.b("rotate",u)),this._pitching&&this.fire(new _.b("pitch",u))}_afterEase(u,g){if(this._easeId&&g&&this._easeId===g)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const w=this._zooming,S=this._rotating,D=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,w&&this.fire(new _.b("zoomend",u)),S&&this.fire(new _.b("rotateend",u)),D&&this.fire(new _.b("pitchend",u)),this.fire(new _.b("moveend",u))}flyTo(u,g){if(this._prefersReducedMotion(u)){const Ze=_.ac(u,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ze,g)}this.stop(),u=_.e({offset:[0,0],speed:1.2,curve:1.42,easing:_.d0},u);const w=this.transform,S=this.getZoom(),D=this.getBearing(),P=this.getPitch(),F="zoom"in u?_.aa(+u.zoom,w.minZoom,w.maxZoom):S,U="bearing"in u?this._normalizeBearing(u.bearing,D):D,H="pitch"in u?+u.pitch:P,X=w.zoomScale(F-S),K=_.P.convert(u.offset),ee=w.centerPoint.add(K),ie=w.pointLocation(ee);let ae=u.center;if(ae&&u.padding){const Ze=this._cameraForBounds(this.transform,ae,ae,U,H,u);Ze&&(ae=Ze.center)}ae=_.bn.convert(ae||ie),this._normalizeCenter(ae);const ce=w.project(ie),me=w.project(ae).sub(ce);let se=u.curve;const be=Math.max(w.width,w.height),Me=be/X,we=me.mag();if("minZoom"in u){const Ze=_.aa(Math.min(u.minZoom,S,F),w.minZoom,w.maxZoom),ht=be/w.zoomScale(Ze-S);se=Math.sqrt(ht/we*2)}const Se=se*se;function pe(Ze){const ht=(Me*Me-be*be+(Ze?-1:1)*Se*Se*we*we)/(2*(Ze?Me:be)*Se*we);return Math.log(Math.sqrt(ht*ht+1)-ht)}function De(Ze){return(Math.exp(Ze)-Math.exp(-Ze))/2}function Fe(Ze){return(Math.exp(Ze)+Math.exp(-Ze))/2}const Ne=pe(0);let je=function(Ze){return Fe(Ne)/Fe(Ne+se*Ze)},at=function(Ze){return be*((Fe(Ne)*(De(ht=Ne+se*Ze)/Fe(ht))-De(Ne))/Se)/we;var ht},Ke=(pe(1)-Ne)/se;if(Math.abs(we)<1e-6||!isFinite(Ke)){if(Math.abs(be-Me)<1e-6)return this.easeTo(u,g);const Ze=Me<be?-1:1;Ke=Math.abs(Math.log(Me/be))/se,at=function(){return 0},je=function(ht){return Math.exp(Ze*se*ht)}}u.duration="duration"in u?+u.duration:1e3*Ke/("screenSpeed"in u?+u.screenSpeed/se:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0);const rt=D!==U,pt=H!==P,Pt=Ze=>ht=>{const ze=ht*Ke,Ye=1/je(ze);Ze.zoom=1===ht?F:S+Ze.scaleZoom(Ye),rt&&(Ze.bearing=_.U(D,U,ht)),pt&&(Ze.pitch=_.U(P,H,ht));const Mt=1===ht?ae:Ze.unproject(ce.add(me.mult(at(ze))).mult(Ye));return Ze.setLocationAtPoint(Ze.renderWorldCopies?Mt.wrap():Mt,ee),Ze._updateCameraOnTerrain(),u.preloadOnly||this._fireMoveEvents(g),Ze};if(u.preloadOnly){const Ze=this._emulate(Pt,u.duration,w);return this._preloadTiles(Ze),this}return this._zooming=!0,this._rotating=rt,this._pitching=pt,this._prepareEase(g,!1),this._ease(Pt(w),()=>this._afterEase(g),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(u,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const w=this._onEaseEnd;this._onEaseEnd=void 0,w.call(this,g)}if(!u){const w=this.handlers;w&&w.stop(!1)}return this}_ease(u,g,w){!1===w.animate||0===w.duration?(u(1),g()):(this._easeStart=_.f.now(),this._easeOptions=w,this._onEaseFrame=u,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const u=Math.min((_.f.now()-this._easeStart)/this._easeOptions.duration,1),g=this._onEaseFrame;g&&g(this._easeOptions.easing(u)),u<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(u,g){u=_.bh(u,-180,180);const w=Math.abs(u-g);return Math.abs(u-360-g)<w&&(u-=360),Math.abs(u+360-g)<w&&(u+=360),u}_normalizeCenter(u){const g=this.transform;if(g.maxBounds||"globe"!==g.projection.name&&!g.renderWorldCopies)return;const w=u.lng-g.center.lng;u.lng+=w>180?-360:w<-180?360:0}_prefersReducedMotion(u){return this._respectPrefersReducedMotion&&_.f.prefersReducedMotion&&!(u&&u.essential)}_emulate(u,g,w){const S=Math.ceil(15*g/1e3),D=[],P=u(w.clone());for(let F=0;F<=S;F++){const U=P(F/S);D.push(U.clone())}return D}}class Th{constructor(u={}){this.options=u,_.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(u){const g=this.options&&this.options.compact;return this._map=u,this._container=Kt("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Kt("button","mapboxgl-ctrl-attrib-button",this._container),Kt("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Kt("div","mapboxgl-ctrl-attrib-inner",this._container),g&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===g&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(u,g){const w=this._map._getUIString(`AttributionControl.${g}`);u.removeAttribute("title"),u.firstElementChild&&u.firstElementChild.setAttribute("title",w)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));const g=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||_.d5.ACCESS_TOKEN}];if(u){const w=g.reduce((S,D,P)=>(D.value&&(S+=`${D.key}=${D.value}${P<g.length-1?"&":""}`),S),"?");u.href=`${_.d5.FEEDBACK_URL}/${w}#${xa(this._map,!0)}`,u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}}_updateData(u){!u||"metadata"!==u.sourceDataType&&"visibility"!==u.sourceDataType&&"style"!==u.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let u=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const g=this._map.style._mergedSourceCaches;for(const S in g){const D=g[S];if(D.used){const P=D.getSource();P.attribution&&u.indexOf(P.attribution)<0&&u.push(P.attribution)}}u.sort((S,D)=>S.length-D.length),u=u.filter((S,D)=>{for(let P=D+1;P<u.length;P++)if(u[P].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=[...this.options.customAttribution,...u]:u.unshift(this.options.customAttribution));const w=u.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,u.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Bs{constructor(){_.aY(["_updateLogo","_updateCompact"],this)}onAdd(u){this._map=u,this._container=Kt("div","mapboxgl-ctrl");const g=Kt("a","mapboxgl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://www.mapbox.com/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(u){u&&"metadata"!==u.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const u=this._map.style._sourceCaches;if(0===Object.entries(u).length)return!0;for(const g in u){const w=u[g].getSource();if(w.hasOwnProperty("mapbox_logo")&&!w.mapbox_logo)return!1}return!0}_updateCompact(){const u=this._container.children;if(u.length){const g=u[0];this._map.getCanvasContainer().offsetWidth<250?g.classList.add("mapboxgl-compact"):g.classList.remove("mapboxgl-compact")}}}class Hf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const g=++this._id;return this._queue.push({callback:u,id:g,cancelled:!1}),g}remove(u){const g=this._currentlyRunning,w=g?this._queue.concat(g):this._queue;for(const S of w)if(S.id===u)return void(S.cancelled=!0)}run(u=0){const g=this._currentlyRunning=this._queue;this._queue=[];for(const w of g)if(!w.cancelled&&(w.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Ds(x,u,g){if(x=new _.bn(x.lng,x.lat),u){const w=new _.bn(x.lng-360,x.lat),S=new _.bn(x.lng+360,x.lat),D=360*Math.ceil(Math.abs(x.lng-g.center.lng)/360),P=g.locationPoint(x).distSqr(u),F=u.x<0||u.y<0||u.x>g.width||u.y>g.height;g.locationPoint(w).distSqr(u)<P&&(F||Math.abs(w.lng-g.center.lng)<D)?x=w:g.locationPoint(S).distSqr(u)<P&&(F||Math.abs(S.lng-g.center.lng)<D)&&(x=S)}for(;Math.abs(x.lng-g.center.lng)>180;){const w=g.locationPoint(x);if(w.x>=0&&w.y>=0&&w.x<=g.width&&w.y<=g.height)break;x.lng>g.center.lng?x.lng-=360:x.lng+=360}return x}const ha={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ig extends _.E{constructor(u,g){if(super(),(u instanceof HTMLElement||g)&&(u=_.e({element:u},g)),_.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=u&&u.occludedOpacity||.2,u&&u.element)this._element=u.element,this._offset=_.P.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=Kt("div");const D=41,P=27,F=ui("svg",{display:"block",height:D*this._scale+"px",width:P*this._scale+"px",viewBox:`0 0 ${P} ${D}`},this._element),U=ui("radialGradient",{id:"shadowGradient"},ui("defs",{},F));ui("stop",{offset:"10%","stop-opacity":.4},U),ui("stop",{offset:"100%","stop-opacity":.05},U),ui("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},F),ui("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},F),ui("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},F),ui("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},F),this._offset=_.P.convert(u&&u.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",D=>{D.preventDefault()}),this._element.addEventListener("mousedown",D=>{D.preventDefault()});const w=this._element.classList;for(const D in ha)w.remove(`mapboxgl-marker-anchor-${D}`);w.add(`mapboxgl-marker-anchor-${this._anchor}`);const S=u&&u.className?u.className.trim().split(/\s+/):[];w.add(...S),this._popup=null}addTo(u){return u===this._map||(this.remove(),this._map=u,u.getCanvasContainer().appendChild(this._element),u.on("move",this._updateMoving),u.on("moveend",this._update),u.on("remove",this._clearFadeTimer),u._addMarker(this),this.setDraggable(this._draggable),this._update(),u.on("click",this._onMapClick)),this}remove(){const u=this._map;return u&&(u.off("click",this._onMapClick),u.off("move",this._updateMoving),u.off("moveend",this._update),u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler),u.off("mouseup",this._onUp),u.off("touchend",this._onUp),u.off("mousemove",this._onMove),u.off("touchmove",this._onMove),u.off("remove",this._clearFadeTimer),u._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=_.bn.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(24.6+S)],"bottom-right":[-S,-1*(24.6+S)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=u,u._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(u){const g=u.code,w=u.charCode||u.keyCode;"Space"!==g&&"Enter"!==g&&32!==w&&13!==w||this.togglePopup()}_onMapClick(u){const g=u.originalEvent.target,w=this._element;this._popup&&(g===w||w.contains(g))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const u=this._popup;return u?(u.isOpen()?(u.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(u.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const u=this._map,g=this._pos;if(!u||!g)return!1;const w=u.unproject(g),S=u.getFreeCameraOptions();if(!S.position)return!1;const D=S.position.toLngLat();return D.distanceTo(w)<.9*D.distanceTo(this._lngLat)}_evaluateOpacity(){const u=this._map;if(!u)return;const g=this._pos;if(!g||g.x<0||g.x>u.transform.width||g.y<0||g.y>u.transform.height)return void this._clearFadeTimer();const w=u.unproject(g);let S;u._showingGlobe()&&_.d6(u.transform,this._lngLat)?S=0:(S=1-u._queryFogOpacity(w),u.transform._terrainEnabled()&&u.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const u=this._pos;if(!u||!this._map)return;const g=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${u.x}px,${u.y}px)\n            ${ha[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${g.x}px,${g.y}px)\n        `}_calculateXYTransform(){const u=this._pos,g=this._map,w=this.getPitchAlignment();if(!g||!u||"map"!==w)return"";if(!g._showingGlobe()){const U=g.getPitch();return U?`rotateX(${U}deg)`:""}const S=_.bF(_.d7(g.transform,this._lngLat)),D=u.sub(_.d8(g.transform)),P=Math.abs(D.x)+Math.abs(D.y);if(0===P)return"";const F=S/P;return`rotateX(${-D.y*F}deg) rotateY(${D.x*F}deg)`}_calculateZTransform(){const u=this._pos,g=this._map;if(!g||!u)return"";let w=0;const S=this.getRotationAlignment();if("map"===S)if(g._showingGlobe()){const D=g.project(new _.bn(this._lngLat.lng,this._lngLat.lat+.001)),P=g.project(new _.bn(this._lngLat.lng,this._lngLat.lat-.001)).sub(D);w=_.bF(Math.atan2(P.y,P.x))-90}else w=-g.getBearing();else if("horizon"===S){const D=_.O(4,6,g.getZoom()),P=_.d8(g.transform);P.y+=D*g.transform.height;const F=u.sub(P),U=_.bF(Math.atan2(F.y,F.x));w=(U>90?U-270:U+90)*(1-D)}return w+=this._rotation,w?`rotateZ(${w}deg)`:""}_update(u){cancelAnimationFrame(this._updateFrameId);const g=this._map;g&&(g.transform.renderWorldCopies&&(this._lngLat=Ds(this._lngLat,this._pos,g.transform)),this._pos=g.project(this._lngLat),!0===u?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),g._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(g._showingGlobe()||g.getTerrain()||g.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(u){return this._offset=_.P.convert(u),this._update(),this}addClassName(u){return this._element.classList.add(u),this}removeClassName(u){return this._element.classList.remove(u),this}toggleClassName(u){return this._element.classList.toggle(u)}_onMove(u){const g=this._map;if(!g)return;const w=this._pointerdownPos,S=this._positionDelta;if(w&&S){if(!this._isDragging){const D=this._clickTolerance||g._clickTolerance;if(u.point.dist(w)<D)return;this._isDragging=!0}this._pos=u.point.sub(S),this._lngLat=g.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new _.b("dragstart"))),this.fire(new _.b("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const u=this._map;u&&(u.off("mousemove",this._onMove),u.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new _.b("dragend")),this._state="inactive"}_addDragHandler(u){const g=this._map,w=this._pos;g&&w&&this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(w),this._pointerdownPos=u.point,this._state="pending",g.on("mousemove",this._onMove),g.on("touchmove",this._onMove),g.once("mouseup",this._onUp),g.once("touchend",this._onUp))}setDraggable(u){this._draggable=!!u;const g=this._map;return g&&(u?(g.on("mousedown",this._addDragHandler),g.on("touchstart",this._addDragHandler)):(g.off("mousedown",this._addDragHandler),g.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(u){return this._occludedOpacity=u||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Sh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},cp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function $l(x=new _.P(0,0),u="bottom"){if("number"==typeof x){const g=Math.round(Math.sqrt(.5*Math.pow(x,2)));switch(u){case"top":return new _.P(0,x);case"top-left":return new _.P(g,g);case"top-right":return new _.P(-g,g);case"bottom":return new _.P(0,-x);case"bottom-left":return new _.P(g,-g);case"bottom-right":return new _.P(-g,-g);case"left":return new _.P(x,0);case"right":return new _.P(-x,0)}return new _.P(0,0)}return x instanceof _.P||Array.isArray(x)?_.P.convert(x):_.P.convert(x[u]||[0,0])}class Mh{constructor(u){this.jumpTo(u)}getValue(u){if(u<=this._startTime)return this._start;if(u>=this._endTime)return this._end;const g=_.cc((u-this._startTime)/(this._endTime-this._startTime));return this._start*(1-g)+this._end*g}isEasing(u){return u>=this._startTime&&u<=this._endTime}jumpTo(u){this._startTime=-1/0,this._endTime=-1/0,this._start=u,this._end=u}easeTo(u,g,w){this._start=this.getValue(g),this._end=u,this._startTime=g,this._endTime=g+w}}const dp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},hv={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1};class Rg{constructor(){this.showOverdrawInspector=!1,this.showTileBoundaries=!1,this.showParseStatus=!1,this.continuousRedraw=!1,this.showTileAABBs=!1,this.showPadding=!1,this.showTerrainWireframe=!1,this.showLayers2DWireframe=!1,this.showLayers3DWireframe=!1}}const Pg={showCompass:!0,showZoom:!0,visualizePitch:!1};class zu{constructor(u,g,w=!1){this._clickTolerance=10,this.element=g,this.mouseRotate=new cd({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,w&&(this.mousePitch=new Ko({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),_.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),g.addEventListener("mousedown",this.mousedown),g.addEventListener("touchstart",this.touchstart,{passive:!1}),g.addEventListener("touchmove",this.touchmove),g.addEventListener("touchend",this.touchend),g.addEventListener("touchcancel",this.reset)}down(u,g){this.mouseRotate.mousedown(u,g),this.mousePitch&&this.mousePitch.mousedown(u,g),ji()}move(u,g){const w=this.map,S=this.mouseRotate.mousemoveWindow(u,g),D=S&&S.bearingDelta;if(D&&w.setBearing(w.getBearing()+D),this.mousePitch){const P=this.mousePitch.mousemoveWindow(u,g),F=P&&P.pitchDelta;F&&w.setPitch(w.getPitch()+F)}}off(){const u=this.element;u.removeEventListener("mousedown",this.mousedown),u.removeEventListener("touchstart",this.touchstart,{passive:!1}),u.removeEventListener("touchmove",this.touchmove),u.removeEventListener("touchend",this.touchend),u.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){un(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(u){this.down(_.e({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),Di(this.element,u)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(u){this.move(u,Di(this.element,u))}mouseup(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()}touchstart(u){1!==u.targetTouches.length?this.reset():(this._startPos=this._lastPos=ki(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>u.preventDefault()},this._startPos))}touchmove(u){1!==u.targetTouches.length?this.reset():(this._lastPos=ki(this.element,u.targetTouches)[0],this.move({preventDefault:()=>u.preventDefault()},this._lastPos))}touchend(u){0===u.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const $f={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Al={maxWidth:100,unit:"metric"},Wf={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:_.dk,supported:Si,setRTLTextPlugin:_.dm,getRTLTextPluginStatus:_.dn,Map:class extends Wo{constructor(x){const u=x;if(null!=(x=_.e({},hv,x)).minZoom&&null!=x.maxZoom&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=x.minPitch&&null!=x.maxPitch&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=x.minPitch&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=x.maxPitch&&x.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(x.antialias&&_.d9(window)&&(x.antialias=!1,_.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Wd(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies),x),this._repaint=!1,this._interactive=x.interactive,this._minTileCacheSize=x.minTileCacheSize,this._maxTileCacheSize=x.maxTileCacheSize,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=x.crossSourceCollisions,this._collectResourceTiming=x.collectResourceTiming,this._language=this._parseLanguage(x.language),this._worldview=x.worldview,this._renderTaskQueue=new Hf,this._domRenderTaskQueue=new Hf,this._controls=[],this._markers=[],this._popups=[],this._mapId=_.aC(),this._locale=_.e({},dp,x.locale),this._clickTolerance=x.clickTolerance,this._cooperativeGestures=x.cooperativeGestures,this._performanceMetricsCollection=x.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Mh(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new _.da(x.transformRequest,x.accessToken,x.testMode),this._silenceAuthErrors=!!x.testMode,this._contextCreateOptions=x.contextCreateOptions?{...x.contextCreateOptions}:{},"string"==typeof x.container){const g=document.getElementById(x.container);if(!g)throw new Error(`Container '${x.container.toString()}' not found.`);this._container=g}else{if(!(x.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(this._container.childNodes.length>0&&_.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),x.maxBounds&&this.setMaxBounds(x.maxBounds),_.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._debugParams=new Rg,this._tp=x.devtools?new ua(this):new ua,this._tp.registerParameter(this._debugParams,["Debug"],"showOverdrawInspector",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileBoundaries",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showParseStatus",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"continuousRedraw",void 0,g=>{this.repaint=g}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileAABBs",void 0,g=>{this.showTileAABBs=g}),this._tp.registerParameter(this._debugParams,["Debug"],"showPadding",void 0,g=>{this.showPadding=g}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showTerrainWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers2DWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers3DWireframe",void 0,()=>{this._update()}),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new lp(this,x),this._localFontFamily=x.localFontFamily,this._localIdeographFontFamily=x.localIdeographFontFamily,(x.style||!x.testMode)&&this.setStyle(x.style||_.d5.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),x.projection&&this.setProjection(x.projection),x.hash&&(this._hash=new Oo("string"==typeof x.hash&&x.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==u.center&&null==u.zoom||(this.transform._unmodified=!1),this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch});const g=x.bounds;g&&(this.resize(),this.fitBounds(g,_.e({},x.fitBoundsOptions,{duration:0})))}this.resize(),x.attributionControl&&this.addControl(new Th({customAttribution:x.customAttribution})),this._logoControl=new Bs,this.addControl(this._logoControl,x.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",g=>{this._update("style"===g.dataType),this.fire(new _.b(`${g.dataType}data`,g))}),this.on("dataloading",g=>{this.fire(new _.b(`${g.dataType}dataloading`,g))})}_getMapId(){return this._mapId}addControl(x,u){if(void 0===u&&(u=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new _.a(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=x.onAdd(this);this._controls.push(x);const w=this._controlPositions[u];return-1!==u.indexOf("bottom")?w.insertBefore(g,w.firstChild):w.appendChild(g),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new _.a(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(x);return u>-1&&this._controls.splice(u,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(x){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const u=!this._moving;return u&&this.fire(new _.b("movestart",x)).fire(new _.b("move",x)),this.fire(new _.b("resize",x)),u&&this.fire(new _.b("moveend",x)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(x){return this.transform.setMaxBounds(_.ad.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x?this.setZoom(x):this.fire(new _.b("zoomstart")).fire(new _.b("zoom")).fire(new _.b("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x?this.setZoom(x):this.fire(new _.b("zoomstart")).fire(new _.b("zoom")).fire(new _.b("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x?this.setPitch(x):this.fire(new _.b("pitchstart")).fire(new _.b("pitch")).fire(new _.b("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x?this.setPitch(x):this.fire(new _.b("pitchstart")).fire(new _.b("pitch")).fire(new _.b("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.renderWorldCopies=x,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(x){return"auto"===x?navigator.language:Array.isArray(x)?0===x.length?void 0:x.map(u=>"auto"===u?navigator.language:u):x}setLanguage(x){const u=this._parseLanguage(x);if(!this.style||u===this._language)return this;this._language=u,this.style.reloadSources();for(const g of this._controls)g._setLanguage&&g._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(x){return this.style&&x!==this._worldview?(this._worldview=x,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(x){return this._lazyInitEmptyStyle(),x?"string"==typeof x&&(x={name:x}):x=null,this._useExplicitProjection=!!x,this._prioritizeAndUpdateProjection(x,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const x=this.transform,u=x.projection.name;let g;"globe"===u&&x.zoom>=_.bx?(x.setMercatorFromTransition(),g=!0):"mercator"===u&&x.zoom<_.bx&&(x.setProjection({name:"globe"}),g=!0),g&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(x,u){return this._updateProjection(x||u||{name:"mercator"})}_updateProjection(x){let u;return u="globe"===x.name&&this.transform.zoom>=_.bx?this.transform.setMercatorFromTransition():this.transform.setProjection(x),this.style.applyProjectionUpdate(),u&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(x){return this.transform.locationPoint3D(_.bn.convert(x))}unproject(x){return this.transform.pointLocation3D(_.P.convert(x))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(x,u,g){if("mouseenter"===x||"mouseover"===x){let w=!1;const S=P=>{const F=u.filter(H=>this.getLayer(H)),U=F.length?this.queryRenderedFeatures(P.point,{layers:F}):[];U.length?w||(w=!0,g.call(this,new il(x,this,P.originalEvent,{features:U}))):w=!1},D=()=>{w=!1};return{layers:new Set(u),listener:g,delegates:{mousemove:S,mouseout:D}}}if("mouseleave"===x||"mouseout"===x){let w=!1;const S=P=>{const F=u.filter(U=>this.getLayer(U));(F.length?this.queryRenderedFeatures(P.point,{layers:F}):[]).length?w=!0:w&&(w=!1,g.call(this,new il(x,this,P.originalEvent)))},D=P=>{w&&(w=!1,g.call(this,new il(x,this,P.originalEvent)))};return{layers:new Set(u),listener:g,delegates:{mousemove:S,mouseout:D}}}{const w=S=>{const D=u.filter(F=>this.getLayer(F)),P=D.length?this.queryRenderedFeatures(S.point,{layers:D}):[];P.length&&(S.features=P,g.call(this,S),delete S.features)};return{layers:new Set(u),listener:g,delegates:{[x]:w}}}}on(x,u,g){if(void 0===g)return super.on(x,u);if(Array.isArray(u)||(u=[u]),u)for(const S of u)if(!this._isValidId(S))return this;const w=this._createDelegatedListener(x,u,g);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(w);for(const S in w.delegates)this.on(S,w.delegates[S]);return this}once(x,u,g){if(void 0===g)return super.once(x,u);if(Array.isArray(u)||(u=[u]),u)for(const S of u)if(!this._isValidId(S))return this;const w=this._createDelegatedListener(x,u,g);for(const S in w.delegates)this.once(S,w.delegates[S]);return this}off(x,u,g){if(void 0===g)return super.off(x,u);u=new Set(Array.isArray(u)?u:[u]);for(const D of u)if(!this._isValidId(D))return this;const w=(D,P)=>{if(D.size!==P.size)return!1;for(const F of D)if(!P.has(F))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[x]:void 0;return S&&(D=>{for(let P=0;P<D.length;P++){const F=D[P];if(F.listener===g&&w(F.layers,u)){for(const U in F.delegates)this.off(U,F.delegates[U]);return D.splice(P,1),this}}})(S),this}queryRenderedFeatures(x,u){if(!this.style)return[];if(void 0!==u||void 0===x||x instanceof _.P||Array.isArray(x)||(u=x,x=void 0),x=x||[[0,0],[this.transform.width,this.transform.height]],(u=u||{}).layers&&Array.isArray(u.layers))for(const g of u.layers)if(!this._isValidId(g))return[];return this.style.queryRenderedFeatures(x,u,this.transform)}querySourceFeatures(x,u){return this._isValidId(x)?this.style.querySourceFeatures(x,u):[]}isPointOnSurface(x){const{name:u}=this.transform.projection;return"globe"!==u&&"mercator"!==u&&_.w(`${u} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(_.P.convert(x))}setStyle(x,u){return!1!==(u=_.e({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},u)).diff&&u.localIdeographFontFamily===this._localIdeographFontFamily&&u.localFontFamily===this._localFontFamily&&this.style&&x?(this._diffStyle(x,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._localFontFamily=u.localFontFamily,this._updateStyle(x,u))}_getUIString(x){const u=this._locale[x];if(null==u)throw new Error(`Missing UI string '${x}'`);return u}_updateStyle(x,u){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),x&&(this.style=new Gl(this,u||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof x?this.style.loadURL(x):this.style.loadJSON(x)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Gl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,u){if("string"==typeof x){const g=this._requestManager.normalizeStyleURL(x),w=this._requestManager.transformRequest(g,_.R.Style);_.g(w,(S,D)=>{S?this.fire(new _.a(S)):D&&this._updateDiff(D,u)})}else"object"==typeof x&&this._updateDiff(x,u)}_updateDiff(x,u){try{this.style.setState(x)&&this._update(!0)}catch(g){_.w(`Unable to perform style diff: ${g.message||g.error||g}.  Rebuilding the style from scratch.`),this._updateStyle(x,u)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(_.w("There is no style added to the map."),!1)}_isValidId(x){return null==x?(this.fire(new _.a(new Error("IDs can't be empty."))),!1):!_.c4(x)||(this.fire(new _.a(new Error(`IDs can't contain special symbols: "${x}".`))),!1)}addSource(x,u){return this._isValidId(x)?(this._lazyInitEmptyStyle(),this.style.addSource(x,u),this._update(!0)):this}isSourceLoaded(x){return!!this._isValidId(x)&&!!this.style&&this.style._isSourceCacheLoaded(x)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(x,u,g){this._lazyInitEmptyStyle(),this.style.addSourceType(x,u,g)}removeSource(x){return this._isValidId(x)?(this.style.removeSource(x),this._updateTerrain(),this._update(!0)):this}getSource(x){return this._isValidId(x)?this.style.getOwnSource(x):null}addImage(x,u,{pixelRatio:g=1,sdf:w=!1,stretchX:S,stretchY:D,content:P}={}){if(this._lazyInitEmptyStyle(),u instanceof HTMLImageElement||ImageBitmap&&u instanceof ImageBitmap){const{width:F,height:U,data:H}=_.f.getImageData(u);this.style.addImage(x,{data:new _.h({width:F,height:U},H),pixelRatio:g,stretchX:S,stretchY:D,content:P,sdf:w,version:0})}else if(void 0===u.width||void 0===u.height)this.fire(new _.a(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:F,height:U}=u,H=u;this.style.addImage(x,{data:new _.h({width:F,height:U},new Uint8Array(H.data)),pixelRatio:g,stretchX:S,stretchY:D,content:P,sdf:w,version:0,userImage:H}),H.onAdd&&H.onAdd(this,x)}}updateImage(x,u){this._lazyInitEmptyStyle();const g=this.style.getImage(x);if(!g)return void this.fire(new _.a(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=u instanceof HTMLImageElement||ImageBitmap&&u instanceof ImageBitmap?_.f.getImageData(u):u,{width:S,height:D}=w,P=w.data;if(void 0===S||void 0===D)return void this.fire(new _.a(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==g.data.width||D!==g.data.height)return void this.fire(new _.a(new Error(`The width and height of the updated image (${S}, ${D})\n                must be that same as the previous version of the image\n                (${g.data.width}, ${g.data.height})`)));const F=!(u instanceof HTMLImageElement||ImageBitmap&&u instanceof ImageBitmap);g.data.replace(P,F),this.style.updateImage(x,g)}hasImage(x){return x?!!this.style&&!!this.style.getImage(x):(this.fire(new _.a(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x,u){_.d(this._requestManager.transformRequest(x,_.R.Image),(g,w)=>{u(g,w instanceof HTMLImageElement?_.f.getImageData(w):w)})}listImages(){return this.style.listImages()}addModel(x,u){this._lazyInitEmptyStyle(),this.style.addModel(x,u)}hasModel(x){return x?this.style.hasModel(x):(this.fire(new _.a(new Error("Missing required model id"))),!1)}removeModel(x){this.style.removeModel(x)}listModels(){return this.style.listModels()}addLayer(x,u){return this._isValidId(x.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(x,u),this._update(!0)):this}getSlot(x){const u=this.getLayer(x);return u&&u.slot||null}setSlot(x,u){return this.style.setSlot(x,u),this.style.mergeLayers(),this._update(!0)}addImport(x,u){return this.style.addImport(x,u),this}updateImport(x,u){return"string"!=typeof u&&u.id!==x?(this.removeImport(x),this.addImport(u)):(this.style.updateImport(x,u),this._update(!0))}removeImport(x){return this.style.removeImport(x),this}moveImport(x,u){return this.style.moveImport(x,u),this._update(!0)}moveLayer(x,u){return this._isValidId(x)?(this.style.moveLayer(x,u),this._update(!0)):this}removeLayer(x){return this._isValidId(x)?(this.style.removeLayer(x),this._update(!0)):this}getLayer(x){return this._isValidId(x)?this.style.getOwnLayer(x):null}setLayerZoomRange(x,u,g){return this._isValidId(x)?(this.style.setLayerZoomRange(x,u,g),this._update(!0)):this}setFilter(x,u,g={}){return this._isValidId(x)?(this.style.setFilter(x,u,g),this._update(!0)):this}getFilter(x){return this._isValidId(x)?this.style.getFilter(x):null}setPaintProperty(x,u,g,w={}){return this._isValidId(x)?(this.style.setPaintProperty(x,u,g,w),this._update(!0)):this}getPaintProperty(x,u){return this._isValidId(x)?this.style.getPaintProperty(x,u):null}setLayoutProperty(x,u,g,w={}){return this._isValidId(x)?(this.style.setLayoutProperty(x,u,g,w),this._update(!0)):this}getLayoutProperty(x,u){return this._isValidId(x)?this.style.getLayoutProperty(x,u):null}getConfigProperty(x,u){return this.style.getConfigProperty(x,u)}setConfigProperty(x,u,g){return this.style.setConfigProperty(x,u,g),this._update(!0)}setLights(x){if(this._lazyInitEmptyStyle(),x&&1===x.length&&"flat"===x[0].type){const u=x[0];u.properties?this.style.setFlatLight(u.properties,u.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(x),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const x=this.style.getLights()||[];return 0===x.length&&x.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),x}setLight(x,u={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:x}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(x){return this._lazyInitEmptyStyle(),!x&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(x),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(x){return this._lazyInitEmptyStyle(),this.style.setFog(x),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(x){return this.style.setCamera(x),this._triggerCameraUpdate(x)}_triggerCameraUpdate(x){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===x["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(x){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(_.bn.convert(x),this.transform):0}setFeatureState(x,u){return this._isValidId(x.source)?(this.style.setFeatureState(x,u),this._update()):this}removeFeatureState(x,u){return this._isValidId(x.source)?(this.style.removeFeatureState(x,u),this._update()):this}getFeatureState(x){return this._isValidId(x.source)?this.style.getFeatureState(x):null}_updateContainerDimensions(){if(!this._container)return;const x=this._container.getBoundingClientRect().width||400,u=this._container.getBoundingClientRect().height||300;let g,w,S,D=this._container;for(;D&&(!w||!S);){const P=window.getComputedStyle(D).transform;P&&"none"!==P&&(g=P.match(/matrix.*\((.+)\)/)[1].split(", "),g[0]&&"0"!==g[0]&&"1"!==g[0]&&(w=g[0]),g[3]&&"0"!==g[3]&&"1"!==g[3]&&(S=g[3])),D=D.parentElement}this._containerWidth=w?Math.abs(x/w):x,this._containerHeight=S?Math.abs(u/S):u}_detectMissingCSS(){"rgb(250, 128, 114)"!==window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&_.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const x=this._container;x.classList.add("mapboxgl-map"),(this._missingCSSCanary=Kt("div","mapboxgl-canary",x)).style.visibility="hidden",this._detectMissingCSS();const u=this._canvasContainer=Kt("div","mapboxgl-canvas-container",x);this._canvas=Kt("canvas","mapboxgl-canvas",u),this._interactive&&(u.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const g=this._controlContainer=Kt("div","mapboxgl-control-container",x),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{w[S]=Kt("div",`mapboxgl-ctrl-${S}`,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(x,u){const g=_.f.devicePixelRatio||1;this._canvas.width=g*Math.ceil(x),this._canvas.height=g*Math.ceil(u),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${u}px`}_addMarker(x){this._markers.push(x)}_removeMarker(x){const u=this._markers.indexOf(x);-1!==u&&this._markers.splice(u,1)}_addPopup(x){this._popups.push(x)}_removePopup(x){const u=this._popups.indexOf(x);-1!==u&&this._popups.splice(u,1)}_setupPainter(){const x=_.e({},Si.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),u=this._canvas.getContext("webgl2",x);u?(_.db(u,!0),this.painter=new Lu(u,this._contextCreateOptions,this.transform,this._tp),this.on("data",g=>{"source"===g.dataType&&this.painter.setTileLoadedFlag(!0)}),_.dc.testSupport(u)):this.fire(new _.a(new Error("Failed to initialize WebGL")))}_contextLost(x){x.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new _.b("webglcontextlost",{originalEvent:x}))}_contextRestored(x){this._setupPainter(),this.resize(),this._update(),this.fire(new _.b("webglcontextrestored",{originalEvent:x}))}_onMapScroll(x){if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_requestDomTask(x){!this.loaded()||this.loaded()&&!this.isMoving()?x():this._domRenderTaskQueue.add(x)}_render(x){let u;this.fire(new _.b("renderstart"));const g=this.painter.context.extTimerQuery,w=_.f.now(),S=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(u=S.createQuery(),S.beginQuery(g.TIME_ELAPSED_EXT,u)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(x),this._domRenderTaskQueue.run(x),this._removed)return;this._updateProjectionTransition();const D=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,H=this.transform.pitch,X=_.f.now(),K=new _.K(U,{now:X,fadeDuration:D,pitch:H,transition:this.style.transition});this.style.update(K)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let P=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),P=this._updateAverageElevation(w),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):P=this._updateAverageElevation(w),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,D,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries||this._debugParams.showTileBoundaries,showParseStatus:this.showParseStatus||this._debugParams.showParseStatus,wireframe:{terrain:this.showTerrainWireframe||this._debugParams.showTerrainWireframe,layers2D:this.showLayers2DWireframe||this._debugParams.showLayers2DWireframe,layers3D:this.showLayers3DWireframe||this._debugParams.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector||this._debugParams.showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs||this._debugParams.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:D,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding||this._debugParams.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new _.b("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new _.b("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),u){const U=_.f.now()-w;S.endQuery(g.TIME_ELAPSED_EXT),setTimeout(()=>{const H=S.getQueryParameter(u,S.QUERY_RESULT)/1e6;S.deleteQuery(u),this.fire(new _.b("gpu-timing-frame",{cpuTime:U,gpuTime:H}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const H=this.painter.queryGpuTimers(U);this.fire(new _.b("gpu-timing-layer",{layerTimes:H}))},50)}if(this.listens("gpu-timing-deferred-render")){const U=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const H=this.painter.queryGpuTimeDeferredRender(U);this.fire(new _.b("gpu-timing-deferred-render",{gpuTime:H}))},50)}const F=this._sourcesDirty||this._styleDirty||this._placementDirty||P;if(F||this._repaint)this.triggerRepaint();else{const U=!this.isMoving()&&this.loaded();if(U&&(P=this._updateAverageElevation(w,!0)),P)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new _.b("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const H=this._calculateSpeedIndex();this.fire(new _.b("speedindexcompleted",{speedIndex:H})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,this._performanceMetricsCollection&&_.dd(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(x){for(const u of this._markers)x&&!this.getRenderWorldCopies()&&(u._lngLat=u._lngLat.wrap()),u._update();for(const u of this._popups)!x||this.getRenderWorldCopies()||u._trackPointer||(u._lngLat=u._lngLat.wrap()),u._update()}_updateAverageElevation(x,u=!1){const g=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&g(0);const w=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(w||(u||x-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(x)){const S=this.transform.averageElevation;let D=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(D)?D=0:this._averageElevationLastSampledAt=x;const P=Math.abs(S-D);if(P>1){if(this._isInitialLoad||w)return this._averageElevation.jumpTo(D),g(D);this._averageElevation.easeTo(D,x,300)}else if(P>1e-4)return this._averageElevation.jumpTo(D),g(D)}return!!this._averageElevation.isEasing(x)&&g(this._averageElevation.getValue(x))}_authenticate(){_.de(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,x=>{if(x&&(x.message===_.df||401===x.status)){const u=this.painter.context.gl;_.db(u,!1),this._logoControl instanceof Bs&&this._logoControl._updateLogo(),u&&u.clear(u.DEPTH_BUFFER_BIT|u.COLOR_BUFFER_BIT|u.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new _.a(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),_.dg(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const x=this._isDragging();this.painter.updateTerrain(this.style,x)}_calculateSpeedIndex(){const x=this.painter.canvasCopy(),u=this.painter.getCanvasCopiesAndTimestamps();u.timeStamps.push(performance.now());const g=this.painter.context.gl,w=g.createFramebuffer();function S(D){g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,D,0);const P=new Uint8Array(g.drawingBufferWidth*g.drawingBufferHeight*4);return g.readPixels(0,0,g.drawingBufferWidth,g.drawingBufferHeight,g.RGBA,g.UNSIGNED_BYTE,P),P}return g.bindFramebuffer(g.FRAMEBUFFER,w),this._canvasPixelComparison(S(x),u.canvasCopies.map(S),u.timeStamps)}_canvasPixelComparison(x,u,g){let w=g[1]-g[0];const S=x.length/4;for(let D=0;D<u.length;D++){const P=u[D];let F=0;for(let U=0;U<P.length;U+=4)P[U]===x[U]&&P[U+1]===x[U+1]&&P[U+2]===x[U+2]&&P[U+3]===x[U+3]&&(F+=1);w+=(g[D+2]-g[D+1])*(1-F/S)}return w}remove(){this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const x=this.painter.context.gl.getExtension("WEBGL_lose_context");x&&x.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),_.dh(this.painter.context.gl),_.di.remove(),_.dj.remove(),this._removed=!0,this.fire(new _.b("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(x){this._renderNextFrame=this._renderNextFrame||x,this.style&&!this._frame&&(this._frame=_.f.frame(u=>{const g=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,g&&this._render(u)}))}_preloadTiles(x){const u=this.style?Object.values(this.style._sourceCaches):[];return _.b1(u,(g,w)=>g._preloadTiles(x,w),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(x){this._trackResize&&this.resize({originalEvent:x})._update()}_onVisibilityChange(){"hidden"===document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(x){this._showParseStatus!==x&&(this._showParseStatus=x,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(x){this._showTerrainWireframe!==x&&(this._showTerrainWireframe=x,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(x){this._showLayers2DWireframe!==x&&(this._showLayers2DWireframe=x,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(x){this._showLayers3DWireframe!==x&&(this._showLayers3DWireframe=x,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(x){this._speedIndexTiming!==x&&(this._speedIndexTiming=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(x){this._showTileAABBs!==x&&(this._showTileAABBs=x,x&&this._update())}_setCacheLimits(x,u){_.dl(x,u)}get version(){return _.dk}},NavigationControl:class{constructor(x){this.options=_.e({},Pg,x),this._container=Kt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",u=>u.preventDefault()),this.options.showZoom&&(_.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",u=>{this._map&&this._map.zoomIn({},{originalEvent:u})}),Kt("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",u=>{this._map&&this._map.zoomOut({},{originalEvent:u})}),Kt("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(_.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",u=>{const g=this._map;g&&(this.options.visualizePitch?g.resetNorthPitch({},{originalEvent:u}):g.resetNorth({},{originalEvent:u}))}),this._compassIcon=Kt("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const x=this._map;if(!x)return;const u=x.getZoom(),g=u===x.getMaxZoom(),w=u===x.getMinZoom();this._zoomInButton.disabled=g,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",g.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())}_rotateCompassArrow(){const x=this._map;if(!x)return;const u=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(x.transform.pitch*(Math.PI/180)),.5)}) rotateX(${x.transform.pitch}deg) rotateZ(${x.transform.angle*(180/Math.PI)}deg)`:`rotate(${x.transform.angle*(180/Math.PI)}deg)`;x._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=u)})}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),x.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&x.on("pitch",this._rotateCompassArrow),x.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zu(x,this._compass,this.options.visualizePitch)),this._container}onRemove(){const x=this._map;x&&(this._container.remove(),this.options.showZoom&&x.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&x.off("pitch",this._rotateCompassArrow),x.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(x,u){const g=Kt("button",x,this._container);return g.type="button",g.addEventListener("click",u),g}_setButtonTitle(x,u){if(!this._map)return;const g=this._map._getUIString(`NavigationControl.${u}`);x.setAttribute("aria-label",g),x.firstElementChild&&x.firstElementChild.setAttribute("title",g)}},GeolocateControl:class extends _.E{constructor(x){super();const u=navigator.geolocation;this.options=_.e({geolocation:u},$f,x),_.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ld(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(x){return this._map=x,this._container=Kt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(x){const u=(g=!!this.options.geolocation)=>{this._supportsGeolocation=g,x(g)};void 0!==this._supportsGeolocation?x(this._supportsGeolocation):void 0!==navigator.permissions?navigator.permissions.query({name:"geolocation"}).then(g=>u("denied"!==g.state)).catch(()=>u()):u()}_isOutOfMapMaxBounds(x){const u=this._map.getMaxBounds(),g=x.coords;return!!u&&(g.longitude<u.getWest()||g.longitude>u.getEast()||g.latitude<u.getSouth()||g.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(x){if(this._map){if(this._isOutOfMapMaxBounds(x))return this._setErrorState(),this.fire(new _.b("outofmaxbounds",x)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=x,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(x),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(x),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new _.b("geolocate",x)),this._finish()}}_updateCamera(x){const u=new _.bn(x.coords.longitude,x.coords.latitude),g=x.coords.accuracy,w=this._map.getBearing(),S=_.e({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(g),S,{geolocateSource:!0})}_updateMarker(x){if(x){const u=new _.bn(x.coords.longitude,x.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=x.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const x=this._map.transform,u=_.bl(1,x._center.lat)*x.worldSize,g=Math.ceil(2*this._accuracy*u);this._circleElement.style.width=`${g}px`,this._circleElement.style.height=`${g}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(x){if(this._map){if(this.options.trackUserLocation)if(1===x.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===x.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new _.b("error",x)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(x){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=Kt("button","mapboxgl-ctrl-geolocate",this._container),Kt("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===x){_.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Kt("div","mapboxgl-user-location"),this._dotElement.appendChild(Kt("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Kt("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ig({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Kt("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ig({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||"ACTIVE_LOCK"!==this._watchState||u.originalEvent&&"resize"===u.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new _.b("trackuserlocationend")))})}}_onDeviceOrientation(x){this._userLocationDotMarker&&(x.webkitCompassHeading?this._heading=x.webkitCompassHeading:!0===x.absolute&&(this._heading=-1*x.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return _.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new _.b("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new _.b("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new _.b("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let x;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(x={maximumAge:6e5,timeout:0},this._noTimeout=!0):(x=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,x),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const x=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(u=>{"granted"===u&&x()}).catch(console.error):x()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Th,ScaleControl:class{constructor(x){this.options=_.e({},Al,x),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),_.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const x=this.options.maxWidth||100,u=this._map,g=u._containerHeight/2,w=u._containerWidth/2-x/2,S=u.unproject([w,g]),D=u.unproject([w+x,g]),P=S.distanceTo(D);if("imperial"===this.options.unit){const F=3.2808*P;F>5280?this._setScale(x,F/5280,"mile"):this._setScale(x,F,"foot")}else"nautical"===this.options.unit?this._setScale(x,P/1852,"nautical-mile"):P>=1e3?this._setScale(x,P/1e3,"kilometer"):this._setScale(x,P,"meter")}_setScale(x,u,g){this._map._requestDomTask(()=>{const w=function(D){const P=Math.pow(10,`${Math.floor(D)}`.length-1);let F=D/P;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(U){const H=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*H)/H}(F),P*F}(u),S=w/u;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==g?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:g}).format(w):`${w}&nbsp;${Wf[g]}`,this._container.style.width=x*S+"px"})}onAdd(x){return this._map=x,this._language=x.getLanguage(),this._container=Kt("div","mapboxgl-ctrl mapboxgl-ctrl-scale",x.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(x){this._language=x,this._update()}setUnit(x){this.options.unit=x,this._update()}},FullscreenControl:class{constructor(x){this._fullscreen=!1,x&&x.container&&(x.container instanceof HTMLElement?this._container=x.container:_.w("Full screen control 'container' must be a DOM element.")),_.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=Kt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",_.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const x=this._fullscreenButton=Kt("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Kt("span","mapboxgl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",x)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends _.E{constructor(x){super(),this.options=_.e(Object.create(Sh),x),_.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(x&&x.className?x.className.trim().split(/\s+/):[])}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&x.on("preclick",this._onClose),this.options.closeOnMove&&x.on("move",this._onClose),x.on("remove",this.remove),this._update(),x._addPopup(this),this._focusFirstElement(),this._trackPointer?(x.on("mousemove",this._onMouseEvent),x.on("mouseup",this._onMouseEvent),x._canvasContainer.classList.add("mapboxgl-track-pointer")):x.on("move",this._update),this.fire(new _.b("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const x=this._map;return x&&(x.off("move",this._update),x.off("move",this._onClose),x.off("preclick",this._onClose),x.off("click",this._onClose),x.off("remove",this.remove),x.off("mousemove",this._onMouseEvent),x.off("mouseup",this._onMouseEvent),x.off("drag",this._onMouseEvent),x._canvasContainer&&x._canvasContainer.classList.remove("mapboxgl-track-pointer"),x._removePopup(this),this._map=void 0),this.fire(new _.b("close")),this}getLngLat(){return this._lngLat}setLngLat(x){this._lngLat=_.bn.convert(x),this._pos=null,this._trackPointer=!1,this._update();const u=this._map;return u&&(u.on("move",this._update),u.off("mousemove",this._onMouseEvent),u._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const x=this._map;return x&&(x.off("move",this._update),x.on("mousemove",this._onMouseEvent),x.on("drag",this._onMouseEvent),x._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(document.createTextNode(x))}setHTML(x){const u=document.createDocumentFragment(),g=document.createElement("body");let w;for(g.innerHTML=x;w=g.firstChild,w;)u.appendChild(w);return this.setDOMContent(u)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){let u=this._content;if(u)for(;u.hasChildNodes();)u.firstChild&&u.removeChild(u.firstChild);else u=this._content=Kt("div","mapboxgl-popup-content",this._container||void 0);if(u.appendChild(x),this.options.closeButton){const g=this._closeButton=Kt("button","mapboxgl-popup-close-button",u);g.type="button",g.setAttribute("aria-label","Close popup"),g.setAttribute("aria-hidden","true"),g.innerHTML="&#215;",g.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(x){return this._classList.add(x),this._updateClassList(),this}removeClassName(x){return this._classList.delete(x),this._updateClassList(),this}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){let u;return this._classList.delete(x)?u=!1:(this._classList.add(x),u=!0),this._updateClassList(),u}_onMouseEvent(x){this._update(x.point)}_getAnchor(x){if(this.options.anchor)return this.options.anchor;const u=this._map,g=this._container,w=this._pos;if(!u||!g||!w)return"bottom";const S=g.offsetWidth,D=g.offsetHeight,P=w.x<S/2,F=w.x>u.transform.width-S/2;if(w.y+x<D)return P?"top-left":F?"top-right":"top";if(w.y>u.transform.height-D){if(P)return"bottom-left";if(F)return"bottom-right"}return P?"left":F?"right":"bottom"}_updateClassList(){const x=this._container;if(!x)return;const u=[...this._classList];u.push("mapboxgl-popup"),this._anchor&&u.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&u.push("mapboxgl-popup-track-pointer"),x.className=u.join(" ")}_update(x){const u=this._map,g=this._content;if(!u||!this._lngLat&&!this._trackPointer||!g)return;let w=this._container;if(w||(w=this._container=Kt("div","mapboxgl-popup",u.getContainer()),this._tip=Kt("div","mapboxgl-popup-tip",w),w.appendChild(g)),this.options.maxWidth&&w.style.maxWidth!==this.options.maxWidth&&(w.style.maxWidth=this.options.maxWidth),u.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ds(this._lngLat,this._pos,u.transform)),!this._trackPointer||x){const S=this._pos=this._trackPointer&&x?x:u.project(this._lngLat),D=$l(this.options.offset),P=this._anchor=this._getAnchor(D.y),F=$l(this.options.offset,P),U=S.add(F).round();u._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${ha[P]} translate(${U.x}px,${U.y}px)`)})}if(!this._marker&&u._showingGlobe()){const S=_.d6(u.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(cp);x&&x.focus()}_onClose(){this.remove()}_setOpacity(x){this._container&&(this._container.style.opacity=`${x}`),this._content&&(this._content.style.pointerEvents=x?"auto":"none")}},Marker:Ig,Style:Gl,LngLat:_.bn,LngLatBounds:_.ad,Point:_.P,MercatorCoordinate:_.L,FreeCameraOptions:fc,Evented:_.E,config:_.d5,prewarm:_.dp,clearPrewarmedResources:_.dq,get accessToken(){return _.d5.ACCESS_TOKEN},set accessToken(x){_.d5.ACCESS_TOKEN=x},get baseApiUrl(){return _.d5.API_URL},set baseApiUrl(x){_.d5.API_URL=x},get workerCount(){return _.dr.workerCount},set workerCount(x){_.dr.workerCount=x},get maxParallelImageRequests(){return _.d5.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(x){_.d5.MAX_PARALLEL_IMAGE_REQUESTS=x},clearStorage(x){_.ds(x)},get workerUrl(){return _.dt.workerUrl},set workerUrl(x){_.dt.workerUrl=x},get workerClass(){return _.dt.workerClass},set workerClass(x){_.dt.workerClass=x},get workerParams(){return _.dt.workerParams},set workerParams(x){_.dt.workerParams=x},get dracoUrl(){return _.du()},set dracoUrl(x){_.dv(x)},get meshoptUrl(){return _.dw()},set meshoptUrl(x){_.dx(x)},setNow:_.f.setNow,restoreNow:_.f.restoreNow}}),o}()},412:(Go,Gn,It)=>{"use strict";It.d(Gn,{t:()=>Yt});var o=It(413);class Yt extends o.B{constructor(_){super(),this._value=_}get value(){return this.getValue()}_subscribe(_){const Tt=super._subscribe(_);return!Tt.closed&&_.next(this._value),Tt}getValue(){const{hasError:_,thrownError:Tt,_value:Si}=this;if(_)throw Tt;return this._throwIfClosed(),Si}next(_){super.next(this._value=_)}}},985:(Go,Gn,It)=>{"use strict";It.d(Gn,{c:()=>Ar});var o=It(707),Yt=It(359),Ai=It(494),_=It(203),Tt=It(26),Si=It(71),Ri=It(786);let Ar=(()=>{class Li{constructor(ji){ji&&(this._subscribe=ji)}lift(ji){const un=new Li;return un.source=this,un.operator=ji,un}subscribe(ji,un,tr){const bi=function Ft(Li){return Li&&Li instanceof o.vU||function ui(Li){return Li&&(0,Si.T)(Li.next)&&(0,Si.T)(Li.error)&&(0,Si.T)(Li.complete)}(Li)&&(0,Yt.Uv)(Li)}(ji)?ji:new o.Ms(ji,un,tr);return(0,Ri.Y)(()=>{const{operator:Di,source:ki}=this;bi.add(Di?Di.call(bi,ki):ki?this._subscribe(bi):this._trySubscribe(bi))}),bi}_trySubscribe(ji){try{return this._subscribe(ji)}catch(un){ji.error(un)}}forEach(ji,un){return new(un=Kt(un))((tr,bi)=>{const Di=new o.Ms({next:ki=>{try{ji(ki)}catch(Ki){bi(Ki),Di.unsubscribe()}},error:bi,complete:tr});this.subscribe(Di)})}_subscribe(ji){var un;return null===(un=this.source)||void 0===un?void 0:un.subscribe(ji)}[Ai.s](){return this}pipe(...ji){return(0,_.m)(ji)(this)}toPromise(ji){return new(ji=Kt(ji))((un,tr)=>{let bi;this.subscribe(Di=>bi=Di,Di=>tr(Di),()=>un(bi))})}}return Li.create=er=>new Li(er),Li})();function Kt(Li){var er;return null!==(er=Li??Tt.$.Promise)&&void 0!==er?er:Promise}},413:(Go,Gn,It)=>{"use strict";It.d(Gn,{B:()=>Ri});var o=It(985),Yt=It(359);const _=(0,It(853).L)(Kt=>function(){Kt(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Tt=It(908),Si=It(786);let Ri=(()=>{class Kt extends o.c{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Ft){const Li=new Ar(this,this);return Li.operator=Ft,Li}_throwIfClosed(){if(this.closed)throw new _}next(Ft){(0,Si.Y)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Li of this.currentObservers)Li.next(Ft)}})}error(Ft){(0,Si.Y)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Ft;const{observers:Li}=this;for(;Li.length;)Li.shift().error(Ft)}})}complete(){(0,Si.Y)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Ft}=this;for(;Ft.length;)Ft.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Ft;return(null===(Ft=this.observers)||void 0===Ft?void 0:Ft.length)>0}_trySubscribe(Ft){return this._throwIfClosed(),super._trySubscribe(Ft)}_subscribe(Ft){return this._throwIfClosed(),this._checkFinalizedStatuses(Ft),this._innerSubscribe(Ft)}_innerSubscribe(Ft){const{hasError:Li,isStopped:er,observers:ji}=this;return Li||er?Yt.Kn:(this.currentObservers=null,ji.push(Ft),new Yt.yU(()=>{this.currentObservers=null,(0,Tt.o)(ji,Ft)}))}_checkFinalizedStatuses(Ft){const{hasError:Li,thrownError:er,isStopped:ji}=this;Li?Ft.error(er):ji&&Ft.complete()}asObservable(){const Ft=new o.c;return Ft.source=this,Ft}}return Kt.create=(ui,Ft)=>new Ar(ui,Ft),Kt})();class Ar extends Ri{constructor(ui,Ft){super(),this.destination=ui,this.source=Ft}next(ui){var Ft,Li;null===(Li=null===(Ft=this.destination)||void 0===Ft?void 0:Ft.next)||void 0===Li||Li.call(Ft,ui)}error(ui){var Ft,Li;null===(Li=null===(Ft=this.destination)||void 0===Ft?void 0:Ft.error)||void 0===Li||Li.call(Ft,ui)}complete(){var ui,Ft;null===(Ft=null===(ui=this.destination)||void 0===ui?void 0:ui.complete)||void 0===Ft||Ft.call(ui)}_subscribe(ui){var Ft,Li;return null!==(Li=null===(Ft=this.source)||void 0===Ft?void 0:Ft.subscribe(ui))&&void 0!==Li?Li:Yt.Kn}}},707:(Go,Gn,It)=>{"use strict";It.d(Gn,{Ms:()=>tr,vU:()=>Li});var o=It(71),Yt=It(359),Ai=It(26),_=It(334),Tt=It(343);const Si=Kt("C",void 0,void 0);function Kt(mt,yi,en){return{kind:mt,value:yi,error:en}}var ui=It(270),Ft=It(786);class Li extends Yt.yU{constructor(yi){super(),this.isStopped=!1,yi?(this.destination=yi,(0,Yt.Uv)(yi)&&yi.add(this)):this.destination=Ki}static create(yi,en,mi){return new tr(yi,en,mi)}next(yi){this.isStopped?ki(function Ar(mt){return Kt("N",mt,void 0)}(yi),this):this._next(yi)}error(yi){this.isStopped?ki(function Ri(mt){return Kt("E",void 0,mt)}(yi),this):(this.isStopped=!0,this._error(yi))}complete(){this.isStopped?ki(Si,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(yi){this.destination.next(yi)}_error(yi){try{this.destination.error(yi)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const er=Function.prototype.bind;function ji(mt,yi){return er.call(mt,yi)}class un{constructor(yi){this.partialObserver=yi}next(yi){const{partialObserver:en}=this;if(en.next)try{en.next(yi)}catch(mi){bi(mi)}}error(yi){const{partialObserver:en}=this;if(en.error)try{en.error(yi)}catch(mi){bi(mi)}else bi(yi)}complete(){const{partialObserver:yi}=this;if(yi.complete)try{yi.complete()}catch(en){bi(en)}}}class tr extends Li{constructor(yi,en,mi){let Mn;if(super(),(0,o.T)(yi)||!yi)Mn={next:yi??void 0,error:en??void 0,complete:mi??void 0};else{let vn;this&&Ai.$.useDeprecatedNextContext?(vn=Object.create(yi),vn.unsubscribe=()=>this.unsubscribe(),Mn={next:yi.next&&ji(yi.next,vn),error:yi.error&&ji(yi.error,vn),complete:yi.complete&&ji(yi.complete,vn)}):Mn=yi}this.destination=new un(Mn)}}function bi(mt){Ai.$.useDeprecatedSynchronousErrorHandling?(0,Ft.l)(mt):(0,_.m)(mt)}function ki(mt,yi){const{onStoppedNotification:en}=Ai.$;en&&ui.f.setTimeout(()=>en(mt,yi))}const Ki={closed:!0,next:Tt.l,error:function Di(mt){throw mt},complete:Tt.l}},359:(Go,Gn,It)=>{"use strict";It.d(Gn,{Kn:()=>Si,yU:()=>Tt,Uv:()=>Ri});var o=It(71);const Ai=(0,It(853).L)(Kt=>function(Ft){Kt(this),this.message=Ft?`${Ft.length} errors occurred during unsubscription:\n${Ft.map((Li,er)=>`${er+1}) ${Li.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Ft});var _=It(908);class Tt{constructor(ui){this.initialTeardown=ui,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let ui;if(!this.closed){this.closed=!0;const{_parentage:Ft}=this;if(Ft)if(this._parentage=null,Array.isArray(Ft))for(const ji of Ft)ji.remove(this);else Ft.remove(this);const{initialTeardown:Li}=this;if((0,o.T)(Li))try{Li()}catch(ji){ui=ji instanceof Ai?ji.errors:[ji]}const{_finalizers:er}=this;if(er){this._finalizers=null;for(const ji of er)try{Ar(ji)}catch(un){ui=ui??[],un instanceof Ai?ui=[...ui,...un.errors]:ui.push(un)}}if(ui)throw new Ai(ui)}}add(ui){var Ft;if(ui&&ui!==this)if(this.closed)Ar(ui);else{if(ui instanceof Tt){if(ui.closed||ui._hasParent(this))return;ui._addParent(this)}(this._finalizers=null!==(Ft=this._finalizers)&&void 0!==Ft?Ft:[]).push(ui)}}_hasParent(ui){const{_parentage:Ft}=this;return Ft===ui||Array.isArray(Ft)&&Ft.includes(ui)}_addParent(ui){const{_parentage:Ft}=this;this._parentage=Array.isArray(Ft)?(Ft.push(ui),Ft):Ft?[Ft,ui]:ui}_removeParent(ui){const{_parentage:Ft}=this;Ft===ui?this._parentage=null:Array.isArray(Ft)&&(0,_.o)(Ft,ui)}remove(ui){const{_finalizers:Ft}=this;Ft&&(0,_.o)(Ft,ui),ui instanceof Tt&&ui._removeParent(this)}}Tt.EMPTY=(()=>{const Kt=new Tt;return Kt.closed=!0,Kt})();const Si=Tt.EMPTY;function Ri(Kt){return Kt instanceof Tt||Kt&&"closed"in Kt&&(0,o.T)(Kt.remove)&&(0,o.T)(Kt.add)&&(0,o.T)(Kt.unsubscribe)}function Ar(Kt){(0,o.T)(Kt)?Kt():Kt.unsubscribe()}},26:(Go,Gn,It)=>{"use strict";It.d(Gn,{$:()=>o});const o={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},360:(Go,Gn,It)=>{"use strict";It.d(Gn,{_:()=>Yt});var o=It(707);function Yt(_,Tt,Si,Ri,Ar){return new Ai(_,Tt,Si,Ri,Ar)}class Ai extends o.vU{constructor(Tt,Si,Ri,Ar,Kt,ui){super(Tt),this.onFinalize=Kt,this.shouldUnsubscribe=ui,this._next=Si?function(Ft){try{Si(Ft)}catch(Li){Tt.error(Li)}}:super._next,this._error=Ar?function(Ft){try{Ar(Ft)}catch(Li){Tt.error(Li)}finally{this.unsubscribe()}}:super._error,this._complete=Ri?function(){try{Ri()}catch(Ft){Tt.error(Ft)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Tt;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Si}=this;super.unsubscribe(),!Si&&(null===(Tt=this.onFinalize)||void 0===Tt||Tt.call(this))}}}},354:(Go,Gn,It)=>{"use strict";It.d(Gn,{T:()=>Ai});var o=It(974),Yt=It(360);function Ai(_,Tt){return(0,o.N)((Si,Ri)=>{let Ar=0;Si.subscribe((0,Yt._)(Ri,Kt=>{Ri.next(_.call(Tt,Kt,Ar++))}))})}},270:(Go,Gn,It)=>{"use strict";It.d(Gn,{f:()=>o});const o={setTimeout(Yt,Ai,..._){const{delegate:Tt}=o;return Tt?.setTimeout?Tt.setTimeout(Yt,Ai,..._):setTimeout(Yt,Ai,..._)},clearTimeout(Yt){const{delegate:Ai}=o;return(Ai?.clearTimeout||clearTimeout)(Yt)},delegate:void 0}},494:(Go,Gn,It)=>{"use strict";It.d(Gn,{s:()=>o});const o="function"==typeof Symbol&&Symbol.observable||"@@observable"},908:(Go,Gn,It)=>{"use strict";function o(Yt,Ai){if(Yt){const _=Yt.indexOf(Ai);0<=_&&Yt.splice(_,1)}}It.d(Gn,{o:()=>o})},853:(Go,Gn,It)=>{"use strict";function o(Yt){const _=Yt(Tt=>{Error.call(Tt),Tt.stack=(new Error).stack});return _.prototype=Object.create(Error.prototype),_.prototype.constructor=_,_}It.d(Gn,{L:()=>o})},786:(Go,Gn,It)=>{"use strict";It.d(Gn,{Y:()=>Ai,l:()=>_});var o=It(26);let Yt=null;function Ai(Tt){if(o.$.useDeprecatedSynchronousErrorHandling){const Si=!Yt;if(Si&&(Yt={errorThrown:!1,error:null}),Tt(),Si){const{errorThrown:Ri,error:Ar}=Yt;if(Yt=null,Ri)throw Ar}}else Tt()}function _(Tt){o.$.useDeprecatedSynchronousErrorHandling&&Yt&&(Yt.errorThrown=!0,Yt.error=Tt)}},669:(Go,Gn,It)=>{"use strict";function o(Yt){return Yt}It.d(Gn,{D:()=>o})},71:(Go,Gn,It)=>{"use strict";function o(Yt){return"function"==typeof Yt}It.d(Gn,{T:()=>o})},974:(Go,Gn,It)=>{"use strict";It.d(Gn,{N:()=>Ai,S:()=>Yt});var o=It(71);function Yt(_){return(0,o.T)(_?.lift)}function Ai(_){return Tt=>{if(Yt(Tt))return Tt.lift(function(Si){try{return _(Si,this)}catch(Ri){this.error(Ri)}});throw new TypeError("Unable to lift unknown Observable type")}}},343:(Go,Gn,It)=>{"use strict";function o(){}It.d(Gn,{l:()=>o})},203:(Go,Gn,It)=>{"use strict";It.d(Gn,{F:()=>Yt,m:()=>Ai});var o=It(669);function Yt(..._){return Ai(_)}function Ai(_){return 0===_.length?o.D:1===_.length?_[0]:function(Si){return _.reduce((Ri,Ar)=>Ar(Ri),Si)}}},334:(Go,Gn,It)=>{"use strict";It.d(Gn,{m:()=>Ai});var o=It(26),Yt=It(270);function Ai(_){Yt.f.setTimeout(()=>{const{onUnhandledError:Tt}=o.$;if(!Tt)throw _;Tt(_)})}},720:()=>{},194:()=>{},236:()=>{},676:()=>{},611:()=>{},449:()=>{},953:(Go,Gn,It)=>{"use strict";function o(c,h){return Object.is(c,h)}It.d(Gn,{bc$:()=>jC,iLQ:()=>ND,sZ2:()=>Ty,hnV:()=>kN,wjH:()=>M,Hbi:()=>HU,o8S:()=>_u,BIS:()=>Mv,gRc:()=>ZR,Ql9:()=>EU,OM3:()=>cb,Ocv:()=>HR,abz:()=>bp,Z63:()=>Vc,aKT:()=>_v,uvJ:()=>ua,zcH:()=>Pl,bkB:()=>Yu,$GK:()=>Cr,nKC:()=>Qn,zZn:()=>Pa,_q3:()=>og,MKu:()=>qD,xe9:()=>ix,Co$:()=>FI,Vns:()=>x_,SKi:()=>fs,Xx1:()=>Af,Agw:()=>UC,PLl:()=>nM,rOR:()=>vy,sFG:()=>eA,_9s:()=>Tc,czy:()=>Aw,WPN:()=>Dp,FRM:()=>ce,kdw:()=>Df,C4Q:()=>eh,NYb:()=>OD,giA:()=>tx,RxE:()=>LT,c1b:()=>Gi,gXe:()=>ao,mal:()=>V,Tzd:()=>L,Af3:()=>Gc,L39:()=>p5,EWP:()=>x5,Ol2:()=>sA,w6W:()=>PL,QZP:()=>w3,Rfq:()=>Cl,oKB:()=>Lf,WQX:()=>Tn,naY:()=>WD,Hps:()=>Xp,QuC:()=>na,EmA:()=>rp,Udg:()=>g5,HJs:()=>S5,N4e:()=>vo,vPA:()=>GE,O8t:()=>w5,H3F:()=>SD,H8p:()=>Ag,KH2:()=>w1,TgB:()=>qu,wOt:()=>Ue,WHO:()=>PD,e01:()=>V1,lNU:()=>$e,h9k:()=>tE,$MX:()=>qg,ZF7:()=>Xg,Kcf:()=>yw,e5t:()=>nI,UyX:()=>tI,cWb:()=>Rv,osQ:()=>iI,H5H:()=>WA,Zy3:()=>Ct,mq5:()=>XA,JZv:()=>fo,TL3:()=>U1,LfX:()=>Xb,plB:()=>ne,jNT:()=>z1,zjR:()=>DN,ngT:()=>hl,TL$:()=>mw,Tbb:()=>Xs,rcV:()=>Bh,Vt3:()=>PI,GFd:()=>RL,OA$:()=>se,Jv_:()=>pD,aNF:()=>gD,R7$:()=>jv,BMQ:()=>EA,HbH:()=>wb,ZvI:()=>c2,AVh:()=>dT,vxM:()=>B0,wni:()=>Nd,VBU:()=>ip,FsC:()=>ny,jDH:()=>zo,G2t:()=>Eu,$C:()=>tl,EJ8:()=>av,rXU:()=>Dd,nrm:()=>b1,eu8:()=>z0,bVm:()=>Eb,qex:()=>y1,k0s:()=>Qh,j41:()=>Om,RV6:()=>qa,xGo:()=>em,Mr5:()=>T_,KVO:()=>ba,kS0:()=>Xu,QTQ:()=>Xy,bIt:()=>iD,lsd:()=>Y0,joV:()=>ql,qSk:()=>mo,XpG:()=>G2,nI1:()=>AT,bMT:()=>_R,i5U:()=>vR,SdG:()=>$2,NAR:()=>H2,Y8G:()=>L0,lJ4:()=>gR,eq3:()=>YF,l_i:()=>D_,mGM:()=>Q2,sdS:()=>tf,Dyx:()=>GA,Z7z:()=>fT,fX1:()=>V0,Vm6:()=>f2,Njj:()=>vc,tSv:()=>Mw,eBV:()=>nl,B4B:()=>nE,n$t:()=>oE,Aen:()=>dh,xc7:()=>cT,Kam:()=>nD,zvX:()=>pT,DNE:()=>cA,C5r:()=>yR,EFF:()=>lD,JRh:()=>wT,SpI:()=>R1,Lme:()=>P1,E5c:()=>uD,DH7:()=>fR,mxI:()=>CT,R50:()=>hD,GBs:()=>K2});let Yt=null,Ai=!1,_=1;const Tt=Symbol("SIGNAL");function Si(c){const h=Yt;return Yt=c,h}const ui={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Ft(c){if(Ai)throw new Error("");if(null===Yt)return;Yt.consumerOnSignalRead(c);const h=Yt.nextProducerIndex++;mi(Yt),h<Yt.producerNode.length&&Yt.producerNode[h]!==c&&en(Yt)&&yi(Yt.producerNode[h],Yt.producerIndexOfThis[h]),Yt.producerNode[h]!==c&&(Yt.producerNode[h]=c,Yt.producerIndexOfThis[h]=en(Yt)?mt(c,Yt,h):0),Yt.producerLastReadVersion[h]=c.version}function er(c){if((!en(c)||c.dirty)&&(c.dirty||c.lastCleanEpoch!==_)){if(!c.producerMustRecompute(c)&&!ki(c))return c.dirty=!1,void(c.lastCleanEpoch=_);c.producerRecomputeValue(c),c.dirty=!1,c.lastCleanEpoch=_}}function ji(c){if(void 0===c.liveConsumerNode)return;const h=Ai;Ai=!0;try{for(const p of c.liveConsumerNode)p.dirty||tr(p)}finally{Ai=h}}function un(){return!1!==Yt?.consumerAllowSignalWrites}function tr(c){c.dirty=!0,ji(c),c.consumerMarkedDirty?.(c)}function bi(c){return c&&(c.nextProducerIndex=0),Si(c)}function Di(c,h){if(Si(h),c&&void 0!==c.producerNode&&void 0!==c.producerIndexOfThis&&void 0!==c.producerLastReadVersion){if(en(c))for(let p=c.nextProducerIndex;p<c.producerNode.length;p++)yi(c.producerNode[p],c.producerIndexOfThis[p]);for(;c.producerNode.length>c.nextProducerIndex;)c.producerNode.pop(),c.producerLastReadVersion.pop(),c.producerIndexOfThis.pop()}}function ki(c){mi(c);for(let h=0;h<c.producerNode.length;h++){const p=c.producerNode[h],b=c.producerLastReadVersion[h];if(b!==p.version||(er(p),b!==p.version))return!0}return!1}function Ki(c){if(mi(c),en(c))for(let h=0;h<c.producerNode.length;h++)yi(c.producerNode[h],c.producerIndexOfThis[h]);c.producerNode.length=c.producerLastReadVersion.length=c.producerIndexOfThis.length=0,c.liveConsumerNode&&(c.liveConsumerNode.length=c.liveConsumerIndexOfThis.length=0)}function mt(c,h,p){if(Mn(c),0===c.liveConsumerNode.length&&vn(c))for(let b=0;b<c.producerNode.length;b++)c.producerIndexOfThis[b]=mt(c.producerNode[b],c,b);return c.liveConsumerIndexOfThis.push(p),c.liveConsumerNode.push(h)-1}function yi(c,h){if(Mn(c),1===c.liveConsumerNode.length&&vn(c))for(let b=0;b<c.producerNode.length;b++)yi(c.producerNode[b],c.producerIndexOfThis[b]);const p=c.liveConsumerNode.length-1;if(c.liveConsumerNode[h]=c.liveConsumerNode[p],c.liveConsumerIndexOfThis[h]=c.liveConsumerIndexOfThis[p],c.liveConsumerNode.length--,c.liveConsumerIndexOfThis.length--,h<c.liveConsumerNode.length){const b=c.liveConsumerIndexOfThis[h],T=c.liveConsumerNode[h];mi(T),T.producerIndexOfThis[b]=h}}function en(c){return c.consumerIsAlwaysLive||(c?.liveConsumerNode?.length??0)>0}function mi(c){c.producerNode??=[],c.producerIndexOfThis??=[],c.producerLastReadVersion??=[]}function Mn(c){c.liveConsumerNode??=[],c.liveConsumerIndexOfThis??=[]}function vn(c){return void 0!==c.producerNode}const Vn=Symbol("UNSET"),yn=Symbol("COMPUTING"),Ii=Symbol("ERRORED"),an={...ui,value:Vn,dirty:!0,error:null,equal:o,producerMustRecompute:c=>c.value===Vn||c.value===yn,producerRecomputeValue(c){if(c.value===yn)throw new Error("Detected cycle in computations.");const h=c.value;c.value=yn;const p=bi(c);let b;try{b=c.computation()}catch(T){b=Ii,c.error=T}finally{Di(c,p)}h!==Vn&&h!==Ii&&b!==Ii&&c.equal(h,b)?c.value=h:(c.value=b,c.version++)}};let uo=function Vr(){throw new Error};function Hr(){uo()}let va=null;function Eo(c,h){un()||Hr(),c.equal(c.value,h)||(c.value=h,function la(c){c.version++,function Li(){_++}(),ji(c),va?.()}(c))}const No={...ui,equal:o,value:void 0};const Ge=()=>{},Qe={...ui,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:c=>{null!==c.schedule&&c.schedule(c.ref)},hasRun:!1,cleanupFn:Ge};var Xt=It(412),kt=It(413),qt=It(359),Bt=It(354);typeof navigator<"u"&&navigator,typeof navigator<"u"&&!/Opera/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||navigator),typeof navigator<"u"&&!/Opera|WebKit/.test(navigator.userAgent)&&navigator,typeof navigator<"u"&&navigator;const $e="https://g.co/ng/security#xss";class Ue extends Error{constructor(h,p){super(Ct(h,p)),this.code=h}}function Ct(c,h){return`NG0${Math.abs(c)}${h?": "+h:""}`}function pr(c){return{toString:c}.toString()}const Ja="__parameters__";function Ga(c,h,p){return pr(()=>{const b=function ja(c){return function(...p){if(c){const b=c(...p);for(const T in b)this[T]=b[T]}}}(h);function T(...I){if(this instanceof T)return b.apply(this,I),this;const B=new T(...I);return G.annotation=B,G;function G(Y,oe,ue){const Pe=Y.hasOwnProperty(Ja)?Y[Ja]:Object.defineProperty(Y,Ja,{value:[]})[Ja];for(;Pe.length<=ue;)Pe.push(null);return(Pe[ue]=Pe[ue]||[]).push(B),Y}}return p&&(T.prototype=Object.create(p.prototype)),T.prototype.ngMetadataName=c,T.annotationCls=T,T})}const fo=globalThis;function Nt(c){for(let h in c)if(c[h]===Nt)return h;throw Error("Could not find renamed property on target object.")}function Um(c,h){for(const p in h)h.hasOwnProperty(p)&&!c.hasOwnProperty(p)&&(c[p]=h[p])}function Xs(c){if("string"==typeof c)return c;if(Array.isArray(c))return"["+c.map(Xs).join(", ")+"]";if(null==c)return""+c;if(c.overriddenName)return`${c.overriddenName}`;if(c.name)return`${c.name}`;const h=c.toString();if(null==h)return""+h;const p=h.indexOf("\n");return-1===p?h:h.substring(0,p)}function Cu(c,h){return null==c||""===c?null===h?"":h:null==h||""===h?c:c+" "+h}const uc=Nt({__forward_ref__:Nt});function Cl(c){return c.__forward_ref__=Cl,c.toString=function(){return Xs(this())},c}function gr(c){return hc(c)?c():c}function hc(c){return"function"==typeof c&&c.hasOwnProperty(uc)&&c.__forward_ref__===Cl}function zo(c){return{token:c.token,providedIn:c.providedIn||null,factory:c.factory,value:void 0}}function Eu(c){return{providers:c.providers||[],imports:c.imports||[]}}function $d(c){return fc(c,Tu)||fc(c,qs)}function Xb(c){return null!==$d(c)}function fc(c,h){return c.hasOwnProperty(h)?c[h]:null}function ad(c){return c&&(c.hasOwnProperty(Wd)||c.hasOwnProperty(Su))?c[Wd]:null}const Tu=Nt({\u0275prov:Nt}),Wd=Nt({\u0275inj:Nt}),qs=Nt({ngInjectableDef:Nt}),Su=Nt({ngInjectorDef:Nt});class Qn{constructor(h,p){this._desc=h,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof p?this.__NG_ELEMENT_ID__=p:void 0!==p&&(this.\u0275prov=zo({token:this,providedIn:p.providedIn||"root",factory:p.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Xm(c){return c&&!!c.\u0275providers}const yf=Nt({\u0275cmp:Nt}),xf=Nt({\u0275dir:Nt}),Gl=Nt({\u0275pipe:Nt}),qm=Nt({\u0275mod:Nt}),pc=Nt({\u0275fac:Nt}),Mu=Nt({__NG_ELEMENT_ID__:Nt}),Ym=Nt({__NG_ENV_ID__:Nt});function Dr(c){return"string"==typeof c?c:null==c?"":String(c)}function Au(c,h){throw new Ue(-201,!1)}var Cr=function(c){return c[c.Default=0]="Default",c[c.Host=1]="Host",c[c.Self=2]="Self",c[c.SkipSelf=4]="SkipSelf",c[c.Optional=8]="Optional",c}(Cr||{});let qd;function _g(){return qd}function Ia(c){const h=qd;return qd=c,h}function vg(c,h,p){const b=$d(c);return b&&"root"==b.providedIn?void 0===b.value?b.value=b.factory():b.value:p&Cr.Optional?null:void 0!==h?h:void Au()}const Ef={},Yb="__NG_DI_FLAG__",os="ngTempTokenPath",Q_=/\n/gm,Tf="__source";let Sf;function Hl(c){const h=Sf;return Sf=c,h}function J_(c,h=Cr.Default){if(void 0===Sf)throw new Ue(-203,!1);return null===Sf?vg(c,void 0,h):Sf.get(c,h&Cr.Optional?null:void 0,h)}function ba(c,h=Cr.Default){return(_g()||J_)(gr(c),h)}function Tn(c,h=Cr.Default){return ba(c,Jm(h))}function Jm(c){return typeof c>"u"||"number"==typeof c?c:(c.optional&&8)|(c.host&&1)|(c.self&&2)|(c.skipSelf&&4)}function Mf(c){const h=[];for(let p=0;p<c.length;p++){const b=gr(c[p]);if(Array.isArray(b)){if(0===b.length)throw new Ue(900,!1);let T,I=Cr.Default;for(let B=0;B<b.length;B++){const G=b[B],Y=ev(G);"number"==typeof Y?-1===Y?T=G.token:I|=Y:T=G}h.push(ba(T,I))}else h.push(ba(b))}return h}function bg(c,h){return c[Yb]=h,c.prototype[Yb]=h,c}function ev(c){return c[Yb]}const Af=bg(Ga("Optional"),8),Df=bg(Ga("SkipSelf"),4);function ku(c,h){return c.hasOwnProperty(pc)?c[pc]:null}function Bc(c,h){c.forEach(p=>Array.isArray(p)?Bc(p,h):h(p))}function yg(c,h,p){h>=c.length?c.push(p):c.splice(h,0,p)}function Zd(c,h){return h>=c.length-1?c.pop():c.splice(h,1)[0]}function el(c,h,p){let b=Iu(c,h);return b>=0?c[1|b]=p:(b=~b,function iv(c,h,p,b){let T=c.length;if(T==h)c.push(p,b);else if(1===T)c.push(b,c[0]),c[0]=p;else{for(T--,c.push(c[T-1],c[T]);T>h;)c[T]=c[T-2],T--;c[h]=p,c[h+1]=b}}(c,b,h,p)),b}function wg(c,h){const p=Iu(c,h);if(p>=0)return c[1|p]}function Iu(c,h){return function Rx(c,h,p){let b=0,T=c.length>>p;for(;T!==b;){const I=b+(T-b>>1),B=c[I<<p];if(h===B)return I<<p;B>h?T=I:b=I+1}return~(T<<p)}(c,h,1)}const Kd={},yo=[],Vc=new Qn(""),ep=new Qn("",-1),If=new Qn("");class Ru{get(h,p=Ef){if(p===Ef){const b=new Error(`NullInjectorError: No provider for ${Xs(h)}!`);throw b.name="NullInjectorError",b}return p}}var Rf=function(c){return c[c.OnPush=0]="OnPush",c[c.Default=1]="Default",c}(Rf||{}),ao=function(c){return c[c.Emulated=0]="Emulated",c[c.None=2]="None",c[c.ShadowDom=3]="ShadowDom",c}(ao||{}),Pu=function(c){return c[c.None=0]="None",c[c.SignalBased=1]="SignalBased",c[c.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",c}(Pu||{});function Eg(c,h,p){let b=c.length;for(;;){const T=c.indexOf(h,p);if(-1===T)return T;if(0===T||c.charCodeAt(T-1)<=32){const I=h.length;if(T+I===b||c.charCodeAt(T+I)<=32)return T}p=T+1}}function Pf(c,h,p){let b=0;for(;b<p.length;){const T=p[b];if("number"==typeof T){if(0!==T)break;b++;const I=p[b++],B=p[b++],G=p[b++];c.setAttribute(h,B,G,I)}else{const I=T,B=p[++b];zc(I)?c.setProperty(h,I,B):c.setAttribute(h,I,B),b++}}return b}function Px(c){return 3===c||4===c||6===c}function zc(c){return 64===c.charCodeAt(0)}function El(c,h){if(null!==h&&0!==h.length)if(null===c||0===c.length)c=h.slice();else{let p=-1;for(let b=0;b<h.length;b++){const T=h[b];"number"==typeof T?p=T:0===p||Qd(c,p,T,null,-1===p||2===p?h[++b]:null)}}return c}function Qd(c,h,p,b,T){let I=0,B=c.length;if(-1===h)B=-1;else for(;I<c.length;){const G=c[I++];if("number"==typeof G){if(G===h){B=-1;break}if(G>h){B=I-1;break}}}for(;I<c.length;){const G=c[I];if("number"==typeof G)break;if(G===p){if(null===b)return void(null!==T&&(c[I+1]=T));if(b===c[I+1])return void(c[I+2]=T)}I++,null!==b&&I++,null!==T&&I++}-1!==B&&(c.splice(B,0,h),I=B+1),c.splice(I++,0,p),null!==b&&c.splice(I++,0,b),null!==T&&c.splice(I++,0,T)}const Of="ng-template";function Oi(c,h,p,b){let T=0;if(b){for(;T<h.length&&"string"==typeof h[T];T+=2)if("class"===h[T]&&-1!==Eg(h[T+1].toLowerCase(),p,0))return!0}else if(nv(c))return!1;if(T=h.indexOf(1,T),T>-1){let I;for(;++T<h.length&&"string"==typeof(I=h[T]);)if(I.toLowerCase()===p)return!0}return!1}function nv(c){return 4===c.type&&c.value!==Of}function rv(c,h,p){return h===(4!==c.type||p?c.value:Of)}function Jd(c,h,p){let b=4;const T=c.attrs,I=null!==T?function pC(c){for(let h=0;h<c.length;h++)if(Px(c[h]))return h;return c.length}(T):0;let B=!1;for(let G=0;G<h.length;G++){const Y=h[G];if("number"!=typeof Y){if(!B)if(4&b){if(b=2|1&b,""!==Y&&!rv(c,Y,p)||""===Y&&1===h.length){if(Ra(b))return!1;B=!0}}else if(8&b){if(null===T||!Oi(c,T,Y,p)){if(Ra(b))return!1;B=!0}}else{const oe=h[++G],ue=Wi(Y,T,nv(c),p);if(-1===ue){if(Ra(b))return!1;B=!0;continue}if(""!==oe){let Pe;if(Pe=ue>I?"":T[ue+1].toLowerCase(),2&b&&oe!==Pe){if(Ra(b))return!1;B=!0}}}}else{if(!B&&!Ra(b)&&!Ra(Y))return!1;if(B&&Ra(Y))continue;B=!1,b=Y|1&b}}return Ra(b)||B}function Ra(c){return!(1&c)}function Wi(c,h,p,b){if(null===h)return-1;let T=0;if(b||!p){let I=!1;for(;T<h.length;){const B=h[T];if(B===c)return T;if(3===B||6===B)I=!0;else{if(1===B||2===B){let G=h[++T];for(;"string"==typeof G;)G=h[++T];continue}if(4===B)break;if(0===B){T+=4;continue}}T+=I?1:2}return-1}return function ey(c,h){let p=c.indexOf(4);if(p>-1)for(p++;p<c.length;){const b=c[p];if("number"==typeof b)return-1;if(b===h)return p;p++}return-1}(h,c)}function Uc(c,h,p=!1){for(let b=0;b<h.length;b++)if(Jd(c,h[b],p))return!0;return!1}function ov(c,h){e:for(let p=0;p<h.length;p++){const b=h[p];if(c.length===b.length){for(let T=0;T<c.length;T++)if(c[T]!==b[T])continue e;return!0}}return!1}function Tg(c,h){return c?":not("+h.trim()+")":h}function Ox(c){let h=c[0],p=1,b=2,T="",I=!1;for(;p<c.length;){let B=c[p];if("string"==typeof B)if(2&b){const G=c[++p];T+="["+B+(G.length>0?'="'+G+'"':"")+"]"}else 8&b?T+="."+B:4&b&&(T+=" "+B);else""!==T&&!Ra(B)&&(h+=Tg(I,T),T=""),b=B,I=I||!Ra(b);p++}return""!==T&&(h+=Tg(I,T)),h}function ip(c){return pr(()=>{const h=np(c),p={...h,decls:c.decls,vars:c.vars,template:c.template,consts:c.consts||null,ngContentSelectors:c.ngContentSelectors,onPush:c.changeDetection===Rf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:h.standalone&&c.dependencies||null,getStandaloneInjector:null,signals:c.signals??!1,data:c.data||{},encapsulation:c.encapsulation||ao.Emulated,styles:c.styles||yo,_:null,schemas:c.schemas||null,tView:null,id:""};lv(p);const b=c.dependencies;return p.directiveDefs=gc(b,!1),p.pipeDefs=gc(b,!0),p.id=function yh(c){let h=0;const p=[c.selectors,c.ngContentSelectors,c.hostVars,c.hostAttrs,c.consts,c.vars,c.decls,c.encapsulation,c.standalone,c.signals,c.exportAs,JSON.stringify(c.inputs),JSON.stringify(c.outputs),Object.getOwnPropertyNames(c.type.prototype),!!c.contentQueries,!!c.viewQuery].join("|");for(const T of p)h=Math.imul(31,h)+T.charCodeAt(0)|0;return h+=2147483648,"c"+h}(p),p})}function Sg(c){return no(c)||ps(c)}function sv(c){return null!==c}function tl(c){return pr(()=>({type:c.type,bootstrap:c.bootstrap||yo,declarations:c.declarations||yo,imports:c.imports||yo,exports:c.exports||yo,transitiveCompileScopes:null,schemas:c.schemas||null,id:c.id||null}))}function Ou(c,h){if(null==c)return Kd;const p={};for(const b in c)if(c.hasOwnProperty(b)){const T=c[b];let I,B,G=Pu.None;Array.isArray(T)?(G=T[0],I=T[1],B=T[2]??I):(I=T,B=T),h?(p[I]=G!==Pu.None?[b,G]:b,h[I]=B):p[I]=b}return p}function ny(c){return pr(()=>{const h=np(c);return lv(h),h})}function av(c){return{type:c.type,name:c.name,factory:null,pure:!1!==c.pure,standalone:!0===c.standalone,onDestroy:c.type.prototype.ngOnDestroy||null}}function no(c){return c[yf]||null}function ps(c){return c[xf]||null}function ya(c){return c[Gl]||null}function na(c){const h=no(c)||ps(c)||ya(c);return null!==h&&h.standalone}function qr(c,h){const p=c[qm]||null;if(!p&&!0===h)throw new Error(`Type ${Xs(c)} does not have '\u0275mod' property.`);return p}function np(c){const h={};return{type:c.type,providersResolver:null,factory:null,hostBindings:c.hostBindings||null,hostVars:c.hostVars||0,hostAttrs:c.hostAttrs||null,contentQueries:c.contentQueries||null,declaredInputs:h,inputTransforms:null,inputConfig:c.inputs||Kd,exportAs:c.exportAs||null,standalone:!0===c.standalone,signals:!0===c.signals,selectors:c.selectors||yo,viewQuery:c.viewQuery||null,features:c.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Ou(c.inputs,h),outputs:Ou(c.outputs),debugInfo:null}}function lv(c){c.features?.forEach(h=>h(c))}function gc(c,h){if(!c)return null;const p=h?ya:Sg;return()=>("function"==typeof c?c():c).map(b=>p(b)).filter(sv)}function rp(c){return{\u0275providers:c}}function Lf(...c){return{\u0275providers:Ff(0,c),\u0275fromNgModule:!0}}function Ff(c,...h){const p=[],b=new Set;let T;const I=B=>{p.push(B)};return Bc(h,B=>{const G=B;Ji(G,I,[],b)&&(T||=[],T.push(G))}),void 0!==T&&ni(T,I),p}function ni(c,h){for(let p=0;p<c.length;p++){const{ngModule:b,providers:T}=c[p];$o(T,I=>{h(I,b)})}}function Ji(c,h,p,b){if(!(c=gr(c)))return!1;let T=null,I=ad(c);const B=!I&&no(c);if(I||B){if(B&&!B.standalone)return!1;T=c}else{const Y=c.ngModule;if(I=ad(Y),!I)return!1;T=Y}const G=b.has(T);if(B){if(G)return!1;if(b.add(T),B.dependencies){const Y="function"==typeof B.dependencies?B.dependencies():B.dependencies;for(const oe of Y)Ji(oe,h,p,b)}}else{if(!I)return!1;{if(null!=I.imports&&!G){let oe;b.add(T);try{Bc(I.imports,ue=>{Ji(ue,h,p,b)&&(oe||=[],oe.push(ue))})}finally{}void 0!==oe&&ni(oe,h)}if(!G){const oe=ku(T)||(()=>new T);h({provide:T,useFactory:oe,deps:yo},T),h({provide:If,useValue:T,multi:!0},T),h({provide:Vc,useValue:()=>ba(T),multi:!0},T)}const Y=I.providers;if(null!=Y&&!G){const oe=c;$o(Y,ue=>{h(ue,oe)})}}}return T!==c&&void 0!==c.providers}function $o(c,h){for(let p of c)Xm(p)&&(p=p.\u0275providers),Array.isArray(p)?$o(p,h):h(p)}const Mg=Nt({provide:String,useValue:Nt});function Nf(c){return null!==c&&"object"==typeof c&&Mg in c}function Fs(c){return"function"==typeof c}const Ag=new Qn(""),So={},gs={};let As;function Ur(){return void 0===As&&(As=new Ru),As}class ua{}class jc extends ua{get destroyed(){return this._destroyed}constructor(h,p,b,T){super(),this.parent=p,this.source=b,this.scopes=T,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Vf(h,B=>this.processProvider(B)),this.records.set(ep,xa(void 0,this)),T.has("environment")&&this.records.set(ua,xa(void 0,this));const I=this.records.get(Ag);null!=I&&"string"==typeof I.value&&this.scopes.add(I.value),this.injectorDefTypes=new Set(this.get(If,yo,Cr.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const h=Si(null);try{for(const b of this._ngOnDestroyHooks)b.ngOnDestroy();const p=this._onDestroyHooks;this._onDestroyHooks=[];for(const b of p)b()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Si(h)}}onDestroy(h){return this.assertNotDestroyed(),this._onDestroyHooks.push(h),()=>this.removeOnDestroy(h)}runInContext(h){this.assertNotDestroyed();const p=Hl(this),b=Ia(void 0);try{return h()}finally{Hl(p),Ia(b)}}get(h,p=Ef,b=Cr.Default){if(this.assertNotDestroyed(),h.hasOwnProperty(Ym))return h[Ym](this);b=Jm(b);const I=Hl(this),B=Ia(void 0);try{if(!(b&Cr.SkipSelf)){let Y=this.records.get(h);if(void 0===Y){const oe=function dv(c){return"function"==typeof c||"object"==typeof c&&c instanceof Qn}(h)&&$d(h);Y=oe&&this.injectableDefInScope(oe)?xa(sp(h),So):null,this.records.set(h,Y)}if(null!=Y)return this.hydrate(h,Y)}return(b&Cr.Self?Ur():this.parent).get(h,p=b&Cr.Optional&&p===Ef?null:p)}catch(G){if("NullInjectorError"===G.name){if((G[os]=G[os]||[]).unshift(Xs(h)),I)throw G;return function kx(c,h,p,b){const T=c[os];throw h[Tf]&&T.unshift(h[Tf]),c.message=function tv(c,h,p,b=null){c=c&&"\n"===c.charAt(0)&&"\u0275"==c.charAt(1)?c.slice(2):c;let T=Xs(h);if(Array.isArray(h))T=h.map(Xs).join(" -> ");else if("object"==typeof h){let I=[];for(let B in h)if(h.hasOwnProperty(B)){let G=h[B];I.push(B+":"+("string"==typeof G?JSON.stringify(G):Xs(G)))}T=`{${I.join(", ")}}`}return`${p}${b?"("+b+")":""}[${T}]: ${c.replace(Q_,"\n  ")}`}("\n"+c.message,T,p,b),c.ngTokenPath=T,c[os]=null,c}(G,h,"R3InjectorError",this.source)}throw G}finally{Ia(B),Hl(I)}}resolveInjectorInitializers(){const h=Si(null),p=Hl(this),b=Ia(void 0);try{const I=this.get(Vc,yo,Cr.Self);for(const B of I)B()}finally{Hl(p),Ia(b),Si(h)}}toString(){const h=[],p=this.records;for(const b of p.keys())h.push(Xs(b));return`R3Injector[${h.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ue(205,!1)}processProvider(h){let p=Fs(h=gr(h))?h:gr(h&&h.provide);const b=function ld(c){return Nf(c)?xa(void 0,c.useValue):xa(Oo(c),So)}(h);if(!Fs(h)&&!0===h.multi){let T=this.records.get(p);T||(T=xa(void 0,So,!0),T.factory=()=>Mf(T.multi),this.records.set(p,T)),p=h,T.multi.push(h)}this.records.set(p,b)}hydrate(h,p){const b=Si(null);try{return p.value===So&&(p.value=gs,p.value=p.factory()),"object"==typeof p.value&&p.value&&function Tl(c){return null!==c&&"object"==typeof c&&"function"==typeof c.ngOnDestroy}(p.value)&&this._ngOnDestroyHooks.add(p.value),p.value}finally{Si(b)}}injectableDefInScope(h){if(!h.providedIn)return!1;const p=gr(h.providedIn);return"string"==typeof p?"any"===p||this.scopes.has(p):this.injectorDefTypes.has(p)}removeOnDestroy(h){const p=this._onDestroyHooks.indexOf(h);-1!==p&&this._onDestroyHooks.splice(p,1)}}function sp(c){const h=$d(c),p=null!==h?h.factory:ku(c);if(null!==p)return p;if(c instanceof Qn)throw new Ue(204,!1);if(c instanceof Function)return function Lu(c){if(c.length>0)throw new Ue(204,!1);const p=function bf(c){return c&&(c[Tu]||c[qs])||null}(c);return null!==p?()=>p.factory(c):()=>new c}(c);throw new Ue(204,!1)}function Oo(c,h,p){let b;if(Fs(c)){const T=gr(c);return ku(T)||sp(T)}if(Nf(c))b=()=>gr(c.useValue);else if(function cv(c){return!(!c||!c.useFactory)}(c))b=()=>c.useFactory(...Mf(c.deps||[]));else if(function ot(c){return!(!c||!c.useExisting)}(c))b=()=>ba(gr(c.useExisting));else{const T=gr(c&&(c.useClass||c.provide));if(!function Bf(c){return!!c.deps}(c))return ku(T)||sp(T);b=()=>new T(...Mf(c.deps))}return b}function xa(c,h,p=!1){return{factory:c,value:h,multi:p?[]:void 0}}function Vf(c,h){for(const p of c)Array.isArray(p)?Vf(p,h):p&&Xm(p)?Vf(p.\u0275providers,h):h(p)}function vo(c,h){c instanceof jc&&c.assertNotDestroyed();const b=Hl(c),T=Ia(void 0);try{return h()}finally{Hl(b),Ia(T)}}function Ir(){return void 0!==_g()||null!=function Qm(){return Sf}()}function Gc(c){if(!Ir())throw new Ue(-203,!1)}const Ko=0,Fi=1,ln=2,vs=3,Sl=4,Ys=5,Ns=6,eu=7,Ao=8,xs=9,Ha=10,_r=11,Nu=12,Gf=13,dd=14,us=15,Bu=16,Vu=17,ud=18,wh=19,uv=20,tu=21,Ch=22,Ml=23,sr=25,Eh=1,Wc=7,Th=9,Bs=10;var Hf=function(c){return c[c.None=0]="None",c[c.HasTransplantedViews=2]="HasTransplantedViews",c}(Hf||{});function Ds(c){return Array.isArray(c)&&"object"==typeof c[Eh]}function ha(c){return Array.isArray(c)&&!0===c[Eh]}function Ig(c){return!!(4&c.flags)}function Sh(c){return c.componentOffset>-1}function cp(c){return!(1&~c.flags)}function $l(c){return!!c.template}function Mh(c){return!!(512&c[ln])}class ce{constructor(h,p,b){this.previousValue=h,this.currentValue=p,this.firstChange=b}isFirstChange(){return this.firstChange}}function me(c,h,p,b){null!==h?h.applyValueToInputSignal(h,b):c[p]=b}function se(){return be}function be(c){return c.type.prototype.ngOnChanges&&(c.setInput=we),Me}function Me(){const c=pe(this),h=c?.current;if(h){const p=c.previous;if(p===Kd)c.previous=h;else for(let b in h)p[b]=h[b];c.current=null,this.ngOnChanges(h)}}function we(c,h,p,b,T){const I=this.declaredInputs[b],B=pe(c)||function De(c,h){return c[Se]=h}(c,{previous:Kd,current:null}),G=B.current||(B.current={}),Y=B.previous,oe=Y[I];G[I]=new ce(oe&&oe.currentValue,p,Y===Kd),me(c,h,T,p)}se.ngInherit=!0;const Se="__ngSimpleChanges__";function pe(c){return c[Se]||null}const je=function(c,h,p){},at="svg";function rt(c){for(;Array.isArray(c);)c=c[Ko];return c}function Pt(c,h){return rt(h[c])}function Ze(c,h){return rt(h[c.index])}function ze(c,h){return c.data[h]}function Ye(c,h){return c[h]}function Mt(c,h){const p=h[c];return Ds(p)?p:p[Ko]}function Wt(c){return!(128&~c[ln])}function vi(c,h){return null==h?null:c[h]}function Yi(c){c[Vu]=0}function qi(c){1024&c[ln]||(c[ln]|=1024,Wt(c)&&xn(c))}function Sn(c){return!!(9216&c[ln]||c[Ml]?.dirty)}function bn(c){c[Ha].changeDetectionScheduler?.notify(7),64&c[ln]&&(c[ln]|=1024),Sn(c)&&xn(c)}function xn(c){c[Ha].changeDetectionScheduler?.notify(0);let h=jr(c);for(;null!==h&&!(8192&h[ln])&&(h[ln]|=8192,Wt(h));)h=jr(h)}function Dn(c,h){if(!(256&~c[ln]))throw new Ue(911,!1);null===c[tu]&&(c[tu]=[]),c[tu].push(h)}function jr(c){const h=c[vs];return ha(h)?h[vs]:h}const Mi={lFrame:Nx(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let Lr=!1;function Zs(){return Mi.bindingsEnabled}function ws(){return null!==Mi.skipHydrationRootTNode}function Ot(){return Mi.lFrame.lView}function Jn(){return Mi.lFrame.tView}function nl(c){return Mi.lFrame.contextLView=c,c[Ao]}function vc(c){return Mi.lFrame.contextLView=null,c}function lo(){let c=Xc();for(;null!==c&&64===c.type;)c=c.parent;return c}function Xc(){return Mi.lFrame.currentTNode}function $a(c,h){const p=Mi.lFrame;p.currentTNode=c,p.isParent=h}function Xf(){return Mi.lFrame.isParent}function Uu(){Mi.lFrame.isParent=!1}function _C(){return Lr}function Zf(c){Lr=c}function fa(){const c=Mi.lFrame;let h=c.bindingRootIndex;return-1===h&&(h=c.bindingRootIndex=c.tView.bindingStartIndex),h}function bc(){return Mi.lFrame.bindingIndex}function fd(){return Mi.lFrame.bindingIndex++}function iu(c){const h=Mi.lFrame,p=h.bindingIndex;return h.bindingIndex=h.bindingIndex+c,p}function dr(c,h){const p=Mi.lFrame;p.bindingIndex=p.bindingRootIndex=c,hp(h)}function hp(c){Mi.lFrame.currentDirectiveIndex=c}function md(c){const h=Mi.lFrame.currentDirectiveIndex;return-1===h?null:c[h]}function Xl(){return Mi.lFrame.currentQueryIndex}function fp(c){Mi.lFrame.currentQueryIndex=c}function xo(c){const h=c[Fi];return 2===h.type?h.declTNode:1===h.type?c[Ys]:null}function Ah(c,h,p){if(p&Cr.SkipSelf){let T=h,I=c;for(;!(T=T.parent,null!==T||p&Cr.Host||(T=xo(I),null===T||(I=I[dd],10&T.type))););if(null===T)return!1;h=T,c=I}const b=Mi.lFrame=oy();return b.currentTNode=h,b.lView=c,!0}function pd(c){const h=oy(),p=c[Fi];Mi.lFrame=h,h.currentTNode=p.firstChild,h.lView=c,h.tView=p,h.contextLView=c,h.bindingIndex=p.bindingStartIndex,h.inI18n=!1}function oy(){const c=Mi.lFrame,h=null===c?null:c.child;return null===h?Nx(c):h}function Nx(c){const h={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:c,child:null,inI18n:!1};return null!==c&&(c.child=h),h}function Bx(){const c=Mi.lFrame;return Mi.lFrame=c.parent,c.currentTNode=null,c.lView=null,c}const Jo=Bx;function fv(){const c=Bx();c.isParent=!0,c.tView=null,c.selectedIndex=-1,c.contextLView=null,c.elementDepthCount=0,c.currentDirectiveIndex=-1,c.currentNamespace=null,c.bindingRootIndex=-1,c.bindingIndex=-1,c.currentQueryIndex=0}function rl(){return Mi.lFrame.selectedIndex}function Kf(c){Mi.lFrame.selectedIndex=c}function bs(){const c=Mi.lFrame;return ze(c.tView,c.selectedIndex)}function mo(){Mi.lFrame.currentNamespace=at}function ql(){!function sy(){Mi.lFrame.currentNamespace=null}()}let bC=!0;function zn(){return bC}function Il(c){bC=c}function mp(c,h){for(let p=h.directiveStart,b=h.directiveEnd;p<b;p++){const I=c.data[p].type.prototype,{ngAfterContentInit:B,ngAfterContentChecked:G,ngAfterViewInit:Y,ngAfterViewChecked:oe,ngOnDestroy:ue}=I;B&&(c.contentHooks??=[]).push(-p,B),G&&((c.contentHooks??=[]).push(p,G),(c.contentCheckHooks??=[]).push(p,G)),Y&&(c.viewHooks??=[]).push(-p,Y),oe&&((c.viewHooks??=[]).push(p,oe),(c.viewCheckHooks??=[]).push(p,oe)),null!=ue&&(c.destroyHooks??=[]).push(p,ue)}}function pp(c,h,p){ay(c,h,3,p)}function Yl(c,h,p,b){(3&c[ln])===p&&ay(c,h,p,b)}function Dh(c,h){let p=c[ln];(3&p)===h&&(p&=16383,p+=1,c[ln]=p)}function ay(c,h,p,b){const I=b??-1,B=h.length-1;let G=0;for(let Y=void 0!==b?65535&c[Vu]:0;Y<B;Y++)if("number"==typeof h[Y+1]){if(G=h[Y],null!=b&&G>=b)break}else h[Y]<0&&(c[Vu]+=65536),(G<I||-1==I)&&(yC(c,p,h,Y),c[Vu]=(4294901760&c[Vu])+Y+2),Y++}function ly(c,h){je(4,c,h);const p=Si(null);try{h.call(c)}finally{Si(p),je(5,c,h)}}function yC(c,h,p,b){const T=p[b]<0,I=p[b+1],G=c[T?-p[b]:p[b]];T?c[ln]>>14<c[Vu]>>16&&(3&c[ln])===h&&(c[ln]+=16384,ly(G,I)):ly(G,I)}const qc=-1;class wn{constructor(h,p,b){this.factory=h,this.resolving=!1,this.canSeeViewProviders=p,this.injectImpl=b}}const Ng={};class gp{constructor(h,p){this.injector=h,this.parentInjector=p}get(h,p,b){b=Jm(b);const T=this.injector.get(h,Ng,b);return T!==Ng||p===Ng?T:this.parentInjector.get(h,p,b)}}function _p(c){return c!==qc}function vp(c){return 32767&c}function Hu(c,h){let p=function wC(c){return c>>16}(c),b=h;for(;p>0;)b=b[dd],p--;return b}let jx=!0;function or(c){const h=jx;return jx=c,h}const Rl=255,dy=5;let CC=0;const gd={};function mv(c,h){const p=EC(c,h);if(-1!==p)return p;const b=h[Fi];b.firstCreatePass&&(c.injectorIndex=h.length,$x(b.data,c),$x(h,null),$x(b.blueprint,null));const T=uy(c,h),I=c.injectorIndex;if(_p(T)){const B=vp(T),G=Hu(T,h),Y=G[Fi].data;for(let oe=0;oe<8;oe++)h[I+oe]=G[B+oe]|Y[B+oe]}return h[I+8]=T,I}function $x(c,h){c.push(0,0,0,0,0,0,0,0,h)}function EC(c,h){return-1===c.injectorIndex||c.parent&&c.parent.injectorIndex===c.injectorIndex||null===h[c.injectorIndex+8]?-1:c.injectorIndex}function uy(c,h){if(c.parent&&-1!==c.parent.injectorIndex)return c.parent.injectorIndex;let p=0,b=null,T=h;for(;null!==T;){if(b=Zx(T),null===b)return qc;if(p++,T=T[dd],-1!==b.injectorIndex)return b.injectorIndex|p<<16}return qc}function Wx(c,h,p){!function Hx(c,h,p){let b;"string"==typeof p?b=p.charCodeAt(0)||0:p.hasOwnProperty(Mu)&&(b=p[Mu]),null==b&&(b=p[Mu]=CC++);const T=b&Rl;h.data[c+(T>>dy)]|=1<<T}(c,h,p)}function Xx(c,h,p){if(p&Cr.Optional||void 0!==c)return c;Au()}function Qf(c,h,p,b){if(p&Cr.Optional&&void 0===b&&(b=null),!(p&(Cr.Self|Cr.Host))){const T=c[xs],I=Ia(void 0);try{return T?T.get(h,b,p&Cr.Optional):vg(h,b,p&Cr.Optional)}finally{Ia(I)}}return Xx(b,0,p)}function TC(c,h,p,b=Cr.Default,T){if(null!==c){if(2048&h[ln]&&!(b&Cr.Self)){const B=function AC(c,h,p,b,T){let I=c,B=h;for(;null!==I&&null!==B&&2048&B[ln]&&!(512&B[ln]);){const G=_d(I,B,p,b|Cr.Self,gd);if(G!==gd)return G;let Y=I.parent;if(!Y){const oe=B[uv];if(oe){const ue=oe.get(p,gd,b);if(ue!==gd)return ue}Y=Zx(B),B=B[dd]}I=Y}return T}(c,h,p,b,gd);if(B!==gd)return B}const I=_d(c,h,p,b,gd);if(I!==gd)return I}return Qf(h,p,b,T)}function _d(c,h,p,b,T){const I=function SC(c){if("string"==typeof c)return c.charCodeAt(0)||0;const h=c.hasOwnProperty(Mu)?c[Mu]:void 0;return"number"==typeof h?h>=0?h&Rl:MC:h}(p);if("function"==typeof I){if(!Ah(h,c,b))return b&Cr.Host?Xx(T,0,b):Qf(h,p,b,T);try{let B;if(B=I(b),null!=B||b&Cr.Optional)return B;Au()}finally{Jo()}}else if("number"==typeof I){let B=null,G=EC(c,h),Y=qc,oe=b&Cr.Host?h[us][Ys]:null;for((-1===G||b&Cr.SkipSelf)&&(Y=-1===G?uy(c,h):h[G+8],Y!==qc&&Yx(b,!1)?(B=h[Fi],G=vp(Y),h=Hu(Y,h)):G=-1);-1!==G;){const ue=h[Fi];if(qx(I,G,ue.data)){const Pe=Qs(G,h,p,B,b,oe);if(Pe!==gd)return Pe}Y=h[G+8],Y!==qc&&Yx(b,h[Fi].data[G+8]===oe)&&qx(I,G,h)?(B=ue,G=vp(Y),h=Hu(Y,h)):G=-1}}return T}function Qs(c,h,p,b,T,I){const B=h[Fi],G=B.data[c+8],ue=pv(G,B,p,null==b?Sh(G)&&jx:b!=B&&!!(3&G.type),T&Cr.Host&&I===G);return null!==ue?yc(h,B,ue,G):gd}function pv(c,h,p,b,T){const I=c.providerIndexes,B=h.data,G=1048575&I,Y=c.directiveStart,ue=I>>20,Xe=T?G+ue:c.directiveEnd;for(let Je=b?G:G+ue;Je<Xe;Je++){const vt=B[Je];if(Je<Y&&p===vt||Je>=Y&&vt.type===p)return Je}if(T){const Je=B[Y];if(Je&&$l(Je)&&Je.type===p)return Y}return null}function yc(c,h,p,b){let T=c[p];const I=h.data;if(function Un(c){return c instanceof wn}(T)){const B=T;B.resolving&&function Cf(c,h){throw h&&h.join(" > "),new Ue(-200,c)}(function To(c){return"function"==typeof c?c.name||c.toString():"object"==typeof c&&null!=c&&"function"==typeof c.type?c.type.name||c.type.toString():Dr(c)}(I[p]));const G=or(B.canSeeViewProviders);B.resolving=!0;const oe=B.injectImpl?Ia(B.injectImpl):null;Ah(c,b,Cr.Default);try{T=c[p]=B.factory(void 0,I,c,b),h.firstCreatePass&&p>=b.directiveStart&&function hs(c,h,p){const{ngOnChanges:b,ngOnInit:T,ngDoCheck:I}=h.type.prototype;if(b){const B=be(h);(p.preOrderHooks??=[]).push(c,B),(p.preOrderCheckHooks??=[]).push(c,B)}T&&(p.preOrderHooks??=[]).push(0-c,T),I&&((p.preOrderHooks??=[]).push(c,I),(p.preOrderCheckHooks??=[]).push(c,I))}(p,I[p],h)}finally{null!==oe&&Ia(oe),or(G),B.resolving=!1,Jo()}}return T}function qx(c,h,p){return!!(p[h+(c>>dy)]&1<<c)}function Yx(c,h){return!(c&Cr.Self||c&Cr.Host&&h)}class ra{constructor(h,p){this._tNode=h,this._lView=p}get(h,p,b){return TC(this._tNode,this._lView,h,Jm(b),p)}}function MC(){return new ra(lo(),Ot())}function em(c){return pr(()=>{const h=c.prototype.constructor,p=h[pc]||tm(h),b=Object.prototype;let T=Object.getPrototypeOf(c.prototype).constructor;for(;T&&T!==b;){const I=T[pc]||tm(T);if(I&&I!==p)return I;T=Object.getPrototypeOf(T)}return I=>new I})}function tm(c){return hc(c)?()=>{const h=tm(gr(c));return h&&h()}:ku(c)}function Zx(c){const h=c[Fi],p=h.type;return 2===p?h.declTNode:1===p?c[Ys]:null}function Xu(c){return function jS(c,h){if("class"===h)return c.classes;if("style"===h)return c.styles;const p=c.attrs;if(p){const b=p.length;let T=0;for(;T<b;){const I=p[T];if(Px(I))break;if(0===I)T+=2;else if("number"==typeof I)for(T++;T<b&&"string"==typeof p[T];)T++;else{if(I===h)return p[T+1];T+=2}}}return null}(lo(),c)}function Jx(c,h=null,p=null,b){const T=gy(c,h,p,b);return T.resolveInjectorInitializers(),T}function gy(c,h=null,p=null,b,T=new Set){const I=[p||yo,Lf(c)];return b=b||("object"==typeof c?void 0:Xs(c)),new jc(I,h||Ur(),b||null,T)}class Pa{static{this.THROW_IF_NOT_FOUND=Ef}static{this.NULL=new Ru}static create(h,p){if(Array.isArray(h))return Jx({name:""},p,h,"");{const b=h.name??"";return Jx({name:b},h.parent,h.providers,b)}}static{this.\u0275prov=zo({token:Pa,providedIn:"any",factory:()=>ba(ep)})}static{this.__NG_ELEMENT_ID__=-1}}new Qn("").__NG_ELEMENT_ID__=c=>{const h=lo();if(null===h)throw new Ue(204,!1);if(2&h.type)return h.value;if(c&Cr.Optional)return null;throw new Ue(204,!1)};function Xn(c){return c.ngOriginalError}class Pl{constructor(){this._console=console}handleError(h){const p=this._findOriginalError(h);this._console.error("ERROR",h),p&&this._console.error("ORIGINAL ERROR",p)}_findOriginalError(h){let p=h&&Xn(h);for(;p&&Xn(p);)p=Xn(p);return p||null}}const Yc=new Qn("",{providedIn:"root",factory:()=>Tn(Pl).handleError.bind(void 0)});let bp=(()=>{class c{static{this.__NG_ELEMENT_ID__=IC}static{this.__NG_ENV_ID__=p=>p}}return c})();class kC extends bp{constructor(h){super(),this._lView=h}onDestroy(h){return Dn(this._lView,h),()=>function fr(c,h){if(null===c[tu])return;const p=c[tu].indexOf(h);-1!==p&&c[tu].splice(p,1)}(this._lView,h)}}function IC(){return new kC(Ot())}function YS(){return im(lo(),Ot())}function im(c,h){return new _v(Ze(c,h))}let _v=(()=>{class c{constructor(p){this.nativeElement=p}static{this.__NG_ELEMENT_ID__=YS}}return c})();function PC(c){return c instanceof _v?c.nativeElement:c}let qu=(()=>{class c{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Xt.t(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const p=this.taskId++;return this.pendingTasks.add(p),p}remove(p){this.pendingTasks.delete(p),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=zo({token:c,providedIn:"root",factory:()=>new c})}}return c})();const Yu=class ZS extends kt.B{constructor(h=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=h,Ir()&&(this.destroyRef=Tn(bp,{optional:!0})??void 0,this.pendingTasks=Tn(qu,{optional:!0})??void 0)}emit(h){const p=Si(null);try{super.next(h)}finally{Si(p)}}subscribe(h,p,b){let T=h,I=p||(()=>null),B=b;if(h&&"object"==typeof h){const Y=h;T=Y.next?.bind(Y),I=Y.error?.bind(Y),B=Y.complete?.bind(Y)}this.__isAsync&&(I=this.wrapInTimeout(I),T&&(T=this.wrapInTimeout(T)),B&&(B=this.wrapInTimeout(B)));const G=super.subscribe({next:T,error:I,complete:B});return h instanceof qt.yU&&h.add(G),G}wrapInTimeout(h){return p=>{const b=this.pendingTasks?.add();setTimeout(()=>{h(p),void 0!==b&&this.pendingTasks?.remove(b)})}}};function KS(){return this._results[Symbol.iterator]()}class vy{get changes(){return this._changes??=new Yu}constructor(h=!1){this._emitDistinctChangesOnly=h,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const p=vy.prototype;p[Symbol.iterator]||(p[Symbol.iterator]=KS)}get(h){return this._results[h]}map(h){return this._results.map(h)}filter(h){return this._results.filter(h)}find(h){return this._results.find(h)}reduce(h,p){return this._results.reduce(h,p)}forEach(h){this._results.forEach(h)}some(h){return this._results.some(h)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(h,p){this.dirty=!1;const b=function ia(c){return c.flat(Number.POSITIVE_INFINITY)}(h);(this._changesDetected=!function Qb(c,h,p){if(c.length!==h.length)return!1;for(let b=0;b<c.length;b++){let T=c[b],I=h[b];if(p&&(T=p(T),I=p(I)),I!==T)return!1}return!0}(this._results,b,p))&&(this._results=b,this.length=b.length,this.last=b[this.length-1],this.first=b[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(h){this._onDirty=h}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function bv(c){return!(128&~c.flags)}const nm=new Map;let OC=0;const yd="__ngContext__";function Ol(c,h){Ds(h)?(c[yd]=h[wh],function ow(c){nm.set(c[wh],c)}(h)):c[yd]=h}function dw(c){return Ih(c[Nu])}function Ey(c){return Ih(c[Sl])}function Ih(c){for(;null!==c&&!ha(c);)c=c[Sl];return c}let xc;function mw(c){xc=c}const Ty=new Qn("",{providedIn:"root",factory:()=>Sy}),Sy="ng",nM=new Qn(""),UC=new Qn("",{providedIn:"platform",factory:()=>"unknown"}),jC=new Qn(""),Mv=new Qn("",{providedIn:"root",factory:()=>function ol(){if(void 0!==xc)return xc;if(typeof document<"u")return document;throw new Ue(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let XC=()=>null;function Py(c,h,p=!1){return XC(c,h,p)}const By=new Qn("",{providedIn:"root",factory:()=>!1});let Ep,Tp;function lm(c){return function Hg(){if(void 0===Ep&&(Ep=null,fo.trustedTypes))try{Ep=fo.trustedTypes.createPolicy("angular",{createHTML:c=>c,createScript:c=>c,createScriptURL:c=>c})}catch{}return Ep}()?.createHTML(c)||c}function Qu(c){return function Sp(){if(void 0===Tp&&(Tp=null,fo.trustedTypes))try{Tp=fo.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:c=>c,createScript:c=>c,createScriptURL:c=>c})}catch{}return Tp}()?.createScriptURL(c)||c}class Wa{constructor(h){this.changingThisBreaksApplicationSecurity=h}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${$e})`}}class Nh extends Wa{getTypeName(){return"HTML"}}class Sd extends Wa{getTypeName(){return"Style"}}class aM extends Wa{getTypeName(){return"Script"}}class lM extends Wa{getTypeName(){return"URL"}}class Mp extends Wa{getTypeName(){return"ResourceURL"}}function Bh(c){return c instanceof Wa?c.changingThisBreaksApplicationSecurity:c}function Xg(c,h){const p=function eI(c){return c instanceof Wa&&c.getTypeName()||null}(c);if(null!=p&&p!==h){if("ResourceURL"===p&&"URL"===h)return!0;throw new Error(`Required a safe ${h}, got a ${p} (see ${$e})`)}return p===h}function yw(c){return new Nh(c)}function Rv(c){return new Sd(c)}function tI(c){return new aM(c)}function iI(c){return new lM(c)}function nI(c){return new Mp(c)}class rI{constructor(h){this.inertDocumentHelper=h}getInertBodyElement(h){h="<body><remove></remove>"+h;try{const p=(new window.DOMParser).parseFromString(lm(h),"text/html").body;return null===p?this.inertDocumentHelper.getInertBodyElement(h):(p.removeChild(p.firstChild),p)}catch{return null}}}class KC{constructor(h){this.defaultDoc=h,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(h){const p=this.inertDocument.createElement("template");return p.innerHTML=lm(h),p}}const Vy=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function qg(c){return(c=String(c)).match(Vy)?c:"unsafe:"+c}function Md(c){const h={};for(const p of c.split(","))h[p]=!0;return h}function cm(...c){const h={};for(const p of c)for(const b in p)p.hasOwnProperty(b)&&(h[b]=!0);return h}const QC=Md("area,br,col,hr,img,wbr"),JC=Md("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),eE=Md("rp,rt"),Pv=cm(QC,cm(JC,Md("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),cm(eE,Md("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),cm(eE,JC)),xw=Md("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ww=cm(xw,Md("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Md("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),dM=Md("script,style,template");class uM{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(h){let p=h.firstChild,b=!0,T=[];for(;p;)if(p.nodeType===Node.ELEMENT_NODE?b=this.startElement(p):p.nodeType===Node.TEXT_NODE?this.chars(p.nodeValue):this.sanitizedSomething=!0,b&&p.firstChild)T.push(p),p=mM(p);else for(;p;){p.nodeType===Node.ELEMENT_NODE&&this.endElement(p);let I=fM(p);if(I){p=I;break}p=T.pop()}return this.buf.join("")}startElement(h){const p=pM(h).toLowerCase();if(!Pv.hasOwnProperty(p))return this.sanitizedSomething=!0,!dM.hasOwnProperty(p);this.buf.push("<"),this.buf.push(p);const b=h.attributes;for(let T=0;T<b.length;T++){const I=b.item(T),B=I.name,G=B.toLowerCase();if(!ww.hasOwnProperty(G)){this.sanitizedSomething=!0;continue}let Y=I.value;xw[G]&&(Y=qg(Y)),this.buf.push(" ",B,'="',Lv(Y),'"')}return this.buf.push(">"),!0}endElement(h){const p=pM(h).toLowerCase();Pv.hasOwnProperty(p)&&!QC.hasOwnProperty(p)&&(this.buf.push("</"),this.buf.push(p),this.buf.push(">"))}chars(h){this.buf.push(Lv(h))}}function fM(c){const h=c.nextSibling;if(h&&c!==h.previousSibling)throw gM(h);return h}function mM(c){const h=c.firstChild;if(h&&function hM(c,h){return(c.compareDocumentPosition(h)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(c,h))throw gM(h);return h}function pM(c){const h=c.nodeName;return"string"==typeof h?h:"FORM"}function gM(c){return new Error(`Failed to sanitize html because the element is clobbered: ${c.outerHTML}`)}const aI=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ov=/([^\#-~ |!])/g;function Lv(c){return c.replace(/&/g,"&amp;").replace(aI,function(h){return"&#"+(1024*(h.charCodeAt(0)-55296)+(h.charCodeAt(1)-56320)+65536)+";"}).replace(Ov,function(h){return"&#"+h.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let zy;function tE(c,h){let p=null;try{zy=zy||function cM(c){const h=new KC(c);return function Ap(){try{return!!(new window.DOMParser).parseFromString(lm(""),"text/html")}catch{return!1}}()?new rI(h):h}(c);let b=h?String(h):"";p=zy.getInertBodyElement(b);let T=5,I=b;do{if(0===T)throw new Error("Failed to sanitize html because the input is unstable");T--,b=I,I=p.innerHTML,p=zy.getInertBodyElement(b)}while(b!==I);return lm((new uM).sanitizeChildren(iE(p)||p))}finally{if(p){const b=iE(p)||p;for(;b.firstChild;)b.removeChild(b.firstChild)}}}function iE(c){return"content"in c&&function _M(c){return c.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===c.nodeName}(c)?c.content:null}var Dp=function(c){return c[c.NONE=0]="NONE",c[c.HTML=1]="HTML",c[c.STYLE=2]="STYLE",c[c.SCRIPT=3]="SCRIPT",c[c.URL=4]="URL",c[c.RESOURCE_URL=5]="RESOURCE_URL",c}(Dp||{});function nE(c){const h=Fv();return h?h.sanitize(Dp.URL,c)||"":Xg(c,"URL")?Bh(c):qg(Dr(c))}function bM(c){const h=Fv();if(h)return Qu(h.sanitize(Dp.RESOURCE_URL,c)||"");if(Xg(c,"ResourceURL"))return Qu(Bh(c));throw new Ue(904,!1)}function oE(c,h,p){return function xM(c,h){return"src"===h&&("embed"===c||"frame"===c||"iframe"===c||"media"===c||"script"===c)||"href"===h&&("base"===c||"link"===c)?bM:nE}(h,p)(c)}function Fv(){const c=Ot();return c&&c[Ha].sanitizer}const wM=/^>|^->|<!--|-->|--!>|<!-$/g,CM=/(<|>)/g,hI="\u200b$1\u200b";function Mw(c){return c.ownerDocument.defaultView}function ll(c){return c instanceof Function?c():c}function wc(c){return"browser"===(c??Tn(Pa)).get(UC)}var Aw=function(c){return c[c.Important=1]="Important",c[c.DashCase=2]="DashCase",c}(Aw||{});let Nv;function dm(c,h){return Nv(c,h)}function ru(c,h,p,b,T){if(null!=b){let I,B=!1;ha(b)?I=b:Ds(b)&&(B=!0,b=b[Ko]);const G=rt(b);0===c&&null!==p?null==T?kw(h,p,G):Jg(h,p,G,T||null,!0):1===c&&null!==p?Jg(h,p,G,T||null,!0):2===c?function jh(c,h,p){const b=kp(c,h);b&&function dE(c,h,p,b){c.removeChild(h,p,b)}(c,b,h,p)}(h,G,B):3===c&&h.destroyNode(G),null!=I&&function $y(c,h,p,b,T){const I=p[Wc];I!==rt(p)&&ru(h,c,b,I,T);for(let G=Bs;G<p.length;G++){const Y=p[G];zv(Y[Fi],Y,c,h,b,I)}}(h,c,I,p,T)}}function Bv(c,h){return c.createComment(function EM(c){return c.replace(wM,h=>h.replace(CM,hI))}(h))}function Yg(c,h,p){return c.createElement(h,p)}function zh(c,h){h[Ha].changeDetectionScheduler?.notify(8),zv(c,h,h[_r],2,null,null)}function ou(c,h){const p=c[Th],b=h[vs];(Ds(b)||h[us]!==b[vs][us])&&(c[ln]|=Hf.HasTransplantedViews),null===p?c[Th]=[h]:p.push(h)}function su(c,h){const p=c[Th],b=p.indexOf(h);p.splice(b,1)}function Qg(c,h){if(c.length<=Bs)return;const p=Bs+h,b=c[p];if(b){const T=b[Bu];null!==T&&T!==c&&su(T,b),h>0&&(c[p-1][Sl]=b[Sl]);const I=Zd(c,Bs+h);!function Zg(c,h){zh(c,h),h[Ko]=null,h[Ys]=null}(b[Fi],b);const B=I[ud];null!==B&&B.detachView(I[Fi]),b[vs]=null,b[Sl]=null,b[ln]&=-129}return b}function Es(c,h){if(!(256&h[ln])){const p=h[_r];p.destroyNode&&zv(c,h,p,3,null,null),function Kg(c){let h=c[Nu];if(!h)return au(c[Fi],c);for(;h;){let p=null;if(Ds(h))p=h[Nu];else{const b=h[Bs];b&&(p=b)}if(!p){for(;h&&!h[Sl]&&h!==c;)Ds(h)&&au(h[Fi],h),h=h[vs];null===h&&(h=c),Ds(h)&&au(h[Fi],h),p=h&&h[Sl]}h=p}}(h)}}function au(c,h){if(256&h[ln])return;const p=Si(null);try{h[ln]&=-129,h[ln]|=256,h[Ml]&&Ki(h[Ml]),function Vv(c,h){let p;if(null!=c&&null!=(p=c.destroyHooks))for(let b=0;b<p.length;b+=2){const T=h[p[b]];if(!(T instanceof wn)){const I=p[b+1];if(Array.isArray(I))for(let B=0;B<I.length;B+=2){const G=T[I[B]],Y=I[B+1];je(4,G,Y);try{Y.call(G)}finally{je(5,G,Y)}}else{je(4,T,I);try{I.call(T)}finally{je(5,T,I)}}}}}(c,h),function Dw(c,h){const p=c.cleanup,b=h[eu];if(null!==p)for(let I=0;I<p.length-1;I+=2)if("string"==typeof p[I]){const B=p[I+3];B>=0?b[B]():b[-B].unsubscribe(),I+=2}else p[I].call(b[p[I+1]]);null!==b&&(h[eu]=null);const T=h[tu];if(null!==T){h[tu]=null;for(let I=0;I<T.length;I++)(0,T[I])()}}(c,h),1===h[Fi].type&&h[_r].destroy();const b=h[Bu];if(null!==b&&ha(h[vs])){b!==h[vs]&&su(b,h);const T=h[ud];null!==T&&T.detachView(c)}!function ss(c){nm.delete(c[wh])}(h)}finally{Si(p)}}function Vs(c,h,p){return function lu(c,h,p){let b=h;for(;null!==b&&40&b.type;)b=(h=b).parent;if(null===b)return p[Ko];{const{componentOffset:T}=b;if(T>-1){const{encapsulation:I}=c.data[b.directiveStart+T];if(I===ao.None||I===ao.Emulated)return null}return Ze(b,p)}}(c,h.parent,p)}function Jg(c,h,p,b,T){c.insertBefore(h,p,b,T)}function kw(c,h,p){c.appendChild(h,p)}function cu(c,h,p,b,T){null!==b?Jg(c,h,p,b,T):kw(c,h,p)}function kp(c,h){return c.parentNode(h)}function Iw(c,h,p){return Rw(c,h,p)}let Hy,Rw=function hm(c,h,p){return 40&c.type?Ze(c,p):null};function sa(c,h,p,b){const T=Vs(c,b,h),I=h[_r],G=Iw(b.parent||h[Ys],b,h);if(null!=T)if(Array.isArray(p))for(let Y=0;Y<p.length;Y++)cu(I,T,p[Y],G,!1);else cu(I,T,p,G,!1);void 0!==Hy&&Hy(I,b,h,p,T)}function fm(c,h){if(null!==h){const p=h.type;if(3&p)return Ze(h,c);if(4&p)return mm(-1,c[h.index]);if(8&p){const b=h.child;if(null!==b)return fm(c,b);{const T=c[h.index];return ha(T)?mm(-1,T):rt(T)}}if(32&p)return dm(h,c)()||rt(c[h.index]);{const b=Cc(c,h);return null!==b?Array.isArray(b)?b[0]:fm(jr(c[us]),b):fm(c,h.next)}}return null}function Cc(c,h){return null!==h?c[us][Ys].projection[h.projection]:null}function mm(c,h){const p=Bs+c+1;if(p<h.length){const b=h[p],T=b[Fi].firstChild;if(null!==T)return fm(b,T)}return h[Wc]}function Ll(c,h,p,b,T,I,B){for(;null!=p;){const G=b[p.index],Y=p.type;if(B&&0===h&&(G&&Ol(rt(G),b),p.flags|=2),32&~p.flags)if(8&Y)Ll(c,h,p.child,b,T,I,!1),ru(h,c,T,G,I);else if(32&Y){const oe=dm(p,b);let ue;for(;ue=oe();)ru(h,c,T,ue,I);ru(h,c,T,G,I)}else 16&Y?Ad(c,h,b,p,T,I):ru(h,c,T,G,I);p=B?p.projectionNext:p.next}}function zv(c,h,p,b,T,I){Ll(p,b,c.firstChild,h,T,I,!1)}function Ad(c,h,p,b,T,I){const B=p[us],Y=B[Ys].projection[b.projection];if(Array.isArray(Y))for(let oe=0;oe<Y.length;oe++)ru(h,c,T,Y[oe],I);else{let oe=Y;const ue=B[vs];bv(b)&&(oe.flags|=128),Ll(c,h,oe,ue,T,I,!0)}}function e_(c,h,p){""===p?c.removeAttribute(h,"class"):c.setAttribute(h,"class",p)}function t_(c,h,p){const{mergedAttrs:b,classes:T,styles:I}=p;null!==b&&Pf(c,h,b),null!==T&&e_(c,h,T),null!==I&&function Wy(c,h,p){c.setAttribute(h,"style",p)}(c,h,I)}const $r={};function jv(c=1){IM(Jn(),Ot(),rl()+c,!1)}function IM(c,h,p,b){if(!b)if(3&~h[ln]){const I=c.preOrderHooks;null!==I&&Yl(h,I,0,p)}else{const I=c.preOrderCheckHooks;null!==I&&pp(h,I,p)}Kf(p)}function Dd(c,h=Cr.Default){const p=Ot();return null===p?ba(c,h):TC(lo(),p,gr(c),h)}function Xy(){throw new Error("invalid")}function hE(c,h,p,b,T,I){const B=Si(null);try{let G=null;T&Pu.SignalBased&&(G=h[b][Tt]),null!==G&&void 0!==G.transformFn&&(I=G.transformFn(I)),T&Pu.HasDecoratorInputTransform&&(I=c.inputTransforms[b].call(h,I)),null!==c.setInput?c.setInput(h,G,I,p,b):me(h,G,b,I)}finally{Si(B)}}function i_(c,h,p,b,T,I,B,G,Y,oe,ue){const Pe=h.blueprint.slice();return Pe[Ko]=T,Pe[ln]=204|b,(null!==oe||c&&2048&c[ln])&&(Pe[ln]|=2048),Yi(Pe),Pe[vs]=Pe[dd]=c,Pe[Ao]=p,Pe[Ha]=B||c&&c[Ha],Pe[_r]=G||c&&c[_r],Pe[xs]=Y||c&&c[xs]||null,Pe[Ys]=I,Pe[wh]=function LC(){return OC++}(),Pe[Ns]=ue,Pe[uv]=oe,Pe[us]=2==h.type?c[us]:Pe,Pe}function n_(c,h,p,b,T){let I=c.data[h];if(null===I)I=function Rp(c,h,p,b,T){const I=Xc(),B=Xf(),Y=c.data[h]=function Pp(c,h,p,b,T,I){let B=h?h.injectorIndex:-1,G=0;return ws()&&(G|=128),{type:p,index:b,insertBeforeIndex:null,injectorIndex:B,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:G,providerIndexes:0,value:T,attrs:I,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:h,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,B?I:I&&I.parent,p,h,b,T);return null===c.firstChild&&(c.firstChild=Y),null!==I&&(B?null==I.child&&null!==Y.parent&&(I.child=Y):null===I.next&&(I.next=Y,Y.prev=I)),Y}(c,h,p,b,T),function vC(){return Mi.lFrame.inI18n}()&&(I.flags|=32);else if(64&I.type){I.type=p,I.value=b,I.attrs=T;const B=function Wl(){const c=Mi.lFrame,h=c.currentTNode;return c.isParent?h:h.parent}();I.injectorIndex=null===B?-1:B.injectorIndex}return $a(I,!0),I}function kd(c,h,p,b){if(0===p)return-1;const T=h.length;for(let I=0;I<p;I++)h.push(b),c.blueprint.push(b),c.data.push(null);return T}function qy(c,h,p,b,T){const I=rl(),B=2&b;try{Kf(-1),B&&h.length>sr&&IM(c,h,sr,!1),je(B?2:0,T),p(b,T)}finally{Kf(I),je(B?3:1,T)}}function Gv(c,h,p){if(Ig(h)){const b=Si(null);try{const I=h.directiveEnd;for(let B=h.directiveStart;B<I;B++){const G=c.data[B];G.contentQueries&&G.contentQueries(1,p[B],B)}}finally{Si(b)}}}function r_(c,h,p){Zs()&&(function Xv(c,h,p,b){const T=p.directiveStart,I=p.directiveEnd;Sh(p)&&function bE(c,h,p){const b=Ze(h,c),T=mE(p);let B=16;p.signals?B=4096:p.onPush&&(B=64);const G=a_(c,i_(c,T,null,B,b,h,null,c[Ha].rendererFactory.createRenderer(b,p),null,null,null));c[h.index]=G}(h,p,c.data[T+p.componentOffset]),c.firstCreatePass||mv(p,h),Ol(b,h);const B=p.initialInputs;for(let G=T;G<I;G++){const Y=c.data[G],oe=yc(h,c,G,p);Ol(oe,h),null!==B&&e0(0,G-T,oe,Y,0,B),$l(Y)&&(Mt(p.index,h)[Ao]=yc(h,c,G,p))}}(c,h,p,Ze(p,h)),!(64&~p.flags)&&vE(c,h,p))}function Hv(c,h,p=Ze){const b=h.localNames;if(null!==b){let T=h.index+1;for(let I=0;I<b.length;I+=2){const B=b[I+1],G=-1===B?p(h,c):c[B];c[T++]=G}}}function mE(c){const h=c.tView;return null===h||h.incompleteFirstPass?c.tView=$v(1,null,c.template,c.decls,c.vars,c.directiveDefs,c.pipeDefs,c.viewQuery,c.schemas,c.consts,c.id):h}function $v(c,h,p,b,T,I,B,G,Y,oe,ue){const Pe=sr+b,Xe=Pe+T,Je=function o_(c,h){const p=[];for(let b=0;b<h;b++)p.push(b<c?null:$r);return p}(Pe,Xe),vt="function"==typeof oe?oe():oe;return Je[Fi]={type:c,blueprint:Je,template:p,queries:null,viewQuery:G,declTNode:h,data:Je.slice().fill(null,Pe),bindingStartIndex:Pe,expandoStartIndex:Xe,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof I?I():I,pipeRegistry:"function"==typeof B?B():B,firstChild:null,schemas:Y,consts:vt,incompleteFirstPass:!1,ssrId:ue}}let gm=()=>null;function _m(c,h,p,b,T){for(let I in h){if(!h.hasOwnProperty(I))continue;const B=h[I];if(void 0===B)continue;b??={};let G,Y=Pu.None;Array.isArray(B)?(G=B[0],Y=B[1]):G=B;let oe=I;if(null!==T){if(!T.hasOwnProperty(I))continue;oe=T[I]}0===c?Wv(b,p,oe,G,Y):Wv(b,p,oe,G)}return b}function Wv(c,h,p,b,T){let I;c.hasOwnProperty(p)?(I=c[p]).push(h,b):I=c[p]=[h,b],void 0!==T&&I.push(T)}function zs(c,h,p,b,T,I,B,G){const Y=Ze(h,p);let ue,oe=h.inputs;!G&&null!=oe&&(ue=oe[b])?(c_(c,p,ue,b,T),Sh(h)&&function Ky(c,h){const p=Mt(h,c);16&p[ln]||(p[ln]|=64)}(p,h.index)):3&h.type&&(b=function gE(c){return"class"===c?"className":"for"===c?"htmlFor":"formaction"===c?"formAction":"innerHtml"===c?"innerHTML":"readonly"===c?"readOnly":"tabindex"===c?"tabIndex":c}(b),T=null!=B?B(T,h.value||"",b):T,I.setProperty(Y,b,T))}function Qy(c,h,p,b){if(Zs()){const T=null===b?null:{"":-1},I=function Kc(c,h){const p=c.directiveRegistry;let b=null,T=null;if(p)for(let I=0;I<p.length;I++){const B=p[I];if(Uc(h,B.selectors,!1))if(b||(b=[]),$l(B))if(null!==B.findHostDirectiveDefs){const G=[];T=T||new Map,B.findHostDirectiveDefs(B,G,T),b.unshift(...G,B),Jy(c,h,G.length)}else b.unshift(B),Jy(c,h,0);else T=T||new Map,B.findHostDirectiveDefs?.(B,b,T),b.push(B)}return null===b?null:[b,T]}(c,p);let B,G;null===I?B=G=null:[B,G]=I,null!==B&&_E(c,h,p,B,T,G),T&&function Ju(c,h,p){if(h){const b=c.localNames=[];for(let T=0;T<h.length;T+=2){const I=p[h[T+1]];if(null==I)throw new Ue(-301,!1);b.push(h[T],I)}}}(p,b,T)}p.mergedAttrs=El(p.mergedAttrs,p.attrs)}function _E(c,h,p,b,T,I){for(let oe=0;oe<b.length;oe++)Wx(mv(p,h),c,b[oe].type);!function Zv(c,h,p){c.flags|=1,c.directiveStart=h,c.directiveEnd=h+p,c.providerIndexes=h}(p,c.data.length,b.length);for(let oe=0;oe<b.length;oe++){const ue=b[oe];ue.providersResolver&&ue.providersResolver(ue)}let B=!1,G=!1,Y=kd(c,h,b.length,null);for(let oe=0;oe<b.length;oe++){const ue=b[oe];p.mergedAttrs=El(p.mergedAttrs,ue.hostAttrs),s_(c,p,h,Y,ue),Yv(Y,ue,T),null!==ue.contentQueries&&(p.flags|=4),(null!==ue.hostBindings||null!==ue.hostAttrs||0!==ue.hostVars)&&(p.flags|=64);const Pe=ue.type.prototype;!B&&(Pe.ngOnChanges||Pe.ngOnInit||Pe.ngDoCheck)&&((c.preOrderHooks??=[]).push(p.index),B=!0),!G&&(Pe.ngOnChanges||Pe.ngDoCheck)&&((c.preOrderCheckHooks??=[]).push(p.index),G=!0),Y++}!function RM(c,h,p){const T=h.directiveEnd,I=c.data,B=h.attrs,G=[];let Y=null,oe=null;for(let ue=h.directiveStart;ue<T;ue++){const Pe=I[ue],Xe=p?p.get(Pe):null,vt=Xe?Xe.outputs:null;Y=_m(0,Pe.inputs,ue,Y,Xe?Xe.inputs:null),oe=_m(1,Pe.outputs,ue,oe,vt);const $t=null===Y||null===B||nv(h)?null:LM(Y,ue,B);G.push($t)}null!==Y&&(Y.hasOwnProperty("class")&&(h.flags|=8),Y.hasOwnProperty("style")&&(h.flags|=16)),h.initialInputs=G,h.inputs=Y,h.outputs=oe}(c,p,I)}function vE(c,h,p){const b=p.directiveStart,T=p.directiveEnd,I=p.index,B=function Qo(){return Mi.lFrame.currentDirectiveIndex}();try{Kf(I);for(let G=b;G<T;G++){const Y=c.data[G],oe=h[G];hp(G),(null!==Y.hostBindings||0!==Y.hostVars||null!==Y.hostAttrs)&&qv(Y,oe)}}finally{Kf(-1),hp(B)}}function qv(c,h){null!==c.hostBindings&&c.hostBindings(1,h)}function Jy(c,h,p){h.componentOffset=p,(c.components??=[]).push(h.index)}function Yv(c,h,p){if(p){if(h.exportAs)for(let b=0;b<h.exportAs.length;b++)p[h.exportAs[b]]=c;$l(h)&&(p[""]=c)}}function s_(c,h,p,b,T){c.data[b]=T;const I=T.factory||(T.factory=ku(T.type)),B=new wn(I,$l(T),Dd);c.blueprint[b]=B,p[b]=B,function Ow(c,h,p,b,T){const I=T.hostBindings;if(I){let B=c.hostBindingOpCodes;null===B&&(B=c.hostBindingOpCodes=[]);const G=~h.index;(function wI(c){let h=c.length;for(;h>0;){const p=c[--h];if("number"==typeof p&&p<0)return p}return 0})(B)!=G&&B.push(G),B.push(p,b,I)}}(c,h,b,kd(c,p,T.hostVars,$r),T)}function ec(c,h,p,b,T,I){const B=Ze(c,h);!function Kv(c,h,p,b,T,I,B){if(null==I)c.removeAttribute(h,T,p);else{const G=null==B?Dr(I):B(I,b||"",T);c.setAttribute(h,T,G,p)}}(h[_r],B,I,c.value,p,b,T)}function e0(c,h,p,b,T,I){const B=I[h];if(null!==B)for(let G=0;G<B.length;)hE(b,p,B[G++],B[G++],B[G++],B[G++])}function LM(c,h,p){let b=null,T=0;for(;T<p.length;){const I=p[T];if(0!==I)if(5!==I){if("number"==typeof I)break;if(c.hasOwnProperty(I)){null===b&&(b=[]);const B=c[I];for(let G=0;G<B.length;G+=3)if(B[G]===h){b.push(I,B[G+1],B[G+2],p[T+1]);break}}T+=2}else T+=2;else T+=4}return b}function t0(c,h,p,b){return[c,!0,0,h,null,b,null,p,null,null]}function Us(c,h){const p=c.contentQueries;if(null!==p){const b=Si(null);try{for(let T=0;T<p.length;T+=2){const B=p[T+1];if(-1!==B){const G=c.data[B];fp(p[T]),G.contentQueries(2,h[B],B)}}}finally{Si(b)}}}function a_(c,h){return c[Nu]?c[Gf][Sl]=h:c[Nu]=h,c[Gf]=h,h}function Op(c,h,p){fp(0);const b=Si(null);try{h(c,p)}finally{Si(b)}}function NM(c){return c[eu]??=[]}function BM(c){return c.cleanup??=[]}function n0(c,h,p){return(null===c||$l(c))&&(p=function pt(c){for(;Array.isArray(c);){if("object"==typeof c[Eh])return c;c=c[Ko]}return null}(p[h.index])),p[_r]}function l_(c,h){const p=c[xs],b=p?p.get(Pl,null):null;b&&b.handleError(h)}function c_(c,h,p,b,T){for(let I=0;I<p.length;){const B=p[I++],G=p[I++],Y=p[I++];hE(c.data[B],h[B],b,G,Y,T)}}function Id(c,h,p){const b=Pt(h,c);!function cE(c,h,p){c.setValue(h,p)}(c[_r],b,p)}function yE(c,h){const p=Mt(h,c),b=p[Fi];!function r0(c,h){for(let p=h.length;p<c.blueprint.length;p++)h.push(c.blueprint[p])}(b,p);const T=p[Ko];null!==T&&null===p[Ns]&&(p[Ns]=Py(T,p[xs])),o0(b,p,p[Ao])}function o0(c,h,p){pd(h);try{const b=c.viewQuery;null!==b&&Op(1,b,p);const T=c.template;null!==T&&qy(c,h,T,1,p),c.firstCreatePass&&(c.firstCreatePass=!1),h[ud]?.finishViewCreation(c),c.staticContentQueries&&Us(c,h),c.staticViewQueries&&Op(2,c.viewQuery,p);const I=c.components;null!==I&&function VM(c,h){for(let p=0;p<h.length;p++)yE(c,h[p])}(h,I)}catch(b){throw c.firstCreatePass&&(c.incompleteFirstPass=!0,c.firstCreatePass=!1),b}finally{h[ln]&=-5,fv()}}function vm(c,h,p,b){const T=Si(null);try{const I=h.tView,Y=i_(c,I,p,4096&c[ln]?4096:16,null,h,null,null,b?.injector??null,b?.embeddedViewInjector??null,b?.dehydratedView??null);Y[Bu]=c[h.index];const ue=c[ud];return null!==ue&&(Y[ud]=ue.createEmbeddedView(I)),o0(I,Y,p),Y}finally{Si(T)}}function xE(c,h){const p=Bs+h;if(p<c.length)return c[p]}function Lp(c,h){return!h||null===h.firstChild||bv(c)}function Fp(c,h,p,b=!0){const T=h[Fi];if(function Uh(c,h,p,b){const T=Bs+b,I=p.length;b>0&&(p[T-1][Sl]=h),b<I-Bs?(h[Sl]=p[T],yg(p,Bs+b,h)):(p.push(h),h[Sl]=null),h[vs]=p;const B=h[Bu];null!==B&&p!==B&&ou(B,h);const G=h[ud];null!==G&&G.insertView(c),bn(h),h[ln]|=128}(T,h,c,p),b){const B=mm(p,c),G=h[_r],Y=kp(G,c[Wc]);null!==Y&&function Jl(c,h,p,b,T,I){b[Ko]=T,b[Ys]=h,zv(c,b,p,1,T,I)}(T,c[Ys],G,h,Y,B)}const I=h[Ns];null!==I&&null!==I.firstChild&&(I.firstChild=null)}function Lw(c,h){const p=Qg(c,h);return void 0!==p&&Es(p[Fi],p),p}function qn(c,h,p,b,T=!1){for(;null!==p;){const I=h[p.index];null!==I&&b.push(rt(I)),ha(I)&&zM(I,b);const B=p.type;if(8&B)qn(c,h,p.child,b);else if(32&B){const G=dm(p,h);let Y;for(;Y=G();)b.push(Y)}else if(16&B){const G=Cc(h,p);if(Array.isArray(G))b.push(...G);else{const Y=jr(h[us]);qn(Y[Fi],Y,G,b,!0)}}p=T?p.projectionNext:p.next}return b}function zM(c,h){for(let p=Bs;p<c.length;p++){const b=c[p],T=b[Fi].firstChild;null!==T&&qn(b[Fi],b,T,h)}c[Wc]!==c[Ko]&&h.push(c[Wc])}let Fw=[];const Nw={...ui,consumerIsAlwaysLive:!0,consumerMarkedDirty:c=>{xn(c.lView)},consumerOnSignalRead(){this.lView[Ml]=this}},Qv={...ui,consumerIsAlwaysLive:!0,consumerMarkedDirty:c=>{let h=jr(c.lView);for(;h&&!wE(h[Fi]);)h=jr(h);h&&qi(h)},consumerOnSignalRead(){this.lView[Ml]=this}};function wE(c){return 2!==c.type}const GM=100;function bm(c,h=!0,p=0){const b=c[Ha],T=b.rendererFactory;T.begin?.();try{!function Bw(c,h){const p=_C();try{Zf(!0),TE(c,h);let b=0;for(;Sn(c);){if(b===GM)throw new Ue(103,!1);b++,TE(c,1)}}finally{Zf(p)}}(c,p)}catch(B){throw h&&l_(c,B),B}finally{T.end?.(),b.inlineEffectRunner?.flush()}}function Bp(c,h,p,b){const T=h[ln];if(!(256&~T))return;h[Ha].inlineEffectRunner?.flush(),pd(h);let G=!0,Y=null,oe=null;wE(c)?(oe=function CI(c){return c[Ml]??function UM(c){const h=Fw.pop()??Object.create(Nw);return h.lView=c,h}(c)}(h),Y=bi(oe)):null===function Ri(){return Yt}()?(G=!1,oe=function Np(c){const h=c[Ml]??Object.create(Qv);return h.lView=c,h}(h),Y=bi(oe)):h[Ml]&&(Ki(h[Ml]),h[Ml]=null);try{Yi(h),function up(c){return Mi.lFrame.bindingIndex=c}(c.bindingStartIndex),null!==p&&qy(c,h,p,2,b);const ue=!(3&~T);if(ue){const Je=c.preOrderCheckHooks;null!==Je&&pp(h,Je,null)}else{const Je=c.preOrderHooks;null!==Je&&Yl(h,Je,0,null),Dh(h,0)}if(function Vw(c){for(let h=dw(c);null!==h;h=Ey(h)){if(!(h[ln]&Hf.HasTransplantedViews))continue;const p=h[Th];for(let b=0;b<p.length;b++)qi(p[b])}}(h),CE(h,0),null!==c.contentQueries&&Us(c,h),ue){const Je=c.contentCheckHooks;null!==Je&&pp(h,Je)}else{const Je=c.contentHooks;null!==Je&&Yl(h,Je,1),Dh(h,1)}!function fE(c,h){const p=c.hostBindingOpCodes;if(null!==p)try{for(let b=0;b<p.length;b++){const T=p[b];if(T<0)Kf(~T);else{const I=T,B=p[++b],G=p[++b];dr(B,I),G(2,h[I])}}}finally{Kf(-1)}}(c,h);const Pe=c.components;null!==Pe&&SE(h,Pe,0);const Xe=c.viewQuery;if(null!==Xe&&Op(2,Xe,b),ue){const Je=c.viewCheckHooks;null!==Je&&pp(h,Je)}else{const Je=c.viewHooks;null!==Je&&Yl(h,Je,2),Dh(h,2)}if(!0===c.firstUpdatePass&&(c.firstUpdatePass=!1),h[Ch]){for(const Je of h[Ch])Je();h[Ch]=null}h[ln]&=-73}catch(ue){throw xn(h),ue}finally{null!==oe&&(Di(oe,Y),G&&function jM(c){c.lView[Ml]!==c&&(c.lView=null,Fw.push(c))}(oe)),fv()}}function CE(c,h){for(let p=dw(c);null!==p;p=Ey(p))for(let b=Bs;b<p.length;b++)EE(p[b],h)}function HM(c,h,p){EE(Mt(h,c),p)}function EE(c,h){Wt(c)&&TE(c,h)}function TE(c,h){const b=c[Fi],T=c[ln],I=c[Ml];let B=!!(0===h&&16&T);if(B||=!!(64&T&&0===h),B||=!!(1024&T),B||=!(!I?.dirty||!ki(I)),B||=!1,I&&(I.dirty=!1),c[ln]&=-9217,B)Bp(b,c,b.template,c[Ao]);else if(8192&T){CE(c,1);const G=b.components;null!==G&&SE(c,G,1)}}function SE(c,h,p){for(let b=0;b<h.length;b++)HM(c,h[b],p)}function d_(c,h){const p=_C()?64:1088;for(c[Ha].changeDetectionScheduler?.notify(h);c;){c[ln]|=p;const b=jr(c);if(Mh(c)&&!b)return c;c=b}return null}class Jv{get rootNodes(){const h=this._lView,p=h[Fi];return qn(p,h,p.firstChild,[])}constructor(h,p,b=!0){this._lView=h,this._cdRefInjectingView=p,this.notifyErrorHandler=b,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ao]}set context(h){this._lView[Ao]=h}get destroyed(){return!(256&~this._lView[ln])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const h=this._lView[vs];if(ha(h)){const p=h[8],b=p?p.indexOf(this):-1;b>-1&&(Qg(h,b),Zd(p,b))}this._attachedToViewContainer=!1}Es(this._lView[Fi],this._lView)}onDestroy(h){Dn(this._lView,h)}markForCheck(){d_(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ln]&=-129}reattach(){bn(this._lView),this._lView[ln]|=128}detectChanges(){this._lView[ln]|=1024,bm(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ue(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const h=Mh(this._lView),p=this._lView[Bu];null!==p&&!h&&su(p,this._lView),zh(this._lView[Fi],this._lView)}attachToAppRef(h){if(this._attachedToViewContainer)throw new Ue(902,!1);this._appRef=h;const p=Mh(this._lView),b=this._lView[Bu];null!==b&&!p&&ou(b,this._lView),bn(this._lView)}}let eh=(()=>{class c{static{this.__NG_ELEMENT_ID__=du}}return c})();const EI=eh,TI=class extends EI{constructor(h,p,b){super(),this._declarationLView=h,this._declarationTContainer=p,this.elementRef=b}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(h,p){return this.createEmbeddedViewImpl(h,p)}createEmbeddedViewImpl(h,p,b){const T=vm(this._declarationLView,this._declarationTContainer,h,{embeddedViewInjector:p,dehydratedView:b});return new Jv(T)}};function du(){return th(lo(),Ot())}function th(c,h){return 4&c.type?new TI(h,c,im(c,h)):null}let Wp=()=>null;function Wh(c,h){return Wp(c,h)}class es{}const Xh=new Qn("",{providedIn:"root",factory:()=>!1}),lb=new Qn("");class QM{}class JM{}class Kw{resolveComponentFactory(h){throw function SI(c){const h=Error(`No component factory found for ${Xs(c)}.`);return h.ngComponent=c,h}(h)}}class cb{static{this.NULL=new Kw}}class Tc{}let eA=(()=>{class c{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>function MI(){const c=Ot(),p=Mt(lo().index,c);return(Ds(p)?p:c)[_r]}()}}return c})(),tA=(()=>{class c{static{this.\u0275prov=zo({token:c,providedIn:"root",factory:()=>null})}}return c})();const Qw=new Set;function hl(c){Qw.has(c)||(Qw.add(c),performance?.mark?.("mark_feature_usage",{detail:{feature:c}}))}function Jw(c){let h=!0;return setTimeout(()=>{h&&(h=!1,c())}),"function"==typeof fo.requestAnimationFrame&&fo.requestAnimationFrame(()=>{h&&(h=!1,c())}),()=>{h=!1}}function e1(c){let h=!0;return queueMicrotask(()=>{h&&c()}),()=>{h=!1}}function t1(...c){}class fs{constructor({enableLongStackTrace:h=!1,shouldCoalesceEventChangeDetection:p=!1,shouldCoalesceRunChangeDetection:b=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Yu(!1),this.onMicrotaskEmpty=new Yu(!1),this.onStable=new Yu(!1),this.onError=new Yu(!1),typeof Zone>"u")throw new Ue(908,!1);Zone.assertZonePatched();const T=this;T._nesting=0,T._outer=T._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(T._inner=T._inner.fork(new Zone.TaskTrackingZoneSpec)),h&&Zone.longStackTraceZoneSpec&&(T._inner=T._inner.fork(Zone.longStackTraceZoneSpec)),T.shouldCoalesceEventChangeDetection=!b&&p,T.shouldCoalesceRunChangeDetection=b,T.callbackScheduled=!1,function nh(c){const h=()=>{!function g0(c){c.isCheckStableRunning||c.callbackScheduled||(c.callbackScheduled=!0,Zone.root.run(()=>{Jw(()=>{c.callbackScheduled=!1,rh(c),c.isCheckStableRunning=!0,p0(c),c.isCheckStableRunning=!1})}),rh(c))}(c)};c._inner=c._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(p,b,T,I,B,G)=>{if(function f(c){return y(c,"__ignore_ng_zone__")}(G))return p.invokeTask(T,I,B,G);try{return a(c),p.invokeTask(T,I,B,G)}finally{(c.shouldCoalesceEventChangeDetection&&"eventTask"===I.type||c.shouldCoalesceRunChangeDetection)&&h(),s(c)}},onInvoke:(p,b,T,I,B,G,Y)=>{try{return a(c),p.invoke(T,I,B,G,Y)}finally{c.shouldCoalesceRunChangeDetection&&!c.callbackScheduled&&!function v(c){return y(c,"__scheduler_tick__")}(G)&&h(),s(c)}},onHasTask:(p,b,T,I)=>{p.hasTask(T,I),b===T&&("microTask"==I.change?(c._hasPendingMicrotasks=I.microTask,rh(c),p0(c)):"macroTask"==I.change&&(c.hasPendingMacrotasks=I.macroTask))},onHandleError:(p,b,T,I)=>(p.handleError(T,I),c.runOutsideAngular(()=>c.onError.emit(I)),!1)})}(T)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!fs.isInAngularZone())throw new Ue(909,!1)}static assertNotInAngularZone(){if(fs.isInAngularZone())throw new Ue(909,!1)}run(h,p,b){return this._inner.run(h,p,b)}runTask(h,p,b,T){const I=this._inner,B=I.scheduleEventTask("NgZoneEvent: "+T,h,n1,t1,t1);try{return I.runTask(B,p,b)}finally{I.cancelTask(B)}}runGuarded(h,p,b){return this._inner.runGuarded(h,p,b)}runOutsideAngular(h){return this._outer.run(h)}}const n1={};function p0(c){if(0==c._nesting&&!c.hasPendingMicrotasks&&!c.isStable)try{c._nesting++,c.onMicrotaskEmpty.emit(null)}finally{if(c._nesting--,!c.hasPendingMicrotasks)try{c.runOutsideAngular(()=>c.onStable.emit(null))}finally{c.isStable=!0}}}function rh(c){c.hasPendingMicrotasks=!!(c._hasPendingMicrotasks||(c.shouldCoalesceEventChangeDetection||c.shouldCoalesceRunChangeDetection)&&!0===c.callbackScheduled)}function a(c){c._nesting++,c.isStable&&(c.isStable=!1,c.onUnstable.emit(null))}function s(c){c._nesting--,p0(c)}class d{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Yu,this.onMicrotaskEmpty=new Yu,this.onStable=new Yu,this.onError=new Yu}run(h,p,b){return h.apply(p,b)}runGuarded(h,p,b){return h.apply(p,b)}runOutsideAngular(h){return h()}runTask(h,p,b,T){return h.apply(p,b)}}function y(c,h){return!(!Array.isArray(c)||1!==c.length)&&!0===c[0]?.data?.[h]}var M=function(c){return c[c.EarlyRead=0]="EarlyRead",c[c.Write=1]="Write",c[c.MixedReadWrite=2]="MixedReadWrite",c[c.Read=3]="Read",c}(M||{});const k={destroy(){}};function L(c,h){!h&&Gc();const p=h?.injector??Tn(Pa);if(!wc(p))return k;hl("NgAfterRender");const b=p.get(Z),T=b.handler??=new q,I=h?.phase??M.MixedReadWrite,B=()=>{T.unregister(Y),G()},G=p.get(bp).onDestroy(B),Y=vo(p,()=>new j(I,c));return T.register(Y),{destroy:B}}function V(c,h){!h&&Gc();const p=h?.injector??Tn(Pa);if(!wc(p))return k;hl("NgAfterNextRender");const b=p.get(Z),T=b.handler??=new q,I=h?.phase??M.MixedReadWrite,B=()=>{T.unregister(Y),G()},G=p.get(bp).onDestroy(B),Y=vo(p,()=>new j(I,()=>{B(),c()}));return T.register(Y),{destroy:B}}class j{constructor(h,p){this.phase=h,this.callbackFn=p,this.zone=Tn(fs),this.errorHandler=Tn(Pl,{optional:!0}),Tn(es,{optional:!0})?.notify(6)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(h){this.errorHandler?.handleError(h)}}}class q{constructor(){this.executingCallbacks=!1,this.buckets={[M.EarlyRead]:new Set,[M.Write]:new Set,[M.MixedReadWrite]:new Set,[M.Read]:new Set},this.deferredCallbacks=new Set}register(h){(this.executingCallbacks?this.deferredCallbacks:this.buckets[h.phase]).add(h)}unregister(h){this.buckets[h.phase].delete(h),this.deferredCallbacks.delete(h)}execute(){this.executingCallbacks=!0;for(const h of Object.values(this.buckets))for(const p of h)p.invoke();this.executingCallbacks=!1;for(const h of this.deferredCallbacks)this.buckets[h.phase].add(h);this.deferredCallbacks.clear()}destroy(){for(const h of Object.values(this.buckets))h.clear();this.deferredCallbacks.clear()}}let Z=(()=>{class c{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const p=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const b of p)b()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=zo({token:c,providedIn:"root",factory:()=>new c})}}return c})();function ne(c){return!!qr(c)}function it(c,h,p){let b=p?c.styles:null,T=p?c.classes:null,I=0;if(null!==h)for(let B=0;B<h.length;B++){const G=h[B];"number"==typeof G?I=G:1==I?T=Cu(T,G):2==I&&(b=Cu(b,G+": "+h[++B]+";"))}p?c.styles=b:c.stylesWithoutHost=b,p?c.classes=T:c.classesWithoutHost=T}class xt extends cb{constructor(h){super(),this.ngModule=h}resolveComponentFactory(h){const p=no(h);return new At(p,this.ngModule)}}function Rt(c){const h=[];for(const p in c){if(!c.hasOwnProperty(p))continue;const b=c[p];void 0!==b&&h.push({propName:Array.isArray(b)?b[0]:b,templateName:p})}return h}class At extends JM{get inputs(){const h=this.componentDef,p=h.inputTransforms,b=Rt(h.inputs);if(null!==p)for(const T of b)p.hasOwnProperty(T.propName)&&(T.transform=p[T.propName]);return b}get outputs(){return Rt(this.componentDef.outputs)}constructor(h,p){super(),this.componentDef=h,this.ngModule=p,this.componentType=h.type,this.selector=function ty(c){return c.map(Ox).join(",")}(h.selectors),this.ngContentSelectors=h.ngContentSelectors?h.ngContentSelectors:[],this.isBoundToModule=!!p}create(h,p,b,T){const I=Si(null);try{let B=(T=T||this.ngModule)instanceof ua?T:T?.injector;B&&null!==this.componentDef.getStandaloneInjector&&(B=this.componentDef.getStandaloneInjector(B)||B);const G=B?new gp(h,B):h,Y=G.get(Tc,null);if(null===Y)throw new Ue(407,!1);const oe=G.get(tA,null),Xe={rendererFactory:Y,sanitizer:oe,inlineEffectRunner:null,afterRenderEventManager:G.get(Z,null),changeDetectionScheduler:G.get(es,null)},Je=Y.createRenderer(null,this.componentDef),vt=this.componentDef.selectors[0][0]||"div",$t=b?function pE(c,h,p,b){const I=b.get(By,!1)||p===ao.ShadowDom,B=c.selectRootElement(h,I);return function yI(c){gm(c)}(B),B}(Je,b,this.componentDef.encapsulation,G):Yg(Je,vt,function _t(c){const h=c.toLowerCase();return"svg"===h?at:"math"===h?"math":null}(vt));let Vi=512;this.componentDef.signals?Vi|=4096:this.componentDef.onPush||(Vi|=16);let Zi=null;null!==$t&&(Zi=Py($t,G,!0));const ci=$v(0,null,null,1,0,null,null,null,null,null,null),Nr=i_(null,ci,null,Vi,null,null,Xe,Je,G,null,Zi);let Fo,Rs;pd(Nr);try{const pl=this.componentDef;let Bd,ax=null;pl.findHostDirectiveDefs?(Bd=[],ax=new Map,pl.findHostDirectiveDefs(pl,Bd,ax),Bd.push(pl)):Bd=[pl];const ik=function Dt(c,h){const p=c[Fi],b=sr;return c[b]=h,n_(p,b,2,"#host",null)}(Nr,$t),M5=function ii(c,h,p,b,T,I,B){const G=T[Fi];!function Lt(c,h,p,b){for(const T of c)h.mergedAttrs=El(h.mergedAttrs,T.hostAttrs);null!==h.mergedAttrs&&(it(h,h.mergedAttrs,!0),null!==p&&t_(b,p,h))}(b,c,h,B);let Y=null;null!==h&&(Y=Py(h,T[xs]));const oe=I.rendererFactory.createRenderer(h,p);let ue=16;p.signals?ue=4096:p.onPush&&(ue=64);const Pe=i_(T,mE(p),null,ue,T[c.index],c,I,oe,null,null,Y);return G.firstCreatePass&&Jy(G,c,b.length-1),a_(T,Pe),T[c.index]=Pe}(ik,$t,pl,Bd,Nr,Xe,Je);Rs=ze(ci,sr),$t&&function Ti(c,h,p,b){if(b)Pf(c,p,["ng-version","18.0.4"]);else{const{attrs:T,classes:I}=function iy(c){const h=[],p=[];let b=1,T=2;for(;b<c.length;){let I=c[b];if("string"==typeof I)2===T?""!==I&&h.push(I,c[++b]):8===T&&p.push(I);else{if(!Ra(T))break;T=I}b++}return{attrs:h,classes:p}}(h.selectors[0]);T&&Pf(c,p,T),I&&I.length>0&&e_(c,p,I.join(" "))}}(Je,pl,$t,b),void 0!==p&&function Ut(c,h,p){const b=c.projection=[];for(let T=0;T<h.length;T++){const I=p[T];b.push(null!=I?Array.from(I):null)}}(Rs,this.ngContentSelectors,p),Fo=function Ui(c,h,p,b,T,I){const B=lo(),G=T[Fi],Y=Ze(B,T);_E(G,T,B,p,null,b);for(let ue=0;ue<p.length;ue++)Ol(yc(T,G,B.directiveStart+ue,B),T);vE(G,T,B),Y&&Ol(Y,T);const oe=yc(T,G,B.directiveStart+B.componentOffset,B);if(c[Ao]=T[Ao]=oe,null!==I)for(const ue of I)ue(oe,h);return Gv(G,B,T),oe}(M5,pl,Bd,ax,Nr,[on]),o0(ci,Nr,null)}finally{fv()}return new ft(this.componentType,Fo,im(Rs,Nr),Nr,Rs)}finally{Si(I)}}}class ft extends QM{constructor(h,p,b,T,I){super(),this.location=b,this._rootLView=T,this._tNode=I,this.previousInputValues=null,this.instance=p,this.hostView=this.changeDetectorRef=new Jv(T,void 0,!1),this.componentType=h}setInput(h,p){const b=this._tNode.inputs;let T;if(null!==b&&(T=b[h])){if(this.previousInputValues??=new Map,this.previousInputValues.has(h)&&Object.is(this.previousInputValues.get(h),p))return;const I=this._rootLView;c_(I[Fi],I,T,h,p),this.previousInputValues.set(h,p),d_(Mt(this._tNode.index,I),1)}}get injector(){return new ra(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(h){this.hostView.onDestroy(h)}}function on(){const c=lo();mp(Ot()[Fi],c)}let Gi=(()=>{class c{static{this.__NG_ELEMENT_ID__=Bi}}return c})();function Bi(){return Yn(lo(),Ot())}const Gt=Gi,Qi=class extends Gt{constructor(h,p,b){super(),this._lContainer=h,this._hostTNode=p,this._hostLView=b}get element(){return im(this._hostTNode,this._hostLView)}get injector(){return new ra(this._hostTNode,this._hostLView)}get parentInjector(){const h=uy(this._hostTNode,this._hostLView);if(_p(h)){const p=Hu(h,this._hostLView),b=vp(h);return new ra(p[Fi].data[b+8],p)}return new ra(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(h){const p=Hn(this._lContainer);return null!==p&&p[h]||null}get length(){return this._lContainer.length-Bs}createEmbeddedView(h,p,b){let T,I;"number"==typeof b?T=b:null!=b&&(T=b.index,I=b.injector);const B=Wh(this._lContainer,h.ssrId),G=h.createEmbeddedViewImpl(p||{},I,B);return this.insertImpl(G,T,Lp(this._hostTNode,B)),G}createComponent(h,p,b,T,I){const B=h&&!function _c(c){return"function"==typeof c}(h);let G;if(B)G=p;else{const vt=p||{};G=vt.index,b=vt.injector,T=vt.projectableNodes,I=vt.environmentInjector||vt.ngModuleRef}const Y=B?h:new At(no(h)),oe=b||this.parentInjector;if(!I&&null==Y.ngModule){const $t=(B?oe:this.parentInjector).get(ua,null);$t&&(I=$t)}const ue=no(Y.componentType??{}),Pe=Wh(this._lContainer,ue?.id??null),Je=Y.create(oe,T,Pe?.firstChild??null,I);return this.insertImpl(Je.hostView,G,Lp(this._hostTNode,Pe)),Je}insert(h,p){return this.insertImpl(h,p,!0)}insertImpl(h,p,b){const T=h._lView;if(function _i(c){return ha(c[vs])}(T)){const G=this.indexOf(h);if(-1!==G)this.detach(G);else{const Y=T[vs],oe=new Qi(Y,Y[Ys],Y[vs]);oe.detach(oe.indexOf(h))}}const I=this._adjustIndex(p),B=this._lContainer;return Fp(B,T,I,b),h.attachToViewContainerRef(),yg(hn(B),I,h),h}move(h,p){return this.insert(h,p)}indexOf(h){const p=Hn(this._lContainer);return null!==p?p.indexOf(h):-1}remove(h){const p=this._adjustIndex(h,-1),b=Qg(this._lContainer,p);b&&(Zd(hn(this._lContainer),p),Es(b[Fi],b))}detach(h){const p=this._adjustIndex(h,-1),b=Qg(this._lContainer,p);return b&&null!=Zd(hn(this._lContainer),p)?new Jv(b):null}_adjustIndex(h,p=0){return h??this.length+p}};function Hn(c){return c[8]}function hn(c){return c[8]||(c[8]=[])}function Yn(c,h){let p;const b=h[c.index];return ha(b)?p=b:(p=t0(b,h,null,c),h[c.index]=p,a_(h,p)),xr(p,h,c,b),new Qi(p,c,h)}let xr=function Fr(c,h,p,b){if(c[Wc])return;let T;T=8&p.type?rt(b):function In(c,h){const p=c[_r],b=p.createComment(""),T=Ze(h,c);return Jg(p,kp(p,T),b,function kM(c,h){return c.nextSibling(h)}(p,T),!1),b}(h,p),c[Wc]=T},Rn=()=>!1;class Mo{constructor(h){this.queryList=h,this.matches=null}clone(){return new Mo(this.queryList)}setDirty(){this.queryList.setDirty()}}class Jr{constructor(h=[]){this.queries=h}createEmbeddedView(h){const p=h.queries;if(null!==p){const b=null!==h.contentQueries?h.contentQueries[0]:p.length,T=[];for(let I=0;I<b;I++){const B=p.getByIndex(I);T.push(this.queries[B.indexInDeclarationView].clone())}return new Jr(T)}return null}insertView(h){this.dirtyQueriesWithMatches(h)}detachView(h){this.dirtyQueriesWithMatches(h)}finishViewCreation(h){this.dirtyQueriesWithMatches(h)}dirtyQueriesWithMatches(h){for(let p=0;p<this.queries.length;p++)null!==db(h,p).matches&&this.queries[p].setDirty()}}class ms{constructor(h,p,b=null){this.flags=p,this.read=b,this.predicate="string"==typeof h?function Pd(c){return c.split(",").map(h=>h.trim())}(h):h}}class Is{constructor(h=[]){this.queries=h}elementStart(h,p){for(let b=0;b<this.queries.length;b++)this.queries[b].elementStart(h,p)}elementEnd(h){for(let p=0;p<this.queries.length;p++)this.queries[p].elementEnd(h)}embeddedTView(h){let p=null;for(let b=0;b<this.length;b++){const T=null!==p?p.length:0,I=this.getByIndex(b).embeddedTView(h,T);I&&(I.indexInDeclarationView=b,null!==p?p.push(I):p=[I])}return null!==p?new Is(p):null}template(h,p){for(let b=0;b<this.queries.length;b++)this.queries[b].template(h,p)}getByIndex(h){return this.queries[h]}get length(){return this.queries.length}track(h){this.queries.push(h)}}class aa{constructor(h,p=-1){this.metadata=h,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=p}elementStart(h,p){this.isApplyingToNode(p)&&this.matchTNode(h,p)}elementEnd(h){this._declarationNodeIndex===h.index&&(this._appliesToNextNode=!1)}template(h,p){this.elementStart(h,p)}embeddedTView(h,p){return this.isApplyingToNode(h)?(this.crossesNgTemplate=!0,this.addMatch(-h.index,p),new aa(this.metadata)):null}isApplyingToNode(h){if(this._appliesToNextNode&&1&~this.metadata.flags){const p=this._declarationNodeIndex;let b=h.parent;for(;null!==b&&8&b.type&&b.index!==p;)b=b.parent;return p===(null!==b?b.index:-1)}return this._appliesToNextNode}matchTNode(h,p){const b=this.metadata.predicate;if(Array.isArray(b))for(let T=0;T<b.length;T++){const I=b[T];this.matchTNodeWithReadOption(h,p,Uo(p,I)),this.matchTNodeWithReadOption(h,p,pv(p,h,I,!1,!1))}else b===eh?4&p.type&&this.matchTNodeWithReadOption(h,p,-1):this.matchTNodeWithReadOption(h,p,pv(p,h,b,!1,!1))}matchTNodeWithReadOption(h,p,b){if(null!==b){const T=this.metadata.read;if(null!==T)if(T===_v||T===Gi||T===eh&&4&p.type)this.addMatch(p.index,-2);else{const I=pv(p,h,T,!1,!1);null!==I&&this.addMatch(p.index,I)}else this.addMatch(p.index,b)}}addMatch(h,p){null===this.matches?this.matches=[h,p]:this.matches.push(h,p)}}function Uo(c,h){const p=c.localNames;if(null!==p)for(let b=0;b<p.length;b+=2)if(p[b]===h)return p[b+1];return null}function ma(c,h,p,b){return-1===p?function ts(c,h){return 11&c.type?im(c,h):4&c.type?th(c,h):null}(h,c):-2===p?function pa(c,h,p){return p===_v?im(h,c):p===eh?th(h,c):p===Gi?Yn(h,c):void 0}(c,h,b):yc(c,c[Fi],p,h)}function ga(c,h,p,b){const T=h[ud].queries[b];if(null===T.matches){const I=c.data,B=p.matches,G=[];for(let Y=0;null!==B&&Y<B.length;Y+=2){const oe=B[Y];G.push(oe<0?null:ma(h,I[oe],B[Y+1],p.metadata.read))}T.matches=G}return T.matches}function Co(c,h,p,b){const T=c.queries.getByIndex(p),I=T.matches;if(null!==I){const B=ga(c,h,T,p);for(let G=0;G<I.length;G+=2){const Y=I[G];if(Y>0)b.push(B[G/2]);else{const oe=I[G+1],ue=h[-Y];for(let Pe=Bs;Pe<ue.length;Pe++){const Xe=ue[Pe];Xe[Bu]===Xe[vs]&&Co(Xe[Fi],Xe,oe,b)}if(null!==ue[Th]){const Pe=ue[Th];for(let Xe=0;Xe<Pe.length;Xe++){const Je=Pe[Xe];Co(Je[Fi],Je,oe,b)}}}}}return b}function Yh(c,h,p){const b=new vy(!(4&~p));return function Zy(c,h,p,b){const T=NM(h);T.push(p),c.firstCreatePass&&BM(c).push(b,T.length-1)}(c,h,b,b.destroy),(h[ud]??=new Jr).queries.push(new Mo(b))-1}function Sc(c,h,p){null===c.queries&&(c.queries=new Is),c.queries.track(new aa(h,p))}function db(c,h){return c.queries.getByIndex(h)}function _0(c,h){const p=c[Fi],b=db(p,h);return b.crossesNgTemplate?Co(p,c,h,[]):ga(p,c,b,h)}function Xp(c){return"function"==typeof c&&void 0!==c[Tt]}function GE(c,h){hl("NgSignals");const p=function jt(c){const h=Object.create(No);h.value=c;const p=()=>(Ft(h),h.value);return p[Tt]=h,p}(c),b=p[Tt];return h?.equal&&(b.equal=h.equal),p.set=T=>Eo(b,T),p.update=T=>function zr(c,h){un()||Hr(),Eo(c,h(c.value))}(b,T),p.asReadonly=HE.bind(p),p}function HE(){const c=this[Tt];if(void 0===c.readonlyFn){const h=()=>this();h[Tt]=c,c.readonlyFn=h}return c.readonlyFn}function mu(c){return Xp(c)&&"function"==typeof c.set}function PI(c){let h=function oo(c){return Object.getPrototypeOf(c.prototype).constructor}(c.type),p=!0;const b=[c];for(;h;){let T;if($l(c))T=h.\u0275cmp||h.\u0275dir;else{if(h.\u0275cmp)throw new Ue(903,!1);T=h.\u0275dir}if(T){if(p){b.push(T);const B=c;B.inputs=s1(c.inputs),B.inputTransforms=s1(c.inputTransforms),B.declaredInputs=s1(c.declaredInputs),B.outputs=s1(c.outputs);const G=T.hostBindings;G&&ML(c,G);const Y=T.viewQuery,oe=T.contentQueries;if(Y&&A4(c,Y),oe&&D4(c,oe),OI(c,T),Um(c.outputs,T.outputs),$l(T)&&T.data.animation){const ue=c.data;ue.animation=(ue.animation||[]).concat(T.data.animation)}}const I=T.features;if(I)for(let B=0;B<I.length;B++){const G=I[B];G&&G.ngInherit&&G(c),G===PI&&(p=!1)}}h=Object.getPrototypeOf(h)}!function M4(c){let h=0,p=null;for(let b=c.length-1;b>=0;b--){const T=c[b];T.hostVars=h+=T.hostVars,T.hostAttrs=El(T.hostAttrs,p=El(p,T.hostAttrs))}}(b)}function OI(c,h){for(const p in h.inputs){if(!h.inputs.hasOwnProperty(p)||c.inputs.hasOwnProperty(p))continue;const b=h.inputs[p];if(void 0!==b&&(c.inputs[p]=b,c.declaredInputs[p]=h.declaredInputs[p],null!==h.inputTransforms)){const T=Array.isArray(b)?b[0]:b;if(!h.inputTransforms.hasOwnProperty(T))continue;c.inputTransforms??={},c.inputTransforms[T]=h.inputTransforms[T]}}}function s1(c){return c===Kd?{}:c===yo?[]:c}function A4(c,h){const p=c.viewQuery;c.viewQuery=p?(b,T)=>{h(b,T),p(b,T)}:h}function D4(c,h){const p=c.contentQueries;c.contentQueries=p?(b,T,I)=>{h(b,T,I),p(b,T,I)}:h}function ML(c,h){const p=c.hostBindings;c.hostBindings=p?(b,T)=>{h(b,T),p(b,T)}:h}function RL(c){const h=c.inputConfig,p={};for(const b in h)if(h.hasOwnProperty(b)){const T=h[b];Array.isArray(T)&&T[3]&&(p[b]=T[3])}c.inputTransforms=p}class x_{}class FI{}function PL(c,h){return new rA(c,h??null,[])}class rA extends x_{constructor(h,p,b){super(),this._parent=p,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new xt(this);const T=qr(h);this._bootstrapComponents=ll(T.bootstrap),this._r3Injector=gy(h,p,[{provide:x_,useValue:this},{provide:cb,useValue:this.componentFactoryResolver},...b],Xs(h),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(h)}get injector(){return this._r3Injector}destroy(){const h=this._r3Injector;!h.destroyed&&h.destroy(),this.destroyCbs.forEach(p=>p()),this.destroyCbs=null}onDestroy(h){this.destroyCbs.push(h)}}class oA extends FI{constructor(h){super(),this.moduleType=h}create(h){return new rA(this.moduleType,h,[])}}class NI extends x_{constructor(h){super(),this.componentFactoryResolver=new xt(this),this.instance=null;const p=new jc([...h.providers,{provide:x_,useValue:this},{provide:cb,useValue:this.componentFactoryResolver}],h.parent||Ur(),h.debugName,new Set(["environment"]));this.injector=p,h.runEnvironmentInitializers&&p.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(h){this.injector.onDestroy(h)}}function sA(c,h,p=null){return new NI({providers:c,parent:h,debugName:p,runEnvironmentInitializers:!0}).injector}function aA(c){return!!lA(c)&&(Array.isArray(c)||!(c instanceof Map)&&Symbol.iterator in c)}function lA(c){return null!==c&&("function"==typeof c||"object"==typeof c)}function Dm(c,h,p){return c[h]=p}function Fa(c,h,p){return!Object.is(c[h],p)&&(c[h]=p,!0)}function gb(c,h,p,b){const T=Fa(c,h,p);return Fa(c,h+1,b)||T}function c1(c,h,p,b,T,I,B,G,Y,oe){const ue=p+sr,Pe=h.firstCreatePass?function VL(c,h,p,b,T,I,B,G,Y){const oe=h.consts,ue=n_(h,c,4,B||null,G||null);Qy(h,p,ue,vi(oe,Y)),mp(h,ue);const Pe=ue.tView=$v(2,ue,b,T,I,h.directiveRegistry,h.pipeRegistry,null,h.schemas,oe,null);return null!==h.queries&&(h.queries.template(h,ue),Pe.queries=h.queries.embeddedTView(ue)),ue}(ue,h,c,b,T,I,B,G,Y):h.data[ue];$a(Pe,!1);const Xe=BI(h,c,Pe,p);zn()&&sa(h,c,Xe,Pe),Ol(Xe,c);const Je=t0(Xe,c,Xe,Pe);return c[ue]=Je,a_(c,Je),function po(c,h,p){return Rn(c,h,p)}(Je,Pe,c),cp(Pe)&&r_(h,c,Pe),null!=Y&&Hv(c,Pe,oe),Pe}function cA(c,h,p,b,T,I,B,G){const Y=Ot(),oe=Jn();return c1(Y,oe,c,h,p,b,T,vi(oe.consts,I),B,G),cA}let BI=function VI(c,h,p,b){return Il(!0),h[_r].createComment("")};function EA(c,h,p,b){const T=Ot();return Fa(T,fd(),h)&&(Jn(),ec(bs(),T,c,h,p,b)),EA}function w_(c,h,p,b){return Fa(c,fd(),p)?h+Dr(p)+b:$r}function Zp(c,h,p,b,T,I,B,G){const oe=function XE(c,h,p,b,T){const I=gb(c,h,p,b);return Fa(c,h+2,T)||I}(c,bc(),p,T,B);return iu(3),oe?h+Dr(p)+b+Dr(T)+I+Dr(B)+G:$r}function O0(c,h){return c<<17|h<<2}function Kp(c){return c>>17&32767}function aT(c){return 2|c}function xb(c){return(131068&c)>>2}function MA(c,h){return-131069&c|h<<2}function AA(c){return 1|c}function t2(c,h,p,b){const T=c[p+1],I=null===h;let B=b?Kp(T):xb(T),G=!1;for(;0!==B&&(!1===G||I);){const oe=c[B+1];DA(c[B],h)&&(G=!0,c[B+1]=b?AA(oe):aT(oe)),B=b?Kp(oe):xb(oe)}G&&(c[p+1]=b?aT(T):AA(T))}function DA(c,h){return null===c||null==h||(Array.isArray(c)?c[1]:c)===h||!(!Array.isArray(c)||"string"!=typeof h)&&Iu(c,h)>=0}const ml={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function n2(c){return c.substring(ml.key,ml.keyEnd)}function tF(c){return c.substring(ml.value,ml.valueEnd)}function kA(c,h){const p=ml.textEnd;return p===h?-1:(h=ml.keyEnd=function IA(c,h,p){for(;h<p&&c.charCodeAt(h)>32;)h++;return h}(c,ml.key=h,p),Rm(c,h,p))}function ch(c,h){const p=ml.textEnd;let b=ml.key=Rm(c,h,p);return p===b?-1:(b=ml.keyEnd=function rF(c,h,p){let b;for(;h<p&&(45===(b=c.charCodeAt(h))||95===b||(-33&b)>=65&&(-33&b)<=90||b>=48&&b<=57);)h++;return h}(c,b,p),b=r2(c,b,p),b=ml.value=Rm(c,b,p),b=ml.valueEnd=function RA(c,h,p){let b=-1,T=-1,I=-1,B=h,G=B;for(;B<p;){const Y=c.charCodeAt(B++);if(59===Y)return G;34===Y||39===Y?G=B=o2(c,Y,B,p):h===B-4&&85===I&&82===T&&76===b&&40===Y?G=B=o2(c,41,B,p):Y>32&&(G=B),I=T,T=b,b=-33&Y}return G}(c,b,p),r2(c,b,p))}function lT(c){ml.key=0,ml.keyEnd=0,ml.value=0,ml.valueEnd=0,ml.textEnd=c.length}function Rm(c,h,p){for(;h<p&&c.charCodeAt(h)<=32;)h++;return h}function r2(c,h,p,b){return(h=Rm(c,h,p))<p&&h++,h}function o2(c,h,p,b){let T=-1,I=p;for(;I<b;){const B=c.charCodeAt(I++);if(B==h&&92!==T)return I;T=92==B&&92===T?0:B}throw new Error}function L0(c,h,p){const b=Ot();return Fa(b,fd(),h)&&zs(Jn(),bs(),b,c,h,b[_r],p,!1),L0}function PA(c,h,p,b,T){const B=T?"class":"style";c_(c,p,h.inputs[B],B,b)}function cT(c,h,p){return Kh(c,h,p,!1),cT}function dT(c,h){return Kh(c,h,null,!0),dT}function dh(c){hh(sF,uh,c,!1)}function uh(c,h){for(let p=function nF(c){return lT(c),ch(c,Rm(c,0,ml.textEnd))}(h);p>=0;p=ch(h,p))sF(c,n2(h),tF(h))}function wb(c){hh(W4,Pm,c,!0)}function Pm(c,h){for(let p=function iF(c){return lT(c),kA(c,Rm(c,0,ml.textEnd))}(h);p>=0;p=kA(h,p))el(c,n2(h),!0)}function Kh(c,h,p,b){const T=Ot(),I=Jn(),B=iu(2);I.firstUpdatePass&&OA(I,c,B,b),h!==$r&&Fa(T,B,h)&&NA(I,I.data[rl()],T,T[_r],c,T[B+1]=function aF(c,h){return null==c||""===c||("string"==typeof h?c+=h:"object"==typeof c&&(c=Xs(Bh(c)))),c}(h,p),b,B)}function hh(c,h,p,b){const T=Jn(),I=iu(2);T.firstUpdatePass&&OA(T,null,I,b);const B=Ot();if(p!==$r&&Fa(B,I,p)){const G=T.data[rl()];if(l2(G,b)&&!s2(T,I)){let Y=b?G.classesWithoutHost:G.stylesWithoutHost;null!==Y&&(p=Cu(Y,p||"")),PA(T,G,B,p,b)}else!function uT(c,h,p,b,T,I,B,G){T===$r&&(T=yo);let Y=0,oe=0,ue=0<T.length?T[0]:null,Pe=0<I.length?I[0]:null;for(;null!==ue||null!==Pe;){const Xe=Y<T.length?T[Y+1]:void 0,Je=oe<I.length?I[oe+1]:void 0;let $t,vt=null;ue===Pe?(Y+=2,oe+=2,Xe!==Je&&(vt=Pe,$t=Je)):null===Pe||null!==ue&&ue<Pe?(Y+=2,vt=ue):(oe+=2,vt=Pe,$t=Je),null!==vt&&NA(c,h,p,b,vt,$t,B,G),ue=Y<T.length?T[Y]:null,Pe=oe<I.length?I[oe]:null}}(T,G,B,B[_r],B[I+1],B[I+1]=function a2(c,h,p){if(null==p||""===p)return yo;const b=[],T=Bh(p);if(Array.isArray(T))for(let I=0;I<T.length;I++)c(b,T[I],!0);else if("object"==typeof T)for(const I in T)T.hasOwnProperty(I)&&c(b,I,T[I]);else"string"==typeof T&&h(b,T);return b}(c,h,p),b,I)}}function s2(c,h){return h>=c.expandoStartIndex}function OA(c,h,p,b){const T=c.data;if(null===T[p+1]){const I=T[rl()],B=s2(c,p);l2(I,b)&&null===h&&!B&&(h=!1),h=function _1(c,h,p,b){const T=md(c);let I=b?h.residualClasses:h.residualStyles;if(null===T)0===(b?h.classBindings:h.styleBindings)&&(p=F0(p=FA(null,c,h,p,b),h.attrs,b),I=null);else{const B=h.directiveStylingLast;if(-1===B||c[B]!==T)if(p=FA(T,c,h,p,b),null===I){let Y=function oF(c,h,p){const b=p?h.classBindings:h.styleBindings;if(0!==xb(b))return c[Kp(b)]}(c,h,b);void 0!==Y&&Array.isArray(Y)&&(Y=FA(null,c,h,Y[1],b),Y=F0(Y,h.attrs,b),function v1(c,h,p,b){c[Kp(p?h.classBindings:h.styleBindings)]=b}(c,h,b,Y))}else I=function LA(c,h,p){let b;const T=h.directiveEnd;for(let I=1+h.directiveStylingLast;I<T;I++)b=F0(b,c[I].hostAttrs,p);return F0(b,h.attrs,p)}(c,h,b)}return void 0!==I&&(b?h.residualClasses=I:h.residualStyles=I),p}(T,I,h,b),function eF(c,h,p,b,T,I){let B=I?h.classBindings:h.styleBindings,G=Kp(B),Y=xb(B);c[b]=p;let ue,oe=!1;if(Array.isArray(p)?(ue=p[1],(null===ue||Iu(p,ue)>0)&&(oe=!0)):ue=p,T)if(0!==Y){const Xe=Kp(c[G+1]);c[b+1]=O0(Xe,G),0!==Xe&&(c[Xe+1]=MA(c[Xe+1],b)),c[G+1]=function KL(c,h){return 131071&c|h<<17}(c[G+1],b)}else c[b+1]=O0(G,0),0!==G&&(c[G+1]=MA(c[G+1],b)),G=b;else c[b+1]=O0(Y,0),0===G?G=b:c[Y+1]=MA(c[Y+1],b),Y=b;oe&&(c[b+1]=aT(c[b+1])),t2(c,ue,b,!0),t2(c,ue,b,!1),function e2(c,h,p,b,T){const I=T?c.residualClasses:c.residualStyles;null!=I&&"string"==typeof h&&Iu(I,h)>=0&&(p[b+1]=AA(p[b+1]))}(h,ue,c,b,I),B=O0(G,Y),I?h.classBindings=B:h.styleBindings=B}(T,I,h,p,B,b)}}function FA(c,h,p,b,T){let I=null;const B=p.directiveEnd;let G=p.directiveStylingLast;for(-1===G?G=p.directiveStart:G++;G<B&&(I=h[G],b=F0(b,I.hostAttrs,T),I!==c);)G++;return null!==c&&(p.directiveStylingLast=G),b}function F0(c,h,p){const b=p?1:2;let T=-1;if(null!==h)for(let I=0;I<h.length;I++){const B=h[I];"number"==typeof B?T=B:T===b&&(Array.isArray(c)||(c=void 0===c?[]:["",c]),el(c,B,!!p||h[++I]))}return void 0===c?null:c}function sF(c,h,p){el(c,h,Bh(p))}function W4(c,h,p){const b=String(h);""!==b&&!b.includes(" ")&&el(c,b,p)}function NA(c,h,p,b,T,I,B,G){if(!(3&h.type))return;const Y=c.data,oe=Y[G+1],ue=function QL(c){return!(1&~c)}(oe)?BA(Y,h,p,T,xb(oe),B):void 0;hT(ue)||(hT(I)||function G4(c){return!(2&~c)}(oe)&&(I=BA(Y,null,p,T,G,B)),function Uv(c,h,p,b,T){if(h)T?c.addClass(p,b):c.removeClass(p,b);else{let I=-1===b.indexOf("-")?void 0:Aw.DashCase;null==T?c.removeStyle(p,b,I):("string"==typeof T&&T.endsWith("!important")&&(T=T.slice(0,-10),I|=Aw.Important),c.setStyle(p,b,T,I))}}(b,B,Pt(rl(),p),T,I))}function BA(c,h,p,b,T,I){const B=null===h;let G;for(;T>0;){const Y=c[T],oe=Array.isArray(Y),ue=oe?Y[1]:Y,Pe=null===ue;let Xe=p[T+1];Xe===$r&&(Xe=Pe?yo:void 0);let Je=Pe?wg(Xe,b):ue===b?Xe:void 0;if(oe&&!hT(Je)&&(Je=wg(Y,b)),hT(Je)&&(G=Je,B))return G;const vt=c[T+1];T=B?Kp(vt):xb(vt)}if(null!==h){let Y=I?h.residualClasses:h.residualStyles;null!=Y&&(G=wg(Y,b))}return G}function hT(c){return void 0!==c}function l2(c,h){return!!(c.flags&(h?8:16))}function c2(c,h,p){hh(el,Pm,w_(Ot(),c,h,p),!0)}class Y4{destroy(h){}updateValue(h,p){}swap(h,p){const b=Math.min(h,p),T=Math.max(h,p),I=this.detach(T);if(T-b>1){const B=this.detach(b);this.attach(b,I),this.attach(T,B)}else this.attach(b,I)}move(h,p){this.attach(p,this.detach(h))}}function N0(c,h,p,b,T){return c===p&&Object.is(h,b)?1:Object.is(T(c,h),T(p,b))?-1:0}function zA(c,h,p,b){return!(void 0===h||!h.has(b)||(c.attach(p,h.get(b)),h.delete(b),0))}function u2(c,h,p,b,T){if(zA(c,h,b,p(b,T)))c.updateValue(b,T);else{const I=c.create(b,T);c.attach(b,I)}}function h2(c,h,p,b){const T=new Set;for(let I=h;I<=p;I++)T.add(b(I,c.at(I)));return T}class UA{constructor(){this.kvMap=new Map,this._vMap=void 0}has(h){return this.kvMap.has(h)}delete(h){if(!this.has(h))return!1;const p=this.kvMap.get(h);return void 0!==this._vMap&&this._vMap.has(p)?(this.kvMap.set(h,this._vMap.get(p)),this._vMap.delete(p)):this.kvMap.delete(h),!0}get(h){return this.kvMap.get(h)}set(h,p){if(this.kvMap.has(h)){let b=this.kvMap.get(h);void 0===this._vMap&&(this._vMap=new Map);const T=this._vMap;for(;T.has(b);)b=T.get(b);T.set(b,p)}else this.kvMap.set(h,p)}forEach(h){for(let[p,b]of this.kvMap)if(h(b,p),void 0!==this._vMap){const T=this._vMap;for(;T.has(b);)b=T.get(b),h(b,p)}}}function B0(c,h){hl("NgControlFlow");const p=Ot(),b=fd(),T=p[b]!==$r?p[b]:-1,I=-1!==T?E_(p,sr+T):void 0;if(Fa(p,b,c)){const G=Si(null);try{if(void 0!==I&&Lw(I,0),-1!==c){const Y=sr+c,oe=E_(p,Y),ue=$A(p[Fi],Y),Pe=Wh(oe,ue.tView.ssrId);Fp(oe,vm(p,ue,h,{dehydratedView:Pe}),0,Lp(ue,Pe))}}finally{Si(G)}}else if(void 0!==I){const G=xE(I,0);void 0!==G&&(G[Ao]=h)}}class Cb{constructor(h,p,b){this.lContainer=h,this.$implicit=p,this.$index=b}get $count(){return this.lContainer.length-Bs}}function f2(c){return c}function V0(c,h){return h}class m2{constructor(h,p,b){this.hasEmptyBlock=h,this.trackByFn=p,this.liveCollection=b}}function fT(c,h,p,b,T,I,B,G,Y,oe,ue,Pe,Xe){hl("NgControlFlow");const Je=Ot(),vt=Jn(),$t=void 0!==Y,Vi=Ot(),Zi=G?B.bind(Vi[us][Ao]):B,ci=new m2($t,Zi);Vi[sr+c]=ci,c1(Je,vt,c+1,h,p,b,T,vi(vt.consts,I)),$t&&c1(Je,vt,c+2,Y,oe,ue,Pe,vi(vt.consts,Xe))}class jA extends Y4{constructor(h,p,b){super(),this.lContainer=h,this.hostLView=p,this.templateTNode=b,this.operationsCounter=void 0,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Bs}at(h){return this.getLView(h)[Ao].$implicit}attach(h,p){const b=p[Ns];this.needsIndexUpdate||=h!==this.length,Fp(this.lContainer,p,h,Lp(this.templateTNode,b))}detach(h){return this.needsIndexUpdate||=h!==this.length-1,function HA(c,h){return Qg(c,h)}(this.lContainer,h)}create(h,p){const b=Wh(this.lContainer,this.templateTNode.tView.ssrId),T=vm(this.hostLView,this.templateTNode,new Cb(this.lContainer,p,h),{dehydratedView:b});return this.operationsCounter?.recordCreate(),T}destroy(h){Es(h[Fi],h),this.operationsCounter?.recordDestroy()}updateValue(h,p){this.getLView(h)[Ao].$implicit=p}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let h=0;h<this.length;h++)this.getLView(h)[Ao].$index=h}getLView(h){return function g2(c,h){return xE(c,h)}(this.lContainer,h)}}function GA(c){const h=Si(null),p=rl();try{const b=Ot(),T=b[Fi],I=b[p],B=p+1,G=E_(b,B);if(void 0===I.liveCollection){const oe=$A(T,B);I.liveCollection=new jA(G,b,oe)}else I.liveCollection.reset();const Y=I.liveCollection;if(function mF(c,h,p){let b,T,I=0,B=c.length-1;if(Array.isArray(h)){let Y=h.length-1;for(;I<=B&&I<=Y;){const oe=c.at(I),ue=h[I],Pe=N0(I,oe,I,ue,p);if(0!==Pe){Pe<0&&c.updateValue(I,ue),I++;continue}const Xe=c.at(B),Je=h[Y],vt=N0(B,Xe,Y,Je,p);if(0!==vt){vt<0&&c.updateValue(B,Je),B--,Y--;continue}const $t=p(I,oe),Vi=p(B,Xe),Zi=p(I,ue);if(Object.is(Zi,Vi)){const ci=p(Y,Je);Object.is(ci,$t)?(c.swap(I,B),c.updateValue(B,Je),Y--,B--):c.move(B,I),c.updateValue(I,ue),I++}else if(b??=new UA,T??=h2(c,I,B,p),zA(c,b,I,Zi))c.updateValue(I,ue),I++,B++;else if(T.has(Zi))b.set($t,c.detach(I)),B--;else{const ci=c.create(I,h[I]);c.attach(I,ci),I++,B++}}for(;I<=Y;)u2(c,b,p,I,h[I]),I++}else if(null!=h){const Y=h[Symbol.iterator]();let oe=Y.next();for(;!oe.done&&I<=B;){const ue=c.at(I),Pe=oe.value,Xe=N0(I,ue,I,Pe,p);if(0!==Xe)Xe<0&&c.updateValue(I,Pe),I++,oe=Y.next();else{b??=new UA,T??=h2(c,I,B,p);const Je=p(I,Pe);if(zA(c,b,I,Je))c.updateValue(I,Pe),I++,B++,oe=Y.next();else if(T.has(Je)){const vt=p(I,ue);b.set(vt,c.detach(I)),B--}else c.attach(I,c.create(I,Pe)),I++,B++,oe=Y.next()}}for(;!oe.done;)u2(c,b,p,c.length,oe.value),oe=Y.next()}for(;I<=B;)c.destroy(c.detach(B--));b?.forEach(Y=>{c.destroy(Y)})}(Y,c,I.trackByFn),Y.updateIndexes(),I.hasEmptyBlock){const oe=fd(),ue=0===Y.length;if(Fa(b,oe,ue)){const Pe=p+2,Xe=E_(b,Pe);if(ue){const Je=$A(T,Pe),vt=Wh(Xe,Je.tView.ssrId);Fp(Xe,vm(b,Je,void 0,{dehydratedView:vt}),0,Lp(Je,vt))}else Lw(Xe,0)}}}finally{Si(h)}}function E_(c,h){return c[h]}function $A(c,h){return ze(c,h)}function Om(c,h,p,b){const T=Ot(),I=Jn(),B=sr+c,G=T[_r],Y=I.firstCreatePass?function _2(c,h,p,b,T,I){const B=h.consts,Y=n_(h,c,2,b,vi(B,T));return Qy(h,p,Y,vi(B,I)),null!==Y.attrs&&it(Y,Y.attrs,!1),null!==Y.mergedAttrs&&it(Y,Y.mergedAttrs,!0),null!==h.queries&&h.queries.elementStart(h,Y),Y}(B,I,T,h,p,b):I.data[B],oe=Qp(I,T,Y,G,h,c);T[B]=oe;const ue=cp(Y);return $a(Y,!0),t_(G,oe,Y),!function b0(c){return!(32&~c.flags)}(Y)&&zn()&&sa(I,T,oe,Y),0===function Sr(){return Mi.lFrame.elementDepthCount}()&&Ol(oe,T),function ko(){Mi.lFrame.elementDepthCount++}(),ue&&(r_(I,T,Y),Gv(I,Y,T)),null!==b&&Hv(T,Y),Om}function Qh(){let c=lo();Xf()?Uu():(c=c.parent,$a(c,!1));const h=c;(function Dl(c){return Mi.skipHydrationRootTNode===c})(h)&&function ks(){Mi.skipHydrationRootTNode=null}(),function Yr(){Mi.lFrame.elementDepthCount--}();const p=Jn();return p.firstCreatePass&&(mp(p,c),Ig(c)&&p.queries.elementEnd(c)),null!=h.classesWithoutHost&&function zx(c){return!!(8&c.flags)}(h)&&PA(p,h,Ot(),h.classesWithoutHost,!0),null!=h.stylesWithoutHost&&function cy(c){return!!(16&c.flags)}(h)&&PA(p,h,Ot(),h.stylesWithoutHost,!1),Qh}function b1(c,h,p,b){return Om(c,h,p,b),Qh(),b1}let Qp=(c,h,p,b,T,I)=>(Il(!0),Yg(b,T,function Lg(){return Mi.lFrame.currentNamespace}()));function y1(c,h,p){const b=Ot(),T=Jn(),I=c+sr,B=T.firstCreatePass?function y2(c,h,p,b,T){const I=h.consts,B=vi(I,b),G=n_(h,c,8,"ng-container",B);return null!==B&&it(G,B,!0),Qy(h,p,G,vi(I,T)),null!==h.queries&&h.queries.elementStart(h,G),G}(I,T,b,h,p):T.data[I];$a(B,!0);const G=x2(T,b,B,c);return b[I]=G,zn()&&sa(T,b,G,B),Ol(G,b),cp(B)&&(r_(T,b,B),Gv(T,B,b)),null!=p&&Hv(b,B),y1}function Eb(){let c=lo();const h=Jn();return Xf()?Uu():(c=c.parent,$a(c,!1)),h.firstCreatePass&&(mp(h,c),Ig(c)&&h.queries.elementEnd(c)),Eb}function z0(c,h,p){return y1(c,h,p),Eb(),z0}let x2=(c,h,p,b)=>(Il(!0),Bv(h[_r],""));function qa(){return Ot()}function T_(c,h,p){const b=Ot();return Fa(b,fd(),h)&&zs(Jn(),bs(),b,c,h,b[_r],p,!0),T_}function pT(c,h,p){const b=Ot();if(Fa(b,fd(),h)){const I=Jn(),B=bs();zs(I,B,b,c,h,n0(md(I.data),B,b),p,!0)}return pT}const Jp=void 0;var gF=["en",[["a","p"],["AM","PM"],Jp],[["AM","PM"],Jp,Jp],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Jp,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Jp,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Jp,"{1} 'at' {0}",Jp],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function w2(c){const p=Math.floor(Math.abs(c)),b=c.toString().replace(/^[^.]*\.?/,"").length;return 1===p&&0===b?1:5}];let U0={};function WA(c){const h=function qA(c){return c.toLowerCase().replace(/_/g,"-")}(c);let p=E2(h);if(p)return p;const b=h.split("-")[0];if(p=E2(b),p)return p;if("en"===b)return gF;throw new Ue(701,!1)}function XA(c){return WA(c)[w1.PluralCase]}function E2(c){return c in U0||(U0[c]=fo.ng&&fo.ng.common&&fo.ng.common.locales&&fo.ng.common.locales[c]),U0[c]}var w1=function(c){return c[c.LocaleId=0]="LocaleId",c[c.DayPeriodsFormat=1]="DayPeriodsFormat",c[c.DayPeriodsStandalone=2]="DayPeriodsStandalone",c[c.DaysFormat=3]="DaysFormat",c[c.DaysStandalone=4]="DaysStandalone",c[c.MonthsFormat=5]="MonthsFormat",c[c.MonthsStandalone=6]="MonthsStandalone",c[c.Eras=7]="Eras",c[c.FirstDayOfWeek=8]="FirstDayOfWeek",c[c.WeekendRange=9]="WeekendRange",c[c.DateFormat=10]="DateFormat",c[c.TimeFormat=11]="TimeFormat",c[c.DateTimeFormat=12]="DateTimeFormat",c[c.NumberSymbols=13]="NumberSymbols",c[c.NumberFormats=14]="NumberFormats",c[c.CurrencyCode=15]="CurrencyCode",c[c.CurrencySymbol=16]="CurrencySymbol",c[c.CurrencyName=17]="CurrencyName",c[c.Currencies=18]="Currencies",c[c.Directionality=19]="Directionality",c[c.PluralCase=20]="PluralCase",c[c.ExtraData=21]="ExtraData",c}(w1||{});const j0="en-US";let YA=j0;let V2=(c,h,p)=>{};function iD(c,h,p,b){const T=Ot(),I=Jn(),B=lo();return rD(I,T,T[_r],B,c,h,b),iD}function nD(c,h){const p=lo(),b=Ot(),T=Jn();return rD(T,b,n0(md(T.data),p,b),p,c,h),nD}function rD(c,h,p,b,T,I,B){const G=cp(b),oe=c.firstCreatePass&&BM(c),ue=h[Ao],Pe=NM(h);let Xe=!0;if(3&b.type||B){const $t=Ze(b,h),Vi=B?B($t):$t,Zi=Pe.length,ci=B?Fo=>B(rt(Fo[b.index])):b.index;let Nr=null;if(!B&&G&&(Nr=function Gs(c,h,p,b){const T=c.cleanup;if(null!=T)for(let I=0;I<T.length-1;I+=2){const B=T[I];if(B===p&&T[I+1]===b){const G=h[eu],Y=T[I+2];return G.length>Y?G[Y]:null}"string"==typeof B&&(I+=2)}return null}(c,h,T,b.index)),null!==Nr)(Nr.__ngLastListenerFn__||Nr).__ngNextListenerFn__=I,Nr.__ngLastListenerFn__=I,Xe=!1;else{I=j2(b,h,ue,I),V2($t,T,I);const Fo=p.listen(Vi,T,I);Pe.push(I,Fo),oe&&oe.push(T,ci,Zi,Zi+1)}}else I=j2(b,h,ue,I);const Je=b.outputs;let vt;if(Xe&&null!==Je&&(vt=Je[T])){const $t=vt.length;if($t)for(let Vi=0;Vi<$t;Vi+=2){const Rs=h[vt[Vi]][vt[Vi+1]].subscribe(I),pl=Pe.length;Pe.push(I,Rs),oe&&oe.push(T,b.index,pl,-(pl+1))}}}function U2(c,h,p,b){const T=Si(null);try{return je(6,h,p),!1!==p(b)}catch(I){return l_(c,I),!1}finally{je(7,h,p),Si(T)}}function j2(c,h,p,b){return function T(I){if(I===Function)return b;d_(c.componentOffset>-1?Mt(c.index,h):h,5);let G=U2(h,p,b,I),Y=T.__ngNextListenerFn__;for(;Y;)G=U2(h,p,Y,I)&&G,Y=Y.__ngNextListenerFn__;return G}}function G2(c=1){return function Gu(c){return(Mi.lFrame.contextLView=function Xi(c,h){for(;c>0;)h=h[dd],c--;return h}(c,Mi.lFrame.contextLView))[Ao]}(c)}function FF(c,h){let p=null;const b=function tp(c){const h=c.attrs;if(null!=h){const p=h.indexOf(5);if(!(1&p))return h[p+1]}return null}(c);for(let T=0;T<h.length;T++){const I=h[T];if("*"!==I){if(null===b?Uc(c,I,!0):ov(b,I))return T}else p=T}return p}function H2(c){const h=Ot()[us][Ys];if(!h.projection){const b=h.projection=function xg(c,h){const p=[];for(let b=0;b<c;b++)p.push(h);return p}(c?c.length:1,null),T=b.slice();let I=h.child;for(;null!==I;){const B=c?FF(I,c):0;null!==B&&(T[B]?T[B].projectionNext=I:b[B]=I,T[B]=I),I=I.next}}}function $2(c,h=0,p,b,T,I){const B=Ot(),G=Jn(),Y=b?c+1:null;null!==Y&&c1(B,G,Y,b,T,I,null,p);const oe=n_(G,sr+c,16,null,p||null);null===oe.projection&&(oe.projection=h),Uu();const Pe=!B[Ns]||ws();null===B[us][Ys].projection[oe.projection]&&null!==Y?function NF(c,h,p){const b=sr+p,T=h.data[b],I=c[b],B=Wh(I,T.tView.ssrId);Fp(I,vm(c,T,void 0,{dehydratedView:B}),0,Lp(T,B))}(B,G,Y):Pe&&32&~oe.flags&&function Ip(c,h,p){Ad(h[_r],0,h,p,Vs(c,p,h),Iw(p.parent||h[Ys],p,h))}(G,B,oe)}function Nd(c,h,p,b){!function fl(c,h,p,b){const T=Jn();if(T.firstCreatePass){const I=lo();Sc(T,new ms(h,p,b),I.index),function r1(c,h){const p=c.contentQueries||(c.contentQueries=[]);h!==(p.length?p[p.length-1]:-1)&&p.push(c.queries.length-1,h)}(T,c),!(2&~p)&&(T.staticContentQueries=!0)}return Yh(T,Ot(),p)}(c,h,p,b)}function K2(c,h,p){!function wa(c,h,p){const b=Jn();return b.firstCreatePass&&(Sc(b,new ms(c,h,p),-1),!(2&~h)&&(b.staticViewQueries=!0)),Yh(b,Ot(),h)}(c,h,p)}function Q2(c){const h=Ot(),p=Jn(),b=Xl();fp(b+1);const T=db(p,b);if(c.dirty&&function ti(c){return!(4&~c[ln])}(h)===!(2&~T.metadata.flags)){if(null===T.matches)c.reset([]);else{const I=_0(h,b);c.reset(I,PC),c.notifyOnChanges()}return!0}return!1}function Y0(){return function ic(c,h){return c[ud].queries[h].queryList}(Ot(),Xl())}function tf(c){return Ye(function qf(){return Mi.lFrame.contextLView}(),sr+c)}function lD(c,h=""){const p=Ot(),b=Jn(),T=c+sr,I=b.firstCreatePass?n_(b,T,1,h,null):b.data[T],B=cD(b,p,I,h,c);p[T]=B,zn()&&sa(b,p,B,I),$a(I,!1)}let cD=(c,h,p,b,T)=>(Il(!0),function um(c,h){return c.createText(h)}(h[_r],b));function wT(c){return R1("",c,""),wT}function R1(c,h,p){const b=Ot(),T=w_(b,c,h,p);return T!==$r&&Id(b,rl(),T),R1}function P1(c,h,p,b,T){const I=Ot(),B=function C_(c,h,p,b,T,I){const G=gb(c,bc(),p,T);return iu(2),G?h+Dr(p)+b+Dr(T)+I:$r}(I,c,h,p,b,T);return B!==$r&&Id(I,rl(),B),P1}function uD(c,h,p,b,T,I,B){const G=Ot(),Y=Zp(G,c,h,p,b,T,I,B);return Y!==$r&&Id(G,rl(),Y),uD}function hD(c,h,p){mu(h)&&(h=h());const b=Ot();return Fa(b,fd(),h)&&zs(Jn(),bs(),b,c,h,b[_r],p,!1),hD}function fR(c,h){const p=mu(c);return p&&c.set(h),p}function CT(c,h){const p=Ot(),b=Jn(),T=lo();return rD(b,p,p[_r],T,c,h),CT}function A_(c,h,p,b,T){if(c=gr(c),Array.isArray(c))for(let I=0;I<c.length;I++)A_(c[I],h,p,b,T);else{const I=Jn(),B=Ot(),G=lo();let Y=Fs(c)?c:gr(c.provide);const oe=Oo(c),ue=1048575&G.providerIndexes,Pe=G.directiveStart,Xe=G.providerIndexes>>20;if(Fs(c)||!c.multi){const Je=new wn(oe,T,Dd),vt=so(Y,h,T?ue:ue+Xe,Pe);-1===vt?(Wx(mv(G,B),I,Y),tg(I,c,h.length),h.push(Y),G.directiveStart++,G.directiveEnd++,T&&(G.providerIndexes+=1048576),p.push(Je),B.push(Je)):(p[vt]=Je,B[vt]=Je)}else{const Je=so(Y,h,ue+Xe,Pe),vt=so(Y,h,ue,ue+Xe),Vi=vt>=0&&p[vt];if(T&&!Vi||!T&&!(Je>=0&&p[Je])){Wx(mv(G,B),I,Y);const Zi=function Z0(c,h,p,b,T){const I=new wn(c,p,Dd);return I.multi=[],I.index=h,I.componentProviders=0,ig(I,T,b&&!p),I}(T?WF:mD,p.length,T,b,oe);!T&&Vi&&(p[vt].providerFactory=Zi),tg(I,c,h.length,0),h.push(Y),G.directiveStart++,G.directiveEnd++,T&&(G.providerIndexes+=1048576),p.push(Zi),B.push(Zi)}else tg(I,c,Je>-1?Je:vt,ig(p[T?vt:Je],oe,!T&&b));!T&&b&&Vi&&p[vt].componentProviders++}}}function tg(c,h,p,b){const T=Fs(h),I=function Lx(c){return!!c.useClass}(h);if(T||I){const Y=(I?gr(h.useClass):h).prototype.ngOnDestroy;if(Y){const oe=c.destroyHooks||(c.destroyHooks=[]);if(!T&&h.multi){const ue=oe.indexOf(p);-1===ue?oe.push(p,[b,Y]):oe[ue+1].push(b,Y)}else oe.push(p,Y)}}}function ig(c,h,p){return p&&c.componentProviders++,c.multi.push(h)-1}function so(c,h,p,b){for(let T=p;T<b;T++)if(h[T]===c)return T;return-1}function mD(c,h,p,b){return Bl(this.multi,[])}function WF(c,h,p,b){const T=this.multi;let I;if(this.providerFactory){const B=this.providerFactory.componentProviders,G=yc(p,p[Fi],this.providerFactory.index,b);I=G.slice(0,B),Bl(T,I);for(let Y=B;Y<G.length;Y++)I.push(G[Y])}else I=[],Bl(T,I);return I}function Bl(c,h){for(let p=0;p<c.length;p++)h.push((0,c[p])());return h}function pD(c,h=[]){return p=>{p.providersResolver=(b,T)=>function fD(c,h,p){const b=Jn();if(b.firstCreatePass){const T=$l(c);A_(p,b.data,b.blueprint,T,!0),A_(h,b.data,b.blueprint,T,!1)}}(b,T?T(c):c,h)}}let XF=(()=>{class c{constructor(p){this._injector=p,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(p){if(!p.standalone)return null;if(!this.cachedInjectors.has(p)){const b=Ff(0,p.type),T=b.length>0?sA([b],this._injector,`Standalone[${p.type.name}]`):null;this.cachedInjectors.set(p,T)}return this.cachedInjectors.get(p)}ngOnDestroy(){try{for(const p of this.cachedInjectors.values())null!==p&&p.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=zo({token:c,providedIn:"environment",factory:()=>new c(ba(ua))})}}return c})();function gD(c){hl("NgStandalone"),c.getStandaloneInjector=h=>h.get(XF).getOrCreateStandaloneInjector(c)}function gR(c,h,p){const b=fa()+c,T=Ot();return T[b]===$r?Dm(T,b,p?h.call(p):h()):function l1(c,h){return c[h]}(T,b)}function YF(c,h,p,b){return tN(Ot(),fa(),c,h,p,b)}function D_(c,h,p,b,T){return L1(Ot(),fa(),c,h,p,b,T)}function K0(c,h){const p=c[h];return p===$r?void 0:p}function tN(c,h,p,b,T,I){const B=h+p;return Fa(c,B,T)?Dm(c,B+1,I?b.call(I,T):b(T)):K0(c,B+1)}function L1(c,h,p,b,T,I,B){const G=h+p;return gb(c,G,T,I)?Dm(c,G+2,B?b.call(B,T,I):b(T,I)):K0(c,G+2)}function AT(c,h){const p=Jn();let b;const T=c+sr;p.firstCreatePass?(b=function lU(c,h){if(h)for(let p=h.length-1;p>=0;p--){const b=h[p];if(c===b.name)return b}}(h,p.pipeRegistry),p.data[T]=b,b.onDestroy&&(p.destroyHooks??=[]).push(T,b.onDestroy)):b=p.data[T];const I=b.factory||(b.factory=ku(b.type)),G=Ia(Dd);try{const Y=or(!1),oe=I();return or(Y),function J2(c,h,p,b){p>=c.data.length&&(c.data[p]=null,c.blueprint[p]=null),h[p]=b}(p,Ot(),T,oe),oe}finally{Ia(G)}}function _R(c,h,p){const b=c+sr,T=Ot(),I=Ye(T,b);return Q0(T,b)?tN(T,fa(),h,I.transform,p,I):I.transform(p)}function vR(c,h,p,b){const T=c+sr,I=Ot(),B=Ye(I,T);return Q0(I,T)?L1(I,fa(),h,B.transform,p,b,B):B.transform(p,b)}function Q0(c,h){return c[Fi].data[h].pure}function yR(c,h){return th(c,h)}class LT{constructor(h){this.full=h;const p=h.split(".");this.major=p[0],this.minor=p[1],this.patch=p.slice(2).join(".")}}let SD=(()=>{class c{log(p){console.log(p)}warn(p){console.warn(p)}static{this.\u0275fac=function(b){return new(b||c)}}static{this.\u0275prov=zo({token:c,factory:c.\u0275fac,providedIn:"platform"})}}return c})();const PD=new Qn(""),V1=new Qn("");let LD,OD=(()=>{class c{constructor(p,b,T){this._ngZone=p,this.registry=b,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,LD||(function AN(c){LD=c}(T),T.addToWindow(b)),this._watchAngularEvents(),p.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{fs.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let p=this._callbacks.pop();clearTimeout(p.timeoutId),p.doneCb()}});else{let p=this.getPendingTasks();this._callbacks=this._callbacks.filter(b=>!b.updateCb||!b.updateCb(p)||(clearTimeout(b.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(p=>({source:p.source,creationLocation:p.creationLocation,data:p.data})):[]}addCallback(p,b,T){let I=-1;b&&b>0&&(I=setTimeout(()=>{this._callbacks=this._callbacks.filter(B=>B.timeoutId!==I),p()},b)),this._callbacks.push({doneCb:p,timeoutId:I,updateCb:T})}whenStable(p,b,T){if(T&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(p,b,T),this._runCallbacksIfReady()}registerApplication(p){this.registry.registerApplication(p,this)}unregisterApplication(p){this.registry.unregisterApplication(p)}findProviders(p,b,T){return[]}static{this.\u0275fac=function(b){return new(b||c)(ba(fs),ba(tx),ba(V1))}}static{this.\u0275prov=zo({token:c,factory:c.\u0275fac})}}return c})(),tx=(()=>{class c{constructor(){this._applications=new Map}registerApplication(p,b){this._applications.set(p,b)}unregisterApplication(p){this._applications.delete(p)}unregisterAllApplications(){this._applications.clear()}getTestability(p){return this._applications.get(p)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(p,b=!0){return LD?.findTestabilityInTree(this,p,b)??null}static{this.\u0275fac=function(b){return new(b||c)}}static{this.\u0275prov=zo({token:c,factory:c.\u0275fac,providedIn:"platform"})}}return c})();function z1(c){return!!c&&"function"==typeof c.then}function DN(c){return!!c&&"function"==typeof c.subscribe}const kN=new Qn("");let FD=(()=>{class c{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((p,b)=>{this.resolve=p,this.reject=b}),this.appInits=Tn(kN,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const p=[];for(const T of this.appInits){const I=T();if(z1(I))p.push(I);else if(DN(I)){const B=new Promise((G,Y)=>{I.subscribe({complete:G,error:Y})});p.push(B)}}const b=()=>{this.done=!0,this.resolve()};Promise.all(p).then(()=>{b()}).catch(T=>{this.reject(T)}),0===p.length&&b(),this.initialized=!0}static{this.\u0275fac=function(b){return new(b||c)}}static{this.\u0275prov=zo({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();const ND=new Qn("");let _u=(()=>{class c{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Tn(Yc),this.afterRenderEffectManager=Tn(Z),this.zonelessEnabled=Tn(Xh),this.externalTestViews=new Set,this.beforeRender=new kt.B,this.afterTick=new kt.B,this.componentTypes=[],this.components=[],this.isStable=Tn(qu).hasPendingTasks.pipe((0,Bt.T)(p=>!p)),this._injector=Tn(ua)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(p,b){const T=p instanceof JM;if(!this._injector.get(FD).done)throw!T&&na(p),new Ue(405,!1);let B;B=T?p:this._injector.get(cb).resolveComponentFactory(p),this.componentTypes.push(B.componentType);const G=function RN(c){return c.isBoundToModule}(B)?void 0:this._injector.get(x_),oe=B.create(Pa.NULL,[],b||B.selector,G),ue=oe.location.nativeElement,Pe=oe.injector.get(PD,null);return Pe?.registerApplication(ue),oe.onDestroy(()=>{this.detachView(oe.hostView),VT(this.components,oe),Pe?.unregisterApplication(ue)}),this._loadComponent(oe),oe}tick(){this._tick(!0)}_tick(p){if(this._runningTick)throw new Ue(101,!1);const b=Si(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(p)}catch(T){this.internalErrorHandler(T)}finally{this._runningTick=!1,Si(b),this.afterTick.next()}}detectChangesInAttachedViews(p){let b=null;this._injector.destroyed||(b=this._injector.get(Tc,null,{optional:!0}));let T=0;const I=this.afterRenderEffectManager;for(;T<10;){const B=0===T;if(p||!B){this.beforeRender.next(B);for(let{_lView:G,notifyErrorHandler:Y}of this._views)CU(G,Y,B,this.zonelessEnabled)}else b?.begin?.(),b?.end?.();if(T++,I.executeInternalCallbacks(),!this.allViews.some(({_lView:G})=>Sn(G))&&(I.execute(),!this.allViews.some(({_lView:G})=>Sn(G))))break}}attachView(p){const b=p;this._views.push(b),b.attachToAppRef(this)}detachView(p){const b=p;VT(this._views,b),b.detachFromAppRef()}_loadComponent(p){this.attachView(p.hostView),this.tick(),this.components.push(p);const b=this._injector.get(ND,[]);[...this._bootstrapListeners,...b].forEach(T=>T(p))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(p=>p()),this._views.slice().forEach(p=>p.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(p){return this._destroyListeners.push(p),()=>VT(this._destroyListeners,p)}destroy(){if(this._destroyed)throw new Ue(406,!1);const p=this._injector;p.destroy&&!p.destroyed&&p.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(b){return new(b||c)}}static{this.\u0275prov=zo({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();function VT(c,h){const p=c.indexOf(h);p>-1&&c.splice(p,1)}function CU(c,h,p,b){(p||Sn(c))&&bm(c,h,p&&!b?0:1)}class VD{constructor(h,p){this.ngModuleFactory=h,this.componentFactories=p}}let EU=(()=>{class c{compileModuleSync(p){return new oA(p)}compileModuleAsync(p){return Promise.resolve(this.compileModuleSync(p))}compileModuleAndAllComponentsSync(p){const b=this.compileModuleSync(p),I=ll(qr(p).declarations).reduce((B,G)=>{const Y=no(G);return Y&&B.push(new At(Y)),B},[]);return new VD(b,I)}compileModuleAndAllComponentsAsync(p){return Promise.resolve(this.compileModuleAndAllComponentsSync(p))}clearCache(){}clearCacheFor(p){}getModuleId(p){}static{this.\u0275fac=function(b){return new(b||c)}}static{this.\u0275prov=zo({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})(),SU=(()=>{class c{constructor(){this.zone=Tn(fs),this.changeDetectionScheduler=Tn(es),this.applicationRef=Tn(_u)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(b){return new(b||c)}}static{this.\u0275prov=zo({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();function Db({ngZoneFactory:c,ignoreChangesOutsideZone:h}){return c??=()=>new fs(function jD(c){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:c?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:c?.runCoalescing??!1}}()),[{provide:fs,useFactory:c},{provide:Vc,multi:!0,useFactory:()=>{const p=Tn(SU,{optional:!0});return()=>p.initialize()}},{provide:Vc,multi:!0,useFactory:()=>{const p=Tn(ON);return()=>{p.initialize()}}},{provide:Yc,useFactory:UD},!0===h?{provide:lb,useValue:!0}:[]]}function UD(){const c=Tn(fs),h=Tn(Pl);return p=>c.runOutsideAngular(()=>h.handleError(p))}let ON=(()=>{class c{constructor(){this.subscription=new qt.yU,this.initialized=!1,this.zone=Tn(fs),this.pendingTasks=Tn(qu)}initialize(){if(this.initialized)return;this.initialized=!0;let p=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(p=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{fs.assertNotInAngularZone(),queueMicrotask(()=>{null!==p&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(p),p=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{fs.assertInAngularZone(),p??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(b){return new(b||c)}}static{this.\u0275prov=zo({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})(),GT=(()=>{class c{constructor(){this.appRef=Tn(_u),this.taskService=Tn(qu),this.ngZone=Tn(fs),this.zonelessEnabled=Tn(Xh),this.disableScheduling=Tn(lb,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new qt.yU,this.cancelScheduledCallback=null,this.shouldRefreshViews=!1,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof d||!this.zoneIsDefined)}notify(p){if(!this.zonelessEnabled&&5===p)return;switch(p){case 3:case 2:case 0:case 4:case 5:case 1:this.shouldRefreshViews=!0}if(!this.shouldScheduleTick())return;const b=this.useMicrotaskScheduler?e1:Jw;this.pendingRenderTaskId=this.taskService.add(),this.zoneIsDefined?Zone.root.run(()=>{this.cancelScheduledCallback=b(()=>{this.tick(this.shouldRefreshViews)})}):this.cancelScheduledCallback=b(()=>{this.tick(this.shouldRefreshViews)})}shouldScheduleTick(){return!(this.disableScheduling||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&fs.isInAngularZone())}tick(p){if(this.runningTick||this.appRef.destroyed)return;const b=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick(p)},void 0,this.schedulerTickApplyArgs)}catch(T){throw this.taskService.remove(b),T}finally{this.cleanup()}this.useMicrotaskScheduler=!0,e1(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(b)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.shouldRefreshViews=!1,this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const p=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(p)}}static{this.\u0275fac=function(b){return new(b||c)}}static{this.\u0275prov=zo({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();const ix=new Qn("",{providedIn:"root",factory:()=>Tn(ix,Cr.Optional|Cr.SkipSelf)||function LN(){return typeof $localize<"u"&&$localize.locale||j0}()}),HR=new Qn("",{providedIn:"root",factory:()=>"USD"}),GD=new Qn("");let k_=null;function WD(){return!1}let ZR=(()=>{class c{static{this.__NG_ELEMENT_ID__=VN}}return c})();function VN(c){return function Va(c,h,p){if(Sh(c)&&!p){const b=Mt(c.index,h);return new Jv(b,b)}return 47&c.type?new Jv(h[us],h):null}(lo(),Ot(),!(16&~c))}class Fm{constructor(){}supports(h){return aA(h)}create(h){return new JR(h)}}const HN=(c,h)=>h;class JR{constructor(h){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=h||HN}forEachItem(h){let p;for(p=this._itHead;null!==p;p=p._next)h(p)}forEachOperation(h){let p=this._itHead,b=this._removalsHead,T=0,I=null;for(;p||b;){const B=!b||p&&p.currentIndex<XD(b,T,I)?p:b,G=XD(B,T,I),Y=B.currentIndex;if(B===b)T--,b=b._nextRemoved;else if(p=p._next,null==B.previousIndex)T++;else{I||(I=[]);const oe=G-T,ue=Y-T;if(oe!=ue){for(let Xe=0;Xe<oe;Xe++){const Je=Xe<I.length?I[Xe]:I[Xe]=0,vt=Je+Xe;ue<=vt&&vt<oe&&(I[Xe]=Je+1)}I[B.previousIndex]=ue-oe}}G!==Y&&h(B,G,Y)}}forEachPreviousItem(h){let p;for(p=this._previousItHead;null!==p;p=p._nextPrevious)h(p)}forEachAddedItem(h){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)h(p)}forEachMovedItem(h){let p;for(p=this._movesHead;null!==p;p=p._nextMoved)h(p)}forEachRemovedItem(h){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)h(p)}forEachIdentityChange(h){let p;for(p=this._identityChangesHead;null!==p;p=p._nextIdentityChange)h(p)}diff(h){if(null==h&&(h=[]),!aA(h))throw new Ue(900,!1);return this.check(h)?this:null}onDestroy(){}check(h){this._reset();let T,I,B,p=this._itHead,b=!1;if(Array.isArray(h)){this.length=h.length;for(let G=0;G<this.length;G++)I=h[G],B=this._trackByFn(G,I),null!==p&&Object.is(p.trackById,B)?(b&&(p=this._verifyReinsertion(p,I,B,G)),Object.is(p.item,I)||this._addIdentityChange(p,I)):(p=this._mismatch(p,I,B,G),b=!0),p=p._next}else T=0,function NL(c,h){if(Array.isArray(c))for(let p=0;p<c.length;p++)h(c[p]);else{const p=c[Symbol.iterator]();let b;for(;!(b=p.next()).done;)h(b.value)}}(h,G=>{B=this._trackByFn(T,G),null!==p&&Object.is(p.trackById,B)?(b&&(p=this._verifyReinsertion(p,G,B,T)),Object.is(p.item,G)||this._addIdentityChange(p,G)):(p=this._mismatch(p,G,B,T),b=!0),p=p._next,T++}),this.length=T;return this._truncate(p),this.collection=h,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let h;for(h=this._previousItHead=this._itHead;null!==h;h=h._next)h._nextPrevious=h._next;for(h=this._additionsHead;null!==h;h=h._nextAdded)h.previousIndex=h.currentIndex;for(this._additionsHead=this._additionsTail=null,h=this._movesHead;null!==h;h=h._nextMoved)h.previousIndex=h.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(h,p,b,T){let I;return null===h?I=this._itTail:(I=h._prev,this._remove(h)),null!==(h=null===this._unlinkedRecords?null:this._unlinkedRecords.get(b,null))?(Object.is(h.item,p)||this._addIdentityChange(h,p),this._reinsertAfter(h,I,T)):null!==(h=null===this._linkedRecords?null:this._linkedRecords.get(b,T))?(Object.is(h.item,p)||this._addIdentityChange(h,p),this._moveAfter(h,I,T)):h=this._addAfter(new $N(p,b),I,T),h}_verifyReinsertion(h,p,b,T){let I=null===this._unlinkedRecords?null:this._unlinkedRecords.get(b,null);return null!==I?h=this._reinsertAfter(I,h._prev,T):h.currentIndex!=T&&(h.currentIndex=T,this._addToMoves(h,T)),h}_truncate(h){for(;null!==h;){const p=h._next;this._addToRemovals(this._unlink(h)),h=p}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(h,p,b){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(h);const T=h._prevRemoved,I=h._nextRemoved;return null===T?this._removalsHead=I:T._nextRemoved=I,null===I?this._removalsTail=T:I._prevRemoved=T,this._insertAfter(h,p,b),this._addToMoves(h,b),h}_moveAfter(h,p,b){return this._unlink(h),this._insertAfter(h,p,b),this._addToMoves(h,b),h}_addAfter(h,p,b){return this._insertAfter(h,p,b),this._additionsTail=null===this._additionsTail?this._additionsHead=h:this._additionsTail._nextAdded=h,h}_insertAfter(h,p,b){const T=null===p?this._itHead:p._next;return h._next=T,h._prev=p,null===T?this._itTail=h:T._prev=h,null===p?this._itHead=h:p._next=h,null===this._linkedRecords&&(this._linkedRecords=new YT),this._linkedRecords.put(h),h.currentIndex=b,h}_remove(h){return this._addToRemovals(this._unlink(h))}_unlink(h){null!==this._linkedRecords&&this._linkedRecords.remove(h);const p=h._prev,b=h._next;return null===p?this._itHead=b:p._next=b,null===b?this._itTail=p:b._prev=p,h}_addToMoves(h,p){return h.previousIndex===p||(this._movesTail=null===this._movesTail?this._movesHead=h:this._movesTail._nextMoved=h),h}_addToRemovals(h){return null===this._unlinkedRecords&&(this._unlinkedRecords=new YT),this._unlinkedRecords.put(h),h.currentIndex=null,h._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=h,h._prevRemoved=null):(h._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=h),h}_addIdentityChange(h,p){return h.item=p,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=h:this._identityChangesTail._nextIdentityChange=h,h}}class $N{constructor(h,p){this.item=h,this.trackById=p,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class sc{constructor(){this._head=null,this._tail=null}add(h){null===this._head?(this._head=this._tail=h,h._nextDup=null,h._prevDup=null):(this._tail._nextDup=h,h._prevDup=this._tail,h._nextDup=null,this._tail=h)}get(h,p){let b;for(b=this._head;null!==b;b=b._nextDup)if((null===p||p<=b.currentIndex)&&Object.is(b.trackById,h))return b;return null}remove(h){const p=h._prevDup,b=h._nextDup;return null===p?this._head=b:p._nextDup=b,null===b?this._tail=p:b._prevDup=p,null===this._head}}class YT{constructor(){this.map=new Map}put(h){const p=h.trackById;let b=this.map.get(p);b||(b=new sc,this.map.set(p,b)),b.add(h)}get(h,p){const T=this.map.get(h);return T?T.get(h,p):null}remove(h){const p=h.trackById;return this.map.get(p).remove(h)&&this.map.delete(p),h}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function XD(c,h,p){const b=c.previousIndex;if(null===b)return b;let T=0;return p&&b<p.length&&(T=p[b]),b+h+T}class WN{constructor(){}supports(h){return h instanceof Map||lA(h)}create(){return new eP}}class eP{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(h){let p;for(p=this._mapHead;null!==p;p=p._next)h(p)}forEachPreviousItem(h){let p;for(p=this._previousMapHead;null!==p;p=p._nextPrevious)h(p)}forEachChangedItem(h){let p;for(p=this._changesHead;null!==p;p=p._nextChanged)h(p)}forEachAddedItem(h){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)h(p)}forEachRemovedItem(h){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)h(p)}diff(h){if(h){if(!(h instanceof Map||lA(h)))throw new Ue(900,!1)}else h=new Map;return this.check(h)?this:null}onDestroy(){}check(h){this._reset();let p=this._mapHead;if(this._appendAfter=null,this._forEach(h,(b,T)=>{if(p&&p.key===T)this._maybeAddToChanges(p,b),this._appendAfter=p,p=p._next;else{const I=this._getOrCreateRecordForKey(T,b);p=this._insertBeforeOrAppend(p,I)}}),p){p._prev&&(p._prev._next=null),this._removalsHead=p;for(let b=p;null!==b;b=b._nextRemoved)b===this._mapHead&&(this._mapHead=null),this._records.delete(b.key),b._nextRemoved=b._next,b.previousValue=b.currentValue,b.currentValue=null,b._prev=null,b._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(h,p){if(h){const b=h._prev;return p._next=h,p._prev=b,h._prev=p,b&&(b._next=p),h===this._mapHead&&(this._mapHead=p),this._appendAfter=h,h}return this._appendAfter?(this._appendAfter._next=p,p._prev=this._appendAfter):this._mapHead=p,this._appendAfter=p,null}_getOrCreateRecordForKey(h,p){if(this._records.has(h)){const T=this._records.get(h);this._maybeAddToChanges(T,p);const I=T._prev,B=T._next;return I&&(I._next=B),B&&(B._prev=I),T._next=null,T._prev=null,T}const b=new tP(h);return this._records.set(h,b),b.currentValue=p,this._addToAdditions(b),b}_reset(){if(this.isDirty){let h;for(this._previousMapHead=this._mapHead,h=this._previousMapHead;null!==h;h=h._next)h._nextPrevious=h._next;for(h=this._changesHead;null!==h;h=h._nextChanged)h.previousValue=h.currentValue;for(h=this._additionsHead;null!=h;h=h._nextAdded)h.previousValue=h.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(h,p){Object.is(p,h.currentValue)||(h.previousValue=h.currentValue,h.currentValue=p,this._addToChanges(h))}_addToAdditions(h){null===this._additionsHead?this._additionsHead=this._additionsTail=h:(this._additionsTail._nextAdded=h,this._additionsTail=h)}_addToChanges(h){null===this._changesHead?this._changesHead=this._changesTail=h:(this._changesTail._nextChanged=h,this._changesTail=h)}_forEach(h,p){h instanceof Map?h.forEach(p):Object.keys(h).forEach(b=>p(h[b],b))}}class tP{constructor(h){this.key=h,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function ox(){return new og([new Fm])}let og=(()=>{class c{static{this.\u0275prov=zo({token:c,providedIn:"root",factory:ox})}constructor(p){this.factories=p}static create(p,b){if(null!=b){const T=b.factories.slice();p=p.concat(T)}return new c(p)}static extend(p){return{provide:c,useFactory:b=>c.create(p,b||ox()),deps:[[c,new Df,new Af]]}}find(p){const b=this.factories.find(T=>T.supports(p));if(null!=b)return b;throw new Ue(901,!1)}}return c})();function XN(){return new qD([new WN])}let qD=(()=>{class c{static{this.\u0275prov=zo({token:c,providedIn:"root",factory:XN})}constructor(p){this.factories=p}static create(p,b){if(b){const T=b.factories.slice();p=p.concat(T)}return new c(p)}static extend(p){return{provide:c,useFactory:b=>c.create(p,b||XN()),deps:[[c,new Df,new Af]]}}find(p){const b=this.factories.find(T=>T.supports(p));if(b)return b;throw new Ue(901,!1)}}return c})(),HU=(()=>{class c{constructor(p){}static{this.\u0275fac=function(b){return new(b||c)(ba(_u))}}static{this.\u0275mod=tl({type:c})}static{this.\u0275inj=Eu({})}}return c})();function U1(c){try{const{rootComponent:h,appProviders:p,platformProviders:b}=c,T=function $D(c=[]){if(k_)return k_;const h=function HD(c=[],h){return Pa.create({name:h,providers:[{provide:Ag,useValue:"platform"},{provide:GD,useValue:new Set([()=>k_=null])},...c]})}(c);return k_=h,function BD(){!function as(c){uo=c}(()=>{throw new Ue(600,!1)})}(),function WT(c){c.get(nM,null)?.forEach(p=>p())}(h),h}(b),I=[Db({}),{provide:es,useExisting:GT},...p||[]],G=new NI({providers:I,parent:T,debugName:"",runEnvironmentInitializers:!1}).injector,Y=G.get(fs);return Y.run(()=>{G.resolveInjectorInitializers();const oe=G.get(Pl,null);let ue;Y.runOutsideAngular(()=>{ue=Y.onError.subscribe({next:Je=>{oe.handleError(Je)}})});const Pe=()=>G.destroy(),Xe=T.get(GD);return Xe.add(Pe),G.onDestroy(()=>{ue.unsubscribe(),Xe.delete(Pe)}),function BT(c,h,p){try{const b=p();return z1(b)?b.catch(T=>{throw h.runOutsideAngular(()=>c.handleError(T)),T}):b}catch(b){throw h.runOutsideAngular(()=>c.handleError(b)),b}}(oe,Y,()=>{const Je=G.get(FD);return Je.runInitializers(),Je.donePromise.then(()=>{!function ZA(c){"string"==typeof c&&(YA=c.toLowerCase().replace(/_/g,"-"))}(G.get(ix,j0)||j0);const $t=G.get(_u);return void 0!==h&&$t.bootstrap(h),$t})})})}catch(h){return Promise.reject(h)}}function p5(c){return"boolean"==typeof c?c:null!=c&&"false"!==c}function g5(c,h=NaN){return isNaN(parseFloat(c))||isNaN(Number(c))?h:Number(c)}function x5(c,h){hl("NgSignals");const p=function St(c){const h=Object.create(an);h.computation=c;const p=()=>{if(er(h),Ft(h),h.value===Ii)throw h.error;return h.value};return p[Tt]=h,p}(c);return h?.equal&&(p[Tt].equal=h.equal),p}function w5(c){const h=Si(null);try{return c()}finally{Si(h)}}const C5=new Qn("",{providedIn:"root",factory:()=>Tn(E5)});let E5=(()=>{class c{static{this.\u0275prov=zo({token:c,providedIn:"root",factory:()=>new T5})}}return c})();class T5{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=Tn(qu),this.taskId=null}scheduleEffect(h){if(this.enqueue(h),null===this.taskId){const p=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(p),this.taskId=null})}}enqueue(h){const p=h.creationZone;this.queues.has(p)||this.queues.set(p,new Set);const b=this.queues.get(p);b.has(h)||(this.queuedEffectCount++,b.add(h))}flush(){for(;this.queuedEffectCount>0;)for(const[h,p]of this.queues)null===h?this.flushQueue(p):h.run(()=>this.flushQueue(p))}flushQueue(h){for(const p of h)h.delete(p),this.queuedEffectCount--,p.run()}}class x3{constructor(h,p,b,T,I,B){this.scheduler=h,this.effectFn=p,this.creationZone=b,this.injector=I,this.watcher=function io(c,h,p){const b=Object.create(Qe);p&&(b.consumerAllowSignalWrites=!0),b.fn=c,b.schedule=h;const T=Y=>{b.cleanupFn=Y};return b.ref={notify:()=>tr(b),run:()=>{if(null===b.fn)return;if(function Ar(){return Ai}())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(b.dirty=!1,b.hasRun&&!ki(b))return;b.hasRun=!0;const Y=bi(b);try{b.cleanupFn(),b.cleanupFn=Ge,b.fn(T)}finally{Di(b,Y)}},cleanup:()=>b.cleanupFn(),destroy:()=>function B(Y){(function I(Y){return null===Y.fn&&null===Y.schedule})(Y)||(Ki(Y),Y.cleanupFn(),Y.fn=null,Y.schedule=null,Y.cleanupFn=Ge)}(b),[Tt]:b},b.ref}(G=>this.runEffect(G),()=>this.schedule(),B),this.unregisterOnDestroy=T?.onDestroy(()=>this.destroy())}runEffect(h){try{this.effectFn(h)}catch(p){this.injector.get(Pl,null,{optional:!0})?.handleError(p)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}}function w3(c,h){hl("NgSignals"),!h?.injector&&Gc();const p=h?.injector??Tn(Pa),b=!0!==h?.manualCleanup?p.get(bp):null,T=new x3(p.get(C5),c,typeof Zone>"u"?null:Zone.current,b,p,h?.allowSignalWrites??!1),I=p.get(ZR,null,{optional:!0});return I&&8&I._lView[ln]?(I._lView[Ch]??=[]).push(T.watcher.notify):T.watcher.notify(),T}function S5(c){const h=no(c);if(!h)return null;const p=new At(h);return{get selector(){return p.selector},get type(){return p.componentType},get inputs(){return p.inputs},get outputs(){return p.outputs},get ngContentSelectors(){return p.ngContentSelectors},get isStandalone(){return h.standalone},get isSignal(){return h.signals}}}},467:(Go,Gn,It)=>{"use strict";function o(Ai,_,Tt,Si,Ri,Ar,Kt){try{var ui=Ai[Ar](Kt),Ft=ui.value}catch(Li){return void Tt(Li)}ui.done?_(Ft):Promise.resolve(Ft).then(Si,Ri)}function Yt(Ai){return function(){var _=this,Tt=arguments;return new Promise(function(Si,Ri){var Ar=Ai.apply(_,Tt);function Kt(Ft){o(Ar,Si,Ri,Kt,ui,"next",Ft)}function ui(Ft){o(Ar,Si,Ri,Kt,ui,"throw",Ft)}Kt(void 0)})}}It.d(Gn,{A:()=>Yt})}},Go=>{Go(Go.s=364)}]);